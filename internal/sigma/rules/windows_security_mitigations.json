{
  "metadata": {
    "logsource": "windows_security_mitigations",
    "rule_count": 2,
    "compiled_at": "2026-02-04T12:28:36.561404",
    "version": "1.1"
  },
  "rules": [
    {
      "id": "0b0ea3cc-99c8-4730-9c53-45deee2a4c86",
      "title": "Microsoft Defender Blocked from Loading Unsigned DLL",
      "status": "test",
      "description": "Detects Code Integrity (CI) engine blocking Microsoft Defender's processes (MpCmdRun and NisSrv) from loading unsigned DLLs which may be an attempt to sideload arbitrary DLL",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1574.001"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security-mitigations"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": [
                  11,
                  12
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "ProcessPath__endswith": {
                "field": "ProcessPath",
                "value": [
                  "\\MpCmdRun.exe",
                  "\\NisSrv.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1574.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Bhabesh Raj",
        "date": "2022-08-02",
        "modified": "2022-09-28",
        "references": [
          "https://www.sentinelone.com/blog/living-off-windows-defender-lockbit-ransomware-sideloads-cobalt-strike-through-microsoft-security-tool"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security_mitigations/win_security_mitigations_defender_load_unsigned_dll.yml"
      }
    },
    {
      "id": "8289bf8c-4aca-4f5a-9db3-dc3d7afe5c10",
      "title": "Unsigned Binary Loaded From Suspicious Location",
      "status": "test",
      "description": "Detects Code Integrity (CI) engine blocking processes from loading unsigned DLLs residing in suspicious locations",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1574.001"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security-mitigations"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": [
                  11,
                  12
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "ImageName__contains": {
                "field": "ImageName",
                "value": [
                  "\\Users\\Public\\",
                  "\\PerfLogs\\",
                  "\\Desktop\\",
                  "\\Downloads\\",
                  "\\AppData\\Local\\Temp\\",
                  "C:\\Windows\\TEMP\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1574.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-03",
        "modified": "2022-09-28",
        "references": [
          "https://github.com/nasbench/EVTX-ETW-Resources/blob/45fd5be71a51aa518b1b36d4e1f36af498084e27/ETWEventsList/CSV/Windows11/21H2/W11_21H2_Pro_20220719_22000.795/Providers/Microsoft-Windows-Security-Mitigations.csv"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security_mitigations/win_security_mitigations_unsigned_dll_from_susp_location.yml"
      }
    }
  ]
}