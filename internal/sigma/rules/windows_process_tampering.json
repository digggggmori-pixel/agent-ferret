{
  "metadata": {
    "logsource": "windows_process_tampering",
    "rule_count": 1,
    "compiled_at": "2026-02-04T12:28:36.515965",
    "version": "1.1"
  },
  "rules": [
    {
      "id": "c4b890e5-8d8c-4496-8c66-c805753817cd",
      "title": "Potential Process Hollowing Activity",
      "status": "test",
      "description": "Detects when a memory process image does not match the disk image, indicative of process hollowing.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1055.012"
      ],
      "logsource": {
        "category": "process_tampering",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Type": {
                "field": "Type",
                "value": "Image is replaced",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_generic": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  ":\\Program Files (x86)",
                  ":\\Program Files\\",
                  ":\\Windows\\System32\\wbem\\WMIADAP.exe",
                  ":\\Windows\\SysWOW64\\wbem\\WMIADAP.exe"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_opera": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": "\\AppData\\Local\\Programs\\Opera\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\opera.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_edge": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\WindowsApps\\MicrosoftEdge.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1055.012"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Christopher Peacock '@securepeacock', SCYTHE '@scythe_io', Sittikorn S",
        "date": "2022-01-25",
        "modified": "2023-11-28",
        "references": [
          "https://twitter.com/SecurePeacock/status/1486054048390332423?s=20",
          "https://www.bleepingcomputer.com/news/microsoft/microsoft-sysmon-now-detects-malware-process-tampering-attempts/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_tampering/proc_tampering_susp_process_hollowing.yml"
      }
    }
  ]
}