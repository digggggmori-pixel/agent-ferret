{
  "metadata": {
    "logsource": "windows_process_creation",
    "rule_count": 1156,
    "compiled_at": "2026-02-04T12:28:36.429822",
    "version": "1.1"
  },
  "rules": [
    {
      "id": "e20b5b14-ce93-4230-88af-981983ef6e74",
      "title": "QuickAssist Execution",
      "status": "experimental",
      "description": "Detects the execution of Microsoft Quick Assist tool \"QuickAssist.exe\". This utility can be used by attackers to gain remote access.\n",
      "level": "low",
      "tags": [
        "attack.command-and-control",
        "attack.t1219.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\QuickAssist.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1219.002"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Muhammad Faisal (@faisalusuf)",
        "date": "2024-12-19",
        "modified": "",
        "references": [
          "https://www.microsoft.com/en-us/security/blog/2024/05/15/threat-actors-misusing-quick-assist-in-social-engineering-attacks-leading-to-ransomware/",
          "https://www.linkedin.com/posts/kevin-beaumont-security_ive-been-assisting-a-few-orgs-hit-with-successful-activity-7268055739116445701-xxjZ/",
          "https://x.com/cyb3rops/status/1862406110365245506",
          "https://learn.microsoft.com/en-us/windows/client-management/client-tools/quick-assist"
        ],
        "falsepositives": [
          "Legitimate use of Quick Assist in the environment."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_quickassist_execution.yml"
      }
    },
    {
      "id": "deb9b646-a508-44ee-b7c9-d8965921c6b6",
      "title": "Powershell Token Obfuscation - Process Creation",
      "status": "test",
      "description": "Detects TOKEN OBFUSCATION technique from Invoke-Obfuscation",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027.009"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__re": {
                    "field": "CommandLine",
                    "value": "\\w+`(\\w+|-|.)`[\\w+|\\s]",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__re": {
                    "field": "CommandLine",
                    "value": "\"(\\{\\d\\})+\"\\s*-f",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__re": {
                    "field": "CommandLine",
                    "value": "(?i)\\$\\{`?e`?n`?v`?:`?p`?a`?t`?h`?\\}",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_main_envpath": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "${env:path}",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1027.009"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-12-27",
        "modified": "2024-08-11",
        "references": [
          "https://github.com/danielbohannon/Invoke-Obfuscation"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_token_obfuscation.yml"
      }
    },
    {
      "id": "51cbac1e-eee3-4a90-b1b7-358efb81fa0a",
      "title": "Potential Windows Defender Tampering Via Wmic.EXE",
      "status": "test",
      "description": "Detects potential tampering with Windows Defender settings such as adding exclusion using wmic",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.execution",
        "attack.t1047",
        "attack.t1562"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "wmic.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\WMIC.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "/Namespace:\\\\\\\\root\\\\Microsoft\\\\Windows\\\\Defender",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1047",
          "T1562"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-12-11",
        "modified": "2023-02-14",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/5c1e6f1b4fafd01c8d1ece85f510160fc1275fbf/atomics/T1562.001/T1562.001.md",
          "https://www.bleepingcomputer.com/news/security/gootkit-malware-bypasses-windows-defender-by-setting-path-exclusions/",
          "https://www.bleepingcomputer.com/news/security/iobit-forums-hacked-to-spread-ransomware-to-its-members/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wmic_namespace_defender.yml"
      }
    },
    {
      "id": "afe52666-401e-4a02-b4ff-5d128990b8cb",
      "title": "Suspicious Greedy Compression Using Rar.EXE",
      "status": "test",
      "description": "Detects RAR usage that creates an archive from a suspicious folder, either a system folder or one of the folders often used by attackers for staging purposes",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_opt_1": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\rar.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "Command line RAR",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_opt_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ".exe a ",
                  " a -m"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_flags": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " -hp",
                  " -r "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_folders": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " ?:\\\\\\*.",
                  " ?:\\\\\\\\\\*.",
                  " ?:\\$Recycle.bin\\",
                  " ?:\\PerfLogs\\",
                  " ?:\\Temp",
                  " ?:\\Users\\Public\\",
                  " ?:\\Windows\\",
                  " %public%"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_opt_* and all of selection_cli_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "1 of selection_opt_*"
            },
            {
              "type": "ref",
              "value": "all of selection_cli_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1059"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "X__Junior (Nextron Systems), Florian Roth (Nextron Systems)",
        "date": "2022-12-15",
        "modified": "2024-01-02",
        "references": [
          "https://decoded.avast.io/martinchlumecky/png-steganography"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_rar_susp_greedy_compression.yml"
      }
    },
    {
      "id": "022eaba8-f0bf-4dd9-9217-4604b0bb3bb0",
      "title": "HackTool - Wmiexec Default Powershell Command",
      "status": "test",
      "description": "Detects the execution of PowerShell with a specific flag sequence that is used by the Wmiexec script",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.lateral-movement"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-NoP -NoL -sta -NonI -W Hidden -Exec Bypass -Enc",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion",
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-03-08",
        "modified": "",
        "references": [
          "https://github.com/fortra/impacket/blob/f4b848fa27654ca95bc0f4c73dbba8b9c2c9f30a/examples/wmiexec.py"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_wmiexec_default_powershell.yml"
      }
    },
    {
      "id": "503d581c-7df0-4bbe-b9be-5840c0ecc1fc",
      "title": "UAC Bypass Using ChangePK and SLUI",
      "status": "test",
      "description": "Detects an UAC bypass that uses changepk.exe and slui.exe (UACMe 61)",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\changepk.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\slui.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "IntegrityLevel": {
                "field": "IntegrityLevel",
                "value": [
                  "High",
                  "System",
                  "S-1-16-16384",
                  "S-1-16-12288"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Christian Burkard (Nextron Systems)",
        "date": "2021-08-23",
        "modified": "2024-12-01",
        "references": [
          "https://mattharr0ey.medium.com/privilege-escalation-uac-bypass-in-changepk-c40b92818d1b",
          "https://github.com/hfiref0x/UACME",
          "https://medium.com/falconforce/falconfriday-detecting-uac-bypasses-0xff16-86c2a9107abf"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_uac_bypass_changepk_slui.yml"
      }
    },
    {
      "id": "ea011323-7045-460b-b2d7-0f7442ea6b38",
      "title": "Potential PsExec Remote Execution",
      "status": "test",
      "description": "Detects potential psexec command that initiate execution on a remote systems via common commandline flags used by the utility",
      "level": "high",
      "tags": [
        "attack.resource-development",
        "attack.t1587.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "accepteula",
                  " -u ",
                  " -p ",
                  " \\\\\\\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_localhost": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\\\\\\\localhost",
                  "\\\\\\\\127."
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1587.001"
        ],
        "tactics": [
          "resource_development"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-02-28",
        "modified": "2025-09-01",
        "references": [
          "https://learn.microsoft.com/en-us/sysinternals/downloads/psexec",
          "https://www.poweradmin.com/paexec/",
          "https://www.fireeye.com/blog/threat-research/2020/10/kegtap-and-singlemalt-with-a-ransomware-chaser.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sysinternals_psexec_remote_execution.yml"
      }
    },
    {
      "id": "d487ed4a-fd24-436d-a0b2-f4e95f7b2635",
      "title": "Suspicious ClickFix/FileFix Execution Pattern",
      "status": "experimental",
      "description": "Detects suspicious execution patterns where users are tricked into running malicious commands via clipboard manipulation, either through the Windows Run dialog (ClickFix) or File Explorer address bar (FileFix).\nAttackers leverage social engineering campaigns—such as fake CAPTCHA challenges or urgent alerts—encouraging victims to paste clipboard contents, often executing mshta.exe, powershell.exe, or similar commands to infect systems.\n",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1204.001",
        "attack.t1204.004"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\explorer.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "#",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli_captcha": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "account",
                  "anti-bot",
                  "botcheck",
                  "captcha",
                  "challenge",
                  "confirmation",
                  "fraud",
                  "human",
                  "identification",
                  "identificator",
                  "identity",
                  "robot",
                  "validation",
                  "verification",
                  "verify"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1204.001",
          "T1204.004"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "montysecurity, Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-11-19",
        "modified": "",
        "references": [
          "https://github.com/JohnHammond/recaptcha-phish",
          "https://www.zscaler.com/blogs/security-research/deepseek-lure-using-captchas-spread-malware",
          "https://www.threatdown.com/blog/clipboard-hijacker-tries-to-install-a-trojan/",
          "https://app.any.run/tasks/5c16b4db-4b36-4039-a0ed-9b09abff8be2",
          "https://www.esentire.com/security-advisories/netsupport-rat-clickfix-distribution",
          "https://www.scpx.com.au/2025/11/16/decades-old-finger-protocol-abused-in-clickfix-malware-attacks/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_clickfix_filefix_execution.yml"
      }
    },
    {
      "id": "37db85d1-b089-490a-a59a-c7b6f984f480",
      "title": "Sysmon Discovery Via Default Driver Altitude Using Findstr.EXE",
      "status": "test",
      "description": "Detects usage of \"findstr\" with the argument \"385201\". Which could indicate potential discovery of an installed Sysinternals Sysmon service using the default driver altitude (even if the name is changed).",
      "level": "high",
      "tags": [
        "attack.discovery",
        "attack.t1518.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\find.exe",
                      "\\findstr.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "FIND.EXE",
                      "FINDSTR.EXE"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " 385201",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1518.001"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-12-16",
        "modified": "2023-11-14",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1518.001/T1518.001.md#atomic-test-5---security-software-discovery---sysmon-service"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_findstr_sysmon_discovery_via_default_altitude.yml"
      }
    },
    {
      "id": "258fc8ce-8352-443a-9120-8a11e4857fa5",
      "title": "Potential Arbitrary Command Execution Using Msdt.EXE",
      "status": "test",
      "description": "Detects processes leveraging the \"ms-msdt\" handler or the \"msdt.exe\" binary to execute arbitrary commands as seen in the follina (CVE-2022-30190) vulnerability",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1202"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\msdt.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "msdt.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cmd_inline": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "IT_BrowseForFile=",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cmd_answerfile_flag": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " PCWDiagnostic",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cmd_answerfile_param": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -af ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_img and (selection_cmd_inline or all of selection_cmd_answerfile_*)",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection_img and (selection_cmd_inline",
            "all of selection_cmd_answerfile_*)"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1202"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-05-29",
        "modified": "2024-03-13",
        "references": [
          "https://twitter.com/nao_sec/status/1530196847679401984",
          "https://app.any.run/tasks/713f05d2-fe78-4b9d-a744-f7c133e3fafb/",
          "https://twitter.com/_JohnHammond/status/1531672601067675648"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_msdt_arbitrary_command_execution.yml"
      }
    },
    {
      "id": "1a0d4aba-7668-4365-9ce4-6d79ab088dfd",
      "title": "Ping Hex IP",
      "status": "test",
      "description": "Detects a ping command that uses a hex encoded IP address",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1140",
        "attack.t1027"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\ping.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__re": {
                "field": "CommandLine",
                "value": "0x[a-fA-F0-9]{8}",
                "modifiers": [
                  "re"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1140",
          "T1027"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2018-03-23",
        "modified": "2025-10-17",
        "references": [
          "https://github.com/vysecurity/Aggressor-VYSEC/blob/0d61c80387b9432dab64b8b8a9fb52d20cfef80e/ping.cna",
          "https://twitter.com/vysecurity/status/977198418354491392"
        ],
        "falsepositives": [
          "Unlikely, because no sane admin pings IP addresses in a hexadecimal form"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_ping_hex_ip.yml"
      }
    },
    {
      "id": "3c1b5fb0-c72f-45ba-abd1-4d4c353144ab",
      "title": "Process Creation Using Sysnative Folder",
      "status": "test",
      "description": "Detects process creation events that use the Sysnative folder (common for CobaltStrike spawns)",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1055"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": ":\\Windows\\Sysnative\\",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__contains": {
                    "field": "Image",
                    "value": ":\\Windows\\Sysnative\\",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_main_ngen": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  "C:\\Windows\\Microsoft.NET\\Framework64\\v",
                  "C:\\Windows\\Microsoft.NET\\Framework\\v",
                  "C:\\Windows\\Microsoft.NET\\FrameworkArm\\v",
                  "C:\\Windows\\Microsoft.NET\\FrameworkArm64\\v"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\ngen.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "install",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_xampp": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "\"C:\\Windows\\sysnative\\cmd.exe\"",
                  "\\xampp\\",
                  "\\catalina_start.bat"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1055"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Max Altgelt (Nextron Systems)",
        "date": "2022-08-23",
        "modified": "2025-10-08",
        "references": [
          "https://thedfirreport.com/2021/08/29/cobalt-strike-a-defenders-guide/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_sysnative.yml"
      }
    },
    {
      "id": "949f1ffb-6e85-4f00-ae1e-c3c5b190d605",
      "title": "Explorer Process Tree Break",
      "status": "test",
      "description": "Detects a command line process that uses explorer.exe to launch arbitrary commands or binaries,\nwhich is similar to cmd.exe /c, only it breaks the process tree and makes its parent a new instance of explorer spawning from \"svchost\"\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_factory": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "/factory,{75dff2b7-6936-4c06-a8bb-676a7b00b24b}",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_root": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "explorer.exe",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_1": {
                "field": "CommandLine",
                "value": " /root,",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1036"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems), @gott_cyber",
        "date": "2019-06-29",
        "modified": "2025-10-31",
        "references": [
          "https://twitter.com/CyberRaiju/status/1273597319322058752",
          "https://twitter.com/bohops/status/1276357235954909188?s=12",
          "https://twitter.com/nas_bench/status/1535322450858233858",
          "https://securityboulevard.com/2019/09/deobfuscating-ostap-trickbots-34000-line-javascript-downloader/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_explorer_break_process_tree.yml"
      }
    },
    {
      "id": "32b96012-7892-429e-b26c-ac2bf46066ff",
      "title": "Shell32 DLL Execution in Suspicious Directory",
      "status": "test",
      "description": "Detects shell32.dll executing a DLL in a suspicious directory",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.execution",
        "attack.t1218.011"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\rundll32.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "RUNDLL32.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "shell32.dll",
                  "Control_RunDLL"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "%AppData%",
                  "%LocalAppData%",
                  "%Temp%",
                  "%tmp%",
                  "\\AppData\\",
                  "\\Temp\\",
                  "\\Users\\Public\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.011"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Christian Burkard (Nextron Systems)",
        "date": "2021-11-24",
        "modified": "2023-02-09",
        "references": [
          "https://www.group-ib.com/resources/threat-research/red-curl-2.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_rundll32_shell32_susp_execution.yml"
      }
    },
    {
      "id": "590a5f4c-6c8c-4f10-8307-89afe9453a9d",
      "title": "Suspicious Child Process Created as System",
      "status": "test",
      "description": "Detection of child processes spawned with SYSTEM privileges by parents with LOCAL SERVICE or NETWORK SERVICE accounts",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1134.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentUser__contains": {
                "field": "ParentUser",
                "value": [
                  "AUTHORI",
                  "AUTORI"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "ParentUser__endswith": {
                "field": "ParentUser",
                "value": [
                  "\\NETWORK SERVICE",
                  "\\LOCAL SERVICE"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "User__contains": {
                "field": "User",
                "value": [
                  "AUTHORI",
                  "AUTORI"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "User__endswith": {
                "field": "User",
                "value": [
                  "\\SYSTEM",
                  "\\Système",
                  "\\СИСТЕМА"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "IntegrityLevel": {
                "field": "IntegrityLevel",
                "value": [
                  "System",
                  "S-1-16-16384"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_rundll32": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\rundll32.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "DavSetCookie",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1134.002"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Teymur Kheirkhabarov, Roberto Rodriguez (@Cyb3rWard0g), Open Threat Research (OTR)",
        "date": "2019-10-26",
        "modified": "2024-12-01",
        "references": [
          "https://speakerdeck.com/heirhabarov/hunting-for-privilege-escalation-in-windows-environment",
          "https://foxglovesecurity.com/2016/09/26/rotten-potato-privilege-escalation-from-service-accounts-to-system/",
          "https://github.com/antonioCoco/RogueWinRM",
          "https://twitter.com/Cyb3rWard0g/status/1453123054243024897"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_child_process_as_system_.yml"
      }
    },
    {
      "id": "811f459f-9231-45d4-959a-0266c6311987",
      "title": "Suspicious Child Process Of BgInfo.EXE",
      "status": "test",
      "description": "Detects suspicious child processes of \"BgInfo.exe\" which could be a sign of potential abuse of the binary to proxy execution via external VBScript",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059.005",
        "attack.defense-evasion",
        "attack.t1218",
        "attack.t1202"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\bginfo.exe",
                  "\\bginfo64.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_child": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\calc.exe",
                      "\\cmd.exe",
                      "\\cscript.exe",
                      "\\mshta.exe",
                      "\\notepad.exe",
                      "\\powershell.exe",
                      "\\pwsh.exe",
                      "\\wscript.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__contains": {
                    "field": "Image",
                    "value": [
                      "\\AppData\\Local\\",
                      "\\AppData\\Roaming\\",
                      ":\\Users\\Public\\",
                      ":\\Temp\\",
                      ":\\Windows\\Temp\\",
                      ":\\PerfLogs\\"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.005",
          "T1218",
          "T1202"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-08-16",
        "modified": "",
        "references": [
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Bginfo/",
          "https://oddvar.moe/2017/05/18/bypassing-application-whitelisting-with-bginfo/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_bginfo_suspicious_child_process.yml"
      }
    },
    {
      "id": "e2e80da2-8c66-4e00-ae3c-2eebd29f6b6d",
      "title": "Compress Data and Lock With Password for Exfiltration With WINZIP",
      "status": "test",
      "description": "An adversary may compress or encrypt data that is collected prior to exfiltration using 3rd party utilities",
      "level": "medium",
      "tags": [
        "attack.collection",
        "attack.t1560.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_winzip": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "winzip.exe",
                  "winzip64.exe"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_password": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-s\"",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_other": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -min ",
                  " -a "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1560.001"
        ],
        "tactics": [
          "collection"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-07-27",
        "modified": "2022-12-25",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1560.001/T1560.001.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_winzip_password_compression.yml"
      }
    },
    {
      "id": "b27077d6-23e6-45d2-81a0-e2b356eea5fd",
      "title": "Use of TTDInject.exe",
      "status": "test",
      "description": "Detects the executiob of TTDInject.exe, which is used by Windows 10 v1809 and newer to debug time travel (underlying call of tttracer.exe)",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1127"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "ttdinject.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "TTDInject.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1127"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-05-16",
        "modified": "",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Ttdinject/"
        ],
        "falsepositives": [
          "Legitimate use"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_ttdinject.yml"
      }
    },
    {
      "id": "3b6ab547-8ec2-4991-b9d2-2b06702a48d7",
      "title": "PowerShell Download Pattern",
      "status": "test",
      "description": "Detects a Powershell process that contains download commands in its command line string",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell_ise.exe",
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell_ISE.EXE",
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "new-object",
                  "net.webclient).",
                  "download"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "string(",
                  "file("
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), oscd.community, Jonhnathan Ribeiro",
        "date": "2019-01-16",
        "modified": "2025-10-20",
        "references": [
          "https://blog.redteam.pl/2020/06/black-kingdom-ransomware.html",
          "https://lab52.io/blog/winter-vivern-all-summer/",
          "https://hatching.io/blog/powershell-analysis/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_download_patterns.yml"
      }
    },
    {
      "id": "cbb9e3d1-2386-4e59-912e-62f1484f7a89",
      "title": "Conhost Spawned By Uncommon Parent Process",
      "status": "test",
      "description": "Detects when the Console Window Host (conhost.exe) process is spawned by an uncommon parent process, which could be indicative of potential code injection activity.",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\conhost.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\explorer.exe",
                  "\\lsass.exe",
                  "\\regsvr32.exe",
                  "\\rundll32.exe",
                  "\\services.exe",
                  "\\smss.exe",
                  "\\spoolsv.exe",
                  "\\svchost.exe",
                  "\\userinit.exe",
                  "\\wininit.exe",
                  "\\winlogon.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_svchost": {
            "type": "field_match",
            "matchers": {
              "ParentCommandLine__contains": {
                "field": "ParentCommandLine",
                "value": [
                  "-k apphost -s AppHostSvc",
                  "-k imgsvc",
                  "-k localService -p -s RemoteRegistry",
                  "-k LocalSystemNetworkRestricted -p -s NgcSvc",
                  "-k NetSvcs -p -s NcaSvc",
                  "-k netsvcs -p -s NetSetupSvc",
                  "-k netsvcs -p -s wlidsvc",
                  "-k NetworkService -p -s DoSvc",
                  "-k wsappx -p -s AppXSvc",
                  "-k wsappx -p -s ClipSVC",
                  "-k wusvcs -p -s WaaSMedicSvc"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_dropbox": {
            "type": "field_match",
            "matchers": {
              "ParentCommandLine__contains": {
                "field": "ParentCommandLine",
                "value": [
                  "C:\\Program Files (x86)\\Dropbox\\Client\\",
                  "C:\\Program Files\\Dropbox\\Client\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1059"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Tim Rauch, Elastic (idea)",
        "date": "2022-09-28",
        "modified": "2025-03-06",
        "references": [
          "https://www.elastic.co/guide/en/security/current/conhost-spawned-by-suspicious-parent-process.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_conhost_uncommon_parent.yml"
      }
    },
    {
      "id": "9e50a8b3-dd05-4eb8-9153-bdb6b79d50b0",
      "title": "Msxsl.EXE Execution",
      "status": "test",
      "description": "Detects the execution of the MSXSL utility. This can be used to execute Extensible Stylesheet Language (XSL) files. These files are commonly used to describe the processing and rendering of data within XML files.\nAdversaries can abuse this functionality to execute arbitrary files while potentially bypassing application whitelisting defenses.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1220"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\msxsl.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1220"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Timur Zinniatullin, oscd.community",
        "date": "2019-10-21",
        "modified": "2023-11-09",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1220/T1220.md",
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Msxsl/"
        ],
        "falsepositives": [
          "Msxsl is not installed by default and is deprecated, so unlikely on most systems."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_msxsl_execution.yml"
      }
    },
    {
      "id": "fb843269-508c-4b76-8b8d-88679db22ce7",
      "title": "Suspicious Execution of Powershell with Base64",
      "status": "test",
      "description": "Commandline to launch powershell with a base64 payload",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\powershell.exe",
                  "\\pwsh.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -e ",
                  " -en ",
                  " -enc ",
                  " -enco",
                  " -ec "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_encoding": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -Encoding ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_azure": {
            "type": "field_match",
            "matchers": {
              "ParentImage__contains": {
                "field": "ParentImage",
                "value": [
                  "C:\\Packages\\Plugins\\Microsoft.GuestConfiguration.ConfigurationforWindows\\",
                  "\\gc_worker.exe"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-02",
        "modified": "2023-01-05",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1059.001/T1059.001.md#atomic-test-20---powershell-invoke-known-malicious-cmdlets",
          "https://unit42.paloaltonetworks.com/unit42-pulling-back-the-curtains-on-encodedcommand-powershell-attacks/",
          "https://mikefrobbins.com/2017/06/15/simple-obfuscation-with-powershell-using-base64-encoding/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_encode.yml"
      }
    },
    {
      "id": "a29808fd-ef50-49ff-9c7a-59a9b040b404",
      "title": "HackTool - Pypykatz Credentials Dumping Activity",
      "status": "test",
      "description": "Detects the usage of \"pypykatz\" to obtain stored credentials. Adversaries may attempt to extract credential material from the Security Account Manager (SAM) database through Windows registry where the SAM database is stored",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\pypykatz.exe",
                  "\\python.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "live",
                  "registry"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.002"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-05",
        "modified": "2023-02-05",
        "references": [
          "https://github.com/skelsec/pypykatz",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1003.002/T1003.002.md#atomic-test-2---registry-parse-with-pypykatz"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_pypykatz.yml"
      }
    },
    {
      "id": "cc268ac1-42d9-40fd-9ed3-8c4e1a5b87e6",
      "title": "Devtoolslauncher.exe Executes Specified Binary",
      "status": "test",
      "description": "The Devtoolslauncher.exe executes other binary",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\devtoolslauncher.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "LaunchForDeploy",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Beyu Denis, oscd.community (rule), @_felamos (idea)",
        "date": "2019-10-12",
        "modified": "2021-11-27",
        "references": [
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Devtoolslauncher/",
          "https://twitter.com/_felamos/status/1179811992841797632"
        ],
        "falsepositives": [
          "Legitimate use of devtoolslauncher.exe by legitimate user"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_devtoolslauncher.yml"
      }
    },
    {
      "id": "696bfb54-227e-4602-ac5b-30d9d2053312",
      "title": "Veeam Backup Database Suspicious Query",
      "status": "test",
      "description": "Detects potentially suspicious SQL queries using SQLCmd targeting the Veeam backup databases in order to steal information.",
      "level": "medium",
      "tags": [
        "attack.collection",
        "attack.t1005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_sql": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\sqlcmd.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "VeeamBackup",
                  "From "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_db": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "BackupRepositories",
                  "Backups",
                  "Credentials",
                  "HostCreds",
                  "SmbFileShares",
                  "Ssh_creds",
                  "VSphereInfo"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1005"
        ],
        "tactics": [
          "collection"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-04",
        "modified": "",
        "references": [
          "https://labs.withsecure.com/publications/fin7-target-veeam-servers"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sqlcmd_veeam_db_recon.yml"
      }
    },
    {
      "id": "cb0fe7c5-f3a3-484d-aa25-d350a7912729",
      "title": "Suspicious Driver/DLL Installation Via Odbcconf.EXE",
      "status": "test",
      "description": "Detects execution of \"odbcconf\" with the \"INSTALLDRIVER\" action where the driver doesn't contain a \".dll\" extension. This is often used as a defense evasion method.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.008"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\odbcconf.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "odbcconf.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "INSTALLDRIVER ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_dll_ext": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": ".dll",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_main_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.008"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-23",
        "modified": "",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Odbcconf/",
          "https://web.archive.org/web/20191023232753/https://twitter.com/Hexacorn/status/1187143326673330176",
          "https://www.hexacorn.com/blog/2020/08/23/odbcconf-lolbin-trifecta/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_odbcconf_driver_install_susp.yml"
      }
    },
    {
      "id": "80fc36aa-945e-4181-89f2-2f907ab6775d",
      "title": "UAC Bypass Using IEInstal - Process",
      "status": "test",
      "description": "Detects the pattern of UAC Bypass using IEInstal.exe (UACMe 64)",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "IntegrityLevel": {
                "field": "IntegrityLevel",
                "value": [
                  "High",
                  "System",
                  "S-1-16-16384",
                  "S-1-16-12288"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\ieinstal.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__contains": {
                "field": "Image",
                "value": "\\AppData\\Local\\Temp\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "consent.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Christian Burkard (Nextron Systems)",
        "date": "2021-08-30",
        "modified": "2024-12-01",
        "references": [
          "https://github.com/hfiref0x/UACME"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_uac_bypass_ieinstal.yml"
      }
    },
    {
      "id": "2a4b3e61-9d22-4e4a-b60f-6e8f0cde6f25",
      "title": "Potential Provisioning Registry Key Abuse For Binary Proxy Execution",
      "status": "test",
      "description": "Detects potential abuse of the provisioning registry key for indirect command execution through \"Provlaunch.exe\".",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "SOFTWARE\\Microsoft\\Provisioning\\Commands\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), Swachchhanda Shrawan Poudel",
        "date": "2023-08-08",
        "modified": "",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Provlaunch/",
          "https://twitter.com/0gtweet/status/1674399582162153472"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_registry_provlaunch_provisioning_command.yml"
      }
    },
    {
      "id": "a20391f8-76fb-437b-abc0-dba2df1952c6",
      "title": "Visual Studio NodejsTools PressAnyKey Arbitrary Binary Execution",
      "status": "test",
      "description": "Detects child processes of Microsoft.NodejsTools.PressAnyKey.exe that can be used to execute any other binary",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\Microsoft.NodejsTools.PressAnyKey.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-01-11",
        "modified": "2023-04-11",
        "references": [
          "https://twitter.com/mrd0x/status/1463526834918854661",
          "https://gist.github.com/nasbench/a989ce64cefa8081bd50cf6ad8c491b5"
        ],
        "falsepositives": [
          "Legitimate use by developers as part of NodeJS development with Visual Studio Tools"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pressanykey_lolbin_execution.yml"
      }
    },
    {
      "id": "224f140f-3553-4cd1-af78-13d81bf9f7cc",
      "title": "Potential RDP Session Hijacking Activity",
      "status": "test",
      "description": "Detects potential RDP Session Hijacking activity on Windows systems",
      "level": "medium",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\tscon.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "tscon.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_integrity": {
            "type": "field_match",
            "matchers": {
              "IntegrityLevel": {
                "field": "IntegrityLevel",
                "value": [
                  "System",
                  "S-1-16-16384"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "@juju4",
        "date": "2022-12-27",
        "modified": "2024-12-01",
        "references": [
          "https://twitter.com/Moti_B/status/909449115477659651"
        ],
        "falsepositives": [
          "Administrative activity"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_tscon_rdp_session_hijacking.yml"
      }
    },
    {
      "id": "869b9ca7-9ea2-4a5a-8325-e80e62f75445",
      "title": "Suspicious Child Process Of SQL Server",
      "status": "test",
      "description": "Detects suspicious child processes of the SQLServer process. This could indicate potential RCE or SQL Injection.",
      "level": "high",
      "tags": [
        "attack.t1505.003",
        "attack.t1190",
        "attack.initial-access",
        "attack.persistence",
        "attack.privilege-escalation"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\sqlservr.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\bash.exe",
                  "\\bitsadmin.exe",
                  "\\cmd.exe",
                  "\\netstat.exe",
                  "\\nltest.exe",
                  "\\ping.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\regsvr32.exe",
                  "\\rundll32.exe",
                  "\\sh.exe",
                  "\\systeminfo.exe",
                  "\\tasklist.exe",
                  "\\wsl.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_datev": {
            "type": "field_match",
            "matchers": {
              "ParentImage__startswith": {
                "field": "ParentImage",
                "value": "C:\\Program Files\\Microsoft SQL Server\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "DATEV_DBENGINE\\MSSQL\\Binn\\sqlservr.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\System32\\cmd.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "CommandLine__startswith": {
                "field": "CommandLine",
                "value": "\"C:\\Windows\\system32\\cmd.exe\" ",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1505.003",
          "T1190"
        ],
        "tactics": [
          "initial_access",
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "FPT.EagleEye Team, wagga",
        "date": "2020-12-11",
        "modified": "2023-05-04",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_mssql_susp_child_process.yml"
      }
    },
    {
      "id": "b471f462-eb0d-4832-be35-28d94bdb4780",
      "title": "Remote Access Tool - Renamed MeshAgent Execution - Windows",
      "status": "experimental",
      "description": "Detects the execution of a renamed instance of the Remote Monitoring and Management (RMM) tool, MeshAgent.\nRMM tools such as MeshAgent are commonly utilized by IT administrators for legitimate remote support and system management.\nHowever, malicious actors may exploit these tools by renaming them to bypass detection mechanisms, enabling unauthorized access and control over compromised systems.\n",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.defense-evasion",
        "attack.t1219.002",
        "attack.t1036.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_meshagent": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": "--meshServiceName",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName__contains": {
                    "field": "OriginalFileName",
                    "value": "meshagent",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_main_legitimate": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\meshagent.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection_meshagent and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_meshagent"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1219.002",
          "T1036.003"
        ],
        "tactics": [
          "command_and_control",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Norbert Jaśniewicz (AlphaSOC)",
        "date": "2025-05-19",
        "modified": "",
        "references": [
          "https://www.huntress.com/blog/know-thy-enemy-a-novel-november-case-on-persistent-remote-access",
          "https://thecyberexpress.com/ukraine-hit-by-meshagent-malware-campaign/",
          "https://wazuh.com/blog/how-to-detect-meshagent-with-wazuh/",
          "https://www.security.com/threat-intelligence/medusa-ransomware-attacks"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_remote_access_tools_renamed_meshagent_execution.yml"
      }
    },
    {
      "id": "c49c5062-0966-4170-9efd-9968c913a6cf",
      "title": "Stop Windows Service Via PowerShell Stop-Service",
      "status": "test",
      "description": "Detects the stopping of a Windows service via the PowerShell Cmdlet \"Stop-Service\"",
      "level": "low",
      "tags": [
        "attack.impact",
        "attack.t1489"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_sc_net_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "Stop-Service ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1489"
        ],
        "tactics": [
          "impact"
        ]
      },
      "meta": {
        "author": "Jakob Weinzettl, oscd.community, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-03-05",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.management/stop-service?view=powershell-7.4"
        ],
        "falsepositives": [
          "There are many legitimate reasons to stop a service. This rule isn't looking for any suspicious behaviour in particular. Filter legitimate activity accordingly"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_stop_service.yml"
      }
    },
    {
      "id": "85b0b087-eddf-4a2b-b033-d771fa2b9775",
      "title": "PowerShell Download and Execution Cradles",
      "status": "test",
      "description": "Detects PowerShell download and execution cradles.",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_download": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ".DownloadString(",
                  ".DownloadFile(",
                  "Invoke-WebRequest ",
                  "iwr ",
                  "Invoke-RestMethod ",
                  "irm "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_iex": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ";iex $",
                  "| IEX",
                  "|IEX ",
                  "I`E`X",
                  "I`EX",
                  "IE`X",
                  "iex ",
                  "IEX (",
                  "IEX(",
                  "Invoke-Expression"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-03-24",
        "modified": "2025-07-18",
        "references": [
          "https://github.com/VirtualAlllocEx/Payload-Download-Cradles/blob/88e8eca34464a547c90d9140d70e9866dcbc6a12/Download-Cradles.cmd",
          "https://labs.withsecure.com/publications/fin7-target-veeam-servers"
        ],
        "falsepositives": [
          "Some PowerShell installers were seen using similar combinations. Apply filters accordingly"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_download_iex.yml"
      }
    },
    {
      "id": "9386d78a-7207-4048-9c9f-a93a7c2d1c05",
      "title": "Code Execution via Pcwutl.dll",
      "status": "test",
      "description": "Detects launch of executable by calling the LaunchApplication function from pcwutl.dll library.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.011"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\rundll32.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "RUNDLL32.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "pcwutl",
                  "LaunchApplication"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.011"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Julia Fomina, oscd.community",
        "date": "2020-10-05",
        "modified": "2023-02-09",
        "references": [
          "https://lolbas-project.github.io/lolbas/Libraries/Pcwutl/",
          "https://twitter.com/harr0ey/status/989617817849876488"
        ],
        "falsepositives": [
          "Use of Program Compatibility Troubleshooter Helper"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_pcwutl.yml"
      }
    },
    {
      "id": "0ed99dda-6a35-11ef-8c99-0242ac120002",
      "title": "Attempts of Kerberos Coercion Via DNS SPN Spoofing",
      "status": "experimental",
      "description": "Detects the presence of \"UWhRC....AAYBAAAA\" pattern in command line.\nThe pattern \"1UWhRCAAAAA..BAAAA\" is a base64-encoded signature that corresponds to a marshaled CREDENTIAL_TARGET_INFORMATION structure.\nAttackers can use this technique to coerce authentication from victim systems to attacker-controlled hosts.\nIt is one of the strong indicators of a Kerberos coercion attack, where adversaries manipulate DNS records\nto spoof Service Principal Names (SPNs) and redirect authentication requests like in CVE-2025-33073.\nIf you see this pattern in the command line, it is likely an attempt to add spoofed Service Principal Names (SPNs) to DNS records,\nor checking for the presence of such records through the `nslookup` command.\n",
      "level": "high",
      "tags": [
        "attack.collection",
        "attack.credential-access",
        "attack.persistence",
        "attack.privilege-escalation",
        "attack.t1557.001",
        "attack.t1187"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "UWhRCA",
                  "BAAAA"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1557.001",
          "T1187"
        ],
        "tactics": [
          "collection",
          "credential_access",
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-06-20",
        "modified": "",
        "references": [
          "https://www.synacktiv.com/publications/ntlm-reflection-is-dead-long-live-ntlm-reflection-an-in-depth-analysis-of-cve-2025",
          "https://googleprojectzero.blogspot.com/2021/10/using-kerberos-for-authentication-relay.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_kerberos_coercion_via_dns_spn_spoofing.yml"
      }
    },
    {
      "id": "ce72ef99-22f1-43d4-8695-419dcb5d9330",
      "title": "Suspicious Windows Service Tampering",
      "status": "test",
      "description": "Detects the usage of binaries such as 'net', 'sc' or 'powershell' in order to stop, pause, disable or delete critical or important Windows services such as AV, Backup, etc. As seen being used in some ransomware scripts\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.impact",
        "attack.t1489",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_tools_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "net.exe",
                      "net1.exe",
                      "PowerShell_ISE.EXE",
                      "PowerShell.EXE",
                      "psservice.exe",
                      "pwsh.dll",
                      "sc.exe",
                      "wmic.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\net.exe",
                      "\\net1.exe",
                      "\\PowerShell_ISE.EXE",
                      "\\powershell.exe",
                      "\\PsService.exe",
                      "\\PsService64.exe",
                      "\\pwsh.exe",
                      "\\sc.exe",
                      "\\wmic.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_tools_cli": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      " delete ",
                      ".delete()",
                      " pause ",
                      " stop ",
                      "Stop-Service ",
                      "Remove-Service "
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "config",
                      "start=disabled"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_services": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "143Svc",
                  "Acronis VSS Provider",
                  "AcronisAgent",
                  "AcrSch2Svc",
                  "AdobeARMservice",
                  "AHS Service",
                  "Antivirus",
                  "Apache4",
                  "ARSM",
                  "aswBcc",
                  "AteraAgent",
                  "Avast Business Console Client Antivirus Service",
                  "avast! Antivirus",
                  "AVG Antivirus",
                  "avgAdminClient",
                  "AvgAdminServer",
                  "AVP1",
                  "BackupExec",
                  "bedbg",
                  "BITS",
                  "BrokerInfrastructure",
                  "CASLicenceServer",
                  "CASWebServer",
                  "Client Agent 7.60",
                  "Core Browsing Protection",
                  "Core Mail Protection",
                  "Core Scanning Server",
                  "DCAgent",
                  "dwmrcs",
                  "EhttpSr",
                  "ekrn",
                  "Enterprise Client Service",
                  "epag",
                  "EPIntegrationService",
                  "EPProtectedService",
                  "EPRedline",
                  "EPSecurityService",
                  "EPUpdateService",
                  "EraserSvc11710",
                  "EsgShKernel",
                  "ESHASRV",
                  "FA_Scheduler",
                  "FirebirdGuardianDefaultInstance",
                  "FirebirdServerDefaultInstance",
                  "FontCache3.0.0.0",
                  "HealthTLService",
                  "hmpalertsvc",
                  "HMS",
                  "HostControllerService",
                  "hvdsvc",
                  "IAStorDataMgrSvc",
                  "IBMHPS",
                  "ibmspsvc",
                  "IISAdmin",
                  "IMANSVC",
                  "IMAP4Svc",
                  "instance2",
                  "KAVFS",
                  "KAVFSGT",
                  "kavfsslp",
                  "KeyIso",
                  "klbackupdisk",
                  "klbackupflt",
                  "klflt",
                  "klhk",
                  "KLIF",
                  "klim6",
                  "klkbdflt",
                  "klmouflt",
                  "klnagent",
                  "klpd",
                  "kltap",
                  "KSDE1.0.0",
                  "LogProcessorService",
                  "M8EndpointAgent",
                  "macmnsvc",
                  "masvc",
                  "MBAMService",
                  "MBCloudEA",
                  "MBEndpointAgent",
                  "McAfeeDLPAgentService",
                  "McAfeeEngineService",
                  "MCAFEEEVENTPARSERSRV",
                  "McAfeeFramework",
                  "MCAFEETOMCATSRV530",
                  "McShield",
                  "McTaskManager",
                  "mfefire",
                  "mfemms",
                  "mfevto",
                  "mfevtp",
                  "mfewc",
                  "MMS",
                  "mozyprobackup",
                  "mpssvc",
                  "MSComplianceAudit",
                  "MSDTC",
                  "MsDtsServer",
                  "MSExchange",
                  "msftesq1SPROO",
                  "msftesql$PROD",
                  "msftesql$SQLEXPRESS",
                  "MSOLAP$SQL_2008",
                  "MSOLAP$SYSTEM_BGC",
                  "MSOLAP$TPS",
                  "MSOLAP$TPSAMA",
                  "MSOLAPSTPS",
                  "MSOLAPSTPSAMA",
                  "mssecflt",
                  "MSSQ!I.SPROFXENGAGEMEHT",
                  "MSSQ0SHAREPOINT",
                  "MSSQ0SOPHOS",
                  "MSSQL",
                  "MSSQLFDLauncher$",
                  "MySQL",
                  "NanoServiceMain",
                  "NetMsmqActivator",
                  "NetPipeActivator",
                  "netprofm",
                  "NetTcpActivator",
                  "NetTcpPortSharing",
                  "ntrtscan",
                  "nvspwmi",
                  "ofcservice",
                  "Online Protection System",
                  "OracleClientCache80",
                  "OracleDBConsole",
                  "OracleMTSRecoveryService",
                  "OracleOraDb11g_home1",
                  "OracleService",
                  "OracleVssWriter",
                  "osppsvc",
                  "PandaAetherAgent",
                  "PccNTUpd",
                  "PDVFSService",
                  "POP3Svc",
                  "postgresql-x64-9.4",
                  "POVFSService",
                  "PSUAService",
                  "Quick Update Service",
                  "RepairService",
                  "ReportServer",
                  "ReportServer$",
                  "RESvc",
                  "RpcEptMapper",
                  "sacsvr",
                  "SamSs",
                  "SAVAdminService",
                  "SAVService",
                  "ScSecSvc",
                  "SDRSVC",
                  "SearchExchangeTracing",
                  "sense",
                  "SentinelAgent",
                  "SentinelHelperService",
                  "SepMasterService",
                  "ShMonitor",
                  "Smcinst",
                  "SmcService",
                  "SMTPSvc",
                  "SNAC",
                  "SntpService",
                  "Sophos",
                  "SQ1SafeOLRService",
                  "SQL Backups",
                  "SQL Server",
                  "SQLAgent",
                  "SQLANYs_Sage_FAS_Fixed_Assets",
                  "SQLBrowser",
                  "SQLsafe",
                  "SQLSERVERAGENT",
                  "SQLTELEMETRY",
                  "SQLWriter",
                  "SSISTELEMETRY130",
                  "SstpSvc",
                  "storflt",
                  "svcGenericHost",
                  "swc_service",
                  "swi_filter",
                  "swi_service",
                  "swi_update",
                  "Symantec",
                  "sysmon",
                  "TeamViewer",
                  "Telemetryserver",
                  "ThreatLockerService",
                  "TMBMServer",
                  "TmCCSF",
                  "TmFilter",
                  "TMiCRCScanService",
                  "tmlisten",
                  "TMLWCSService",
                  "TmPfw",
                  "TmPreFilter",
                  "TmProxy",
                  "TMSmartRelayService",
                  "tmusa",
                  "Tomcat",
                  "Trend Micro Deep Security Manager",
                  "TrueKey",
                  "UFNet",
                  "UI0Detect",
                  "UniFi",
                  "UTODetect",
                  "vds",
                  "Veeam",
                  "VeeamDeploySvc",
                  "Veritas System Recovery",
                  "vmic",
                  "VMTools",
                  "vmvss",
                  "VSApiNt",
                  "VSS",
                  "W3Svc",
                  "wbengine",
                  "WdNisSvc",
                  "WeanClOudSve",
                  "Weems JY",
                  "WinDefend",
                  "wmms",
                  "wozyprobackup",
                  "WPFFontCache_v0400",
                  "WRSVC",
                  "wsbexchange",
                  "WSearch",
                  "wscsvc",
                  "Zoolz 2 Service"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1489",
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion",
          "impact"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), frack113 , X__Junior (Nextron Systems)",
        "date": "2022-09-01",
        "modified": "2025-08-27",
        "references": [
          "https://www.trendmicro.com/content/dam/trendmicro/global/en/research/22/h/ransomware-actor-abuses-genshin-impact-anti-cheat-driver-to-kill-antivirus/Genshin%20Impact%20Figure%2010.jpg",
          "https://www.trellix.com/en-sg/about/newsroom/stories/threat-labs/lockergoga-ransomware-family-used-in-targeted-attacks.html",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md",
          "https://research.nccgroup.com/2022/08/19/back-in-black-unlocking-a-lockbit-3-0-ransomware-attack/",
          "https://www.virustotal.com/gui/file/38283b775552da8981452941ea74191aa0d203edd3f61fb2dee7b0aea3514955",
          "https://learn.microsoft.com/en-us/windows/win32/cimwin32prov/delete-method-in-class-win32-service"
        ],
        "falsepositives": [
          "Administrators or tools shutting down the services due to upgrade or removal purposes. If you experience some false positive, please consider adding filters to the parent process launching this command and not removing the entry"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_service_tamper.yml"
      }
    },
    {
      "id": "b36d01a3-ddaf-4804-be18-18a6247adfcd",
      "title": "Add Windows Capability Via PowerShell Cmdlet",
      "status": "test",
      "description": "Detects usage of the \"Add-WindowsCapability\" cmdlet to add Windows capabilities. Notable capabilities could be \"OpenSSH\" and others.",
      "level": "medium",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cmdlet": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "Add-WindowsCapability",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_capa": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "OpenSSH.",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-01-22",
        "modified": "2023-05-09",
        "references": [
          "https://learn.microsoft.com/en-us/windows-server/administration/openssh/openssh_install_firstuse?tabs=powershell",
          "https://www.virustotal.com/gui/file/af1c82237b6e5a3a7cdbad82cc498d298c67845d92971bada450023d1335e267/content"
        ],
        "falsepositives": [
          "Legitimate usage of the capabilities by administrators or users. Add additional filters accordingly."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_add_windows_capability.yml"
      }
    },
    {
      "id": "d81871ef-5738-47ab-9797-7a9c90cd4bfb",
      "title": "Php Inline Command Execution",
      "status": "test",
      "description": "Detects execution of php using the \"-r\" flag. This is could be used as a way to launch a reverse shell or execute live php code.",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\php.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "php.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -r",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-01-02",
        "modified": "",
        "references": [
          "https://www.php.net/manual/en/features.commandline.php",
          "https://www.revshells.com/",
          "https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_php_inline_command_execution.yml"
      }
    },
    {
      "id": "5cddf373-ef00-4112-ad72-960ac29bac34",
      "title": "HackTool - Koadic Execution",
      "status": "test",
      "description": "Detects command line parameters used by Koadic hack tool",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059.003",
        "attack.t1059.005",
        "attack.t1059.007"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\cmd.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "Cmd.Exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/q",
                  "/c",
                  "chcp"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.003",
          "T1059.005",
          "T1059.007"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "wagga, Jonhnathan Ribeiro, oscd.community",
        "date": "2020-01-12",
        "modified": "2023-02-11",
        "references": [
          "https://unit42.paloaltonetworks.com/unit42-sofacy-groups-parallel-attacks/",
          "https://github.com/offsecginger/koadic/blob/457f9a3ff394c989cdb4c599ab90eb34fb2c762c/data/stager/js/stdlib.js",
          "https://blog.f-secure.com/hunting-for-koadic-a-com-based-rootkit/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_koadic.yml"
      }
    },
    {
      "id": "7e6237fe-3ddb-438f-9381-9bf9de5af8d0",
      "title": "Windows Internet Hosted WebDav Share Mount Via Net.EXE",
      "status": "test",
      "description": "Detects when an internet hosted webdav share is mounted using the \"net.exe\" utility",
      "level": "high",
      "tags": [
        "attack.lateral-movement",
        "attack.t1021.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\net.exe",
                      "\\net1.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "net.exe",
                      "net1.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " use ",
                  " http"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1021.002"
        ],
        "tactics": [
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-02-21",
        "modified": "2023-07-25",
        "references": [
          "https://drive.google.com/file/d/1lKya3_mLnR3UQuCoiYruO3qgu052_iS_/view"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_net_use_mount_internet_share.yml"
      }
    },
    {
      "id": "d474c8fe-bb69-4ea0-b7d9-f682b56d52d3",
      "title": "HackTool - Doppelanger LSASS Dumper Execution",
      "status": "experimental",
      "description": "Detects the execution of the Doppelanger hacktool which is used to dump LSASS memory via process cloning while evading common detection methods",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\Doppelganger.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Hashes__contains": {
                    "field": "Hashes",
                    "value": [
                      "IMPHASH=AB94D5217896ADCD765A06B2D52F0AEB",
                      "IMPHASH=65F0EA61156EE0C2A35421926F0C7F78"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.001"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-07-01",
        "modified": "",
        "references": [
          "https://labs.yarix.com/2025/06/doppelganger-an-advanced-lsass-dumper-with-process-cloning/",
          "https://github.com/vari-sh/RedTeamGrimoire/tree/668e0357072546065729ad623f8c02f7be21bb08/Doppelganger"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_doppelganger.yml"
      }
    },
    {
      "id": "4a30ac0c-b9d6-4e01-b71a-5f851bbf4259",
      "title": "Potential Defense Evasion Activity Via Emoji Usage In CommandLine - 1",
      "status": "test",
      "description": "Detects the usage of emojis in the command line, this could be a sign of potential defense evasion activity.",
      "level": "high",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "😀",
                  "😃",
                  "😄",
                  "😁",
                  "😆",
                  "😅",
                  "😂",
                  "🤣",
                  "🥲",
                  "🥹",
                  "☺️",
                  "😊",
                  "😇",
                  "🙂",
                  "🙃",
                  "😉",
                  "😌",
                  "😍",
                  "🥰",
                  "😘",
                  "😗",
                  "😙",
                  "😚",
                  "😋",
                  "😛",
                  "😝",
                  "😜",
                  "🤪",
                  "🤨",
                  "🧐",
                  "🤓",
                  "😎",
                  "🥸",
                  "🤩",
                  "🥳",
                  "😏",
                  "😒",
                  "😞",
                  "😔",
                  "😟",
                  "😕",
                  "🙁",
                  "☹️",
                  "😣",
                  "😖",
                  "😫",
                  "😩",
                  "🥺",
                  "😢",
                  "😭",
                  "😮‍💨",
                  "😤",
                  "😠",
                  "😡",
                  "🤬",
                  "🤯",
                  "😳",
                  "🥵",
                  "🥶",
                  "😱",
                  "😨",
                  "😰",
                  "😥",
                  "😓",
                  "🫣",
                  "🤗",
                  "🫡",
                  "🤔",
                  "🫢",
                  "🤭",
                  "🤫",
                  "🤥",
                  "😶",
                  "😶‍🌫️",
                  "😐",
                  "😑",
                  "😬",
                  "🫠",
                  "🙄",
                  "😯",
                  "😦",
                  "😧",
                  "😮",
                  "😲",
                  "🥱",
                  "😴",
                  "🤤",
                  "😪",
                  "😵",
                  "😵‍💫",
                  "🫥",
                  "🤐",
                  "🥴",
                  "🤢",
                  "🤮",
                  "🤧",
                  "😷",
                  "🤒",
                  "🤕",
                  "🤑",
                  "🤠",
                  "😈",
                  "👿",
                  "👹",
                  "👺",
                  "🤡",
                  "💩",
                  "👻",
                  "💀",
                  "☠️",
                  "👽",
                  "👾",
                  "🤖",
                  "🎃",
                  "😺",
                  "😸",
                  "😹",
                  "😻",
                  "😼",
                  "😽",
                  "🙀",
                  "😿",
                  "😾",
                  "👋",
                  "🤚",
                  "🖐",
                  "✋",
                  "🖖",
                  "👌",
                  "🤌",
                  "🤏",
                  "✌️",
                  "🤞",
                  "🫰",
                  "🤟",
                  "🤘",
                  "🤙",
                  "🫵",
                  "🫱",
                  "🫲",
                  "🫳",
                  "🫴",
                  "👈",
                  "👉",
                  "👆",
                  "🖕",
                  "👇",
                  "☝️",
                  "👍",
                  "👎",
                  "✊",
                  "👊",
                  "🤛",
                  "🤜",
                  "👏",
                  "🫶",
                  "🙌",
                  "👐",
                  "🤲",
                  "🤝",
                  "🙏",
                  "✍️",
                  "💪",
                  "🦾",
                  "🦵",
                  "🦿",
                  "🦶",
                  "👣",
                  "👂",
                  "🦻",
                  "👃",
                  "🫀",
                  "🫁",
                  "🧠",
                  "🦷",
                  "🦴",
                  "👀",
                  "👁",
                  "👅",
                  "👄",
                  "🫦",
                  "💋",
                  "🩸",
                  "👶",
                  "👧",
                  "🧒",
                  "👦",
                  "👩",
                  "🧑",
                  "👨",
                  "👩‍🦱",
                  "🧑‍🦱",
                  "👨‍🦱",
                  "👩‍🦰",
                  "🧑‍🦰",
                  "👨‍🦰",
                  "👱‍♀️",
                  "👱",
                  "👱‍♂️",
                  "👩‍🦳",
                  "🧑‍🦳",
                  "👨‍🦳",
                  "👩‍🦲",
                  "🧑‍🦲",
                  "👨‍🦲",
                  "🧔‍♀️",
                  "🧔",
                  "🧔‍♂️",
                  "👵",
                  "🧓",
                  "👴",
                  "👲",
                  "👳‍♀️",
                  "👳",
                  "👳‍♂️",
                  "🧕",
                  "👮‍♀️",
                  "👮",
                  "👮‍♂️",
                  "👷‍♀️",
                  "👷",
                  "👷‍♂️",
                  "💂‍♀️",
                  "💂",
                  "💂‍♂️",
                  "🕵️‍♀️",
                  "🕵️",
                  "🕵️‍♂️",
                  "👩‍⚕️",
                  "🧑‍⚕️",
                  "👨‍⚕️",
                  "👩‍🌾",
                  "🧑‍🌾",
                  "👨‍🌾",
                  "👩‍🍳",
                  "🧑‍🍳",
                  "👨‍🍳",
                  "👩‍🎓",
                  "🧑‍🎓",
                  "👨‍🎓",
                  "👩‍🎤",
                  "🧑‍🎤",
                  "👨‍🎤",
                  "👩‍🏫",
                  "🧑‍🏫",
                  "👨‍🏫",
                  "👩‍🏭",
                  "🧑‍🏭",
                  "👨‍🏭",
                  "👩‍💻",
                  "🧑‍💻",
                  "👨‍💻",
                  "👩‍💼",
                  "🧑‍💼",
                  "👨‍💼",
                  "👩‍🔧",
                  "🧑‍🔧",
                  "👨‍🔧",
                  "👩‍🔬",
                  "🧑‍🔬",
                  "👨‍🔬",
                  "👩‍🎨",
                  "🧑‍🎨",
                  "👨‍🎨",
                  "👩‍🚒",
                  "🧑‍🚒",
                  "👨‍🚒",
                  "👩‍✈️",
                  "🧑‍✈️",
                  "👨‍✈️",
                  "👩‍🚀",
                  "🧑‍🚀",
                  "👨‍🚀",
                  "👩‍⚖️",
                  "🧑‍⚖️",
                  "👨‍⚖️",
                  "👰‍♀️",
                  "👰",
                  "👰‍♂️",
                  "🤵‍♀️",
                  "🤵",
                  "🤵‍♂️",
                  "👸",
                  "🫅",
                  "🤴",
                  "🥷",
                  "🦸‍♀️",
                  "🦸",
                  "🦸‍♂️",
                  "🦹‍♀️",
                  "🦹",
                  "🦹‍♂️",
                  "🤶",
                  "🧑‍🎄",
                  "🎅",
                  "🧙‍♀️",
                  "🧙",
                  "🧙‍♂️",
                  "🧝‍♀️",
                  "🧝",
                  "🧝‍♂️",
                  "🧛‍♀️",
                  "🧛",
                  "🧛‍♂️",
                  "🧟‍♀️",
                  "🧟",
                  "🧟‍♂️",
                  "🧞‍♀️",
                  "🧞",
                  "🧞‍♂️",
                  "🧜‍♀️",
                  "🧜",
                  "🧜‍♂️",
                  "🧚‍♀️",
                  "🧚",
                  "🧚‍♂️",
                  "🧌",
                  "👼",
                  "🤰",
                  "🫄",
                  "🫃",
                  "🤱",
                  "👩‍🍼",
                  "🧑‍🍼",
                  "👨‍🍼",
                  "🙇‍♀️",
                  "🙇",
                  "🙇‍♂️",
                  "💁‍♀️",
                  "💁",
                  "💁‍♂️",
                  "🙅‍♀️",
                  "🙅",
                  "🙅‍♂️",
                  "🙆‍♀️",
                  "🙆",
                  "🙆‍♂️",
                  "🙋‍♀️",
                  "🙋",
                  "🙋‍♂️",
                  "🧏‍♀️",
                  "🧏",
                  "🧏‍♂️",
                  "🤦‍♀️",
                  "🤦",
                  "🤦‍♂️",
                  "🤷‍♀️",
                  "🤷",
                  "🤷‍♂️",
                  "🙎‍♀️",
                  "🙎",
                  "🙎‍♂️",
                  "🙍‍♀️",
                  "🙍",
                  "🙍‍♂️",
                  "💇‍♀️",
                  "💇",
                  "💇‍♂️",
                  "💆‍♀️",
                  "💆",
                  "💆‍♂️",
                  "🧖‍♀️",
                  "🧖",
                  "🧖‍♂️",
                  "💅",
                  "💃",
                  "🕺",
                  "👯‍♀️",
                  "👯",
                  "👯‍♂️",
                  "🕴",
                  "👩‍🦽",
                  "🧑‍🦽",
                  "👨‍🦽",
                  "👩‍🦼",
                  "🧑‍🦼",
                  "👨‍🦼",
                  "🚶‍♀️",
                  "🚶",
                  "🚶‍♂️",
                  "👩‍🦯",
                  "🧑‍🦯",
                  "👨‍🦯",
                  "🧎‍♀️",
                  "🧎",
                  "🧎‍♂️",
                  "🏃‍♀️",
                  "🏃",
                  "🏃‍♂️",
                  "🧍‍♀️",
                  "🧍",
                  "🧍‍♂️",
                  "👭",
                  "🧑‍🤝‍🧑",
                  "👬",
                  "👫",
                  "👩‍❤️‍👩",
                  "💑",
                  "👨‍❤️‍👨",
                  "👩‍❤️‍👨",
                  "👩‍❤️‍💋‍👩",
                  "💏",
                  "👨‍❤️‍💋‍👨",
                  "👩‍❤️‍💋‍👨",
                  "👪",
                  "👨‍👩‍👦",
                  "👨‍👩‍👧",
                  "👨‍👩‍👧‍👦",
                  "👨‍👩‍👦‍👦",
                  "👨‍👩‍👧‍👧",
                  "👨‍👨‍👦",
                  "👨‍👨‍👧",
                  "👨‍👨‍👧‍👦",
                  "👨‍👨‍👦‍👦",
                  "👨‍👨‍👧‍👧",
                  "👩‍👩‍👦",
                  "👩‍👩‍👧",
                  "👩‍👩‍👧‍👦",
                  "👩‍👩‍👦‍👦",
                  "👩‍👩‍👧‍👧",
                  "👨‍👦",
                  "👨‍👦‍👦",
                  "👨‍👧",
                  "👨‍👧‍👦",
                  "👨‍👧‍👧",
                  "👩‍👦",
                  "👩‍👦‍👦",
                  "👩‍👧",
                  "👩‍👧‍👦",
                  "👩‍👧‍👧",
                  "🗣",
                  "👤",
                  "👥",
                  "🫂",
                  "🧳",
                  "🌂",
                  "☂️",
                  "🧵",
                  "🪡",
                  "🪢",
                  "🧶",
                  "👓",
                  "🕶",
                  "🥽",
                  "🥼",
                  "🦺",
                  "👔",
                  "👕",
                  "👖",
                  "🧣",
                  "🧤",
                  "🧥",
                  "🧦",
                  "👗",
                  "👘",
                  "🥻",
                  "🩴",
                  "🩱",
                  "🩲",
                  "🩳",
                  "👙",
                  "👚",
                  "👛",
                  "👜",
                  "👝",
                  "🎒",
                  "👞",
                  "👟",
                  "🥾",
                  "🥿",
                  "👠",
                  "👡",
                  "🩰",
                  "👢",
                  "👑",
                  "👒",
                  "🎩",
                  "🎓",
                  "🧢",
                  "⛑",
                  "🪖",
                  "💄",
                  "💍",
                  "💼",
                  "👋🏻",
                  "🤚🏻",
                  "🖐🏻",
                  "✋🏻",
                  "🖖🏻",
                  "👌🏻",
                  "🤌🏻",
                  "🤏🏻",
                  "✌🏻",
                  "🤞🏻",
                  "🫰🏻",
                  "🤟🏻",
                  "🤘🏻",
                  "🤙🏻",
                  "🫵🏻",
                  "🫱🏻",
                  "🫲🏻",
                  "🫳🏻",
                  "🫴🏻",
                  "👈🏻",
                  "👉🏻",
                  "👆🏻",
                  "🖕🏻",
                  "👇🏻",
                  "☝🏻",
                  "👍🏻",
                  "👎🏻",
                  "✊🏻",
                  "👊🏻",
                  "🤛🏻",
                  "🤜🏻",
                  "👏🏻",
                  "🫶🏻",
                  "🙌🏻",
                  "👐🏻",
                  "🤲🏻",
                  "🙏🏻",
                  "✍🏻",
                  "💪🏻",
                  "🦵🏻",
                  "🦶🏻",
                  "👂🏻",
                  "🦻🏻",
                  "👃🏻",
                  "👶🏻",
                  "👧🏻",
                  "🧒🏻",
                  "👦🏻",
                  "👩🏻",
                  "🧑🏻",
                  "👨🏻",
                  "👩🏻‍🦱",
                  "🧑🏻‍🦱",
                  "👨🏻‍🦱",
                  "👩🏻‍🦰",
                  "🧑🏻‍🦰",
                  "👨🏻‍🦰",
                  "👱🏻‍♀️",
                  "👱🏻",
                  "👱🏻‍♂️",
                  "👩🏻‍🦳",
                  "🧑🏻‍🦳",
                  "👨🏻‍🦳",
                  "👩🏻‍🦲",
                  "🧑🏻‍🦲",
                  "👨🏻‍🦲",
                  "🧔🏻‍♀️",
                  "🧔🏻",
                  "🧔🏻‍♂️",
                  "👵🏻",
                  "🧓🏻",
                  "👴🏻",
                  "👲🏻",
                  "👳🏻‍♀️",
                  "👳🏻",
                  "👳🏻‍♂️",
                  "🧕🏻",
                  "👮🏻‍♀️",
                  "👮🏻",
                  "👮🏻‍♂️",
                  "👷🏻‍♀️",
                  "👷🏻",
                  "👷🏻‍♂️",
                  "💂🏻‍♀️",
                  "💂🏻",
                  "💂🏻‍♂️",
                  "🕵🏻‍♀️",
                  "🕵🏻",
                  "🕵🏻‍♂️",
                  "👩🏻‍⚕️",
                  "🧑🏻‍⚕️",
                  "👨🏻‍⚕️",
                  "👩🏻‍🌾",
                  "🧑🏻‍🌾",
                  "👨🏻‍🌾",
                  "👩🏻‍🍳",
                  "🧑🏻‍🍳",
                  "👨🏻‍🍳",
                  "👩🏻‍🎓",
                  "🧑🏻‍🎓",
                  "👨🏻‍🎓",
                  "👩🏻‍🎤",
                  "🧑🏻‍🎤",
                  "👨🏻‍🎤",
                  "👩🏻‍🏫",
                  "🧑🏻‍🏫",
                  "👨🏻‍🏫",
                  "👩🏻‍🏭",
                  "🧑🏻‍🏭",
                  "👨🏻‍🏭",
                  "👩🏻‍💻",
                  "🧑🏻‍💻",
                  "👨🏻‍💻",
                  "👩🏻‍💼",
                  "🧑🏻‍💼",
                  "👨🏻‍💼",
                  "👩🏻‍🔧",
                  "🧑🏻‍🔧",
                  "👨🏻‍🔧",
                  "👩🏻‍🔬",
                  "🧑🏻‍🔬",
                  "👨🏻‍🔬",
                  "👩🏻‍🎨",
                  "🧑🏻‍🎨",
                  "👨🏻‍🎨",
                  "👩🏻‍🚒",
                  "🧑🏻‍🚒",
                  "👨🏻‍🚒",
                  "👩🏻‍✈️",
                  "🧑🏻‍✈️",
                  "👨🏻‍✈️",
                  "👩🏻‍🚀",
                  "🧑🏻‍🚀",
                  "👨🏻‍🚀",
                  "👩🏻‍⚖️",
                  "🧑🏻‍⚖️",
                  "👨🏻‍⚖️",
                  "👰🏻‍♀️",
                  "👰🏻",
                  "👰🏻‍♂️",
                  "🤵🏻‍♀️",
                  "🤵🏻",
                  "🤵🏻‍♂️",
                  "👸🏻",
                  "🫅🏻",
                  "🤴🏻",
                  "🥷🏻",
                  "🦸🏻‍♀️",
                  "🦸🏻",
                  "🦸🏻‍♂️",
                  "🦹🏻‍♀️",
                  "🦹🏻",
                  "🦹🏻‍♂️",
                  "🤶🏻",
                  "🧑🏻‍🎄",
                  "🎅🏻",
                  "🧙🏻‍♀️",
                  "🧙🏻",
                  "🧙🏻‍♂️",
                  "🧝🏻‍♀️",
                  "🧝🏻",
                  "🧝🏻‍♂️",
                  "🧛🏻‍♀️",
                  "🧛🏻",
                  "🧛🏻‍♂️",
                  "🧜🏻‍♀️",
                  "🧜🏻",
                  "🧜🏻‍♂️",
                  "🧚🏻‍♀️",
                  "🧚🏻",
                  "🧚🏻‍♂️",
                  "👼🏻",
                  "🤰🏻",
                  "🫄🏻",
                  "🫃🏻",
                  "🤱🏻",
                  "👩🏻‍🍼",
                  "🧑🏻‍🍼",
                  "👨🏻‍🍼",
                  "🙇🏻‍♀️",
                  "🙇🏻",
                  "🙇🏻‍♂️",
                  "💁🏻‍♀️",
                  "💁🏻",
                  "💁🏻‍♂️",
                  "🙅🏻‍♀️",
                  "🙅🏻",
                  "🙅🏻‍♂️",
                  "🙆🏻‍♀️",
                  "🙆🏻",
                  "🙆🏻‍♂️",
                  "🙋🏻‍♀️",
                  "🙋🏻",
                  "🙋🏻‍♂️",
                  "🧏🏻‍♀️",
                  "🧏🏻",
                  "🧏🏻‍♂️",
                  "🤦🏻‍♀️",
                  "🤦🏻",
                  "🤦🏻‍♂️",
                  "🤷🏻‍♀️",
                  "🤷🏻",
                  "🤷🏻‍♂️",
                  "🙎🏻‍♀️",
                  "🙎🏻",
                  "🙎🏻‍♂️",
                  "🙍🏻‍♀️",
                  "🙍🏻",
                  "🙍🏻‍♂️",
                  "💇🏻‍♀️",
                  "💇🏻",
                  "💇🏻‍♂️",
                  "💆🏻‍♀️",
                  "💆🏻",
                  "💆🏻‍♂️",
                  "🧖🏻‍♀️",
                  "🧖🏻",
                  "🧖🏻‍♂️",
                  "💃🏻",
                  "🕺🏻",
                  "🕴🏻",
                  "👩🏻‍🦽",
                  "🧑🏻‍🦽",
                  "👨🏻‍🦽",
                  "👩🏻‍🦼",
                  "🧑🏻‍🦼",
                  "👨🏻‍🦼",
                  "🚶🏻‍♀️",
                  "🚶🏻",
                  "🚶🏻‍♂️",
                  "👩🏻‍🦯",
                  "🧑🏻‍🦯",
                  "👨🏻‍🦯",
                  "🧎🏻‍♀️",
                  "🧎🏻",
                  "🧎🏻‍♂️",
                  "🏃🏻‍♀️",
                  "🏃🏻",
                  "🏃🏻‍♂️",
                  "🧍🏻‍♀️",
                  "🧍🏻",
                  "🧍🏻‍♂️",
                  "👭🏻",
                  "🧑🏻‍🤝‍🧑🏻",
                  "👬🏻",
                  "👫🏻",
                  "🧗🏻‍♀️",
                  "🧗🏻",
                  "🧗🏻‍♂️",
                  "🏇🏻",
                  "🏂🏻",
                  "🏌🏻‍♀️",
                  "🏌🏻",
                  "🏌🏻‍♂️",
                  "🏄🏻‍♀️",
                  "🏄🏻",
                  "🏄🏻‍♂️",
                  "🚣🏻‍♀️",
                  "🚣🏻",
                  "🚣🏻‍♂️",
                  "🏊🏻‍♀️",
                  "🏊🏻",
                  "🏊🏻‍♂️",
                  "⛹🏻‍♀️",
                  "⛹🏻",
                  "⛹🏻‍♂️",
                  "🏋🏻‍♀️",
                  "🏋🏻",
                  "🏋🏻‍♂️",
                  "🚴🏻‍♀️",
                  "🚴🏻",
                  "🚴🏻‍♂️",
                  "🚵🏻‍♀️",
                  "🚵🏻",
                  "🚵🏻‍♂️",
                  "🤸🏻‍♀️",
                  "🤸🏻",
                  "🤸🏻‍♂️",
                  "🤽🏻‍♀️",
                  "🤽🏻",
                  "🤽🏻‍♂️",
                  "🤾🏻‍♀️",
                  "🤾🏻",
                  "🤾🏻‍♂️",
                  "🤹🏻‍♀️",
                  "🤹🏻",
                  "🤹🏻‍♂️",
                  "🧘🏻‍♀️",
                  "🧘🏻",
                  "🧘🏻‍♂️",
                  "🛀🏻",
                  "🛌🏻",
                  "👋🏼",
                  "🤚🏼",
                  "🖐🏼",
                  "✋🏼",
                  "🖖🏼",
                  "👌🏼",
                  "🤌🏼",
                  "🤏🏼",
                  "✌🏼",
                  "🤞🏼",
                  "🫰🏼",
                  "🤟🏼",
                  "🤘🏼",
                  "🤙🏼",
                  "🫵🏼",
                  "🫱🏼",
                  "🫲🏼",
                  "🫳🏼",
                  "🫴🏼",
                  "👈🏼",
                  "👉🏼",
                  "👆🏼",
                  "🖕🏼",
                  "👇🏼",
                  "☝🏼",
                  "👍🏼",
                  "👎🏼",
                  "✊🏼",
                  "👊🏼",
                  "🤛🏼",
                  "🤜🏼",
                  "👏🏼",
                  "🫶🏼",
                  "🙌🏼",
                  "👐🏼",
                  "🤲🏼",
                  "🙏🏼",
                  "✍🏼",
                  "💪🏼",
                  "🦵🏼",
                  "🦶🏼",
                  "👂🏼",
                  "🦻🏼",
                  "👃🏼",
                  "👶🏼",
                  "👧🏼",
                  "🧒🏼",
                  "👦🏼",
                  "👩🏼",
                  "🧑🏼",
                  "👨🏼",
                  "👩🏼‍🦱",
                  "🧑🏼‍🦱",
                  "👨🏼‍🦱",
                  "👩🏼‍🦰",
                  "🧑🏼‍🦰",
                  "👨🏼‍🦰",
                  "👱🏼‍♀️",
                  "👱🏼",
                  "👱🏼‍♂️",
                  "👩🏼‍🦳",
                  "🧑🏼‍🦳",
                  "👨🏼‍🦳",
                  "👩🏼‍🦲",
                  "🧑🏼‍🦲",
                  "👨🏼‍🦲",
                  "🧔🏼‍♀️",
                  "🧔🏼",
                  "🧔🏼‍♂️",
                  "👵🏼",
                  "🧓🏼",
                  "👴🏼",
                  "👲🏼",
                  "👳🏼‍♀️",
                  "👳🏼",
                  "👳🏼‍♂️",
                  "🧕🏼",
                  "👮🏼‍♀️",
                  "👮🏼",
                  "👮🏼‍♂️",
                  "👷🏼‍♀️",
                  "👷🏼",
                  "👷🏼‍♂️",
                  "💂🏼‍♀️",
                  "💂🏼",
                  "💂🏼‍♂️",
                  "🕵🏼‍♀️",
                  "🕵🏼",
                  "🕵🏼‍♂️",
                  "👩🏼‍⚕️",
                  "🧑🏼‍⚕️",
                  "👨🏼‍⚕️",
                  "👩🏼‍🌾",
                  "🧑🏼‍🌾",
                  "👨🏼‍🌾",
                  "👩🏼‍🍳",
                  "🧑🏼‍🍳",
                  "👨🏼‍🍳",
                  "👩🏼‍🎓",
                  "🧑🏼‍🎓",
                  "👨🏼‍🎓",
                  "👩🏼‍🎤",
                  "🧑🏼‍🎤",
                  "👨🏼‍🎤",
                  "👩🏼‍🏫",
                  "🧑🏼‍🏫",
                  "👨🏼‍🏫",
                  "👩🏼‍🏭",
                  "🧑🏼‍🏭",
                  "👨🏼‍🏭",
                  "👩🏼‍💻",
                  "🧑🏼‍💻",
                  "👨🏼‍💻",
                  "👩🏼‍💼",
                  "🧑🏼‍💼",
                  "👨🏼‍💼",
                  "👩🏼‍🔧",
                  "🧑🏼‍🔧",
                  "👨🏼‍🔧",
                  "👩🏼‍🔬",
                  "🧑🏼‍🔬",
                  "👨🏼‍🔬",
                  "👩🏼‍🎨",
                  "🧑🏼‍🎨",
                  "👨🏼‍🎨",
                  "👩🏼‍🚒",
                  "🧑🏼‍🚒",
                  "👨🏼‍🚒",
                  "👩🏼‍✈️",
                  "🧑🏼‍✈️",
                  "👨🏼‍✈️",
                  "👩🏼‍🚀",
                  "🧑🏼‍🚀",
                  "👨🏼‍🚀",
                  "👩🏼‍⚖️",
                  "🧑🏼‍⚖️",
                  "👨🏼‍⚖️",
                  "👰🏼‍♀️",
                  "👰🏼",
                  "👰🏼‍♂️",
                  "🤵🏼‍♀️",
                  "🤵🏼",
                  "🤵🏼‍♂️",
                  "👸🏼",
                  "🫅🏼",
                  "🤴🏼",
                  "🥷🏼",
                  "🦸🏼‍♀️",
                  "🦸🏼",
                  "🦸🏼‍♂️",
                  "🦹🏼‍♀️",
                  "🦹🏼",
                  "🦹🏼‍♂️",
                  "🤶🏼",
                  "🧑🏼‍🎄",
                  "🎅🏼",
                  "🧙🏼‍♀️",
                  "🧙🏼",
                  "🧙🏼‍♂️",
                  "🧝🏼‍♀️",
                  "🧝🏼",
                  "🧝🏼‍♂️",
                  "🧛🏼‍♀️",
                  "🧛🏼",
                  "🧛🏼‍♂️",
                  "🧜🏼‍♀️",
                  "🧜🏼",
                  "🧜🏼‍♂️",
                  "🧚🏼‍♀️",
                  "🧚🏼",
                  "🧚🏼‍♂️",
                  "👼🏼",
                  "🤰🏼",
                  "🫄🏼",
                  "🫃🏼",
                  "🤱🏼",
                  "👩🏼‍🍼",
                  "🧑🏼‍🍼",
                  "👨🏼‍🍼",
                  "🙇🏼‍♀️",
                  "🙇🏼",
                  "🙇🏼‍♂️",
                  "💁🏼‍♀️",
                  "💁🏼",
                  "💁🏼‍♂️",
                  "🙅🏼‍♀️",
                  "🙅🏼",
                  "🙅🏼‍♂️",
                  "🙆🏼‍♀️",
                  "🙆🏼",
                  "🙆🏼‍♂️",
                  "🙋🏼‍♀️",
                  "🙋🏼",
                  "🙋🏼‍♂️",
                  "🧏🏼‍♀️",
                  "🧏🏼",
                  "🧏🏼‍♂️",
                  "🤦🏼‍♀️",
                  "🤦🏼",
                  "🤦🏼‍♂️",
                  "🤷🏼‍♀️"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "@Kostastsale, TheDFIRReport",
        "date": "2022-12-05",
        "modified": "",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_emoji_usage_in_cli_1.yml"
      }
    },
    {
      "id": "ff3b6b39-e765-42f9-bb2c-ea6761e0e0f6",
      "title": "Mstsc.EXE Execution From Uncommon Parent",
      "status": "test",
      "description": "Detects potential RDP connection via Mstsc using a local \".rdp\" file located in suspicious locations.",
      "level": "high",
      "tags": [
        "attack.lateral-movement"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\brave.exe",
                  "\\CCleanerBrowser.exe",
                  "\\chrome.exe",
                  "\\chromium.exe",
                  "\\firefox.exe",
                  "\\iexplore.exe",
                  "\\microsoftedge.exe",
                  "\\msedge.exe",
                  "\\opera.exe",
                  "\\vivaldi.exe",
                  "\\whale.exe",
                  "\\outlook.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\mstsc.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "mstsc.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-04-18",
        "modified": "",
        "references": [
          "https://www.blackhillsinfosec.com/rogue-rdp-revisiting-initial-access-methods/",
          "https://web.archive.org/web/20230726144748/https://blog.thickmints.dev/mintsights/detecting-rogue-rdp/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_mstsc_run_local_rpd_file_susp_parent.yml"
      }
    },
    {
      "id": "2ddef153-167b-4e89-86b6-757a9e65dcac",
      "title": "File Download Via Bitsadmin To A Suspicious Target Folder",
      "status": "test",
      "description": "Detects usage of bitsadmin downloading a file to a suspicious target folder",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.persistence",
        "attack.t1197",
        "attack.s0190",
        "attack.t1036.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\bitsadmin.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "bitsadmin.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_flags": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " /transfer ",
                  " /create ",
                  " /addfile "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_folder": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ":\\Perflogs",
                  ":\\ProgramData\\",
                  ":\\Temp\\",
                  ":\\Users\\Public\\",
                  ":\\Windows\\",
                  "\\AppData\\Local\\Temp\\",
                  "\\AppData\\Roaming\\",
                  "\\Desktop\\",
                  "%ProgramData%",
                  "%public%"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1197",
          "T1036.003"
        ],
        "tactics": [
          "defense_evasion",
          "persistence"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-06-28",
        "modified": "2023-05-30",
        "references": [
          "https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin",
          "https://isc.sans.edu/diary/22264",
          "https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/",
          "https://blog.talosintelligence.com/breaking-the-silence-recent-truebot-activity/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_bitsadmin_download_susp_targetfolder.yml"
      }
    },
    {
      "id": "f11f2808-adb4-46c0-802a-8660db50fa99",
      "title": "ImagingDevices Unusual Parent/Child Processes",
      "status": "test",
      "description": "Detects unusual parent or children of the ImagingDevices.exe (Windows Contacts) process as seen being used with Bumblebee activity",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\WmiPrvSE.exe",
                  "\\svchost.exe",
                  "\\dllhost.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\ImagingDevices.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_child": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\ImagingDevices.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-09-27",
        "modified": "2022-12-29",
        "references": [
          "https://thedfirreport.com/2022/09/26/bumblebee-round-two/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_imagingdevices_unusual_parents.yml"
      }
    },
    {
      "id": "81ebd28b-9607-4478-bf06-974ed9d53ed7",
      "title": "Potential Application Whitelisting Bypass via Dnx.EXE",
      "status": "test",
      "description": "Detects the execution of Dnx.EXE. The Dnx utility allows for the execution of C# code.\nAttackers might abuse this in order to bypass application whitelisting.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218",
        "attack.t1027.004"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\dnx.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218",
          "T1027.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Beyu Denis, oscd.community",
        "date": "2019-10-26",
        "modified": "2024-04-24",
        "references": [
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Csi/",
          "https://enigma0x3.net/2016/11/17/bypassing-application-whitelisting-by-using-dnx-exe/"
        ],
        "falsepositives": [
          "Legitimate use of dnx.exe by legitimate user"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_dnx_execute_csharp_code.yml"
      }
    },
    {
      "id": "1dd05363-104e-4b4a-b963-196a534b03a1",
      "title": "Potential Suspicious Mofcomp Execution",
      "status": "test",
      "description": "Detects execution of the \"mofcomp\" utility as a child of a suspicious shell or script running utility or by having a suspicious path in the commandline.\nThe \"mofcomp\" utility parses a file containing MOF statements and adds the classes and class instances defined in the file to the WMI repository.\nAttackers abuse this utility to install malicious MOF scripts\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\mofcomp.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "mofcomp.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_case": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "ParentImage__endswith": {
                    "field": "ParentImage",
                    "value": [
                      "\\cmd.exe",
                      "\\powershell.exe",
                      "\\pwsh.exe",
                      "\\wsl.exe",
                      "\\wscript.exe",
                      "\\cscript.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      "\\AppData\\Local\\Temp",
                      "\\Users\\Public\\",
                      "\\WINDOWS\\Temp\\",
                      "%temp%",
                      "%tmp%",
                      "%appdata%"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_main_wmiprvse": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": "C:\\Windows\\System32\\wbem\\WmiPrvSE.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "C:\\Windows\\TEMP\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": ".mof",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_null_parent": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "C:\\Windows\\TEMP\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": ".mof",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "all of selection_*"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-07-12",
        "modified": "2023-04-11",
        "references": [
          "https://thedfirreport.com/2022/07/11/select-xmrig-from-sqlserver/",
          "https://github.com/The-DFIR-Report/Sigma-Rules/blob/75260568a7ffe61b2458ca05f6f25914efb44337/win_mofcomp_execution.yml",
          "https://learn.microsoft.com/en-us/windows/win32/wmisdk/mofcomp"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_mofcomp_execution.yml"
      }
    },
    {
      "id": "5a6e1e16-07de-48d8-8aae-faa766c05e88",
      "title": "Potential Cookies Session Hijacking",
      "status": "test",
      "description": "Detects execution of \"curl.exe\" with the \"-c\" flag in order to save cookie data.",
      "level": "medium",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\curl.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "curl.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__re": {
                    "field": "CommandLine",
                    "value": "\\s-c\\s",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": "--cookie-jar",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-07-27",
        "modified": "",
        "references": [
          "https://curl.se/docs/manpage.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_curl_cookie_hijacking.yml"
      }
    },
    {
      "id": "6f535e01-ca1f-40be-ab8d-45b19c0c8b7f",
      "title": "Import LDAP Data Interchange Format File Via Ldifde.EXE",
      "status": "test",
      "description": "Detects the execution of \"Ldifde.exe\" with the import flag \"-i\". The can be abused to include HTTP-based arguments which will allow the arbitrary download of files from a remote server.\n",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.defense-evasion",
        "attack.t1218",
        "attack.t1105"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\ldifde.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "ldifde.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "-i",
                  "-f"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218",
          "T1105"
        ],
        "tactics": [
          "command_and_control",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "@gott_cyber",
        "date": "2022-09-02",
        "modified": "2023-03-14",
        "references": [
          "https://twitter.com/0gtweet/status/1564968845726580736",
          "https://strontic.github.io/xcyclopedia/library/ldifde.exe-979DE101F5059CEC1D2C56967CA2BAC0.html",
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc731033(v=ws.11)"
        ],
        "falsepositives": [
          "Since the content of the files are unknown, false positives are expected"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_ldifde_file_load.yml"
      }
    },
    {
      "id": "87e3c4e8-a6a8-4ad9-bb4f-46e7ff99a180",
      "title": "Change PowerShell Policies to an Insecure Level",
      "status": "test",
      "description": "Detects changing the PowerShell script execution policy to a potentially insecure level using the \"-ExecutionPolicy\" flag.",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "powershell_ise.exe",
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell_ise.exe",
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_option": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "-executionpolicy ",
                  " -ep ",
                  " -exec "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_level": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Bypass",
                  "Unrestricted"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_powershell_core": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": [
                  "C:\\Windows\\SysWOW64\\msiexec.exe",
                  "C:\\Windows\\System32\\msiexec.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "-NoProfile -ExecutionPolicy Bypass -File \"C:\\Program Files\\PowerShell\\7\\",
                  "-NoProfile -ExecutionPolicy Bypass -File \"C:\\Program Files (x86)\\PowerShell\\7\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_avast": {
            "type": "field_match",
            "matchers": {
              "ParentImage__contains": {
                "field": "ParentImage",
                "value": [
                  "C:\\Program Files\\Avast Software\\Avast\\",
                  "C:\\Program Files (x86)\\Avast Software\\Avast\\",
                  "\\instup.exe"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "-ExecutionPolicy ByPass -File \"C:\\Program Files\\Avast Software\\Avast",
                  "-ExecutionPolicy ByPass -File \"C:\\Program Files (x86)\\Avast Software\\Avast\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "all of selection_*"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-11-01",
        "modified": "2025-10-07",
        "references": [
          "https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.security/set-executionpolicy?view=powershell-7.4",
          "https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_execution_policies?view=powershell-7.4",
          "https://adsecurity.org/?p=2604",
          "https://thedfirreport.com/2021/11/01/from-zero-to-domain-admin/"
        ],
        "falsepositives": [
          "Administrator scripts"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_set_policies_to_unsecure_level.yml"
      }
    },
    {
      "id": "970007b7-ce32-49d0-a4a4-fbef016950bd",
      "title": "Potential Configuration And Service Reconnaissance Via Reg.EXE",
      "status": "test",
      "description": "Detects the usage of \"reg.exe\" in order to query reconnaissance information from the registry. Adversaries may interact with the Windows registry to gather information about credentials, the system, configuration, and installed software.",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.t1012",
        "attack.t1007"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\reg.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "reg.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_flag": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "query",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_key": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "currentVersion\\windows",
                  "winlogon\\",
                  "currentVersion\\shellServiceObjectDelayLoad",
                  "currentVersion\\run",
                  "currentVersion\\policies\\explorer\\run",
                  "currentcontrolset\\services"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1012",
          "T1007"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Timur Zinniatullin, oscd.community",
        "date": "2019-10-21",
        "modified": "2023-02-05",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1012/T1012.md"
        ],
        "falsepositives": [
          "Discord"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_reg_query_registry.yml"
      }
    },
    {
      "id": "b730a276-6b63-41b8-bcf8-55930c8fc6ee",
      "title": "Csc.EXE Execution Form Potentially Suspicious Parent",
      "status": "test",
      "description": "Detects a potentially suspicious parent of \"csc.exe\", which could be a sign of payload delivery.",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059.005",
        "attack.t1059.007",
        "attack.defense-evasion",
        "attack.t1218.005",
        "attack.t1027.004"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\csc.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "csc.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_parent_generic": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\cscript.exe",
                  "\\excel.exe",
                  "\\mshta.exe",
                  "\\onenote.exe",
                  "\\outlook.exe",
                  "\\powerpnt.exe",
                  "\\winword.exe",
                  "\\wscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_parent_powershell": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\powershell.exe",
                  "\\pwsh.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "ParentCommandLine__contains": {
                "field": "ParentCommandLine",
                "value": [
                  "-Encoded ",
                  "FromBase64String"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_parent_susp_location": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "ParentCommandLine__re": {
                    "field": "ParentCommandLine",
                    "value": "([Pp]rogram[Dd]ata|%([Ll]ocal)?[Aa]pp[Dd]ata%|\\\\[Aa]pp[Dd]ata\\\\([Ll]ocal([Ll]ow)?|[Rr]oaming))\\\\[^\\\\]{1,256}$",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "ParentCommandLine__contains": {
                    "field": "ParentCommandLine",
                    "value": [
                      ":\\PerfLogs\\",
                      ":\\Users\\Public\\",
                      ":\\Windows\\Temp\\",
                      "\\Temporary Internet"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "ParentCommandLine__contains_all": {
                    "field": "ParentCommandLine",
                    "value": [
                      ":\\Users\\",
                      "\\Favorites\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "ParentCommandLine__contains_all": {
                    "field": "ParentCommandLine",
                    "value": [
                      ":\\Users\\",
                      "\\Favourites\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "ParentCommandLine__contains_all": {
                    "field": "ParentCommandLine",
                    "value": [
                      ":\\Users\\",
                      "\\Contacts\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "ParentCommandLine__contains_all": {
                    "field": "ParentCommandLine",
                    "value": [
                      ":\\Users\\",
                      "\\Pictures\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_main_programfiles": {
            "type": "field_match",
            "matchers": {
              "ParentImage__startswith": {
                "field": "ParentImage",
                "value": [
                  "C:\\Program Files (x86)\\",
                  "C:\\Program Files\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_sdiagnhost": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": "C:\\Windows\\System32\\sdiagnhost.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_w3p": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": "C:\\Windows\\System32\\inetsrv\\w3wp.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_chocolatey": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": "C:\\ProgramData\\chocolatey\\choco.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_defender": {
            "type": "field_match",
            "matchers": {
              "ParentCommandLine__contains": {
                "field": "ParentCommandLine",
                "value": "\\ProgramData\\Microsoft\\Windows Defender Advanced Threat Protection",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_ansible": {
            "type": "field_match",
            "matchers": {
              "ParentCommandLine__contains": {
                "field": "ParentCommandLine",
                "value": [
                  "JwB7ACIAZgBhAGkAbABlAGQAIgA6AHQAcgB1AGUALAAiAG0AcwBnACIAOgAiAEEAbgBzAGkAYgBsAGUAIAByAGUAcQB1AGkAcgBlAHMAIABQAG8AdwBlAHIAUwBoAGUAbABsACAAdgAzAC4AMAAgAG8AcgAgAG4AZQB3AGUAcgAiAH0AJw",
                  "cAewAiAGYAYQBpAGwAZQBkACIAOgB0AHIAdQBlACwAIgBtAHMAZwAiADoAIgBBAG4AcwBpAGIAbABlACAAcgBlAHEAdQBpAHIAZQBzACAAUABvAHcAZQByAFMAaABlAGwAbAAgAHYAMwAuADAAIABvAHIAIABuAGUAdwBlAHIAIgB9ACcA",
                  "nAHsAIgBmAGEAaQBsAGUAZAAiADoAdAByAHUAZQAsACIAbQBzAGcAIgA6ACIAQQBuAHMAaQBiAGwAZQAgAHIAZQBxAHUAaQByAGUAcwAgAFAAbwB3AGUAcgBTAGgAZQBsAGwAIAB2ADMALgAwACAAbwByACAAbgBlAHcAZQByACIAfQAnA"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection_img and 1 of selection_parent_* and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_img"
            },
            {
              "type": "ref",
              "value": "1 of selection_parent_*"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1059.005",
          "T1059.007",
          "T1218.005",
          "T1027.004"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems), X__Junior (Nextron Systems)",
        "date": "2019-02-11",
        "modified": "2024-05-27",
        "references": [
          "https://www.uptycs.com/blog/warzonerat-can-now-evade-with-process-hollowing",
          "https://reaqta.com/2017/11/short-journey-darkvnc/",
          "https://www.pwc.com/gx/en/issues/cybersecurity/cyber-threat-intelligence/yellow-liderc-ships-its-scripts-delivers-imaploader-malware.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_csc_susp_parent.yml"
      }
    },
    {
      "id": "26488ad0-f9fd-4536-876f-52fea846a2e4",
      "title": "HackTool - SharPersist Execution",
      "status": "test",
      "description": "Detects the execution of the hacktool SharPersist - used to deploy various different kinds of persistence mechanisms",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.execution",
        "attack.persistence",
        "attack.t1053"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\SharPersist.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Product": {
                    "field": "Product",
                    "value": "SharPersist",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -t schtask -c ",
                  " -t startupfolder -c "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " -t reg -c ",
                  " -m add"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_3": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " -t service -c ",
                  " -m add"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_4": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " -t schtask -c ",
                  " -m add"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1053"
        ],
        "tactics": [
          "privilege_escalation",
          "execution",
          "persistence"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-09-15",
        "modified": "2023-02-04",
        "references": [
          "https://www.mandiant.com/resources/blog/sharpersist-windows-persistence-toolkit",
          "https://github.com/mandiant/SharPersist"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_sharpersist.yml"
      }
    },
    {
      "id": "f4bbd493-b796-416e-bbf2-121235348529",
      "title": "Non Interactive PowerShell Process Spawned",
      "status": "test",
      "description": "Detects non-interactive PowerShell activity by looking at the \"powershell\" process with a non-user GUI process such as \"explorer.exe\" as a parent.",
      "level": "low",
      "tags": [
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_main_generic": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  ":\\Windows\\explorer.exe",
                  ":\\Windows\\System32\\CompatTelRunner.exe",
                  ":\\Windows\\SysWOW64\\explorer.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_windows_update": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": ":\\$WINDOWS.~BT\\Sources\\SetupHost.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_vscode": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\AppData\\Local\\Programs\\Microsoft VS Code\\Code.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "ParentCommandLine__contains": {
                "field": "ParentCommandLine",
                "value": " --ms-enable-electron-run-as-node ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_terminal": {
            "type": "field_match",
            "matchers": {
              "ParentImage__contains": {
                "field": "ParentImage",
                "value": ":\\Program Files\\WindowsApps\\Microsoft.WindowsTerminal_",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\WindowsTerminal.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez @Cyb3rWard0g (rule), oscd.community (improvements)",
        "date": "2019-09-12",
        "modified": "2023-09-07",
        "references": [
          "https://web.archive.org/web/20200925032237/https://threathunterplaybook.com/notebooks/windows/02_execution/WIN-190410151110.html"
        ],
        "falsepositives": [
          "Likely. Many admin scripts and tools leverage PowerShell in their BAT or VB scripts which may trigger this rule often. It is best to add additional filters or use this to hunt for anomalies"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_non_interactive_execution.yml"
      }
    },
    {
      "id": "a85f7765-698a-4088-afa0-ecfbf8d01fa4",
      "title": "Potential Memory Dumping Activity Via LiveKD",
      "status": "test",
      "description": "Detects execution of LiveKD based on PE metadata or image name",
      "level": "medium",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\livekd.exe",
                      "\\livekd64.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "livekd.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-15",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/sysinternals/downloads/livekd"
        ],
        "falsepositives": [
          "Administration and debugging activity (must be investigated)"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sysinternals_livekd_execution.yml"
      }
    },
    {
      "id": "0f0450f3-8b47-441e-a31b-15a91dc243e2",
      "title": "Potential DLL File Download Via PowerShell Invoke-WebRequest",
      "status": "test",
      "description": "Detects potential DLL files being downloaded using the PowerShell Invoke-WebRequest or Invoke-RestMethod cmdlets.",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.execution",
        "attack.t1059.001",
        "attack.t1105"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Invoke-RestMethod ",
                  "Invoke-WebRequest ",
                  "IRM ",
                  "IWR "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "http",
                  "OutFile",
                  ".dll"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001",
          "T1105"
        ],
        "tactics": [
          "command_and_control",
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Hieu Tran",
        "date": "2023-03-13",
        "modified": "2025-07-18",
        "references": [
          "https://www.zscaler.com/blogs/security-research/onenote-growing-threat-malware-distribution"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_download_dll.yml"
      }
    },
    {
      "id": "a0d7e4d2-bede-4141-8896-bc6e237e977c",
      "title": "Suspicious File Download From File Sharing Domain Via Wget.EXE",
      "status": "test",
      "description": "Detects potentially suspicious file downloads from file sharing domains using wget.exe",
      "level": "high",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\wget.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "wget.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_websites": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ".githubusercontent.com",
                  "anonfiles.com",
                  "cdn.discordapp.com",
                  "ddns.net",
                  "dl.dropboxusercontent.com",
                  "ghostbin.co",
                  "github.com",
                  "glitch.me",
                  "gofile.io",
                  "hastebin.com",
                  "mediafire.com",
                  "mega.nz",
                  "onrender.com",
                  "pages.dev",
                  "paste.ee",
                  "pastebin.com",
                  "pastebin.pl",
                  "pastetext.net",
                  "pixeldrain.com",
                  "privatlab.com",
                  "privatlab.net",
                  "send.exploit.in",
                  "sendspace.com",
                  "storage.googleapis.com",
                  "storjshare.io",
                  "supabase.co",
                  "temp.sh",
                  "transfer.sh",
                  "trycloudflare.com",
                  "ufile.io",
                  "w3spaces.com",
                  "workers.dev"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_http": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "http",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_flag": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__re": {
                    "field": "CommandLine",
                    "value": "\\s-O\\s",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": "--output-document",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_ext": {
            "type": "field_match",
            "matchers": {
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": [
                  ".ps1",
                  ".ps1'",
                  ".ps1\"",
                  ".dat",
                  ".dat'",
                  ".dat\"",
                  ".msi",
                  ".msi'",
                  ".msi\"",
                  ".bat",
                  ".bat'",
                  ".bat\"",
                  ".exe",
                  ".exe'",
                  ".exe\"",
                  ".vbs",
                  ".vbs'",
                  ".vbs\"",
                  ".vbe",
                  ".vbe'",
                  ".vbe\"",
                  ".hta",
                  ".hta'",
                  ".hta\"",
                  ".dll",
                  ".dll'",
                  ".dll\"",
                  ".psm1",
                  ".psm1'",
                  ".psm1\""
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-05",
        "modified": "2025-12-10",
        "references": [
          "https://labs.withsecure.com/publications/fin7-target-veeam-servers",
          "https://github.com/WithSecureLabs/iocs/blob/344203de742bb7e68bd56618f66d34be95a9f9fc/FIN7VEEAM/iocs.csv",
          "https://www.microsoft.com/en-us/security/blog/2024/01/17/new-ttps-observed-in-mint-sandstorm-campaign-targeting-high-profile-individuals-at-universities-and-research-orgs/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wget_download_susp_file_sharing_domains.yml"
      }
    },
    {
      "id": "44143844-0631-49ab-97a0-96387d6b2d7c",
      "title": "File Download Using Notepad++ GUP Utility",
      "status": "test",
      "description": "Detects execution of the Notepad++ updater (gup) from a process other than Notepad++ to download files.",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1105"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\GUP.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "gup.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " -unzipTo ",
                  "http"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\notepad++.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection* and not filter",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "all of selection*"
            },
            {
              "type": "not",
              "value": "filter"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1105"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-06-10",
        "modified": "2023-03-02",
        "references": [
          "https://twitter.com/nas_bench/status/1535322182863179776"
        ],
        "falsepositives": [
          "Other parent processes other than notepad++ using GUP that are not currently identified"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_gup_download.yml"
      }
    },
    {
      "id": "1816994b-42e1-4fb1-afd2-134d88184f71",
      "title": "PowerShell Base64 Encoded WMI Classes",
      "status": "test",
      "description": "Detects calls to base64 encoded WMI class such as \"Win32_ShadowCopy\", \"Win32_ScheduledJob\", etc.",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059.001",
        "attack.defense-evasion",
        "attack.t1027"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_shadowcopy": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "VwBpAG4AMwAyAF8AUwBoAGEAZABvAHcAYwBvAHAAeQ",
                  "cAaQBuADMAMgBfAFMAaABhAGQAbwB3AGMAbwBwAHkA",
                  "XAGkAbgAzADIAXwBTAGgAYQBkAG8AdwBjAG8AcAB5A",
                  "V2luMzJfU2hhZG93Y29we",
                  "dpbjMyX1NoYWRvd2NvcH",
                  "XaW4zMl9TaGFkb3djb3B5"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_scheduledJob": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "VwBpAG4AMwAyAF8AUwBjAGgAZQBkAHUAbABlAGQASgBvAGIA",
                  "cAaQBuADMAMgBfAFMAYwBoAGUAZAB1AGwAZQBkAEoAbwBiA",
                  "XAGkAbgAzADIAXwBTAGMAaABlAGQAdQBsAGUAZABKAG8AYg",
                  "V2luMzJfU2NoZWR1bGVkSm9i",
                  "dpbjMyX1NjaGVkdWxlZEpvY",
                  "XaW4zMl9TY2hlZHVsZWRKb2"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_process": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "VwBpAG4AMwAyAF8AUAByAG8AYwBlAHMAcw",
                  "cAaQBuADMAMgBfAFAAcgBvAGMAZQBzAHMA",
                  "XAGkAbgAzADIAXwBQAHIAbwBjAGUAcwBzA",
                  "V2luMzJfUHJvY2Vzc",
                  "dpbjMyX1Byb2Nlc3",
                  "XaW4zMl9Qcm9jZXNz"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_useraccount": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "VwBpAG4AMwAyAF8AVQBzAGUAcgBBAGMAYwBvAHUAbgB0A",
                  "cAaQBuADMAMgBfAFUAcwBlAHIAQQBjAGMAbwB1AG4AdA",
                  "XAGkAbgAzADIAXwBVAHMAZQByAEEAYwBjAG8AdQBuAHQA",
                  "V2luMzJfVXNlckFjY291bn",
                  "dpbjMyX1VzZXJBY2NvdW50",
                  "XaW4zMl9Vc2VyQWNjb3Vud"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_loggedonuser": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "VwBpAG4AMwAyAF8ATABvAGcAZwBlAGQATwBuAFUAcwBlAHIA",
                  "cAaQBuADMAMgBfAEwAbwBnAGcAZQBkAE8AbgBVAHMAZQByA",
                  "XAGkAbgAzADIAXwBMAG8AZwBnAGUAZABPAG4AVQBzAGUAcg",
                  "V2luMzJfTG9nZ2VkT25Vc2Vy",
                  "dpbjMyX0xvZ2dlZE9uVXNlc",
                  "XaW4zMl9Mb2dnZWRPblVzZX"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_img and 1 of selection_cli_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_img"
            },
            {
              "type": "ref",
              "value": "1 of selection_cli_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001",
          "T1027"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Christian Burkard (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-01-30",
        "modified": "",
        "references": [
          "https://github.com/Neo23x0/Raccine/blob/20a569fa21625086433dcce8bb2765d0ea08dcb6/yara/mal_revil.yar"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_base64_wmi_classes.yml"
      }
    },
    {
      "id": "b2ddd389-f676-4ac4-845a-e00781a48e5f",
      "title": "Using SettingSyncHost.exe as LOLBin",
      "status": "test",
      "description": "Detects using SettingSyncHost.exe to run hijacked binary",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.execution",
        "attack.defense-evasion",
        "attack.t1574.008"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "system_utility": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Windows\\System32\\",
                  "C:\\Windows\\SysWOW64\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "parent_is_settingsynchost": {
            "type": "field_match",
            "matchers": {
              "ParentCommandLine__contains_all": {
                "field": "ParentCommandLine",
                "value": [
                  "cmd.exe /c",
                  "RoamDiag.cmd",
                  "-outputpath"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "not system_utility and parent_is_settingsynchost",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "not",
              "value": "system_utility"
            },
            {
              "type": "ref",
              "value": "parent_is_settingsynchost"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1574.008"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Anton Kutepov, oscd.community",
        "date": "2020-02-05",
        "modified": "2021-11-27",
        "references": [
          "https://www.hexacorn.com/blog/2020/02/02/settingsynchost-exe-as-a-lolbin"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_settingsynchost.yml"
      }
    },
    {
      "id": "9fff585c-c33e-4a86-b3cd-39312079a65f",
      "title": "Taskmgr as LOCAL_SYSTEM",
      "status": "test",
      "description": "Detects the creation of taskmgr.exe process in context of LOCAL_SYSTEM",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "User__contains": {
                "field": "User",
                "value": [
                  "AUTHORI",
                  "AUTORI"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\taskmgr.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1036"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2018-03-18",
        "modified": "2022-05-27",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_taskmgr_localsystem.yml"
      }
    },
    {
      "id": "6c8fbee5-dee8-49bc-851d-c3142d02aa47",
      "title": "Allow Service Access Using Security Descriptor Tampering Via Sc.EXE",
      "status": "test",
      "description": "Detects suspicious DACL modifications to allow access to a service from a suspicious trustee. This can be used to override access restrictions set by previous ACLs.",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1543.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_sc": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\sc.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "sc.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_sdset": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "sdset",
                  "A;"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_trustee": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ";IU",
                  ";SU",
                  ";BA",
                  ";SY",
                  ";WD"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_hexnode": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": "C:\\Hexnode\\Hexnode Agent\\Current\\HexnodeAgent.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_optional_"
        }
      },
      "mitre": {
        "techniques": [
          "T1543.003"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-02-28",
        "modified": "2025-10-22",
        "references": [
          "https://twitter.com/0gtweet/status/1628720819537936386",
          "https://itconnect.uw.edu/tools-services-support/it-systems-infrastructure/msinf/other-help/understanding-sddl-syntax/",
          "https://learn.microsoft.com/en-us/windows/win32/secauthz/sid-strings"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sc_sdset_allow_service_changes.yml"
      }
    },
    {
      "id": "754ed792-634f-40ae-b3bc-e0448d33f695",
      "title": "Suspicious PowerShell Parent Process",
      "status": "test",
      "description": "Detects a suspicious or uncommon parent processes of PowerShell",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "ParentImage__contains": {
                    "field": "ParentImage",
                    "value": "tomcat",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "ParentImage__endswith": {
                    "field": "ParentImage",
                    "value": [
                      "\\amigo.exe",
                      "\\browser.exe",
                      "\\chrome.exe",
                      "\\firefox.exe",
                      "\\httpd.exe",
                      "\\iexplore.exe",
                      "\\jbosssvc.exe",
                      "\\microsoftedge.exe",
                      "\\microsoftedgecp.exe",
                      "\\MicrosoftEdgeSH.exe",
                      "\\mshta.exe",
                      "\\nginx.exe",
                      "\\outlook.exe",
                      "\\php-cgi.exe",
                      "\\regsvr32.exe",
                      "\\rundll32.exe",
                      "\\safari.exe",
                      "\\services.exe",
                      "\\sqlagent.exe",
                      "\\sqlserver.exe",
                      "\\sqlservr.exe",
                      "\\vivaldi.exe",
                      "\\w3wp.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_powershell": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      "/c powershell",
                      "/c pwsh"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "Windows PowerShell",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Product": {
                    "field": "Product",
                    "value": "PowerShell Core 6",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Teymur Kheirkhabarov, Harish Segar",
        "date": "2020-03-20",
        "modified": "2023-02-04",
        "references": [
          "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse?slide=26"
        ],
        "falsepositives": [
          "Other scripts"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_susp_parent_process.yml"
      }
    },
    {
      "id": "6e968eb1-5f05-4dac-94e9-fd0c5cb49fd6",
      "title": "Uncommon Link.EXE Parent Process",
      "status": "test",
      "description": "Detects an uncommon parent process of \"LINK.EXE\".\nLink.EXE in Microsoft incremental linker. Its a utility usually bundled with Visual Studio installation.\nMultiple utilities often found in the same folder (editbin.exe, dumpbin.exe, lib.exe, etc) have a hardcode call to the \"LINK.EXE\" binary without checking its validity.\nThis would allow an attacker to sideload any binary with the name \"link.exe\" if one of the aforementioned tools get executed from a different location.\nBy filtering the known locations of such utilities we can spot uncommon parent process of LINK.EXE that might be suspicious or malicious.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\link.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "LINK /",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_visual_studio": {
            "type": "field_match",
            "matchers": {
              "ParentImage__startswith": {
                "field": "ParentImage",
                "value": [
                  "C:\\Program Files\\Microsoft Visual Studio\\",
                  "C:\\Program Files (x86)\\Microsoft Visual Studio\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "ParentImage__contains": {
                "field": "ParentImage",
                "value": [
                  "\\VC\\bin\\",
                  "\\VC\\Tools\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-22",
        "modified": "2024-06-27",
        "references": [
          "https://twitter.com/0gtweet/status/1560732860935729152"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_link_uncommon_parent_process.yml"
      }
    },
    {
      "id": "193d5ccd-6f59-40c6-b5b0-8e32d5ddd3d1",
      "title": "Xwizard.EXE Execution From Non-Default Location",
      "status": "test",
      "description": "Detects the execution of Xwizard tool from a non-default directory.\nWhen executed from a non-default directory, this utility can be abused in order to side load a custom version of \"xwizards.dll\".\n",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1574.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\xwizard.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "xwizard.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_main_legit_location": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Windows\\System32\\",
                  "C:\\Windows\\SysWOW64\\",
                  "C:\\Windows\\WinSxS\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1574.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Christian Burkard (Nextron Systems)",
        "date": "2021-09-20",
        "modified": "2024-08-15",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Xwizard/",
          "http://www.hexacorn.com/blog/2017/07/31/the-wizard-of-x-oppa-plugx-style/"
        ],
        "falsepositives": [
          "Windows installed on non-C drive"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_xwizard_execution_non_default_location.yml"
      }
    },
    {
      "id": "37e8d358-6408-4853-82f4-98333fca7014",
      "title": "Remote Access Tool - NetSupport Execution From Unusual Location",
      "status": "test",
      "description": "Detects execution of client32.exe (NetSupport RAT) from an unusual location (outside of 'C:\\Program Files')",
      "level": "medium",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\client32.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Product__contains": {
                    "field": "Product",
                    "value": "NetSupport Remote Control",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName__contains": {
                    "field": "OriginalFileName",
                    "value": "client32.exe",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Hashes__contains": {
                    "field": "Hashes",
                    "value": "IMPHASH=a9d50692e95b79723f3e76fcf70d023e",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\",
                  "C:\\Program Files (x86)\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-09-19",
        "modified": "2024-11-23",
        "references": [
          "https://redcanary.com/blog/misbehaving-rats/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_remote_access_tools_netsupport_susp_exec.yml"
      }
    },
    {
      "id": "c74c0390-3e20-41fd-a69a-128f0275a5ea",
      "title": "Cab File Extraction Via Wusa.EXE From Potentially Suspicious Paths",
      "status": "test",
      "description": "Detects the execution of the \"wusa.exe\" (Windows Update Standalone Installer) utility to extract \".cab\" files using the \"/extract\" argument from potentially suspicious paths.\n",
      "level": "high",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_root": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\wusa.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "/extract:",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_paths": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ":\\PerfLogs\\",
                  ":\\Users\\Public\\",
                  ":\\Windows\\Temp\\",
                  "\\Appdata\\Local\\Temp\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-05",
        "modified": "2023-11-28",
        "references": [
          "https://web.archive.org/web/20180331144337/https://www.fireeye.com/blog/threat-research/2018/03/sanny-malware-delivery-method-updated-in-recently-observed-attacks.html",
          "https://www.echotrail.io/insights/search/wusa.exe/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wusa_cab_files_extraction_from_susp_paths.yml"
      }
    },
    {
      "id": "f57c58b3-ee69-4ef5-9041-455bf39aaa89",
      "title": "Remote CHM File Download/Execution Via HH.EXE",
      "status": "test",
      "description": "Detects the usage of \"hh.exe\" to execute/download remotely hosted \".chm\" files.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "HH.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\hh.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "http://",
                  "https://",
                  "\\\\\\\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-09-29",
        "modified": "2024-01-31",
        "references": [
          "https://www.splunk.com/en_us/blog/security/follina-for-protocol-handlers.html",
          "https://github.com/redcanaryco/atomic-red-team/blob/1cf4dd51f83dcb0ebe6ade902d6157ad2dbc6ac8/atomics/T1218.001/T1218.001.md",
          "https://www.zscaler.com/blogs/security-research/unintentional-leak-glimpse-attack-vectors-apt37"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hh_chm_remote_download_or_execution.yml"
      }
    },
    {
      "id": "4f2cd9b6-4a17-440f-bb2a-687abb65993a",
      "title": "Uncommon AddinUtil.EXE CommandLine Execution",
      "status": "test",
      "description": "Detects execution of the Add-In deployment cache updating utility (AddInutil.exe) with uncommon Addinroot or Pipelineroot paths. An adversary may execute AddinUtil.exe with uncommon Addinroot/Pipelineroot paths that point to the adversaries Addins.Store payload.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\addinutil.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "AddInUtil.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "-AddInRoot:",
                  "-PipelineRoot:"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_addinroot": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "-AddInRoot:\"C:\\Program Files (x86)\\Common Files\\Microsoft Shared\\VSTA",
                  "-AddInRoot:C:\\Program Files (x86)\\Common Files\\Microsoft Shared\\VSTA",
                  "-PipelineRoot:\"C:\\Program Files (x86)\\Common Files\\Microsoft Shared\\VSTA",
                  "-PipelineRoot:C:\\Program Files (x86)\\Common Files\\Microsoft Shared\\VSTA"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_main_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Michael McKinley (@McKinleyMike), Tony Latteri (@TheLatteri)",
        "date": "2023-09-18",
        "modified": "",
        "references": [
          "https://www.blue-prints.blog/content/blog/posts/lolbin/addinutil-lolbas.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_addinutil_uncommon_cmdline.yml"
      }
    },
    {
      "id": "8a7e90c5-fe6e-45dc-889e-057fe4378bd9",
      "title": "HackTool - SysmonEOP Execution",
      "status": "test",
      "description": "Detects the execution of the PoC that can be used to exploit Sysmon CVE-2022-41120",
      "level": "critical",
      "tags": [
        "cve.2022-41120",
        "attack.t1068",
        "attack.privilege-escalation"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\SysmonEOP.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_hash": {
            "type": "field_match",
            "matchers": {
              "Hashes__contains": {
                "field": "Hashes",
                "value": [
                  "IMPHASH=22F4089EB8ABA31E1BB162C6D9BF72E5",
                  "IMPHASH=5123FA4C4384D431CD0D893EEB49BBEC"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1068"
        ],
        "tactics": [
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-12-04",
        "modified": "2024-11-23",
        "references": [
          "https://github.com/Wh04m1001/SysmonEoP"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_sysmoneop.yml"
      }
    },
    {
      "id": "a238b5d0-ce2d-4414-a676-7a531b3d13d6",
      "title": "ETW Trace Evasion Activity",
      "status": "test",
      "description": "Detects command line activity that tries to clear or disable any ETW trace log which could be a sign of logging evasion.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1070",
        "attack.t1562.006",
        "car.2016-04-002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_clear_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "cl",
                  "/Trace"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_clear_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "clear-log",
                  "/Trace"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_disable_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "sl",
                  "/e:false"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_disable_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "set-log",
                  "/e:false"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_disable_3": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "logman",
                  "update",
                  "trace",
                  "--p",
                  "-ets"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_pwsh_remove": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "Remove-EtwTraceProvider",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_pwsh_set": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "Set-EtwTraceProvider",
                  "0x11"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1070",
          "T1562.006"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "@neu5ron, Florian Roth (Nextron Systems), Jonhnathan Ribeiro, oscd.community",
        "date": "2019-03-22",
        "modified": "2022-06-28",
        "references": [
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wevtutil",
          "https://abuse.io/lockergoga.txt",
          "https://medium.com/palantir/tampering-with-windows-event-tracing-background-offense-and-defense-4be7ac62ac63"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_etw_trace_evasion.yml"
      }
    },
    {
      "id": "78f10490-f2f4-4d19-a75b-4e0683bf3b8d",
      "title": "Suspicious Speech Runtime Binary Child Process",
      "status": "experimental",
      "description": "Detects suspicious Speech Runtime Binary Execution by monitoring its child processes.\nChild processes spawned by SpeechRuntime.exe could indicate an attempt for lateral movement via COM & DCOM hijacking.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.lateral-movement",
        "attack.t1021.003",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\SpeechRuntime.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1021.003",
          "T1218"
        ],
        "tactics": [
          "defense_evasion",
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "andrewdanis",
        "date": "2025-10-23",
        "modified": "",
        "references": [
          "https://github.com/rtecCyberSec/SpeechRuntimeMove"
        ],
        "falsepositives": [
          "Unlikely."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_speechruntime_child_process.yml"
      }
    },
    {
      "id": "c31364f7-8be6-4b77-8483-dd2b5a7b69a3",
      "title": "Import PowerShell Modules From Suspicious Directories - ProcCreation",
      "status": "test",
      "description": "Detects powershell scripts that import modules from suspicious directories",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Import-Module \"$Env:Temp\\",
                  "Import-Module '$Env:Temp\\",
                  "Import-Module $Env:Temp\\",
                  "Import-Module \"$Env:Appdata\\",
                  "Import-Module '$Env:Appdata\\",
                  "Import-Module $Env:Appdata\\",
                  "Import-Module C:\\Users\\Public\\",
                  "ipmo \"$Env:Temp\\",
                  "ipmo '$Env:Temp\\",
                  "ipmo $Env:Temp\\",
                  "ipmo \"$Env:Appdata\\",
                  "ipmo '$Env:Appdata\\",
                  "ipmo $Env:Appdata\\",
                  "ipmo C:\\Users\\Public\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-01-10",
        "modified": "",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1003.002/T1003.002.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_import_module_susp_dirs.yml"
      }
    },
    {
      "id": "84972c80-251c-4c3a-9079-4f00aad93938",
      "title": "Sensitive File Recovery From Backup Via Wbadmin.EXE",
      "status": "test",
      "description": "Detects the dump of highly sensitive files such as \"NTDS.DIT\" and \"SECURITY\" hive.\nAttackers can leverage the \"wbadmin\" utility in order to dump sensitive files that might contain credential or sensitive information.\n",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\wbadmin.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "WBADMIN.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_backup": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " recovery",
                  "recoveryTarget",
                  "itemtype:File"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\config\\SAM",
                  "\\config\\SECURITY",
                  "\\config\\SYSTEM",
                  "\\Windows\\NTDS\\NTDS.dit"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.003"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), frack113",
        "date": "2024-05-10",
        "modified": "",
        "references": [
          "https://github.com/LOLBAS-Project/LOLBAS/blob/2cc01b01132b5c304027a658c698ae09dd6a92bf/yml/OSBinaries/Wbadmin.yml",
          "https://lolbas-project.github.io/lolbas/Binaries/Wbadmin/",
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wbadmin-start-recovery",
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wbadmin-start-backup"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wbadmin_restore_sensitive_files.yml"
      }
    },
    {
      "id": "8f88e3f6-2a49-48f5-a5c4-2f7eedf78710",
      "title": "Java Running with Remote Debugging",
      "status": "test",
      "description": "Detects a JAVA process running with remote debugging allowing more than just localhost to connect",
      "level": "medium",
      "tags": [
        "attack.t1203",
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_jdwp_transport": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "transport=dt_socket,address=",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_old_jvm_version": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "jre1.",
                  "jdk1."
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "exclusion": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "address=127.0.0.1",
                  "address=localhost"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_* and not exclusion",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "all of selection_*"
            },
            {
              "type": "not",
              "value": "exclusion"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1203"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2019-01-16",
        "modified": "2023-02-01",
        "references": [
          "https://dzone.com/articles/remote-debugging-java-applications-with-jdwp"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_java_remote_debugging.yml"
      }
    },
    {
      "id": "30fc8de7-d833-40c4-96b6-28319fbc4f6c",
      "title": "UAC Bypass Using Event Viewer RecentViews",
      "status": "test",
      "description": "Detects the pattern of UAC Bypass using Event Viewer RecentViews",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_path": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\Event Viewer\\RecentViews",
                  "\\EventV~1\\RecentViews"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_redirect": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": ">",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-11-22",
        "modified": "",
        "references": [
          "https://twitter.com/orange_8361/status/1518970259868626944",
          "https://lolbas-project.github.io/lolbas/Binaries/Eventvwr/#execute"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_uac_bypass_eventvwr_recentviews.yml"
      }
    },
    {
      "id": "5f03babb-12db-4eec-8c82-7b4cb5580868",
      "title": "Response File Execution Via Odbcconf.EXE",
      "status": "test",
      "description": "Detects execution of \"odbcconf\" with the \"-f\" flag in order to load a response file which might contain a malicious action.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.008"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\odbcconf.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "odbcconf.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -f ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_rsp_ext": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": ".rsp",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.008"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Kirill Kiryanov, Beyu Denis, Daniil Yugoslavskiy, oscd.community, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-22",
        "modified": "2024-03-05",
        "references": [
          "https://learn.microsoft.com/en-us/sql/odbc/odbcconf-exe?view=sql-server-ver16",
          "https://lolbas-project.github.io/lolbas/Binaries/Odbcconf/",
          "https://www.cybereason.com/blog/threat-analysis-report-bumblebee-loader-the-high-road-to-enterprise-domain-control",
          "https://www.hexacorn.com/blog/2020/08/23/odbcconf-lolbin-trifecta/"
        ],
        "falsepositives": [
          "The rule is looking for any usage of response file, which might generate false positive when this function is used legitimately. Investigate the contents of the \".rsp\" file to determine if it is malicious and apply additional filters if necessary."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_odbcconf_response_file.yml"
      }
    },
    {
      "id": "6640f31c-01ad-49b5-beb5-83498a5cd8bd",
      "title": "Potential Arbitrary Code Execution Via Node.EXE",
      "status": "test",
      "description": "Detects the execution node.exe which is shipped with multiple software such as VMware, Adobe...etc. In order to execute arbitrary code. For example to establish reverse shell as seen in Log4j attacks...etc",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1127"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_main": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\node.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -e ",
                  " --eval "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_action_reverse_shell": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  ".exec(",
                  "net.socket",
                  ".connect",
                  "child_process"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_main and 1 of selection_action_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_main"
            },
            {
              "type": "ref",
              "value": "1 of selection_action_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1127"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-09-09",
        "modified": "2023-02-03",
        "references": [
          "http://blog.talosintelligence.com/2022/09/lazarus-three-rats.html",
          "https://www.sprocketsecurity.com/resources/crossing-the-log4j-horizon-a-vulnerability-with-no-return",
          "https://www.rapid7.com/blog/post/2022/01/18/active-exploitation-of-vmware-horizon-servers/",
          "https://nodejs.org/api/cli.html"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_node_abuse.yml"
      }
    },
    {
      "id": "e22a6eb2-f8a5-44b5-8b44-a2dbd47b1144",
      "title": "Potential MsiExec Masquerading",
      "status": "test",
      "description": "Detects the execution of msiexec.exe from an uncommon directory",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036.005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\msiexec.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "\\msiexec.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Windows\\System32\\",
                  "C:\\Windows\\SysWOW64\\",
                  "C:\\Windows\\WinSxS\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1036.005"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2019-11-14",
        "modified": "2023-02-21",
        "references": [
          "https://twitter.com/200_okay_/status/1194765831911215104"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_msiexec_masquerading.yml"
      }
    },
    {
      "id": "ae9c6a7c-9521-42a6-915e-5aaa8689d529",
      "title": "CobaltStrike Load by Rundll32",
      "status": "test",
      "description": "Rundll32 can be use by Cobalt Strike with StartW function to load DLLs from the command line.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.011"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_rundll": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\rundll32.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "RUNDLL32.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      "rundll32.exe",
                      "rundll32 "
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_params": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": ".dll",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": [
                  " StartW",
                  ",StartW"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.011"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Wojciech Lesicki",
        "date": "2021-06-01",
        "modified": "2022-09-16",
        "references": [
          "https://www.cobaltstrike.com/help-windows-executable",
          "https://redcanary.com/threat-detection-report/",
          "https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_cobaltstrike_load_by_rundll32.yml"
      }
    },
    {
      "id": "647c7b9e-d784-4fda-b9a0-45c565a7b729",
      "title": "Operator Bloopers Cobalt Strike Commands",
      "status": "test",
      "description": "Detects use of Cobalt Strike commands accidentally entered in the CMD shell",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059.003",
        "stp.1u"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "Cmd.Exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\cmd.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__startswith": {
                "field": "CommandLine",
                "value": [
                  "cmd ",
                  "cmd.exe",
                  "c:\\windows\\system32\\cmd.exe"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "psinject",
                  "spawnas",
                  "make_token",
                  "remote-exec",
                  "rev2self",
                  "dcsync",
                  "logonpasswords",
                  "execute-assembly",
                  "getsystem"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.003"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "_pete_0, TheDFIRReport",
        "date": "2022-05-06",
        "modified": "2023-01-30",
        "references": [
          "https://hstechdocs.helpsystems.com/manuals/cobaltstrike/current/userguide/content/cobalt-4-5-user-guide.pdf",
          "https://thedfirreport.com/2021/10/04/bazarloader-and-the-conti-leaks/",
          "https://thedfirreport.com/2022/06/16/sans-ransomware-summit-2022-can-you-detect-this/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_cobaltstrike_bloopers_cmd.yml"
      }
    },
    {
      "id": "a95b9b42-1308-4735-a1af-abb1c5e6f5ac",
      "title": "Suspicious Service DACL Modification Via Set-Service Cmdlet",
      "status": "test",
      "description": "Detects suspicious DACL modifications via the \"Set-Service\" cmdlet using the \"SecurityDescriptorSddl\" flag (Only available with PowerShell 7) that can be used to hide services or make them unstopable",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1543.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\pwsh.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "pwsh.dll",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_sddl_flag": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "-SecurityDescriptorSddl ",
                  "-sd "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_set_service": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "Set-Service ",
                  "D;;"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ";;;IU",
                  ";;;SU",
                  ";;;BA",
                  ";;;SY",
                  ";;;WD"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1543.003"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-10-18",
        "modified": "",
        "references": [
          "https://www.sans.org/blog/red-team-tactics-hiding-windows-services/",
          "https://learn.microsoft.com/pt-br/windows/win32/secauthz/sid-strings"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_service_dacl_modification_set_service.yml"
      }
    },
    {
      "id": "fe63010f-8823-4864-a96b-a7b4a0f7b929",
      "title": "LSASS Process Reconnaissance Via Findstr.EXE",
      "status": "test",
      "description": "Detects findstring commands that include the keyword lsass, which indicates recon actviity for the LSASS process PID",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1552.006"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_findstr_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\find.exe",
                      "\\findstr.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "FIND.EXE",
                      "FINDSTR.EXE"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_findstr_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "lsass",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_special": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " /i \"lsass",
                  " /i lsass.exe",
                  "findstr \"lsass",
                  "findstr lsass",
                  "findstr.exe \"lsass",
                  "findstr.exe lsass"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_findstr_* or selection_special",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "all of selection_findstr_*",
            "selection_special"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1552.006"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-08-12",
        "modified": "2024-06-04",
        "references": [
          "https://blog.talosintelligence.com/2022/08/recent-cyber-attack.html?m=1"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_findstr_lsass.yml"
      }
    },
    {
      "id": "198effb6-6c98-4d0c-9ea3-451fa143c45c",
      "title": "Run Once Task Execution as Configured in Registry",
      "status": "test",
      "description": "This rule detects the execution of Run Once task as configured in the registry",
      "level": "low",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\runonce.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "Run Once Wrapper",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": "/AlternateShellStartup",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__endswith": {
                    "field": "CommandLine",
                    "value": "/r",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Avneet Singh @v3t0_, oscd.community, Christopher Peacock @SecurePeacock (updated)",
        "date": "2020-10-18",
        "modified": "2022-12-13",
        "references": [
          "https://twitter.com/pabraeken/status/990717080805789697",
          "https://lolbas-project.github.io/lolbas/Binaries/Runonce/",
          "https://twitter.com/0gtweet/status/1602644163824156672?s=20&t=kuxbUnZPltpvFPZdCrqPXA"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_runonce_execution.yml"
      }
    },
    {
      "id": "ca5583e9-8f80-46ac-ab91-7f314d13b984",
      "title": "Potentially Suspicious Child Process of KeyScrambler.exe",
      "status": "test",
      "description": "Detects potentially suspicious child processes of KeyScrambler.exe",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.execution",
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1203",
        "attack.t1574.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\KeyScrambler.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_binaries": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\cmd.exe",
                      "\\cscript.exe",
                      "\\mshta.exe",
                      "\\powershell.exe",
                      "\\pwsh.exe",
                      "\\regsvr32.exe",
                      "\\rundll32.exe",
                      "\\wscript.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "Cmd.Exe",
                      "cscript.exe",
                      "mshta.exe",
                      "PowerShell.EXE",
                      "pwsh.dll",
                      "regsvr32.exe",
                      "RUNDLL32.EXE",
                      "wscript.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1203",
          "T1574.001"
        ],
        "tactics": [
          "persistence",
          "execution",
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel",
        "date": "2024-05-13",
        "modified": "",
        "references": [
          "https://twitter.com/DTCERT/status/1712785421845790799"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_keyscrambler_susp_child_process.yml"
      }
    },
    {
      "id": "79a87aa6-e4bd-42fc-a5bb-5e6fbdcd62f5",
      "title": "Msiexec Quiet Installation",
      "status": "test",
      "description": "Adversaries may abuse msiexec.exe to proxy execution of malicious payloads.\nMsiexec.exe is the command-line utility for the Windows Installer and is thus commonly associated with executing installation packages (.msi)\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.007"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\msiexec.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "msiexec.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "-i",
                  "-package",
                  "-a",
                  "-j"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_quiet": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-q",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_user_temp": {
            "type": "field_match",
            "matchers": {
              "ParentImage__startswith": {
                "field": "ParentImage",
                "value": "C:\\Users\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "ParentImage__contains": {
                "field": "ParentImage",
                "value": "\\AppData\\Local\\Temp\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_system_temp": {
            "type": "field_match",
            "matchers": {
              "ParentImage__startswith": {
                "field": "ParentImage",
                "value": "C:\\Windows\\Temp\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_ccm": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": "C:\\Windows\\CCM\\Ccm32BitLauncher.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "IntegrityLevel": {
                "field": "IntegrityLevel",
                "value": [
                  "System",
                  "S-1-16-16384"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.007"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-16",
        "modified": "2024-12-01",
        "references": [
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/msiexec",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1218.007/T1218.007.md",
          "https://twitter.com/_st0pp3r_/status/1583914244344799235"
        ],
        "falsepositives": [
          "WindowsApps installing updates via the quiet flag"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_msiexec_install_quiet.yml"
      }
    },
    {
      "id": "e9142d84-fbe0-401d-ac50-3e519fb00c89",
      "title": "WhoAmI as Parameter",
      "status": "test",
      "description": "Detects a suspicious process command line that uses whoami as first parameter (as e.g. used by EfsPotato)",
      "level": "high",
      "tags": [
        "attack.discovery",
        "attack.t1033",
        "car.2016-03-001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": ".exe whoami",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1033"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-11-29",
        "modified": "2022-12-25",
        "references": [
          "https://twitter.com/blackarrowsec/status/1463805700602224645?s=12"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_whoami_as_param.yml"
      }
    },
    {
      "id": "85c312b7-f44d-4a51-a024-d671c40b49fc",
      "title": "Service StartupType Change Via Sc.EXE",
      "status": "test",
      "description": "Detect the use of \"sc.exe\" to change the startup type of a service to \"disabled\" or \"demand\"",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\sc.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "sc.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " config ",
                  "start"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "disabled",
                  "demand"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-01",
        "modified": "2023-03-04",
        "references": [
          "https://www.virustotal.com/gui/file/38283b775552da8981452941ea74191aa0d203edd3f61fb2dee7b0aea3514955"
        ],
        "falsepositives": [
          "False positives may occur with troubleshooting scripts"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sc_disable_service.yml"
      }
    },
    {
      "id": "2d22a514-e024-4428-9dba-41505bd63a5b",
      "title": "Indirect Command Execution From Script File Via Bash.EXE",
      "status": "test",
      "description": "Detects execution of Microsoft bash launcher without any flags to execute the content of a bash script directly.\nThis can be used to potentially bypass defenses and execute Linux or Windows-based binaries directly via bash.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1202"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      ":\\Windows\\System32\\bash.exe",
                      ":\\Windows\\SysWOW64\\bash.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "Bash.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_main_cli_flag": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "bash.exe -",
                  "bash -"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_no_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine": {
                "field": "CommandLine",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_empty": {
            "type": "field_match",
            "matchers": {
              "CommandLine": {
                "field": "CommandLine",
                "value": "",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_no_flag": {
            "type": "field_match",
            "matchers": {
              "CommandLine": {
                "field": "CommandLine",
                "value": [
                  "bash.exe",
                  "bash"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1202"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-08-15",
        "modified": "",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Bash/",
          "https://linux.die.net/man/1/bash",
          "Internal Research"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_bash_file_execution.yml"
      }
    },
    {
      "id": "79ce34ca-af29-4d0e-b832-fc1b377020db",
      "title": "Whoami.EXE Execution From Privileged Process",
      "status": "test",
      "description": "Detects the execution of \"whoami.exe\" by privileged accounts that are often abused by threat actors",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.discovery",
        "attack.t1033"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "whoami.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\whoami.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_user": {
            "type": "field_match",
            "matchers": {
              "User__contains": {
                "field": "User",
                "value": [
                  "AUTHORI",
                  "AUTORI",
                  "TrustedInstaller"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1033"
        ],
        "tactics": [
          "privilege_escalation",
          "discovery"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Teymur Kheirkhabarov",
        "date": "2022-01-28",
        "modified": "2023-12-04",
        "references": [
          "https://speakerdeck.com/heirhabarov/hunting-for-privilege-escalation-in-windows-environment",
          "https://web.archive.org/web/20221019044836/https://nsudo.m2team.org/en-us/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_whoami_execution_from_high_priv_process.yml"
      }
    },
    {
      "id": "58f4ea09-0fc2-4520-ba18-b85c540b0eaf",
      "title": "Suspicious Serv-U Process Pattern",
      "status": "test",
      "description": "Detects a suspicious process pattern which could be a sign of an exploited Serv-U service",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1555",
        "cve.2021-35211"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\Serv-U.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\cmd.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\wscript.exe",
                  "\\cscript.exe",
                  "\\sh.exe",
                  "\\bash.exe",
                  "\\schtasks.exe",
                  "\\regsvr32.exe",
                  "\\wmic.exe",
                  "\\mshta.exe",
                  "\\rundll32.exe",
                  "\\msiexec.exe",
                  "\\forfiles.exe",
                  "\\scriptrunner.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1555"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-07-14",
        "modified": "2022-07-14",
        "references": [
          "https://www.microsoft.com/security/blog/2021/07/13/microsoft-discovers-threat-actor-targeting-solarwinds-serv-u-software-with-0-day-exploit/"
        ],
        "falsepositives": [
          "Legitimate uses in which users or programs use the SSH service of Serv-U for remote command execution"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_servu_susp_child_process.yml"
      }
    },
    {
      "id": "b5746143-59d6-4603-8d06-acbd60e166ee",
      "title": "Uncommon Child Process Of AddinUtil.EXE",
      "status": "test",
      "description": "Detects uncommon child processes of the Add-In deployment cache updating utility (AddInutil.exe) which could be a sign of potential abuse of the binary to proxy execution via a custom Addins.Store payload.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\addinutil.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_werfault": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  ":\\Windows\\System32\\conhost.exe",
                  ":\\Windows\\System32\\werfault.exe",
                  ":\\Windows\\SysWOW64\\werfault.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Michael McKinley (@McKinleyMike), Tony Latteri (@TheLatteri)",
        "date": "2023-09-18",
        "modified": "",
        "references": [
          "https://www.blue-prints.blog/content/blog/posts/lolbin/addinutil-lolbas.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_addinutil_uncommon_child_process.yml"
      }
    },
    {
      "id": "d06be4b9-8045-428b-a567-740a26d9db25",
      "title": "Verclsid.exe Runs COM Object",
      "status": "test",
      "description": "Detects when verclsid.exe is used to run COM object via GUID",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\verclsid.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "verclsid.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/S",
                  "/C"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_runtimebroker": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "C:\\Windows\\System32\\RuntimeBroker.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "verclsid.exe\" /S /C {",
                  "} /I {"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_main_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Victor Sergeev, oscd.community",
        "date": "2020-10-09",
        "modified": "2025-10-07",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Verclsid/",
          "https://gist.github.com/NickTyrer/0598b60112eaafe6d07789f7964290d5",
          "https://bohops.com/2018/08/18/abusing-the-com-registry-structure-part-2-loading-techniques-for-evasion-and-persistence/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_verclsid_runs_com.yml"
      }
    },
    {
      "id": "734f8d9b-42b8-41b2-bcf5-abaf49d5a3c8",
      "title": "Remote PowerShell Session Host Process (WinRM)",
      "status": "test",
      "description": "Detects remote PowerShell sections by monitoring for wsmprovhost (WinRM host process) as a parent or child process (sign of an active PowerShell remote session).",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.lateral-movement",
        "attack.t1059.001",
        "attack.t1021.006"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\wsmprovhost.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "ParentImage__endswith": {
                    "field": "ParentImage",
                    "value": "\\wsmprovhost.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001",
          "T1021.006"
        ],
        "tactics": [
          "execution",
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez @Cyb3rWard0g",
        "date": "2019-09-12",
        "modified": "2022-10-09",
        "references": [
          "https://threathunterplaybook.com/hunts/windows/190511-RemotePwshExecution/notebook.html"
        ],
        "falsepositives": [
          "Legitimate usage of remote Powershell, e.g. for monitoring purposes."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_winrm_remote_powershell_session_process.yml"
      }
    },
    {
      "id": "771d1eb5-9587-4568-95fb-9ec44153a012",
      "title": "PUA - NSudo Execution",
      "status": "test",
      "description": "Detects the use of NSudo tool for command execution",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1569.002",
        "attack.s0029"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\NSudo.exe",
                      "\\NSudoLC.exe",
                      "\\NSudoLG.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "NSudo.exe",
                      "NSudoLC.exe",
                      "NSudoLG.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "-U:S ",
                  "-U:T ",
                  "-U:E ",
                  "-P:E ",
                  "-M:S ",
                  "-M:H ",
                  "-U=S ",
                  "-U=T ",
                  "-U=E ",
                  "-P=E ",
                  "-M=S ",
                  "-M=H ",
                  "-ShowWindowMode:Hide"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1569.002"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali",
        "date": "2022-01-24",
        "modified": "2023-02-13",
        "references": [
          "https://web.archive.org/web/20221019044836/https://nsudo.m2team.org/en-us/",
          "https://www.winhelponline.com/blog/run-program-as-system-localsystem-account-windows/"
        ],
        "falsepositives": [
          "Legitimate use by administrators"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_nsudo.yml"
      }
    },
    {
      "id": "b1876533-4ed5-4a83-90f3-b8645840a413",
      "title": "HackTool - SafetyKatz Execution",
      "status": "test",
      "description": "Detects the execution of the hacktool SafetyKatz via PE information and default Image name",
      "level": "critical",
      "tags": [
        "attack.credential-access",
        "attack.t1003.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\SafetyKatz.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "SafetyKatz.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "SafetyKatz",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.001"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-10-20",
        "modified": "2023-02-04",
        "references": [
          "https://github.com/GhostPack/SafetyKatz"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_safetykatz.yml"
      }
    },
    {
      "id": "5722dff1-4bdd-4949-86ab-fbaf707e767a",
      "title": "PUA - System Informer Execution",
      "status": "test",
      "description": "Detects the execution of System Informer, a task manager tool to view and manipulate processes, kernel options and other low level operations",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.privilege-escalation",
        "attack.discovery",
        "attack.defense-evasion",
        "attack.t1082",
        "attack.t1564",
        "attack.t1543"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\SystemInformer.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "SystemInformer.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "System Informer",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Product": {
                    "field": "Product",
                    "value": "System Informer",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Hashes__contains": {
                    "field": "Hashes",
                    "value": [
                      "MD5=19426363A37C03C3ED6FEDF57B6696EC",
                      "SHA1=8B12C6DA8FAC0D5E8AB999C31E5EA04AF32D53DC",
                      "SHA256=8EE9D84DE50803545937A63C686822388A3338497CDDB660D5D69CF68B68F287",
                      "IMPHASH=B68908ADAEB5D662F87F2528AF318F12"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1082",
          "T1564",
          "T1543"
        ],
        "tactics": [
          "persistence",
          "privilege_escalation",
          "discovery",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2023-05-08",
        "modified": "2024-11-23",
        "references": [
          "https://github.com/winsiderss/systeminformer"
        ],
        "falsepositives": [
          "System Informer is regularly used legitimately by system administrators or developers. Apply additional filters accordingly"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_system_informer.yml"
      }
    },
    {
      "id": "4a0b2c7e-7cb2-495d-8b63-5f268e7bfd67",
      "title": "Renamed ProcDump Execution",
      "status": "test",
      "description": "Detects the execution of a renamed ProcDump executable.\nThis often done by attackers or malware in order to evade defensive mechanisms.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_ofn": {
            "type": "field_match",
            "matchers": {
              "OriginalFileName": {
                "field": "OriginalFileName",
                "value": "procdump",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli_dump_flag": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -ma ",
                  " -mp "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_eula_flag": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " /accepteula",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_known_names": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\procdump.exe",
                  "\\procdump64.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "(selection_ofn or all of selection_cli_*) and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "(selection_ofn",
            "all of selection_cli_*) and not 1 of filter_main_*"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1036.003"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2019-11-18",
        "modified": "2024-06-25",
        "references": [
          "https://learn.microsoft.com/en-us/sysinternals/downloads/procdump"
        ],
        "falsepositives": [
          "Procdump illegally bundled with legitimate software.",
          "Administrators who rename binaries (should be investigated)."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_renamed_sysinternals_procdump.yml"
      }
    },
    {
      "id": "f7d7ebd5-a016-46e2-9c54-f9932f2d386d",
      "title": "Potential RDP Tunneling Via SSH",
      "status": "test",
      "description": "Execution of ssh.exe to perform data exfiltration and tunneling through RDP",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1572"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\ssh.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": ":3389",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1572"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-10-12",
        "modified": "2023-01-25",
        "references": [
          "https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_ssh_rdp_tunneling.yml"
      }
    },
    {
      "id": "15619216-e993-4721-b590-4c520615a67d",
      "title": "Potential Meterpreter/CobaltStrike Activity",
      "status": "test",
      "description": "Detects the use of getsystem Meterpreter/Cobalt Strike command by detecting a specific service starting",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1134.001",
        "attack.t1134.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\services.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_technique_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/c",
                  "echo",
                  "\\pipe\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "cmd",
                  "%COMSPEC%"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_technique_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "rundll32",
                  ".dll,a",
                  "/p:"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_defender": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "MpCmdRun",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection_img and 1 of selection_technique_* and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_img"
            },
            {
              "type": "ref",
              "value": "1 of selection_technique_*"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1134.001",
          "T1134.002"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Teymur Kheirkhabarov, Ecco, Florian Roth",
        "date": "2019-10-26",
        "modified": "2023-02-05",
        "references": [
          "https://speakerdeck.com/heirhabarov/hunting-for-privilege-escalation-in-windows-environment",
          "https://blog.cobaltstrike.com/2014/04/02/what-happens-when-i-type-getsystem/"
        ],
        "falsepositives": [
          "Commandlines containing components like cmd accidentally",
          "Jobs and services started with cmd"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_meterpreter_getsystem.yml"
      }
    },
    {
      "id": "8de1cbe8-d6f5-496d-8237-5f44a721c7a0",
      "title": "Whoami.EXE Execution Anomaly",
      "status": "test",
      "description": "Detects the execution of whoami.exe with suspicious parent processes.",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.t1033",
        "car.2016-03-001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\whoami.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "whoami.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_main_known_parents": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\cmd.exe",
                  "\\powershell_ise.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_ms_monitoring_agent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": ":\\Program Files\\Microsoft Monitoring Agent\\Agent\\MonitoringHost.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_parent_null": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_parent_empty": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": [
                  "",
                  "-"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1033"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-08-12",
        "modified": "2025-03-06",
        "references": [
          "https://brica.de/alerts/alert/public/1247926/agent-tesla-keylogger-delivered-inside-a-power-iso-daa-archive/",
          "https://app.any.run/tasks/7eaba74e-c1ea-400f-9c17-5e30eee89906/",
          "https://www.youtube.com/watch?v=DsJ9ByX84o4&t=6s"
        ],
        "falsepositives": [
          "Admin activity",
          "Scripts and administrative tools used in the monitored environment",
          "Monitoring activity"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_whoami_parent_anomaly.yml"
      }
    },
    {
      "id": "e5d36acd-acb4-4c6f-a13f-9eb203d50099",
      "title": "Active Directory Structure Export Via Csvde.EXE",
      "status": "test",
      "description": "Detects the execution of \"csvde.exe\" in order to export organizational Active Directory structure.",
      "level": "medium",
      "tags": [
        "attack.exfiltration",
        "attack.discovery",
        "attack.t1087.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\csvde.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "csvde.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_remote": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -f",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_import": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -i",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_"
        }
      },
      "mitre": {
        "techniques": [
          "T1087.002"
        ],
        "tactics": [
          "exfiltration",
          "discovery"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-03-14",
        "modified": "",
        "references": [
          "https://www.cybereason.com/blog/research/operation-ghostshell-novel-rat-targets-global-aerospace-and-telecoms-firms",
          "https://web.archive.org/web/20180725233601/https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf",
          "https://businessinsights.bitdefender.com/deep-dive-into-a-backdoordiplomacy-attack-a-study-of-an-attackers-toolkit",
          "https://redcanary.com/blog/msix-installers/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_csvde_export.yml"
      }
    },
    {
      "id": "b655a06a-31c0-477a-95c2-3726b83d649d",
      "title": "Suspicious Userinit Child Process",
      "status": "test",
      "description": "Detects a suspicious child process of userinit",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.defense-evasion",
        "attack.t1055"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\userinit.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_netlogon": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "\\netlogon\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_explorer": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\explorer.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "explorer.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine": {
                    "field": "CommandLine",
                    "value": "C:\\Windows\\Explorer.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "filter_main_null": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1055"
        ],
        "tactics": [
          "privilege_escalation",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Samir Bousseaden (idea)",
        "date": "2019-06-17",
        "modified": "2025-10-17",
        "references": [
          "https://twitter.com/SBousseaden/status/1139811587760562176"
        ],
        "falsepositives": [
          "Administrative scripts"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_userinit_child.yml"
      }
    },
    {
      "id": "cc4e02ba-9c06-48e2-b09e-2500cace9ae0",
      "title": "Tasks Folder Evasion",
      "status": "test",
      "description": "The Tasks folder in system32 and syswow64 are globally writable paths.\nAdversaries can take advantage of this and load or influence any script hosts or ANY .NET Application\nin Tasks to load and execute a custom assembly into cscript, wscript, regsvr32, mshta, eventvwr\n",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.defense-evasion",
        "attack.persistence",
        "attack.execution",
        "attack.t1574.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "echo ",
                  "copy ",
                  "type ",
                  "file createnew"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " C:\\Windows\\System32\\Tasks\\",
                  " C:\\Windows\\SysWow64\\Tasks\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1574.001"
        ],
        "tactics": [
          "privilege_escalation",
          "defense_evasion",
          "persistence",
          "execution"
        ]
      },
      "meta": {
        "author": "Sreeman",
        "date": "2020-01-13",
        "modified": "2022-12-25",
        "references": [
          "https://twitter.com/subTee/status/1216465628946563073",
          "https://gist.github.com/am0nsec/8378da08f848424e4ab0cc5b317fdd26"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_task_folder_evasion.yml"
      }
    },
    {
      "id": "9c14c9fa-1a63-4a64-8e57-d19280559490",
      "title": "Invoke-Obfuscation Via Stdin",
      "status": "test",
      "description": "Detects Obfuscated Powershell via Stdin in Scripts",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027",
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__re": {
                "field": "CommandLine",
                "value": "(?i)(set).*&&\\s?set.*(environment|invoke|\\$\\{?input).*&&.*\"",
                "modifiers": [
                  "re"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1027",
          "T1059.001"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Nikita Nazarov, oscd.community",
        "date": "2020-10-12",
        "modified": "2024-04-16",
        "references": [
          "https://github.com/SigmaHQ/sigma/issues/1009"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_invoke_obfuscation_via_stdin.yml"
      }
    },
    {
      "id": "8b93a509-1cb8-42e1-97aa-ee24224cdc15",
      "title": "Sensitive File Dump Via Wbadmin.EXE",
      "status": "test",
      "description": "Detects the dump of highly sensitive files such as \"NTDS.DIT\" and \"SECURITY\" hive.\nAttackers can leverage the \"wbadmin\" utility in order to dump sensitive files that might contain credential or sensitive information.\n",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\wbadmin.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "WBADMIN.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_backup": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "start",
                  "backup"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_path": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\config\\SAM",
                  "\\config\\SECURITY",
                  "\\config\\SYSTEM",
                  "\\Windows\\NTDS\\NTDS.dit"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.003"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), frack113",
        "date": "2024-05-10",
        "modified": "",
        "references": [
          "https://github.com/LOLBAS-Project/LOLBAS/blob/2cc01b01132b5c304027a658c698ae09dd6a92bf/yml/OSBinaries/Wbadmin.yml",
          "https://lolbas-project.github.io/lolbas/Binaries/Wbadmin/",
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wbadmin-start-recovery",
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wbadmin-start-backup"
        ],
        "falsepositives": [
          "Legitimate backup operation by authorized administrators. Matches must be investigated and allowed on a case by case basis."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wbadmin_dump_sensitive_files.yml"
      }
    },
    {
      "id": "cb9cc1d1-e84e-4bdc-b7ad-c31b1b7908ec",
      "title": "Insecure Transfer Via Curl.EXE",
      "status": "test",
      "description": "Detects execution of \"curl.exe\" with the \"--insecure\" flag.",
      "level": "medium",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\curl.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "curl.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__re": {
                    "field": "CommandLine",
                    "value": "\\s-k\\s",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": "--insecure",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "X__Junior (Nextron Systems)",
        "date": "2023-06-30",
        "modified": "",
        "references": [
          "https://curl.se/docs/manpage.html"
        ],
        "falsepositives": [
          "Access to badly maintained internal or development systems"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_curl_insecure_connection.yml"
      }
    },
    {
      "id": "f9578658-9e71-4711-b634-3f9b50cd3c06",
      "title": "Potential Defense Evasion Activity Via Emoji Usage In CommandLine - 3",
      "status": "test",
      "description": "Detects the usage of emojis in the command line, this could be a sign of potential defense evasion activity.",
      "level": "high",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "🦆",
                  "🦅",
                  "🦉",
                  "🦇",
                  "🐺",
                  "🐗",
                  "🐴",
                  "🦄",
                  "🐝",
                  "🪱",
                  "🐛",
                  "🦋",
                  "🐌",
                  "🐞",
                  "🐜",
                  "🪰",
                  "🪲",
                  "🪳",
                  "🦟",
                  "🦗",
                  "🕷",
                  "🕸",
                  "🦂",
                  "🐢",
                  "🐍",
                  "🦎",
                  "🦖",
                  "🦕",
                  "🐙",
                  "🦑",
                  "🦐",
                  "🦞",
                  "🦀",
                  "🪸",
                  "🐡",
                  "🐠",
                  "🐟",
                  "🐬",
                  "🐳",
                  "🐋",
                  "🦈",
                  "🐊",
                  "🐅",
                  "🐆",
                  "🦓",
                  "🦍",
                  "🦧",
                  "🦣",
                  "🐘",
                  "🦛",
                  "🦏",
                  "🐪",
                  "🐫",
                  "🦒",
                  "🦘",
                  "🦬",
                  "🐃",
                  "🐂",
                  "🐄",
                  "🐎",
                  "🐖",
                  "🐏",
                  "🐑",
                  "🦙",
                  "🐐",
                  "🦌",
                  "🐕",
                  "🐩",
                  "🦮",
                  "🐕‍🦺",
                  "🐈",
                  "🐈‍⬛",
                  "🪶",
                  "🐓",
                  "🦃",
                  "🦤",
                  "🦚",
                  "🦜",
                  "🦢",
                  "🦩",
                  "🕊",
                  "🐇",
                  "🦝",
                  "🦨",
                  "🦡",
                  "🦫",
                  "🦦",
                  "🦥",
                  "🐁",
                  "🐀",
                  "🐿",
                  "🦔",
                  "🐾",
                  "🐉",
                  "🐲",
                  "🌵",
                  "🎄",
                  "🌲",
                  "🌳",
                  "🌴",
                  "🪹",
                  "🪺",
                  "🪵",
                  "🌱",
                  "🌿",
                  "☘️",
                  "🍀",
                  "🎍",
                  "🪴",
                  "🎋",
                  "🍃",
                  "🍂",
                  "🍁",
                  "🍄",
                  "🐚",
                  "🪨",
                  "🌾",
                  "💐",
                  "🌷",
                  "🪷",
                  "🌹",
                  "🥀",
                  "🌺",
                  "🌸",
                  "🌼",
                  "🌻",
                  "🌞",
                  "🌝",
                  "🌛",
                  "🌜",
                  "🌚",
                  "🌕",
                  "🌖",
                  "🌗",
                  "🌘",
                  "🌑",
                  "🌒",
                  "🌓",
                  "🌔",
                  "🌙",
                  "🌎",
                  "🌍",
                  "🌏",
                  "🪐",
                  "💫",
                  "⭐️",
                  "🌟",
                  "✨",
                  "⚡️",
                  "☄️",
                  "💥",
                  "🔥",
                  "🌪",
                  "🌈",
                  "☀️",
                  "🌤",
                  "⛅️",
                  "🌥",
                  "☁️",
                  "🌦",
                  "🌧",
                  "⛈",
                  "🌩",
                  "🌨",
                  "❄️",
                  "☃️",
                  "⛄️",
                  "🌬",
                  "💨",
                  "💧",
                  "💦",
                  "🫧",
                  "☔️",
                  "☂️",
                  "🌊",
                  "🌫🍏",
                  "🍎",
                  "🍐",
                  "🍊",
                  "🍋",
                  "🍌",
                  "🍉",
                  "🍇",
                  "🍓",
                  "🫐",
                  "🍈",
                  "🍒",
                  "🍑",
                  "🥭",
                  "🍍",
                  "🥥",
                  "🥝",
                  "🍅",
                  "🍆",
                  "🥑",
                  "🥦",
                  "🥬",
                  "🥒",
                  "🌶",
                  "🫑",
                  "🌽",
                  "🥕",
                  "🫒",
                  "🧄",
                  "🧅",
                  "🥔",
                  "🍠",
                  "🫘",
                  "🥐",
                  "🥯",
                  "🍞",
                  "🥖",
                  "🥨",
                  "🧀",
                  "🥚",
                  "🍳",
                  "🧈",
                  "🥞",
                  "🧇",
                  "🥓",
                  "🥩",
                  "🍗",
                  "🍖",
                  "🦴",
                  "🌭",
                  "🍔",
                  "🍟",
                  "🍕",
                  "🫓",
                  "🥪",
                  "🥙",
                  "🧆",
                  "🌮",
                  "🌯",
                  "🫔",
                  "🥗",
                  "🥘",
                  "🫕",
                  "🥫",
                  "🍝",
                  "🍜",
                  "🍲",
                  "🍛",
                  "🍣",
                  "🍱",
                  "🥟",
                  "🦪",
                  "🍤",
                  "🍙",
                  "🍚",
                  "🍘",
                  "🍥",
                  "🥠",
                  "🥮",
                  "🍢",
                  "🍡",
                  "🍧",
                  "🍨",
                  "🍦",
                  "🥧",
                  "🧁",
                  "🍰",
                  "🎂",
                  "🍮",
                  "🍭",
                  "🍬",
                  "🍫",
                  "🍿",
                  "🍩",
                  "🍪",
                  "🌰",
                  "🥜",
                  "🍯",
                  "🥛",
                  "🍼",
                  "🫖",
                  "☕️",
                  "🍵",
                  "🧃",
                  "🥤",
                  "🧋",
                  "🫙",
                  "🍶",
                  "🍺",
                  "🍻",
                  "🥂",
                  "🍷",
                  "🫗",
                  "🥃",
                  "🍸",
                  "🍹",
                  "🧉",
                  "🍾",
                  "🧊",
                  "🥄",
                  "🍴",
                  "🍽",
                  "🥣",
                  "🥡",
                  "🥢",
                  "🧂",
                  "⚽️",
                  "🏀",
                  "🏈",
                  "⚾️",
                  "🥎",
                  "🎾",
                  "🏐",
                  "🏉",
                  "🥏",
                  "🎱",
                  "🪀",
                  "🏓",
                  "🏸",
                  "🏒",
                  "🏑",
                  "🥍",
                  "🏏",
                  "🪃",
                  "🥅",
                  "⛳️",
                  "🪁",
                  "🏹",
                  "🎣",
                  "🤿",
                  "🥊",
                  "🥋",
                  "🎽",
                  "🛹",
                  "🛼",
                  "🛷",
                  "⛸",
                  "🥌",
                  "🎿",
                  "⛷",
                  "🏂",
                  "🪂",
                  "🏋️‍♀️",
                  "🏋️",
                  "🏋️‍♂️",
                  "🤼‍♀️",
                  "🤼",
                  "🤼‍♂️",
                  "🤸‍♀️",
                  "🤸",
                  "🤸‍♂️",
                  "⛹️‍♀️",
                  "⛹️",
                  "⛹️‍♂️",
                  "🤺",
                  "🤾‍♀️",
                  "🤾",
                  "🤾‍♂️",
                  "🏌️‍♀️",
                  "🏌️",
                  "🏌️‍♂️",
                  "🏇",
                  "🧘‍♀️",
                  "🧘",
                  "🧘‍♂️",
                  "🏄‍♀️",
                  "🏄",
                  "🏄‍♂️",
                  "🏊‍♀️",
                  "🏊",
                  "🏊‍♂️",
                  "🤽‍♀️",
                  "🤽",
                  "🤽‍♂️",
                  "🚣‍♀️",
                  "🚣",
                  "🚣‍♂️",
                  "🧗‍♀️",
                  "🧗",
                  "🧗‍♂️",
                  "🚵‍♀️",
                  "🚵",
                  "🚵‍♂️",
                  "🚴‍♀️",
                  "🚴",
                  "🚴‍♂️",
                  "🏆",
                  "🥇",
                  "🥈",
                  "🥉",
                  "🏅",
                  "🎖",
                  "🏵",
                  "🎗",
                  "🎫",
                  "🎟",
                  "🎪",
                  "🤹",
                  "🤹‍♂️",
                  "🤹‍♀️",
                  "🎭",
                  "🩰",
                  "🎨",
                  "🎬",
                  "🎤",
                  "🎧",
                  "🎼",
                  "🎹",
                  "🥁",
                  "🪘",
                  "🎷",
                  "🎺",
                  "🪗",
                  "🎸",
                  "🪕",
                  "🎻",
                  "🎲",
                  "♟",
                  "🎯",
                  "🎳",
                  "🎮",
                  "🎰",
                  "🧩",
                  "🚗",
                  "🚕",
                  "🚙",
                  "🚌",
                  "🚎",
                  "🏎",
                  "🚓",
                  "🚑",
                  "🚒",
                  "🚐",
                  "🛻",
                  "🚚",
                  "🚛",
                  "🚜",
                  "🦯",
                  "🦽",
                  "🦼",
                  "🛴",
                  "🚲",
                  "🛵",
                  "🏍",
                  "🛺",
                  "🚨",
                  "🚔",
                  "🚍",
                  "🚘",
                  "🚖",
                  "🛞",
                  "🚡",
                  "🚠",
                  "🚟",
                  "🚃",
                  "🚋",
                  "🚞",
                  "🚝",
                  "🚄",
                  "🚅",
                  "🚈",
                  "🚂",
                  "🚆",
                  "🚇",
                  "🚊",
                  "🚉",
                  "✈️",
                  "🛫",
                  "🛬",
                  "🛩",
                  "💺",
                  "🛰",
                  "🚀",
                  "🛸",
                  "🚁",
                  "🛶",
                  "⛵️",
                  "🚤",
                  "🛥",
                  "🛳",
                  "⛴",
                  "🚢",
                  "⚓️",
                  "🛟",
                  "🪝",
                  "⛽️",
                  "🚧",
                  "🚦",
                  "🚥",
                  "🚏",
                  "🗺",
                  "🗿",
                  "🗽",
                  "🗼",
                  "🏰",
                  "🏯",
                  "🏟",
                  "🎡",
                  "🎢",
                  "🛝",
                  "🎠",
                  "⛲️",
                  "⛱",
                  "🏖",
                  "🏝",
                  "🏜",
                  "🌋",
                  "⛰",
                  "🏔",
                  "🗻",
                  "🏕",
                  "⛺️",
                  "🛖",
                  "🏠",
                  "🏡",
                  "🏘",
                  "🏚",
                  "🏗",
                  "🏭",
                  "🏢",
                  "🏬",
                  "🏣",
                  "🏤",
                  "🏥",
                  "🏦",
                  "🏨",
                  "🏪",
                  "🏫",
                  "🏩",
                  "💒",
                  "🏛",
                  "⛪️",
                  "🕌",
                  "🕍",
                  "🛕",
                  "🕋",
                  "⛩",
                  "🛤",
                  "🛣",
                  "🗾",
                  "🎑",
                  "🏞",
                  "🌅",
                  "🌄",
                  "🌠",
                  "🎇",
                  "🎆",
                  "🌇",
                  "🌆",
                  "🏙",
                  "🌃",
                  "🌌",
                  "🌉",
                  "🌁",
                  "⌚️",
                  "📱",
                  "📲",
                  "💻",
                  "⌨️",
                  "🖥",
                  "🖨",
                  "🖱",
                  "🖲",
                  "🕹",
                  "🗜",
                  "💽",
                  "💾",
                  "💿",
                  "📀",
                  "📼",
                  "📷",
                  "📸",
                  "📹",
                  "🎥",
                  "📽",
                  "🎞",
                  "📞",
                  "☎️",
                  "📟",
                  "📠",
                  "📺",
                  "📻",
                  "🎙",
                  "🎚",
                  "🎛",
                  "🧭",
                  "⏱",
                  "⏲",
                  "⏰",
                  "🕰",
                  "⌛️",
                  "⏳",
                  "📡",
                  "🔋",
                  "🪫",
                  "🔌",
                  "💡",
                  "🔦",
                  "🕯",
                  "🪔",
                  "🧯",
                  "🛢",
                  "💸",
                  "💵",
                  "💴",
                  "💶",
                  "💷",
                  "🪙",
                  "💰",
                  "💳",
                  "💎",
                  "⚖️",
                  "🪜",
                  "🧰",
                  "🪛",
                  "🔧",
                  "🔨",
                  "⚒",
                  "🛠",
                  "⛏",
                  "🪚",
                  "🔩",
                  "⚙️",
                  "🪤",
                  "🧱",
                  "⛓",
                  "🧲",
                  "🔫",
                  "💣",
                  "🧨",
                  "🪓",
                  "🔪",
                  "🗡",
                  "⚔️",
                  "🛡",
                  "🚬",
                  "⚰️",
                  "🪦",
                  "⚱️",
                  "🏺",
                  "🔮",
                  "📿",
                  "🧿",
                  "🪬",
                  "💈",
                  "⚗️",
                  "🔭",
                  "🔬",
                  "🕳",
                  "🩹",
                  "🩺",
                  "🩻",
                  "🩼",
                  "💊",
                  "💉",
                  "🩸",
                  "🧬",
                  "🦠",
                  "🧫",
                  "🧪",
                  "🌡",
                  "🧹",
                  "🪠",
                  "🧺",
                  "🧻",
                  "🚽",
                  "🚰",
                  "🚿",
                  "🛁",
                  "🛀",
                  "🧼",
                  "🪥",
                  "🪒",
                  "🧽",
                  "🪣",
                  "🧴",
                  "🛎",
                  "🔑",
                  "🗝",
                  "🚪",
                  "🪑",
                  "🛋",
                  "🛏",
                  "🛌",
                  "🧸",
                  "🪆",
                  "🖼",
                  "🪞",
                  "🪟",
                  "🛍",
                  "🛒",
                  "🎁",
                  "🎈",
                  "🎏",
                  "🎀",
                  "🪄",
                  "🪅",
                  "🎊",
                  "🎉",
                  "🪩",
                  "🎎",
                  "🏮",
                  "🎐",
                  "🧧",
                  "✉️",
                  "📩",
                  "📨",
                  "📧",
                  "💌",
                  "📥",
                  "📤",
                  "📦",
                  "🏷",
                  "🪧",
                  "📪",
                  "📫",
                  "📬",
                  "📭",
                  "📮",
                  "📯",
                  "📜",
                  "📃",
                  "📄",
                  "📑",
                  "🧾",
                  "📊",
                  "📈",
                  "📉",
                  "🗒",
                  "🗓",
                  "📆",
                  "📅",
                  "🗑",
                  "🪪",
                  "📇",
                  "🗃",
                  "🗳",
                  "🗄",
                  "📋",
                  "📁",
                  "📂",
                  "🗂",
                  "🗞",
                  "📰",
                  "📓",
                  "📔",
                  "📒",
                  "📕",
                  "📗",
                  "📘",
                  "📙",
                  "📚",
                  "📖",
                  "🔖",
                  "🧷",
                  "🔗",
                  "📎",
                  "🖇",
                  "📐",
                  "📏",
                  "🧮",
                  "📌",
                  "📍",
                  "✂️",
                  "🖊",
                  "🖋",
                  "✒️",
                  "🖌",
                  "🖍",
                  "📝",
                  "✏️",
                  "🔍",
                  "🔎",
                  "🔏",
                  "🔐",
                  "🔒",
                  "🔓❤️",
                  "🧡",
                  "💛",
                  "💚",
                  "💙",
                  "💜",
                  "🖤",
                  "🤍",
                  "🤎",
                  "❤️‍🔥",
                  "❤️‍🩹",
                  "💔",
                  "❣️",
                  "💕",
                  "💞",
                  "💓",
                  "💗",
                  "💖",
                  "💘",
                  "💝",
                  "💟",
                  "☮️",
                  "✝️",
                  "☪️",
                  "🕉",
                  "☸️",
                  "✡️",
                  "🔯",
                  "🕎",
                  "☯️",
                  "☦️",
                  "🛐",
                  "⛎",
                  "♈️",
                  "♉️",
                  "♊️",
                  "♋️",
                  "♌️",
                  "♍️",
                  "♎️",
                  "♏️",
                  "♐️",
                  "♑️",
                  "♒️",
                  "♓️",
                  "🆔",
                  "⚛️",
                  "🉑",
                  "☢️",
                  "☣️",
                  "📴",
                  "📳",
                  "🈶",
                  "🈚️",
                  "🈸",
                  "🈺",
                  "🈷️",
                  "✴️",
                  "🆚",
                  "💮",
                  "🉐",
                  "㊙️",
                  "㊗️",
                  "🈴",
                  "🈵",
                  "🈹",
                  "🈲",
                  "🅰️",
                  "🅱️",
                  "🆎",
                  "🆑",
                  "🅾️",
                  "🆘",
                  "❌",
                  "⭕️",
                  "🛑",
                  "⛔️",
                  "📛",
                  "🚫",
                  "💯",
                  "💢",
                  "♨️",
                  "🚷",
                  "🚯",
                  "🚳",
                  "🚱",
                  "🔞",
                  "📵",
                  "🚭",
                  "❗️",
                  "❕",
                  "❓",
                  "❔",
                  "‼️",
                  "⁉️",
                  "🔅",
                  "🔆",
                  "〽️",
                  "⚠️",
                  "🚸",
                  "🔱",
                  "⚜️",
                  "🔰",
                  "♻️",
                  "✅",
                  "🈯️",
                  "💹",
                  "❇️",
                  "✳️",
                  "❎",
                  "🌐",
                  "💠",
                  "Ⓜ️",
                  "🌀",
                  "💤",
                  "🏧",
                  "🚾",
                  "♿️",
                  "🅿️",
                  "🛗",
                  "🈳",
                  "🈂️",
                  "🛂",
                  "🛃",
                  "🛄",
                  "🛅",
                  "🚹",
                  "🚺",
                  "🚼",
                  "⚧",
                  "🚻",
                  "🚮",
                  "🎦",
                  "📶",
                  "🈁",
                  "🔣",
                  "ℹ️",
                  "🔤",
                  "🔡",
                  "🔠",
                  "🆖",
                  "🆗",
                  "🆙",
                  "🆒",
                  "🆕",
                  "🆓",
                  "0️⃣",
                  "1️⃣",
                  "2️⃣",
                  "3️⃣",
                  "4️⃣",
                  "5️⃣",
                  "6️⃣",
                  "7️⃣",
                  "8️⃣",
                  "9️⃣",
                  "🔟",
                  "🔢",
                  "#️⃣",
                  "*️⃣",
                  "⏏️",
                  "▶️",
                  "⏸",
                  "⏯",
                  "⏹",
                  "⏺",
                  "⏭",
                  "⏮",
                  "⏩",
                  "⏪",
                  "⏫",
                  "⏬",
                  "◀️",
                  "🔼",
                  "🔽",
                  "➡️",
                  "⬅️",
                  "⬆️",
                  "⬇️",
                  "↗️",
                  "↘️",
                  "↙️",
                  "↖️",
                  "↕️",
                  "↔️",
                  "↪️",
                  "↩️",
                  "⤴️",
                  "⤵️",
                  "🔀",
                  "🔁",
                  "🔂",
                  "🔄",
                  "🔃",
                  "🎵",
                  "🎶",
                  "➕",
                  "➖",
                  "➗",
                  "✖️",
                  "🟰",
                  "♾",
                  "💲",
                  "💱",
                  "™️",
                  "©️",
                  "®️",
                  "〰️",
                  "➰",
                  "➿",
                  "🔚",
                  "🔙",
                  "🔛",
                  "🔝",
                  "🔜",
                  "✔️",
                  "☑️",
                  "🔘",
                  "🔴",
                  "🟠",
                  "🟡",
                  "🟢",
                  "🔵",
                  "🟣",
                  "⚫️",
                  "⚪️",
                  "🟤",
                  "🔺",
                  "🔻"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "@Kostastsale, TheDFIRReport",
        "date": "2022-12-05",
        "modified": "",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_emoji_usage_in_cli_3.yml"
      }
    },
    {
      "id": "a77c1610-fc73-4019-8e29-0f51efc04a51",
      "title": "Potential Dosfuscation Activity",
      "status": "test",
      "description": "Detects possible payload obfuscation via the commandline",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "^^",
                  "^|^",
                  ",;,",
                  ";;;;",
                  ";; ;;",
                  "(,(,",
                  "%COMSPEC:~",
                  " c^m^d",
                  "^c^m^d",
                  " c^md",
                  " cm^d",
                  "^cm^d",
                  " s^et ",
                  " s^e^t ",
                  " se^t "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-02-15",
        "modified": "2023-03-06",
        "references": [
          "https://www.fireeye.com/content/dam/fireeye-www/blog/pdfs/dosfuscation-report.pdf",
          "https://github.com/danielbohannon/Invoke-DOSfuscation"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_cmd_dosfuscation.yml"
      }
    },
    {
      "id": "dd8756e7-a3a0-4768-b47e-8f545d1a751c",
      "title": "Suspicious LNK Command-Line Padding with Whitespace Characters",
      "status": "experimental",
      "description": "Detects exploitation of LNK file command-line length discrepancy, where attackers hide malicious commands beyond the 260-character UI limit while the actual command-line argument field supports 4096 characters using whitespace padding (e.g., 0x20, 0x09-0x0D).\nAdversaries insert non-printable whitespace characters (e.g., Line Feed \\x0A, Carriage Return \\x0D) to pad the visible section of the LNK file, pushing malicious commands past the UI-visible boundary.\nThe hidden payload, executed at runtime but invisible in Windows Explorer properties, enables stealthy execution and evasion—commonly used for social engineering attacks.\nThis rule flags suspicious use of such padding observed in real-world attacks.\n",
      "level": "high",
      "tags": [
        "attack.initial-access",
        "attack.execution",
        "attack.t1204.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "ParentImage__endswith": {
                    "field": "ParentImage",
                    "value": "\\explorer.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "ParentCommandLine__contains": {
                    "field": "ParentCommandLine",
                    "value": ".lnk",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cmd": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      "                 ",
                      "\\u0009",
                      "\\u000A",
                      "\\u0011",
                      "\\u0012",
                      "\\u0013",
                      "\\u000B",
                      "\\u000C",
                      "\\u000D"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__re": {
                    "field": "CommandLine",
                    "value": "\\n\\n\\n\\n\\n\\n",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1204.002"
        ],
        "tactics": [
          "initial_access",
          "execution"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-03-19",
        "modified": "",
        "references": [
          "https://syedhasan010.medium.com/forensics-analysis-of-an-lnk-file-da68a98b8415",
          "https://thehackernews.com/2025/03/unpatched-windows-zero-day-flaw.html",
          "https://www.trendmicro.com/en_us/research/25/c/windows-shortcut-zero-day-exploit.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_lnk_exec_hidden_cmd.yml"
      }
    },
    {
      "id": "40b95d31-1afc-469e-8d34-9a3a667d058e",
      "title": "Suspicious Csi.exe Usage",
      "status": "test",
      "description": "Csi.exe is a signed binary from Microsoft that comes with Visual Studio and provides C# interactive capabilities. It can be used to run C# code from a file passed as a parameter in command line. Early version of this utility provided with Microsoft “Roslyn” Community Technology Preview was named 'rcsi.exe'",
      "level": "medium",
      "tags": [
        "attack.lateral-movement",
        "attack.execution",
        "attack.t1072",
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\csi.exe",
                      "\\rcsi.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "csi.exe",
                      "rcsi.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "Company": {
                "field": "Company",
                "value": "Microsoft Corporation",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1072",
          "T1218"
        ],
        "tactics": [
          "lateral_movement",
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Konstantin Grishchenko, oscd.community",
        "date": "2020-10-17",
        "modified": "2022-07-11",
        "references": [
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Csi/",
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Rcsi/",
          "https://enigma0x3.net/2016/11/21/bypassing-application-whitelisting-by-using-rcsi-exe/",
          "https://twitter.com/Z3Jpa29z/status/1317545798981324801"
        ],
        "falsepositives": [
          "Legitimate usage by software developers"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_csi_execution.yml"
      }
    },
    {
      "id": "4a6713f6-3331-11ed-a261-0242ac120002",
      "title": "Taskkill Symantec Endpoint Protection",
      "status": "test",
      "description": "Detects one of the possible scenarios for disabling Symantec Endpoint Protection.\nSymantec Endpoint Protection antivirus software services incorrectly implement the protected service mechanism.\nAs a result, the NT AUTHORITY/SYSTEM user can execute the taskkill /im command several times ccSvcHst.exe /f, thereby killing the process belonging to the service, and thus shutting down the service.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "taskkill",
                  " /F ",
                  " /IM ",
                  "ccSvcHst.exe"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Ilya Krestinichev, Florian Roth (Nextron Systems)",
        "date": "2022-09-13",
        "modified": "",
        "references": [
          "https://www.exploit-db.com/exploits/37525",
          "https://community.spiceworks.com/topic/2195015-batch-script-to-uninstall-symantec-endpoint-protection",
          "https://community.broadcom.com/symantecenterprise/communities/community-home/digestviewer/viewthread?MessageKey=6ce94b67-74e1-4333-b16f-000b7fd874f0&CommunityKey=1ecf5f55-9545-44d6-b0f4-4e4a7f5f5e68&tab=digestviewer"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_taskkill_sep.yml"
      }
    },
    {
      "id": "dc4576d4-7467-424f-9eee-fd2b02855fe0",
      "title": "Suspicious Cabinet File Execution Via Msdt.EXE",
      "status": "test",
      "description": "Detects execution of msdt.exe using the \"cab\" flag which could indicates suspicious diagcab files with embedded answer files leveraging CVE-2022-30190",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1202"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\msdt.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "msdt.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cmd": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -cab ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1202"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), GossiTheDog, frack113",
        "date": "2022-06-21",
        "modified": "2024-03-13",
        "references": [
          "https://twitter.com/nas_bench/status/1537896324837781506",
          "https://github.com/GossiTheDog/ThreatHunting/blob/e85884abbf05d5b41efc809ea6532b10b45bd05c/AdvancedHuntingQueries/DogWalk-DiagCab",
          "https://github.com/elastic/protections-artifacts/commit/746086721fd385d9f5c6647cada1788db4aea95f#diff-9015912909545e72ed42cbac4d1e96295e8964579c406d23fd9c47a8091576a0",
          "https://irsl.medium.com/the-trouble-with-microsofts-troubleshooters-6e32fc80b8bd"
        ],
        "falsepositives": [
          "Legitimate usage of \".diagcab\" files"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_msdt_susp_cab_options.yml"
      }
    },
    {
      "id": "ac20ae82-8758-4f38-958e-b44a3140ca88",
      "title": "Invoke-Obfuscation Via Use MSHTA",
      "status": "test",
      "description": "Detects Obfuscated Powershell via use MSHTA in Scripts",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027",
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "set",
                  "&&",
                  "mshta",
                  "vbscript:createobject",
                  ".run",
                  "(window.close)"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1027",
          "T1059.001"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Nikita Nazarov, oscd.community",
        "date": "2020-10-08",
        "modified": "2022-03-08",
        "references": [
          "https://github.com/SigmaHQ/sigma/issues/1009"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_invoke_obfuscation_via_use_mhsta.yml"
      }
    },
    {
      "id": "25676e10-2121-446e-80a4-71ff8506af47",
      "title": "Exchange PowerShell Snap-Ins Usage",
      "status": "test",
      "description": "Detects adding and using Exchange PowerShell snap-ins to export mailbox data. As seen used by HAFNIUM and APT27",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059.001",
        "attack.collection",
        "attack.t1114"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "Add-PSSnapin",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_module": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Microsoft.Exchange.Powershell.Snapin",
                  "Microsoft.Exchange.Management.PowerShell.SnapIn"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_msiexec": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": "C:\\Windows\\System32\\msiexec.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "$exserver=Get-ExchangeServer ([Environment]::MachineName) -ErrorVariable exerr 2> $null",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001",
          "T1114"
        ],
        "tactics": [
          "execution",
          "collection"
        ]
      },
      "meta": {
        "author": "FPT.EagleEye, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2021-03-03",
        "modified": "2023-03-24",
        "references": [
          "https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero-day-vulnerabilities/",
          "https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/",
          "https://www.intrinsec.com/apt27-analysis/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_snapins_hafnium.yml"
      }
    },
    {
      "id": "10c14723-61c7-4c75-92ca-9af245723ad2",
      "title": "HackTool - Potential Impacket Lateral Movement Activity",
      "status": "stable",
      "description": "Detects wmiexec/dcomexec/atexec/smbexec from Impacket framework",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1047",
        "attack.lateral-movement",
        "attack.t1021.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_other": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\wmiprvse.exe",
                  "\\mmc.exe",
                  "\\explorer.exe",
                  "\\services.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "cmd.exe",
                  "/Q",
                  "/c",
                  "\\\\\\\\127.0.0.1\\\\",
                  "&1"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_atexec": {
            "type": "field_match",
            "matchers": {
              "ParentCommandLine__contains": {
                "field": "ParentCommandLine",
                "value": [
                  "svchost.exe -k netsvcs",
                  "taskeng.exe"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "cmd.exe",
                  "/C",
                  "Windows\\Temp\\",
                  "&1"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1047",
          "T1021.003"
        ],
        "tactics": [
          "execution",
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Ecco, oscd.community, Jonhnathan Ribeiro, Tim Rauch",
        "date": "2019-09-03",
        "modified": "2023-02-21",
        "references": [
          "https://github.com/SecureAuthCorp/impacket/blob/8b1a99f7c715702eafe3f24851817bb64721b156/examples/wmiexec.py",
          "https://github.com/SecureAuthCorp/impacket/blob/8b1a99f7c715702eafe3f24851817bb64721b156/examples/atexec.py",
          "https://github.com/SecureAuthCorp/impacket/blob/8b1a99f7c715702eafe3f24851817bb64721b156/examples/smbexec.py",
          "https://github.com/SecureAuthCorp/impacket/blob/8b1a99f7c715702eafe3f24851817bb64721b156/examples/dcomexec.py",
          "https://www.elastic.co/guide/en/security/current/suspicious-cmd-execution-via-wmi.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_impacket_lateral_movement.yml"
      }
    },
    {
      "id": "f38ce0b9-5e97-4b47-a211-7dc8d8b871da",
      "title": "Potential RDP Tunneling Via Plink",
      "status": "test",
      "description": "Execution of plink to perform data exfiltration and tunneling",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1572"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_a": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\plink.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": ":127.0.0.1:3389",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_b1": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\plink.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": ":3389",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_b2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -P 443",
                  " -P 22"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_a or all of selection_b*",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection_a",
            "all of selection_b*"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1572"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-08-04",
        "modified": "2023-01-27",
        "references": [
          "https://www.microsoft.com/security/blog/2022/07/26/malicious-iis-extensions-quietly-open-persistent-backdoors-into-servers/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_plink_susp_tunneling.yml"
      }
    },
    {
      "id": "9cfe4b27-1e56-48b4-b7a8-d46851c91a44",
      "title": "MMC Executing Files with Reversed Extensions Using RTLO Abuse",
      "status": "experimental",
      "description": "Detects malicious behavior where the MMC utility (`mmc.exe`) executes files with reversed extensions caused by Right-to-Left Override (RLO) abuse, disguising them as document formats.",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1204.002",
        "attack.defense-evasion",
        "attack.t1218.014",
        "attack.t1036.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_image": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\mmc.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "MMC.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_commandline": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "cod.msc",
                  "fdp.msc",
                  "ftr.msc",
                  "lmth.msc",
                  "slx.msc",
                  "tdo.msc",
                  "xcod.msc",
                  "xslx.msc",
                  "xtpp.msc"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1204.002",
          "T1218.014",
          "T1036.002"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-02-05",
        "modified": "",
        "references": [
          "https://www.unicode.org/versions/Unicode5.2.0/ch02.pdf",
          "https://en.wikipedia.org/wiki/Right-to-left_override",
          "https://tria.ge/241015-l98snsyeje/behavioral2"
        ],
        "falsepositives": [
          "Legitimate administrative actions using MMC to execute misnamed `.msc` files.",
          "Unconventional but non-malicious usage of RLO or reversed extensions."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_mmc_rlo_abuse_pattern.yml"
      }
    },
    {
      "id": "c98f2a0d-e1b8-4f76-90d3-359caf88d6b9",
      "title": "Potential Defense Evasion Activity Via Emoji Usage In CommandLine - 2",
      "status": "test",
      "description": "Detects the usage of emojis in the command line, this could be a sign of potential defense evasion activity.",
      "level": "high",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "🤷🏼",
                  "🤷🏼‍♂️",
                  "🙎🏼‍♀️",
                  "🙎🏼",
                  "🙎🏼‍♂️",
                  "🙍🏼‍♀️",
                  "🙍🏼",
                  "🙍🏼‍♂️",
                  "💇🏼‍♀️",
                  "💇🏼",
                  "💇🏼‍♂️",
                  "💆🏼‍♀️",
                  "💆🏼",
                  "💆🏼‍♂️",
                  "🧖🏼‍♀️",
                  "🧖🏼",
                  "🧖🏼‍♂️",
                  "💃🏼",
                  "🕺🏼",
                  "🕴🏼",
                  "👩🏼‍🦽",
                  "🧑🏼‍🦽",
                  "👨🏼‍🦽",
                  "👩🏼‍🦼",
                  "🧑🏼‍🦼",
                  "👨🏼‍🦼",
                  "🚶🏼‍♀️",
                  "🚶🏼",
                  "🚶🏼‍♂️",
                  "👩🏼‍🦯",
                  "🧑🏼‍🦯",
                  "👨🏼‍🦯",
                  "🧎🏼‍♀️",
                  "🧎🏼",
                  "🧎🏼‍♂️",
                  "🏃🏼‍♀️",
                  "🏃🏼",
                  "🏃🏼‍♂️",
                  "🧍🏼‍♀️",
                  "🧍🏼",
                  "🧍🏼‍♂️",
                  "👭🏼",
                  "🧑🏼‍🤝‍🧑🏼",
                  "👬🏼",
                  "👫🏼",
                  "🧗🏼‍♀️",
                  "🧗🏼",
                  "🧗🏼‍♂️",
                  "🏇🏼",
                  "🏂🏼",
                  "🏌🏼‍♀️",
                  "🏌🏼",
                  "🏌🏼‍♂️",
                  "🏄🏼‍♀️",
                  "🏄🏼",
                  "🏄🏼‍♂️",
                  "🚣🏼‍♀️",
                  "🚣🏼",
                  "🚣🏼‍♂️",
                  "🏊🏼‍♀️",
                  "🏊🏼",
                  "🏊🏼‍♂️",
                  "⛹🏼‍♀️",
                  "⛹🏼",
                  "⛹🏼‍♂️",
                  "🏋🏼‍♀️",
                  "🏋🏼",
                  "🏋🏼‍♂️",
                  "🚴🏼‍♀️",
                  "🚴🏼",
                  "🚴🏼‍♂️",
                  "🚵🏼‍♀️",
                  "🚵🏼",
                  "🚵🏼‍♂️",
                  "🤸🏼‍♀️",
                  "🤸🏼",
                  "🤸🏼‍♂️",
                  "🤽🏼‍♀️",
                  "🤽🏼",
                  "🤽🏼‍♂️",
                  "🤾🏼‍♀️",
                  "🤾🏼",
                  "🤾🏼‍♂️",
                  "🤹🏼‍♀️",
                  "🤹🏼",
                  "🤹🏼‍♂️",
                  "🧘🏼‍♀️",
                  "🧘🏼",
                  "🧘🏼‍♂️",
                  "🛀🏼",
                  "🛌🏼",
                  "👋🏽",
                  "🤚🏽",
                  "🖐🏽",
                  "✋🏽",
                  "🖖🏽",
                  "👌🏽",
                  "🤌🏽",
                  "🤏🏽",
                  "✌🏽",
                  "🤞🏽",
                  "🫰🏽",
                  "🤟🏽",
                  "🤘🏽",
                  "🤙🏽",
                  "🫵🏽",
                  "🫱🏽",
                  "🫲🏽",
                  "🫳🏽",
                  "🫴🏽",
                  "👈🏽",
                  "👉🏽",
                  "👆🏽",
                  "🖕🏽",
                  "👇🏽",
                  "☝🏽",
                  "👍🏽",
                  "👎🏽",
                  "✊🏽",
                  "👊🏽",
                  "🤛🏽",
                  "🤜🏽",
                  "👏🏽",
                  "🫶🏽",
                  "🙌🏽",
                  "👐🏽",
                  "🤲🏽",
                  "🙏🏽",
                  "✍🏽",
                  "💪🏽",
                  "🦵🏽",
                  "🦶🏽",
                  "👂🏽",
                  "🦻🏽",
                  "👃🏽",
                  "👶🏽",
                  "👧🏽",
                  "🧒🏽",
                  "👦🏽",
                  "👩🏽",
                  "🧑🏽",
                  "👨🏽",
                  "👩🏽‍🦱",
                  "🧑🏽‍🦱",
                  "👨🏽‍🦱",
                  "👩🏽‍🦰",
                  "🧑🏽‍🦰",
                  "👨🏽‍🦰",
                  "👱🏽‍♀️",
                  "👱🏽",
                  "👱🏽‍♂️",
                  "👩🏽‍🦳",
                  "🧑🏽‍🦳",
                  "👨🏽‍🦳",
                  "👩🏽‍🦲",
                  "🧑🏽‍🦲",
                  "👨🏽‍🦲",
                  "🧔🏽‍♀️",
                  "🧔🏽",
                  "🧔🏽‍♂️",
                  "👵🏽",
                  "🧓🏽",
                  "👴🏽",
                  "👲🏽",
                  "👳🏽‍♀️",
                  "👳🏽",
                  "👳🏽‍♂️",
                  "🧕🏽",
                  "👮🏽‍♀️",
                  "👮🏽",
                  "👮🏽‍♂️",
                  "👷🏽‍♀️",
                  "👷🏽",
                  "👷🏽‍♂️",
                  "💂🏽‍♀️",
                  "💂🏽",
                  "💂🏽‍♂️",
                  "🕵🏽‍♀️",
                  "🕵🏽",
                  "🕵🏽‍♂️",
                  "👩🏽‍⚕️",
                  "🧑🏽‍⚕️",
                  "👨🏽‍⚕️",
                  "👩🏽‍🌾",
                  "🧑🏽‍🌾",
                  "👨🏽‍🌾",
                  "👩🏽‍🍳",
                  "🧑🏽‍🍳",
                  "👨🏽‍🍳",
                  "👩🏽‍🎓",
                  "🧑🏽‍🎓",
                  "👨🏽‍🎓",
                  "👩🏽‍🎤",
                  "🧑🏽‍🎤",
                  "👨🏽‍🎤",
                  "👩🏽‍🏫",
                  "🧑🏽‍🏫",
                  "👨🏽‍🏫",
                  "👩🏽‍🏭",
                  "🧑🏽‍🏭",
                  "👨🏽‍🏭",
                  "👩🏽‍💻",
                  "🧑🏽‍💻",
                  "👨🏽‍💻",
                  "👩🏽‍💼",
                  "🧑🏽‍💼",
                  "👨🏽‍💼",
                  "👩🏽‍🔧",
                  "🧑🏽‍🔧",
                  "👨🏽‍🔧",
                  "👩🏽‍🔬",
                  "🧑🏽‍🔬",
                  "👨🏽‍🔬",
                  "👩🏽‍🎨",
                  "🧑🏽‍🎨",
                  "👨🏽‍🎨",
                  "👩🏽‍🚒",
                  "🧑🏽‍🚒",
                  "👨🏽‍🚒",
                  "👩🏽‍✈️",
                  "🧑🏽‍✈️",
                  "👨🏽‍✈️",
                  "👩🏽‍🚀",
                  "🧑🏽‍🚀",
                  "👨🏽‍🚀",
                  "👩🏽‍⚖️",
                  "🧑🏽‍⚖️",
                  "👨🏽‍⚖️",
                  "👰🏽‍♀️",
                  "👰🏽",
                  "👰🏽‍♂️",
                  "🤵🏽‍♀️",
                  "🤵🏽",
                  "🤵🏽‍♂️",
                  "👸🏽",
                  "🫅🏽",
                  "🤴🏽",
                  "🥷🏽",
                  "🦸🏽‍♀️",
                  "🦸🏽",
                  "🦸🏽‍♂️",
                  "🦹🏽‍♀️",
                  "🦹🏽",
                  "🦹🏽‍♂️",
                  "🤶🏽",
                  "🧑🏽‍🎄",
                  "🎅🏽",
                  "🧙🏽‍♀️",
                  "🧙🏽",
                  "🧙🏽‍♂️",
                  "🧝🏽‍♀️",
                  "🧝🏽",
                  "🧝🏽‍♂️",
                  "🧛🏽‍♀️",
                  "🧛🏽",
                  "🧛🏽‍♂️",
                  "🧜🏽‍♀️",
                  "🧜🏽",
                  "🧜🏽‍♂️",
                  "🧚🏽‍♀️",
                  "🧚🏽",
                  "🧚🏽‍♂️",
                  "👼🏽",
                  "🤰🏽",
                  "🫄🏽",
                  "🫃🏽",
                  "🤱🏽",
                  "👩🏽‍🍼",
                  "🧑🏽‍🍼",
                  "👨🏽‍🍼",
                  "🙇🏽‍♀️",
                  "🙇🏽",
                  "🙇🏽‍♂️",
                  "💁🏽‍♀️",
                  "💁🏽",
                  "💁🏽‍♂️",
                  "🙅🏽‍♀️",
                  "🙅🏽",
                  "🙅🏽‍♂️",
                  "🙆🏽‍♀️",
                  "🙆🏽",
                  "🙆🏽‍♂️",
                  "🙋🏽‍♀️",
                  "🙋🏽",
                  "🙋🏽‍♂️",
                  "🧏🏽‍♀️",
                  "🧏🏽",
                  "🧏🏽‍♂️",
                  "🤦🏽‍♀️",
                  "🤦🏽",
                  "🤦🏽‍♂️",
                  "🤷🏽‍♀️",
                  "🤷🏽",
                  "🤷🏽‍♂️",
                  "🙎🏽‍♀️",
                  "🙎🏽",
                  "🙎🏽‍♂️",
                  "🙍🏽‍♀️",
                  "🙍🏽",
                  "🙍🏽‍♂️",
                  "💇🏽‍♀️",
                  "💇🏽",
                  "💇🏽‍♂️",
                  "💆🏽‍♀️",
                  "💆🏽",
                  "💆🏽‍♂️",
                  "🧖🏽‍♀️",
                  "🧖🏽",
                  "🧖🏽‍♂️",
                  "💃🏽",
                  "🕺🏽",
                  "🕴🏽",
                  "👩🏽‍🦽",
                  "🧑🏽‍🦽",
                  "👨🏽‍🦽",
                  "👩🏽‍🦼",
                  "🧑🏽‍🦼",
                  "👨🏽‍🦼",
                  "🚶🏽‍♀️",
                  "🚶🏽",
                  "🚶🏽‍♂️",
                  "👩🏽‍🦯",
                  "🧑🏽‍🦯",
                  "👨🏽‍🦯",
                  "🧎🏽‍♀️",
                  "🧎🏽",
                  "🧎🏽‍♂️",
                  "🏃🏽‍♀️",
                  "🏃🏽",
                  "🏃🏽‍♂️",
                  "🧍🏽‍♀️",
                  "🧍🏽",
                  "🧍🏽‍♂️",
                  "👭🏽",
                  "🧑🏽‍🤝‍🧑🏽",
                  "👬🏽",
                  "👫🏽",
                  "🧗🏽‍♀️",
                  "🧗🏽",
                  "🧗🏽‍♂️",
                  "🏇🏽",
                  "🏂🏽",
                  "🏌🏽‍♀️",
                  "🏌🏽",
                  "🏌🏽‍♂️",
                  "🏄🏽‍♀️",
                  "🏄🏽",
                  "🏄🏽‍♂️",
                  "🚣🏽‍♀️",
                  "🚣🏽",
                  "🚣🏽‍♂️",
                  "🏊🏽‍♀️",
                  "🏊🏽",
                  "🏊🏽‍♂️",
                  "⛹🏽‍♀️",
                  "⛹🏽",
                  "⛹🏽‍♂️",
                  "🏋🏽‍♀️",
                  "🏋🏽",
                  "🏋🏽‍♂️",
                  "🚴🏽‍♀️",
                  "🚴🏽",
                  "🚴🏽‍♂️",
                  "🚵🏽‍♀️",
                  "🚵🏽",
                  "🚵🏽‍♂️",
                  "🤸🏽‍♀️",
                  "🤸🏽",
                  "🤸🏽‍♂️",
                  "🤽🏽‍♀️",
                  "🤽🏽",
                  "🤽🏽‍♂️",
                  "🤾🏽‍♀️",
                  "🤾🏽",
                  "🤾🏽‍♂️",
                  "🤹🏽‍♀️",
                  "🤹🏽",
                  "🤹🏽‍♂️",
                  "🧘🏽‍♀️",
                  "🧘🏽",
                  "🧘🏽‍♂️",
                  "🛀🏽",
                  "🛌🏽",
                  "👋🏾",
                  "🤚🏾",
                  "🖐🏾",
                  "✋🏾",
                  "🖖🏾",
                  "👌🏾",
                  "🤌🏾",
                  "🤏🏾",
                  "✌🏾",
                  "🤞🏾",
                  "🫰🏾",
                  "🤟🏾",
                  "🤘🏾",
                  "🤙🏾",
                  "🫵🏾",
                  "🫱🏾",
                  "🫲🏾",
                  "🫳🏾",
                  "🫴🏾",
                  "👈🏾",
                  "👉🏾",
                  "👆🏾",
                  "🖕🏾",
                  "👇🏾",
                  "☝🏾",
                  "👍🏾",
                  "👎🏾",
                  "✊🏾",
                  "👊🏾",
                  "🤛🏾",
                  "🤜🏾",
                  "👏🏾",
                  "🫶🏾",
                  "🙌🏾",
                  "👐🏾",
                  "🤲🏾",
                  "🙏🏾",
                  "✍🏾",
                  "💪🏾",
                  "🦵🏾",
                  "🦶🏾",
                  "👂🏾",
                  "🦻🏾",
                  "👃🏾",
                  "👶🏾",
                  "👧🏾",
                  "🧒🏾",
                  "👦🏾",
                  "👩🏾",
                  "🧑🏾",
                  "👨🏾",
                  "👩🏾‍🦱",
                  "🧑🏾‍🦱",
                  "👨🏾‍🦱",
                  "👩🏾‍🦰",
                  "🧑🏾‍🦰",
                  "👨🏾‍🦰",
                  "👱🏾‍♀️",
                  "👱🏾",
                  "👱🏾‍♂️",
                  "👩🏾‍🦳",
                  "🧑🏾‍🦳",
                  "👨🏾‍🦳",
                  "👩🏾‍🦲",
                  "🧑🏾‍🦲",
                  "👨🏾‍🦲",
                  "🧔🏾‍♀️",
                  "🧔🏾",
                  "🧔🏾‍♂️",
                  "👵🏾",
                  "🧓🏾",
                  "👴🏾",
                  "👲🏾",
                  "👳🏾‍♀️",
                  "👳🏾",
                  "👳🏾‍♂️",
                  "🧕🏾",
                  "👮🏾‍♀️",
                  "👮🏾",
                  "👮🏾‍♂️",
                  "👷🏾‍♀️",
                  "👷🏾",
                  "👷🏾‍♂️",
                  "💂🏾‍♀️",
                  "💂🏾",
                  "💂🏾‍♂️",
                  "🕵🏾‍♀️",
                  "🕵🏾",
                  "🕵🏾‍♂️",
                  "👩🏾‍⚕️",
                  "🧑🏾‍⚕️",
                  "👨🏾‍⚕️",
                  "👩🏾‍🌾",
                  "🧑🏾‍🌾",
                  "👨🏾‍🌾",
                  "👩🏾‍🍳",
                  "🧑🏾‍🍳",
                  "👨🏾‍🍳",
                  "👩🏾‍🎓",
                  "🧑🏾‍🎓",
                  "👨🏾‍🎓",
                  "👩🏾‍🎤",
                  "🧑🏾‍🎤",
                  "👨🏾‍🎤",
                  "👩🏾‍🏫",
                  "🧑🏾‍🏫",
                  "👨🏾‍🏫",
                  "👩🏾‍🏭",
                  "🧑🏾‍🏭",
                  "👨🏾‍🏭",
                  "👩🏾‍💻",
                  "🧑🏾‍💻",
                  "👨🏾‍💻",
                  "👩🏾‍💼",
                  "🧑🏾‍💼",
                  "👨🏾‍💼",
                  "👩🏾‍🔧",
                  "🧑🏾‍🔧",
                  "👨🏾‍🔧",
                  "👩🏾‍🔬",
                  "🧑🏾‍🔬",
                  "👨🏾‍🔬",
                  "👩🏾‍🎨",
                  "🧑🏾‍🎨",
                  "👨🏾‍🎨",
                  "👩🏾‍🚒",
                  "🧑🏾‍🚒",
                  "👨🏾‍🚒",
                  "👩🏾‍✈️",
                  "🧑🏾‍✈️",
                  "👨🏾‍✈️",
                  "👩🏾‍🚀",
                  "🧑🏾‍🚀",
                  "👨🏾‍🚀",
                  "👩🏾‍⚖️",
                  "🧑🏾‍⚖️",
                  "👨🏾‍⚖️",
                  "👰🏾‍♀️",
                  "👰🏾",
                  "👰🏾‍♂️",
                  "🤵🏾‍♀️",
                  "🤵🏾",
                  "🤵🏾‍♂️",
                  "👸🏾",
                  "🫅🏾",
                  "🤴🏾",
                  "🥷🏾",
                  "🦸🏾‍♀️",
                  "🦸🏾",
                  "🦸🏾‍♂️",
                  "🦹🏾‍♀️",
                  "🦹🏾",
                  "🦹🏾‍♂️",
                  "🤶🏾",
                  "🧑🏾‍🎄",
                  "🎅🏾",
                  "🧙🏾‍♀️",
                  "🧙🏾",
                  "🧙🏾‍♂️",
                  "🧝🏾‍♀️",
                  "🧝🏾",
                  "🧝🏾‍♂️",
                  "🧛🏾‍♀️",
                  "🧛🏾",
                  "🧛🏾‍♂️",
                  "🧜🏾‍♀️",
                  "🧜🏾",
                  "🧜🏾‍♂️",
                  "🧚🏾‍♀️",
                  "🧚🏾",
                  "🧚🏾‍♂️",
                  "👼🏾",
                  "🤰🏾",
                  "🫄🏾",
                  "🫃🏾",
                  "🤱🏾",
                  "👩🏾‍🍼",
                  "🧑🏾‍🍼",
                  "👨🏾‍🍼",
                  "🙇🏾‍♀️",
                  "🙇🏾",
                  "🙇🏾‍♂️",
                  "💁🏾‍♀️",
                  "💁🏾",
                  "💁🏾‍♂️",
                  "🙅🏾‍♀️",
                  "🙅🏾",
                  "🙅🏾‍♂️",
                  "🙆🏾‍♀️",
                  "🙆🏾",
                  "🙆🏾‍♂️",
                  "🙋🏾‍♀️",
                  "🙋🏾",
                  "🙋🏾‍♂️",
                  "🧏🏾‍♀️",
                  "🧏🏾",
                  "🧏🏾‍♂️",
                  "🤦🏾‍♀️",
                  "🤦🏾",
                  "🤦🏾‍♂️",
                  "🤷🏾‍♀️",
                  "🤷🏾",
                  "🤷🏾‍♂️",
                  "🙎🏾‍♀️",
                  "🙎🏾",
                  "🙎🏾‍♂️",
                  "🙍🏾‍♀️",
                  "🙍🏾",
                  "🙍🏾‍♂️",
                  "💇🏾‍♀️",
                  "💇🏾",
                  "💇🏾‍♂️",
                  "💆🏾‍♀️",
                  "💆🏾",
                  "💆🏾‍♂️",
                  "🧖🏾‍♀️",
                  "🧖🏾",
                  "🧖🏾‍♂️",
                  "💃🏾",
                  "🕺🏾",
                  "👩🏾‍🦽",
                  "🧑🏾‍🦽",
                  "👨🏾‍🦽",
                  "👩🏾‍🦼",
                  "🧑🏾‍🦼",
                  "👨🏾‍🦼",
                  "🚶🏾‍♀️",
                  "🚶🏾",
                  "🚶🏾‍♂️",
                  "👩🏾‍🦯",
                  "🧑🏾‍🦯",
                  "👨🏾‍🦯",
                  "🧎🏾‍♀️",
                  "🧎🏾",
                  "🧎🏾‍♂️",
                  "🏃🏾‍♀️",
                  "🏃🏾",
                  "🏃🏾‍♂️",
                  "🧍🏾‍♀️",
                  "🧍🏾",
                  "🧍🏾‍♂️",
                  "👭🏾",
                  "🧑🏾‍🤝‍🧑🏾",
                  "👬🏾",
                  "👫🏾",
                  "🧗🏾‍♀️",
                  "🧗🏾",
                  "🧗🏾‍♂️",
                  "🏇🏾",
                  "🏂🏾",
                  "🏌🏾‍♀️",
                  "🏌🏾",
                  "🏌🏾‍♂️",
                  "🏄🏾‍♀️",
                  "🏄🏾",
                  "🏄🏾‍♂️",
                  "🚣🏾‍♀️",
                  "🚣🏾",
                  "🚣🏾‍♂️",
                  "🏊🏾‍♀️",
                  "🏊🏾",
                  "🏊🏾‍♂️",
                  "⛹🏾‍♀️",
                  "⛹🏾",
                  "⛹🏾‍♂️",
                  "🏋🏾‍♀️",
                  "🏋🏾",
                  "🏋🏾‍♂️",
                  "🚴🏾‍♀️",
                  "🚴🏾",
                  "🚴🏾‍♂️",
                  "🚵🏾‍♀️",
                  "🚵🏾",
                  "🚵🏾‍♂️",
                  "🤸🏾‍♀️",
                  "🤸🏾",
                  "🤸🏾‍♂️",
                  "🤽🏾‍♀️",
                  "🤽🏾",
                  "🤽🏾‍♂️",
                  "🤾🏾‍♀️",
                  "🤾🏾",
                  "🤾🏾‍♂️",
                  "🤹🏾‍♀️",
                  "🤹🏾",
                  "🤹🏾‍♂️",
                  "🧘🏾‍♀️",
                  "🧘🏾",
                  "🧘🏾‍♂️",
                  "🛀🏾",
                  "🛌🏾",
                  "👋🏿",
                  "🤚🏿",
                  "🖐🏿",
                  "✋🏿",
                  "🖖🏿",
                  "👌🏿",
                  "🤌🏿",
                  "🤏🏿",
                  "✌🏿",
                  "🤞🏿",
                  "🫰🏿",
                  "🤟🏿",
                  "🤘🏿",
                  "🤙🏿",
                  "🫵🏿",
                  "🫱🏿",
                  "🫲🏿",
                  "🫳🏿",
                  "🫴🏿",
                  "👈🏿",
                  "👉🏿",
                  "👆🏿",
                  "🖕🏿",
                  "👇🏿",
                  "☝🏿",
                  "👍🏿",
                  "👎🏿",
                  "✊🏿",
                  "👊🏿",
                  "🤛🏿",
                  "🤜🏿",
                  "👏🏿",
                  "🫶🏿",
                  "🙌🏿",
                  "👐🏿",
                  "🤲🏿",
                  "🙏🏿",
                  "✍🏿",
                  "🤳🏿",
                  "💪🏿",
                  "🦵🏿",
                  "🦶🏿",
                  "👂🏿",
                  "🦻🏿",
                  "👃🏿",
                  "👶🏿",
                  "👧🏿",
                  "🧒🏿",
                  "👦🏿",
                  "👩🏿",
                  "🧑🏿",
                  "👨🏿",
                  "👩🏿‍🦱",
                  "🧑🏿‍🦱",
                  "👨🏿‍🦱",
                  "👩🏿‍🦰",
                  "🧑🏿‍🦰",
                  "👨🏿‍🦰",
                  "👱🏿‍♀️",
                  "👱🏿",
                  "👱🏿‍♂️",
                  "👩🏿‍🦳",
                  "🧑🏿‍🦳",
                  "👨🏿‍🦳",
                  "👩🏿‍🦲",
                  "🧑🏿‍🦲",
                  "👨🏿‍🦲",
                  "🧔🏿‍♀️",
                  "🧔🏿",
                  "🧔🏿‍♂️",
                  "👵🏿",
                  "🧓🏿",
                  "👴🏿",
                  "👲🏿",
                  "👳🏿‍♀️",
                  "👳🏿",
                  "👳🏿‍♂️",
                  "🧕🏿",
                  "👮🏿‍♀️",
                  "👮🏿",
                  "👮🏿‍♂️",
                  "👷🏿‍♀️",
                  "👷🏿",
                  "👷🏿‍♂️",
                  "💂🏿‍♀️",
                  "💂🏿",
                  "💂🏿‍♂️",
                  "🕵🏿‍♀️",
                  "🕵🏿",
                  "🕵🏿‍♂️",
                  "👩🏿‍⚕️",
                  "🧑🏿‍⚕️",
                  "👨🏿‍⚕️",
                  "👩🏿‍🌾",
                  "🧑🏿‍🌾",
                  "👨🏿‍🌾",
                  "👩🏿‍🍳",
                  "🧑🏿‍🍳",
                  "👨🏿‍🍳",
                  "👩🏿‍🎓",
                  "🧑🏿‍🎓",
                  "👨🏿‍🎓",
                  "👩🏿‍🎤",
                  "🧑🏿‍🎤",
                  "👨🏿‍🎤",
                  "👩🏿‍🏫",
                  "🧑🏿‍🏫",
                  "👨🏿‍🏫",
                  "👩🏿‍🏭",
                  "🧑🏿‍🏭",
                  "👨🏿‍🏭",
                  "👩🏿‍💻",
                  "🧑🏿‍💻",
                  "👨🏿‍💻",
                  "👩🏿‍💼",
                  "🧑🏿‍💼",
                  "👨🏿‍💼",
                  "👩🏿‍🔧",
                  "🧑🏿‍🔧",
                  "👨🏿‍🔧",
                  "👩🏿‍🔬",
                  "🧑🏿‍🔬",
                  "👨🏿‍🔬",
                  "👩🏿‍🎨",
                  "🧑🏿‍🎨",
                  "👨🏿‍🎨",
                  "👩🏿‍🚒",
                  "🧑🏿‍🚒",
                  "👨🏿‍🚒",
                  "👩🏿‍✈️",
                  "🧑🏿‍✈️",
                  "👨🏿‍✈️",
                  "👩🏿‍🚀",
                  "🧑🏿‍🚀",
                  "👨🏿‍🚀",
                  "👩🏿‍⚖️",
                  "🧑🏿‍⚖️",
                  "👨🏿‍⚖️",
                  "👰🏿‍♀️",
                  "👰🏿",
                  "👰🏿‍♂️",
                  "🤵🏿‍♀️",
                  "🤵🏿",
                  "🤵🏿‍♂️",
                  "👸🏿",
                  "🫅🏿",
                  "🤴🏿",
                  "🥷🏿",
                  "🦸🏿‍♀️",
                  "🦸🏿",
                  "🦸🏿‍♂️",
                  "🦹🏿‍♀️",
                  "🦹🏿",
                  "🦹🏿‍♂️",
                  "🤶🏿",
                  "🧑🏿‍🎄",
                  "🎅🏿",
                  "🧙🏿‍♀️",
                  "🧙🏿",
                  "🧙🏿‍♂️",
                  "🧝🏿‍♀️",
                  "🧝🏿",
                  "🧝🏿‍♂️",
                  "🧛🏿‍♀️",
                  "🧛🏿",
                  "🧛🏿‍♂️",
                  "🧜🏿‍♀️",
                  "🧜🏿",
                  "🧜🏿‍♂️",
                  "🧚🏿‍♀️",
                  "🧚🏿",
                  "🧚🏿‍♂️",
                  "👼🏿",
                  "🤰🏿",
                  "🫄🏿",
                  "🫃🏿",
                  "🤱🏿",
                  "👩🏿‍🍼",
                  "🧑🏿‍🍼",
                  "👨🏿‍🍼",
                  "🙇🏿‍♀️",
                  "🙇🏿",
                  "🙇🏿‍♂️",
                  "💁🏿‍♀️",
                  "💁🏿",
                  "💁🏿‍♂️",
                  "🙅🏿‍♀️",
                  "🙅🏿",
                  "🙅🏿‍♂️",
                  "🙆🏿‍♀️",
                  "🙆🏿",
                  "🙆🏿‍♂️",
                  "🙋🏿‍♀️",
                  "🙋🏿",
                  "🙋🏿‍♂️",
                  "🧏🏿‍♀️",
                  "🧏🏿",
                  "🧏🏿‍♂️",
                  "🤦🏿‍♀️",
                  "🤦🏿",
                  "🤦🏿‍♂️",
                  "🤷🏿‍♀️",
                  "🤷🏿",
                  "🤷🏿‍♂️",
                  "🙎🏿‍♀️",
                  "🙎🏿",
                  "🙎🏿‍♂️",
                  "🙍🏿‍♀️",
                  "🙍🏿",
                  "🙍🏿‍♂️",
                  "💇🏿‍♀️",
                  "💇🏿",
                  "💇🏿‍♂️",
                  "💆🏿‍♀️",
                  "💆🏿",
                  "💆🏿‍♂️",
                  "🧖🏿‍♀️",
                  "🧖🏿",
                  "🧖🏿‍♂️",
                  "💃🏿",
                  "🕺🏿",
                  "🕴🏿",
                  "👩🏿‍🦽",
                  "🧑🏿‍🦽",
                  "👨🏿‍🦽",
                  "👩🏿‍🦼",
                  "🧑🏿‍🦼",
                  "👨🏿‍🦼",
                  "🚶🏿‍♀️",
                  "🚶🏿",
                  "🚶🏿‍♂️",
                  "👩🏿‍🦯",
                  "🧑🏿‍🦯",
                  "👨🏿‍🦯",
                  "🧎🏿‍♀️",
                  "🧎🏿",
                  "🧎🏿‍♂️",
                  "🏃🏿‍♀️",
                  "🏃🏿",
                  "🏃🏿‍♂️",
                  "🧍🏿‍♀️",
                  "🧍🏿",
                  "🧍🏿‍♂️",
                  "👭🏿",
                  "🧑🏿‍🤝‍🧑🏿",
                  "👬🏿",
                  "👫🏿",
                  "🧗🏿‍♀️",
                  "🧗🏿",
                  "🧗🏿‍♂️",
                  "🏇🏿",
                  "🏂🏿",
                  "🏌🏿‍♀️",
                  "🏌🏿",
                  "🏌🏿‍♂️",
                  "🏄🏿‍♀️",
                  "🏄🏿",
                  "🏄🏿‍♂️",
                  "🚣🏿‍♀️",
                  "🚣🏿",
                  "🚣🏿‍♂️",
                  "🏊🏿‍♀️",
                  "🏊🏿",
                  "🏊🏿‍♂️",
                  "⛹🏿‍♀️",
                  "⛹🏿",
                  "⛹🏿‍♂️",
                  "🏋🏿‍♀️",
                  "🏋🏿",
                  "🏋🏿‍♂️",
                  "🚴🏿‍♀️",
                  "🚴🏿",
                  "🚴🏿‍♂️",
                  "🚵🏿‍♀️",
                  "🚵🏿",
                  "🚵🏿‍♂️",
                  "🤸🏿‍♀️",
                  "🤸🏿",
                  "🤸🏿‍♂️",
                  "🤽🏿‍♀️",
                  "🤽🏿",
                  "🤽🏿‍♂️",
                  "🤾🏿‍♀️",
                  "🤾🏿",
                  "🤾🏿‍♂️",
                  "🤹🏿‍♀️",
                  "🤹🏿",
                  "🤹🏿‍♂️",
                  "🧘🏿‍♀️",
                  "🧘🏿",
                  "🧘🏿‍♂️",
                  "🛀🏿",
                  "🛌🏿",
                  "🐶",
                  "🐱",
                  "🐭",
                  "🐹",
                  "🐰",
                  "🦊",
                  "🐻",
                  "🐼",
                  "🐻‍❄️",
                  "🐨",
                  "🐯",
                  "🦁",
                  "🐮",
                  "🐷",
                  "🐽",
                  "🐸",
                  "🐵",
                  "🙈",
                  "🙉",
                  "🙊",
                  "🐒",
                  "🐔",
                  "🐧",
                  "🐦",
                  "🐤",
                  "🐣",
                  "🐥"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "@Kostastsale, TheDFIRReport",
        "date": "2022-12-05",
        "modified": "",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_emoji_usage_in_cli_2.yml"
      }
    },
    {
      "id": "a4694263-59a8-4608-a3a0-6f8d3a51664c",
      "title": "Suspicious Key Manager Access",
      "status": "test",
      "description": "Detects the invocation of the Stored User Names and Passwords dialogue (Key Manager)",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1555.004"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\rundll32.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "RUNDLL32.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "keymgr",
                  "KRShowKeyMgr"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1555.004"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-04-21",
        "modified": "2023-02-09",
        "references": [
          "https://twitter.com/NinjaParanoid/status/1516442028963659777"
        ],
        "falsepositives": [
          "Administrative activity"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_rundll32_keymgr.yml"
      }
    },
    {
      "id": "8518ed3d-f7c9-4601-a26c-f361a4256a0c",
      "title": "Suspicious Download From File-Sharing Website Via Bitsadmin",
      "status": "test",
      "description": "Detects usage of bitsadmin downloading a file from a suspicious domain",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.persistence",
        "attack.t1197",
        "attack.s0190",
        "attack.t1036.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\bitsadmin.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "bitsadmin.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_flags": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " /transfer ",
                  " /create ",
                  " /addfile "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_domain": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ".githubusercontent.com",
                  "anonfiles.com",
                  "cdn.discordapp.com",
                  "ddns.net",
                  "dl.dropboxusercontent.com",
                  "ghostbin.co",
                  "glitch.me",
                  "gofile.io",
                  "hastebin.com",
                  "mediafire.com",
                  "mega.nz",
                  "onrender.com",
                  "pages.dev",
                  "paste.ee",
                  "pastebin.com",
                  "pastebin.pl",
                  "pastetext.net",
                  "privatlab.com",
                  "privatlab.net",
                  "send.exploit.in",
                  "sendspace.com",
                  "storage.googleapis.com",
                  "storjshare.io",
                  "supabase.co",
                  "temp.sh",
                  "transfer.sh",
                  "trycloudflare.com",
                  "ufile.io",
                  "w3spaces.com",
                  "workers.dev"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1197",
          "T1036.003"
        ],
        "tactics": [
          "defense_evasion",
          "persistence"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-06-28",
        "modified": "2024-08-22",
        "references": [
          "https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin",
          "https://isc.sans.edu/diary/22264",
          "https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/",
          "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ransomware-hive-conti-avoslocker",
          "https://www.cisa.gov/uscert/ncas/alerts/aa22-321a",
          "https://www.microsoft.com/en-us/security/blog/2024/01/17/new-ttps-observed-in-mint-sandstorm-campaign-targeting-high-profile-individuals-at-universities-and-research-orgs/"
        ],
        "falsepositives": [
          "Some legitimate apps use this, but limited."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_bitsadmin_download_file_sharing_domains.yml"
      }
    },
    {
      "id": "01aeb693-138d-49d2-9403-c4f52d7d3d62",
      "title": "RDP Connection Allowed Via Netsh.EXE",
      "status": "test",
      "description": "Detects usage of the netsh command to open and allow connections to port 3389 (RDP). As seen used by Sarwent Malware",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.004"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\netsh.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "netsh.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "firewall ",
                  "add ",
                  "tcp ",
                  "3389"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "portopening",
                  "allow"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Sander Wiebing",
        "date": "2020-05-23",
        "modified": "2023-12-11",
        "references": [
          "https://labs.sentinelone.com/sarwent-malware-updates-command-detonation/"
        ],
        "falsepositives": [
          "Legitimate administration activity"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_netsh_fw_allow_rdp.yml"
      }
    },
    {
      "id": "71158e3f-df67-472b-930e-7d287acaa3e1",
      "title": "Execution Of Non-Existing File",
      "status": "test",
      "description": "Checks whether the image specified in a process creation event is not a full, absolute path (caused by process ghosting or other unorthodox methods to start a process)",
      "level": "high",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "image_absolute_path": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": "\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_null": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_empty": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "-",
                  ""
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_4688": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image": {
                    "field": "Image",
                    "value": [
                      "System",
                      "Registry",
                      "MemCompression",
                      "vmmem"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine": {
                    "field": "CommandLine",
                    "value": [
                      "Registry",
                      "MemCompression",
                      "vmmem"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "condition": "not image_absolute_path and not 1 of filter*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "not",
              "value": "image_absolute_path"
            },
            {
              "type": "not",
              "value": "1 of filter*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Max Altgelt (Nextron Systems)",
        "date": "2021-12-09",
        "modified": "2022-12-14",
        "references": [
          "https://pentestlaboratories.com/2021/12/08/process-ghosting/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_image_missing.yml"
      }
    },
    {
      "id": "b9e8c7d6-a5f4-4e3d-8b1a-9f0c8d7e6a5b",
      "title": "Windows Defender Context Menu Removed",
      "status": "experimental",
      "description": "Detects the use of reg.exe or PowerShell to delete the Windows Defender context menu handler registry keys.\nThis action removes the \"Scan with Microsoft Defender\" option from the right-click menu for files, directories, and drives.\nAttackers may use this technique to hinder manual, on-demand scans and reduce the visibility of the security product.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell_ise.exe",
                      "\\powershell.exe",
                      "\\pwsh.exe",
                      "\\reg.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "powershell_ise.EXE",
                      "PowerShell.EXE",
                      "pwsh.dll",
                      "reg.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_action": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "del",
                  "Remove-Item",
                  "ri "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_reg_path": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "\\shellex\\ContextMenuHandlers\\EPP",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Matt Anderson (Huntress)",
        "date": "2025-07-09",
        "modified": "",
        "references": [
          "https://research.splunk.com/endpoint/395ed5fe-ad13-4366-9405-a228427bdd91/",
          "https://winaero.com/how-to-delete-scan-with-windows-defender-from-context-menu-in-windows-10/",
          "https://thedfirreport.com/2021/10/18/icedid-to-xinglocker-ransomware-in-24-hours/",
          "https://blog.malwarebytes.com/malwarebytes-news/2021/02/lazyscripter-from-empire-to-double-rat/"
        ],
        "falsepositives": [
          "May be part of a system customization or \"debloating\" script, but this is highly unusual in a managed corporate environment."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_defender_remove_context_menu.yml"
      }
    },
    {
      "id": "9d5a1274-922a-49d0-87f3-8c653483b909",
      "title": "Uncommon System Information Discovery Via Wmic.EXE",
      "status": "test",
      "description": "Detects the use of the WMI command-line (WMIC) utility to identify and display various system information,\nincluding OS, CPU, GPU, and disk drive names; memory capacity; display resolution; and baseboard, BIOS,\nand GPU driver products/versions.\nSome of these commands were used by Aurora Stealer in late 2022/early 2023.\n",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.t1082"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_wmic": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "WMI Commandline Utility",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "wmic.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\WMIC.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_commands": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "LOGICALDISK get Name,Size,FreeSpace",
                  "os get Caption,OSArchitecture,Version"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1082"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "TropChaud",
        "date": "2023-01-26",
        "modified": "2023-12-19",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/a2ccd19c37d0278b4ffa8583add3cf52060a5418/atomics/T1082/T1082.md#atomic-test-25---system-information-discovery-with-wmic",
          "https://nwgat.ninja/getting-system-information-with-wmic-on-windows/",
          "https://blog.sekoia.io/aurora-a-rising-stealer-flying-under-the-radar",
          "https://blog.cyble.com/2023/01/18/aurora-a-stealer-using-shapeshifting-tactics/",
          "https://app.any.run/tasks/a6aa0057-82ec-451f-8f99-55650ca537da/",
          "https://www.virustotal.com/gui/file/d6f6bc10ae0e634ed4301d584f61418cee18e5d58ad9af72f8aa552dc4aaeca3/behavior"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wmic_recon_system_info_uncommon.yml"
      }
    },
    {
      "id": "1e75c1cc-c5d4-42aa-ac3d-91b0b68b3b4c",
      "title": "Arbitrary File Download Via Squirrel.EXE",
      "status": "test",
      "description": "Detects the usage of the \"Squirrel.exe\" to download arbitrary files. This binary is part of multiple Electron based software installations (Slack, Teams, Discord, etc.)\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.execution",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\squirrel.exe",
                  "\\update.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_download_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " --download ",
                  " --update ",
                  " --updateRollback="
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_download_http_keyword": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "http",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), Karneades / Markus Neis, Jonhnathan Ribeiro, oscd.community",
        "date": "2022-06-09",
        "modified": "2023-11-09",
        "references": [
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Squirrel/",
          "http://www.hexacorn.com/blog/2019/03/30/sqirrel-packages-manager-as-a-lolbin-a-k-a-many-electron-apps-are-lolbins-by-default/",
          "http://www.hexacorn.com/blog/2018/08/16/squirrel-as-a-lolbin/"
        ],
        "falsepositives": [
          "Expected FP with some Electron based applications such as (1Clipboard, Beaker Browser, Caret, Discord, GitHub Desktop, etc.)"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_squirrel_download.yml"
      }
    },
    {
      "id": "3ffd6f51-e6c1-47b7-94b4-c1e61d4117c5",
      "title": "Certificate Exported Via Certutil.EXE",
      "status": "test",
      "description": "Detects the execution of the certutil with the \"exportPFX\" flag which allows the utility to export certificates.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\certutil.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "CertUtil.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-exportPFX ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1027"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Jonhnathan Ribeiro, oscd.community, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-02-15",
        "modified": "2024-03-05",
        "references": [
          "https://www.splunk.com/en_us/blog/security/a-golden-saml-journey-solarwinds-continued.html"
        ],
        "falsepositives": [
          "There legitimate reasons to export certificates. Investigate the activity to determine if it's benign"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_certutil_export_pfx.yml"
      }
    },
    {
      "id": "7aa7009a-28b9-4344-8c1f-159489a390df",
      "title": "HackTool - Windows Credential Editor (WCE) Execution",
      "status": "test",
      "description": "Detects the use of Windows Credential Editor (WCE), a popular post-exploitation tool used to extract plaintext passwords, hash, PIN code and Kerberos tickets from memory.\nIt is often used by threat actors for credential dumping and lateral movement within compromised networks.\n",
      "level": "critical",
      "tags": [
        "attack.credential-access",
        "attack.t1003.001",
        "attack.s0005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\WCE.exe",
                  "\\WCE64.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_hash": {
            "type": "field_match",
            "matchers": {
              "Hashes__contains": {
                "field": "Hashes",
                "value": [
                  "IMPHASH=136F0A8572C058A96436C82E541E4C41",
                  "IMPHASH=589657C64DDE88533186C39F82FA1F50",
                  "IMPHASH=6BFE09EFCB4FFDE061EBDBAFC4DB84CF",
                  "IMPHASH=7D490037BF450877E6D0287BDCFF8D2E",
                  "IMPHASH=8AB93B061287C79F3088C5BC7E7D97ED",
                  "IMPHASH=A53A02B997935FD8EEDCB5F7ABAB9B9F",
                  "IMPHASH=BA434A7A729EEC20E136CA4C32D6C740",
                  "IMPHASH=BD1D1547DA13C0FCB6C15E86217D5EB8",
                  "IMPHASH=E96A73C7BF33A464C510EDE582318BF2"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.001"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2019-12-31",
        "modified": "2025-10-21",
        "references": [
          "https://www.ampliasecurity.com/research/windows-credentials-editor/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_wce.yml"
      }
    },
    {
      "id": "85ff530b-261d-48c6-a441-facaa2e81e48",
      "title": "New Service Creation Using Sc.EXE",
      "status": "test",
      "description": "Detects the creation of a new service using the \"sc.exe\" utility.",
      "level": "low",
      "tags": [
        "attack.persistence",
        "attack.privilege-escalation",
        "attack.t1543.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\sc.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "create",
                  "binPath"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_dropbox": {
            "type": "field_match",
            "matchers": {
              "ParentImage__startswith": {
                "field": "ParentImage",
                "value": [
                  "C:\\Program Files (x86)\\Dropbox\\Client\\",
                  "C:\\Program Files\\Dropbox\\Client\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\Dropbox.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1543.003"
        ],
        "tactics": [
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Timur Zinniatullin, Daniil Yugoslavskiy, oscd.community",
        "date": "2023-02-20",
        "modified": "2025-09-01",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1543.003/T1543.003.md"
        ],
        "falsepositives": [
          "Legitimate administrator or user creates a service for legitimate reasons.",
          "Software installation"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sc_create_service.yml"
      }
    },
    {
      "id": "5a3164f2-b373-4152-93cf-090b13c12d27",
      "title": "Potentially Suspicious Child Process Of VsCode",
      "status": "test",
      "description": "Detects uncommon or suspicious child processes spawning from a VsCode \"code.exe\" process. This could indicate an attempt of persistence via VsCode tasks or terminal profiles.",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.defense-evasion",
        "attack.t1218",
        "attack.t1202"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\code.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_children_images": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\calc.exe",
                  "\\regsvr32.exe",
                  "\\rundll32.exe",
                  "\\cscript.exe",
                  "\\wscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_children_cli": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\cmd.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Invoke-Expressions",
                  "IEX",
                  "Invoke-Command",
                  "ICM",
                  "DownloadString",
                  "rundll32",
                  "regsvr32",
                  "wscript",
                  "cscript"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_children_paths": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  ":\\Users\\Public\\",
                  ":\\Windows\\Temp\\",
                  ":\\Temp\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_parent and 1 of selection_children_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_parent"
            },
            {
              "type": "ref",
              "value": "1 of selection_children_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218",
          "T1202"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-01-26",
        "modified": "2023-10-25",
        "references": [
          "https://twitter.com/nas_bench/status/1618021838407495681",
          "https://twitter.com/nas_bench/status/1618021415852335105"
        ],
        "falsepositives": [
          "In development environment where VsCode is used heavily. False positives may occur when developers use task to compile or execute different types of code. Remove or add processes accordingly"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_vscode_child_processes_anomalies.yml"
      }
    },
    {
      "id": "725a9768-0f5e-4cb3-aec2-bc5719c6831a",
      "title": "Suspicious Where Execution",
      "status": "test",
      "description": "Adversaries may enumerate browser bookmarks to learn more about compromised hosts.\nBrowser bookmarks may reveal personal information about users (ex: banking sites, interests, social media, etc.) as well as details about\ninternal network resources such as servers, tools/dashboards, or other related infrastructure.\n",
      "level": "low",
      "tags": [
        "attack.discovery",
        "attack.t1217"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "where_exe": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\where.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "where.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "where_opt": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "places.sqlite",
                  "cookies.sqlite",
                  "formhistory.sqlite",
                  "logins.json",
                  "key4.db",
                  "key3.db",
                  "sessionstore.jsonlz4",
                  "History",
                  "Bookmarks",
                  "Cookies",
                  "Login Data"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of where_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "where_"
        }
      },
      "mitre": {
        "techniques": [
          "T1217"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2021-12-13",
        "modified": "2022-06-29",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1217/T1217.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_where_browser_data_recon.yml"
      }
    },
    {
      "id": "9a132afa-654e-11eb-ae93-0242ac130002",
      "title": "PUA - AdFind Suspicious Execution",
      "status": "test",
      "description": "Detects AdFind execution with common flags seen used during attacks",
      "level": "high",
      "tags": [
        "attack.discovery",
        "attack.t1018",
        "attack.t1087.002",
        "attack.t1482",
        "attack.t1069.002",
        "stp.1u"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "domainlist",
                  "trustdmp",
                  "dcmodes",
                  "adinfo",
                  "-sc dclist",
                  "computer_pwdnotreqd",
                  "objectcategory=",
                  "-subnets -f",
                  "name=\"Domain Admins\"",
                  "-sc u:",
                  "domainncs",
                  "dompol",
                  " oudmp ",
                  "subnetdmp",
                  "gpodmp",
                  "fspdmp",
                  "users_noexpire",
                  "computers_active",
                  "computers_pwdnotreqd"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1018",
          "T1087.002",
          "T1482",
          "T1069.002"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Janantha Marasinghe (https://github.com/blueteam0ps), FPT.EagleEye Team, omkar72, oscd.community",
        "date": "2021-02-02",
        "modified": "2025-10-24",
        "references": [
          "https://www.joeware.net/freetools/tools/adfind/",
          "https://thedfirreport.com/2020/05/08/adfind-recon/",
          "https://thedfirreport.com/2021/01/11/trickbot-still-alive-and-well/",
          "https://www.microsoft.com/security/blog/2021/01/20/deep-dive-into-the-solorigate-second-stage-activation-from-sunburst-to-teardrop-and-raindrop/",
          "https://social.technet.microsoft.com/wiki/contents/articles/7535.adfind-command-examples.aspx",
          "https://github.com/center-for-threat-informed-defense/adversary_emulation_library/blob/bf62ece1c679b07b5fb49c4bae947fe24c81811f/fin6/Emulation_Plan/Phase1.md",
          "https://github.com/redcanaryco/atomic-red-team/blob/0f229c0e42bfe7ca736a14023836d65baa941ed2/atomics/T1087.002/T1087.002.md#atomic-test-7---adfind---enumerate-active-directory-user-objects"
        ],
        "falsepositives": [
          "Legitimate admin activity"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_adfind_susp_usage.yml"
      }
    },
    {
      "id": "7e8f2d3b-9c1a-4f67-b9e8-8d9006e0e51f",
      "title": "PowerShell Web Access Feature Enabled Via DISM",
      "status": "test",
      "description": "Detects the use of DISM to enable the PowerShell Web Access feature, which could be used for remote access and potential abuse",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.defense-evasion",
        "attack.persistence",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\dism.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "DISM.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "WindowsPowerShellWebAccess",
                  "/online",
                  "/enable-feature"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "privilege_escalation",
          "defense_evasion",
          "persistence"
        ]
      },
      "meta": {
        "author": "Michael Haag",
        "date": "2024-09-03",
        "modified": "",
        "references": [
          "https://docs.microsoft.com/en-us/powershell/module/dism/enable-windowsoptionalfeature",
          "https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-241a",
          "https://gist.github.com/MHaggis/7e67b659af9148fa593cf2402edebb41"
        ],
        "falsepositives": [
          "Legitimate PowerShell Web Access installations by administrators"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_dism_enable_powershell_web_access_feature.yml"
      }
    },
    {
      "id": "a6fc3c46-23b8-4996-9ea2-573f4c4d88c5",
      "title": "RemoteFXvGPUDisablement Abuse Via AtomicTestHarnesses",
      "status": "test",
      "description": "Detects calls to the AtomicTestHarnesses \"Invoke-ATHRemoteFXvGPUDisablementCommand\" which is designed to abuse the \"RemoteFXvGPUDisablement.exe\" binary to run custom PowerShell code via module load-order hijacking.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Invoke-ATHRemoteFXvGPUDisablementCommand",
                  "Invoke-ATHRemoteFXvGPUDisableme"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-07-13",
        "modified": "2023-05-09",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1218/T1218.md",
          "https://github.com/redcanaryco/AtomicTestHarnesses/blob/7e1e4da116801e3d6fcc6bedb207064577e40572/TestHarnesses/T1218_SignedBinaryProxyExecution/InvokeRemoteFXvGPUDisablementCommand.ps1"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_remotefxvgpudisablement_abuse.yml"
      }
    },
    {
      "id": "fdb62a13-9a81-4e5c-a38f-ea93a16f6d7c",
      "title": "PowerShell Base64 Encoded FromBase64String Cmdlet",
      "status": "test",
      "description": "Detects usage of a base64 encoded \"FromBase64String\" cmdlet in a process command line",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1140",
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__base64offset_contains": {
                    "field": "CommandLine",
                    "value": "::FromBase64String",
                    "modifiers": [
                      "base64offset",
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      "OgA6AEYAcgBvAG0AQgBhAHMAZQA2ADQAUwB0AHIAaQBuAGcA",
                      "oAOgBGAHIAbwBtAEIAYQBzAGUANgA0AFMAdAByAGkAbgBnA",
                      "6ADoARgByAG8AbQBCAGEAcwBlADYANABTAHQAcgBpAG4AZw"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1140",
          "T1059.001"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2019-08-24",
        "modified": "2023-04-06",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_base64_frombase64string.yml"
      }
    },
    {
      "id": "a7664b14-75fb-4a50-a223-cb9bc0afbacf",
      "title": "HackTool - RemoteKrbRelay Execution",
      "status": "test",
      "description": "Detects the use of RemoteKrbRelay, a Kerberos relaying tool via CommandLine flags and PE metadata.\n",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1558.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\RemoteKrbRelay.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "RemoteKrbRelay.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_required": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " -clsid ",
                  " -target ",
                  " -victim "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_attack_smb": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "-smb ",
                  "--smbkeyword "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "interactive",
                  "secrets",
                  "service-add"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_attack_rbcd_main": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-rbcd ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli_attack_rbcd_options": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "-cn ",
                  "--computername "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_attack_changepass": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-chp ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "-chpPass ",
                  "-chpUser "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_attack_addgrpname": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "-addgroupmember ",
                  "-group ",
                  "-groupuser "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_img or selection_cli_required or all of selection_cli_attack_rbcd_* or selection_cli_attack_changepass or selection_cli_attack_addgrpname or selection_cli_attack_smb",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection_img",
            "selection_cli_required",
            "all of selection_cli_attack_rbcd_*",
            "selection_cli_attack_changepass",
            "selection_cli_attack_addgrpname",
            "selection_cli_attack_smb"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1558.003"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2024-06-27",
        "modified": "",
        "references": [
          "https://github.com/CICADA8-Research/RemoteKrbRelay"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_krbrelay_remote.yml"
      }
    },
    {
      "id": "c80e66d8-1780-48a9-b412-46663fd21ac0",
      "title": "Suspicious Autorun Registry Modified via WMI",
      "status": "experimental",
      "description": "Detects suspicious activity where the WMIC process is used to create an autorun registry entry via reg.exe, which is often indicative of persistence mechanisms employed by malware.\n",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.execution",
        "attack.persistence",
        "attack.t1547.001",
        "attack.t1047"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_execution_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\wmic.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "wmic.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "ParentImage__endswith": {
                    "field": "ParentImage",
                    "value": "\\wmiprvse.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_execution_cmd": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "reg",
                  " add "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\Software\\Microsoft\\Windows\\CurrentVersion\\Run",
                  "\\Software\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Run",
                  "\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_suspicious_paths_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ":\\Perflogs",
                  ":\\ProgramData'",
                  ":\\Windows\\Temp",
                  ":\\Temp",
                  "\\AppData\\Local\\Temp",
                  "\\AppData\\Roaming",
                  ":\\$Recycle.bin",
                  ":\\Users\\Default",
                  ":\\Users\\public",
                  "%temp%",
                  "%tmp%",
                  "%Public%",
                  "%AppData%"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_suspicious_paths_user_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": ":\\Users\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_suspicious_paths_user_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\Favorites",
                  "\\Favourites",
                  "\\Contacts",
                  "\\Music",
                  "\\Pictures",
                  "\\Documents",
                  "\\Photos"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_execution_* and (selection_suspicious_paths_1 or (all of selection_suspicious_paths_user_*))",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "all of selection_execution_* and (selection_suspicious_paths_1",
            "(all of selection_suspicious_paths_user_*))"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1547.001",
          "T1047"
        ],
        "tactics": [
          "privilege_escalation",
          "execution",
          "persistence"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-02-17",
        "modified": "",
        "references": [
          "Internal Research",
          "https://github.com/HackTricks-wiki/hacktricks/blob/e4c7b21b8f36c97c35b7c622732b38a189ce18f7/src/windows-hardening/windows-local-privilege-escalation/privilege-escalation-with-autorun-binaries.md"
        ],
        "falsepositives": [
          "Legitimate administrative activity or software installations"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_autorun_registry_modified_via_wmic.yml"
      }
    },
    {
      "id": "bef37fa2-f205-4a7b-b484-0759bfd5f86f",
      "title": "PUA - Advanced IP Scanner Execution",
      "status": "test",
      "description": "Detects the use of Advanced IP Scanner. Seems to be a popular tool for ransomware groups.",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.t1046",
        "attack.t1135"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__contains": {
                    "field": "Image",
                    "value": "\\advanced_ip_scanner",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName__contains": {
                    "field": "OriginalFileName",
                    "value": "advanced_ip_scanner",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description__contains": {
                    "field": "Description",
                    "value": "Advanced IP Scanner",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/portable",
                  "/lng"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1046",
          "T1135"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), @ROxPinTeddy",
        "date": "2020-05-12",
        "modified": "2023-02-07",
        "references": [
          "https://news.sophos.com/en-us/2019/12/09/snatch-ransomware-reboots-pcs-into-safe-mode-to-bypass-protection/",
          "https://www.fireeye.com/blog/threat-research/2020/05/tactics-techniques-procedures-associated-with-maze-ransomware-incidents.html",
          "https://labs.f-secure.com/blog/prelude-to-ransomware-systembc",
          "https://assets.documentcloud.org/documents/20444693/fbi-pin-egregor-ransomware-bc-01062021.pdf",
          "https://thedfirreport.com/2021/01/18/all-that-for-a-coinminer",
          "https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Other/Advanced%20IP%20Scanner"
        ],
        "falsepositives": [
          "Legitimate administrative use"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_advanced_ip_scanner.yml"
      }
    },
    {
      "id": "9f8573c9-22b4-40e3-89c1-72bc2b8d49ab",
      "title": "Scheduled Task Creation Masquerading as System Processes",
      "status": "experimental",
      "description": "Detects the creation of scheduled tasks that involve system processes, which may indicate malicious actors masquerading as or abusing these processes to execute payloads or maintain persistence.",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.execution",
        "attack.persistence",
        "attack.t1053.005",
        "attack.defense-evasion",
        "attack.t1036.004",
        "attack.t1036.005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\schtasks.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "schtasks.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " /create ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_1": {
                "field": "CommandLine",
                "value": [
                  " audiodg",
                  " conhost",
                  " dwm.exe",
                  " explorer",
                  " lsass",
                  " lsm",
                  " mmc",
                  " msiexec",
                  " regsvr32",
                  " rundll32",
                  " services",
                  " spoolsv",
                  " svchost",
                  " taskeng",
                  " taskhost",
                  " wininit",
                  " winlogon"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1053.005",
          "T1036.004",
          "T1036.005"
        ],
        "tactics": [
          "privilege_escalation",
          "execution",
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-02-05",
        "modified": "",
        "references": [
          "https://tria.ge/241015-l98snsyeje/behavioral2"
        ],
        "falsepositives": [
          "Legitimate system administration tasks scheduling trusted system processes."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_schtasks_system_process.yml"
      }
    },
    {
      "id": "dd6b39d9-d9be-4a3b-8fe0-fe3c6a5c1795",
      "title": "Use NTFS Short Name in Command Line",
      "status": "test",
      "description": "Detect use of the Windows 8.3 short name. Which could be used as a method to avoid command-line detection",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1564.004"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "~1.exe",
                  "~1.bat",
                  "~1.msi",
                  "~1.vbe",
                  "~1.vbs",
                  "~1.dll",
                  "~1.ps1",
                  "~1.js",
                  "~1.hta",
                  "~2.exe",
                  "~2.bat",
                  "~2.msi",
                  "~2.vbe",
                  "~2.vbs",
                  "~2.dll",
                  "~2.ps1",
                  "~2.js",
                  "~2.hta"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "ParentImage__endswith": {
                    "field": "ParentImage",
                    "value": [
                      "\\WebEx\\WebexHost.exe",
                      "\\thor\\thor64.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": "C:\\xampp\\vcredist\\VCREDI~1.EXE",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1564.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-05",
        "modified": "2022-09-21",
        "references": [
          "https://www.acunetix.com/blog/articles/windows-short-8-3-filenames-web-security-problem/",
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/cc959352(v=technet.10)",
          "https://twitter.com/jonasLyk/status/1555914501802921984"
        ],
        "falsepositives": [
          "Applications could use this notation occasionally which might generate some false positives. In that case Investigate the parent and child process."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_ntfs_short_name_use_cli.yml"
      }
    },
    {
      "id": "114de787-4eb2-48cc-abdb-c0b449f93ea4",
      "title": "Suspicious X509Enrollment - Process Creation",
      "status": "test",
      "description": "Detect use of X509Enrollment",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1553.004"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "X509Enrollment.CBinaryConverter",
                  "884e2002-217d-11da-b2a4-000e7bbb2b09"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1553.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-12-23",
        "modified": "",
        "references": [
          "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse?slide=42",
          "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse?slide=41",
          "https://learn.microsoft.com/en-us/dotnet/api/microsoft.hpc.scheduler.store.cx509enrollmentwebclassfactoryclass?view=hpc-sdk-5.1.6115"
        ],
        "falsepositives": [
          "Legitimate administrative script"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_x509enrollment.yml"
      }
    },
    {
      "id": "42b1a5b8-353f-4f10-b256-39de4467faff",
      "title": "Harvesting Of Wifi Credentials Via Netsh.EXE",
      "status": "test",
      "description": "Detect the harvesting of wifi credentials using netsh.exe",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.credential-access",
        "attack.t1040"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\netsh.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "netsh.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "wlan",
                  " s",
                  " p",
                  " k",
                  "=clear"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1040"
        ],
        "tactics": [
          "discovery",
          "credential_access"
        ]
      },
      "meta": {
        "author": "Andreas Hunkeler (@Karneades), oscd.community",
        "date": "2020-04-20",
        "modified": "2023-02-13",
        "references": [
          "https://blog.malwarebytes.com/threat-analysis/2020/04/new-agenttesla-variant-steals-wifi-credentials/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_netsh_wifi_credential_harvesting.yml"
      }
    },
    {
      "id": "c30fb093-1109-4dc8-88a8-b30d11c95a5d",
      "title": "Whoami.EXE Execution With Output Option",
      "status": "test",
      "description": "Detects the execution of \"whoami.exe\" with the \"/FO\" flag to choose CSV as output format or with redirection options to export the results to a file for later use.",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.t1033",
        "car.2016-03-001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_main_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\whoami.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "whoami.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_main_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " /FO CSV",
                  " -FO CSV"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_special": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "whoami*>",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_main_* or selection_special",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "all of selection_main_*",
            "selection_special"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1033"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-02-28",
        "modified": "2023-12-04",
        "references": [
          "https://brica.de/alerts/alert/public/1247926/agent-tesla-keylogger-delivered-inside-a-power-iso-daa-archive/",
          "https://app.any.run/tasks/7eaba74e-c1ea-400f-9c17-5e30eee89906/",
          "https://www.youtube.com/watch?v=DsJ9ByX84o4&t=6s"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_whoami_output.yml"
      }
    },
    {
      "id": "a35f5a72-f347-4e36-8895-9869b0d5fc6d",
      "title": "Suspicious Program Location Whitelisted In Firewall Via Netsh.EXE",
      "status": "test",
      "description": "Detects Netsh command execution that whitelists a program located in a suspicious location in the Windows Firewall",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.004"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\netsh.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "netsh.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "firewall",
                      "add",
                      "allowedprogram"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "advfirewall",
                      "firewall",
                      "add",
                      "rule",
                      "action=allow",
                      "program="
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_paths": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ":\\$Recycle.bin\\",
                  ":\\RECYCLER.BIN\\",
                  ":\\RECYCLERS.BIN\\",
                  ":\\SystemVolumeInformation\\",
                  ":\\Temp\\",
                  ":\\Users\\Default\\",
                  ":\\Users\\Desktop\\",
                  ":\\Users\\Public\\",
                  ":\\Windows\\addins\\",
                  ":\\Windows\\cursors\\",
                  ":\\Windows\\debug\\",
                  ":\\Windows\\drivers\\",
                  ":\\Windows\\fonts\\",
                  ":\\Windows\\help\\",
                  ":\\Windows\\system32\\tasks\\",
                  ":\\Windows\\Tasks\\",
                  ":\\Windows\\Temp\\",
                  "\\Downloads\\",
                  "\\Local Settings\\Temporary Internet Files\\",
                  "\\Temporary Internet Files\\Content.Outlook\\",
                  "%Public%\\",
                  "%TEMP%",
                  "%TMP%"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Sander Wiebing, Jonhnathan Ribeiro, Daniil Yugoslavskiy, oscd.community",
        "date": "2020-05-25",
        "modified": "2023-12-11",
        "references": [
          "https://www.virusradar.com/en/Win32_Kasidet.AD/description",
          "https://www.hybrid-analysis.com/sample/07e789f4f2f3259e7559fdccb36e96814c2dbff872a21e1fa03de9ee377d581f?environmentId=100"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_netsh_fw_allow_program_in_susp_location.yml"
      }
    },
    {
      "id": "ae6f14e6-14de-45b0-9f44-c0986f50dc89",
      "title": "Change Default File Association To Executable Via Assoc",
      "status": "test",
      "description": "Detects when a program changes the default file association of any extension to an executable.\nWhen a file is opened, the default program used to open the file (also called the file association or handler) is checked. File association selections are stored in the Windows Registry and can be edited by users, administrators, or programs that have Registry access or by administrators using the built-in assoc utility. Applications can modify the file association for a given file extension to call an arbitrary program when a file with the given extension is opened.\n",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1546.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\cmd.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "Cmd.Exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "assoc ",
                  "exefile"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": ".exe=exefile",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not filter",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "all of selection_*"
            },
            {
              "type": "not",
              "value": "filter"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1546.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-06-28",
        "modified": "2023-03-06",
        "references": [
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/assoc"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_cmd_assoc_tamper_exe_file_association.yml"
      }
    },
    {
      "id": "634b00d5-ccc3-4a06-ae3b-0ec8444dd51b",
      "title": "Malicious Windows Script Components File Execution by TAEF Detection",
      "status": "test",
      "description": "Windows Test Authoring and Execution Framework (TAEF) framework allows you to run automation by executing tests files written on different languages (C, C#, Microsoft COM Scripting interfaces\nAdversaries may execute malicious code (such as WSC file with VBScript, dll and so on) directly by running te.exe\n",
      "level": "low",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\te.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "ParentImage__endswith": {
                    "field": "ParentImage",
                    "value": "\\te.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "\\te.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Agro (@agro_sev) oscd.community",
        "date": "2020-10-13",
        "modified": "2021-11-27",
        "references": [
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Te/",
          "https://twitter.com/pabraeken/status/993298228840992768",
          "https://learn.microsoft.com/en-us/windows-hardware/drivers/taef/"
        ],
        "falsepositives": [
          "It's not an uncommon to use te.exe directly to execute legal TAEF tests"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_use_of_te_bin.yml"
      }
    },
    {
      "id": "1444443e-6757-43e4-9ea4-c8fc705f79a2",
      "title": "Boot Configuration Tampering Via Bcdedit.EXE",
      "status": "stable",
      "description": "Detects the use of the bcdedit command to tamper with the boot configuration data. This technique is often times used by malware or attackers as a destructive way before launching ransomware.",
      "level": "high",
      "tags": [
        "attack.impact",
        "attack.t1490"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\bcdedit.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "bcdedit.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_set": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "set",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "bootstatuspolicy",
                      "ignoreallfailures"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "recoveryenabled",
                      "no"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1490"
        ],
        "tactics": [
          "impact"
        ]
      },
      "meta": {
        "author": "E.M. Anhaus (originally from Atomic Blue Detections, Endgame), oscd.community",
        "date": "2019-10-24",
        "modified": "2023-02-15",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1490/T1490.md",
          "https://eqllib.readthedocs.io/en/latest/analytics/c4732632-9c1d-4980-9fa8-1d98c93f918e.html"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_bcdedit_boot_conf_tamper.yml"
      }
    },
    {
      "id": "a20def93-0709-4eae-9bd2-31206e21e6b2",
      "title": "DriverQuery.EXE Execution",
      "status": "test",
      "description": "Detect usage of the \"driverquery\" utility. Which can be used to perform reconnaissance on installed drivers",
      "level": "medium",
      "tags": [
        "attack.discovery"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "driverquery.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "drvqry.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_main_other": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "ParentImage__endswith": {
                    "field": "ParentImage",
                    "value": [
                      "\\cscript.exe",
                      "\\mshta.exe",
                      "\\regsvr32.exe",
                      "\\rundll32.exe",
                      "\\wscript.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "ParentImage__contains": {
                    "field": "ParentImage",
                    "value": [
                      "\\AppData\\Local\\",
                      "\\Users\\Public\\",
                      "\\Windows\\Temp\\"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-01-19",
        "modified": "2023-09-29",
        "references": [
          "https://thedfirreport.com/2023/01/09/unwrapping-ursnifs-gifts/",
          "https://www.vmray.com/cyber-security-blog/analyzing-ursnif-behavior-malware-sandbox/",
          "https://www.fireeye.com/blog/threat-research/2020/01/saigon-mysterious-ursnif-fork.html"
        ],
        "falsepositives": [
          "Legitimate use by third party tools in order to investigate installed drivers"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_driverquery_usage.yml"
      }
    },
    {
      "id": "727454c0-d851-48b0-8b89-385611ab0704",
      "title": "Lolbin Unregmp2.exe Use As Proxy",
      "status": "test",
      "description": "Detect usage of the \"unregmp2.exe\" binary as a proxy to launch a custom version of \"wmpnscfg.exe\"",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\unregmp2.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "unregmp2.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cmd": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " /HideWMP",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-12-29",
        "modified": "2024-06-04",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Unregmp2/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_unregmp2.yml"
      }
    },
    {
      "id": "4fe074b4-b833-4081-8f24-7dcfeca72b42",
      "title": "Security Tools Keyword Lookup Via Findstr.EXE",
      "status": "test",
      "description": "Detects execution of \"findstr\" to search for common names of security tools. Attackers often pipe the results of recon commands such as \"tasklist\" or \"whoami\" to \"findstr\" in order to filter out the results.\nThis detection focuses on the keywords that the attacker might use as a filter.\n",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.t1518.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\find.exe",
                      "\\findstr.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "FIND.EXE",
                      "FINDSTR.EXE"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": [
                  " avira",
                  " avira\"",
                  " cb",
                  " cb\"",
                  " cylance",
                  " cylance\"",
                  " defender",
                  " defender\"",
                  " kaspersky",
                  " kaspersky\"",
                  " kes",
                  " kes\"",
                  " mc",
                  " mc\"",
                  " sec",
                  " sec\"",
                  " sentinel",
                  " sentinel\"",
                  " symantec",
                  " symantec\"",
                  " virus",
                  " virus\""
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1518.001"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), frack113",
        "date": "2023-10-20",
        "modified": "2023-11-14",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/987e3ca988ae3cff4b9f6e388c139c05bf44bbb8/atomics/T1518.001/T1518.001.md#atomic-test-1---security-software-discovery",
          "https://www.microsoft.com/en-us/security/blog/2023/10/18/multiple-north-korean-threat-actors-exploiting-the-teamcity-cve-2023-42793-vulnerability/",
          "https://www.hhs.gov/sites/default/files/manage-engine-vulnerability-sector-alert-tlpclear.pdf"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_findstr_security_keyword_lookup.yml"
      }
    },
    {
      "id": "ad92e3f9-7eb6-460e-96b1-582b0ccbb980",
      "title": "UAC Bypass Using MSConfig Token Modification - Process",
      "status": "test",
      "description": "Detects the pattern of UAC Bypass using a msconfig GUI hack (UACMe 55)",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "IntegrityLevel": {
                "field": "IntegrityLevel",
                "value": [
                  "High",
                  "System",
                  "S-1-16-16384",
                  "S-1-16-12288"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\AppData\\Local\\Temp\\pkgmgr.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine": {
                "field": "CommandLine",
                "value": "\"C:\\Windows\\system32\\msconfig.exe\" -5",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Christian Burkard (Nextron Systems)",
        "date": "2021-08-30",
        "modified": "2024-12-01",
        "references": [
          "https://github.com/hfiref0x/UACME"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_uac_bypass_msconfig_gui.yml"
      }
    },
    {
      "id": "847d5ff3-8a31-4737-a970-aeae8fe21765",
      "title": "Potential Tampering With Security Products Via WMIC",
      "status": "test",
      "description": "Detects uninstallation or termination of security products using the WMIC utility",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_cli_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "wmic",
                  "product where ",
                  "call",
                  "uninstall",
                  "/nointeractive"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "wmic",
                  "caption like "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "call delete",
                  "call terminate"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_3": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "process ",
                  "where ",
                  "delete"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_product": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "%carbon%",
                  "%cylance%",
                  "%endpoint%",
                  "%eset%",
                  "%malware%",
                  "%Sophos%",
                  "%symantec%",
                  "Antivirus",
                  "AVG ",
                  "Carbon Black",
                  "CarbonBlack",
                  "Cb Defense Sensor 64-bit",
                  "Crowdstrike Sensor",
                  "Cylance ",
                  "Dell Threat Defense",
                  "DLP Endpoint",
                  "Endpoint Detection",
                  "Endpoint Protection",
                  "Endpoint Security",
                  "Endpoint Sensor",
                  "ESET File Security",
                  "LogRhythm System Monitor Service",
                  "Malwarebytes",
                  "McAfee Agent",
                  "Microsoft Security Client",
                  "Sophos Anti-Virus",
                  "Sophos AutoUpdate",
                  "Sophos Credential Store",
                  "Sophos Management Console",
                  "Sophos Management Database",
                  "Sophos Management Server",
                  "Sophos Remote Management System",
                  "Sophos Update Manager",
                  "Threat Protection",
                  "VirusScan",
                  "Webroot SecureAnywhere",
                  "Windows Defender"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_cli_* and selection_product",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "1 of selection_cli_*"
            },
            {
              "type": "ref",
              "value": "selection_product"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2021-01-30",
        "modified": "2023-02-14",
        "references": [
          "https://twitter.com/cglyer/status/1355171195654709249",
          "https://thedfirreport.com/2021/10/18/icedid-to-xinglocker-ransomware-in-24-hours/",
          "https://www.mandiant.com/resources/unc2165-shifts-to-evade-sanctions",
          "https://research.nccgroup.com/2022/08/19/back-in-black-unlocking-a-lockbit-3-0-ransomware-attack/",
          "https://www.trendmicro.com/en_us/research/23/a/vice-society-ransomware-group-targets-manufacturing-companies.html"
        ],
        "falsepositives": [
          "Legitimate administration"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wmic_uninstall_security_products.yml"
      }
    },
    {
      "id": "e9f8f8cc-07cc-4e81-b724-f387db9175e4",
      "title": "Potentially Suspicious Execution Of Regasm/Regsvcs With Uncommon Extension",
      "status": "test",
      "description": "Detects potentially suspicious execution of the Regasm/Regsvcs utilities with an uncommon extension.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.009"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\Regsvcs.exe",
                      "\\Regasm.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "RegSvcs.exe",
                      "RegAsm.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_extension": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ".dat",
                  ".gif",
                  ".jpeg",
                  ".jpg",
                  ".png",
                  ".txt"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.009"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-02-13",
        "modified": "",
        "references": [
          "https://www.fortiguard.com/threat-signal-report/4718?s=09",
          "https://lolbas-project.github.io/lolbas/Binaries/Regasm/",
          "https://lolbas-project.github.io/lolbas/Binaries/Regsvcs/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_regasm_regsvcs_uncommon_extension_execution.yml"
      }
    },
    {
      "id": "2dbd9d3d-9e27-42a8-b8df-f13825c6c3d5",
      "title": "WebDav Client Execution Via Rundll32.EXE",
      "status": "test",
      "description": "Detects \"svchost.exe\" spawning \"rundll32.exe\" with command arguments like \"C:\\windows\\system32\\davclnt.dll,DavSetCookie\".\nThis could be an indicator of exfiltration or use of WebDav to launch code (hosted on a WebDav server).\n",
      "level": "medium",
      "tags": [
        "attack.exfiltration",
        "attack.t1048.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\svchost.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\rundll32.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "RUNDLL32.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "C:\\windows\\system32\\davclnt.dll,DavSetCookie",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1048.003"
        ],
        "tactics": [
          "exfiltration"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
        "date": "2020-05-02",
        "modified": "2023-09-18",
        "references": [
          "https://github.com/OTRF/detection-hackathon-apt29/issues/17",
          "https://github.com/OTRF/ThreatHunter-Playbook/blob/2d4257f630f4c9770f78d0c1df059f891ffc3fec/docs/evals/apt29/detections/7.B.4_C10730EA-6345-4934-AA0F-B0EFCA0C4BA6.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_rundll32_webdav_client_execution.yml"
      }
    },
    {
      "id": "9f38c1db-e2ae-40bf-81d0-5b68f73fb512",
      "title": "Suspicious BitLocker Access Agent Update Utility Execution",
      "status": "experimental",
      "description": "Detects the execution of the BitLocker Access Agent Update Utility (baaupdate.exe) which is not a common parent process for other processes.\nSuspicious child processes spawned by baaupdate.exe could indicate an attempt at lateral movement via BitLocker DCOM & COM Hijacking.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218",
        "attack.lateral-movement",
        "attack.t1021.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\baaupdate.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\bitsadmin.exe",
                  "\\cmd.exe",
                  "\\cscript.exe",
                  "\\mshta.exe",
                  "\\powershell_ise.exe",
                  "\\powershell.exe",
                  "\\regsvr32.exe",
                  "\\rundll32.exe",
                  "\\schtasks.exe",
                  "\\wmic.exe",
                  "\\wscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218",
          "T1021.003"
        ],
        "tactics": [
          "defense_evasion",
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "andrewdanis, Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-10-18",
        "modified": "",
        "references": [
          "https://github.com/rtecCyberSec/BitlockMove"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_baaupdate_susp_child_process.yml"
      }
    },
    {
      "id": "379fa130-190e-4c3f-b7bc-6c8e834485f3",
      "title": "File Deletion Via Del",
      "status": "test",
      "description": "Detects execution of the builtin \"del\"/\"erase\" commands in order to delete files.\nAdversaries may delete files left behind by the actions of their intrusion activity.\nMalware, tools, or other non-native files dropped or created on a system by an adversary may leave traces to indicate to what was done within a network and how.\nRemoval of these files can occur during an intrusion, or as part of a post-intrusion process to minimize the adversary's footprint.\n",
      "level": "low",
      "tags": [
        "attack.defense-evasion",
        "attack.t1070.004"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\cmd.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "Cmd.Exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_del": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "del ",
                  "erase "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_flags": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -f",
                  " -s",
                  " -q"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1070.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-15",
        "modified": "2024-03-05",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.004/T1070.004.md",
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/erase"
        ],
        "falsepositives": [
          "False positives levels will differ Depending on the environment. You can use a combination of ParentImage and other keywords from the CommandLine field to filter legitimate activity"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_cmd_del_execution.yml"
      }
    },
    {
      "id": "7a01183d-71a2-46ad-ad5c-acd989ac1793",
      "title": "UAC Bypass Abusing Winsat Path Parsing - Process",
      "status": "test",
      "description": "Detects the pattern of UAC Bypass using a path parsing issue in winsat.exe (UACMe 52)",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "IntegrityLevel": {
                "field": "IntegrityLevel",
                "value": [
                  "High",
                  "System",
                  "S-1-16-16384",
                  "S-1-16-12288"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\AppData\\Local\\Temp\\system32\\winsat.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "ParentCommandLine__contains": {
                "field": "ParentCommandLine",
                "value": "C:\\Windows \\system32\\winsat.exe",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Christian Burkard (Nextron Systems)",
        "date": "2021-08-30",
        "modified": "2024-12-01",
        "references": [
          "https://github.com/hfiref0x/UACME"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_uac_bypass_winsat.yml"
      }
    },
    {
      "id": "4bc90587-e6ca-4b41-be0b-ed4d04e4ed0c",
      "title": "Suspicious Velociraptor Child Process",
      "status": "experimental",
      "description": "Detects the suspicious use of the Velociraptor DFIR tool to execute other tools or download additional payloads, as seen in a campaign where it was abused for remote access and to stage further attacks.",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1219"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\Velociraptor.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_child_vscode_tunnel": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "code.exe",
                  "tunnel",
                  "--accept-server-license-terms"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_child_msiexec": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "msiexec",
                  "/i",
                  "http"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_child_powershell": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\powershell.exe",
                  "\\powershell_ise.exe",
                  "\\pwsh.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Invoke-WebRequest ",
                  "IWR ",
                  ".DownloadFile",
                  ".DownloadString"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_parent and 1 of selection_child_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_parent"
            },
            {
              "type": "ref",
              "value": "1 of selection_child_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1219"
        ],
        "tactics": [
          "command_and_control",
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-08-29",
        "modified": "",
        "references": [
          "https://news.sophos.com/en-us/2025/08/26/velociraptor-incident-response-tool-abused-for-remote-access/"
        ],
        "falsepositives": [
          "Legitimate administrators or incident responders might use Velociraptor to execute scripts or tools. However, the combination of Velociraptor spawning these specific processes with these command lines is suspicious. Tuning may be required to exclude known administrative actions or specific scripts."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_velociraptor_child_process.yml"
      }
    },
    {
      "id": "b6457d63-d2a2-4e29-859d-4e7affc153d1",
      "title": "Potential Discovery Activity Via Dnscmd.EXE",
      "status": "test",
      "description": "Detects an attempt to leverage dnscmd.exe to enumerate the DNS zones of a domain. DNS zones used to host the DNS records for a particular domain.",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\dnscmd.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "/enumrecords",
                  "/enumzones",
                  "/ZonePrint",
                  "/info"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "discovery",
          "execution"
        ]
      },
      "meta": {
        "author": "@gott_cyber",
        "date": "2022-07-31",
        "modified": "2023-02-04",
        "references": [
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/dnscmd",
          "https://learn.microsoft.com/en-us/azure/dns/dns-zones-records",
          "https://lolbas-project.github.io/lolbas/Binaries/Dnscmd/"
        ],
        "falsepositives": [
          "Legitimate administration use"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_dnscmd_discovery.yml"
      }
    },
    {
      "id": "f3d39c45-de1a-4486-a687-ab126124f744",
      "title": "Sdiagnhost Calling Suspicious Child Process",
      "status": "test",
      "description": "Detects sdiagnhost.exe calling a suspicious child process (e.g. used in exploits for Follina / CVE-2022-30190)",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\sdiagnhost.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\cmd.exe",
                  "\\mshta.exe",
                  "\\cscript.exe",
                  "\\wscript.exe",
                  "\\taskkill.exe",
                  "\\regsvr32.exe",
                  "\\rundll32.exe",
                  "\\calc.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_cmd_bits": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\cmd.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "bits",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_powershell_noprofile": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\powershell.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": [
                  "-noprofile -",
                  "-noprofile"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1036",
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nextron Systems, @Kostastsale",
        "date": "2022-06-01",
        "modified": "2024-08-23",
        "references": [
          "https://twitter.com/nao_sec/status/1530196847679401984",
          "https://doublepulsar.com/follina-a-microsoft-office-code-execution-vulnerability-1a47fce5629e",
          "https://app.any.run/tasks/713f05d2-fe78-4b9d-a744-f7c133e3fafb/",
          "https://app.any.run/tasks/f420d295-0457-4e9b-9b9e-6732be227583/",
          "https://app.any.run/tasks/c4117d9a-f463-461a-b90f-4cd258746798/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sdiagnhost_susp_child.yml"
      }
    },
    {
      "id": "98b53e78-ebaf-46f8-be06-421aafd176d9",
      "title": "HackTool - winPEAS Execution",
      "status": "test",
      "description": "WinPEAS is a script that search for possible paths to escalate privileges on Windows hosts. The checks are explained on book.hacktricks.xyz",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.discovery",
        "attack.t1082",
        "attack.t1087",
        "attack.t1046"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "winPEAS.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\winPEASany_ofs.exe",
                      "\\winPEASany.exe",
                      "\\winPEASx64_ofs.exe",
                      "\\winPEASx64.exe",
                      "\\winPEASx86_ofs.exe",
                      "\\winPEASx86.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_option": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " applicationsinfo",
                  " browserinfo",
                  " eventsinfo",
                  " fileanalysis",
                  " filesinfo",
                  " processinfo",
                  " servicesinfo",
                  " windowscreds"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_dl": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "https://github.com/carlospolop/PEASS-ng/releases/latest/download/",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli_specific": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "ParentCommandLine__endswith": {
                    "field": "ParentCommandLine",
                    "value": " -linpeas",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__endswith": {
                    "field": "CommandLine",
                    "value": " -linpeas",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1082",
          "T1087",
          "T1046"
        ],
        "tactics": [
          "privilege_escalation",
          "discovery"
        ]
      },
      "meta": {
        "author": "Georg Lauenstein (sure[secure])",
        "date": "2022-09-19",
        "modified": "2023-03-23",
        "references": [
          "https://github.com/carlospolop/PEASS-ng",
          "https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_winpeas.yml"
      }
    },
    {
      "id": "37c1333a-a0db-48be-b64b-7393b2386e3b",
      "title": "Hacktool Execution - PE Metadata",
      "status": "test",
      "description": "Detects the execution of different Windows based hacktools via PE metadata (company, product, etc.) even if the files have been renamed",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.resource-development",
        "attack.t1588.002",
        "attack.t1003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Company": {
                "field": "Company",
                "value": "Cube0x0",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1588.002",
          "T1003"
        ],
        "tactics": [
          "credential_access",
          "resource_development"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-04-27",
        "modified": "2024-01-15",
        "references": [
          "https://github.com/cube0x0",
          "https://www.virustotal.com/gui/search/metadata%253ACube0x0/files"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_execution_via_pe_metadata.yml"
      }
    },
    {
      "id": "52788a70-f1da-40dd-8fbd-73b5865d6568",
      "title": "JScript Compiler Execution",
      "status": "test",
      "description": "Detects the execution of the \"jsc.exe\" (JScript Compiler).\nAttacker might abuse this in order to compile JScript files on the fly and bypassing application whitelisting.\n",
      "level": "low",
      "tags": [
        "attack.defense-evasion",
        "attack.t1127"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\jsc.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "jsc.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1127"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-05-02",
        "modified": "2024-04-24",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Jsc/",
          "https://www.phpied.com/make-your-javascript-a-windows-exe/",
          "https://twitter.com/DissectMalware/status/998797808907046913"
        ],
        "falsepositives": [
          "Legitimate use to compile JScript by developers."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_jsc_execution.yml"
      }
    },
    {
      "id": "a746c9b8-a2fb-4ee5-a428-92bee9e99060",
      "title": "SQL Client Tools PowerShell Session Detection",
      "status": "test",
      "description": "This rule detects execution of a PowerShell code through the sqltoolsps.exe utility, which is included in the standard set of utilities supplied with the Microsoft SQL Server Management studio.\nScript blocks are not logged in this case, so this utility helps to bypass protection mechanisms based on the analysis of these logs.\n",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059.001",
        "attack.defense-evasion",
        "attack.t1127"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\sqltoolsps.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "ParentImage__endswith": {
                    "field": "ParentImage",
                    "value": "\\sqltoolsps.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "\\sqltoolsps.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\smss.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001",
          "T1127"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Agro (@agro_sev) oscd.communitly",
        "date": "2020-10-13",
        "modified": "2022-02-25",
        "references": [
          "https://github.com/LOLBAS-Project/LOLBAS/blob/8283d8d91552213ded165fd36deb6cb9534cb443/yml/OtherMSBinaries/Sqltoolsps.yml",
          "https://twitter.com/pabraeken/status/993298228840992768"
        ],
        "falsepositives": [
          "Direct PS command execution through SQLToolsPS.exe is uncommon, childprocess sqltoolsps.exe spawned by smss.exe is a legitimate action."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_mssql_sqltoolsps_susp_execution.yml"
      }
    },
    {
      "id": "d9367cbb-c2e0-47ce-bdc0-128cb6da898d",
      "title": "HackTool - SharpLdapWhoami Execution",
      "status": "test",
      "description": "Detects SharpLdapWhoami, a whoami alternative that queries the LDAP service on a domain controller",
      "level": "high",
      "tags": [
        "attack.discovery",
        "attack.t1033",
        "car.2016-03-001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_name": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\SharpLdapWhoami.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_pe": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName__contains": {
                    "field": "OriginalFileName",
                    "value": "SharpLdapWhoami",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Product": {
                    "field": "Product",
                    "value": "SharpLdapWhoami",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_flags1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": [
                  " /method:ntlm",
                  " /method:kerb",
                  " /method:nego",
                  " /m:nego",
                  " /m:ntlm",
                  " /m:kerb"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1033"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-08-29",
        "modified": "2023-02-04",
        "references": [
          "https://github.com/bugch3ck/SharpLdapWhoami"
        ],
        "falsepositives": [
          "Programs that use the same command line flags"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_sharpldapwhoami.yml"
      }
    },
    {
      "id": "3b3c7f55-f771-4dd6-8a6e-08d057a17caf",
      "title": "Arbitrary File Download Via MSPUB.EXE",
      "status": "test",
      "description": "Detects usage of \"MSPUB\" (Microsoft Publisher) to download arbitrary files",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.execution",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\MSPUB.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "MSPUB.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "ftp://",
                  "http://",
                  "https://"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-19",
        "modified": "2023-02-08",
        "references": [
          "https://github.com/LOLBAS-Project/LOLBAS/pull/238/files"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_mspub_download.yml"
      }
    },
    {
      "id": "ca387a8e-1c84-4da3-9993-028b45342d30",
      "title": "PUA - SoftPerfect Netscan Execution",
      "status": "test",
      "description": "Detects usage of SoftPerfect's \"netscan.exe\". An application for scanning networks.\nIt is actively used in-the-wild by threat actors to inspect and understand the network architecture of a victim.\n",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.t1046"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\netscan.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Product": {
                    "field": "Product",
                    "value": "Network Scanner",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "Application for scanning networks",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1046"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "@d4ns4n_ (Wuerth-Phoenix)",
        "date": "2024-04-25",
        "modified": "",
        "references": [
          "https://www.protect.airbus.com/blog/uncovering-cyber-intruders-netscan/",
          "https://secjoes-reports.s3.eu-central-1.amazonaws.com/Sockbot%2Bin%2BGoLand.pdf",
          "https://www.sentinelone.com/labs/black-basta-ransomware-attacks-deploy-custom-edr-evasion-tools-tied-to-fin7-threat-actor/",
          "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/yanluowang-ransomware-attacks-continue",
          "https://research.nccgroup.com/2022/07/13/climbing-mount-everest-black-byte-bytes-back/",
          "https://www.bleepingcomputer.com/news/security/microsoft-exchange-servers-hacked-to-deploy-hive-ransomware/",
          "https://www.softperfect.com/products/networkscanner/"
        ],
        "falsepositives": [
          "Legitimate administrator activity"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_netscan.yml"
      }
    },
    {
      "id": "6f8b3439-a203-45dc-a88b-abf57ea15ccf",
      "title": "HackTool - CrackMapExec PowerShell Obfuscation",
      "status": "test",
      "description": "The CrachMapExec pentesting framework implements a PowerShell obfuscation with some static strings detected by this rule.",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059.001",
        "attack.defense-evasion",
        "attack.t1027.005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "join*split",
                  "( $ShellId[1]+$ShellId[13]+'x')",
                  "( $PSHome[*]+$PSHOME[*]+",
                  "( $env:Public[13]+$env:Public[5]+'x')",
                  "( $env:ComSpec[4,*,25]-Join'')",
                  "[1,3]+'x'-Join'')"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001",
          "T1027.005"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Thomas Patzke",
        "date": "2020-05-22",
        "modified": "2023-02-21",
        "references": [
          "https://github.com/byt3bl33d3r/CrackMapExec",
          "https://github.com/byt3bl33d3r/CrackMapExec/blob/0a49f75347b625e81ee6aa8c33d3970b5515ea9e/cme/helpers/powershell.py#L242"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_crackmapexec_powershell_obfuscation.yml"
      }
    },
    {
      "id": "d2125259-ddea-4c1c-9c22-977eb5b29cf0",
      "title": "New Root Certificate Installed Via Certutil.EXE",
      "status": "test",
      "description": "Detects execution of \"certutil\" with the \"addstore\" flag in order to install a new certificate on the system.\nAdversaries may install a root certificate on a compromised system to avoid warnings when connecting to adversary controlled web servers.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1553.004"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\certutil.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "CertUtil.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_add": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-addstore",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli_store": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "root",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1553.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "oscd.community, @redcanary, Zach Stanford @svch0st",
        "date": "2023-03-05",
        "modified": "2024-03-05",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1553.004/T1553.004.md"
        ],
        "falsepositives": [
          "Help Desk or IT may need to manually add a corporate Root CA on occasion. Need to test if GPO push doesn't trigger FP"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_certutil_certificate_installation.yml"
      }
    },
    {
      "id": "edd8a48c-1b9f-4ba1-83aa-490338cd1ccb",
      "title": "Renamed Jusched.EXE Execution",
      "status": "test",
      "description": "Detects the execution of a renamed \"jusched.exe\" as seen used by the cobalt group",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.defense-evasion",
        "attack.t1036.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Description": {
                "field": "Description",
                "value": [
                  "Java Update Scheduler",
                  "Java(TM) Update Scheduler"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\jusched.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1036.003"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Markus Neis, Swisscom",
        "date": "2019-06-04",
        "modified": "2023-02-03",
        "references": [
          "https://www.bitdefender.com/files/News/CaseStudies/study/262/Bitdefender-WhitePaper-An-APT-Blueprint-Gaining-New-Visibility-into-Financial-Threats-interactive.pdf"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_renamed_jusched.yml"
      }
    },
    {
      "id": "7be5fb68-f9ef-476d-8b51-0256ebece19e",
      "title": "Suspicious Execution of Hostname",
      "status": "test",
      "description": "Use of hostname to get information",
      "level": "low",
      "tags": [
        "attack.discovery",
        "attack.t1082"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\HOSTNAME.EXE",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1082"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-01",
        "modified": "",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1082/T1082.md#atomic-test-6---hostname-discovery-windows",
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/hostname"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hostname_execution.yml"
      }
    },
    {
      "id": "0a13e132-651d-11eb-ae93-0242ac130002",
      "title": "Audit Policy Tampering Via Auditpol",
      "status": "test",
      "description": "Threat actors can use auditpol binary to change audit policy configuration to impair detection capability.\nThis can be carried out by selectively disabling/removing certain audit policies as well as restoring a custom policy owned by the threat actor.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\auditpol.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "AUDITPOL.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "disable",
                  "clear",
                  "remove",
                  "restore"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.002"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Janantha Marasinghe (https://github.com/blueteam0ps)",
        "date": "2021-02-02",
        "modified": "2023-02-22",
        "references": [
          "https://www.microsoft.com/security/blog/2021/01/20/deep-dive-into-the-solorigate-second-stage-activation-from-sunburst-to-teardrop-and-raindrop/"
        ],
        "falsepositives": [
          "Administrator or administrator scripts might leverage the flags mentioned in the detection section. Either way, it should always be monitored"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_auditpol_susp_execution.yml"
      }
    },
    {
      "id": "db1c21e4-cd66-4b4e-85ca-590f0780529c",
      "title": "Windows Recovery Environment Disabled Via Reagentc",
      "status": "experimental",
      "description": "Detects attempts to disable windows recovery environment using Reagentc.\nReAgentc.exe is a command-line tool in Windows used to manage the Windows Recovery Environment (WinRE).\nIt allows users to enable, disable, and configure WinRE, which is used for troubleshooting and repairing common boot issues.\n",
      "level": "medium",
      "tags": [
        "attack.impact",
        "attack.t1490"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\reagentc.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "reagentc.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "/disable",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1490"
        ],
        "tactics": [
          "impact"
        ]
      },
      "meta": {
        "author": "Daniel Koifman (KoifSec), Michael Vilshin",
        "date": "2025-07-31",
        "modified": "",
        "references": [
          "https://www.elastic.co/security-labs/maas-appeal-an-infostealer-rises-from-the-ashes",
          "https://learn.microsoft.com/en-us/windows-hardware/manufacture/desktop/reagentc-command-line-options?view=windows-11"
        ],
        "falsepositives": [
          "Legitimate administrative activity"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_reagentc_disable_windows_recovery_environment.yml"
      }
    },
    {
      "id": "514e4c3a-c77d-4cde-a00f-046425e2301e",
      "title": "Abuse of Service Permissions to Hide Services Via Set-Service",
      "status": "test",
      "description": "Detects usage of the \"Set-Service\" powershell cmdlet to configure a new SecurityDescriptor that allows a service to be hidden from other utilities such as \"sc.exe\", \"Get-Service\"...etc. (Works only in powershell 7)",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1574.011"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\pwsh.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "pwsh.dll",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_sddl": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "Set-Service ",
                  "DCLCWPDTSD"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cmdlet": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "-SecurityDescriptorSddl ",
                  "-sd "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1574.011"
        ],
        "tactics": [
          "persistence",
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-10-17",
        "modified": "",
        "references": [
          "https://twitter.com/Alh4zr3d/status/1580925761996828672",
          "https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.management/set-service?view=powershell-7.2"
        ],
        "falsepositives": [
          "Rare intended use of hidden services"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_hide_services_via_set_service.yml"
      }
    },
    {
      "id": "dee4af55-1f22-4e1d-a9d2-4bdc7ecb472a",
      "title": "Disabled Volume Snapshots",
      "status": "test",
      "description": "Detects commands that temporarily turn off Volume Snapshots",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "\\Services\\VSS\\Diag",
                  "/d Disabled"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-01-28",
        "modified": "2023-12-15",
        "references": [
          "https://twitter.com/0gtweet/status/1354766164166115331"
        ],
        "falsepositives": [
          "Legitimate administration"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_reg_volsnap_disable.yml"
      }
    },
    {
      "id": "0e0255bf-2548-47b8-9582-c0955c9283f5",
      "title": "Suspicious Reg Add BitLocker",
      "status": "test",
      "description": "Detects suspicious addition to BitLocker related registry keys via the reg.exe utility",
      "level": "high",
      "tags": [
        "attack.impact",
        "attack.t1486"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "REG",
                  "ADD",
                  "\\SOFTWARE\\Policies\\Microsoft\\FVE",
                  "/v",
                  "/f"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "EnableBDEWithNoTPM",
                  "UseAdvancedStartup",
                  "UseTPM",
                  "UseTPMKey",
                  "UseTPMKeyPIN",
                  "RecoveryKeyMessageSource",
                  "UseTPMPIN",
                  "RecoveryKeyMessage"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1486"
        ],
        "tactics": [
          "impact"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-11-15",
        "modified": "2022-09-09",
        "references": [
          "https://thedfirreport.com/2021/11/15/exchange-exploit-leads-to-domain-wide-ransomware/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_reg_bitlocker.yml"
      }
    },
    {
      "id": "8e3c7994-131e-4ba5-b6ea-804d49113a26",
      "title": "Uncommon Child Process Spawned By Odbcconf.EXE",
      "status": "test",
      "description": "Detects an uncommon child process of \"odbcconf.exe\" binary which normally shouldn't have any child processes.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.008"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\odbcconf.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.008"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Harjot Singh @cyb3rjy0t",
        "date": "2023-05-22",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/sql/odbc/odbcconf-exe?view=sql-server-ver16",
          "https://lolbas-project.github.io/lolbas/Binaries/Odbcconf/",
          "https://medium.com/@cyberjyot/t1218-008-dll-execution-using-odbcconf-exe-803fa9e08dac"
        ],
        "falsepositives": [
          "In rare occurrences where \"odbcconf\" crashes. It might spawn a \"werfault\" process",
          "Other child processes will depend on the DLL being registered by actions like \"regsvr\". In case where the DLLs have external calls (which should be rare). Other child processes might spawn and additional filters need to be applied."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_odbcconf_uncommon_child_process.yml"
      }
    },
    {
      "id": "fb50eb7a-5ab1-43ae-bcc9-091818cb8424",
      "title": "Disabled IE Security Features",
      "status": "test",
      "description": "Detects command lines that indicate unwanted modifications to registry keys that disable important Internet Explorer security features",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " -name IEHarden ",
                  " -value 0 "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " -name DEPOff ",
                  " -value 1 "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection3": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " -name DisableFirstRunCustomize ",
                  " -value 2 "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2020-06-19",
        "modified": "2021-11-27",
        "references": [
          "https://unit42.paloaltonetworks.com/operation-ke3chang-resurfaces-with-new-tidepool-malware/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_disable_ie_features.yml"
      }
    },
    {
      "id": "762f2482-ff21-4970-8939-0aa317a886bb",
      "title": "HackTool - Certify Execution",
      "status": "test",
      "description": "Detects Certify a tool for Active Directory certificate abuse based on PE metadata characteristics and common command line arguments.",
      "level": "high",
      "tags": [
        "attack.discovery",
        "attack.credential-access",
        "attack.t1649"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\Certify.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "Certify.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description__contains": {
                    "field": "Description",
                    "value": "Certify",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_commands": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ".exe cas ",
                  ".exe find ",
                  ".exe pkiobjects ",
                  ".exe request ",
                  ".exe download "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_options": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " /vulnerable",
                  " /template:",
                  " /altname:",
                  " /domain:",
                  " /path:",
                  " /ca:"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_img or all of selection_cli_*",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection_img",
            "all of selection_cli_*"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1649"
        ],
        "tactics": [
          "discovery",
          "credential_access"
        ]
      },
      "meta": {
        "author": "pH-T (Nextron Systems)",
        "date": "2023-04-17",
        "modified": "2023-04-25",
        "references": [
          "https://github.com/GhostPack/Certify"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_certify.yml"
      }
    },
    {
      "id": "5b768e71-86f2-4879-b448-81061cbae951",
      "title": "Suspicious Manipulation Of Default Accounts Via Net.EXE",
      "status": "test",
      "description": "Detects suspicious manipulations of default accounts such as 'administrator' and 'guest'. For example 'enable' or 'disable' accounts or change the password...etc",
      "level": "high",
      "tags": [
        "attack.collection",
        "attack.t1560.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\net.exe",
                      "\\net1.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "net.exe",
                      "net1.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_user_option": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " user ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_username": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " Järjestelmänvalvoja ",
                  " Rendszergazda ",
                  " Администратор ",
                  " Administrateur ",
                  " Administrador ",
                  " Administratör ",
                  " Administrator ",
                  " guest ",
                  " DefaultAccount ",
                  " \"Järjestelmänvalvoja\" ",
                  " \"Rendszergazda\" ",
                  " \"Администратор\" ",
                  " \"Administrateur\" ",
                  " \"Administrador\" ",
                  " \"Administratör\" ",
                  " \"Administrator\" ",
                  " \"guest\" ",
                  " \"DefaultAccount\" ",
                  " 'Järjestelmänvalvoja' ",
                  " 'Rendszergazda' ",
                  " 'Администратор' ",
                  " 'Administrateur' ",
                  " 'Administrador' ",
                  " 'Administratör' ",
                  " 'Administrator' ",
                  " 'guest' ",
                  " 'DefaultAccount' "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "guest",
                  "/active no"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not filter",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "all of selection_*"
            },
            {
              "type": "not",
              "value": "filter"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1560.001"
        ],
        "tactics": [
          "collection"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-09-01",
        "modified": "2023-02-21",
        "references": [
          "https://www.trellix.com/en-sg/about/newsroom/stories/threat-labs/lockergoga-ransomware-family-used-in-targeted-attacks.html",
          "https://redacted.com/blog/bianlian-ransomware-gang-gives-it-a-go/",
          "https://www.microsoft.com/security/blog/2022/09/07/profiling-dev-0270-phosphorus-ransomware-operations/"
        ],
        "falsepositives": [
          "Some false positives could occur with the admin or guest account. It depends on the scripts being used by the admins in your env. If you experience a lot of FP you could reduce the level to medium"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_net_user_default_accounts_manipulation.yml"
      }
    },
    {
      "id": "4931188c-178e-4ee7-a348-39e8a7a56821",
      "title": "Filter Driver Unloaded Via Fltmc.EXE",
      "status": "test",
      "description": "Detect filter driver unloading activity via fltmc.exe",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1070",
        "attack.t1562",
        "attack.t1562.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\fltMC.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "fltMC.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "unload",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_avira": {
            "type": "field_match",
            "matchers": {
              "ParentImage__contains": {
                "field": "ParentImage",
                "value": [
                  "\\AppData\\Local\\Temp\\",
                  ":\\Windows\\Temp\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\endpoint-protection-installer-x64.tmp",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": [
                  "unload rtp_filesystem_filter",
                  "unload rtp_filter"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_manageengine": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": "C:\\Program Files (x86)\\ManageEngine\\uems_agent\\bin\\dcfaservice64.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": "unload DFMFilter",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_optional_"
        }
      },
      "mitre": {
        "techniques": [
          "T1070",
          "T1562",
          "T1562.002"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-02-13",
        "modified": "2025-10-07",
        "references": [
          "https://www.darkoperator.com/blog/2018/10/5/operating-offensively-against-sysmon",
          "https://www.cybereason.com/blog/threat-analysis-report-lockbit-2.0-all-paths-lead-to-ransom"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_fltmc_unload_driver.yml"
      }
    },
    {
      "id": "056c7317-9a09-4bd4-9067-d051312752ea",
      "title": "Powershell Executed From Headless ConHost Process",
      "status": "test",
      "description": "Detects the use of powershell commands from headless ConHost window.\nThe \"--headless\" flag hides the windows from the user upon execution.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.execution",
        "attack.t1059.001",
        "attack.t1059.003",
        "attack.t1564.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\conhost.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "CONHOST.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "--headless",
                  "powershell"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001",
          "T1059.003",
          "T1564.003"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Matt Anderson (Huntress)",
        "date": "2024-07-23",
        "modified": "",
        "references": [
          "https://www.huntress.com/blog/fake-browser-updates-lead-to-boinc-volunteer-computing-software"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_conhost_headless_powershell.yml"
      }
    },
    {
      "id": "98767d61-b2e8-4d71-b661-e36783ee24c1",
      "title": "Gzip Archive Decode Via PowerShell",
      "status": "test",
      "description": "Detects attempts of decoding encoded Gzip archives via PowerShell.",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1132.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "GZipStream",
                  "::Decompress"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1132.001"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Hieu Tran",
        "date": "2023-03-13",
        "modified": "",
        "references": [
          "https://www.zscaler.com/blogs/security-research/onenote-growing-threat-malware-distribution"
        ],
        "falsepositives": [
          "Legitimate administrative scripts may use this functionality. Use \"ParentImage\" in combination with the script names and allowed users and applications to filter legitimate executions"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_decode_gzip.yml"
      }
    },
    {
      "id": "6f1a11aa-4b8a-4b7f-9e13-4d3e4ff0e0d4",
      "title": "WSL Kali-Linux Usage",
      "status": "experimental",
      "description": "Detects the use of Kali Linux through Windows Subsystem for Linux",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1202"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img_appdata": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__contains_all": {
                    "field": "Image",
                    "value": [
                      ":\\Users\\",
                      "\\AppData\\Local\\packages\\KaliLinux"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__contains_all": {
                    "field": "Image",
                    "value": [
                      ":\\Users\\",
                      "\\AppData\\Local\\Microsoft\\WindowsApps\\kali.exe"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_img_windowsapps": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": ":\\Program Files\\WindowsApps\\KaliLinux.",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\kali.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_kali_wsl_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\wsl.exe",
                  "\\wslhost.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_kali_wsl_child": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__contains": {
                    "field": "Image",
                    "value": [
                      "\\kali.exe",
                      "\\KaliLinux"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      "Kali.exe",
                      "Kali-linux",
                      "kalilinux"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_main_install_uninstall": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -i ",
                  " --install ",
                  " --unregister "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "1 of selection_img_* or all of selection_kali_* and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "1 of selection_img_*",
            "all of selection_kali_* and not 1 of filter_main_*"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1202"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-10-10",
        "modified": "",
        "references": [
          "https://medium.com/@redfanatic7/running-kali-linux-on-windows-51ad95166e6e",
          "https://learn.microsoft.com/en-us/windows/wsl/install"
        ],
        "falsepositives": [
          "Legitimate installation or usage of Kali Linux WSL by administrators or security teams"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wsl_kali_linux_usage.yml"
      }
    },
    {
      "id": "8de89e52-f6e1-4b5b-afd1-41ecfa300d48",
      "title": "Suspicious WindowsTerminal Child Processes",
      "status": "test",
      "description": "Detects suspicious children spawned via the Windows Terminal application which could be a sign of persistence via WindowsTerminal (see references section)",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.persistence"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\WindowsTerminal.exe",
                  "\\wt.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_susp": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\rundll32.exe",
                      "\\regsvr32.exe",
                      "\\certutil.exe",
                      "\\cscript.exe",
                      "\\wscript.exe",
                      "\\csc.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__contains": {
                    "field": "Image",
                    "value": [
                      "C:\\Users\\Public\\",
                      "\\Downloads\\",
                      "\\Desktop\\",
                      "\\AppData\\Local\\Temp\\",
                      "\\Windows\\TEMP\\"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      " iex ",
                      " icm",
                      "Invoke-",
                      "Import-Module ",
                      "ipmo ",
                      "DownloadString(",
                      " /c ",
                      " /k ",
                      " /r "
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_builtin_visual_studio_shell": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "Import-Module",
                  "Microsoft.VisualStudio.DevShell.dll",
                  "Enter-VsDevShell"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_open_settings": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "\\AppData\\Local\\Packages\\Microsoft.WindowsTerminal_",
                  "\\LocalState\\settings.json"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_vsdevcmd": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "C:\\Program Files\\Microsoft Visual Studio\\",
                  "\\Common7\\Tools\\VsDevCmd.bat"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution",
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-07-25",
        "modified": "2023-02-14",
        "references": [
          "https://persistence-info.github.io/Data/windowsterminalprofile.html",
          "https://twitter.com/nas_bench/status/1550836225652686848"
        ],
        "falsepositives": [
          "Other legitimate \"Windows Terminal\" profiles"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_windows_terminal_susp_children.yml"
      }
    },
    {
      "id": "797011dc-44f4-4e6f-9f10-a8ceefbe566b",
      "title": "WMI Backdoor Exchange Transport Agent",
      "status": "test",
      "description": "Detects a WMI backdoor in Exchange Transport Agents via WMI event filters",
      "level": "critical",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1546.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\EdgeTransport.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_conhost": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\System32\\conhost.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_oleconverter": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Program Files\\Microsoft\\Exchange Server\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\Bin\\OleConverter.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1546.003"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2019-10-11",
        "modified": "2023-02-08",
        "references": [
          "https://twitter.com/cglyer/status/1182389676876980224",
          "https://twitter.com/cglyer/status/1182391019633029120"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wmi_backdoor_exchange_transport_agent.yml"
      }
    },
    {
      "id": "0022869c-49f7-4ff2-ba03-85ac42ddac58",
      "title": "System Information Discovery via Registry Queries",
      "status": "experimental",
      "description": "Detects attempts to query system information directly from the Windows Registry.",
      "level": "low",
      "tags": [
        "attack.discovery",
        "attack.t1082"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_cmd_reg": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\reg.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "query",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_1": {
                "field": "CommandLine",
                "value": "-v",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cmd_powershell": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\powershell.exe",
                  "\\pwsh.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Get-ItemPropertyValue",
                  "gpv"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_keys": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\SOFTWARE\\Microsoft\\Windows Defender",
                  "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion",
                  "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall",
                  "\\SYSTEM\\CurrentControlSet\\Control\\TimeZoneInformation",
                  "\\SYSTEM\\CurrentControlSet\\Services"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_cmd_* and selection_keys",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "1 of selection_cmd_*"
            },
            {
              "type": "ref",
              "value": "selection_keys"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1082"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "lazarg",
        "date": "2025-06-12",
        "modified": "2025-10-25",
        "references": [
          "https://cert.gov.ua/article/6277849",
          "https://github.com/redcanaryco/atomic-red-team/blob/75fa21076dcefa348a7521403cdd6bfc4e88623c/atomics/T1082/T1082.md",
          "https://github.com/redcanaryco/atomic-red-team/blob/75fa21076dcefa348a7521403cdd6bfc4e88623c/atomics/T1124/T1124.md"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_discovery_via_reg_queries.yml"
      }
    },
    {
      "id": "56321594-9087-49d9-bf10-524fe8479452",
      "title": "Potential Persistence Via Netsh Helper DLL",
      "status": "test",
      "description": "Detects the execution of netsh with \"add helper\" flag in order to add a custom helper DLL. This technique can be abused to add a malicious helper DLL that can be used as a persistence proxy that gets called when netsh.exe is executed.\n",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1546.007",
        "attack.s0108"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "netsh.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\netsh.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "add",
                  "helper"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1546.007"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Victor Sergeev, oscd.community",
        "date": "2019-10-25",
        "modified": "2023-11-28",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1546.007/T1546.007.md",
          "https://github.com/outflanknl/NetshHelperBeacon",
          "https://web.archive.org/web/20160928212230/https://www.adaptforward.com/2016/09/using-netshell-to-execute-evil-dlls-and-persist-on-a-host/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_netsh_helper_dll_persistence.yml"
      }
    },
    {
      "id": "ea0cdc3e-2239-4f26-a947-4e8f8224e464",
      "title": "Suspicious File Encoded To Base64 Via Certutil.EXE",
      "status": "test",
      "description": "Detects the execution of certutil with the \"encode\" flag to encode a file to base64 where the extensions of the file is suspicious",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\certutil.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "CertUtil.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-encode",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_extension": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ".acl",
                  ".bat",
                  ".doc",
                  ".gif",
                  ".jpeg",
                  ".jpg",
                  ".mp3",
                  ".pdf",
                  ".png",
                  ".ppt",
                  ".tmp",
                  ".xls",
                  ".xml"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1027"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-15",
        "modified": "2024-03-05",
        "references": [
          "https://www.virustotal.com/gui/file/35c22725a92d5cb1016b09421c0a6cdbfd860fd4778b3313669b057d4a131cb7/behavior",
          "https://www.virustotal.com/gui/file/427616528b7dbc4a6057ac89eb174a3a90f7abcf3f34e5a359b7a910d82f7a72/behavior",
          "https://www.virustotal.com/gui/file/34de4c8beded481a4084a1fd77855c3e977e8ac643e5c5842d0f15f7f9b9086f/behavior",
          "https://www.virustotal.com/gui/file/4abe1395a09fda06d897a9c4eb247278c1b6cddda5d126ce5b3f4f499e3b8fa2/behavior"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_certutil_encode_susp_extensions.yml"
      }
    },
    {
      "id": "114e7f1c-f137-48c8-8f54-3088c24ce4b9",
      "title": "Remote Access Tool - AnyDesk Silent Installation",
      "status": "test",
      "description": "Detects AnyDesk Remote Desktop silent installation. Which can be used by attackers to gain remote access.",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1219.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "--install",
                  "--start-with-win",
                  "--silent"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1219.002"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Ján Trenčanský",
        "date": "2021-08-06",
        "modified": "2023-03-05",
        "references": [
          "https://twitter.com/TheDFIRReport/status/1423361119926816776?s=20",
          "https://support.anydesk.com/Automatic_Deployment"
        ],
        "falsepositives": [
          "Legitimate deployment of AnyDesk"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_remote_access_tools_anydesk_silent_install.yml"
      }
    },
    {
      "id": "a537cfc3-4297-4789-92b5-345bfd845ad0",
      "title": "Service DACL Abuse To Hide Services Via Sc.EXE",
      "status": "test",
      "description": "Detects usage of the \"sc.exe\" utility adding a new service with special permission seen used by threat actors which makes the service hidden and unremovable.",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1574.011"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\sc.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "sc.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "sdset",
                  "DCLCWPDTSD"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1574.011"
        ],
        "tactics": [
          "persistence",
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Andreas Hunkeler (@Karneades)",
        "date": "2021-12-20",
        "modified": "2022-08-08",
        "references": [
          "https://blog.talosintelligence.com/2021/10/threat-hunting-in-large-datasets-by.html",
          "https://www.sans.org/blog/red-team-tactics-hiding-windows-services/",
          "https://twitter.com/Alh4zr3d/status/1580925761996828672",
          "https://itconnect.uw.edu/tools-services-support/it-systems-infrastructure/msinf/other-help/understanding-sddl-syntax/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sc_sdset_hide_sevices.yml"
      }
    },
    {
      "id": "089fc3d2-71e8-4763-a8a5-c97fbb0a403e",
      "title": "Regsvr32 DLL Execution With Suspicious File Extension",
      "status": "test",
      "description": "Detects the execution of REGSVR32.exe with DLL files masquerading as other files",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.010"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\regsvr32.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "REGSVR32.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": [
                  ".bin",
                  ".bmp",
                  ".cr2",
                  ".dat",
                  ".eps",
                  ".gif",
                  ".ico",
                  ".jpeg",
                  ".jpg",
                  ".log",
                  ".nef",
                  ".orf",
                  ".png",
                  ".raw",
                  ".rtf",
                  ".sr2",
                  ".temp",
                  ".tif",
                  ".tiff",
                  ".tmp",
                  ".txt"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.010"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), frack113",
        "date": "2021-11-29",
        "modified": "2025-08-27",
        "references": [
          "https://thedfirreport.com/2021/11/29/continuing-the-bazar-ransomware-story/",
          "https://blog.talosintelligence.com/2021/10/threat-hunting-in-large-datasets-by.html",
          "https://guides.lib.umich.edu/c.php?g=282942&p=1885348",
          "https://harfanglab.io/insidethelab/uac-0057-pressure-ukraine-poland/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_regsvr32_susp_extensions.yml"
      }
    },
    {
      "id": "75bfe6e6-cd8e-429e-91d3-03921e1d7962",
      "title": "Remote Access Tool - ScreenConnect Installation Execution",
      "status": "test",
      "description": "Detects ScreenConnect program starts that establish a remote access to a system.",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.initial-access",
        "attack.t1133"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "e=Access&",
                  "y=Guest&",
                  "&p=",
                  "&c=",
                  "&k="
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1133"
        ],
        "tactics": [
          "persistence",
          "initial_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-02-11",
        "modified": "2024-02-26",
        "references": [
          "https://www.anomali.com/blog/probable-iranian-cyber-actors-static-kitten-conducting-cyberespionage-campaign-targeting-uae-and-kuwait-government-agencies"
        ],
        "falsepositives": [
          "Legitimate use by administrative staff"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_remote_access_tools_screenconnect_installation_cli_param.yml"
      }
    },
    {
      "id": "39019a4e-317f-4ce3-ae63-309a8c6b53c5",
      "title": "Suspicious Scheduled Task Creation Involving Temp Folder",
      "status": "test",
      "description": "Detects the creation of scheduled tasks that involves a temporary folder and runs only once",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.execution",
        "attack.persistence",
        "attack.t1053.005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\schtasks.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " /create ",
                  " /sc once ",
                  "\\Temp\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1053.005"
        ],
        "tactics": [
          "privilege_escalation",
          "execution",
          "persistence"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-03-11",
        "modified": "2022-10-09",
        "references": [
          "https://discuss.elastic.co/t/detection-and-response-for-hafnium-activity/266289/3"
        ],
        "falsepositives": [
          "Administrative activity",
          "Software installation"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_schtasks_creation_temp_folder.yml"
      }
    },
    {
      "id": "edadb1e5-5919-4e4c-8462-a9e643b02c4b",
      "title": "Process Memory Dump via RdrLeakDiag.EXE",
      "status": "test",
      "description": "Detects the use of the Microsoft Windows Resource Leak Diagnostic tool \"rdrleakdiag.exe\" to dump process memory",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\rdrleakdiag.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "RdrLeakDiag.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_dump": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "/memdmp",
                  "fullmemdmp"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_output_process": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " /o ",
                  " /p "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.001"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Cedric MAURUGEON, Florian Roth (Nextron Systems), Swachchhanda Shrawan Poudel, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2021-09-24",
        "modified": "2024-08-15",
        "references": [
          "https://www.pureid.io/dumping-abusing-windows-credentials-part-1/",
          "https://www.crowdstrike.com/blog/overwatch-exposes-aquatic-panda-in-possession-of-log-4-shell-exploit-tools/",
          "https://lolbas-project.github.io/lolbas/Binaries/Rdrleakdiag/",
          "https://twitter.com/0gtweet/status/1299071304805560321?s=21",
          "https://news.sophos.com/en-us/2024/06/05/operation-crimson-palace-a-technical-deep-dive"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_rdrleakdiag_process_dumping.yml"
      }
    },
    {
      "id": "5e6a80c8-2d45-4633-9ef4-fa2671a39c5c",
      "title": "Suspicious Parent Double Extension File Execution",
      "status": "test",
      "description": "Detect execution of suspicious double extension files in ParentCommandLine",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036.007"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "ParentImage__endswith": {
                    "field": "ParentImage",
                    "value": [
                      ".doc.lnk",
                      ".docx.lnk",
                      ".xls.lnk",
                      ".xlsx.lnk",
                      ".ppt.lnk",
                      ".pptx.lnk",
                      ".rtf.lnk",
                      ".pdf.lnk",
                      ".txt.lnk",
                      ".doc.js",
                      ".docx.js",
                      ".xls.js",
                      ".xlsx.js",
                      ".ppt.js",
                      ".pptx.js",
                      ".rtf.js",
                      ".pdf.js",
                      ".txt.js"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "ParentCommandLine__contains": {
                    "field": "ParentCommandLine",
                    "value": [
                      ".doc.lnk",
                      ".docx.lnk",
                      ".xls.lnk",
                      ".xlsx.lnk",
                      ".ppt.lnk",
                      ".pptx.lnk",
                      ".rtf.lnk",
                      ".pdf.lnk",
                      ".txt.lnk",
                      ".doc.js",
                      ".docx.js",
                      ".xls.js",
                      ".xlsx.js",
                      ".ppt.js",
                      ".pptx.js",
                      ".rtf.js",
                      ".pdf.js",
                      ".txt.js"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1036.007"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-01-06",
        "modified": "2023-02-28",
        "references": [
          "https://www.virustotal.com/gui/file/7872d8845a332dce517adae9c3389fde5313ff2fed38c2577f3b498da786db68/behavior",
          "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/bluebottle-banks-targeted-africa"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_double_extension_parent.yml"
      }
    },
    {
      "id": "22e58743-4ac8-4a9f-bf19-00a0428d8c5f",
      "title": "Base64 MZ Header In CommandLine",
      "status": "test",
      "description": "Detects encoded base64 MZ header in the commandline",
      "level": "high",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "TVqQAAMAAAAEAAAA",
                  "TVpQAAIAAAAEAA8A",
                  "TVqAAAEAAAAEABAA",
                  "TVoAAAAAAAAAAAAA",
                  "TVpTAQEAAAAEAAAA"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-07-12",
        "modified": "",
        "references": [
          "https://thedfirreport.com/2022/07/11/select-xmrig-from-sqlserver/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_inline_base64_mz_header.yml"
      }
    },
    {
      "id": "cd8c163e-a19b-402e-bdd5-419ff5859f12",
      "title": "HackTool - ADCSPwn Execution",
      "status": "test",
      "description": "Detects command line parameters used by ADCSPwn, a tool to escalate privileges in an active directory network by coercing authenticate from machine accounts and relaying to the certificate service",
      "level": "high",
      "tags": [
        "attack.collection",
        "attack.credential-access",
        "attack.t1557.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " --adcs ",
                  " --port "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1557.001"
        ],
        "tactics": [
          "collection",
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-07-31",
        "modified": "2023-02-04",
        "references": [
          "https://github.com/bats3c/ADCSPwn"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_adcspwn.yml"
      }
    },
    {
      "id": "f72aa3e8-49f9-4c7d-bd74-f8ab84ff9bbb",
      "title": "Suspicious RDP Redirect Using TSCON",
      "status": "test",
      "description": "Detects a suspicious RDP session redirect using tscon.exe",
      "level": "high",
      "tags": [
        "attack.lateral-movement",
        "attack.t1563.002",
        "attack.t1021.001",
        "car.2013-07-002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " /dest:rdp-tcp#",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1563.002",
          "T1021.001"
        ],
        "tactics": [
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2018-03-17",
        "modified": "2023-05-16",
        "references": [
          "http://www.korznikov.com/2017/03/0-day-or-feature-privilege-escalation.html",
          "https://medium.com/@networksecurity/rdp-hijacking-how-to-hijack-rds-and-remoteapp-sessions-transparently-to-move-through-an-da2a1e73a5f6",
          "https://www.hackingarticles.in/rdp-session-hijacking-with-tscon/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_tscon_rdp_redirect.yml"
      }
    },
    {
      "id": "055fb54c-a8f4-4aee-bd44-f74cf30a0d9d",
      "title": "HackTool - SharpMove Tool Execution",
      "status": "test",
      "description": "Detects the execution of SharpMove, a .NET utility performing multiple tasks such as \"Task Creation\", \"SCM\" query, VBScript execution using WMI via its PE metadata and command line options.\n",
      "level": "high",
      "tags": [
        "attack.lateral-movement",
        "attack.t1021.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\SharpMove.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "SharpMove.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_computer": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "computername=",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli_actions": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "action=create",
                  "action=dcom",
                  "action=executevbs",
                  "action=hijackdcom",
                  "action=modschtask",
                  "action=modsvc",
                  "action=query",
                  "action=scm",
                  "action=startservice",
                  "action=taskscheduler"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_img or all of selection_cli_*",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection_img",
            "all of selection_cli_*"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1021.002"
        ],
        "tactics": [
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Luca Di Bartolomeo (CrimpSec)",
        "date": "2024-01-29",
        "modified": "",
        "references": [
          "https://github.com/0xthirteen/SharpMove/",
          "https://pentestlab.blog/tag/sharpmove/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_sharpmove.yml"
      }
    },
    {
      "id": "b124ddf4-778d-418e-907f-6dd3fc0d31cd",
      "title": "Arbitrary File Download Via PresentationHost.EXE",
      "status": "test",
      "description": "Detects usage of \"PresentationHost\" which is a utility that runs \".xbap\" (Browser Applications) files to download arbitrary files",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.execution",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\presentationhost.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "PresentationHost.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "http://",
                  "https://",
                  "ftp://"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-19",
        "modified": "2023-11-09",
        "references": [
          "https://github.com/LOLBAS-Project/LOLBAS/pull/239/files"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_presentationhost_download.yml"
      }
    },
    {
      "id": "5fdce3ac-e7f9-4ecd-a3aa-a4d78ebbf0af",
      "title": "Mstsc.EXE Execution With Local RDP File",
      "status": "test",
      "description": "Detects potential RDP connection via Mstsc using a local \".rdp\" file",
      "level": "low",
      "tags": [
        "attack.command-and-control",
        "attack.t1219.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\mstsc.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "mstsc.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": [
                  ".rdp",
                  ".rdp\""
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_wsl": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": "C:\\Windows\\System32\\lxss\\wslhost.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "C:\\ProgramData\\Microsoft\\WSL\\wslg.rdp",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_optional_"
        }
      },
      "mitre": {
        "techniques": [
          "T1219.002"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), Christopher Peacock @securepeacock",
        "date": "2023-04-18",
        "modified": "2023-04-30",
        "references": [
          "https://www.blackhillsinfosec.com/rogue-rdp-revisiting-initial-access-methods/",
          "https://web.archive.org/web/20230726144748/https://blog.thickmints.dev/mintsights/detecting-rogue-rdp/"
        ],
        "falsepositives": [
          "Likely with legitimate usage of \".rdp\" files"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_mstsc_run_local_rdp_file.yml"
      }
    },
    {
      "id": "ac1c92b4-ac81-405a-9978-4604d78cc47e",
      "title": "Potential Binary Proxy Execution Via VSDiagnostics.EXE",
      "status": "test",
      "description": "Detects execution of \"VSDiagnostics.exe\" with the \"start\" command in order to launch and proxy arbitrary binaries.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\VSDiagnostics.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "VSDiagnostics.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_start": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "start",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli_launch": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " /launch:",
                  " -launch:"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-08-03",
        "modified": "",
        "references": [
          "https://twitter.com/0xBoku/status/1679200664013135872"
        ],
        "falsepositives": [
          "Legitimate usage for tracing and diagnostics purposes"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_vsdiagnostics_execution_proxy.yml"
      }
    },
    {
      "id": "38646daa-e78f-4ace-9de0-55547b2d30da",
      "title": "PUA - Seatbelt Execution",
      "status": "test",
      "description": "Detects the execution of the PUA/Recon tool Seatbelt via PE information of command line parameters",
      "level": "high",
      "tags": [
        "attack.discovery",
        "attack.t1526",
        "attack.t1087",
        "attack.t1083"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\Seatbelt.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "Seatbelt.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "Seatbelt",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      " DpapiMasterKeys",
                      " InterestingProcesses",
                      " InterestingFiles",
                      " CertificateThumbprints",
                      " ChromiumBookmarks",
                      " ChromiumHistory",
                      " ChromiumPresence",
                      " CloudCredentials",
                      " CredEnum",
                      " CredGuard",
                      " FirefoxHistory",
                      " ProcessCreationEvents"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_group_list": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -group=misc",
                  " -group=remote",
                  " -group=chromium",
                  " -group=slack",
                  " -group=system",
                  " -group=user",
                  " -group=all"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_group_output": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -outputfile=",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_img or all of selection_group_*",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection_img",
            "all of selection_group_*"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1526",
          "T1087",
          "T1083"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-10-18",
        "modified": "2023-02-04",
        "references": [
          "https://github.com/GhostPack/Seatbelt",
          "https://www.bluetangle.dev/2022/08/fastening-seatbelt-on-threat-hunting.html"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_seatbelt.yml"
      }
    },
    {
      "id": "40b19fa6-d835-400c-b301-41f3a2baacaf",
      "title": "VolumeShadowCopy Symlink Creation Via Mklink",
      "status": "stable",
      "description": "Shadow Copies storage symbolic link creation using operating systems utilities",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003.002",
        "attack.t1003.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "mklink",
                  "HarddiskVolumeShadowCopy"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.002",
          "T1003.003"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Teymur Kheirkhabarov, oscd.community",
        "date": "2019-10-22",
        "modified": "2023-03-06",
        "references": [
          "https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment"
        ],
        "falsepositives": [
          "Legitimate administrator working with shadow copies, access for backup purposes"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_cmd_mklink_shadow_copies_access_symlink.yml"
      }
    },
    {
      "id": "692f0bec-83ba-4d04-af7e-e884a96059b6",
      "title": "Potential WMI Lateral Movement WmiPrvSE Spawned PowerShell",
      "status": "stable",
      "description": "Detects Powershell as a child of the WmiPrvSE process. Which could be a sign of lateral movement via WMI.",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1047",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\WmiPrvSE.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1047",
          "T1059.001"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Markus Neis @Karneades",
        "date": "2019-04-03",
        "modified": "2023-03-29",
        "references": [
          "https://any.run/report/68bc255f9b0db6a0d30a8f2dadfbee3256acfe12497bf93943bc1eab0735e45e/a2385d6f-34f7-403c-90d3-b1f9d2a90a5e"
        ],
        "falsepositives": [
          "AppvClient",
          "CCM",
          "WinRM"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wmiprvse_spawns_powershell.yml"
      }
    },
    {
      "id": "7b10f171-7f04-47c7-9fa2-5be43c76e535",
      "title": "Visual Basic Command Line Compiler Usage",
      "status": "test",
      "description": "Detects successful code compilation via Visual Basic Command Line Compiler that utilizes Windows Resource to Object Converter.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027.004"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\vbc.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\cvtres.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1027.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Ensar Şamil, @sblmsrsn, @oscd_initiative",
        "date": "2020-10-07",
        "modified": "2021-11-27",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Vbc/"
        ],
        "falsepositives": [
          "Utilization of this tool should not be seen in enterprise environment"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_visual_basic_compiler.yml"
      }
    },
    {
      "id": "16905e21-66ee-42fe-b256-1318ada2d770",
      "title": "Start of NT Virtual DOS Machine",
      "status": "test",
      "description": "Ntvdm.exe allows the execution of 16-bit Windows applications on 32-bit Windows operating systems, as well as the execution of both 16-bit and 32-bit DOS applications",
      "level": "medium",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\ntvdm.exe",
                  "\\csrstub.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-07-16",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/windows/compatibility/ntvdm-and-16-bit-app-support",
          "https://support.microsoft.com/fr-fr/topic/an-ms-dos-based-program-that-uses-the-ms-dos-protected-mode-interface-crashes-on-a-computer-that-is-running-windows-7-5dc739ea-987b-b458-15e4-d28d5cca63c7",
          "https://app.any.run/tasks/93fe92fa-8b2b-4d92-8c09-a841aed2e793/",
          "https://app.any.run/tasks/214094a7-0abc-4a7b-a564-1b757faed79d/"
        ],
        "falsepositives": [
          "Legitimate use"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_16bit_application.yml"
      }
    },
    {
      "id": "6b65c28e-11f3-46cb-902a-68f2cafaf474",
      "title": "Odbcconf.EXE Suspicious DLL Location",
      "status": "test",
      "description": "Detects execution of \"odbcconf\" where the path of the DLL being registered is located in a potentially suspicious location.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.008"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\odbcconf.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "odbcconf.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ":\\PerfLogs\\",
                  ":\\ProgramData\\",
                  ":\\Temp\\",
                  ":\\Users\\Public\\",
                  ":\\Windows\\Registration\\CRMLog",
                  ":\\Windows\\System32\\com\\dmp\\",
                  ":\\Windows\\System32\\FxsTmp\\",
                  ":\\Windows\\System32\\Microsoft\\Crypto\\RSA\\MachineKeys\\",
                  ":\\Windows\\System32\\spool\\drivers\\color\\",
                  ":\\Windows\\System32\\spool\\PRINTERS\\",
                  ":\\Windows\\System32\\spool\\SERVERS\\",
                  ":\\Windows\\System32\\Tasks_Migrated\\",
                  ":\\Windows\\System32\\Tasks\\Microsoft\\Windows\\SyncCenter\\",
                  ":\\Windows\\SysWOW64\\com\\dmp\\",
                  ":\\Windows\\SysWOW64\\FxsTmp\\",
                  ":\\Windows\\SysWOW64\\Tasks\\Microsoft\\Windows\\PLA\\System\\",
                  ":\\Windows\\SysWOW64\\Tasks\\Microsoft\\Windows\\SyncCenter\\",
                  ":\\Windows\\Tasks\\",
                  ":\\Windows\\Temp\\",
                  ":\\Windows\\Tracing\\",
                  "\\AppData\\Local\\Temp\\",
                  "\\AppData\\Roaming\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.008"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-22",
        "modified": "2023-05-26",
        "references": [
          "https://learn.microsoft.com/en-us/sql/odbc/odbcconf-exe?view=sql-server-ver16",
          "https://www.trendmicro.com/en_us/research/17/h/backdoor-carrying-emails-set-sights-on-russian-speaking-businesses.html",
          "https://securityintelligence.com/posts/raspberry-robin-worm-dridex-malware/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_odbcconf_exec_susp_locations.yml"
      }
    },
    {
      "id": "a2910908-e86f-4687-aeba-76a5f996e652",
      "title": "DLL Execution Via Register-cimprovider.exe",
      "status": "test",
      "description": "Detects using register-cimprovider.exe to execute arbitrary dll file.",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1574"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\register-cimprovider.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "-path",
                  "dll"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1574"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Ivan Dyachkov, Yulia Fomina, oscd.community",
        "date": "2020-10-07",
        "modified": "2021-11-27",
        "references": [
          "https://twitter.com/PhilipTsukerman/status/992021361106268161",
          "https://lolbas-project.github.io/lolbas/Binaries/Register-cimprovider/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_registry_cimprovider_dll_load.yml"
      }
    },
    {
      "id": "c3a99af4-35a9-4668-879e-c09aeb4f2bdf",
      "title": "Rundll32 Execution With Uncommon DLL Extension",
      "status": "test",
      "description": "Detects the execution of rundll32 with a command line that doesn't contain a common extension",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.011"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\rundll32.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "RUNDLL32.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_main_null": {
            "type": "field_match",
            "matchers": {
              "CommandLine": {
                "field": "CommandLine",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_empty": {
            "type": "field_match",
            "matchers": {
              "CommandLine": {
                "field": "CommandLine",
                "value": "",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_known_extension": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      ".cpl ",
                      ".cpl,",
                      ".cpl\"",
                      ".cpl'",
                      ".dll ",
                      ".dll,",
                      ".dll\"",
                      ".dll'",
                      ".inf ",
                      ".inf,",
                      ".inf\"",
                      ".inf'"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__endswith": {
                    "field": "CommandLine",
                    "value": [
                      ".cpl",
                      ".dll",
                      ".inf"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "filter_main_localserver": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -localserver ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_zzzzInvokeManagedCustomActionOutOfProc": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\msiexec.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  ":\\Windows\\Installer\\",
                  ".tmp",
                  "zzzzInvokeManagedCustomActionOutOfProc"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_EdgeUpdate": {
            "type": "field_match",
            "matchers": {
              "ParentCommandLine__contains_all": {
                "field": "ParentCommandLine",
                "value": [
                  ":\\Users\\",
                  "\\AppData\\Local\\Microsoft\\EdgeUpdate\\Install\\{",
                  "\\EDGEMITMP_",
                  ".tmp\\setup.exe",
                  "--install-archive=",
                  "--previous-version=",
                  "--msedgewebview --verbose-logging --do-not-launch-msedge --user-level"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218.011"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Tim Shelton, Florian Roth (Nextron Systems), Yassine Oukessou",
        "date": "2022-01-13",
        "modified": "2024-04-04",
        "references": [
          "https://twitter.com/mrd0x/status/1481630810495139841?s=12"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_rundll32_uncommon_dll_extension.yml"
      }
    },
    {
      "id": "ee37eb7c-a4e7-4cd5-8fa4-efa27f1c3f31",
      "title": "PUA - Ngrok Execution",
      "status": "test",
      "description": "Detects the use of Ngrok, a utility used for port forwarding and tunneling, often used by threat actors to make local protected services publicly available.\nInvolved domains are bin.equinox.io for download and *.ngrok.io for connections.\n",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1572"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " tcp 139",
                  " tcp 445",
                  " tcp 3389",
                  " tcp 5985",
                  " tcp 5986"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " start ",
                  "--all",
                  "--config",
                  ".yml"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection3": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "ngrok.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " tcp ",
                  " http ",
                  " authtoken "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection4": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ".exe authtoken ",
                  ".exe start --all"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1572"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-05-14",
        "modified": "2023-02-21",
        "references": [
          "https://ngrok.com/docs",
          "https://www.fireeye.com/blog/threat-research/2021/05/shining-a-light-on-darkside-ransomware-operations.html",
          "https://stackoverflow.com/questions/42442320/ssh-tunnel-to-ngrok-and-initiate-rdp",
          "https://www.virustotal.com/gui/file/58d21840d915aaf4040ceb89522396124c82f325282f805d1085527e1e2ccfa1/detection",
          "https://cybleinc.com/2021/02/15/ngrok-platform-abused-by-hackers-to-deliver-a-new-wave-of-phishing-attacks/",
          "https://twitter.com/xorJosh/status/1598646907802451969",
          "https://www.softwaretestinghelp.com/how-to-use-ngrok/"
        ],
        "falsepositives": [
          "Another tool that uses the command line switches of Ngrok",
          "Ngrok http 3978 (https://learn.microsoft.com/en-us/azure/bot-service/bot-service-debug-channel-ngrok?view=azure-bot-service-4.0)"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_ngrok.yml"
      }
    },
    {
      "id": "7f2376f9-42ee-4dfc-9360-fecff9a88fc8",
      "title": "BitLockerTogo.EXE Execution",
      "status": "test",
      "description": "Detects the execution of \"BitLockerToGo.EXE\".\nBitLocker To Go is BitLocker Drive Encryption on removable data drives. This feature includes the encryption of, USB flash drives, SD cards, External hard disk drives, Other drives that are formatted by using the NTFS, FAT16, FAT32, or exFAT file system.\nThis is a rarely used application and usage of it at all is worth investigating.\nMalware such as Lumma stealer has been seen using this process as a target for process hollowing.\n",
      "level": "low",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\BitLockerToGo.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Josh Nickels, mttaggart",
        "date": "2024-07-11",
        "modified": "",
        "references": [
          "https://tria.ge/240521-ynezpagf56/behavioral1",
          "https://any.run/report/6eea2773c1b4b5c6fb7c142933e220c96f9a4ec89055bf0cf54accdcde7df535/a407f006-ee45-420d-b576-f259094df091",
          "https://bazaar.abuse.ch/sample/8c75f8e94486f5bbf461505823f5779f328c5b37f1387c18791e0c21f3fdd576/",
          "https://bazaar.abuse.ch/sample/64e6605496919cd76554915cbed88e56fdec10dec6523918a631754664b8c8d3/"
        ],
        "falsepositives": [
          "Legitimate usage of BitLockerToGo.exe to encrypt portable devices."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_bitlockertogo_execution.yml"
      }
    },
    {
      "id": "3371f518-5fe3-4cf6-a14b-2a0ae3fd8a4f",
      "title": "Sysinternals PsService Execution",
      "status": "test",
      "description": "Detects usage of Sysinternals PsService which can be abused for service reconnaissance and tampering",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.discovery",
        "attack.persistence",
        "attack.t1543.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "psservice.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\PsService.exe",
                      "\\PsService64.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1543.003"
        ],
        "tactics": [
          "privilege_escalation",
          "discovery",
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-06-16",
        "modified": "2023-02-24",
        "references": [
          "https://learn.microsoft.com/en-us/sysinternals/downloads/psservice"
        ],
        "falsepositives": [
          "Legitimate use of PsService by an administrator"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sysinternals_psservice.yml"
      }
    },
    {
      "id": "02030f2f-6199-49ec-b258-ea71b07e03dc",
      "title": "Malicious PowerShell Commandlets - ProcessCreation",
      "status": "test",
      "description": "Detects Commandlet names from well-known PowerShell exploitation frameworks",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.discovery",
        "attack.t1482",
        "attack.t1087",
        "attack.t1087.001",
        "attack.t1087.002",
        "attack.t1069.001",
        "attack.t1069.002",
        "attack.t1069",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Add-Exfiltration",
                  "Add-Persistence",
                  "Add-RegBackdoor",
                  "Add-RemoteRegBackdoor",
                  "Add-ScrnSaveBackdoor",
                  "Check-VM",
                  "ConvertTo-Rc4ByteStream",
                  "Decrypt-Hash",
                  "Disable-ADIDNSNode",
                  "Disable-MachineAccount",
                  "Do-Exfiltration",
                  "Enable-ADIDNSNode",
                  "Enable-MachineAccount",
                  "Enabled-DuplicateToken",
                  "Exploit-Jboss",
                  "Export-ADR",
                  "Export-ADRCSV",
                  "Export-ADRExcel",
                  "Export-ADRHTML",
                  "Export-ADRJSON",
                  "Export-ADRXML",
                  "Find-Fruit",
                  "Find-GPOLocation",
                  "Find-TrustedDocuments",
                  "Get-ADIDNS",
                  "Get-ApplicationHost",
                  "Get-ChromeDump",
                  "Get-ClipboardContents",
                  "Get-FoxDump",
                  "Get-GPPPassword",
                  "Get-IndexedItem",
                  "Get-KerberosAESKey",
                  "Get-Keystrokes",
                  "Get-LSASecret",
                  "Get-MachineAccountAttribute",
                  "Get-MachineAccountCreator",
                  "Get-PassHashes",
                  "Get-RegAlwaysInstallElevated",
                  "Get-RegAutoLogon",
                  "Get-RemoteBootKey",
                  "Get-RemoteCachedCredential",
                  "Get-RemoteLocalAccountHash",
                  "Get-RemoteLSAKey",
                  "Get-RemoteMachineAccountHash",
                  "Get-RemoteNLKMKey",
                  "Get-RickAstley",
                  "Get-Screenshot",
                  "Get-SecurityPackages",
                  "Get-ServiceFilePermission",
                  "Get-ServicePermission",
                  "Get-ServiceUnquoted",
                  "Get-SiteListPassword",
                  "Get-System",
                  "Get-TimedScreenshot",
                  "Get-UnattendedInstallFile",
                  "Get-Unconstrained",
                  "Get-USBKeystrokes",
                  "Get-VaultCredential",
                  "Get-VulnAutoRun",
                  "Get-VulnSchTask",
                  "Grant-ADIDNSPermission",
                  "Gupt-Backdoor",
                  "HTTP-Login",
                  "Install-ServiceBinary",
                  "Install-SSP",
                  "Invoke-ACLScanner",
                  "Invoke-ADRecon",
                  "Invoke-ADSBackdoor",
                  "Invoke-AgentSmith",
                  "Invoke-AllChecks",
                  "Invoke-ARPScan",
                  "Invoke-AzureHound",
                  "Invoke-BackdoorLNK",
                  "Invoke-BadPotato",
                  "Invoke-BetterSafetyKatz",
                  "Invoke-BypassUAC",
                  "Invoke-Carbuncle",
                  "Invoke-Certify",
                  "Invoke-ConPtyShell",
                  "Invoke-CredentialInjection",
                  "Invoke-DAFT",
                  "Invoke-DCSync",
                  "Invoke-DinvokeKatz",
                  "Invoke-DllInjection",
                  "Invoke-DNSUpdate",
                  "Invoke-DNSExfiltrator",
                  "Invoke-DomainPasswordSpray",
                  "Invoke-DowngradeAccount",
                  "Invoke-EgressCheck",
                  "Invoke-Eyewitness",
                  "Invoke-FakeLogonScreen",
                  "Invoke-Farmer",
                  "Invoke-Get-RBCD-Threaded",
                  "Invoke-Gopher",
                  "Invoke-Grouper",
                  "Invoke-HandleKatz",
                  "Invoke-ImpersonatedProcess",
                  "Invoke-ImpersonateSystem",
                  "Invoke-InteractiveSystemPowerShell",
                  "Invoke-Internalmonologue",
                  "Invoke-Inveigh",
                  "Invoke-InveighRelay",
                  "Invoke-KrbRelay",
                  "Invoke-LdapSignCheck",
                  "Invoke-Lockless",
                  "Invoke-MalSCCM",
                  "Invoke-Mimikatz",
                  "Invoke-Mimikittenz",
                  "Invoke-MITM6",
                  "Invoke-NanoDump",
                  "Invoke-NetRipper",
                  "Invoke-Nightmare",
                  "Invoke-NinjaCopy",
                  "Invoke-OfficeScrape",
                  "Invoke-OxidResolver",
                  "Invoke-P0wnedshell",
                  "Invoke-Paranoia",
                  "Invoke-PortScan",
                  "Invoke-PoshRatHttp",
                  "Invoke-PostExfil",
                  "Invoke-PowerDump",
                  "Invoke-PowerDPAPI",
                  "Invoke-PowerShellTCP",
                  "Invoke-PowerShellWMI",
                  "Invoke-PPLDump",
                  "Invoke-PsExec",
                  "Invoke-PSInject",
                  "Invoke-PsUaCme",
                  "Invoke-ReflectivePEInjection",
                  "Invoke-ReverseDNSLookup",
                  "Invoke-Rubeus",
                  "Invoke-RunAs",
                  "Invoke-SafetyKatz",
                  "Invoke-SauronEye",
                  "Invoke-SCShell",
                  "Invoke-Seatbelt",
                  "Invoke-ServiceAbuse",
                  "Invoke-ShadowSpray",
                  "Invoke-Sharp",
                  "Invoke-Shellcode",
                  "Invoke-SMBScanner",
                  "Invoke-Snaffler",
                  "Invoke-Spoolsample",
                  "Invoke-SpraySinglePassword",
                  "Invoke-SSHCommand",
                  "Invoke-StandIn",
                  "Invoke-StickyNotesExtract",
                  "Invoke-SystemCommand",
                  "Invoke-Tasksbackdoor",
                  "Invoke-Tater",
                  "Invoke-Thunderfox",
                  "Invoke-ThunderStruck",
                  "Invoke-TokenManipulation",
                  "Invoke-Tokenvator",
                  "Invoke-TotalExec",
                  "Invoke-UrbanBishop",
                  "Invoke-UserHunter",
                  "Invoke-VoiceTroll",
                  "Invoke-Whisker",
                  "Invoke-WinEnum",
                  "Invoke-winPEAS",
                  "Invoke-WireTap",
                  "Invoke-WmiCommand",
                  "Invoke-WMIExec",
                  "Invoke-WScriptBypassUAC",
                  "Invoke-Zerologon",
                  "MailRaider",
                  "New-ADIDNSNode",
                  "New-DNSRecordArray",
                  "New-HoneyHash",
                  "New-InMemoryModule",
                  "New-MachineAccount",
                  "New-SOASerialNumberArray",
                  "Out-Minidump",
                  "Port-Scan",
                  "PowerBreach",
                  "powercat ",
                  "PowerUp",
                  "PowerView",
                  "Remove-ADIDNSNode",
                  "Remove-MachineAccount",
                  "Remove-Update",
                  "Rename-ADIDNSNode",
                  "Revoke-ADIDNSPermission",
                  "Set-ADIDNSNode",
                  "Set-MacAttribute",
                  "Set-MachineAccountAttribute",
                  "Set-Wallpaper",
                  "Show-TargetScreen",
                  "Start-CaptureServer",
                  "Start-Dnscat2",
                  "Start-WebcamRecorder",
                  "Veeam-Get-Creds",
                  "VolumeShadowCopyTools"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1482",
          "T1087",
          "T1087.001",
          "T1087.002",
          "T1069.001",
          "T1069.002",
          "T1069",
          "T1059.001"
        ],
        "tactics": [
          "execution",
          "discovery"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-01-02",
        "modified": "2025-12-10",
        "references": [
          "https://adsecurity.org/?p=2921",
          "https://github.com/S3cur3Th1sSh1t/PowerSharpPack/tree/master/PowerSharpBinaries",
          "https://github.com/BC-SECURITY/Invoke-ZeroLogon/blob/111d17c7fec486d9bb23387e2e828b09a26075e4/Invoke-ZeroLogon.ps1",
          "https://github.com/xorrior/RandomPS-Scripts/blob/848c919bfce4e2d67b626cbcf4404341cfe3d3b6/Get-DXWebcamVideo.ps1",
          "https://github.com/rvrsh3ll/Misc-Powershell-Scripts/blob/6f23bb41f9675d7e2d32bacccff75e931ae00554/OfficeMemScraper.ps1",
          "https://github.com/dafthack/DomainPasswordSpray/blob/b13d64a5834694aa73fd2aea9911a83027c465a7/DomainPasswordSpray.ps1",
          "https://unit42.paloaltonetworks.com/threat-assessment-black-basta-ransomware/",
          "https://research.nccgroup.com/2022/06/06/shining-the-light-on-black-basta/",
          "https://github.com/calebstewart/CVE-2021-1675",
          "https://github.com/BloodHoundAD/BloodHound/blob/0927441f67161cc6dc08a53c63ceb8e333f55874/Collectors/AzureHound.ps1",
          "https://bloodhound.readthedocs.io/en/latest/data-collection/azurehound.html",
          "https://github.com/HarmJ0y/DAMP",
          "https://github.com/samratashok/nishang",
          "https://github.com/DarkCoderSc/PowerRunAsSystem/",
          "https://github.com/besimorhino/powercat",
          "https://github.com/Kevin-Robertson/Powermad",
          "https://github.com/adrecon/ADRecon",
          "https://github.com/adrecon/AzureADRecon",
          "https://github.com/sadshade/veeam-creds/blob/6010eaf31ba41011b58d6af3950cffbf6f5cea32/Veeam-Get-Creds.ps1",
          "https://github.com/The-Viper-One/Invoke-PowerDPAPI/",
          "https://github.com/Arno0x/DNSExfiltrator/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_malicious_cmdlets.yml"
      }
    },
    {
      "id": "4480827a-9799-4232-b2c4-ccc6c4e9e12b",
      "title": "Suspicious CertReq Command to Download",
      "status": "experimental",
      "description": "Detects a suspicious CertReq execution downloading a file.\nThis behavior is often used by attackers to download additional payloads or configuration files.\nCertreq is a built-in Windows utility used to request and retrieve certificates from a certification authority (CA). However, it can be abused by threat actors for malicious purposes.\n",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1105"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\certreq.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "CertReq.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_flag_post": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-Post",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli_flag_config": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-config",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli_http": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "http",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1105"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Christian Burkard (Nextron Systems)",
        "date": "2021-11-24",
        "modified": "2025-10-29",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Certreq/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_certreq_download.yml"
      }
    },
    {
      "id": "84b14121-9d14-416e-800b-f3b829c5a14d",
      "title": "Suspicious CustomShellHost Execution",
      "status": "test",
      "description": "Detects the execution of CustomShellHost.exe where the child isn't located in 'C:\\Windows\\explorer.exe'. CustomShellHost is a known LOLBin that can be abused by attackers for defense evasion techniques.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1216"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\CustomShellHost.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_explorer": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\explorer.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1216"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-19",
        "modified": "2025-10-29",
        "references": [
          "https://github.com/LOLBAS-Project/LOLBAS/pull/180",
          "https://lolbas-project.github.io/lolbas/Binaries/CustomShellHost/"
        ],
        "falsepositives": [
          "False positives are unlikely, investigate matches carefully."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_customshellhost_susp_exec.yml"
      }
    },
    {
      "id": "e52cb31c-10ed-4aea-bcb7-593c9f4a315b",
      "title": "UAC Bypass via Windows Firewall Snap-In Hijack",
      "status": "test",
      "description": "Detects attempts to bypass User Account Control (UAC) by hijacking the Microsoft Management Console (MMC) Windows Firewall snap-in",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\mmc.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "ParentCommandLine__contains": {
                "field": "ParentCommandLine",
                "value": "WF.msc",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\WerFault.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1548"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Tim Rauch, Elastic (idea)",
        "date": "2022-09-27",
        "modified": "",
        "references": [
          "https://www.elastic.co/guide/en/security/current/uac-bypass-via-windows-firewall-snap-in-hijack.html#uac-bypass-via-windows-firewall-snap-in-hijack"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_uac_bypass_hijacking_firwall_snap_in.yml"
      }
    },
    {
      "id": "fabfb3a7-3ce1-4445-9c7c-3c27f1051cdd",
      "title": "Potential ReflectDebugger Content Execution Via WerFault.EXE",
      "status": "test",
      "description": "Detects execution of \"WerFault.exe\" with the \"-pr\" commandline flag that is used to run files stored in the ReflectDebugger key which could be used to store the path to the malware in order to masquerade the execution flow",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.defense-evasion",
        "attack.t1036"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\WerFault.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "WerFault.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -pr ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1036"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "X__Junior (Nextron Systems)",
        "date": "2023-06-30",
        "modified": "",
        "references": [
          "https://cocomelonc.github.io/malware/2022/11/02/malware-pers-18.html",
          "https://www.hexacorn.com/blog/2018/08/31/beyond-good-ol-run-key-part-85/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_werfault_reflect_debugger_exec.yml"
      }
    },
    {
      "id": "6ba5a05f-b095-4f0a-8654-b825f4f16334",
      "title": "Potential MSTSC Shadowing Activity",
      "status": "test",
      "description": "Detects RDP session hijacking by using MSTSC shadowing",
      "level": "high",
      "tags": [
        "attack.lateral-movement",
        "attack.t1563.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "noconsentprompt",
                  "shadow:"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1563.002"
        ],
        "tactics": [
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2020-01-24",
        "modified": "2023-02-05",
        "references": [
          "https://twitter.com/kmkz_security/status/1220694202301976576",
          "https://github.com/kmkz/Pentesting/blob/47592e5e160d3b86c2024f09ef04ceb87d204995/Post-Exploitation-Cheat-Sheet"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_mstsc_rdp_hijack_shadowing.yml"
      }
    },
    {
      "id": "95022b85-ff2a-49fa-939a-d7b8f56eeb9b",
      "title": "HackTool - RedMimicry Winnti Playbook Execution",
      "status": "test",
      "description": "Detects actions caused by the RedMimicry Winnti playbook a automated breach emulations utility",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.defense-evasion",
        "attack.t1106",
        "attack.t1059.003",
        "attack.t1218.011"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\rundll32.exe",
                  "\\cmd.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "gthread-3.6.dll",
                  "\\Windows\\Temp\\tmp.bat",
                  "sigcmm-2.4.dll"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1106",
          "T1059.003",
          "T1218.011"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Alexander Rausch",
        "date": "2020-06-24",
        "modified": "2023-03-01",
        "references": [
          "https://redmimicry.com/posts/redmimicry-winnti/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_redmimicry_winnti_playbook.yml"
      }
    },
    {
      "id": "221b251a-357a-49a9-920a-271802777cc0",
      "title": "Process Reconnaissance Via Wmic.EXE",
      "status": "test",
      "description": "Detects the execution of \"wmic\" with the \"process\" flag, which adversary might use to list processes running on the compromised host or list installed software hotfixes and patches.",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1047"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\WMIC.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "wmic.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "process",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_creation": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "call",
                  "create"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection* and not 1 of filter_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection",
          "none_of": "filter_"
        }
      },
      "mitre": {
        "techniques": [
          "T1047"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-01",
        "modified": "2023-02-14",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1047/T1047.md",
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wmic"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wmic_recon_process.yml"
      }
    },
    {
      "id": "85a8e5ba-bd03-4bfb-bbfa-a4409a8f8b98",
      "title": "Folder Compress To Potentially Suspicious Output Via Compress-Archive Cmdlet",
      "status": "test",
      "description": "Detects PowerShell scripts that make use of the \"Compress-Archive\" Cmdlet in order to compress folders and files where the output is stored in a potentially suspicious location that is used often by malware for exfiltration.\nAn adversary might compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network.\n",
      "level": "medium",
      "tags": [
        "attack.collection",
        "attack.t1074.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Compress-Archive -Path*-DestinationPath $env:TEMP",
                  "Compress-Archive -Path*-DestinationPath*\\AppData\\Local\\Temp\\",
                  "Compress-Archive -Path*-DestinationPath*:\\Windows\\Temp\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1074.001"
        ],
        "tactics": [
          "collection"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), frack113",
        "date": "2021-07-20",
        "modified": "2022-10-09",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1074.001/T1074.001.md",
          "https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-347a"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_zip_compress.yml"
      }
    },
    {
      "id": "eb1c4225-1c23-4241-8dd4-051389fde4ce",
      "title": "Suspicious DumpMinitool Execution",
      "status": "test",
      "description": "Detects suspicious ways to use the \"DumpMinitool.exe\" binary",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.credential-access",
        "attack.t1036",
        "attack.t1003.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\DumpMinitool.exe",
                      "\\DumpMinitool.x86.exe",
                      "\\DumpMinitool.arm64.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "DumpMinitool.exe",
                      "DumpMinitool.x86.exe",
                      "DumpMinitool.arm64.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "susp_flags": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": ".txt",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "cmd_has_flags": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " Full",
                  " Mini",
                  " WithHeap"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_folder": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  "\\Microsoft Visual Studio\\",
                  "\\Extensions\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_cmd_misses_flags": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "--dumpType",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and ( ( not filter_folder ) or susp_flags or ( cmd_has_flags and not filter_cmd_misses_flags ) )",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection and ( ( not filter_folder )",
            "susp_flags",
            "( cmd_has_flags and not filter_cmd_misses_flags ) )"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1036",
          "T1003.001"
        ],
        "tactics": [
          "defense_evasion",
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-04-06",
        "modified": "2023-04-12",
        "references": [
          "https://twitter.com/mrd0x/status/1511415432888131586",
          "https://twitter.com/mrd0x/status/1511489821247684615",
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/DumpMinitool/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_dumpminitool_susp_execution.yml"
      }
    },
    {
      "id": "c6c56ada-612b-42d1-9a29-adad3c5c2c1e",
      "title": "Audit Policy Tampering Via NT Resource Kit Auditpol",
      "status": "test",
      "description": "Threat actors can use an older version of the auditpol binary available inside the NT resource kit to change audit policy configuration to impair detection capability.\nThis can be carried out by selectively disabling/removing certain audit policies as well as restoring a custom policy owned by the threat actor.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "/logon:none",
                  "/system:none",
                  "/sam:none",
                  "/privilege:none",
                  "/object:none",
                  "/process:none",
                  "/policy:none"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.002"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2021-12-18",
        "modified": "2023-02-21",
        "references": [
          "https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Windows%202000%20Resource%20Kit%20Tools/AuditPol"
        ],
        "falsepositives": [
          "The old auditpol utility isn't available by default on recent versions of Windows as it was replaced by a newer version. The FP rate should be very low except for tools that use a similar flag structure"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_auditpol_nt_resource_kit_usage.yml"
      }
    },
    {
      "id": "30bf1789-379d-4fdc-900f-55cd0a90a801",
      "title": "Visual Studio Code Tunnel Service Installation",
      "status": "test",
      "description": "Detects the installation of VsCode tunnel (code-tunnel) as a service.",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1071.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "tunnel ",
                  "service",
                  "internal-run",
                  "tunnel-service.log"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1071.001"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-10-25",
        "modified": "",
        "references": [
          "https://ipfyx.fr/post/visual-studio-code-tunnel/",
          "https://badoption.eu/blog/2023/01/31/code_c2.html",
          "https://code.visualstudio.com/docs/remote/tunnels"
        ],
        "falsepositives": [
          "Legitimate installation of code-tunnel as a service"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_vscode_tunnel_service_install.yml"
      }
    },
    {
      "id": "2dd2c217-bf68-437a-b57c-fe9fd01d5de8",
      "title": "Potentially Suspicious Regsvr32 HTTP IP Pattern",
      "status": "test",
      "description": "Detects regsvr32 execution to download and install DLLs located remotely where the address is an IP address.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.010"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\regsvr32.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "REGSVR32.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_ip": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " /i:http://1",
                  " /i:http://2",
                  " /i:http://3",
                  " /i:http://4",
                  " /i:http://5",
                  " /i:http://6",
                  " /i:http://7",
                  " /i:http://8",
                  " /i:http://9",
                  " /i:https://1",
                  " /i:https://2",
                  " /i:https://3",
                  " /i:https://4",
                  " /i:https://5",
                  " /i:https://6",
                  " /i:https://7",
                  " /i:https://8",
                  " /i:https://9",
                  " -i:http://1",
                  " -i:http://2",
                  " -i:http://3",
                  " -i:http://4",
                  " -i:http://5",
                  " -i:http://6",
                  " -i:http://7",
                  " -i:http://8",
                  " -i:http://9",
                  " -i:https://1",
                  " -i:https://2",
                  " -i:https://3",
                  " -i:https://4",
                  " -i:https://5",
                  " -i:https://6",
                  " -i:https://7",
                  " -i:https://8",
                  " -i:https://9"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.010"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-01-11",
        "modified": "2023-05-24",
        "references": [
          "https://twitter.com/mrd0x/status/1461041276514623491",
          "https://twitter.com/tccontre18/status/1480950986650832903",
          "https://lolbas-project.github.io/lolbas/Binaries/Regsvr32/"
        ],
        "falsepositives": [
          "FQDNs that start with a number such as \"7-Zip\""
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_regsvr32_http_ip_pattern.yml"
      }
    },
    {
      "id": "961e0abb-1b1e-4c84-a453-aafe56ad0d34",
      "title": "Execution via stordiag.exe",
      "status": "test",
      "description": "Detects the use of stordiag.exe to execute schtasks.exe systeminfo.exe and fltmc.exe",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\stordiag.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\schtasks.exe",
                  "\\systeminfo.exe",
                  "\\fltmc.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "ParentImage__startswith": {
                "field": "ParentImage",
                "value": [
                  "c:\\windows\\system32\\",
                  "c:\\windows\\syswow64\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Austin Songer (@austinsonger)",
        "date": "2021-10-21",
        "modified": "2022-12-25",
        "references": [
          "https://strontic.github.io/xcyclopedia/library/stordiag.exe-1F08FC87C373673944F6A7E8B18CD845.html",
          "https://twitter.com/eral4m/status/1451112385041911809"
        ],
        "falsepositives": [
          "Legitimate usage of stordiag.exe."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_stordiag_susp_child_process.yml"
      }
    },
    {
      "id": "0b80ade5-6997-4b1d-99a1-71701778ea61",
      "title": "Imports Registry Key From an ADS",
      "status": "test",
      "description": "Detects the import of a alternate datastream to the registry with regedit.exe.",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.t1112",
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\regedit.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "REGEDIT.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " /i ",
                  ".reg"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__re": {
                "field": "CommandLine",
                "value": ":[^ \\\\]",
                "modifiers": [
                  "re"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -e ",
                  " -a ",
                  " -c "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not filter",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "all of selection_*"
            },
            {
              "type": "not",
              "value": "filter"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Oddvar Moe, Sander Wiebing, oscd.community",
        "date": "2020-10-12",
        "modified": "2024-03-13",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Regedit/",
          "https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_regedit_import_keys_ads.yml"
      }
    },
    {
      "id": "74403157-20f5-415d-89a7-c505779585cf",
      "title": "ConvertTo-SecureString Cmdlet Usage Via CommandLine",
      "status": "test",
      "description": "Detects usage of the \"ConvertTo-SecureString\" cmdlet via the commandline. Which is fairly uncommon and could indicate potential suspicious activity",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027",
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "ConvertTo-SecureString",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1027",
          "T1059.001"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Teymur Kheirkhabarov (idea), Vasiliy Burov (rule), oscd.community, Tim Shelton",
        "date": "2020-10-11",
        "modified": "2023-02-01",
        "references": [
          "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse?slide=65",
          "https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.security/convertto-securestring?view=powershell-7.3#examples"
        ],
        "falsepositives": [
          "Legitimate use to pass password to different powershell commands"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_cmdline_convertto_securestring.yml"
      }
    },
    {
      "id": "34ebb878-1b15-4895-b352-ca2eeb99b274",
      "title": "Suspicious Execution of Shutdown",
      "status": "test",
      "description": "Use of the commandline to shutdown or reboot windows",
      "level": "medium",
      "tags": [
        "attack.impact",
        "attack.t1529"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\shutdown.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "/r ",
                  "/s "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1529"
        ],
        "tactics": [
          "impact"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-01",
        "modified": "",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1529/T1529.md",
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/shutdown"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_shutdown_execution.yml"
      }
    },
    {
      "id": "b9aeac14-2ffd-4ad3-b967-1354a4e628c3",
      "title": "PowerShell Get-Clipboard Cmdlet Via CLI",
      "status": "test",
      "description": "Detects usage of the 'Get-Clipboard' cmdlet via CLI",
      "level": "medium",
      "tags": [
        "attack.collection",
        "attack.t1115"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "Get-Clipboard",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1115"
        ],
        "tactics": [
          "collection"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2020-05-02",
        "modified": "2022-12-25",
        "references": [
          "https://github.com/OTRF/detection-hackathon-apt29/issues/16",
          "https://github.com/OTRF/ThreatHunter-Playbook/blob/2d4257f630f4c9770f78d0c1df059f891ffc3fec/docs/evals/apt29/detections/3.B.2_C36B49B5-DF58-4A34-9FE9-56189B9DEFEA.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_get_clipboard.yml"
      }
    },
    {
      "id": "b98d0db6-511d-45de-ad02-e82a98729620",
      "title": "Remotely Hosted HTA File Executed Via Mshta.EXE",
      "status": "test",
      "description": "Detects execution of the \"mshta\" utility with an argument containing the \"http\" keyword, which could indicate that an attacker is executing a remotely hosted malicious hta file",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.execution",
        "attack.t1218.005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\mshta.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "MSHTA.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "http://",
                  "https://",
                  "ftp://"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.005"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-08",
        "modified": "2023-02-06",
        "references": [
          "https://www.trendmicro.com/en_us/research/22/e/avoslocker-ransomware-variant-abuses-driver-file-to-disable-anti-Virus-scans-log4shell.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_mshta_http.yml"
      }
    },
    {
      "id": "7d4aaec2-08ed-4430-8b96-28420e030e04",
      "title": "Uncommon Sigverif.EXE Child Process",
      "status": "test",
      "description": "Detects uncommon child processes spawning from \"sigverif.exe\", which could indicate potential abuse of the latter as a living of the land binary in order to proxy execution.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1216"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\sigverif.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_werfault": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Windows\\System32\\WerFault.exe",
                  "C:\\Windows\\SysWOW64\\WerFault.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1216"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-19",
        "modified": "2024-08-27",
        "references": [
          "https://www.hexacorn.com/blog/2018/04/27/i-shot-the-sigverif-exe-the-gui-based-lolbin/",
          "https://twitter.com/0gtweet/status/1457676633809330184"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sigverif_uncommon_child_process.yml"
      }
    },
    {
      "id": "cc9cbe82-7bc0-4ef5-bc23-bbfb83947be7",
      "title": "File Decoded From Base64/Hex Via Certutil.EXE",
      "status": "test",
      "description": "Detects the execution of certutil with either the \"decode\" or \"decodehex\" flags to decode base64 or hex encoded files. This can be abused by attackers to decode an encoded payload before execution",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\certutil.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "CertUtil.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "-decode ",
                  "-decodehex "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1027"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Jonhnathan Ribeiro, oscd.community",
        "date": "2023-02-15",
        "modified": "2025-06-04",
        "references": [
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/certutil",
          "https://unit42.paloaltonetworks.com/new-babyshark-malware-targets-u-s-national-security-think-tanks/",
          "https://news.sophos.com/en-us/2021/04/13/compromised-exchange-server-hosting-cryptojacker-targeting-other-exchange-servers/",
          "https://twitter.com/JohnLaTwC/status/835149808817991680",
          "https://learn.microsoft.com/en-us/archive/blogs/pki/basic-crl-checking-with-certutil",
          "https://lolbas-project.github.io/lolbas/Binaries/Certutil/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_certutil_decode.yml"
      }
    },
    {
      "id": "43fa5350-db63-4b8f-9a01-789a427074e1",
      "title": "Potential Obfuscated Ordinal Call Via Rundll32",
      "status": "test",
      "description": "Detects execution of \"rundll32\" with potential obfuscated ordinal calls",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027.010"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\rundll32.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "RUNDLL32.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": "rundll32",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "#+",
                  "#-",
                  "#0",
                  "#655",
                  "#656"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1027.010"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2023-05-17",
        "modified": "2025-02-23",
        "references": [
          "Internal Research",
          "https://www.youtube.com/watch?v=52tAmVLg1KM&t=2070s"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_rundll32_obfuscated_ordinal_call.yml"
      }
    },
    {
      "id": "dfd2fcb7-8bd5-4daa-b132-5adb61d6ad45",
      "title": "Windows Hotfix Updates Reconnaissance Via Wmic.EXE",
      "status": "test",
      "description": "Detects the execution of wmic with the \"qfe\" flag in order to obtain information about installed hotfix updates on the system. This is often used by pentester and attacker enumeration scripts",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1047"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "wmic.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\WMIC.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " qfe",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1047"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-06-20",
        "modified": "2023-02-14",
        "references": [
          "https://github.com/carlospolop/PEASS-ng/blob/fa0f2e17fbc1d86f1fd66338a40e665e7182501d/winPEAS/winPEASbat/winPEAS.bat",
          "https://sushant747.gitbooks.io/total-oscp-guide/content/privilege_escalation_windows.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wmic_recon_hotfix.yml"
      }
    },
    {
      "id": "e8d34729-86a4-4140-adfd-0a29c2106307",
      "title": "HackTool - CoercedPotato Execution",
      "status": "test",
      "description": "Detects the use of CoercedPotato, a tool for privilege escalation",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1055"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_loader_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\CoercedPotato.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_params": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " --exploitId ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_loader_imphash": {
            "type": "field_match",
            "matchers": {
              "Hashes__contains": {
                "field": "Hashes",
                "value": [
                  "IMPHASH=A75D7669DB6B2E107A44C4057FF7F7D6",
                  "IMPHASH=F91624350E2C678C5DCBE5E1F24E22C9",
                  "IMPHASH=14C81850A079A87E83D50CA41C709A15"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1055"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2023-10-11",
        "modified": "2024-11-23",
        "references": [
          "https://github.com/hackvens/CoercedPotato",
          "https://blog.hackvens.fr/articles/CoercedPotato.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_coercedpotato.yml"
      }
    },
    {
      "id": "f6ecd1cf-19b8-4488-97f6-00f0924991a3",
      "title": "PUA - Nmap/Zenmap Execution",
      "status": "test",
      "description": "Detects usage of namp/zenmap. Adversaries may attempt to get a listing of services running on remote hosts, including those that may be vulnerable to remote software exploitation",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.t1046"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\nmap.exe",
                      "\\zennmap.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "nmap.exe",
                      "zennmap.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1046"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-12-10",
        "modified": "2023-12-11",
        "references": [
          "https://nmap.org/",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1046/T1046.md#atomic-test-3---port-scan-nmap-for-windows"
        ],
        "falsepositives": [
          "Legitimate administrator activity"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_nmap_zenmap.yml"
      }
    },
    {
      "id": "2d32dd6f-3196-4093-b9eb-1ad8ab088ca5",
      "title": "Suspicious Response File Execution Via Odbcconf.EXE",
      "status": "test",
      "description": "Detects execution of \"odbcconf\" with the \"-f\" flag in order to load a response file with a non-\".rsp\" extension.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.008"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\odbcconf.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "odbcconf.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -f ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_rsp_ext": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": ".rsp",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_runonce_odbc": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": "C:\\Windows\\System32\\runonce.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\System32\\odbcconf.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": ".exe /E /F \"C:\\WINDOWS\\system32\\odbcconf.tmp\"",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_main_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.008"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-22",
        "modified": "2024-03-13",
        "references": [
          "https://learn.microsoft.com/en-us/sql/odbc/odbcconf-exe?view=sql-server-ver16",
          "https://lolbas-project.github.io/lolbas/Binaries/Odbcconf/",
          "https://www.trendmicro.com/en_us/research/17/h/backdoor-carrying-emails-set-sights-on-russian-speaking-businesses.html"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_odbcconf_response_file_susp.yml"
      }
    },
    {
      "id": "88d6e60c-759d-4ac1-a447-c0f1466c2d21",
      "title": "Chromium Browser Instance Executed With Custom Extension",
      "status": "test",
      "description": "Detects a Chromium based browser process with the 'load-extension' flag to start a instance with a custom extension",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.t1176.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\brave.exe",
                  "\\chrome.exe",
                  "\\msedge.exe",
                  "\\opera.exe",
                  "\\vivaldi.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "--load-extension=",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1176.001"
        ],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "Aedan Russell, frack113, X__Junior (Nextron Systems)",
        "date": "2022-06-19",
        "modified": "2023-11-28",
        "references": [
          "https://redcanary.com/blog/chromeloader/",
          "https://emkc.org/s/RJjuLa",
          "https://www.mandiant.com/resources/blog/lnk-between-browsers"
        ],
        "falsepositives": [
          "Usage of Chrome Extensions in testing tools such as BurpSuite will trigger this alert"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_browsers_chromium_load_extension.yml"
      }
    },
    {
      "id": "36480ae1-a1cb-4eaa-a0d6-29801d7e9142",
      "title": "Potential Defense Evasion Via Binary Rename",
      "status": "test",
      "description": "Detects the execution of a renamed binary often used by attackers or malware leveraging new Sysmon OriginalFileName datapoint.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "OriginalFileName": {
                "field": "OriginalFileName",
                "value": [
                  "Cmd.Exe",
                  "CONHOST.EXE",
                  "7z.exe",
                  "7za.exe",
                  "WinRAR.exe",
                  "wevtutil.exe",
                  "net.exe",
                  "net1.exe",
                  "netsh.exe",
                  "InstallUtil.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\cmd.exe",
                  "\\conhost.exe",
                  "\\7z.exe",
                  "\\7za.exe",
                  "\\WinRAR.exe",
                  "\\wevtutil.exe",
                  "\\net.exe",
                  "\\net1.exe",
                  "\\netsh.exe",
                  "\\InstallUtil.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1036.003"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Matthew Green @mgreen27, Ecco, James Pemberton @4A616D6573, oscd.community, Andreas Hunkeler (@Karneades)",
        "date": "2019-06-15",
        "modified": "2025-07-15",
        "references": [
          "https://mgreen27.github.io/posts/2019/05/12/BinaryRename.html",
          "https://mgreen27.github.io/posts/2019/05/29/BinaryRename2.html",
          "https://github.com/redcanaryco/atomic-red-team/blob/0f229c0e42bfe7ca736a14023836d65baa941ed2/atomics/T1036.003/T1036.003.md#atomic-test-1---masquerading-as-windows-lsass-process",
          "https://www.splunk.com/en_us/blog/security/inno-setup-malware-redline-stealer-campaign.html"
        ],
        "falsepositives": [
          "Custom applications use renamed binaries adding slight change to binary name. Typically this is easy to spot and add to whitelist"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_renamed_binary.yml"
      }
    },
    {
      "id": "87a476dc-0079-4583-a985-dee7a20a03de",
      "title": "Enumeration for 3rd Party Creds From CLI",
      "status": "test",
      "description": "Detects processes that query known 3rd party registry keys that holds credentials via commandline",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.t1552.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\Software\\Aerofox\\Foxmail\\V3.1",
                  "\\Software\\Aerofox\\FoxmailPreview",
                  "\\Software\\DownloadManager\\Passwords",
                  "\\Software\\FTPWare\\COREFTP\\Sites",
                  "\\Software\\IncrediMail\\Identities",
                  "\\Software\\Martin Prikryl\\WinSCP 2\\Sessions",
                  "\\Software\\Mobatek\\MobaXterm\\",
                  "\\Software\\OpenSSH\\Agent\\Keys",
                  "\\Software\\OpenVPN-GUI\\configs",
                  "\\Software\\ORL\\WinVNC3\\Password",
                  "\\Software\\Qualcomm\\Eudora\\CommandLine",
                  "\\Software\\RealVNC\\WinVNC4",
                  "\\Software\\RimArts\\B2\\Settings",
                  "\\Software\\SimonTatham\\PuTTY\\Sessions",
                  "\\Software\\SimonTatham\\PuTTY\\SshHostKeys\\",
                  "\\Software\\Sota\\FFFTP",
                  "\\Software\\TightVNC\\Server",
                  "\\Software\\WOW6432Node\\Radmin\\v3.0\\Server\\Parameters\\Radmin"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_other_rule": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "reg.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "export",
                  "save"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1552.002"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-06-20",
        "modified": "2025-05-22",
        "references": [
          "https://isc.sans.edu/diary/More+Data+Exfiltration/25698",
          "https://github.com/synacktiv/Radmin3-Password-Cracker/blob/acfc87393e4b7c06353973a14a6c7126a51f36ac/regkey.txt",
          "https://github.com/HyperSine/how-does-MobaXterm-encrypt-password",
          "https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation#inside-the-registry"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_registry_enumeration_for_credentials_cli.yml"
      }
    },
    {
      "id": "13e6fe51-d478-4c7e-b0f2-6da9b400a829",
      "title": "Suspicious File Downloaded From Direct IP Via Certutil.EXE",
      "status": "test",
      "description": "Detects the execution of certutil with certain flags that allow the utility to download files from direct IPs.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027",
        "attack.command-and-control",
        "attack.t1105"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\certutil.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "CertUtil.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_flags": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "urlcache ",
                  "verifyctl ",
                  "URL "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_http": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "://1",
                  "://2",
                  "://3",
                  "://4",
                  "://5",
                  "://6",
                  "://7",
                  "://8",
                  "://9"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_seven_zip": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "://7-",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_main_"
        }
      },
      "mitre": {
        "techniques": [
          "T1027",
          "T1105"
        ],
        "tactics": [
          "defense_evasion",
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-02-15",
        "modified": "2025-12-01",
        "references": [
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/certutil",
          "https://forensicitguy.github.io/agenttesla-vba-certutil-download/",
          "https://news.sophos.com/en-us/2021/04/13/compromised-exchange-server-hosting-cryptojacker-targeting-other-exchange-servers/",
          "https://twitter.com/egre55/status/1087685529016193025",
          "https://lolbas-project.github.io/lolbas/Binaries/Certutil/",
          "https://twitter.com/_JohnHammond/status/1708910264261980634",
          "https://www.hexacorn.com/blog/2020/08/23/certutil-one-more-gui-lolbin"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_certutil_download_direct_ip.yml"
      }
    },
    {
      "id": "2e65275c-8288-4ab4-aeb7-6274f58b6b20",
      "title": "Procdump Execution",
      "status": "test",
      "description": "Detects usage of the SysInternals Procdump utility",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036",
        "attack.t1003.001",
        "attack.credential-access"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\procdump.exe",
                  "\\procdump64.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1036",
          "T1003.001"
        ],
        "tactics": [
          "defense_evasion",
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-08-16",
        "modified": "2023-02-28",
        "references": [
          "https://learn.microsoft.com/en-us/sysinternals/downloads/procdump"
        ],
        "falsepositives": [
          "Legitimate use of procdump by a developer or administrator"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sysinternals_procdump.yml"
      }
    },
    {
      "id": "62510e69-616b-4078-b371-847da438cc03",
      "title": "Share And Session Enumeration Using Net.EXE",
      "status": "stable",
      "description": "Detects attempts to enumerate file shares, printer shares and sessions using \"net.exe\" with the \"view\" flag.",
      "level": "low",
      "tags": [
        "attack.discovery",
        "attack.t1018"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\net.exe",
                      "\\net1.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "net.exe",
                      "net1.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "view",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "\\\\\\\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not filter",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "all of selection_*"
            },
            {
              "type": "not",
              "value": "filter"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1018"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Endgame, JHasenbusch (ported for oscd.community)",
        "date": "2018-10-30",
        "modified": "2023-02-21",
        "references": [
          "https://eqllib.readthedocs.io/en/latest/analytics/b8a94d2f-dc75-4630-9d73-1edc6bd26fff.html",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1018/T1018.md"
        ],
        "falsepositives": [
          "Legitimate use of net.exe utility by legitimate user"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_net_view_share_and_sessions_enum.yml"
      }
    },
    {
      "id": "225274c4-8dd1-40db-9e09-71dff4f6fb3c",
      "title": "Potential Defense Evasion Activity Via Emoji Usage In CommandLine - 4",
      "status": "test",
      "description": "Detects the usage of emojis in the command line, this could be a sign of potential defense evasion activity.",
      "level": "high",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "🔸",
                  "🔹",
                  "🔶",
                  "🔷",
                  "🔳",
                  "🔲",
                  "▪️",
                  "▫️",
                  "◾️",
                  "◽️",
                  "◼️",
                  "◻️",
                  "🟥",
                  "🟧",
                  "🟨",
                  "🟩",
                  "🟦",
                  "🟪",
                  "⬛️",
                  "⬜️",
                  "🟫",
                  "🔈",
                  "🔇",
                  "🔉",
                  "🔊",
                  "🔔",
                  "🔕",
                  "📣",
                  "📢",
                  "👁‍🗨",
                  "💬",
                  "💭",
                  "🗯",
                  "♠️",
                  "♣️",
                  "♥️",
                  "♦️",
                  "🃏",
                  "🎴",
                  "🀄️",
                  "🕐",
                  "🕑",
                  "🕒",
                  "🕓",
                  "🕔",
                  "🕕",
                  "🕖",
                  "🕗",
                  "🕘",
                  "🕙",
                  "🕚",
                  "🕛",
                  "🕜",
                  "🕝",
                  "🕞",
                  "🕟",
                  "🕠",
                  "🕡",
                  "🕢",
                  "🕣",
                  "🕤",
                  "🕥",
                  "🕦",
                  "🕧✢",
                  "✣",
                  "✤",
                  "✥",
                  "✦",
                  "✧",
                  "★",
                  "☆",
                  "✯",
                  "✡︎",
                  "✩",
                  "✪",
                  "✫",
                  "✬",
                  "✭",
                  "✮",
                  "✶",
                  "✷",
                  "✵",
                  "✸",
                  "✹",
                  "→",
                  "⇒",
                  "⟹",
                  "⇨",
                  "⇾",
                  "➾",
                  "⇢",
                  "☛",
                  "☞",
                  "➔",
                  "➜",
                  "➙",
                  "➛",
                  "➝",
                  "➞",
                  "♠︎",
                  "♣︎",
                  "♥︎",
                  "♦︎",
                  "♤",
                  "♧",
                  "♡",
                  "♢",
                  "♚",
                  "♛",
                  "♜",
                  "♝",
                  "♞",
                  "♟",
                  "♔",
                  "♕",
                  "♖",
                  "♗",
                  "♘",
                  "♙",
                  "⚀",
                  "⚁",
                  "⚂",
                  "⚃",
                  "⚄",
                  "⚅",
                  "🂠",
                  "⚈",
                  "⚉",
                  "⚆",
                  "⚇",
                  "𓀀",
                  "𓀁",
                  "𓀂",
                  "𓀃",
                  "𓀄",
                  "𓀅",
                  "𓀆",
                  "𓀇",
                  "𓀈",
                  "𓀉",
                  "𓀊",
                  "𓀋",
                  "𓀌",
                  "𓀍",
                  "𓀎",
                  "𓀏",
                  "𓀐",
                  "𓀑",
                  "𓀒",
                  "𓀓",
                  "𓀔",
                  "𓀕",
                  "𓀖",
                  "𓀗",
                  "𓀘",
                  "𓀙",
                  "𓀚",
                  "𓀛",
                  "𓀜",
                  "𓀝🏳️",
                  "🏴",
                  "🏁",
                  "🚩",
                  "🏳️‍🌈",
                  "🏳️‍⚧️",
                  "🏴‍☠️",
                  "🇦🇫",
                  "🇦🇽",
                  "🇦🇱",
                  "🇩🇿",
                  "🇦🇸",
                  "🇦🇩",
                  "🇦🇴",
                  "🇦🇮",
                  "🇦🇶",
                  "🇦🇬",
                  "🇦🇷",
                  "🇦🇲",
                  "🇦🇼",
                  "🇦🇺",
                  "🇦🇹",
                  "🇦🇿",
                  "🇧🇸",
                  "🇧🇭",
                  "🇧🇩",
                  "🇧🇧",
                  "🇧🇾",
                  "🇧🇪",
                  "🇧🇿",
                  "🇧🇯",
                  "🇧🇲",
                  "🇧🇹",
                  "🇧🇴",
                  "🇧🇦",
                  "🇧🇼",
                  "🇧🇷",
                  "🇮🇴",
                  "🇻🇬",
                  "🇧🇳",
                  "🇧🇬",
                  "🇧🇫",
                  "🇧🇮",
                  "🇰🇭",
                  "🇨🇲",
                  "🇨🇦",
                  "🇮🇨",
                  "🇨🇻",
                  "🇧🇶",
                  "🇰🇾",
                  "🇨🇫",
                  "🇹🇩",
                  "🇨🇱",
                  "🇨🇳",
                  "🇨🇽",
                  "🇨🇨",
                  "🇨🇴",
                  "🇰🇲",
                  "🇨🇬",
                  "🇨🇩",
                  "🇨🇰",
                  "🇨🇷",
                  "🇨🇮",
                  "🇭🇷",
                  "🇨🇺",
                  "🇨🇼",
                  "🇨🇾",
                  "🇨🇿",
                  "🇩🇰",
                  "🇩🇯",
                  "🇩🇲",
                  "🇩🇴",
                  "🇪🇨",
                  "🇪🇬",
                  "🇸🇻",
                  "🇬🇶",
                  "🇪🇷",
                  "🇪🇪",
                  "🇪🇹",
                  "🇪🇺",
                  "🇫🇰",
                  "🇫🇴",
                  "🇫🇯",
                  "🇫🇮",
                  "🇫🇷",
                  "🇬🇫",
                  "🇵🇫",
                  "🇹🇫",
                  "🇬🇦",
                  "🇬🇲",
                  "🇬🇪",
                  "🇩🇪",
                  "🇬🇭",
                  "🇬🇮",
                  "🇬🇷",
                  "🇬🇱",
                  "🇬🇩",
                  "🇬🇵",
                  "🇬🇺",
                  "🇬🇹",
                  "🇬🇬",
                  "🇬🇳",
                  "🇬🇼",
                  "🇬🇾",
                  "🇭🇹",
                  "🇭🇳",
                  "🇭🇰",
                  "🇭🇺",
                  "🇮🇸",
                  "🇮🇳",
                  "🇮🇩",
                  "🇮🇷",
                  "🇮🇶",
                  "🇮🇪",
                  "🇮🇲",
                  "🇮🇱",
                  "🇮🇹",
                  "🇯🇲",
                  "🇯🇵",
                  "🎌",
                  "🇯🇪",
                  "🇯🇴",
                  "🇰🇿",
                  "🇰🇪",
                  "🇰🇮",
                  "🇽🇰",
                  "🇰🇼",
                  "🇰🇬",
                  "🇱🇦",
                  "🇱🇻",
                  "🇱🇧",
                  "🇱🇸",
                  "🇱🇷",
                  "🇱🇾",
                  "🇱🇮",
                  "🇱🇹",
                  "🇱🇺",
                  "🇲🇴",
                  "🇲🇰",
                  "🇲🇬",
                  "🇲🇼",
                  "🇲🇾",
                  "🇲🇻",
                  "🇲🇱",
                  "🇲🇹",
                  "🇲🇭",
                  "🇲🇶",
                  "🇲🇷",
                  "🇲🇺",
                  "🇾🇹",
                  "🇲🇽",
                  "🇫🇲",
                  "🇲🇩",
                  "🇲🇨",
                  "🇲🇳",
                  "🇲🇪",
                  "🇲🇸",
                  "🇲🇦",
                  "🇲🇿",
                  "🇲🇲",
                  "🇳🇦",
                  "🇳🇷",
                  "🇳🇵",
                  "🇳🇱",
                  "🇳🇨",
                  "🇳🇿",
                  "🇳🇮",
                  "🇳🇪",
                  "🇳🇬",
                  "🇳🇺",
                  "🇳🇫",
                  "🇰🇵",
                  "🇲🇵",
                  "🇳🇴",
                  "🇴🇲",
                  "🇵🇰",
                  "🇵🇼",
                  "🇵🇸",
                  "🇵🇦",
                  "🇵🇬",
                  "🇵🇾",
                  "🇵🇪",
                  "🇵🇭",
                  "🇵🇳",
                  "🇵🇱",
                  "🇵🇹",
                  "🇵🇷",
                  "🇶🇦",
                  "🇷🇪",
                  "🇷🇴",
                  "🇷🇺",
                  "🇷🇼",
                  "🇼🇸",
                  "🇸🇲",
                  "🇸🇦",
                  "🇸🇳",
                  "🇷🇸",
                  "🇸🇨",
                  "🇸🇱",
                  "🇸🇬",
                  "🇸🇽",
                  "🇸🇰",
                  "🇸🇮",
                  "🇬🇸",
                  "🇸🇧",
                  "🇸🇴",
                  "🇿🇦",
                  "🇰🇷",
                  "🇸🇸",
                  "🇪🇸",
                  "🇱🇰",
                  "🇧🇱",
                  "🇸🇭",
                  "🇰🇳",
                  "🇱🇨",
                  "🇵🇲",
                  "🇻🇨",
                  "🇸🇩",
                  "🇸🇷",
                  "🇸🇿",
                  "🇸🇪",
                  "🇨🇭",
                  "🇸🇾",
                  "🇹🇼",
                  "🇹🇯",
                  "🇹🇿",
                  "🇹🇭",
                  "🇹🇱",
                  "🇹🇬",
                  "🇹🇰",
                  "🇹🇴",
                  "🇹🇹",
                  "🇹🇳",
                  "🇹🇷",
                  "🇹🇲",
                  "🇹🇨",
                  "🇹🇻",
                  "🇻🇮",
                  "🇺🇬",
                  "🇺🇦",
                  "🇦🇪",
                  "🇬🇧",
                  "🏴󠁧󠁢󠁥󠁮󠁧󠁿",
                  "🏴󠁧󠁢󠁳󠁣󠁴󠁿",
                  "🏴󠁧󠁢󠁷󠁬󠁳󠁿",
                  "🇺🇳",
                  "🇺🇸",
                  "🇺🇾",
                  "🇺🇿",
                  "🇻🇺",
                  "🇻🇦",
                  "🇻🇪",
                  "🇻🇳",
                  "🇼🇫",
                  "🇪🇭",
                  "🇾🇪",
                  "🇿🇲",
                  "🇿🇼🫠",
                  "🫢",
                  "🫣",
                  "🫡",
                  "🫥",
                  "🫤",
                  "🥹",
                  "🫱",
                  "🫱🏻",
                  "🫱🏼",
                  "🫱🏽",
                  "🫱🏾",
                  "🫱🏿",
                  "🫲",
                  "🫲🏻",
                  "🫲🏼",
                  "🫲🏽",
                  "🫲🏾",
                  "🫲🏿",
                  "🫳",
                  "🫳🏻",
                  "🫳🏼",
                  "🫳🏽",
                  "🫳🏾",
                  "🫳🏿",
                  "🫴",
                  "🫴🏻",
                  "🫴🏼",
                  "🫴🏽",
                  "🫴🏾",
                  "🫴🏿",
                  "🫰",
                  "🫰🏻",
                  "🫰🏼",
                  "🫰🏽",
                  "🫰🏾",
                  "🫰🏿",
                  "🫵",
                  "🫵🏻",
                  "🫵🏼",
                  "🫵🏽",
                  "🫵🏾",
                  "🫵🏿",
                  "🫶",
                  "🫶🏻",
                  "🫶🏼",
                  "🫶🏽",
                  "🫶🏾",
                  "🫶🏿",
                  "🤝🏻",
                  "🤝🏼",
                  "🤝🏽",
                  "🤝🏾",
                  "🤝🏿",
                  "🫱🏻‍🫲🏼",
                  "🫱🏻‍🫲🏽",
                  "🫱🏻‍🫲🏾",
                  "🫱🏻‍🫲🏿",
                  "🫱🏼‍🫲🏻",
                  "🫱🏼‍🫲🏽",
                  "🫱🏼‍🫲🏾",
                  "🫱🏼‍🫲🏿",
                  "🫱🏽‍🫲🏻",
                  "🫱🏽‍🫲🏼",
                  "🫱🏽‍🫲🏾",
                  "🫱🏽‍🫲🏿",
                  "🫱🏾‍🫲🏻",
                  "🫱🏾‍🫲🏼",
                  "🫱🏾‍🫲🏽",
                  "🫱🏾‍🫲🏿",
                  "🫱🏿‍🫲🏻",
                  "🫱🏿‍🫲🏼",
                  "🫱🏿‍🫲🏽",
                  "🫱🏿‍🫲🏾",
                  "🫦",
                  "🫅",
                  "🫅🏻",
                  "🫅🏼",
                  "🫅🏽",
                  "🫅🏾",
                  "🫅🏿",
                  "🫃",
                  "🫃🏻",
                  "🫃🏼",
                  "🫃🏽",
                  "🫃🏾",
                  "🫃🏿",
                  "🫄",
                  "🫄🏻",
                  "🫄🏼",
                  "🫄🏽",
                  "🫄🏾",
                  "🫄🏿",
                  "🧌",
                  "🪸",
                  "🪷",
                  "🪹",
                  "🪺",
                  "🫘",
                  "🫗",
                  "🫙",
                  "🛝",
                  "🛞",
                  "🛟",
                  "🪬",
                  "🪩",
                  "🪫",
                  "🩼",
                  "🩻",
                  "🫧",
                  "🪪",
                  "🟰",
                  "😮‍💨",
                  "😵‍💫",
                  "😶‍🌫️",
                  "❤️‍🔥",
                  "❤️‍🩹",
                  "🧔‍♀️",
                  "🧔🏻‍♀️",
                  "🧔🏼‍♀️",
                  "🧔🏽‍♀️",
                  "🧔🏾‍♀️",
                  "🧔🏿‍♀️",
                  "🧔‍♂️",
                  "🧔🏻‍♂️",
                  "🧔🏼‍♂️",
                  "🧔🏽‍♂️",
                  "🧔🏾‍♂️",
                  "🧔🏿‍♂️",
                  "💑🏻",
                  "💑🏼",
                  "💑🏽",
                  "💑🏾",
                  "💑🏿",
                  "💏🏻",
                  "💏🏼",
                  "💏🏽",
                  "💏🏾",
                  "💏🏿",
                  "👨🏻‍❤️‍👨🏻",
                  "👨🏻‍❤️‍👨🏼",
                  "👨🏻‍❤️‍👨🏽",
                  "👨🏻‍❤️‍👨🏾",
                  "👨🏻‍❤️‍👨🏿",
                  "👨🏼‍❤️‍👨🏻",
                  "👨🏼‍❤️‍👨🏼",
                  "👨🏼‍❤️‍👨🏽",
                  "👨🏼‍❤️‍👨🏾",
                  "👨🏼‍❤️‍👨🏿",
                  "👨🏽‍❤️‍👨🏻",
                  "👨🏽‍❤️‍👨🏼",
                  "👨🏽‍❤️‍👨🏽",
                  "👨🏽‍❤️‍👨🏾",
                  "👨🏽‍❤️‍👨🏿",
                  "👨🏾‍❤️‍👨🏻",
                  "👨🏾‍❤️‍👨🏼",
                  "👨🏾‍❤️‍👨🏽",
                  "👨🏾‍❤️‍👨🏾",
                  "👨🏾‍❤️‍👨🏿",
                  "👨🏿‍❤️‍👨🏻",
                  "👨🏿‍❤️‍👨🏼",
                  "👨🏿‍❤️‍👨🏽",
                  "👨🏿‍❤️‍👨🏾",
                  "👨🏿‍❤️‍👨🏿",
                  "👩🏻‍❤️‍👨🏻",
                  "👩🏻‍❤️‍👨🏼",
                  "👩🏻‍❤️‍👨🏽",
                  "👩🏻‍❤️‍👨🏾",
                  "👩🏻‍❤️‍👨🏿",
                  "👩🏻‍❤️‍👩🏻",
                  "👩🏻‍❤️‍👩🏼",
                  "👩🏻‍❤️‍👩🏽",
                  "👩🏻‍❤️‍👩🏾",
                  "👩🏻‍❤️‍👩🏿",
                  "👩🏼‍❤️‍👨🏻",
                  "👩🏼‍❤️‍👨🏼",
                  "👩🏼‍❤️‍👨🏽",
                  "👩🏼‍❤️‍👨🏾",
                  "👩🏼‍❤️‍👨🏿",
                  "👩🏼‍❤️‍👩🏻",
                  "👩🏼‍❤️‍👩🏼",
                  "👩🏼‍❤️‍👩🏽",
                  "👩🏼‍❤️‍👩🏾",
                  "👩🏼‍❤️‍👩🏿",
                  "👩🏽‍❤️‍👨🏻",
                  "👩🏽‍❤️‍👨🏼",
                  "👩🏽‍❤️‍👨🏽",
                  "👩🏽‍❤️‍👨🏾",
                  "👩🏽‍❤️‍👨🏿",
                  "👩🏽‍❤️‍👩🏻",
                  "👩🏽‍❤️‍👩🏼",
                  "👩🏽‍❤️‍👩🏽",
                  "👩🏽‍❤️‍👩🏾",
                  "👩🏽‍❤️‍👩🏿",
                  "👩🏾‍❤️‍👨🏻",
                  "👩🏾‍❤️‍👨🏼",
                  "👩🏾‍❤️‍👨🏽",
                  "👩🏾‍❤️‍👨🏾",
                  "👩🏾‍❤️‍👨🏿",
                  "👩🏾‍❤️‍👩🏻",
                  "👩🏾‍❤️‍👩🏼",
                  "👩🏾‍❤️‍👩🏽",
                  "👩🏾‍❤️‍👩🏾",
                  "👩🏾‍❤️‍👩🏿",
                  "👩🏿‍❤️‍👨🏻",
                  "👩🏿‍❤️‍👨🏼",
                  "👩🏿‍❤️‍👨🏽",
                  "👩🏿‍❤️‍👨🏾",
                  "👩🏿‍❤️‍👨🏿",
                  "👩🏿‍❤️‍👩🏻",
                  "👩🏿‍❤️‍👩🏼",
                  "👩🏿‍❤️‍👩🏽",
                  "👩🏿‍❤️‍👩🏾",
                  "👩🏿‍❤️‍👩🏿",
                  "🧑🏻‍❤️‍🧑🏼",
                  "🧑🏻‍❤️‍🧑🏽",
                  "🧑🏻‍❤️‍🧑🏾",
                  "🧑🏻‍❤️‍🧑🏿",
                  "🧑🏼‍❤️‍🧑🏻",
                  "🧑🏼‍❤️‍🧑🏽",
                  "🧑🏼‍❤️‍🧑🏾",
                  "🧑🏼‍❤️‍🧑🏿",
                  "🧑🏽‍❤️‍🧑🏻",
                  "🧑🏽‍❤️‍🧑🏼",
                  "🧑🏽‍❤️‍🧑🏾",
                  "🧑🏽‍❤️‍🧑🏿",
                  "🧑🏾‍❤️‍🧑🏻",
                  "🧑🏾‍❤️‍🧑🏼",
                  "🧑🏾‍❤️‍🧑🏽",
                  "🧑🏾‍❤️‍🧑🏿",
                  "🧑🏿‍❤️‍🧑🏻",
                  "🧑🏿‍❤️‍🧑🏼",
                  "🧑🏿‍❤️‍🧑🏽",
                  "🧑🏿‍❤️‍🧑🏾",
                  "👨🏻‍❤️‍💋‍👨🏻",
                  "👨🏻‍❤️‍💋‍👨🏼",
                  "👨🏻‍❤️‍💋‍👨🏽",
                  "👨🏻‍❤️‍💋‍👨🏾",
                  "👨🏻‍❤️‍💋‍👨🏿",
                  "👨🏼‍❤️‍💋‍👨🏻",
                  "👨🏼‍❤️‍💋‍👨🏼",
                  "👨🏼‍❤️‍💋‍👨🏽",
                  "👨🏼‍❤️‍💋‍👨🏾",
                  "👨🏼‍❤️‍💋‍👨🏿",
                  "👨🏽‍❤️‍💋‍👨🏻",
                  "👨🏽‍❤️‍💋‍👨🏼",
                  "👨🏽‍❤️‍💋‍👨🏽",
                  "👨🏽‍❤️‍💋‍👨🏾",
                  "👨🏽‍❤️‍💋‍👨🏿",
                  "👨🏾‍❤️‍💋‍👨🏻",
                  "👨🏾‍❤️‍💋‍👨🏼",
                  "👨🏾‍❤️‍💋‍👨🏽",
                  "👨🏾‍❤️‍💋‍👨🏾",
                  "👨🏾‍❤️‍💋‍👨🏿",
                  "👨🏿‍❤️‍💋‍👨🏻",
                  "👨🏿‍❤️‍💋‍👨🏼",
                  "👨🏿‍❤️‍💋‍👨🏽",
                  "👨🏿‍❤️‍💋‍👨🏾",
                  "👨🏿‍❤️‍💋‍👨🏿",
                  "👩🏻‍❤️‍💋‍👨🏻",
                  "👩🏻‍❤️‍💋‍👨🏼",
                  "👩🏻‍❤️‍💋‍👨🏽",
                  "👩🏻‍❤️‍💋‍👨🏾",
                  "👩🏻‍❤️‍💋‍👨🏿",
                  "👩🏻‍❤️‍💋‍👩🏻",
                  "👩🏻‍❤️‍💋‍👩🏼",
                  "👩🏻‍❤️‍💋‍👩🏽",
                  "👩🏻‍❤️‍💋‍👩🏾",
                  "👩🏻‍❤️‍💋‍👩🏿",
                  "👩🏼‍❤️‍💋‍👨🏻",
                  "👩🏼‍❤️‍💋‍👨🏼",
                  "👩🏼‍❤️‍💋‍👨🏽",
                  "👩🏼‍❤️‍💋‍👨🏾",
                  "👩🏼‍❤️‍💋‍👨🏿",
                  "👩🏼‍❤️‍💋‍👩🏻",
                  "👩🏼‍❤️‍💋‍👩🏼",
                  "👩🏼‍❤️‍💋‍👩🏽",
                  "👩🏼‍❤️‍💋‍👩🏾",
                  "👩🏼‍❤️‍💋‍👩🏿",
                  "👩🏽‍❤️‍💋‍👨🏻",
                  "👩🏽‍❤️‍💋‍👨🏼",
                  "👩🏽‍❤️‍💋‍👨🏽",
                  "👩🏽‍❤️‍💋‍👨🏾",
                  "👩🏽‍❤️‍💋‍👨🏿",
                  "👩🏽‍❤️‍💋‍👩🏻",
                  "👩🏽‍❤️‍💋‍👩🏼",
                  "👩🏽‍❤️‍💋‍👩🏽",
                  "👩🏽‍❤️‍💋‍👩🏾",
                  "👩🏽‍❤️‍💋‍👩🏿",
                  "👩🏾‍❤️‍💋‍👨🏻",
                  "👩🏾‍❤️‍💋‍👨🏼",
                  "👩🏾‍❤️‍💋‍👨🏽",
                  "👩🏾‍❤️‍💋‍👨🏾",
                  "👩🏾‍❤️‍💋‍👨🏿",
                  "👩🏾‍❤️‍💋‍👩🏻",
                  "👩🏾‍❤️‍💋‍👩🏼",
                  "👩🏾‍❤️‍💋‍👩🏽",
                  "👩🏾‍❤️‍💋‍👩🏾",
                  "👩🏾‍❤️‍💋‍👩🏿",
                  "👩🏿‍❤️‍💋‍👨🏻",
                  "👩🏿‍❤️‍💋‍👨🏼",
                  "👩🏿‍❤️‍💋‍👨🏽",
                  "👩🏿‍❤️‍💋‍👨🏾",
                  "👩🏿‍❤️‍💋‍👨🏿",
                  "👩🏿‍❤️‍💋‍👩🏻",
                  "👩🏿‍❤️‍💋‍👩🏼",
                  "👩🏿‍❤️‍💋‍👩🏽",
                  "👩🏿‍❤️‍💋‍👩🏾",
                  "👩🏿‍❤️‍💋‍👩🏿",
                  "🧑🏻‍❤️‍💋‍🧑🏼",
                  "🧑🏻‍❤️‍💋‍🧑🏽",
                  "🧑🏻‍❤️‍💋‍🧑🏾",
                  "🧑🏻‍❤️‍💋‍🧑🏿",
                  "🧑🏼‍❤️‍💋‍🧑🏻",
                  "🧑🏼‍❤️‍💋‍🧑🏽",
                  "🧑🏼‍❤️‍💋‍🧑🏾",
                  "🧑🏼‍❤️‍💋‍🧑🏿",
                  "🧑🏽‍❤️‍💋‍🧑🏻",
                  "🧑🏽‍❤️‍💋‍🧑🏼",
                  "🧑🏽‍❤️‍💋‍🧑🏾",
                  "🧑🏽‍❤️‍💋‍🧑🏿",
                  "🧑🏾‍❤️‍💋‍🧑🏻",
                  "🧑🏾‍❤️‍💋‍🧑🏼",
                  "🧑🏾‍❤️‍💋‍🧑🏽",
                  "🧑🏾‍❤️‍💋‍🧑🏿",
                  "🧑🏿‍❤️‍💋‍🧑🏻",
                  "🧑🏿‍❤️‍💋‍🧑🏼",
                  "🧑🏿‍❤️‍💋‍🧑🏽",
                  "🧑🏿‍❤️‍💋‍🧑🏾"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "@Kostastsale, TheDFIRReport",
        "date": "2022-12-05",
        "modified": "",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_emoji_usage_in_cli_4.yml"
      }
    },
    {
      "id": "b5b29e4e-31fa-4fdf-b058-296e7a1aa0c2",
      "title": "Suspicious FileFix Execution Pattern",
      "status": "experimental",
      "description": "Detects suspicious FileFix execution patterns where users are tricked into running malicious commands through browser file upload dialog manipulation.\nThis attack typically begins when users visit malicious websites impersonating legitimate services or news platforms,\nwhich may display fake CAPTCHA challenges or direct instructions to open file explorer and paste clipboard content.\nThe clipboard content usually contains commands that download and execute malware, such as information stealing tools.\n",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1204.004"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_exec_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\brave.exe",
                  "\\chrome.exe",
                  "\\firefox.exe",
                  "\\msedge.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "#",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli_lolbin": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "%comspec%",
                  "bitsadmin",
                  "certutil",
                  "cmd",
                  "cscript",
                  "curl",
                  "finger",
                  "mshta",
                  "powershell",
                  "pwsh",
                  "regsvr32",
                  "rundll32",
                  "schtasks",
                  "wget",
                  "wscript"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_captcha": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "account",
                  "anti-bot",
                  "botcheck",
                  "captcha",
                  "challenge",
                  "confirmation",
                  "fraud",
                  "human",
                  "identification",
                  "identificator",
                  "identity",
                  "robot",
                  "validation",
                  "verification",
                  "verify"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_exec_parent and 1 of selection_cli_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_exec_parent"
            },
            {
              "type": "ref",
              "value": "1 of selection_cli_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1204.004"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "0xFustang, Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-11-24",
        "modified": "",
        "references": [
          "https://mrd0x.com/filefix-clickfix-alternative/",
          "https://expel.com/blog/cache-smuggling-when-a-picture-isnt-a-thousand-words/",
          "https://blog.checkpoint.com/research/filefix-the-new-social-engineering-attack-building-on-clickfix-tested-in-the-wild/"
        ],
        "falsepositives": [
          "Legitimate use of PowerShell or other utilities launched from browser extensions or automation tools"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_filefix_execution_pattern.yml"
      }
    },
    {
      "id": "502b42de-4306-40b4-9596-6f590c81f073",
      "title": "Local Accounts Discovery",
      "status": "test",
      "description": "Local accounts, System Owner/User discovery using operating systems utilities",
      "level": "low",
      "tags": [
        "attack.discovery",
        "attack.t1033",
        "attack.t1087.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_other_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\whoami.exe",
                      "\\quser.exe",
                      "\\qwinsta.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "whoami.exe",
                      "quser.exe",
                      "qwinsta.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_other_wmi": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\wmic.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "useraccount",
                  "get"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_other_cmdkey": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\cmdkey.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " /l",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cmd": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\cmd.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " /c",
                  "dir ",
                  "\\Users\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_net": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\net.exe",
                  "\\net1.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "user",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_cmd": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " rmdir ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_net": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "/domain",
                  "/add",
                  "/delete",
                  "/active",
                  "/expires",
                  "/passwordreq",
                  "/scriptpath",
                  "/times",
                  "/workstations"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "(selection_cmd and not filter_cmd) or (selection_net and not filter_net) or 1 of selection_other_*",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "(selection_cmd and not filter_cmd)",
            "(selection_net and not filter_net)",
            "1 of selection_other_*"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1033",
          "T1087.001"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Timur Zinniatullin, Daniil Yugoslavskiy, oscd.community",
        "date": "2019-10-21",
        "modified": "2025-10-20",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1033/T1033.md"
        ],
        "falsepositives": [
          "Legitimate administrator or user enumerates local users for legitimate reason"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_local_system_owner_account_discovery.yml"
      }
    },
    {
      "id": "8a582fe2-0882-4b89-a82a-da6b2dc32937",
      "title": "Suspicious WmiPrvSE Child Process",
      "status": "test",
      "description": "Detects suspicious and uncommon child processes of WmiPrvSE",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.defense-evasion",
        "attack.t1047",
        "attack.t1204.002",
        "attack.t1218.010"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\wbem\\WmiPrvSE.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_children_1": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\certutil.exe",
                  "\\cscript.exe",
                  "\\mshta.exe",
                  "\\msiexec.exe",
                  "\\regsvr32.exe",
                  "\\rundll32.exe",
                  "\\verclsid.exe",
                  "\\wscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_children_2": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\cmd.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "cscript",
                  "mshta",
                  "powershell",
                  "pwsh",
                  "regsvr32",
                  "rundll32",
                  "wscript"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_werfault": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\WerFault.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_wmiprvse": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\WmiPrvSE.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_msiexec": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\msiexec.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "/i ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection_parent and 1 of selection_children_* and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_parent"
            },
            {
              "type": "ref",
              "value": "1 of selection_children_*"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1047",
          "T1204.002",
          "T1218.010"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Vadim Khrykov (ThreatIntel), Cyb3rEng, Florian Roth (Nextron Systems)",
        "date": "2021-08-23",
        "modified": "2023-11-10",
        "references": [
          "https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware/",
          "https://github.com/vadim-hunter/Detection-Ideas-Rules/blob/02bcbfc2bfb8b4da601bb30de0344ae453aa1afe/Threat%20Intelligence/The%20DFIR%20Report/20210329_Sodinokibi_(aka_REvil)_Ransomware.yaml",
          "https://blog.osarmor.com/319/onenote-attachment-delivers-asyncrat-malware/",
          "https://twitter.com/ForensicITGuy/status/1334734244120309760"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wmiprvse_susp_child_processes.yml"
      }
    },
    {
      "id": "27aec9c9-dbb0-4939-8422-1742242471d0",
      "title": "Invoke-Obfuscation VAR+ Launcher",
      "status": "test",
      "description": "Detects Obfuscated use of Environment Variables to execute PowerShell",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027",
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__re": {
                "field": "CommandLine",
                "value": "cmd.{0,5}(?:/c|/r)(?:\\s|)\\\"set\\s[a-zA-Z]{3,6}.*(?:\\{\\d\\}){1,}\\\\\\\"\\s+?\\-f(?:.*\\)){1,}.*\\\"",
                "modifiers": [
                  "re"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1027",
          "T1059.001"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Jonathan Cheong, oscd.community",
        "date": "2020-10-15",
        "modified": "2024-04-15",
        "references": [
          "https://github.com/SigmaHQ/sigma/issues/1009"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_invoke_obfuscation_var.yml"
      }
    },
    {
      "id": "79f4ede3-402e-41c8-bc3e-ebbf5f162581",
      "title": "HackTool - Empire PowerShell Launch Parameters",
      "status": "test",
      "description": "Detects suspicious powershell command line parameters used in Empire",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -NoP -sta -NonI -W Hidden -Enc ",
                  " -noP -sta -w 1 -enc ",
                  " -NoP -NonI -W Hidden -enc ",
                  " -noP -sta -w 1 -enc",
                  " -enc  SQB",
                  " -nop -exec bypass -EncodedCommand "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2019-04-20",
        "modified": "2023-02-21",
        "references": [
          "https://github.com/EmpireProject/Empire/blob/c2ba61ca8d2031dad0cfc1d5770ba723e8b710db/lib/common/helpers.py#L165",
          "https://github.com/EmpireProject/Empire/blob/e37fb2eef8ff8f5a0a689f1589f424906fe13055/lib/modules/powershell/persistence/powerbreach/deaduser.py#L191",
          "https://github.com/EmpireProject/Empire/blob/e37fb2eef8ff8f5a0a689f1589f424906fe13055/lib/modules/powershell/persistence/powerbreach/resolver.py#L178",
          "https://github.com/EmpireProject/Empire/blob/e37fb2eef8ff8f5a0a689f1589f424906fe13055/data/module_source/privesc/Invoke-EventVwrBypass.ps1#L64"
        ],
        "falsepositives": [
          "Other tools that incidentally use the same command line parameters"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_empire_powershell_launch.yml"
      }
    },
    {
      "id": "cc368ed0-2411-45dc-a222-510ace303cb2",
      "title": "Potentially Suspicious Execution Of Regasm/Regsvcs From Uncommon Location",
      "status": "test",
      "description": "Detects potentially suspicious execution of the Regasm/Regsvcs utilities from a potentially suspicious location",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.009"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\Regsvcs.exe",
                      "\\Regasm.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "RegSvcs.exe",
                      "RegAsm.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_dir": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\AppData\\Local\\Temp\\",
                  "\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\",
                  "\\PerfLogs\\",
                  "\\Users\\Public\\",
                  "\\Windows\\Temp\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.009"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-25",
        "modified": "2023-02-13",
        "references": [
          "https://www.fortiguard.com/threat-signal-report/4718?s=09",
          "https://lolbas-project.github.io/lolbas/Binaries/Regasm/",
          "https://lolbas-project.github.io/lolbas/Binaries/Regsvcs/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_regasm_regsvcs_uncommon_location_execution.yml"
      }
    },
    {
      "id": "312d0384-401c-4b8b-abdf-685ffba9a332",
      "title": "Email Exifiltration Via Powershell",
      "status": "test",
      "description": "Detects email exfiltration via powershell cmdlets",
      "level": "high",
      "tags": [
        "attack.exfiltration"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\powershell.exe",
                  "\\pwsh.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "Add-PSSnapin",
                  "Get-Recipient",
                  "-ExpandProperty",
                  "EmailAddresses",
                  "SmtpAddress",
                  "-hidetableheaders"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "exfiltration"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems),  Azure-Sentinel (idea)",
        "date": "2022-09-09",
        "modified": "",
        "references": [
          "https://www.microsoft.com/security/blog/2022/09/07/profiling-dev-0270-phosphorus-ransomware-operations/",
          "https://github.com/Azure/Azure-Sentinel/blob/7e6aa438e254d468feec061618a7877aa528ee9f/Hunting%20Queries/Microsoft%20365%20Defender/Ransomware/DEV-0270/Email%20data%20exfiltration%20via%20PowerShell.yaml"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_email_exfil.yml"
      }
    },
    {
      "id": "4b13db67-0c45-40f1-aba8-66a1a7198a1e",
      "title": "Suspicious Extrac32 Alternate Data Stream Execution",
      "status": "test",
      "description": "Extract data from cab file and hide it in an alternate data stream",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1564.004"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "extrac32.exe",
                  ".cab"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__re": {
                "field": "CommandLine",
                "value": ":[^\\\\]",
                "modifiers": [
                  "re"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1564.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-11-26",
        "modified": "2022-12-30",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Extrac32/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_extrac32_ads.yml"
      }
    },
    {
      "id": "a96970af-f126-420d-90e1-d37bf25e50e1",
      "title": "Use Short Name Path in Image",
      "status": "test",
      "description": "Detect use of the Windows 8.3 short name. Which could be used as a method to avoid Image detection",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1564.004"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  "~1\\",
                  "~2\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_system_process": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": [
                  "C:\\Windows\\System32\\Dism.exe",
                  "C:\\Windows\\System32\\cleanmgr.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_installers": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__contains_all": {
                    "field": "Image",
                    "value": [
                      "\\AppData\\",
                      "\\Temp\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "~1\\unzip.exe",
                      "~1\\7zG.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "filter_optional_webex": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\WebEx\\WebexHost.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_thor": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\thor\\thor64.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_installshield": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Product": {
                    "field": "Product",
                    "value": "InstallShield (R)",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "InstallShield (R) Setup Engine",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Company": {
                    "field": "Company",
                    "value": "InstallShield Software Corporation",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1564.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113, Nasreddine Bencherchali",
        "date": "2022-08-07",
        "modified": "2025-10-20",
        "references": [
          "https://www.acunetix.com/blog/articles/windows-short-8-3-filenames-web-security-problem/",
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/cc959352(v=technet.10)",
          "https://twitter.com/frack113/status/1555830623633375232"
        ],
        "falsepositives": [
          "Applications could use this notation occasionally which might generate some false positives. In that case Investigate the parent and child process."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_ntfs_short_name_path_use_image.yml"
      }
    },
    {
      "id": "1327381e-6ab0-4f38-b583-4c1b8346a56b",
      "title": "Potential Command Line Path Traversal Evasion Attempt",
      "status": "test",
      "description": "Detects potential evasion or obfuscation attempts using bogus path traversal via the commandline",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_1": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": "\\Windows\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\..\\Windows\\",
                  "\\..\\System32\\",
                  "\\..\\..\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": ".exe\\..\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_google_drive": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "\\Google\\Drive\\googledrivesync.exe\\..\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_citrix": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "\\Citrix\\Virtual Smart Card\\Citrix.Authentication.VirtualSmartcard.Launcher.exe\\..\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "1 of selection_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "1 of selection_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1036"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Christian Burkard (Nextron Systems)",
        "date": "2021-10-26",
        "modified": "2023-03-29",
        "references": [
          "https://twitter.com/hexacorn/status/1448037865435320323",
          "https://twitter.com/Gal_B1t/status/1062971006078345217"
        ],
        "falsepositives": [
          "Google Drive",
          "Citrix"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_commandline_path_traversal_evasion.yml"
      }
    },
    {
      "id": "a1473adb-5338-4a20-b4c3-126763e2d3d3",
      "title": "Suspicious Advpack Call Via Rundll32.EXE",
      "status": "test",
      "description": "Detects execution of \"rundll32\" calling \"advpack.dll\" with potential obfuscated ordinal calls in order to leverage the \"RegisterOCX\" function",
      "level": "high",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\rundll32.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "RUNDLL32.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": "rundll32",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_dll": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "advpack",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli_ordinal": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "#+",
                      "12"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": "#-",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-17",
        "modified": "",
        "references": [
          "https://twitter.com/Hexacorn/status/1224848930795552769",
          "http://www.hexacorn.com/blog/2020/02/05/stay-positive-lolbins-not/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_rundll32_advpack_obfuscated_ordinal_call.yml"
      }
    },
    {
      "id": "03552375-cc2c-4883-bbe4-7958d5a980be",
      "title": "HackTool - SILENTTRINITY Stager Execution",
      "status": "test",
      "description": "Detects SILENTTRINITY stager use via PE metadata",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1071"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Description__contains": {
                "field": "Description",
                "value": "st2stager",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1071"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Aleksey Potapov, oscd.community",
        "date": "2019-10-22",
        "modified": "2023-02-13",
        "references": [
          "https://github.com/byt3bl33d3r/SILENTTRINITY"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_silenttrinity_stager.yml"
      }
    },
    {
      "id": "41f407b5-3096-44ea-a74f-96d04fbc41be",
      "title": "Remote Access Tool - AnyDesk Execution With Known Revoked Signing Certificate",
      "status": "test",
      "description": "Detects the execution of an AnyDesk binary with a version prior to 8.0.8.\nPrior to version 8.0.8, the Anydesk application used a signing certificate that got compromised by threat actors.\nUse this rule to detect instances of older versions of Anydesk using the compromised certificate\nThis is recommended in order to avoid attackers leveraging the certificate and signing their binaries to bypass detections.\n",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.initial-access"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\AnyDesk.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "AnyDesk",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Product": {
                    "field": "Product",
                    "value": "AnyDesk",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Company": {
                    "field": "Company",
                    "value": "AnyDesk Software GmbH",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_version": {
            "type": "field_match",
            "matchers": {
              "FileVersion__startswith": {
                "field": "FileVersion",
                "value": [
                  "7.0.",
                  "7.1.",
                  "8.0.1",
                  "8.0.2",
                  "8.0.3",
                  "8.0.4",
                  "8.0.5",
                  "8.0.6",
                  "8.0.7"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_uninstall": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " --remove",
                  " --uninstall"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_main_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution",
          "initial_access"
        ]
      },
      "meta": {
        "author": "Sai Prashanth Pulisetti, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2024-02-08",
        "modified": "",
        "references": [
          "https://www.bleepingcomputer.com/news/security/anydesk-says-hackers-breached-its-production-servers-reset-passwords/",
          "https://anydesk.com/en/changelog/windows"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_remote_access_tools_anydesk_revoked_cert.yml"
      }
    },
    {
      "id": "5f6a601c-2ecb-498b-9c33-660362323afa",
      "title": "Root Certificate Installed From Susp Locations",
      "status": "test",
      "description": "Adversaries may install a root certificate on a compromised system to avoid warnings when connecting to adversary controlled web servers.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1553.004"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "Import-Certificate",
                  " -FilePath ",
                  "Cert:\\LocalMachine\\Root"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\AppData\\Local\\Temp\\",
                  ":\\Windows\\TEMP\\",
                  "\\Desktop\\",
                  "\\Downloads\\",
                  "\\Perflogs\\",
                  ":\\Users\\Public\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1553.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-09-09",
        "modified": "2023-01-16",
        "references": [
          "https://www.microsoft.com/security/blog/2022/09/07/profiling-dev-0270-phosphorus-ransomware-operations/",
          "https://learn.microsoft.com/en-us/powershell/module/pki/import-certificate?view=windowsserver2022-ps"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_import_cert_susp_locations.yml"
      }
    },
    {
      "id": "82880171-b475-4201-b811-e9c826cd5eaa",
      "title": "Exports Critical Registry Keys To a File",
      "status": "test",
      "description": "Detects the export of a crital Registry key to a file.",
      "level": "high",
      "tags": [
        "attack.exfiltration",
        "attack.discovery",
        "attack.t1012"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\regedit.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "REGEDIT.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -E ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "hklm",
                  "hkey_local_machine"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_3": {
            "type": "field_match",
            "matchers": {
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": [
                  "\\system",
                  "\\sam",
                  "\\security"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1012"
        ],
        "tactics": [
          "exfiltration",
          "discovery"
        ]
      },
      "meta": {
        "author": "Oddvar Moe, Sander Wiebing, oscd.community",
        "date": "2020-10-12",
        "modified": "2024-03-13",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Regedit/",
          "https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f"
        ],
        "falsepositives": [
          "Dumping hives for legitimate purpouse i.e. backup or forensic investigation"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_regedit_export_critical_keys.yml"
      }
    },
    {
      "id": "5bb68627-3198-40ca-b458-49f973db8752",
      "title": "Rundll32 Execution Without Parameters",
      "status": "test",
      "description": "Detects rundll32 execution without parameters as observed when running Metasploit windows/smb/psexec exploit module",
      "level": "high",
      "tags": [
        "attack.lateral-movement",
        "attack.t1021.002",
        "attack.t1570",
        "attack.execution",
        "attack.t1569.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine": {
                "field": "CommandLine",
                "value": [
                  "rundll32.exe",
                  "rundll32"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1021.002",
          "T1570",
          "T1569.002"
        ],
        "tactics": [
          "lateral_movement",
          "execution"
        ]
      },
      "meta": {
        "author": "Bartlomiej Czyz, Relativity",
        "date": "2021-01-31",
        "modified": "2023-02-28",
        "references": [
          "https://bczyz1.github.io/2021/01/30/psexec.html"
        ],
        "falsepositives": [
          "False positives may occur if a user called rundll32 from CLI with no options"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_rundll32_without_parameters.yml"
      }
    },
    {
      "id": "85de1f22-d189-44e4-8239-dc276b45379b",
      "title": "Curl Web Request With Potential Custom User-Agent",
      "status": "test",
      "description": "Detects execution of \"curl.exe\" with a potential custom \"User-Agent\". Attackers can leverage this to download or exfiltrate data via \"curl\" to a domain that only accept specific \"User-Agent\" strings",
      "level": "medium",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\curl.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "curl.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_header_flag_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__re": {
                "field": "CommandLine",
                "value": "\\s-H\\s",
                "modifiers": [
                  "re"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_header_flag_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "--header",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_user_agent": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "User-Agent:",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_img and 1 of selection_header_* and selection_user_agent",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_img"
            },
            {
              "type": "ref",
              "value": "1 of selection_header_*"
            },
            {
              "type": "ref",
              "value": "selection_user_agent"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-07-27",
        "modified": "2025-12-11",
        "references": [
          "https://labs.withsecure.com/publications/fin7-target-veeam-servers",
          "https://github.com/WithSecureLabs/iocs/blob/344203de742bb7e68bd56618f66d34be95a9f9fc/FIN7VEEAM/iocs.csv"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_curl_custom_user_agent.yml"
      }
    },
    {
      "id": "b18c9d4c-fac9-4708-bd06-dd5bfacf200f",
      "title": "HackTool - F-Secure C3 Load by Rundll32",
      "status": "test",
      "description": "F-Secure C3 produces DLLs with a default exported StartNodeRelay function.",
      "level": "critical",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.011"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "rundll32.exe",
                  ".dll",
                  "StartNodeRelay"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.011"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Alfie Champion (ajpc500)",
        "date": "2021-06-02",
        "modified": "2023-03-05",
        "references": [
          "https://github.com/FSecureLABS/C3/blob/11a081fd3be2aaf2a879f6b6e9a96ecdd24966ef/Src/NodeRelayDll/NodeRelayDll.cpp#L12"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_c3_rundll32_pattern.yml"
      }
    },
    {
      "id": "e1e0b7d7-e10b-4ee4-ac49-a4bda05d320d",
      "title": "File Encryption/Decryption Via Gpg4win From Suspicious Locations",
      "status": "test",
      "description": "Detects usage of Gpg4win to encrypt/decrypt files located in potentially suspicious locations.",
      "level": "high",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_metadata": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\gpg.exe",
                      "\\gpg2.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Product": {
                    "field": "Product",
                    "value": "GNU Privacy Guard (GnuPG)",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "GnuPG’s OpenPGP tool",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-passphrase",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_paths": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ":\\PerfLogs\\",
                  ":\\Temp\\",
                  ":\\Users\\Public\\",
                  ":\\Windows\\Temp\\",
                  "\\AppData\\Local\\Temp\\",
                  "\\AppData\\Roaming\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), X__Junior (Nextron Systems)",
        "date": "2022-11-30",
        "modified": "2023-08-09",
        "references": [
          "https://blogs.vmware.com/security/2022/11/batloader-the-evasive-downloader-malware.html",
          "https://news.sophos.com/en-us/2022/01/19/zloader-installs-remote-access-backdoors-and-delivers-cobalt-strike/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_gpg4win_susp_location.yml"
      }
    },
    {
      "id": "28c8f68b-098d-45af-8d43-8089f3e35403",
      "title": "Potential Register_App.Vbs LOLScript Abuse",
      "status": "test",
      "description": "Detects potential abuse of the \"register_app.vbs\" script that is part of the Windows SDK. The script offers the capability to register new VSS/VDS Provider as a COM+ application. Attackers can use this to install malicious DLLs for persistence and execution.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\cscript.exe",
                      "\\wscript.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "cscript.exe",
                      "wscript.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": ".vbs -register ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Austin Songer @austinsonger",
        "date": "2021-11-05",
        "modified": "2022-07-07",
        "references": [
          "https://twitter.com/sblmsrsn/status/1456613494783160325?s=20",
          "https://github.com/microsoft/Windows-classic-samples/blob/7cbd99ac1d2b4a0beffbaba29ea63d024ceff700/Samples/Win7Samples/winbase/vss/vsssampleprovider/register_app.vbs"
        ],
        "falsepositives": [
          "Other VB scripts that leverage the same starting command line flags"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolscript_register_app.yml"
      }
    },
    {
      "id": "12827a56-61a4-476a-a9cb-f3068f191073",
      "title": "HackTool - KrbRelayUp Execution",
      "status": "test",
      "description": "Detects KrbRelayUp used to perform a universal no-fix local privilege escalation in Windows domain environments where LDAP signing is not enforced",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.credential-access",
        "attack.t1558.003",
        "attack.lateral-movement",
        "attack.t1550.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\KrbRelayUp.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "KrbRelayUp.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " relay ",
                  " -Domain ",
                  " -ComputerName "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " krbscm ",
                  " -sc "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_3": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " spawn ",
                  " -d ",
                  " -cn ",
                  " -cp "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1558.003",
          "T1550.003"
        ],
        "tactics": [
          "defense_evasion",
          "credential_access",
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-04-26",
        "modified": "2023-02-04",
        "references": [
          "https://github.com/Dec0ne/KrbRelayUp"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_krbrelayup.yml"
      }
    },
    {
      "id": "24e3e58a-646b-4b50-adef-02ef935b9fc8",
      "title": "Hacktool Execution - Imphash",
      "status": "test",
      "description": "Detects the execution of different Windows based hacktools via their import hash (imphash) even if the files have been renamed",
      "level": "critical",
      "tags": [
        "attack.credential-access",
        "attack.resource-development",
        "attack.t1588.002",
        "attack.t1003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Hashes__contains": {
                "field": "Hashes",
                "value": [
                  "IMPHASH=BCCA3C247B619DCD13C8CDFF5F123932",
                  "IMPHASH=3A19059BD7688CB88E70005F18EFC439",
                  "IMPHASH=bf6223a49e45d99094406777eb6004ba",
                  "IMPHASH=23867A89C2B8FC733BE6CF5EF902F2D1",
                  "IMPHASH=A37FF327F8D48E8A4D2F757E1B6E70BC",
                  "IMPHASH=F9A28C458284584A93B14216308D31BD",
                  "IMPHASH=6118619783FC175BC7EBECFF0769B46E",
                  "IMPHASH=959A83047E80AB68B368FDB3F4C6E4EA",
                  "IMPHASH=563233BFA169ACC7892451F71AD5850A",
                  "IMPHASH=87575CB7A0E0700EB37F2E3668671A08",
                  "IMPHASH=13F08707F759AF6003837A150A371BA1",
                  "IMPHASH=1781F06048A7E58B323F0B9259BE798B",
                  "IMPHASH=233F85F2D4BC9D6521A6CAAE11A1E7F5",
                  "IMPHASH=24AF2584CBF4D60BBE5C6D1B31B3BE6D",
                  "IMPHASH=632969DDF6DBF4E0F53424B75E4B91F2",
                  "IMPHASH=713C29B396B907ED71A72482759ED757",
                  "IMPHASH=749A7BB1F0B4C4455949C0B2BF7F9E9F",
                  "IMPHASH=8628B2608957A6B0C6330AC3DE28CE2E",
                  "IMPHASH=8B114550386E31895DFAB371E741123D",
                  "IMPHASH=94CB940A1A6B65BED4D5A8F849CE9793",
                  "IMPHASH=9D68781980370E00E0BD939EE5E6C141",
                  "IMPHASH=B18A1401FF8F444056D29450FBC0A6CE",
                  "IMPHASH=CB567F9498452721D77A451374955F5F",
                  "IMPHASH=730073214094CD328547BF1F72289752",
                  "IMPHASH=17B461A082950FC6332228572138B80C",
                  "IMPHASH=DC25EE78E2EF4D36FAA0BADF1E7461C9",
                  "IMPHASH=819B19D53CA6736448F9325A85736792",
                  "IMPHASH=829DA329CE140D873B4A8BDE2CBFAA7E",
                  "IMPHASH=C547F2E66061A8DFFB6F5A3FF63C0A74",
                  "IMPHASH=0588081AB0E63BA785938467E1B10CCA",
                  "IMPHASH=0D9EC08BAC6C07D9987DFD0F1506587C",
                  "IMPHASH=BC129092B71C89B4D4C8CDF8EA590B29",
                  "IMPHASH=4DA924CF622D039D58BCE71CDF05D242",
                  "IMPHASH=E7A3A5C377E2D29324093377D7DB1C66",
                  "IMPHASH=9A9DBEC5C62F0380B4FA5FD31DEFFEDF",
                  "IMPHASH=AF8A3976AD71E5D5FDFB67DDB8DADFCE",
                  "IMPHASH=0C477898BBF137BBD6F2A54E3B805FF4",
                  "IMPHASH=0CA9F02B537BCEA20D4EA5EB1A9FE338",
                  "IMPHASH=3AB3655E5A14D4EEFC547F4781BF7F9E",
                  "IMPHASH=E6F9D5152DA699934B30DAAB206471F6",
                  "IMPHASH=3AD59991CCF1D67339B319B15A41B35D",
                  "IMPHASH=FFDD59E0318B85A3E480874D9796D872",
                  "IMPHASH=0CF479628D7CC1EA25EC7998A92F5051",
                  "IMPHASH=07A2D4DCBD6CB2C6A45E6B101F0B6D51",
                  "IMPHASH=D6D0F80386E1380D05CB78E871BC72B1",
                  "IMPHASH=38D9E015591BBFD4929E0D0F47FA0055",
                  "IMPHASH=0E2216679CA6E1094D63322E3412D650",
                  "IMPHASH=ADA161BF41B8E5E9132858CB54CAB5FB",
                  "IMPHASH=2A1BC4913CD5ECB0434DF07CB675B798",
                  "IMPHASH=11083E75553BAAE21DC89CE8F9A195E4",
                  "IMPHASH=A23D29C9E566F2FA8FFBB79267F5DF80",
                  "IMPHASH=4A07F944A83E8A7C2525EFA35DD30E2F",
                  "IMPHASH=767637C23BB42CD5D7397CF58B0BE688",
                  "IMPHASH=14C4E4C72BA075E9069EE67F39188AD8",
                  "IMPHASH=3C782813D4AFCE07BBFC5A9772ACDBDC",
                  "IMPHASH=7D010C6BB6A3726F327F7E239166D127",
                  "IMPHASH=89159BA4DD04E4CE5559F132A9964EB3",
                  "IMPHASH=6F33F4A5FC42B8CEC7314947BD13F30F",
                  "IMPHASH=5834ED4291BDEB928270428EBBAF7604",
                  "IMPHASH=5A8A8A43F25485E7EE1B201EDCBC7A38",
                  "IMPHASH=DC7D30B90B2D8ABF664FBED2B1B59894",
                  "IMPHASH=41923EA1F824FE63EA5BEB84DB7A3E74",
                  "IMPHASH=3DE09703C8E79ED2CA3F01074719906B",
                  "IMPHASH=A53A02B997935FD8EEDCB5F7ABAB9B9F",
                  "IMPHASH=E96A73C7BF33A464C510EDE582318BF2",
                  "IMPHASH=32089B8851BBF8BC2D014E9F37288C83",
                  "IMPHASH=09D278F9DE118EF09163C6140255C690",
                  "IMPHASH=03866661686829d806989e2fc5a72606",
                  "IMPHASH=e57401fbdadcd4571ff385ab82bd5d6d",
                  "IMPHASH=84B763C45C0E4A3E7CA5548C710DB4EE",
                  "IMPHASH=19584675D94829987952432E018D5056",
                  "IMPHASH=330768A4F172E10ACB6287B87289D83B",
                  "IMPHASH=885C99CCFBE77D1CBFCB9C4E7C1A3313",
                  "IMPHASH=22A22BC9E4E0D2F189F1EA01748816AC",
                  "IMPHASH=7FA30E6BB7E8E8A69155636E50BF1B28",
                  "IMPHASH=96DF3A3731912449521F6F8D183279B1",
                  "IMPHASH=7E6CF3FF4576581271AC8A313B2AAB46",
                  "IMPHASH=51791678F351C03A0EB4E2A7B05C6E17",
                  "IMPHASH=25CE42B079282632708FC846129E98A5",
                  "IMPHASH=021BCCA20BA3381B11BDDE26B4E62F20",
                  "IMPHASH=59223B5F52D8799D38E0754855CBDF42",
                  "IMPHASH=81E75D8F1D276C156653D3D8813E4A43",
                  "IMPHASH=17244E8B6B8227E57FE709CCAD421420",
                  "IMPHASH=5B76DA3ACDEDC8A5CDF23A798B5936B4",
                  "IMPHASH=CB2B65BB77D995CC1C0E5DF1C860133C",
                  "IMPHASH=40445337761D80CF465136FAFB1F63E6",
                  "IMPHASH=8A790F401B29FA87BC1E56F7272B3AA6",
                  "IMPHASH=B50199E952C875241B9CE06C971CE3C1"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1588.002",
          "T1003"
        ],
        "tactics": [
          "credential_access",
          "resource_development"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-03-04",
        "modified": "2024-11-23",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Legitimate use of one of these tools"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_execution_via_imphashes.yml"
      }
    },
    {
      "id": "a4e3d776-f12e-42c2-8510-9e6ed1f43ec3",
      "title": "Unusual Child Process of dns.exe",
      "status": "test",
      "description": "Detects an unexpected process spawning from dns.exe which may indicate activity related to remote code execution or other forms of exploitation as seen in CVE-2020-1350 (SigRed)",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.initial-access",
        "attack.t1133"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\dns.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\conhost.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1133"
        ],
        "tactics": [
          "persistence",
          "initial_access"
        ]
      },
      "meta": {
        "author": "Tim Rauch, Elastic (idea)",
        "date": "2022-09-27",
        "modified": "2023-02-05",
        "references": [
          "https://www.elastic.co/guide/en/security/current/unusual-child-process-of-dns-exe.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_dns_susp_child_process.yml"
      }
    },
    {
      "id": "e290b10b-1023-4452-a4a9-eb31a9013b3a",
      "title": "LOLBAS Data Exfiltration by DataSvcUtil.exe",
      "status": "test",
      "description": "Detects when a user performs data exfiltration by using DataSvcUtil.exe",
      "level": "medium",
      "tags": [
        "attack.exfiltration",
        "attack.t1567"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "/in:",
                  "/out:",
                  "/uri:"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\DataSvcUtil.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "DataSvcUtil.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1567"
        ],
        "tactics": [
          "exfiltration"
        ]
      },
      "meta": {
        "author": "Ialle Teixeira @teixeira0xfffff, Austin Songer @austinsonger",
        "date": "2021-09-30",
        "modified": "2022-05-16",
        "references": [
          "https://gist.github.com/teixeira0xfffff/837e5bfed0d1b0a29a7cb1e5dbdd9ca6",
          "https://learn.microsoft.com/en-us/previous-versions/dotnet/framework/data/wcf/wcf-data-service-client-utility-datasvcutil-exe",
          "https://learn.microsoft.com/en-us/previous-versions/dotnet/framework/data/wcf/generating-the-data-service-client-library-wcf-data-services",
          "https://learn.microsoft.com/en-us/previous-versions/dotnet/framework/data/wcf/how-to-add-a-data-service-reference-wcf-data-services",
          "https://lolbas-project.github.io/lolbas/Binaries/DataSvcUtil/"
        ],
        "falsepositives": [
          "DataSvcUtil.exe being used may be performed by a system administrator.",
          "Verify whether the user identity, user agent, and/or hostname should be making changes in your environment.",
          "DataSvcUtil.exe being executed from unfamiliar users should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_data_exfiltration_by_using_datasvcutil.yml"
      }
    },
    {
      "id": "180c7c5c-d64b-4a63-86e9-68910451bc8b",
      "title": "Potential File Download Via MS-AppInstaller Protocol Handler",
      "status": "test",
      "description": "Detects usage of the \"ms-appinstaller\" protocol handler via command line to potentially download arbitrary files via AppInstaller.EXE\nThe downloaded files are temporarly stored in \":\\Users\\%username%\\AppData\\Local\\Packages\\Microsoft.DesktopAppInstaller_8wekyb3d8bbwe\\AC\\INetCache\\<RANDOM-8-CHAR-DIRECTORY>\"\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.execution",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "ms-appinstaller://?source=",
                  "http"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), Swachchhanda Shrawan Poudel",
        "date": "2023-11-09",
        "modified": "",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/AppInstaller/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_ms_appinstaller_download.yml"
      }
    },
    {
      "id": "c633622e-cab9-4eaa-bb13-66a1d68b3e47",
      "title": "New Virtual Smart Card Created Via TpmVscMgr.EXE",
      "status": "test",
      "description": "Detects execution of \"Tpmvscmgr.exe\" to create a new virtual smart card.",
      "level": "medium",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\tpmvscmgr.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "OriginalFileName": {
                "field": "OriginalFileName",
                "value": "TpmVscMgr.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "create",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-06-15",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/windows/security/identity-protection/virtual-smart-cards/virtual-smart-card-tpmvscmgr"
        ],
        "falsepositives": [
          "Legitimate usage by an administrator"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_tpmvscmgr_add_virtual_smartcard.yml"
      }
    },
    {
      "id": "21dd6d38-2b18-4453-9404-a0fe4a0cc288",
      "title": "Curl Download And Execute Combination",
      "status": "test",
      "description": "Adversaries can use curl to download payloads remotely and execute them. Curl is included by default in Windows 10 build 17063 and later.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218",
        "attack.command-and-control",
        "attack.t1105"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -c ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "curl ",
                  "http",
                  "-o",
                  "&"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218",
          "T1105"
        ],
        "tactics": [
          "defense_evasion",
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Sreeman, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2020-01-13",
        "modified": "2024-03-05",
        "references": [
          "https://medium.com/@reegun/curl-exe-is-the-new-rundll32-exe-lolbin-3f79c5f35983"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_cmd_curl_download_exec_combo.yml"
      }
    },
    {
      "id": "7864a175-3654-4824-9f0d-f0da18ab27c0",
      "title": "Password Set to Never Expire via WMI",
      "status": "experimental",
      "description": "Detects the use of wmic.exe to modify user account settings and explicitly disable password expiration.\n",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.execution",
        "attack.persistence",
        "attack.t1047",
        "attack.t1098"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\wmic.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "wmic.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "useraccount",
                  " set ",
                  "passwordexpires",
                  "false"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1047",
          "T1098"
        ],
        "tactics": [
          "privilege_escalation",
          "execution",
          "persistence"
        ]
      },
      "meta": {
        "author": "Daniel Koifman (KoifSec)",
        "date": "2025-07-30",
        "modified": "",
        "references": [
          "https://www.huntress.com/blog/the-unwanted-guest"
        ],
        "falsepositives": [
          "Legitimate administrative activity"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wmi_password_never_expire.yml"
      }
    },
    {
      "id": "b53317a0-8acf-4fd1-8de8-a5401e776b96",
      "title": "Application Removed Via Wmic.EXE",
      "status": "test",
      "description": "Detects the removal or uninstallation of an application via \"Wmic.EXE\".",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1047"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\WMIC.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "wmic.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "call",
                  "uninstall"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1047"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-28",
        "modified": "2024-07-02",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1047/T1047.md#atomic-test-10---application-uninstall-using-wmic"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wmic_uninstall_application.yml"
      }
    },
    {
      "id": "b243b280-65fe-48df-ba07-6ddea7646427",
      "title": "Discovery of a System Time",
      "status": "test",
      "description": "Identifies use of various commands to query a systems time. This technique may be used before executing a scheduled task or to discover the time zone of a target system.",
      "level": "low",
      "tags": [
        "attack.discovery",
        "attack.t1124"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_time": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\net.exe",
                  "\\net1.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "time",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_w32tm": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\w32tm.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "tz",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1124"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "E.M. Anhaus (originally from Atomic Blue Detections, Endgame), oscd.community",
        "date": "2019-10-24",
        "modified": "2022-06-28",
        "references": [
          "https://eqllib.readthedocs.io/en/latest/analytics/fcdb99c2-ac3c-4bde-b664-4b336329bed2.html",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1124/T1124.md"
        ],
        "falsepositives": [
          "Legitimate use of the system utilities to discover system time for legitimate reason"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_remote_time_discovery.yml"
      }
    },
    {
      "id": "a16980c2-0c56-4de0-9a79-17971979efdd",
      "title": "Cmd.EXE Missing Space Characters Execution Anomaly",
      "status": "test",
      "description": "Detects Windows command lines that miss a space before or after the /c flag when running a command using the cmd.exe.\nThis could be a sign of obfuscation of a fat finger problem (typo by the developer).\n",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "cmd.exe/c",
                  "\\cmd/c",
                  "\"cmd/c",
                  "cmd.exe/k",
                  "\\cmd/k",
                  "\"cmd/k",
                  "cmd.exe/r",
                  "\\cmd/r",
                  "\"cmd/r"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "/cwhoami",
                  "/cpowershell",
                  "/cschtasks",
                  "/cbitsadmin",
                  "/ccertutil",
                  "/kwhoami",
                  "/kpowershell",
                  "/kschtasks",
                  "/kbitsadmin",
                  "/kcertutil"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection3": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "cmd.exe /c",
                  "cmd /c",
                  "cmd.exe /k",
                  "cmd /k",
                  "cmd.exe /r",
                  "cmd /r"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_generic": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "cmd.exe /c ",
                  "cmd /c ",
                  "cmd.exe /k ",
                  "cmd /k ",
                  "cmd.exe /r ",
                  "cmd /r "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_fp": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": "AppData\\Local\\Programs\\Microsoft VS Code\\resources\\app\\node_modules",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__endswith": {
                    "field": "CommandLine",
                    "value": "cmd.exe/c .",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine": {
                    "field": "CommandLine",
                    "value": "cmd.exe /c",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "condition": "1 of selection* and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "1 of selection*"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-08-23",
        "modified": "2023-03-06",
        "references": [
          "https://twitter.com/cyb3rops/status/1562072617552678912",
          "https://ss64.com/nt/cmd.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_cmd_no_space_execution.yml"
      }
    },
    {
      "id": "1ca6bd18-0ba0-44ca-851c-92ed89a61085",
      "title": "UAC Bypass Using Consent and Comctl32 - Process",
      "status": "test",
      "description": "Detects the pattern of UAC Bypass using consent.exe and comctl32.dll (UACMe 22)",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\consent.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\werfault.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "IntegrityLevel": {
                "field": "IntegrityLevel",
                "value": [
                  "High",
                  "System",
                  "S-1-16-16384",
                  "S-1-16-12288"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Christian Burkard (Nextron Systems)",
        "date": "2021-08-23",
        "modified": "2024-12-01",
        "references": [
          "https://github.com/hfiref0x/UACME"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_uac_bypass_consent_comctl32.yml"
      }
    },
    {
      "id": "67f113fa-e23d-4271-befa-30113b3e08b1",
      "title": "Suspicious JavaScript Execution Via Mshta.EXE",
      "status": "test",
      "description": "Detects execution of javascript code using \"mshta.exe\".",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\mshta.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "MSHTA.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "javascript",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.005"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "E.M. Anhaus (originally from Atomic Blue Detections, Endgame), oscd.community",
        "date": "2019-10-24",
        "modified": "2023-02-07",
        "references": [
          "https://eqllib.readthedocs.io/en/latest/analytics/6bc283c4-21f2-4aed-a05c-a9a3ffa95dd4.html",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1218.005/T1218.005.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_mshta_javascript.yml"
      }
    },
    {
      "id": "af491bca-e752-4b44-9c86-df5680533dbc",
      "title": "Finger.EXE Execution",
      "status": "test",
      "description": "Detects execution of the \"finger.exe\" utility.\nFinger.EXE or \"TCPIP Finger Command\" is an old utility that is still present on modern Windows installation. It Displays information about users on a specified remote computer (typically a UNIX computer) that is running the finger service or daemon.\nDue to the old nature of this utility and the rareness of machines having the finger service. Any execution of \"finger.exe\" can be considered \"suspicious\" and worth investigating.\n",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1105"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "finger.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\finger.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1105"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), omkar72, oscd.community",
        "date": "2021-02-24",
        "modified": "2024-06-27",
        "references": [
          "https://twitter.com/bigmacjpg/status/1349727699863011328?s=12",
          "https://app.any.run/tasks/40115012-a919-4208-bfed-41e82cb3dadf/",
          "http://hyp3rlinx.altervista.org/advisories/Windows_TCPIP_Finger_Command_C2_Channel_and_Bypassing_Security_Software.txt"
        ],
        "falsepositives": [
          "Admin activity (unclear what they do nowadays with finger.exe)"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_finger_execution.yml"
      }
    },
    {
      "id": "434c08ba-8406-4d15-8b24-782cb071a691",
      "title": "PowerShell Execution With Potential Decryption Capabilities",
      "status": "test",
      "description": "Detects PowerShell commands that decrypt an \".LNK\" \"file to drop the next stage of the malware.",
      "level": "high",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\powershell.exe",
                  "\\pwsh.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "OriginalFileName": {
                "field": "OriginalFileName",
                "value": [
                  "PowerShell.EXE",
                  "pwsh.dll"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_dir": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Get-ChildItem ",
                  "dir ",
                  "gci ",
                  "ls "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_gc": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Get-Content ",
                  "gc ",
                  "cat ",
                  "type ",
                  "ReadAllBytes"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_specific": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      " ^| ",
                      "\\*.lnk",
                      "-Recurse",
                      "-Skip "
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      " -ExpandProperty ",
                      "\\*.lnk",
                      "WriteAllBytes",
                      " .length "
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "X__Junior (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-06-30",
        "modified": "2023-12-05",
        "references": [
          "https://research.checkpoint.com/2023/chinese-threat-actors-targeting-europe-in-smugx-campaign/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_decrypt_pattern.yml"
      }
    },
    {
      "id": "1ec65a5f-9473-4f12-97da-622044d6df21",
      "title": "Powershell Defender Disable Scan Feature",
      "status": "test",
      "description": "Detects requests to disable Microsoft Defender features using PowerShell commands",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_cli_cmdlet": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Add-MpPreference ",
                  "Set-MpPreference "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_option": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "DisableArchiveScanning ",
                  "DisableRealtimeMonitoring ",
                  "DisableIOAVProtection ",
                  "DisableBehaviorMonitoring ",
                  "DisableBlockAtFirstSeen ",
                  "DisableCatchupFullScan ",
                  "DisableCatchupQuickScan "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_value": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "$true",
                  " 1 "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_encoded_modifier": {
            "type": "field_match",
            "matchers": {
              "CommandLine__base64offset_contains": {
                "field": "CommandLine",
                "value": [
                  "disablearchivescanning ",
                  "DisableArchiveScanning ",
                  "disablebehaviormonitoring ",
                  "DisableBehaviorMonitoring ",
                  "disableblockatfirstseen ",
                  "DisableBlockAtFirstSeen ",
                  "disablecatchupfullscan ",
                  "DisableCatchupFullScan ",
                  "disablecatchupquickscan ",
                  "DisableCatchupQuickScan ",
                  "disableioavprotection ",
                  "DisableIOAVProtection ",
                  "disablerealtimemonitoring ",
                  "DisableRealtimeMonitoring "
                ],
                "modifiers": [
                  "base64offset",
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_encoded_direct": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "RABpAHMAYQBiAGwAZQBSAGUAYQBsAHQAaQBtAGUATQBvAG4AaQB0AG8AcgBpAG4AZwAgA",
                  "QAaQBzAGEAYgBsAGUAUgBlAGEAbAB0AGkAbQBlAE0AbwBuAGkAdABvAHIAaQBuAGcAIA",
                  "EAGkAcwBhAGIAbABlAFIAZQBhAGwAdABpAG0AZQBNAG8AbgBpAHQAbwByAGkAbgBnACAA",
                  "RABpAHMAYQBiAGwAZQBJAE8AQQBWAFAAcgBvAHQAZQBjAHQAaQBvAG4AIA",
                  "QAaQBzAGEAYgBsAGUASQBPAEEAVgBQAHIAbwB0AGUAYwB0AGkAbwBuACAA",
                  "EAGkAcwBhAGIAbABlAEkATwBBAFYAUAByAG8AdABlAGMAdABpAG8AbgAgA",
                  "RABpAHMAYQBiAGwAZQBCAGUAaABhAHYAaQBvAHIATQBvAG4AaQB0AG8AcgBpAG4AZwAgA",
                  "QAaQBzAGEAYgBsAGUAQgBlAGgAYQB2AGkAbwByAE0AbwBuAGkAdABvAHIAaQBuAGcAIA",
                  "EAGkAcwBhAGIAbABlAEIAZQBoAGEAdgBpAG8AcgBNAG8AbgBpAHQAbwByAGkAbgBnACAA",
                  "RABpAHMAYQBiAGwAZQBCAGwAbwBjAGsAQQB0AEYAaQByAHMAdABTAGUAZQBuACAA",
                  "QAaQBzAGEAYgBsAGUAQgBsAG8AYwBrAEEAdABGAGkAcgBzAHQAUwBlAGUAbgAgA",
                  "EAGkAcwBhAGIAbABlAEIAbABvAGMAawBBAHQARgBpAHIAcwB0AFMAZQBlAG4AIA",
                  "ZABpAHMAYQBiAGwAZQByAGUAYQBsAHQAaQBtAGUAbQBvAG4AaQB0AG8AcgBpAG4AZwAgA",
                  "QAaQBzAGEAYgBsAGUAcgBlAGEAbAB0AGkAbQBlAG0AbwBuAGkAdABvAHIAaQBuAGcAIA",
                  "kAGkAcwBhAGIAbABlAHIAZQBhAGwAdABpAG0AZQBtAG8AbgBpAHQAbwByAGkAbgBnACAA",
                  "ZABpAHMAYQBiAGwAZQBpAG8AYQB2AHAAcgBvAHQAZQBjAHQAaQBvAG4AIA",
                  "QAaQBzAGEAYgBsAGUAaQBvAGEAdgBwAHIAbwB0AGUAYwB0AGkAbwBuACAA",
                  "kAGkAcwBhAGIAbABlAGkAbwBhAHYAcAByAG8AdABlAGMAdABpAG8AbgAgA",
                  "ZABpAHMAYQBiAGwAZQBiAGUAaABhAHYAaQBvAHIAbQBvAG4AaQB0AG8AcgBpAG4AZwAgA",
                  "QAaQBzAGEAYgBsAGUAYgBlAGgAYQB2AGkAbwByAG0AbwBuAGkAdABvAHIAaQBuAGcAIA",
                  "kAGkAcwBhAGIAbABlAGIAZQBoAGEAdgBpAG8AcgBtAG8AbgBpAHQAbwByAGkAbgBnACAA",
                  "ZABpAHMAYQBiAGwAZQBiAGwAbwBjAGsAYQB0AGYAaQByAHMAdABzAGUAZQBuACAA",
                  "QAaQBzAGEAYgBsAGUAYgBsAG8AYwBrAGEAdABmAGkAcgBzAHQAcwBlAGUAbgAgA",
                  "kAGkAcwBhAGIAbABlAGIAbABvAGMAawBhAHQAZgBpAHIAcwB0AHMAZQBlAG4AIA",
                  "RABpAHMAYQBiAGwAZQBDAGEAdABjAGgAdQBwAEYAdQBsAGwAUwBjAGEAbgA",
                  "RABpAHMAYQBiAGwAZQBDAGEAdABjAGgAdQBwAFEAdQBpAGMAawBTAGMAYQBuAA",
                  "RABpAHMAYQBiAGwAZQBBAHIAYwBoAGkAdgBlAFMAYwBhAG4AbgBpAG4AZwA"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_cli_* or 1 of selection_encoded_*",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "all of selection_cli_*",
            "1 of selection_encoded_*"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-03-03",
        "modified": "2024-01-02",
        "references": [
          "https://learn.microsoft.com/en-us/powershell/module/defender/set-mppreference?view=windowsserver2022-ps",
          "https://www.virustotal.com/gui/file/d609799091731d83d75ec5d1f030571af20c45efeeb94840b67ea09a3283ab65/behavior/C2AE",
          "https://www.virustotal.com/gui/search/content%253A%2522Set-MpPreference%2520-Disable%2522/files"
        ],
        "falsepositives": [
          "Possible administrative activity",
          "Other Cmdlets that may use the same parameters"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_defender_disable_feature.yml"
      }
    },
    {
      "id": "a9e416a8-e613-4f8b-88b8-a7d1d1af2f61",
      "title": "Suspicious Use of CSharp Interactive Console",
      "status": "test",
      "description": "Detects the execution of CSharp interactive console by PowerShell",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.defense-evasion",
        "attack.t1127"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\csi.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\powershell_ise.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "OriginalFileName": {
                "field": "OriginalFileName",
                "value": "csi.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1127"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Michael R. (@nahamike01)",
        "date": "2020-03-08",
        "modified": "2022-07-14",
        "references": [
          "https://redcanary.com/blog/detecting-attacks-leveraging-the-net-framework/"
        ],
        "falsepositives": [
          "Possible depending on environment. Pair with other factors such as net connections, command-line args, etc."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_csi_use_of_csharp_console.yml"
      }
    },
    {
      "id": "5589ab4f-a767-433c-961d-c91f3f704db1",
      "title": "Potential SMB Relay Attack Tool Execution",
      "status": "test",
      "description": "Detects different hacktools used for relay attacks on Windows for privilege escalation",
      "level": "critical",
      "tags": [
        "attack.collection",
        "attack.execution",
        "attack.credential-access",
        "attack.t1557.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_pe": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  "PetitPotam",
                  "RottenPotato",
                  "HotPotato",
                  "JuicyPotato",
                  "\\just_dce_",
                  "Juicy Potato",
                  "\\temp\\rot.exe",
                  "\\Potato.exe",
                  "\\SpoolSample.exe",
                  "\\Responder.exe",
                  "\\smbrelayx",
                  "\\ntlmrelayx",
                  "\\LocalPotato"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_script": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Invoke-Tater",
                  " smbrelay",
                  " ntlmrelay",
                  "cme smb ",
                  " /ntlm:NTLMhash ",
                  "Invoke-PetitPotam",
                  ".exe -t * -p "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_juicypotato_enum": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": ".exe -c \"{",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": "}\" -z",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_hotpotatoes": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  "HotPotatoes6",
                  "HotPotatoes7",
                  "HotPotatoes "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "1 of selection_* and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "1 of selection_*"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1557.001"
        ],
        "tactics": [
          "collection",
          "execution",
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-07-24",
        "modified": "2023-02-14",
        "references": [
          "https://foxglovesecurity.com/2016/09/26/rotten-potato-privilege-escalation-from-service-accounts-to-system/",
          "https://pentestlab.blog/2017/04/13/hot-potato/",
          "https://github.com/ohpe/juicy-potato",
          "https://hunter2.gitbook.io/darthsidious/other/war-stories/domain-admin-in-30-minutes",
          "https://hunter2.gitbook.io/darthsidious/execution/responder-with-ntlm-relay-and-empire",
          "https://www.localpotato.com/"
        ],
        "falsepositives": [
          "Legitimate files with these rare hacktool names"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_relay_attacks_tools.yml"
      }
    },
    {
      "id": "6a5f68d1-c4b5-46b9-94ee-5324892ea939",
      "title": "Uninstall Sysinternals Sysmon",
      "status": "test",
      "description": "Detects the removal of Sysmon, which could be a potential attempt at defense evasion",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_pe": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\Sysmon64.exe",
                      "\\Sysmon.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "System activity monitor",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-u",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-12",
        "modified": "2024-03-13",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md#atomic-test-11---uninstall-sysmon"
        ],
        "falsepositives": [
          "Legitimate administrators might use this command to remove Sysmon for debugging purposes"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sysinternals_sysmon_uninstall.yml"
      }
    },
    {
      "id": "9cc85849-3b02-4cb5-b371-3a1ff54f2218",
      "title": "File Download From IP URL Via Curl.EXE",
      "status": "test",
      "description": "Detects file downloads directly from IP address URL using curl.exe",
      "level": "medium",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\curl.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "curl.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_ip": {
            "type": "field_match",
            "matchers": {
              "CommandLine__re": {
                "field": "CommandLine",
                "value": "://[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}",
                "modifiers": [
                  "re"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_http": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "http",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_flag": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -O",
                  "--remote-name",
                  "--output"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_ext": {
            "type": "field_match",
            "matchers": {
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": [
                  ".bat",
                  ".bat\"",
                  ".dat",
                  ".dat\"",
                  ".dll",
                  ".dll\"",
                  ".exe",
                  ".exe\"",
                  ".gif",
                  ".gif\"",
                  ".hta",
                  ".hta\"",
                  ".jpeg",
                  ".jpeg\"",
                  ".log",
                  ".log\"",
                  ".msi",
                  ".msi\"",
                  ".png",
                  ".png\"",
                  ".ps1",
                  ".ps1\"",
                  ".psm1",
                  ".psm1\"",
                  ".vbe",
                  ".vbe\"",
                  ".vbs",
                  ".vbs\"",
                  ".bat'",
                  ".dat'",
                  ".dll'",
                  ".exe'",
                  ".gif'",
                  ".hta'",
                  ".jpeg'",
                  ".log'",
                  ".msi'",
                  ".png'",
                  ".ps1'",
                  ".psm1'",
                  ".vbe'",
                  ".vbs'"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_main_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-10-18",
        "modified": "",
        "references": [
          "https://labs.withsecure.com/publications/fin7-target-veeam-servers",
          "https://github.com/WithSecureLabs/iocs/blob/344203de742bb7e68bd56618f66d34be95a9f9fc/FIN7VEEAM/iocs.csv",
          "https://github.com/pr0xylife/IcedID/blob/8dd1e218460db4f750d955b4c65b2f918a1db906/icedID_09.28.2023.txt"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_curl_download_direct_ip_exec.yml"
      }
    },
    {
      "id": "9f0a8bf3-a65b-440a-8c1e-5cb1547c8e70",
      "title": "New DLL Registered Via Odbcconf.EXE",
      "status": "test",
      "description": "Detects execution of \"odbcconf\" with \"REGSVR\" in order to register a new DLL (equivalent to running regsvr32). Attackers abuse this to install and run malicious DLLs.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.008"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\odbcconf.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "odbcconf.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "REGSVR ",
                  ".dll"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.008"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Kirill Kiryanov, Beyu Denis, Daniil Yugoslavskiy, oscd.community, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-22",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/sql/odbc/odbcconf-exe?view=sql-server-ver16",
          "https://lolbas-project.github.io/lolbas/Binaries/Odbcconf/",
          "https://redcanary.com/blog/raspberry-robin/",
          "https://web.archive.org/web/20191023232753/https://twitter.com/Hexacorn/status/1187143326673330176",
          "https://www.hexacorn.com/blog/2020/08/23/odbcconf-lolbin-trifecta/",
          "https://www.trendmicro.com/en_us/research/17/h/backdoor-carrying-emails-set-sights-on-russian-speaking-businesses.html"
        ],
        "falsepositives": [
          "Legitimate DLLs being registered via \"odbcconf\" will generate false positives. Investigate the path of the DLL and its content to determine if the action is authorized."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_odbcconf_register_dll_regsvr.yml"
      }
    },
    {
      "id": "ed825c86-c009-4014-b413-b76003e33d35",
      "title": "Windows Binary Executed From WSL",
      "status": "test",
      "description": "Detects the execution of Windows binaries from within a WSL instance.\nThis could be used to masquerade parent-child relationships\n",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.defense-evasion",
        "attack.t1202"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__re": {
                "field": "Image",
                "value": "[a-zA-Z]:\\\\",
                "modifiers": [
                  "re"
                ],
                "is_list": false,
                "negated": false
              },
              "CurrentDirectory__contains": {
                "field": "CurrentDirectory",
                "value": "\\\\\\\\wsl.localhost",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1202"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-02-14",
        "modified": "",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wsl_windows_binaries_execution.yml"
      }
    },
    {
      "id": "aaf46cdc-934e-4284-b329-34aa701e3771",
      "title": "Uncommon Child Process Of BgInfo.EXE",
      "status": "test",
      "description": "Detects uncommon child processes of \"BgInfo.exe\" which could be a sign of potential abuse of the binary to proxy execution via external VBScript",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059.005",
        "attack.defense-evasion",
        "attack.t1218",
        "attack.t1202"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\bginfo.exe",
                  "\\bginfo64.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.005",
          "T1218",
          "T1202"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), Beyu Denis, oscd.community",
        "date": "2019-10-26",
        "modified": "2023-08-16",
        "references": [
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Bginfo/",
          "https://oddvar.moe/2017/05/18/bypassing-application-whitelisting-with-bginfo/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_bginfo_uncommon_child_process.yml"
      }
    },
    {
      "id": "90dcf730-1b71-4ae7-9ffc-6fcf62bd0132",
      "title": "Suspicious ZipExec Execution",
      "status": "test",
      "description": "ZipExec is a Proof-of-Concept (POC) tool to wrap binary-based tools into a password-protected zip file.",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.defense-evasion",
        "attack.t1218",
        "attack.t1202"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "run": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/generic:Microsoft_Windows_Shell_ZipFolder:filename=",
                  ".zip",
                  "/pass:",
                  "/user:"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "delete": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/delete",
                  "Microsoft_Windows_Shell_ZipFolder:filename=",
                  ".zip"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "run or delete",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "run",
            "delete"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218",
          "T1202"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-11-07",
        "modified": "2022-12-25",
        "references": [
          "https://twitter.com/SBousseaden/status/1451237393017839616",
          "https://github.com/Tylous/ZipExec"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_zipexec.yml"
      }
    },
    {
      "id": "378a05d8-963c-46c9-bcce-13c7657eac99",
      "title": "Potentially Suspicious Electron Application CommandLine",
      "status": "test",
      "description": "Detects potentially suspicious CommandLine of electron apps (teams, discord, slack, etc.). This could be a sign of abuse to proxy execution through a signed binary.",
      "level": "medium",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\chrome.exe",
                      "\\code.exe",
                      "\\discord.exe",
                      "\\GitHubDesktop.exe",
                      "\\keybase.exe",
                      "\\msedge_proxy.exe",
                      "\\msedge.exe",
                      "\\msedgewebview2.exe",
                      "\\msteams.exe",
                      "\\slack.exe",
                      "\\Teams.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "chrome.exe",
                      "code.exe",
                      "discord.exe",
                      "GitHubDesktop.exe",
                      "keybase.exe",
                      "msedge_proxy.exe",
                      "msedge.exe",
                      "msedgewebview2.exe",
                      "msteams.exe",
                      "slack.exe",
                      "Teams.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "--browser-subprocess-path",
                  "--gpu-launcher",
                  "--renderer-cmd-prefix",
                  "--utility-cmd-prefix"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-09-05",
        "modified": "2023-11-09",
        "references": [
          "https://positive.security/blog/ms-officecmd-rce",
          "https://lolbas-project.github.io/lolbas/Binaries/Teams/",
          "https://lolbas-project.github.io/lolbas/Binaries/Msedge/",
          "https://lolbas-project.github.io/lolbas/Binaries/msedgewebview2/",
          "https://medium.com/@MalFuzzer/one-electron-to-rule-them-all-dc2e9b263daf",
          "https://chromium.googlesource.com/chromium/chromium/+/master/content/public/common/content_switches.cc"
        ],
        "falsepositives": [
          "Legitimate usage for debugging purposes"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_electron_execution_proxy.yml"
      }
    },
    {
      "id": "ef64fc9c-a45e-43cc-8fd8-7d75d73b4c99",
      "title": "Wusa.EXE Executed By Parent Process Located In Suspicious Location",
      "status": "test",
      "description": "Detects execution of the \"wusa.exe\" (Windows Update Standalone Installer) utility by a parent process that is located in a suspicious location.\nAttackers could instantiate an instance of \"wusa.exe\" in order to bypass User Account Control (UAC). They can duplicate the access token from \"wusa.exe\" to gain elevated privileges.\n",
      "level": "high",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\wusa.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_paths_1": {
            "type": "field_match",
            "matchers": {
              "ParentImage__contains": {
                "field": "ParentImage",
                "value": [
                  ":\\Perflogs\\",
                  ":\\Users\\Public\\",
                  ":\\Windows\\Temp\\",
                  "\\Appdata\\Local\\Temp\\",
                  "\\Temporary Internet"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_paths_2": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "ParentImage__contains_all": {
                    "field": "ParentImage",
                    "value": [
                      ":\\Users\\",
                      "\\Favorites\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "ParentImage__contains_all": {
                    "field": "ParentImage",
                    "value": [
                      ":\\Users\\",
                      "\\Favourites\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "ParentImage__contains_all": {
                    "field": "ParentImage",
                    "value": [
                      ":\\Users\\",
                      "\\Contacts\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "ParentImage__contains_all": {
                    "field": "ParentImage",
                    "value": [
                      ":\\Users\\",
                      "\\Pictures\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_main_msu": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": ".msu",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection_img and 1 of selection_paths_* and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_img"
            },
            {
              "type": "ref",
              "value": "1 of selection_paths_*"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "X__Junior (Nextron Systems)",
        "date": "2023-11-26",
        "modified": "2024-08-15",
        "references": [
          "https://www.fortinet.com/blog/threat-research/konni-campaign-distributed-via-malicious-document"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wusa_susp_parent_execution.yml"
      }
    },
    {
      "id": "517490a7-115a-48c6-8862-1a481504d5a8",
      "title": "Potential Shim Database Persistence via Sdbinst.EXE",
      "status": "test",
      "description": "Detects installation of a new shim using sdbinst.exe.\nAdversaries may establish persistence and/or elevate privileges by executing malicious content triggered by application shims\n",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.privilege-escalation",
        "attack.t1546.011"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\sdbinst.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "sdbinst.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": ".sdb",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_iis": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\msiexec.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ":\\Program Files (x86)\\IIS Express\\iisexpressshim.sdb",
                  ":\\Program Files\\IIS Express\\iisexpressshim.sdb"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_optional_"
        }
      },
      "mitre": {
        "techniques": [
          "T1546.011"
        ],
        "tactics": [
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Markus Neis",
        "date": "2019-01-16",
        "modified": "2023-12-06",
        "references": [
          "https://www.mandiant.com/resources/blog/fin7-shim-databases-persistence"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sdbinst_shim_persistence.yml"
      }
    },
    {
      "id": "0f9c21f1-6a73-4b0e-9809-cb562cb8d981",
      "title": "Potential Privilege Escalation via Service Permissions Weakness",
      "status": "test",
      "description": "Detect modification of services configuration (ImagePath, FailureCommand and ServiceDLL) in registry by processes with Medium integrity level",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1574.011"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "IntegrityLevel": {
                "field": "IntegrityLevel",
                "value": [
                  "Medium",
                  "S-1-16-8192"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "ControlSet",
                  "services"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\ImagePath",
                  "\\FailureCommand",
                  "\\ServiceDll"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1574.011"
        ],
        "tactics": [
          "persistence",
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Teymur Kheirkhabarov",
        "date": "2019-10-26",
        "modified": "2024-12-01",
        "references": [
          "https://speakerdeck.com/heirhabarov/hunting-for-privilege-escalation-in-windows-environment",
          "https://pentestlab.blog/2017/03/31/insecure-registry-permissions/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_registry_privilege_escalation_via_service_key.yml"
      }
    },
    {
      "id": "c8a180d6-47a3-4345-a609-53f9c3d834fc",
      "title": "Suspicious Reconnaissance Activity Using Get-LocalGroupMember Cmdlet",
      "status": "test",
      "description": "Detects suspicious reconnaissance command line activity on Windows systems using the PowerShell Get-LocalGroupMember Cmdlet",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.t1087.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_cmdlet": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "Get-LocalGroupMember ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_group": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "domain admins",
                  " administrator",
                  " administrateur",
                  "enterprise admins",
                  "Exchange Trusted Subsystem",
                  "Remote Desktop Users",
                  "Utilisateurs du Bureau à distance",
                  "Usuarios de escritorio remoto"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1087.001"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-10-10",
        "modified": "",
        "references": [
          "https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/"
        ],
        "falsepositives": [
          "Administrative activity"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_get_localgroup_member_recon.yml"
      }
    },
    {
      "id": "2617e7ed-adb7-40ba-b0f3-8f9945fe6c09",
      "title": "Suspicious SYSTEM User Process Creation",
      "status": "test",
      "description": "Detects a suspicious process creation as SYSTEM user (suspicious program or command line parameter)",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1134",
        "attack.t1003",
        "attack.t1027"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "IntegrityLevel": {
                "field": "IntegrityLevel",
                "value": [
                  "System",
                  "S-1-16-16384"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "User__contains": {
                "field": "User",
                "value": [
                  "AUTHORI",
                  "AUTORI"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_special": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\calc.exe",
                      "\\cscript.exe",
                      "\\forfiles.exe",
                      "\\hh.exe",
                      "\\mshta.exe",
                      "\\ping.exe",
                      "\\wscript.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__re": {
                    "field": "CommandLine",
                    "value": "net\\s+user\\s+",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      " -NoP ",
                      " -W Hidden ",
                      " -decode ",
                      " /decode ",
                      " /urlcache ",
                      " -urlcache ",
                      " -e* JAB",
                      " -e* SUVYI",
                      " -e* SQBFAFgA",
                      " -e* aWV4I",
                      " -e* IAB",
                      " -e* PAA",
                      " -e* aQBlAHgA",
                      "vssadmin delete shadows",
                      "reg SAVE HKLM",
                      " -ma ",
                      "Microsoft\\Windows\\CurrentVersion\\Run",
                      ".downloadstring(",
                      ".downloadfile(",
                      " /ticket:",
                      "dpapi::",
                      "event::clear",
                      "event::drop",
                      "id::modify",
                      "kerberos::",
                      "lsadump::",
                      "misc::",
                      "privilege::",
                      "rpc::",
                      "sekurlsa::",
                      "sid::",
                      "token::",
                      "vault::cred",
                      "vault::list",
                      " p::d ",
                      ";iex(",
                      "MiniDump"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_main_ping": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "ping",
                  "127.0.0.1",
                  " -n "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_vs": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\PING.EXE",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "ParentCommandLine__contains": {
                "field": "ParentCommandLine",
                "value": "\\DismFoDInstall.cmd",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_config_mgr": {
            "type": "field_match",
            "matchers": {
              "ParentImage__contains": {
                "field": "ParentImage",
                "value": ":\\Packages\\Plugins\\Microsoft.GuestConfiguration.ConfigurationforWindows\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_java": {
            "type": "field_match",
            "matchers": {
              "ParentImage__contains": {
                "field": "ParentImage",
                "value": [
                  ":\\Program Files (x86)\\Java\\",
                  ":\\Program Files\\Java\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\bin\\javaws.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__contains": {
                "field": "Image",
                "value": [
                  ":\\Program Files (x86)\\Java\\",
                  ":\\Program Files\\Java\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\bin\\jp2launcher.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -ma ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection* and not 1 of filter_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection",
          "none_of": "filter_"
        }
      },
      "mitre": {
        "techniques": [
          "T1134",
          "T1003",
          "T1027"
        ],
        "tactics": [
          "credential_access",
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), David ANDRE (additional keywords)",
        "date": "2021-12-20",
        "modified": "2025-10-19",
        "references": [
          "Internal Research",
          "https://tools.thehacker.recipes/mimikatz/modules"
        ],
        "falsepositives": [
          "Administrative activity",
          "Scripts and administrative tools used in the monitored environment",
          "Monitoring activity"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_system_user_anomaly.yml"
      }
    },
    {
      "id": "f426547a-e0f7-441a-b63e-854ac5bdf54d",
      "title": "Perl Inline Command Execution",
      "status": "test",
      "description": "Detects execution of perl using the \"-e\"/\"-E\" flags. This is could be used as a way to launch a reverse shell or execute live perl code.",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\perl.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "perl.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -e",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-01-02",
        "modified": "",
        "references": [
          "https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet",
          "https://www.revshells.com/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_perl_inline_command_execution.yml"
      }
    },
    {
      "id": "81325ce1-be01-4250-944f-b4789644556f",
      "title": "Schedule Task Creation From Env Variable Or Potentially Suspicious Path Via Schtasks.EXE",
      "status": "test",
      "description": "Detects Schtask creations that point to a suspicious folder or an environment variable often used by malware",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.execution",
        "attack.t1053.005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_1_create": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\schtasks.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " /create ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_1_all_folders": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ":\\Perflogs",
                  ":\\Users\\All Users\\",
                  ":\\Users\\Default\\",
                  ":\\Users\\Public",
                  ":\\Windows\\Temp",
                  "\\AppData\\Local\\",
                  "\\AppData\\Roaming\\",
                  "%AppData%",
                  "%Public%"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_2_parent": {
            "type": "field_match",
            "matchers": {
              "ParentCommandLine__endswith": {
                "field": "ParentCommandLine",
                "value": "\\svchost.exe -k netsvcs -p -s Schedule",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_2_some_folders": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ":\\Perflogs",
                  ":\\Windows\\Temp",
                  "\\Users\\Public",
                  "%Public%"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_other": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "ParentCommandLine__contains": {
                    "field": "ParentCommandLine",
                    "value": "unattended.ini",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": "update_task.xml",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "filter_optional_team_viewer": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "/Create /TN TVInstallRestore /TR",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_avira_install": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/Create /Xml ",
                  "\\Temp\\.CR.",
                  "\\Avira_Security_Installation.xml"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_avira_other": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/Create /F /TN",
                  "/Xml ",
                  "\\Temp\\",
                  "Avira_"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ".tmp\\UpdateFallbackTask.xml",
                  ".tmp\\WatchdogServiceControlManagerTimeout.xml",
                  ".tmp\\SystrayAutostart.xml",
                  ".tmp\\MaintenanceTask.xml"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_klite_codec": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "\\Temp\\",
                  "/Create /TN \"klcp_update\" /XML ",
                  "\\klcp_update_task.xml"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "( all of selection_1_* or all of selection_2_* ) and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "( all of selection_1_*",
            "all of selection_2_* ) and not 1 of filter_optional_*"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1053.005"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-02-21",
        "modified": "2025-10-07",
        "references": [
          "https://www.welivesecurity.com/2022/01/18/donot-go-do-not-respawn/",
          "https://www.joesandbox.com/analysis/514608/0/html#324415FF7D8324231381BAD48A052F85DF04",
          "https://blog.talosintelligence.com/gophish-powerrat-dcrat/"
        ],
        "falsepositives": [
          "Benign scheduled tasks creations or executions that happen often during software installations",
          "Software that uses the AppData folder and scheduled tasks to update the software in the AppData folders"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_schtasks_env_folder.yml"
      }
    },
    {
      "id": "5e3cc4d8-3e68-43db-8656-eaaeefdec9cc",
      "title": "Suspicious Invoke-WebRequest Execution",
      "status": "test",
      "description": "Detects a suspicious call to Invoke-WebRequest cmdlet where the and output is located in a suspicious location",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1105"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell_ise.exe",
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "powershell_ise.EXE",
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_commands": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "curl ",
                  "Invoke-WebRequest",
                  "iwr ",
                  "wget "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_flags": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -ur",
                  " -o"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_susp_locations": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\AppData\\",
                  "\\Desktop\\",
                  "\\Temp\\",
                  "\\Users\\Public\\",
                  "%AppData%",
                  "%Public%",
                  "%Temp%",
                  "%tmp%",
                  ":\\Windows\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1105"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-02",
        "modified": "2025-07-18",
        "references": [
          "https://www.sentinelone.com/blog/living-off-windows-defender-lockbit-ransomware-sideloads-cobalt-strike-through-microsoft-security-tool/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_invoke_webrequest_download.yml"
      }
    },
    {
      "id": "e62a9f0c-ca1e-46b2-85d5-a6da77f86d1a",
      "title": "File Encoded To Base64 Via Certutil.EXE",
      "status": "test",
      "description": "Detects the execution of certutil with the \"encode\" flag to encode a file to base64. This can be abused by threat actors and attackers for data exfiltration",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\certutil.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "CertUtil.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-encode",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1027"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Jonhnathan Ribeiro, oscd.community, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2019-02-24",
        "modified": "2024-03-05",
        "references": [
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/certutil",
          "https://unit42.paloaltonetworks.com/new-babyshark-malware-targets-u-s-national-security-think-tanks/",
          "https://lolbas-project.github.io/lolbas/Binaries/Certutil/"
        ],
        "falsepositives": [
          "As this is a general purpose rule, legitimate usage of the encode functionality will trigger some false positives. Apply additional filters accordingly"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_certutil_encode.yml"
      }
    },
    {
      "id": "8823e85d-31d8-473e-b7f4-92da070f0fc6",
      "title": "Suspicious ShellExec_RunDLL Call Via Ordinal",
      "status": "test",
      "description": "Detects suspicious call to the \"ShellExec_RunDLL\" exported function of SHELL32.DLL through the ordinal number to launch other commands.\nAdversary might only use the ordinal number in order to bypass existing detection that alert on usage of ShellExec_RunDLL on CommandLine.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.011"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent_img": {
            "type": "field_match",
            "matchers": {
              "ParentCommandLine__contains": {
                "field": "ParentCommandLine",
                "value": "SHELL32.DLL",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_parent_ordinal": {
            "type": "field_match",
            "matchers": {
              "ParentCommandLine__contains": {
                "field": "ParentCommandLine",
                "value": [
                  "#568",
                  "#570",
                  "#572",
                  "#576"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_susp_cli_parent": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "ParentCommandLine__contains": {
                    "field": "ParentCommandLine",
                    "value": [
                      "comspec",
                      "iex",
                      "Invoke-",
                      "msiexec",
                      "odbcconf",
                      "regsvr32"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "ParentCommandLine__contains": {
                    "field": "ParentCommandLine",
                    "value": [
                      "\\Desktop\\",
                      "\\ProgramData\\",
                      "\\Temp\\",
                      "\\Users\\Public\\"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_susp_child_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\bash.exe",
                  "\\bitsadmin.exe",
                  "\\cmd.exe",
                  "\\cscript.exe",
                  "\\curl.exe",
                  "\\mshta.exe",
                  "\\msiexec.exe",
                  "\\msxsl.exe",
                  "\\odbcconf.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\regsvr32.exe",
                  "\\schtasks.exe",
                  "\\wmic.exe",
                  "\\wscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_parent_* and 1 of selection_susp_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "all of selection_parent_*"
            },
            {
              "type": "ref",
              "value": "1 of selection_susp_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218.011"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel",
        "date": "2024-12-01",
        "modified": "",
        "references": [
          "https://redcanary.com/blog/raspberry-robin/",
          "https://www.microsoft.com/en-us/security/blog/2022/10/27/raspberry-robin-worm-part-of-larger-ecosystem-facilitating-pre-ransomware-activity/",
          "https://github.com/SigmaHQ/sigma/issues/1009",
          "https://strontic.github.io/xcyclopedia/library/shell32.dll-65DA072F25DE83D9F83653E3FEA3644D.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_rundll32_susp_shellexec_ordinal_execution.yml"
      }
    },
    {
      "id": "d3b70aad-097e-409c-9df2-450f80dc476b",
      "title": "PUA - DIT Snapshot Viewer",
      "status": "test",
      "description": "Detects the use of Ditsnap tool, an inspection tool for Active Directory database, ntds.dit.",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\ditsnap.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": "ditsnap.exe",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.003"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Furkan Caliskan (@caliskanfurkan_)",
        "date": "2020-07-04",
        "modified": "2023-02-21",
        "references": [
          "https://thedfirreport.com/2020/06/21/snatch-ransomware/",
          "https://web.archive.org/web/20201124182207/https://github.com/yosqueoy/ditsnap"
        ],
        "falsepositives": [
          "Legitimate admin usage"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_ditsnap.yml"
      }
    },
    {
      "id": "5edc2273-c26f-406c-83f3-f4d948e740dd",
      "title": "Indirect Inline Command Execution Via Bash.EXE",
      "status": "test",
      "description": "Detects execution of Microsoft bash launcher with the \"-c\" flag.\nThis can be used to potentially bypass defenses and execute Linux or Windows-based binaries directly via bash.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1202"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      ":\\Windows\\System32\\bash.exe",
                      ":\\Windows\\SysWOW64\\bash.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "Bash.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -c ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1202"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-11-24",
        "modified": "2023-08-15",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Bash/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_bash_command_execution.yml"
      }
    },
    {
      "id": "cd951fdc-4b2f-47f5-ba99-a33bf61e3770",
      "title": "Always Install Elevated Windows Installer",
      "status": "test",
      "description": "Detects Windows Installer service (msiexec.exe) trying to install MSI packages with SYSTEM privilege",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_user": {
            "type": "field_match",
            "matchers": {
              "User__contains": {
                "field": "User",
                "value": [
                  "AUTHORI",
                  "AUTORI"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_image_1": {
            "type": "field_match",
            "matchers": {
              "Image__contains_all": {
                "field": "Image",
                "value": [
                  "\\Windows\\Installer\\",
                  "msi"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "tmp",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_image_2": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\msiexec.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "IntegrityLevel": {
                "field": "IntegrityLevel",
                "value": [
                  "System",
                  "S-1-16-16384"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_installer": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": "C:\\Windows\\System32\\services.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_repair": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__endswith": {
                    "field": "CommandLine",
                    "value": "\\system32\\msiexec.exe /V",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "ParentCommandLine__endswith": {
                    "field": "ParentCommandLine",
                    "value": "\\system32\\msiexec.exe /V",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "filter_sophos": {
            "type": "field_match",
            "matchers": {
              "ParentImage__startswith": {
                "field": "ParentImage",
                "value": "C:\\ProgramData\\Sophos\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_avira": {
            "type": "field_match",
            "matchers": {
              "ParentImage__startswith": {
                "field": "ParentImage",
                "value": "C:\\ProgramData\\Avira\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_avast": {
            "type": "field_match",
            "matchers": {
              "ParentImage__startswith": {
                "field": "ParentImage",
                "value": [
                  "C:\\Program Files\\Avast Software\\",
                  "C:\\Program Files (x86)\\Avast Software\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_google_update": {
            "type": "field_match",
            "matchers": {
              "ParentImage__startswith": {
                "field": "ParentImage",
                "value": [
                  "C:\\Program Files\\Google\\Update\\",
                  "C:\\Program Files (x86)\\Google\\Update\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "1 of selection_image_* and selection_user and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "1 of selection_image_*"
            },
            {
              "type": "ref",
              "value": "selection_user"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Teymur Kheirkhabarov (idea), Mangatas Tondang (rule), oscd.community",
        "date": "2020-10-13",
        "modified": "2024-12-01",
        "references": [
          "https://image.slidesharecdn.com/kheirkhabarovoffzonefinal-181117201458/95/hunting-for-privilege-escalation-in-windows-environment-48-638.jpg"
        ],
        "falsepositives": [
          "System administrator usage",
          "Anti virus products",
          "WindowsApps located in \"C:\\Program Files\\WindowsApps\\\""
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_always_install_elevated_windows_installer.yml"
      }
    },
    {
      "id": "855bc8b5-2ae8-402e-a9ed-b889e6df1900",
      "title": "Copy From Or To Admin Share Or Sysvol Folder",
      "status": "test",
      "description": "Detects a copy command or a copy utility execution to or from an Admin share or remote",
      "level": "medium",
      "tags": [
        "attack.lateral-movement",
        "attack.collection",
        "attack.exfiltration",
        "attack.t1039",
        "attack.t1048",
        "attack.t1021.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_target": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\\\\\\\*\\\\*$",
                  "\\Sysvol\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_other_tools": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\robocopy.exe",
                      "\\xcopy.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "robocopy.exe",
                      "XCOPY.EXE"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cmd_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\cmd.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "Cmd.Exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cmd_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "copy",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_pwsh_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__contains": {
                    "field": "Image",
                    "value": [
                      "\\powershell_ise.exe",
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "powershell_ise.exe",
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_pwsh_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "copy-item",
                  "copy ",
                  "cpi ",
                  " cp ",
                  "move ",
                  " move-item",
                  " mi ",
                  " mv "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_target and (selection_other_tools or all of selection_cmd_* or all of selection_pwsh_*)",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection_target and (selection_other_tools",
            "all of selection_cmd_*",
            "all of selection_pwsh_*)"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1039",
          "T1048",
          "T1021.002"
        ],
        "tactics": [
          "lateral_movement",
          "collection",
          "exfiltration"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), oscd.community, Teymur Kheirkhabarov @HeirhabarovT, Zach Stanford @svch0st, Nasreddine Bencherchali",
        "date": "2019-12-30",
        "modified": "2025-10-22",
        "references": [
          "https://twitter.com/SBousseaden/status/1211636381086339073",
          "https://drive.google.com/file/d/1lKya3_mLnR3UQuCoiYruO3qgu052_iS_/view",
          "https://www.elastic.co/guide/en/security/current/remote-file-copy-to-a-hidden-share.html",
          "https://www.microsoft.com/en-us/security/blog/2022/10/18/defenders-beware-a-case-for-post-ransomware-investigations/"
        ],
        "falsepositives": [
          "Administrative scripts"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_copy_lateral_movement.yml"
      }
    },
    {
      "id": "2782fbd8-b662-4eb5-9962-5bfbfb671e7b",
      "title": "Suspicious Usage of For Loop with Recursive Directory Search in CMD",
      "status": "experimental",
      "description": "Detects suspicious usage of the cmd.exe 'for /f' loop combined with the 'tokens=' parameter and a recursive directory listing.\nThis pattern may indicate an attempt to discover and execute system binaries dynamically, for example powershell, a technique sometimes used by attackers to evade detection.\nThis behavior has been observed in various malicious lnk files.\n",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059.003",
        "attack.defense-evasion",
        "attack.t1027.010"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_tokens": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "for /f",
                  "tokens=",
                  "in (",
                  "dir"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_tokens_parent": {
            "type": "field_match",
            "matchers": {
              "ParentCommandLine__contains_all": {
                "field": "ParentCommandLine",
                "value": [
                  "for /f",
                  "tokens=",
                  "in (",
                  "dir"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.003",
          "T1027.010"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Joseliyo Sanchez, @Joseliyo_Jstnk",
        "date": "2025-11-12",
        "modified": "",
        "references": [
          "https://www.virustotal.com/gui/file/29837d0d3202758063185828c8f8d9e0b7b42b365c8941cc926d2d7c7bae2fb3"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_cmd_for_loop_execution_with_recursive_directory_search.yml"
      }
    },
    {
      "id": "cafeeba3-01da-4ab4-b6c4-a31b1d9730c7",
      "title": "PrintBrm ZIP Creation of Extraction",
      "status": "test",
      "description": "Detects the execution of the LOLBIN PrintBrm.exe, which can be used to create or extract ZIP files. PrintBrm.exe should not be run on a normal workstation.",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1105",
        "attack.defense-evasion",
        "attack.t1564.004"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\PrintBrm.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " -f",
                  ".zip"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1105",
          "T1564.004"
        ],
        "tactics": [
          "command_and_control",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-05-02",
        "modified": "",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/PrintBrm/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_printbrm.yml"
      }
    },
    {
      "id": "4b8f6d3a-9c5e-4f2a-a7d8-6b9c3e5f2a8d",
      "title": "RDP Enable or Disable via Win32_TerminalServiceSetting WMI Class",
      "status": "experimental",
      "description": "Detects enabling or disabling of Remote Desktop Protocol (RDP) using alternate methods such as WMIC or PowerShell.\nIn PowerShell one-liner commands, the \"SetAllowTSConnections\" method of the \"Win32_TerminalServiceSetting\" class may be used to enable or disable RDP.\nIn WMIC, the \"rdtoggle\" alias or \"Win32_TerminalServiceSetting\" class may be used for the same purpose.\n",
      "level": "medium",
      "tags": [
        "attack.lateral-movement",
        "attack.t1021.001",
        "attack.execution",
        "attack.t1047"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\wmic.exe",
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "wmic.exe",
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_method": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "rdtoggle",
                  "Win32_TerminalServiceSetting"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_property": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "SetAllowTSConnections",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1021.001",
          "T1047"
        ],
        "tactics": [
          "lateral_movement",
          "execution"
        ]
      },
      "meta": {
        "author": "Daniel Koifman (KoifSec), Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-11-15",
        "modified": "",
        "references": [
          "https://www.trendmicro.com/en_gb/research/22/e/uncovering-a-kingminer-botnet-attack-using-trend-micro-managed-x.html",
          "https://github.com/HackTricks-wiki/hacktricks/blob/72f20a3fa26775b932bd819f1824c6377802a768/src/windows-hardening/basic-cmd-for-pentesters.md#firewall",
          "https://github.com/Lifailon/RSA/blob/rsa/Sources/RSA-1.4.1.ps1#L1468"
        ],
        "falsepositives": [
          "Legitimate system administrators enabling RDP for remote support",
          "System configuration scripts during deployment"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_rdp_enable_or_disable_via_win32_terminalservicesetting_wmi_class.yml"
      }
    },
    {
      "id": "19b08b1c-861d-4e75-a1ef-ea0c1baf202b",
      "title": "Suspicious Download Via Certutil.EXE",
      "status": "test",
      "description": "Detects the execution of certutil with certain flags that allow the utility to download files.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027",
        "attack.command-and-control",
        "attack.t1105"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\certutil.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "CertUtil.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_flags": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "urlcache ",
                  "verifyctl ",
                  "URL "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_http": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "http",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1027",
          "T1105"
        ],
        "tactics": [
          "defense_evasion",
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Jonhnathan Ribeiro, oscd.community, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-02-15",
        "modified": "2025-12-01",
        "references": [
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/certutil",
          "https://forensicitguy.github.io/agenttesla-vba-certutil-download/",
          "https://news.sophos.com/en-us/2021/04/13/compromised-exchange-server-hosting-cryptojacker-targeting-other-exchange-servers/",
          "https://twitter.com/egre55/status/1087685529016193025",
          "https://lolbas-project.github.io/lolbas/Binaries/Certutil/",
          "https://www.hexacorn.com/blog/2020/08/23/certutil-one-more-gui-lolbin"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_certutil_download.yml"
      }
    },
    {
      "id": "ce7cf472-6fcc-490a-9481-3786840b5d9b",
      "title": "InfDefaultInstall.exe .inf Execution",
      "status": "test",
      "description": "Executes SCT script using scrobj.dll from a command in entered into a specially prepared INF file.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "InfDefaultInstall.exe ",
                  ".inf"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-07-13",
        "modified": "2022-10-09",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1218/T1218.md#atomic-test-4---infdefaultinstallexe-inf-execution",
          "https://lolbas-project.github.io/lolbas/Binaries/Infdefaultinstall/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_infdefaultinstall_execute_sct_scripts.yml"
      }
    },
    {
      "id": "84b1706c-932a-44c4-ae28-892b28a25b94",
      "title": "OneNote.EXE Execution of Malicious Embedded Scripts",
      "status": "test",
      "description": "Detects the execution of malicious OneNote documents that contain embedded scripts.\nWhen a user clicks on a OneNote attachment and then on the malicious link inside the \".one\" file, it exports and executes the malicious embedded script from specific directories.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\onenote.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\cmd.exe",
                  "\\cscript.exe",
                  "\\mshta.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\wscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\exported\\",
                  "\\onenoteofflinecache_files\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "@kostastsale",
        "date": "2023-02-02",
        "modified": "",
        "references": [
          "https://bazaar.abuse.ch/browse/tag/one/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_office_onenote_embedded_script_execution.yml"
      }
    },
    {
      "id": "643bdcac-8b82-49f4-9fd9-25a90b929f3b",
      "title": "Renamed MegaSync Execution",
      "status": "test",
      "description": "Detects the execution of a renamed MegaSync.exe as seen used by ransomware families like Nefilim, Sodinokibi, Pysa, and Conti.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "OriginalFileName": {
                "field": "OriginalFileName",
                "value": "megasync.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\megasync.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Sittikorn S",
        "date": "2021-06-22",
        "modified": "2023-02-03",
        "references": [
          "https://redcanary.com/blog/rclone-mega-extortion/"
        ],
        "falsepositives": [
          "Software that illegally integrates MegaSync in a renamed form",
          "Administrators that have renamed MegaSync"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_renamed_megasync.yml"
      }
    },
    {
      "id": "8d63dadf-b91b-4187-87b6-34a1114577ea",
      "title": "Potential SquiblyTwo Technique Execution",
      "status": "test",
      "description": "Detects potential SquiblyTwo attack technique with possible renamed WMIC via Imphash and OriginalFileName fields",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1047",
        "attack.t1220",
        "attack.execution",
        "attack.t1059.005",
        "attack.t1059.007"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_pe": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\wmic.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "wmic.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Hashes__contains": {
                    "field": "Hashes",
                    "value": [
                      "IMPHASH=1B1A3F43BF37B5BFE60751F2EE2F326E",
                      "IMPHASH=37777A96245A3C74EB217308F3546F4C",
                      "IMPHASH=9D87C9D67CE724033C0B40CC4CA1B206"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "format:",
                  "http"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1047",
          "T1220",
          "T1059.005",
          "T1059.007"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Markus Neis, Florian Roth",
        "date": "2019-01-16",
        "modified": "2024-11-23",
        "references": [
          "https://web.archive.org/web/20190209154607/https://subt0x11.blogspot.com/2018/04/wmicexe-whitelisting-bypass-hacking.html",
          "https://twitter.com/mattifestation/status/986280382042595328",
          "https://atomicredteam.io/defense-evasion/T1220/",
          "https://lolbas-project.github.io/lolbas/Binaries/Wmic/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wmic_squiblytwo_bypass.yml"
      }
    },
    {
      "id": "c9192ad9-75e5-43eb-8647-82a0a5b493e3",
      "title": "PUA - Mouse Lock Execution",
      "status": "test",
      "description": "In Kaspersky's 2020 Incident Response Analyst Report they listed legitimate tool \"Mouse Lock\" as being used for both credential access and collection in security incidents.",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.collection",
        "attack.t1056.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Product__contains": {
                    "field": "Product",
                    "value": "Mouse Lock",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Company__contains": {
                    "field": "Company",
                    "value": "Misc314",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": "Mouse Lock_",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1056.002"
        ],
        "tactics": [
          "credential_access",
          "collection"
        ]
      },
      "meta": {
        "author": "Cian Heasley",
        "date": "2020-08-13",
        "modified": "2023-02-21",
        "references": [
          "https://github.com/klsecservices/Publications/blob/657deb6a6eb6e00669afd40173f425fb49682eaa/Incident-Response-Analyst-Report-2020.pdf",
          "https://sourceforge.net/projects/mouselock/"
        ],
        "falsepositives": [
          "Legitimate uses of Mouse Lock software"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_mouselock_execution.yml"
      }
    },
    {
      "id": "f117933c-980c-4f78-b384-e3d838111165",
      "title": "Windows Share Mount Via Net.EXE",
      "status": "test",
      "description": "Detects when a share is mounted using the \"net.exe\" utility",
      "level": "low",
      "tags": [
        "attack.lateral-movement",
        "attack.t1021.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\net.exe",
                      "\\net1.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "net.exe",
                      "net1.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " use ",
                  " \\\\\\\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1021.002"
        ],
        "tactics": [
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-02-02",
        "modified": "2023-02-21",
        "references": [
          "https://drive.google.com/file/d/1lKya3_mLnR3UQuCoiYruO3qgu052_iS_/view"
        ],
        "falsepositives": [
          "Legitimate activity by administrators and scripts"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_net_use_mount_share.yml"
      }
    },
    {
      "id": "587254ee-a24b-4335-b3cd-065c0f1f4baa",
      "title": "Remote File Download Via Findstr.EXE",
      "status": "test",
      "description": "Detects execution of \"findstr\" with specific flags and a remote share path. This specific set of CLI flags would allow \"findstr\" to download the content of the file located on the remote share as described in the LOLBAS entry.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.credential-access",
        "attack.command-and-control",
        "attack.t1218",
        "attack.t1564.004",
        "attack.t1552.001",
        "attack.t1105"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_findstr": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": "findstr",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "findstr.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "FINDSTR.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_download_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -v ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli_download_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -l ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli_download_3": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "\\\\\\\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_findstr and all of selection_cli_download_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_findstr"
            },
            {
              "type": "ref",
              "value": "all of selection_cli_download_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218",
          "T1564.004",
          "T1552.001",
          "T1105"
        ],
        "tactics": [
          "defense_evasion",
          "credential_access",
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Furkan CALISKAN, @caliskanfurkan_, @oscd_initiative, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2020-10-05",
        "modified": "2024-03-05",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Findstr/",
          "https://oddvar.moe/2018/04/11/putting-data-in-alternate-data-streams-and-how-to-execute-it-part-2/",
          "https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_findstr_download.yml"
      }
    },
    {
      "id": "c8da0dfd-4ed0-4b68-962d-13c9c884384e",
      "title": "Potential Credential Dumping Via LSASS Process Clone",
      "status": "test",
      "description": "Detects a suspicious LSASS process process clone that could be a sign of credential dumping activity",
      "level": "critical",
      "tags": [
        "attack.credential-access",
        "attack.t1003",
        "attack.t1003.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\Windows\\System32\\lsass.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\Windows\\System32\\lsass.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003",
          "T1003.001"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Samir Bousseaden",
        "date": "2021-11-27",
        "modified": "2023-03-02",
        "references": [
          "https://www.matteomalvica.com/blog/2019/12/02/win-defender-atp-cred-bypass/",
          "https://twitter.com/Hexacorn/status/1420053502554951689",
          "https://twitter.com/SBousseaden/status/1464566846594691073?s=20"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lsass_process_clone.yml"
      }
    },
    {
      "id": "1b3b01c7-84e9-4072-86e5-fc285a41ff23",
      "title": "Nslookup PowerShell Download Cradle - ProcessCreation",
      "status": "test",
      "description": "Detects suspicious powershell download cradle using nslookup. This cradle uses nslookup to extract payloads from DNS records",
      "level": "medium",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__contains": {
                    "field": "Image",
                    "value": "\\nslookup.exe",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "\\nslookup.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cmd": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\powershell.exe",
                  "\\pwsh.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -q=txt ",
                  " -querytype=txt "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-09-05",
        "modified": "2022-12-19",
        "references": [
          "https://twitter.com/Alh4zr3d/status/1566489367232651264"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_nslookup_poweshell_download.yml"
      }
    },
    {
      "id": "ded2b07a-d12f-4284-9b76-653e37b6c8b0",
      "title": "Potentially Suspicious Ping/Copy Command Combination",
      "status": "test",
      "description": "Detects uncommon and potentially suspicious one-liner command containing both \"ping\" and \"copy\" at the same time, which is usually used by malware.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1070.004"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_cmd": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\cmd.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "Cmd.Exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_action": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "ping",
                  "copy "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -n ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -y ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1070.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "X__Junior (Nextron Systems)",
        "date": "2023-07-18",
        "modified": "2024-03-06",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_cmd_ping_copy_combined_execution.yml"
      }
    },
    {
      "id": "24de4f3b-804c-4165-b442-5a06a2302c7e",
      "title": "Arbitrary Shell Command Execution Via Settingcontent-Ms",
      "status": "test",
      "description": "The .SettingContent-ms file type was introduced in Windows 10 and allows a user to create \"shortcuts\" to various Windows 10 setting pages. These files are simply XML and contain paths to various Windows 10 settings binaries.",
      "level": "medium",
      "tags": [
        "attack.t1204",
        "attack.t1566.001",
        "attack.execution",
        "attack.initial-access"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": ".SettingContent-ms",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "immersivecontrolpanel",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1204",
          "T1566.001"
        ],
        "tactics": [
          "execution",
          "initial_access"
        ]
      },
      "meta": {
        "author": "Sreeman",
        "date": "2020-03-13",
        "modified": "2022-04-14",
        "references": [
          "https://posts.specterops.io/the-tale-of-settingcontent-ms-files-f1ea253e4d39"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_arbitrary_shell_execution_via_settingcontent.yml"
      }
    },
    {
      "id": "41421f44-58f9-455d-838a-c398859841d4",
      "title": "ETW Logging Tamper In .NET Processes Via CommandLine",
      "status": "test",
      "description": "Detects changes to environment variables related to ETW logging via the CommandLine.\nThis could indicate potential adversaries stopping ETW providers recording loaded .NET assemblies.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "COMPlus_ETWEnabled",
                  "COMPlus_ETWFlags"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
        "date": "2020-05-02",
        "modified": "2022-12-09",
        "references": [
          "https://twitter.com/_xpn_/status/1268712093928378368",
          "https://social.msdn.microsoft.com/Forums/vstudio/en-US/0878832e-39d7-4eaf-8e16-a729c4c40975/what-can-i-use-e13c0d23ccbc4e12931bd9cc2eee27e4-for?forum=clr",
          "https://github.com/dotnet/runtime/blob/ee2355c801d892f2894b0f7b14a20e6cc50e0e54/docs/design/coreclr/jit/viewing-jit-dumps.md#setting-configuration-variables",
          "https://github.com/dotnet/runtime/blob/f62e93416a1799aecc6b0947adad55a0d9870732/src/coreclr/src/inc/clrconfigvalues.h#L35-L38",
          "https://github.com/dotnet/runtime/blob/7abe42dc1123722ed385218268bb9fe04556e3d3/src/coreclr/src/inc/clrconfig.h#L33-L39",
          "https://github.com/dotnet/runtime/search?p=1&q=COMPlus_&unscoped_q=COMPlus_",
          "https://bunnyinside.com/?term=f71e8cb9c76a",
          "http://managed670.rssing.com/chan-5590147/all_p1.html",
          "https://github.com/dotnet/runtime/blob/4f9ae42d861fcb4be2fcd5d3d55d5f227d30e723/docs/coding-guidelines/clr-jit-coding-conventions.md#1412-disabling-code",
          "https://i.blackhat.com/EU-21/Wednesday/EU-21-Teodorescu-Veni-No-Vidi-No-Vici-Attacks-On-ETW-Blind-EDRs.pdf"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_etw_modification_cmdline.yml"
      }
    },
    {
      "id": "84f52741-8834-4a8c-a413-2eb2269aa6c8",
      "title": "DllUnregisterServer Function Call Via Msiexec.EXE",
      "status": "test",
      "description": "Detects MsiExec loading a DLL and calling its DllUnregisterServer function",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.007"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\msiexec.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "\\msiexec.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_flag": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -z ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_dll": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": ".dll",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.007"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-04-24",
        "modified": "2024-03-13",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1218.007/T1218.007.md",
          "https://lolbas-project.github.io/lolbas/Binaries/Msiexec/",
          "https://twitter.com/_st0pp3r_/status/1583914515996897281"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_msiexec_dll.yml"
      }
    },
    {
      "id": "639c9081-f482-47d3-a0bd-ddee3d4ecd76",
      "title": "All Backups Deleted Via Wbadmin.EXE",
      "status": "test",
      "description": "Detects the deletion of all backups or system state backups via \"wbadmin.exe\".\nThis technique is used by numerous ransomware families and actors.\nThis may only be successful on server platforms that have Windows Backup enabled.\n",
      "level": "high",
      "tags": [
        "attack.impact",
        "attack.t1490"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\wbadmin.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "WBADMIN.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "delete",
                  "backup"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "keepVersions:0",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1490"
        ],
        "tactics": [
          "impact"
        ]
      },
      "meta": {
        "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2021-12-13",
        "modified": "2024-05-10",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1490/T1490.md#atomic-test-5---windows---delete-volume-shadow-copies-via-wmi-with-powershell",
          "https://github.com/albertzsigovits/malware-notes/blob/558898932c1579ff589290092a2c8febefc3a4c9/Ransomware/Lockbit.md",
          "https://www.sentinelone.com/labs/ranzy-ransomware-better-encryption-among-new-features-of-thunderx-derivative/",
          "https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/ransomware-report-avaddon-and-new-techniques-emerge-industrial-sector-targeted",
          "https://www.trendmicro.com/content/dam/trendmicro/global/en/research/24/b/lockbit-attempts-to-stay-afloat-with-a-new-version/technical-appendix-lockbit-ng-dev-analysis.pdf",
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wbadmin-delete-systemstatebackup"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wbadmin_delete_all_backups.yml"
      }
    },
    {
      "id": "5f60740a-f57b-4e76-82a1-15b6ff2cb134",
      "title": "Registry Modification Via Regini.EXE",
      "status": "test",
      "description": "Detects the execution of regini.exe which can be used to modify registry keys, the changes are imported from one or more text files.",
      "level": "low",
      "tags": [
        "attack.persistence",
        "attack.t1112",
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\regini.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "REGINI.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "CommandLine__re": {
                "field": "CommandLine",
                "value": ":[^ \\\\]",
                "modifiers": [
                  "re"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Eli Salem, Sander Wiebing, oscd.community",
        "date": "2020-10-08",
        "modified": "2023-02-08",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Regini/",
          "https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f",
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/regini"
        ],
        "falsepositives": [
          "Legitimate modification of keys"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_regini_execution.yml"
      }
    },
    {
      "id": "5b80a791-ad9b-4b75-bcc1-ad4e1e89c200",
      "title": "File With Suspicious Extension Downloaded Via Bitsadmin",
      "status": "test",
      "description": "Detects usage of bitsadmin downloading a file with a suspicious extension",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.persistence",
        "attack.t1197",
        "attack.s0190",
        "attack.t1036.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\bitsadmin.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "bitsadmin.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_flags": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " /transfer ",
                  " /create ",
                  " /addfile "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_extension": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ".7z",
                  ".asax",
                  ".ashx",
                  ".asmx",
                  ".asp",
                  ".aspx",
                  ".bat",
                  ".cfm",
                  ".cgi",
                  ".chm",
                  ".cmd",
                  ".dll",
                  ".gif",
                  ".jpeg",
                  ".jpg",
                  ".jsp",
                  ".jspx",
                  ".log",
                  ".png",
                  ".ps1",
                  ".psm1",
                  ".rar",
                  ".scf",
                  ".sct",
                  ".txt",
                  ".vbe",
                  ".vbs",
                  ".war",
                  ".wsf",
                  ".wsh",
                  ".xll",
                  ".zip"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1197",
          "T1036.003"
        ],
        "tactics": [
          "defense_evasion",
          "persistence"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-06-28",
        "modified": "2023-05-30",
        "references": [
          "https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin",
          "https://isc.sans.edu/diary/22264",
          "https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_bitsadmin_download_susp_extensions.yml"
      }
    },
    {
      "id": "1f0b4cac-9c81-41f4-95d0-8475ff46b3e2",
      "title": "PPL Tampering Via WerFaultSecure",
      "status": "experimental",
      "description": "Detects potential abuse of WerFaultSecure.exe to dump Protected Process Light (PPL) processes like LSASS or to freeze security solutions (EDR/antivirus).\nThis technique is used by tools such as EDR-Freeze and WSASS to bypass PPL protections and access sensitive information or disable security software.\nDistinct command line patterns help identify the specific tool:\n- WSASS usage typically shows: \"WSASS.exe WerFaultSecure.exe [PID]\" in ParentCommandLine\n- EDR-Freeze usage typically shows: \"EDR-Freeze_[version].exe [PID] [timeout]\" in ParentCommandLine\nLegitimate debugging operations using WerFaultSecure are rare in production environments and should be investigated.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001",
        "attack.credential-access",
        "attack.t1003.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_image": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\WerFaultSecure.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "WerFaultSecure.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_args": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " /h ",
                  " /pid ",
                  " /tid ",
                  " /encfile ",
                  " /cancel ",
                  " /type ",
                  " 268310"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001",
          "T1003.001"
        ],
        "tactics": [
          "defense_evasion",
          "credential_access"
        ]
      },
      "meta": {
        "author": "Jason (https://github.com/0xbcf)",
        "date": "2025-09-23",
        "modified": "2025-11-23",
        "references": [
          "https://www.zerosalarium.com/2025/09/EDR-Freeze-Puts-EDRs-Antivirus-Into-Coma.html",
          "https://github.com/TwoSevenOneT/EDR-Freeze/blob/a7f61030b36fbde89871f393488f7075d2aa89f6/EDR-Freeze.cpp#L53",
          "https://www.zerosalarium.com/2025/09/Dumping-LSASS-With-WER-On-Modern-Windows-11.html",
          "https://github.com/TwoSevenOneT/WSASS/blob/2c8fd9fa32143e7bc9f066e9511c6f8a57bc64b5/WSASS.cpp#L251"
        ],
        "falsepositives": [
          "Legitimate usage of WerFaultSecure for debugging purposes"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_werfaultsecure_abuse.yml"
      }
    },
    {
      "id": "84232095-ecca-4015-b0d7-7726507ee793",
      "title": "Suspicious DLL Loaded via CertOC.EXE",
      "status": "test",
      "description": "Detects when a user installs certificates by using CertOC.exe to load the target DLL file.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\certoc.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "CertOC.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -LoadDLL ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_paths": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\Appdata\\Local\\Temp\\",
                  "\\Desktop\\",
                  "\\Downloads\\",
                  "\\Users\\Public\\",
                  "C:\\Windows\\Tasks\\",
                  "C:\\Windows\\Temp\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-02-15",
        "modified": "2024-03-05",
        "references": [
          "https://twitter.com/sblmsrsn/status/1445758411803480072?s=20",
          "https://github.com/elastic/protections-artifacts/commit/746086721fd385d9f5c6647cada1788db4aea95f#diff-fe98e74189873d6df72a15df2eaa0315c59ba9cdaca93ecd68afc4ea09194ef2",
          "https://lolbas-project.github.io/lolbas/Binaries/Certoc/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_certoc_load_dll_susp_locations.yml"
      }
    },
    {
      "id": "48917adc-a28e-4f5d-b729-11e75da8941f",
      "title": "Suspicious Windows Defender Folder Exclusion Added Via Reg.EXE",
      "status": "test",
      "description": "Detects the usage of \"reg.exe\" to add Defender folder exclusions. Qbot has been seen using this technique to add exclusions for folders within AppData and ProgramData.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\reg.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "SOFTWARE\\Microsoft\\Windows Defender\\Exclusions\\Paths",
                  "SOFTWARE\\Microsoft\\Microsoft Antimalware\\Exclusions\\Paths"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "ADD ",
                  "/t ",
                  "REG_DWORD ",
                  "/v ",
                  "/d ",
                  "0"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-02-13",
        "modified": "2023-02-04",
        "references": [
          "https://thedfirreport.com/2022/02/07/qbot-likes-to-move-it-move-it/",
          "https://redcanary.com/threat-detection-report/threats/qbot/"
        ],
        "falsepositives": [
          "Legitimate use"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_reg_defender_exclusion.yml"
      }
    },
    {
      "id": "02b18447-ea83-4b1b-8805-714a8a34546a",
      "title": "Potential Mpclient.DLL Sideloading Via OfflineScannerShell.EXE Execution",
      "status": "test",
      "description": "Detects execution of Windows Defender \"OfflineScannerShell.exe\" from its non standard directory.\nThe \"OfflineScannerShell.exe\" binary is vulnerable to DLL side loading and will load any DLL named \"mpclient.dll\" from the current working directory.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\OfflineScannerShell.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "OfflineScannerShell.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_main_legit_dir": {
            "type": "field_match",
            "matchers": {
              "CurrentDirectory": {
                "field": "CurrentDirectory",
                "value": "C:\\Program Files\\Windows Defender\\Offline\\",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_empty": {
            "type": "field_match",
            "matchers": {
              "CurrentDirectory": {
                "field": "CurrentDirectory",
                "value": "",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_null": {
            "type": "field_match",
            "matchers": {
              "CurrentDirectory": {
                "field": "CurrentDirectory",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-03-06",
        "modified": "2023-08-03",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/OfflineScannerShell/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_offlinescannershell_mpclient_sideloading.yml"
      }
    },
    {
      "id": "9d7ca793-f6bd-471c-8d0f-11e68b2f0d2f",
      "title": "Computer System Reconnaissance Via Wmic.EXE",
      "status": "test",
      "description": "Detects execution of wmic utility with the \"computersystem\" flag in order to obtain information about the machine such as the domain, username, model, etc.",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.execution",
        "attack.t1047"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\wmic.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "wmic.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "computersystem",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1047"
        ],
        "tactics": [
          "discovery",
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-09-08",
        "modified": "2023-02-14",
        "references": [
          "https://www.microsoft.com/security/blog/2022/09/07/profiling-dev-0270-phosphorus-ransomware-operations/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wmic_recon_computersystem.yml"
      }
    },
    {
      "id": "56c217c3-2de2-479b-990f-5c109ba8458f",
      "title": "HackTool - Default PowerSploit/Empire Scheduled Task Creation",
      "status": "test",
      "description": "Detects the creation of a schtask via PowerSploit or Empire Default Configuration.",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.persistence",
        "attack.privilege-escalation",
        "attack.s0111",
        "attack.g0022",
        "attack.g0060",
        "car.2013-08-001",
        "attack.t1053.005",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\powershell.exe",
                  "\\pwsh.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\schtasks.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/Create",
                  "powershell.exe -NonI",
                  "/TN Updater /TR"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "/SC ONLOGON",
                  "/SC DAILY /ST",
                  "/SC ONIDLE",
                  "/SC HOURLY"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1053.005",
          "T1059.001"
        ],
        "tactics": [
          "execution",
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Markus Neis, @Karneades",
        "date": "2018-03-06",
        "modified": "2023-03-03",
        "references": [
          "https://github.com/0xdeadbeefJERKY/PowerSploit/blob/8690399ef70d2cad10213575ac67e8fa90ddf7c3/Persistence/Persistence.psm1",
          "https://github.com/EmpireProject/Empire/blob/08cbd274bef78243d7a8ed6443b8364acd1fc48b/lib/modules/powershell/persistence/userland/schtasks.py"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_powersploit_empire_default_schtasks.yml"
      }
    },
    {
      "id": "07e3cb2c-0608-410d-be4b-1511cb1a0448",
      "title": "Tamper Windows Defender Remove-MpPreference",
      "status": "test",
      "description": "Detects attempts to remove Windows Defender configurations using the 'MpPreference' cmdlet",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_remove": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "Remove-MpPreference",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_tamper": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "-ControlledFolderAccessProtectedFolders ",
                  "-AttackSurfaceReductionRules_Ids ",
                  "-AttackSurfaceReductionRules_Actions ",
                  "-CheckForSignaturesBeforeRunningScan "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-05",
        "modified": "",
        "references": [
          "https://techcommunity.microsoft.com/t5/core-infrastructure-and-security/windows-10-controlled-folder-access-event-search/ba-p/2326088"
        ],
        "falsepositives": [
          "Legitimate PowerShell scripts"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_remove_mppreference.yml"
      }
    },
    {
      "id": "b2b048b0-7857-4380-b0fb-d3f0ab820b71",
      "title": "Self Extracting Package Creation Via Iexpress.EXE From Potentially Suspicious Location",
      "status": "test",
      "description": "Detects the use of iexpress.exe to create binaries via Self Extraction Directive (SED) files located in potentially suspicious locations.\nThis behavior has been observed in-the-wild by different threat actors.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\iexpress.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "IEXPRESS.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " /n ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_paths": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ":\\ProgramData\\",
                  ":\\Temp\\",
                  ":\\Windows\\System32\\Tasks\\",
                  ":\\Windows\\Tasks\\",
                  ":\\Windows\\Temp\\",
                  "\\AppData\\Local\\Temp\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Joseliyo Sanchez, @Joseliyo_Jstnk, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2024-02-05",
        "modified": "2024-06-04",
        "references": [
          "https://strontic.github.io/xcyclopedia/library/iexpress.exe-D594B2A33EFAFD0EABF09E3FDC05FCEA.html",
          "https://en.wikipedia.org/wiki/IExpress",
          "https://decoded.avast.io/janvojtesek/raspberry-robins-roshtyak-a-little-lesson-in-trickery/",
          "https://www.virustotal.com/gui/file/602f4ae507fa8de57ada079adff25a6c2a899bd25cd092d0af7e62cdb619c93c/behavior"
        ],
        "falsepositives": [
          "Administrators building packages using iexpress.exe"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_iexpress_susp_execution.yml"
      }
    },
    {
      "id": "eca8ae39-5c3c-4321-b538-9e64fe25822e",
      "title": "Installation of WSL Kali-Linux",
      "status": "experimental",
      "description": "Detects installation of Kali Linux distribution through Windows Subsystem for Linux (WSL).\nAttackers may use Kali Linux WSL to leverage its penetration testing tools and capabilities for malicious purposes.\n",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_wsl_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\wsl.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "wsl",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_wsl_install": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " --install ",
                  " -i "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_wsl_kali": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "kali",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_wsl_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_wsl_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-10-10",
        "modified": "",
        "references": [
          "https://medium.com/@redfanatic7/running-kali-linux-on-windows-51ad95166e6e",
          "https://learn.microsoft.com/en-us/windows/wsl/install"
        ],
        "falsepositives": [
          "Legitimate installation or usage of Kali Linux WSL by administrators or security teams"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wsl_kali_linux_installation.yml"
      }
    },
    {
      "id": "6b369ced-4b1d-48f1-b427-fdc0de0790bd",
      "title": "Suspicious Diantz Alternate Data Stream Execution",
      "status": "test",
      "description": "Compress target file into a cab file stored in the Alternate Data Stream (ADS) of the target file.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1564.004"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "diantz.exe",
                  ".cab"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__re": {
                "field": "CommandLine",
                "value": ":[^\\\\]",
                "modifiers": [
                  "re"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1564.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-11-26",
        "modified": "2022-12-31",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Diantz/"
        ],
        "falsepositives": [
          "Very Possible"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_diantz_ads.yml"
      }
    },
    {
      "id": "2f869d59-7f6a-4931-992c-cce556ff2d53",
      "title": "Potential Adplus.EXE Abuse",
      "status": "test",
      "description": "Detects execution of \"AdPlus.exe\", a binary that is part of the Windows SDK that can be used as a LOLBIN in order to dump process memory and execute arbitrary commands.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.execution",
        "attack.credential-access",
        "attack.t1003.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\adplus.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "Adplus.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -hang ",
                  " -pn ",
                  " -pmn ",
                  " -p ",
                  " -po ",
                  " -c ",
                  " -sc "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.001"
        ],
        "tactics": [
          "defense_evasion",
          "execution",
          "credential_access"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-06-09",
        "modified": "2023-06-23",
        "references": [
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Adplus/",
          "https://twitter.com/nas_bench/status/1534916659676422152",
          "https://twitter.com/nas_bench/status/1534915321856917506"
        ],
        "falsepositives": [
          "Legitimate usage of Adplus for debugging purposes"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_adplus_memory_dump.yml"
      }
    },
    {
      "id": "44e24481-6202-4c62-9127-5a0ae8e3fe3d",
      "title": "Obfuscated PowerShell OneLiner Execution",
      "status": "test",
      "description": "Detects the execution of a specific OneLiner to download and execute powershell modules in memory.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.execution",
        "attack.t1059.001",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\powershell.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "http://127.0.0.1",
                  "%{(IRM $_)}",
                  "Invoke"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001",
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "@Kostastsale, TheDFIRReport",
        "date": "2022-05-09",
        "modified": "2025-04-16",
        "references": [
          "https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/",
          "https://gist.github.com/mgeeky/3b11169ab77a7de354f4111aa2f0df38"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_download_cradle_obfuscated.yml"
      }
    },
    {
      "id": "9c8c7000-3065-44a8-a555-79bcba5d9955",
      "title": "MSDT Execution Via Answer File",
      "status": "test",
      "description": "Detects execution of \"msdt.exe\" using an answer file which is simulating the legitimate way of calling msdt via \"pcwrun.exe\" (For example from the compatibility tab).\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218",
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\msdt.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "\\WINDOWS\\diagnostics\\index\\PCWDiagnostic.xml",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_1": {
                "field": "CommandLine",
                "value": " -af ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_pcwrun": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\pcwrun.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-06-13",
        "modified": "2025-10-29",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Msdt/"
        ],
        "falsepositives": [
          "Possible undocumented parents of \"msdt\" other than \"pcwrun\"."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_msdt_answer_file_exec.yml"
      }
    },
    {
      "id": "cd219ff3-fa99-45d4-8380-a7d15116c6dc",
      "title": "New User Created Via Net.EXE",
      "status": "test",
      "description": "Identifies the creation of local users via the net.exe command.",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.t1136.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\net.exe",
                      "\\net1.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "net.exe",
                      "net1.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "user",
                  "add"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1136.001"
        ],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "Endgame, JHasenbusch (adapted to Sigma for oscd.community)",
        "date": "2018-10-30",
        "modified": "2023-02-21",
        "references": [
          "https://eqllib.readthedocs.io/en/latest/analytics/014c3f51-89c6-40f1-ac9c-5688f26090ab.html",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1136.001/T1136.001.md"
        ],
        "falsepositives": [
          "Legitimate user creation.",
          "Better use event IDs for user creation rather than command line rules."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_net_user_add.yml"
      }
    },
    {
      "id": "f1f3bf22-deb2-418d-8cce-e1a45e46a5bd",
      "title": "MMC20 Lateral Movement",
      "status": "test",
      "description": "Detects MMC20.Application Lateral Movement; specifically looks for the spawning of the parent MMC.exe with a command line of \"-Embedding\" as a child of svchost.exe",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.lateral-movement",
        "attack.t1021.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\svchost.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\mmc.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-Embedding",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1021.003"
        ],
        "tactics": [
          "execution",
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "@2xxeformyshirt (Security Risk Advisors) - rule; Teymur Kheirkhabarov (idea)",
        "date": "2020-03-04",
        "modified": "2021-11-27",
        "references": [
          "https://enigma0x3.net/2017/01/05/lateral-movement-using-the-mmc20-application-com-object/",
          "https://drive.google.com/file/d/1lKya3_mLnR3UQuCoiYruO3qgu052_iS_/view?usp=sharing"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_mmc_mmc20_lateral_movement.yml"
      }
    },
    {
      "id": "758ff488-18d5-4cbe-8ec4-02b6285a434f",
      "title": "Remote Access Tool - NetSupport Execution",
      "status": "test",
      "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1219.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "NetSupport Client Configurator",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Product": {
                    "field": "Product",
                    "value": "NetSupport Remote Control",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Company": {
                    "field": "Company",
                    "value": "NetSupport Ltd",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "PCICFGUI.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1219.002"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-09-25",
        "modified": "2023-03-06",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md"
        ],
        "falsepositives": [
          "Legitimate use"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_remote_access_tools_netsupport.yml"
      }
    },
    {
      "id": "81a0ecb5-0a41-4ba1-b2ba-c944eb92bfa2",
      "title": "Add Insecure Download Source To Winget",
      "status": "test",
      "description": "Detects usage of winget to add a new insecure (http) download source.\nWinget will not allow the addition of insecure sources, hence this could indicate potential suspicious activity (or typos)\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.execution",
        "attack.t1059"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\winget.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "winget.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "source ",
                  "add ",
                  "http://"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-04-17",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/windows/package-manager/winget/source",
          "https://github.com/nasbench/Misc-Research/tree/b9596e8109dcdb16ec353f316678927e507a5b8d/LOLBINs/Winget"
        ],
        "falsepositives": [
          "False positives might occur if the users are unaware of such control checks"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_winget_add_insecure_custom_source.yml"
      }
    },
    {
      "id": "4f647cfa-b598-4e12-ad69-c68dd16caef8",
      "title": "DumpStack.log Defender Evasion",
      "status": "test",
      "description": "Detects the use of the filename DumpStack.log to evade Microsoft Defender",
      "level": "critical",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\DumpStack.log",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_download": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -o DumpStack.log",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-01-06",
        "modified": "2022-06-17",
        "references": [
          "https://twitter.com/mrd0x/status/1479094189048713219"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_dumpstack_log_evasion.yml"
      }
    },
    {
      "id": "4b046706-5789-4673-b111-66f25fe99534",
      "title": "Deleted Data Overwritten Via Cipher.EXE",
      "status": "test",
      "description": "Detects usage of the \"cipher\" built-in utility in order to overwrite deleted data from disk.\nAdversaries may destroy data and files on specific systems or in large numbers on a network to interrupt availability to systems, services, and network resources.\nData destruction is likely to render stored data irrecoverable by forensic techniques through overwriting files or data on local and remote drives\n",
      "level": "medium",
      "tags": [
        "attack.impact",
        "attack.t1485"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "CIPHER.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\cipher.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " /w:",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1485"
        ],
        "tactics": [
          "impact"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-12-26",
        "modified": "2023-02-21",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1485/T1485.md#atomic-test-3---overwrite-deleted-data-on-c-drive"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_cipher_overwrite_deleted_data.yml"
      }
    },
    {
      "id": "d95de845-b83c-4a9a-8a6a-4fc802ebf6c0",
      "title": "Suspicious Group And Account Reconnaissance Activity Using Net.EXE",
      "status": "test",
      "description": "Detects suspicious reconnaissance command line activity on Windows systems using Net.EXE\nCheck if the user that executed the commands is suspicious (e.g. service accounts, LOCAL_SYSTEM)\n",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.t1087.001",
        "attack.t1087.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\net.exe",
                      "\\net1.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "net.exe",
                      "net1.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_group_root": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " group ",
                  " localgroup "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_group_flags": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "domain admins",
                  " administrator",
                  " administrateur",
                  "enterprise admins",
                  "Exchange Trusted Subsystem",
                  "Remote Desktop Users",
                  "Utilisateurs du Bureau à distance",
                  "Usuarios de escritorio remoto",
                  " /do"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_accounts_root": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " accounts ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_accounts_flags": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " /do",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_group_add": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " /add",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection_img and ((all of selection_group_* and not filter_group_add) or all of selection_accounts_*)",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection_img and ((all of selection_group_* and not filter_group_add)",
            "all of selection_accounts_*)"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1087.001",
          "T1087.002"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), omkar72, @svch0st, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2019-01-16",
        "modified": "2023-03-02",
        "references": [
          "https://redcanary.com/blog/how-one-hospital-thwarted-a-ryuk-ransomware-outbreak/",
          "https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/",
          "https://research.nccgroup.com/2022/08/19/back-in-black-unlocking-a-lockbit-3-0-ransomware-attack/"
        ],
        "falsepositives": [
          "Inventory tool runs",
          "Administrative activity"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_net_groups_and_accounts_recon.yml"
      }
    },
    {
      "id": "ec88289a-7e1a-4cc3-8d18-bd1f60e4b9ba",
      "title": "Persistence Via TypedPaths - CommandLine",
      "status": "test",
      "description": "Detects modification addition to the 'TypedPaths' key in the user or admin registry via the commandline. Which might indicate persistence attempt",
      "level": "medium",
      "tags": [
        "attack.persistence"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\TypedPaths",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-22",
        "modified": "",
        "references": [
          "https://twitter.com/dez_/status/1560101453150257154",
          "https://forensafe.com/blogs/typedpaths.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_registry_typed_paths_persistence.yml"
      }
    },
    {
      "id": "9f546b25-5f12-4c8d-8532-5893dcb1e4b8",
      "title": "Potentially Suspicious Child Process Of DiskShadow.EXE",
      "status": "test",
      "description": "Detects potentially suspicious child processes of \"Diskshadow.exe\". This could be an attempt to bypass parent/child relationship detection or application whitelisting rules.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\diskshadow.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\certutil.exe",
                  "\\cscript.exe",
                  "\\mshta.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\regsvr32.exe",
                  "\\rundll32.exe",
                  "\\wscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-09-15",
        "modified": "",
        "references": [
          "https://bohops.com/2018/03/26/diskshadow-the-return-of-vss-evasion-persistence-and-active-directory-database-extraction/",
          "https://www.ired.team/offensive-security/credential-access-and-credential-dumping/ntds.dit-enumeration",
          "https://medium.com/@cyberjyot/lolbin-execution-via-diskshadow-f6ff681a27a4",
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/diskshadow",
          "https://www.lifars.com/wp-content/uploads/2022/01/GriefRansomware_Whitepaper-2.pdf",
          "https://www.zscaler.com/blogs/security-research/technical-analysis-crytox-ransomware",
          "https://research.checkpoint.com/2022/evilplayout-attack-against-irans-state-broadcaster/"
        ],
        "falsepositives": [
          "False postitve can occur in cases where admin scripts levreage the \"exec\" flag to execute applications"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_diskshadow_child_process_susp.yml"
      }
    },
    {
      "id": "c947b146-0abc-4c87-9c64-b17e9d7274a2",
      "title": "Shadow Copies Deletion Using Operating Systems Utilities",
      "status": "stable",
      "description": "Shadow Copies deletion using operating systems utilities",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.impact",
        "attack.t1070",
        "attack.t1490"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection1_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell.exe",
                      "\\pwsh.exe",
                      "\\wmic.exe",
                      "\\vssadmin.exe",
                      "\\diskshadow.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell.EXE",
                      "pwsh.dll",
                      "wmic.exe",
                      "VSSADMIN.EXE",
                      "diskshadow.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection1_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "shadow",
                  "delete"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection2_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\wbadmin.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "WBADMIN.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection2_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "delete",
                  "catalog",
                  "quiet"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection3_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\vssadmin.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "VSSADMIN.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection3_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "resize",
                  "shadowstorage"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "unbounded",
                  "/MaxSize="
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "(all of selection1*) or (all of selection2*) or (all of selection3*)",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "(all of selection1*)",
            "(all of selection2*)",
            "(all of selection3*)"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1070",
          "T1490"
        ],
        "tactics": [
          "defense_evasion",
          "impact"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Michael Haag, Teymur Kheirkhabarov, Daniil Yugoslavskiy, oscd.community, Andreas Hunkeler (@Karneades)",
        "date": "2019-10-22",
        "modified": "2022-11-03",
        "references": [
          "https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment",
          "https://blog.talosintelligence.com/2017/05/wannacry.html",
          "https://securingtomorrow.mcafee.com/other-blogs/mcafee-labs/new-teslacrypt-ransomware-arrives-via-spam/",
          "https://www.bleepingcomputer.com/news/security/why-everyone-should-disable-vssadmin-exe-now/",
          "https://www.hybrid-analysis.com/sample/ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa?environmentId=100",
          "https://github.com/Neo23x0/Raccine#the-process",
          "https://github.com/Neo23x0/Raccine/blob/20a569fa21625086433dcce8bb2765d0ea08dcb6/yara/gen_ransomware_command_lines.yar",
          "https://redcanary.com/blog/intelligence-insights-october-2021/",
          "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/blackbyte-exbyte-ransomware"
        ],
        "falsepositives": [
          "Legitimate Administrator deletes Shadow Copies using operating systems utilities for legitimate reason",
          "LANDesk LDClient Ivanti-PSModule (PS EncodedCommand)"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_shadow_copies_deletion.yml"
      }
    },
    {
      "id": "7cce6fc8-a07f-4d84-a53e-96e1879843c9",
      "title": "Potential Binary Impersonating Sysinternals Tools",
      "status": "test",
      "description": "Detects binaries that use the same name as legitimate sysinternals tools to evade detection.\nThis rule looks for the execution of binaries that are named similarly to Sysinternals tools.\nAdversary may rename their malicious tools as legitimate Sysinternals tools to evade detection.\n",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.defense-evasion",
        "attack.t1218",
        "attack.t1202",
        "attack.t1036.005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_exe": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\accesschk.exe",
                  "\\accesschk64.exe",
                  "\\AccessEnum.exe",
                  "\\ADExplorer.exe",
                  "\\ADExplorer64.exe",
                  "\\ADInsight.exe",
                  "\\ADInsight64.exe",
                  "\\adrestore.exe",
                  "\\adrestore64.exe",
                  "\\Autologon.exe",
                  "\\Autologon64.exe",
                  "\\Autoruns.exe",
                  "\\Autoruns64.exe",
                  "\\autorunsc.exe",
                  "\\autorunsc64.exe",
                  "\\Bginfo.exe",
                  "\\Bginfo64.exe",
                  "\\Cacheset.exe",
                  "\\Cacheset64.exe",
                  "\\Clockres.exe",
                  "\\Clockres64.exe",
                  "\\Contig.exe",
                  "\\Contig64.exe",
                  "\\Coreinfo.exe",
                  "\\Coreinfo64.exe",
                  "\\CPUSTRES.EXE",
                  "\\CPUSTRES64.EXE",
                  "\\ctrl2cap.exe",
                  "\\Dbgview.exe",
                  "\\dbgview64.exe",
                  "\\Desktops.exe",
                  "\\Desktops64.exe",
                  "\\disk2vhd.exe",
                  "\\disk2vhd64.exe",
                  "\\diskext.exe",
                  "\\diskext64.exe",
                  "\\Diskmon.exe",
                  "\\Diskmon64.exe",
                  "\\DiskView.exe",
                  "\\DiskView64.exe",
                  "\\du.exe",
                  "\\du64.exe",
                  "\\efsdump.exe",
                  "\\FindLinks.exe",
                  "\\FindLinks64.exe",
                  "\\handle.exe",
                  "\\handle64.exe",
                  "\\hex2dec.exe",
                  "\\hex2dec64.exe",
                  "\\junction.exe",
                  "\\junction64.exe",
                  "\\ldmdump.exe",
                  "\\listdlls.exe",
                  "\\listdlls64.exe",
                  "\\livekd.exe",
                  "\\livekd64.exe",
                  "\\loadOrd.exe",
                  "\\loadOrd64.exe",
                  "\\loadOrdC.exe",
                  "\\loadOrdC64.exe",
                  "\\logonsessions.exe",
                  "\\logonsessions64.exe",
                  "\\movefile.exe",
                  "\\movefile64.exe",
                  "\\notmyfault.exe",
                  "\\notmyfault64.exe",
                  "\\notmyfaultc.exe",
                  "\\notmyfaultc64.exe",
                  "\\ntfsinfo.exe",
                  "\\ntfsinfo64.exe",
                  "\\pendmoves.exe",
                  "\\pendmoves64.exe",
                  "\\pipelist.exe",
                  "\\pipelist64.exe",
                  "\\portmon.exe",
                  "\\procdump.exe",
                  "\\procdump64.exe",
                  "\\procexp.exe",
                  "\\procexp64.exe",
                  "\\Procmon.exe",
                  "\\Procmon64.exe",
                  "\\psExec.exe",
                  "\\psExec64.exe",
                  "\\psfile.exe",
                  "\\psfile64.exe",
                  "\\psGetsid.exe",
                  "\\psGetsid64.exe",
                  "\\psInfo.exe",
                  "\\psInfo64.exe",
                  "\\pskill.exe",
                  "\\pskill64.exe",
                  "\\pslist.exe",
                  "\\pslist64.exe",
                  "\\psLoggedon.exe",
                  "\\psLoggedon64.exe",
                  "\\psloglist.exe",
                  "\\psloglist64.exe",
                  "\\pspasswd.exe",
                  "\\pspasswd64.exe",
                  "\\psping.exe",
                  "\\psping64.exe",
                  "\\psService.exe",
                  "\\psService64.exe",
                  "\\psshutdown.exe",
                  "\\psshutdown64.exe",
                  "\\pssuspend.exe",
                  "\\pssuspend64.exe",
                  "\\RAMMap.exe",
                  "\\RAMMap64.exe",
                  "\\RDCMan.exe",
                  "\\RegDelNull.exe",
                  "\\RegDelNull64.exe",
                  "\\regjump.exe",
                  "\\ru.exe",
                  "\\ru64.exe",
                  "\\sdelete.exe",
                  "\\sdelete64.exe",
                  "\\ShareEnum.exe",
                  "\\ShareEnum64.exe",
                  "\\shellRunas.exe",
                  "\\sigcheck.exe",
                  "\\sigcheck64.exe",
                  "\\streams.exe",
                  "\\streams64.exe",
                  "\\strings.exe",
                  "\\strings64.exe",
                  "\\sync.exe",
                  "\\sync64.exe",
                  "\\Sysmon.exe",
                  "\\Sysmon64.exe",
                  "\\tcpvcon.exe",
                  "\\tcpvcon64.exe",
                  "\\tcpview.exe",
                  "\\tcpview64.exe",
                  "\\Testlimit.exe",
                  "\\Testlimit64.exe",
                  "\\vmmap.exe",
                  "\\vmmap64.exe",
                  "\\Volumeid.exe",
                  "\\Volumeid64.exe",
                  "\\whois.exe",
                  "\\whois64.exe",
                  "\\Winobj.exe",
                  "\\Winobj64.exe",
                  "\\ZoomIt.exe",
                  "\\ZoomIt64.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_arm64": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\accesschk64a.exe",
                  "\\ADExplorer64a.exe",
                  "\\ADInsight64a.exe",
                  "\\adrestore64a.exe",
                  "\\Autologon64a.exe",
                  "\\Autoruns64a.exe",
                  "\\autorunsc64a.exe",
                  "\\Clockres64a.exe",
                  "\\Contig64a.exe",
                  "\\Coreinfo64a.exe",
                  "\\Dbgview64a.exe",
                  "\\disk2vhd64a.exe",
                  "\\diskext64a.exe",
                  "\\DiskView64a.exe",
                  "\\du64a.exe",
                  "\\FindLinks64a.exe",
                  "\\handle64a.exe",
                  "\\hex2dec64a.exe",
                  "\\junction64a.exe",
                  "\\LoadOrd64a.exe",
                  "\\LoadOrdC64a.exe",
                  "\\logonsessions64a.exe",
                  "\\movefile64a.exe",
                  "\\notmyfault64a.exe",
                  "\\notmyfaultc64a.exe",
                  "\\pendmoves64a.exe",
                  "\\pipelist64a.exe",
                  "\\procdump64a.exe",
                  "\\procexp64a.exe",
                  "\\Procmon64a.exe",
                  "\\PsExec64a.exe",
                  "\\psfile64a.exe",
                  "\\PsGetsid64a.exe",
                  "\\PsInfo64a.exe",
                  "\\pskill64a.exe",
                  "\\psloglist64a.exe",
                  "\\pspasswd64a.exe",
                  "\\psping64a.exe",
                  "\\PsService64a.exe",
                  "\\pssuspend64a.exe",
                  "\\RAMMap64a.exe",
                  "\\RegDelNull64a.exe",
                  "\\ru64a.exe",
                  "\\sdelete64a.exe",
                  "\\sigcheck64a.exe",
                  "\\streams64a.exe",
                  "\\strings64a.exe",
                  "\\sync64a.exe",
                  "\\Sysmon64a.exe",
                  "\\tcpvcon64a.exe",
                  "\\tcpview64a.exe",
                  "\\vmmap64a.exe",
                  "\\whois64a.exe",
                  "\\Winobj64a.exe",
                  "\\ZoomIt64a.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_valid": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Company": {
                    "field": "Company",
                    "value": [
                      "Sysinternals - www.sysinternals.com",
                      "Sysinternals"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Product__startswith": {
                    "field": "Product",
                    "value": "Sysinternals",
                    "modifiers": [
                      "startswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "filter_empty": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Company": {
                    "field": "Company",
                    "value": null,
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Product": {
                    "field": "Product",
                    "value": null,
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "condition": "1 of selection_* and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "1 of selection_*"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218",
          "T1202",
          "T1036.005"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113, Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2021-12-20",
        "modified": "2025-04-12",
        "references": [
          "https://learn.microsoft.com/en-us/sysinternals/downloads/sysinternals-suite"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sysinternals_tools_masquerading.yml"
      }
    },
    {
      "id": "66e563f9-1cbd-4a22-a957-d8b7c0f44372",
      "title": "HackTool - XORDump Execution",
      "status": "test",
      "description": "Detects suspicious use of XORDump process memory dumping utility",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036",
        "attack.t1003.001",
        "attack.credential-access"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\xordump.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      " -process lsass.exe ",
                      " -m comsvcs ",
                      " -m dbghelp ",
                      " -m dbgcore "
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1036",
          "T1003.001"
        ],
        "tactics": [
          "defense_evasion",
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-01-28",
        "modified": "2023-02-08",
        "references": [
          "https://github.com/audibleblink/xordump"
        ],
        "falsepositives": [
          "Another tool that uses the command line switches of XORdump"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_xordump.yml"
      }
    },
    {
      "id": "9ef27c24-4903-4192-881a-3adde7ff92a5",
      "title": "Renamed Remote Utilities RAT (RURAT) Execution",
      "status": "test",
      "description": "Detects execution of renamed Remote Utilities (RURAT) via Product PE header field",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.collection",
        "attack.command-and-control",
        "attack.discovery",
        "attack.s0592"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Product": {
                "field": "Product",
                "value": "Remote Utilities",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\rutserv.exe",
                  "\\rfusclient.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion",
          "collection",
          "command_and_control",
          "discovery"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-09-19",
        "modified": "2023-02-03",
        "references": [
          "https://redcanary.com/blog/misbehaving-rats/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_renamed_rurat.yml"
      }
    },
    {
      "id": "7b6a7418-3afc-11f0-aff4-000d3abf478c",
      "title": "Obfuscated PowerShell MSI Install via WindowsInstaller COM",
      "status": "experimental",
      "description": "Detects the execution of obfuscated PowerShell commands that attempt to install MSI packages via the Windows Installer COM object (`WindowsInstaller.Installer`).\nThe technique involves manipulating strings to hide functionality, such as constructing class names using string insertion (e.g., 'indowsInstaller.Installer'.Insert(0,'W')) and correcting\nmalformed URLs (e.g., converting 'htps://' to 'https://') at runtime. This behavior is commonly associated with malware loaders or droppers that aim to bypass static detection\nby hiding intent in runtime-generated strings and using legitimate tools for code execution. The use of `InstallProduct` and COM object creation, particularly combined with\nhidden window execution and suppressed UI, indicates an attempt to install software (likely malicious) without user interaction.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027.010",
        "attack.t1218.007",
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell_ise.exe",
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell_ISE.EXE",
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "-ComObject",
                  "InstallProduct(",
                  ".Insert(",
                  "UILevel"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1027.010",
          "T1218.007",
          "T1059.001"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Meroujan Antonyan (vx3r)",
        "date": "2025-05-27",
        "modified": "",
        "references": [
          "https://informationsecuritybuzz.com/the-real-danger-behind-a-simple-windows-shortcut/",
          "https://redcanary.com/blog/threat-intelligence/intelligence-insights-may-2025/",
          "https://www.virustotal.com/gui/file/f9710b0ba4de5fa0e7ec27da462d4d2fc6838eba83a19f23f6617a466bbad457"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_comobject_msi.yml"
      }
    },
    {
      "id": "f2c64357-b1d2-41b7-849f-34d2682c0fad",
      "title": "Suspicious Command Patterns In Scheduled Task Creation",
      "status": "test",
      "description": "Detects scheduled task creation using \"schtasks\" that contain potentially suspicious or uncommon commands",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.execution",
        "attack.t1053.005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_schtasks": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\schtasks.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "/Create ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_pattern_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "/sc minute ",
                  "/ru system "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_pattern_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "cmd /c",
                  "cmd /k",
                  "cmd /r",
                  "cmd.exe /c ",
                  "cmd.exe /k ",
                  "cmd.exe /r "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_uncommon": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -decode ",
                  " -enc ",
                  " -w hidden ",
                  " bypass ",
                  " IEX",
                  ".DownloadData",
                  ".DownloadFile",
                  ".DownloadString",
                  "/c start /min ",
                  "FromBase64String",
                  "mshta http",
                  "mshta.exe http"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_anomaly_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ":\\ProgramData\\",
                  ":\\Temp\\",
                  ":\\Tmp\\",
                  ":\\Users\\Public\\",
                  ":\\Windows\\Temp\\",
                  "\\AppData\\",
                  "%AppData%",
                  "%Temp%",
                  "%tmp%"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_anomaly_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "cscript",
                  "curl",
                  "wscript"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_schtasks and ( all of selection_pattern_* or selection_uncommon or all of selection_anomaly_* )",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection_schtasks and ( all of selection_pattern_*",
            "selection_uncommon",
            "all of selection_anomaly_* )"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1053.005"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-02-23",
        "modified": "2024-03-19",
        "references": [
          "https://app.any.run/tasks/512c1352-6380-4436-b27d-bb62f0c020d6/",
          "https://twitter.com/RedDrip7/status/1506480588827467785",
          "https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/devil-bait/NCSC-MAR-Devil-Bait.pdf"
        ],
        "falsepositives": [
          "Software installers that run from temporary folders and also install scheduled tasks are expected to generate some false positives"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_schtasks_susp_pattern.yml"
      }
    },
    {
      "id": "1228c958-e64e-4e71-92ad-7d429f4138ba",
      "title": "Script Interpreter Execution From Suspicious Folder",
      "status": "test",
      "description": "Detects a suspicious script execution in temporary folders or folders accessible by environment variables",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_proc_image": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\cscript.exe",
                  "\\mshta.exe",
                  "\\wscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_proc_flags": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -ep bypass ",
                  " -ExecutionPolicy bypass ",
                  " -w hidden ",
                  "/e:javascript ",
                  "/e:Jscript ",
                  "/e:vbscript "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_proc_original": {
            "type": "field_match",
            "matchers": {
              "OriginalFileName": {
                "field": "OriginalFileName",
                "value": [
                  "cscript.exe",
                  "mshta.exe",
                  "wscript.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_folders_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ":\\Perflogs\\",
                  ":\\Users\\Public\\",
                  "\\AppData\\Local\\Temp",
                  "\\AppData\\Roaming\\Temp",
                  "\\Temporary Internet",
                  "\\Windows\\Temp"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_folders_2": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      ":\\Users\\",
                      "\\Favorites\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      ":\\Users\\",
                      "\\Favourites\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      ":\\Users\\",
                      "\\Contacts\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "1 of selection_proc_* and 1 of selection_folders_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "1 of selection_proc_*"
            },
            {
              "type": "ref",
              "value": "1 of selection_folders_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1059"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-02-08",
        "modified": "2023-06-16",
        "references": [
          "https://www.virustotal.com/gui/file/91ba814a86ddedc7a9d546e26f912c541205b47a853d227756ab1334ade92c3f",
          "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/shuckworm-russia-ukraine-military",
          "https://learn.microsoft.com/en-us/windows/win32/shell/csidl"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_script_exec_from_env_folder.yml"
      }
    },
    {
      "id": "44030449-b0df-4c94-aae1-502359ab28ee",
      "title": "PUA - TruffleHog Execution",
      "status": "experimental",
      "description": "Detects execution of TruffleHog, a tool used to search for secrets in different platforms like Git, Jira, Slack, SharePoint, etc. that could be used maliciously.\nWhile it is a legitimate tool, intended for use in CI pipelines and security assessments,\nIt was observed in the Shai-Hulud malware campaign targeting npm packages to steal sensitive information.\n",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.credential-access",
        "attack.t1083",
        "attack.t1552.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\trufflehog.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli_platform": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " docker --image ",
                  " Git ",
                  " GitHub ",
                  " Jira ",
                  " Slack ",
                  " Confluence ",
                  " SharePoint ",
                  " s3 ",
                  " gcs "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_verified": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " --results=verified",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_img or all of selection_cli_*",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection_img",
            "all of selection_cli_*"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1083",
          "T1552.001"
        ],
        "tactics": [
          "discovery",
          "credential_access"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-09-24",
        "modified": "",
        "references": [
          "https://github.com/trufflesecurity/trufflehog",
          "https://www.getsafety.com/blog-posts/shai-hulud-npm-attack"
        ],
        "falsepositives": [
          "Legitimate use of TruffleHog by security teams or developers."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_trufflehog.yml"
      }
    },
    {
      "id": "46123129-1024-423e-9fae-43af4a0fa9a5",
      "title": "File Download Via Windows Defender MpCmpRun.EXE",
      "status": "test",
      "description": "Detects the use of Windows Defender MpCmdRun.EXE to download files",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218",
        "attack.command-and-control",
        "attack.t1105"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "MpCmdRun.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\MpCmdRun.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": "MpCmdRun.exe",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "Microsoft Malware Protection Command Line Utility",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "DownloadFile",
                  "url"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218",
          "T1105"
        ],
        "tactics": [
          "defense_evasion",
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Matthew Matchen",
        "date": "2020-09-04",
        "modified": "2023-11-09",
        "references": [
          "https://web.archive.org/web/20200903194959/https://twitter.com/djmtshepana/status/1301608169496612866",
          "https://lolbas-project.github.io/lolbas/Binaries/MpCmdRun/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_mpcmdrun_download_arbitrary_file.yml"
      }
    },
    {
      "id": "efdd8dd5-cee8-4e59-9390-7d4d5e4dd6f6",
      "title": "Suspicious Program Names",
      "status": "test",
      "description": "Detects suspicious patterns in program names or folders that are often found in malicious samples or hacktools",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_image": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__contains": {
                    "field": "Image",
                    "value": [
                      "\\CVE-202",
                      "\\CVE202"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\poc.exe",
                      "\\artifact.exe",
                      "\\artifact64.exe",
                      "\\artifact_protected.exe",
                      "\\artifact32.exe",
                      "\\artifact32big.exe",
                      "obfuscated.exe",
                      "obfusc.exe",
                      "\\meterpreter"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_commandline": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "inject.ps1",
                  "Invoke-CVE",
                  "pupy.ps1",
                  "payload.ps1",
                  "beacon.ps1",
                  "PowerView.ps1",
                  "bypass.ps1",
                  "obfuscated.ps1",
                  "obfusc.ps1",
                  "obfus.ps1",
                  "obfs.ps1",
                  "evil.ps1",
                  "MiniDogz.ps1",
                  "_enc.ps1",
                  "\\shell.ps1",
                  "\\rshell.ps1",
                  "revshell.ps1",
                  "\\av.ps1",
                  "\\av_test.ps1",
                  "adrecon.ps1",
                  "mimikatz.ps1",
                  "\\PowerUp_",
                  "powerup.ps1",
                  "\\Temp\\a.ps1",
                  "\\Temp\\p.ps1",
                  "\\Temp\\1.ps1",
                  "Hound.ps1",
                  "encode.ps1",
                  "powercat.ps1"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-02-11",
        "modified": "2023-03-22",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1560.001/T1560.001.md"
        ],
        "falsepositives": [
          "Legitimate tools that accidentally match on the searched patterns"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_progname.yml"
      }
    },
    {
      "id": "f0e53e89-8d22-46ea-9db5-9d4796ee2f8a",
      "title": "Exports Registry Key To a File",
      "status": "test",
      "description": "Detects the export of the target Registry key to a file.",
      "level": "low",
      "tags": [
        "attack.exfiltration",
        "attack.discovery",
        "attack.t1012"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\regedit.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "REGEDIT.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -E ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "hklm",
                  "hkey_local_machine"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": [
                  "\\system",
                  "\\sam",
                  "\\security"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not all of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "all of selection_*"
            },
            {
              "type": "not",
              "value": "all of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1012"
        ],
        "tactics": [
          "exfiltration",
          "discovery"
        ]
      },
      "meta": {
        "author": "Oddvar Moe, Sander Wiebing, oscd.community",
        "date": "2020-10-07",
        "modified": "2024-03-13",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Regedit/",
          "https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f"
        ],
        "falsepositives": [
          "Legitimate export of keys"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_regedit_export_keys.yml"
      }
    },
    {
      "id": "2569ed8c-1147-498a-9b8c-2ad3656b10ed",
      "title": "Potential Renamed Rundll32 Execution",
      "status": "test",
      "description": "Detects when 'DllRegisterServer' is called in the commandline and the image is not rundll32. This could mean that the 'rundll32' utility has been renamed in order to avoid detection",
      "level": "high",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "DllRegisterServer",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\rundll32.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-22",
        "modified": "2023-02-03",
        "references": [
          "https://twitter.com/swisscom_csirt/status/1331634525722521602?s=20",
          "https://app.any.run/tasks/f74c5157-8508-4ac6-9805-d63fe7b0d399/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_renamed_rundll32_dllregisterserver.yml"
      }
    },
    {
      "id": "7f43c430-5001-4f8b-aaa9-c3b88f18fa5c",
      "title": "Execute From Alternate Data Streams",
      "status": "test",
      "description": "Detects execution from an Alternate Data Stream (ADS). Adversaries may use NTFS file attributes to hide their malicious data in order to evade detection",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1564.004"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_stream": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "txt:",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_tools_type": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "type ",
                  " > "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_tools_makecab": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "makecab ",
                  ".cab"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_tools_reg": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "reg ",
                  " export "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_tools_regedit": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "regedit ",
                  " /E "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_tools_esentutl": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "esentutl ",
                  " /y ",
                  " /d ",
                  " /o "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_stream and (1 of selection_tools_*)",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_stream"
            },
            {
              "type": "ref",
              "value": "(1 of selection_tools_*)"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1564.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-09-01",
        "modified": "2022-10-09",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1564.004/T1564.004.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_alternate_data_streams.yml"
      }
    },
    {
      "id": "c57872c7-614f-4d7f-a40d-b78c8df2d30d",
      "title": "Assembly Loading Via CL_LoadAssembly.ps1",
      "status": "test",
      "description": "Detects calls to \"LoadAssemblyFromPath\" or \"LoadAssemblyFromNS\" that are part of the \"CL_LoadAssembly.ps1\" script. This can be abused to load different assemblies and bypass App locker controls.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1216"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "LoadAssemblyFromPath ",
                  "LoadAssemblyFromNS "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1216"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-05-21",
        "modified": "2023-08-17",
        "references": [
          "https://bohops.com/2018/01/07/executing-commands-and-bypassing-applocker-with-powershell-diagnostic-scripts/",
          "https://lolbas-project.github.io/lolbas/Scripts/CL_LoadAssembly/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_cl_loadassembly.yml"
      }
    },
    {
      "id": "cf0c254b-22f1-4b2b-8221-e137b3c0af94",
      "title": "HackTool - Impersonate Execution",
      "status": "test",
      "description": "Detects execution of the Impersonate tool. Which can be used to manipulate tokens on a Windows computers remotely (PsExec/WmiExec) or interactively",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.defense-evasion",
        "attack.t1134.001",
        "attack.t1134.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_commandline_exe": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "impersonate.exe",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_commandline_opt": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " list ",
                  " exec ",
                  " adduser "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_hash": {
            "type": "field_match",
            "matchers": {
              "Hashes__contains": {
                "field": "Hashes",
                "value": [
                  "MD5=9520714AB576B0ED01D1513691377D01",
                  "SHA256=E81CC96E2118DC4FBFE5BAD1604E0AC7681960143E2101E1A024D52264BB0A8A",
                  "IMPHASH=0A358FFC1697B7A07D0E817AC740DF62"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_commandline_* or selection_hash",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "all of selection_commandline_*",
            "selection_hash"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1134.001",
          "T1134.003"
        ],
        "tactics": [
          "privilege_escalation",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Sai Prashanth Pulisetti @pulisettis",
        "date": "2022-12-21",
        "modified": "2024-11-23",
        "references": [
          "https://sensepost.com/blog/2022/abusing-windows-tokens-to-compromise-active-directory-without-touching-lsass/",
          "https://github.com/sensepost/impersonate"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_impersonate.yml"
      }
    },
    {
      "id": "b1ec66c6-f4d1-4b5c-96dd-af28ccae7727",
      "title": "New Generic Credentials Added Via Cmdkey.EXE",
      "status": "test",
      "description": "Detects usage of \"cmdkey.exe\" to add generic credentials.\nAs an example, this can be used before connecting to an RDP session via command line interface.\n",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.t1003.005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\cmdkey.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "cmdkey.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_generic": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -g",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli_user": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -u",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli_password": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -p",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.005"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-02-03",
        "modified": "2024-03-05",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1021.001/T1021.001.md#t1021001---remote-desktop-protocol"
        ],
        "falsepositives": [
          "Legitimate usage for administration purposes"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_cmdkey_adding_generic_creds.yml"
      }
    },
    {
      "id": "c1d867fe-8d95-4487-aab4-e53f2d339f90",
      "title": "Renamed Sysinternals Sdelete Execution",
      "status": "test",
      "description": "Detects the use of a renamed SysInternals Sdelete, which is something an administrator shouldn't do (the renaming)",
      "level": "high",
      "tags": [
        "attack.impact",
        "attack.t1485"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "OriginalFileName": {
                "field": "OriginalFileName",
                "value": "sdelete.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\sdelete.exe",
                  "\\sdelete64.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1485"
        ],
        "tactics": [
          "impact"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-09-06",
        "modified": "2023-02-03",
        "references": [
          "https://learn.microsoft.com/en-us/sysinternals/downloads/sdelete",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1485/T1485.md"
        ],
        "falsepositives": [
          "System administrator usage"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_renamed_sysinternals_sdelete.yml"
      }
    },
    {
      "id": "5394fcc7-aeb2-43b5-9a09-cac9fc5edcd5",
      "title": "Suspicious Execution Location Of Wermgr.EXE",
      "status": "test",
      "description": "Detects suspicious Windows Error Reporting manager (wermgr.exe) execution location.",
      "level": "high",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\wermgr.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_legit_location": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Windows\\System32\\",
                  "C:\\Windows\\SysWOW64\\",
                  "C:\\Windows\\WinSxS\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-10-14",
        "modified": "2023-08-23",
        "references": [
          "https://www.trendmicro.com/en_us/research/22/j/black-basta-infiltrates-networks-via-qakbot-brute-ratel-and-coba.html",
          "https://www.echotrail.io/insights/search/wermgr.exe",
          "https://github.com/binderlabs/DirCreate2System"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wermgr_susp_exec_location.yml"
      }
    },
    {
      "id": "18ee686c-38a3-4f65-9f44-48a077141f42",
      "title": "Uncommon Extension Shim Database Installation Via Sdbinst.EXE",
      "status": "test",
      "description": "Detects installation of a potentially suspicious new shim with an uncommon extension using sdbinst.exe.\nAdversaries may establish persistence and/or elevate privileges by executing malicious content triggered by application shims\n",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.privilege-escalation",
        "attack.t1546.011"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\sdbinst.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "sdbinst.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_main_legit_ext": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": ".sdb",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_legit_extensions": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__endswith": {
                    "field": "CommandLine",
                    "value": [
                      " -c",
                      " -f",
                      " -mm",
                      " -t"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": " -m -bg",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "filter_main_null": {
            "type": "field_match",
            "matchers": {
              "CommandLine": {
                "field": "CommandLine",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_empty": {
            "type": "field_match",
            "matchers": {
              "CommandLine": {
                "field": "CommandLine",
                "value": "",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1546.011"
        ],
        "tactics": [
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-08-01",
        "modified": "2024-01-10",
        "references": [
          "https://www.fireeye.com/blog/threat-research/2017/05/fin7-shim-databases-persistence.html",
          "https://github.com/nasbench/Misc-Research/blob/8ee690e43a379cbce8c9d61107442c36bd9be3d3/Other/Undocumented-Flags-Sdbinst.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sdbinst_susp_extension.yml"
      }
    },
    {
      "id": "4e2ed651-1906-4a59-a78a-18220fca1b22",
      "title": "PUA - NirCmd Execution",
      "status": "test",
      "description": "Detects the use of NirCmd tool for command execution, which could be the result of legitimate administrative activity",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1569.002",
        "attack.s0029"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_org": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\NirCmd.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "NirCmd.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cmd": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " execmd ",
                  ".exe script ",
                  ".exe shexec ",
                  " runinteractive "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "combo_exec": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " exec ",
                  " exec2 "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "combo_exec_params": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " show ",
                  " hide "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_* or all of combo_*",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "1 of selection_*",
            "all of combo_*"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1569.002"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-01-24",
        "modified": "2023-02-13",
        "references": [
          "https://www.nirsoft.net/utils/nircmd.html",
          "https://www.winhelponline.com/blog/run-program-as-system-localsystem-account-windows/",
          "https://www.nirsoft.net/utils/nircmd2.html#using"
        ],
        "falsepositives": [
          "Legitimate use by administrators"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_nircmd.yml"
      }
    },
    {
      "id": "f7b5f842-a6af-4da5-9e95-e32478f3cd2f",
      "title": "MsiExec Web Install",
      "status": "test",
      "description": "Detects suspicious msiexec process starts with web addresses as parameter",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.007",
        "attack.command-and-control",
        "attack.t1105"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " msiexec",
                  "://"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.007",
          "T1105"
        ],
        "tactics": [
          "defense_evasion",
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2018-02-09",
        "modified": "2022-01-07",
        "references": [
          "https://blog.trendmicro.com/trendlabs-security-intelligence/attack-using-windows-installer-msiexec-exe-leads-lokibot/"
        ],
        "falsepositives": [
          "False positives depend on scripts and administrative tools used in the monitored environment"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_msiexec_web_install.yml"
      }
    },
    {
      "id": "f956c7c1-0f60-4bc5-b7d7-b39ab3c08908",
      "title": "PktMon.EXE Execution",
      "status": "test",
      "description": "Detects execution of PktMon, a tool that captures network packets.",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.credential-access",
        "attack.t1040"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\pktmon.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "PktMon.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1040"
        ],
        "tactics": [
          "discovery",
          "credential_access"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-03-17",
        "modified": "2023-06-23",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Pktmon/"
        ],
        "falsepositives": [
          "Legitimate use"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pktmon_execution.yml"
      }
    },
    {
      "id": "0900463c-b33b-49a8-be1d-552a3b553dae",
      "title": "Potential Hidden Directory Creation Via NTFS INDEX_ALLOCATION Stream - CLI",
      "status": "test",
      "description": "Detects command line containing reference to the \"::$index_allocation\" stream, which can be used as a technique to prevent access to folders or files from tooling such as \"explorer.exe\" or \"powershell.exe\"\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1564.004"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "::$index_allocation",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1564.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), Scoubi (@ScoubiMtl)",
        "date": "2023-10-09",
        "modified": "",
        "references": [
          "https://twitter.com/pfiatde/status/1681977680688738305",
          "https://soroush.me/blog/2010/12/a-dotty-salty-directory-a-secret-place-in-ntfs-for-secret-files/",
          "https://sec-consult.com/blog/detail/pentesters-windows-ntfs-tricks-collection/",
          "https://github.com/redcanaryco/atomic-red-team/blob/5c3b23002d2bbede3c07e7307165fc2a235a427d/atomics/T1564.004/T1564.004.md#atomic-test-5---create-hidden-directory-via-index_allocation",
          "https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-fscc/c54dec26-1551-4d3a-a0ea-4fa40f848eb3"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_hidden_dir_index_allocation.yml"
      }
    },
    {
      "id": "cec8e918-30f7-4e2d-9bfa-a59cc97ae60f",
      "title": "OpenWith.exe Executes Specified Binary",
      "status": "test",
      "description": "The OpenWith.exe executes other binary",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\OpenWith.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "/c",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Beyu Denis, oscd.community (rule), @harr0ey (idea)",
        "date": "2019-10-12",
        "modified": "2021-11-27",
        "references": [
          "https://github.com/LOLBAS-Project/LOLBAS/blob/4db780e0f0b2e2bb8cb1fa13e09196da9b9f1834/yml/LOLUtilz/OSBinaries/Openwith.yml",
          "https://twitter.com/harr0ey/status/991670870384021504"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_openwith.yml"
      }
    },
    {
      "id": "9ac94dc8-9042-493c-ba45-3b5e7c86b980",
      "title": "Disable Important Scheduled Task",
      "status": "test",
      "description": "Detects when adversaries stop services or processes by disabling their respective scheduled tasks in order to conduct data destructive activities",
      "level": "high",
      "tags": [
        "attack.impact",
        "attack.t1489"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\schtasks.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/Change",
                  "/TN",
                  "/disable"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\Windows\\BitLocker",
                  "\\Windows\\ExploitGuard",
                  "\\Windows\\ExploitGuard\\ExploitGuard MDM policy Refresh",
                  "\\Windows\\SystemRestore\\SR",
                  "\\Windows\\UpdateOrchestrator\\",
                  "\\Windows\\Windows Defender\\",
                  "\\Windows\\WindowsBackup\\",
                  "\\Windows\\WindowsUpdate\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1489"
        ],
        "tactics": [
          "impact"
        ]
      },
      "meta": {
        "author": "frack113, Nasreddine Bencherchali (Nextron Systems), X__Junior",
        "date": "2021-12-26",
        "modified": "2024-08-25",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1490/T1490.md#atomic-test-8---windows---disable-the-sr-scheduled-task",
          "https://twitter.com/MichalKoczwara/status/1553634816016498688",
          "https://thedfirreport.com/2021/10/18/icedid-to-xinglocker-ransomware-in-24-hours/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_schtasks_disable.yml"
      }
    },
    {
      "id": "d047726b-c71c-4048-a99b-2e2f50dc107d",
      "title": "Kavremover Dropped Binary LOLBIN Usage",
      "status": "test",
      "description": "Detects the execution of a signed binary dropped by Kaspersky Lab Products Remover (kavremover) which can be abused as a LOLBIN to execute arbitrary commands and binaries.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1127"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " run run-cmd ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_legit_parents": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\cleanapi.exe",
                  "\\kavremover.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1127"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-11-01",
        "modified": "",
        "references": [
          "https://nasbench.medium.com/lolbined-using-kaspersky-endpoint-security-kes-installer-to-execute-arbitrary-commands-1c999f1b7fea"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_kavremover_uncommon_execution.yml"
      }
    },
    {
      "id": "dfa03a09-8b92-4d83-8e74-f72839b1c407",
      "title": "Potentially Suspicious Child Processes Spawned by ConHost",
      "status": "experimental",
      "description": "Detects suspicious child processes related to Windows Shell utilities spawned by `conhost.exe`, which could indicate malicious activity using trusted system components.",
      "level": "high",
      "tags": [
        "attack.t1202",
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\conhost.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_child": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\cmd.exe",
                      "\\cscript.exe",
                      "\\mshta.exe",
                      "\\powershell_ise.exe",
                      "\\powershell.exe",
                      "\\pwsh.exe",
                      "\\regsvr32.exe",
                      "\\wscript.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "cmd.exe",
                      "cscript.exe",
                      "mshta.exe",
                      "powershell_ise.exe",
                      "powershell.exe",
                      "pwsh.dll",
                      "regsvr32.exe",
                      "wscript.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1202",
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-02-05",
        "modified": "",
        "references": [
          "https://tria.ge/241015-l98snsyeje/behavioral2"
        ],
        "falsepositives": [
          "Legitimate administrative tasks using `conhost.exe` to spawn child processes such as `cmd.exe`, `powershell.exe`, or `regsvr32.exe`."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_conhost_susp_winshell_child_process.yml"
      }
    },
    {
      "id": "5cb299fc-5fb1-4d07-b989-0644c68b6043",
      "title": "Suspicious File Download From IP Via Curl.EXE",
      "status": "test",
      "description": "Detects potentially suspicious file downloads directly from IP addresses using curl.exe",
      "level": "high",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\curl.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "curl.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_ip": {
            "type": "field_match",
            "matchers": {
              "CommandLine__re": {
                "field": "CommandLine",
                "value": "://[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}",
                "modifiers": [
                  "re"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_http": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "http",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_flag": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -O",
                  "--remote-name",
                  "--output"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_ext": {
            "type": "field_match",
            "matchers": {
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": [
                  ".bat",
                  ".bat\"",
                  ".dat",
                  ".dat\"",
                  ".dll",
                  ".dll\"",
                  ".exe",
                  ".exe\"",
                  ".gif",
                  ".gif\"",
                  ".hta",
                  ".hta\"",
                  ".jpeg",
                  ".jpeg\"",
                  ".log",
                  ".log\"",
                  ".msi",
                  ".msi\"",
                  ".png",
                  ".png\"",
                  ".ps1",
                  ".ps1\"",
                  ".psm1",
                  ".psm1\"",
                  ".vbe",
                  ".vbe\"",
                  ".vbs",
                  ".vbs\"",
                  ".bat'",
                  ".dat'",
                  ".dll'",
                  ".exe'",
                  ".gif'",
                  ".hta'",
                  ".jpeg'",
                  ".log'",
                  ".msi'",
                  ".png'",
                  ".ps1'",
                  ".psm1'",
                  ".vbe'",
                  ".vbs'"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-07-27",
        "modified": "",
        "references": [
          "https://labs.withsecure.com/publications/fin7-target-veeam-servers",
          "https://github.com/WithSecureLabs/iocs/blob/344203de742bb7e68bd56618f66d34be95a9f9fc/FIN7VEEAM/iocs.csv",
          "https://github.com/pr0xylife/IcedID/blob/8dd1e218460db4f750d955b4c65b2f918a1db906/icedID_09.28.2023.txt"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_curl_download_direct_ip_susp_extensions.yml"
      }
    },
    {
      "id": "27ee9438-90dc-4bef-904b-d3ef927f5e7e",
      "title": "Windows Kernel Debugger Execution",
      "status": "test",
      "description": "Detects execution of the Windows Kernel Debugger \"kd.exe\".",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\kd.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "kd.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-15",
        "modified": "2024-04-24",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Rare occasions of legitimate cases where kernel debugging is necessary in production. Investigation is required"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_kd_execution.yml"
      }
    },
    {
      "id": "0d34ed8b-1c12-4ff2-828c-16fc860b766d",
      "title": "Suspicious Processes Spawned by Java.EXE",
      "status": "test",
      "description": "Detects suspicious processes spawned from a Java host process which could indicate a sign of exploitation (e.g. log4j)",
      "level": "high",
      "tags": [
        "attack.initial-access",
        "attack.persistence",
        "attack.privilege-escalation"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\java.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\AppVLP.exe",
                  "\\bitsadmin.exe",
                  "\\certutil.exe",
                  "\\cscript.exe",
                  "\\curl.exe",
                  "\\forfiles.exe",
                  "\\hh.exe",
                  "\\mftrace.exe",
                  "\\mshta.exe",
                  "\\net.exe",
                  "\\net1.exe",
                  "\\query.exe",
                  "\\reg.exe",
                  "\\regsvr32.exe",
                  "\\rundll32.exe",
                  "\\schtasks.exe",
                  "\\scrcons.exe",
                  "\\scriptrunner.exe",
                  "\\sh.exe",
                  "\\systeminfo.exe",
                  "\\whoami.exe",
                  "\\wmic.exe",
                  "\\wscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "initial_access",
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Andreas Hunkeler (@Karneades), Florian Roth",
        "date": "2021-12-17",
        "modified": "2024-01-18",
        "references": [
          "https://web.archive.org/web/20231230220738/https://www.lunasec.io/docs/blog/log4j-zero-day/"
        ],
        "falsepositives": [
          "Legitimate calls to system binaries",
          "Company specific internal usage"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_java_susp_child_process.yml"
      }
    },
    {
      "id": "f24bcaea-0cd1-11eb-adc1-0242ac120002",
      "title": "Uncommon  Assistive Technology Applications Execution Via AtBroker.EXE",
      "status": "test",
      "description": "Detects the start of a non built-in assistive technology applications via \"Atbroker.EXE\".",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\AtBroker.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "AtBroker.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "start",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_builtin": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "animations",
                  "audiodescription",
                  "caretbrowsing",
                  "caretwidth",
                  "colorfiltering",
                  "cursorindicator",
                  "cursorscheme",
                  "filterkeys",
                  "focusborderheight",
                  "focusborderwidth",
                  "highcontrast",
                  "keyboardcues",
                  "keyboardpref",
                  "livecaptions",
                  "magnifierpane",
                  "messageduration",
                  "minimumhitradius",
                  "mousekeys",
                  "Narrator",
                  "osk",
                  "overlappedcontent",
                  "showsounds",
                  "soundsentry",
                  "speechreco",
                  "stickykeys",
                  "togglekeys",
                  "voiceaccess",
                  "windowarranging",
                  "windowtracking",
                  "windowtrackingtimeout",
                  "windowtrackingzorder"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_java": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "Oracle_JavaAccessBridge",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "all of selection_*"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Mateusz Wydra, oscd.community",
        "date": "2020-10-12",
        "modified": "2024-03-06",
        "references": [
          "http://www.hexacorn.com/blog/2016/07/22/beyond-good-ol-run-key-part-42/",
          "https://lolbas-project.github.io/lolbas/Binaries/Atbroker/"
        ],
        "falsepositives": [
          "Legitimate, non-default assistive technology applications execution"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_atbroker_uncommon_ats_execution.yml"
      }
    },
    {
      "id": "164eda96-11b2-430b-85ff-6a265c15bf32",
      "title": "Local Groups Reconnaissance Via Wmic.EXE",
      "status": "test",
      "description": "Detects the execution of \"wmic\" with the \"group\" flag.\nAdversaries may attempt to find local system groups and permission settings.\nThe knowledge of local system permission groups can help adversaries determine which groups exist and which users belong to a particular group.\nAdversaries may use this information to determine which users have elevated permissions, such as the users found within the local administrators group.\n",
      "level": "low",
      "tags": [
        "attack.discovery",
        "attack.t1069.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\wmic.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "wmic.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " group",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1069.001"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-12-12",
        "modified": "2023-02-14",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1069.001/T1069.001.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wmic_recon_group.yml"
      }
    },
    {
      "id": "9f8fc146-1d1a-4dbf-b8fd-dfae15e08541",
      "title": "HackTool - SharpLDAPmonitor Execution",
      "status": "test",
      "description": "Detects execution of the SharpLDAPmonitor. Which can monitor the creation, deletion and changes to LDAP objects.",
      "level": "medium",
      "tags": [
        "attack.discovery"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\SharpLDAPmonitor.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "SharpLDAPmonitor.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/user:",
                  "/pass:",
                  "/dcip:"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-12-30",
        "modified": "2023-02-14",
        "references": [
          "https://github.com/p0dalirius/LDAPmonitor"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_sharp_ldap_monitor.yml"
      }
    },
    {
      "id": "d2b749ee-4225-417e-b20e-a8d2193cbb84",
      "title": "PUA - AdvancedRun Execution",
      "status": "test",
      "description": "Detects the execution of AdvancedRun utility",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1564.003",
        "attack.t1134.002",
        "attack.t1059.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "AdvancedRun.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      " /EXEFilename ",
                      " /Run"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      " /WindowState 0",
                      " /RunAs ",
                      " /CommandLine "
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1564.003",
          "T1134.002",
          "T1059.003"
        ],
        "tactics": [
          "execution",
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-01-20",
        "modified": "2023-02-21",
        "references": [
          "https://twitter.com/splinter_code/status/1483815103279603714",
          "https://medium.com/s2wblog/analysis-of-destructive-malware-whispergate-targeting-ukraine-9d5d158f19f3",
          "https://www.elastic.co/security-labs/operation-bleeding-bear",
          "https://www.winhelponline.com/blog/run-program-as-system-localsystem-account-windows/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_advancedrun.yml"
      }
    },
    {
      "id": "53d8d3e1-ca33-4012-adf3-e05a4d652e34",
      "title": "Process Memory Dump Via Dotnet-Dump",
      "status": "test",
      "description": "Detects the execution of \"dotnet-dump\" with the \"collect\" flag. The execution could indicate potential process dumping of critical processes such as LSASS.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\dotnet-dump.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "dotnet-dump.dll",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "collect",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-03-14",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/dotnet/core/diagnostics/dotnet-dump#dotnet-dump-collect",
          "https://twitter.com/bohops/status/1635288066909966338"
        ],
        "falsepositives": [
          "Process dumping is the expected behavior of the tool. So false positives are expected in legitimate usage. The PID/Process Name of the process being dumped needs to be investigated"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_dotnetdump_memory_dump.yml"
      }
    },
    {
      "id": "a6a39bdb-935c-4f0a-ab77-35f4bbf44d33",
      "title": "Suspicious Script Execution From Temp Folder",
      "status": "test",
      "description": "Detects a suspicious script executions from temporary folder",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\mshta.exe",
                  "\\wscript.exe",
                  "\\cscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\Windows\\Temp",
                  "\\Temporary Internet",
                  "\\AppData\\Local\\Temp",
                  "\\AppData\\Roaming\\Temp",
                  "%TEMP%",
                  "%TMP%",
                  "%LocalAppData%\\Temp"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " >",
                  "Out-File",
                  "ConvertTo-Json",
                  "-WindowStyle hidden -Verb runAs",
                  "\\Windows\\system32\\config\\systemprofile\\AppData\\Local\\Temp\\Amazon\\EC2-Windows\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1059"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Max Altgelt (Nextron Systems), Tim Shelton",
        "date": "2021-07-14",
        "modified": "2022-10-05",
        "references": [
          "https://www.microsoft.com/security/blog/2021/07/13/microsoft-discovers-threat-actor-targeting-solarwinds-serv-u-software-with-0-day-exploit/"
        ],
        "falsepositives": [
          "Administrative scripts"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_script_exec_from_temp.yml"
      }
    },
    {
      "id": "b0ce780f-10bd-496d-9067-066d23dc3aa5",
      "title": "HackTool - SharpWSUS/WSUSpendu Execution",
      "status": "test",
      "description": "Detects the execution of SharpWSUS or WSUSpendu, utilities that allow for lateral movement through WSUS.\nWindows Server Update Services (WSUS) is a critical component of Windows systems and is frequently configured in a way that allows an attacker to circumvent internal networking limitations.\n",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.lateral-movement",
        "attack.t1210"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_wsuspendu_inject": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -Inject ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_wsuspendu_payload": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -PayloadArgs ",
                  " -PayloadFile "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_sharpwsus_commands": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " approve ",
                  " create ",
                  " check ",
                  " delete "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_sharpwsus_flags": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " /payload:",
                  " /payload=",
                  " /updateid:",
                  " /updateid="
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_wsuspendu_* or all of selection_sharpwsus_*",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "all of selection_wsuspendu_*",
            "all of selection_sharpwsus_*"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1210"
        ],
        "tactics": [
          "execution",
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "@Kostastsale, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-10-07",
        "modified": "2024-08-23",
        "references": [
          "https://labs.nettitude.com/blog/introducing-sharpwsus/",
          "https://github.com/nettitude/SharpWSUS",
          "https://web.archive.org/web/20210512154016/https://github.com/AlsidOfficial/WSUSpendu/blob/master/WSUSpendu.ps1"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_sharpwsus_wsuspendu_execution.yml"
      }
    },
    {
      "id": "01d2e2a1-5f09-44f7-9fc1-24faa7479b6d",
      "title": "Uncommon Svchost Parent Process",
      "status": "test",
      "description": "Detects an uncommon svchost parent process",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036.005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\svchost.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_generic": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\Mrt.exe",
                  "\\MsMpEng.exe",
                  "\\ngen.exe",
                  "\\rpcnet.exe",
                  "\\services.exe",
                  "\\TiWorker.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_parent_null": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_parent_empty": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": [
                  "-",
                  ""
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1036.005"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2017-08-15",
        "modified": "2022-06-28",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_svchost_uncommon_parent_process.yml"
      }
    },
    {
      "id": "e9f55347-2928-4c06-88e5-1a7f8169942e",
      "title": "Invoke-Obfuscation VAR++ LAUNCHER OBFUSCATION",
      "status": "test",
      "description": "Detects Obfuscated Powershell via VAR++ LAUNCHER",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027",
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "&&set",
                  "cmd",
                  "/c",
                  "-f"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "{0}",
                  "{1}",
                  "{2}",
                  "{3}",
                  "{4}",
                  "{5}"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1027",
          "T1059.001"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Timur Zinniatullin, oscd.community",
        "date": "2020-10-13",
        "modified": "2022-11-16",
        "references": [
          "https://github.com/SigmaHQ/sigma/issues/1009"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_invoke_obfuscation_via_var.yml"
      }
    },
    {
      "id": "fa3c117a-bc0d-416e-a31b-0c0e80653efb",
      "title": "Chopper Webshell Process Pattern",
      "status": "test",
      "description": "Detects patterns found in process executions cause by China Chopper like tiny (ASPX) webshells",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.discovery",
        "attack.t1505.003",
        "attack.t1018",
        "attack.t1033",
        "attack.t1087"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_origin": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\w3wp.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "ParentImage__endswith": {
                    "field": "ParentImage",
                    "value": "\\w3wp.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cmdline": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "&ipconfig&echo",
                  "&quser&echo",
                  "&whoami&echo",
                  "&c:&echo",
                  "&cd&echo",
                  "&dir&echo",
                  "&echo [E]",
                  "&echo [S]"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1505.003",
          "T1018",
          "T1033",
          "T1087"
        ],
        "tactics": [
          "persistence",
          "discovery"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), MSTI (query)",
        "date": "2022-10-01",
        "modified": "",
        "references": [
          "https://www.microsoft.com/security/blog/2022/09/30/analyzing-attacks-using-the-exchange-vulnerabilities-cve-2022-41040-and-cve-2022-41082/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_webshell_chopper.yml"
      }
    },
    {
      "id": "b19146a3-25d4-41b4-928b-1e2a92641b1b",
      "title": "Remote Access Tool - ScreenConnect Server Web Shell Execution",
      "status": "test",
      "description": "Detects potential web shell execution from the ScreenConnect server process.",
      "level": "high",
      "tags": [
        "attack.initial-access",
        "attack.t1190"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\ScreenConnect.Service.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\cmd.exe",
                  "\\csc.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1190"
        ],
        "tactics": [
          "initial_access"
        ]
      },
      "meta": {
        "author": "Jason Rathbun (Blackpoint Cyber)",
        "date": "2024-02-26",
        "modified": "",
        "references": [
          "https://blackpointcyber.com/resources/blog/breaking-through-the-screen/",
          "https://www.connectwise.com/company/trust/security-bulletins/connectwise-screenconnect-23.9.8"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_remote_access_tools_screenconnect_webshell.yml"
      }
    },
    {
      "id": "93671f99-04eb-4ab4-a161-70d446a84003",
      "title": "Capture Credentials with Rpcping.exe",
      "status": "test",
      "description": "Detects using Rpcping.exe to send a RPC test connection to the target server (-s) and force the NTLM hash to be sent in the process.",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.t1003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_main_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\RpcPing.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "\\RpcPing.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_main_flag": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-s",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli_ntlm": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-u",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_1": {
                "field": "CommandLine",
                "value": "NTLM",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli_ncacn": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-t",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_1": {
                "field": "CommandLine",
                "value": "ncacn_np",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_main_* and 1 of selection_cli_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "all of selection_main_*"
            },
            {
              "type": "ref",
              "value": "1 of selection_cli_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1003"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Julia Fomina, oscd.community",
        "date": "2020-10-09",
        "modified": "2025-10-31",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Rpcping/",
          "https://twitter.com/vysecurity/status/974806438316072960",
          "https://twitter.com/vysecurity/status/873181705024266241",
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/hh875578(v=ws.11)"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_rpcping_credential_capture.yml"
      }
    },
    {
      "id": "b0524451-19af-4efa-a46f-562a977f792e",
      "title": "ShimCache Flush",
      "status": "stable",
      "description": "Detects actions that clear the local ShimCache and remove forensic evidence",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection1a": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "rundll32",
                  "apphelp.dll"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection1b": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "ShimFlushCache",
                  "#250"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection2a": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "rundll32",
                  "kernel32.dll"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection2b": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "BaseFlushAppcompatCache",
                  "#46"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "( selection1a and selection1b ) or ( selection2a and selection2b )",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "( selection1a and selection1b )",
            "( selection2a and selection2b )"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-02-01",
        "modified": "",
        "references": [
          "https://medium.com/@blueteamops/shimcache-flush-89daff28d15e"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_rundll32_susp_shimcache_flush.yml"
      }
    },
    {
      "id": "62b7ccc9-23b4-471e-aa15-6da3663c4d59",
      "title": "PowerShell Base64 Encoded Reflective Assembly Load",
      "status": "test",
      "description": "Detects base64 encoded .NET reflective loading of Assembly",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059.001",
        "attack.defense-evasion",
        "attack.t1027",
        "attack.t1620"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "WwBSAGUAZgBsAGUAYwB0AGkAbwBuAC4AQQBzAHMAZQBtAGIAbAB5AF0AOgA6AEwAbwBhAGQAKA",
                  "sAUgBlAGYAbABlAGMAdABpAG8AbgAuAEEAcwBzAGUAbQBiAGwAeQBdADoAOgBMAG8AYQBkACgA",
                  "bAFIAZQBmAGwAZQBjAHQAaQBvAG4ALgBBAHMAcwBlAG0AYgBsAHkAXQA6ADoATABvAGEAZAAoA",
                  "AFsAcgBlAGYAbABlAGMAdABpAG8AbgAuAGEAcwBzAGUAbQBiAGwAeQBdADoAOgAoACIATABvAGEAZAAiAC",
                  "BbAHIAZQBmAGwAZQBjAHQAaQBvAG4ALgBhAHMAcwBlAG0AYgBsAHkAXQA6ADoAKAAiAEwAbwBhAGQAIgAp",
                  "AWwByAGUAZgBsAGUAYwB0AGkAbwBuAC4AYQBzAHMAZQBtAGIAbAB5AF0AOgA6ACgAIgBMAG8AYQBkACIAK",
                  "WwBSAGUAZgBsAGUAYwB0AGkAbwBuAC4AQQBzAHMAZQBtAGIAbAB5AF0AOgA6ACgAIgBMAG8AYQBkACIAKQ",
                  "sAUgBlAGYAbABlAGMAdABpAG8AbgAuAEEAcwBzAGUAbQBiAGwAeQBdADoAOgAoACIATABvAGEAZAAiACkA",
                  "bAFIAZQBmAGwAZQBjAHQAaQBvAG4ALgBBAHMAcwBlAG0AYgBsAHkAXQA6ADoAKAAiAEwAbwBhAGQAIgApA",
                  "WwByAGUAZgBsAGUAYwB0AGkAbwBuAC4AYQBzAHMAZQBtAGIAbAB5AF0AOgA6AEwAbwBhAGQAKA",
                  "sAcgBlAGYAbABlAGMAdABpAG8AbgAuAGEAcwBzAGUAbQBiAGwAeQBdADoAOgBMAG8AYQBkACgA",
                  "bAHIAZQBmAGwAZQBjAHQAaQBvAG4ALgBhAHMAcwBlAG0AYgBsAHkAXQA6ADoATABvAGEAZAAoA"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001",
          "T1027",
          "T1620"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Christian Burkard (Nextron Systems), pH-T (Nextron Systems)",
        "date": "2022-03-01",
        "modified": "2023-01-30",
        "references": [
          "https://github.com/Neo23x0/Raccine/blob/20a569fa21625086433dcce8bb2765d0ea08dcb6/yara/mal_revil.yar",
          "https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_base64_reflection_assembly_load.yml"
      }
    },
    {
      "id": "d21374ff-f574-44a7-9998-4a8c8bf33d7d",
      "title": "WmiPrvSE Spawned A Process",
      "status": "stable",
      "description": "Detects WmiPrvSE spawning a process",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1047"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\WmiPrvSe.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_logonid": {
            "type": "field_match",
            "matchers": {
              "LogonId": {
                "field": "LogonId",
                "value": [
                  "0x3e7",
                  "null"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_system_user": {
            "type": "field_match",
            "matchers": {
              "User__contains": {
                "field": "User",
                "value": [
                  "AUTHORI",
                  "AUTORI"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_wmiprvse": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\WmiPrvSE.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_werfault": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\WerFault.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_null": {
            "type": "field_match",
            "matchers": {
              "LogonId": {
                "field": "LogonId",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1047"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez @Cyb3rWard0g",
        "date": "2019-08-15",
        "modified": "2023-03-23",
        "references": [
          "https://threathunterplaybook.com/hunts/windows/190815-RemoteServiceInstallation/notebook.html"
        ],
        "falsepositives": [
          "False positives are expected (e.g. in environments where WinRM is used legitimately)"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wmiprvse_spawning_process.yml"
      }
    },
    {
      "id": "ff23ffbc-3378-435e-992f-0624dcf93ab4",
      "title": "HackTool - PurpleSharp Execution",
      "status": "test",
      "description": "Detects the execution of the PurpleSharp adversary simulation tool",
      "level": "critical",
      "tags": [
        "attack.t1587",
        "attack.resource-development"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__contains": {
                    "field": "Image",
                    "value": "\\purplesharp",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "PurpleSharp.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "xyz123456.exe",
                  "PurpleSharp"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1587"
        ],
        "tactics": [
          "resource_development"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-06-18",
        "modified": "2023-02-05",
        "references": [
          "https://github.com/mvelazc0/PurpleSharp"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_purplesharp_indicators.yml"
      }
    },
    {
      "id": "1070db9a-3e5d-412e-8e7b-7183b616e1b3",
      "title": "Persistence Via Sticky Key Backdoor",
      "status": "test",
      "description": "By replacing the sticky keys executable with the local admins CMD executable, an attacker is able to access a privileged windows console session without authenticating to the system.\nWhen the sticky keys are \"activated\" the privilleged shell is launched.\n",
      "level": "critical",
      "tags": [
        "attack.persistence",
        "attack.t1546.008",
        "attack.privilege-escalation"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "copy ",
                  "/y ",
                  "C:\\windows\\system32\\cmd.exe C:\\windows\\system32\\sethc.exe"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1546.008"
        ],
        "tactics": [
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Sreeman",
        "date": "2020-02-18",
        "modified": "2023-03-07",
        "references": [
          "https://www.fireeye.com/blog/threat-research/2017/03/apt29_domain_frontin.html",
          "https://www.clearskysec.com/wp-content/uploads/2020/02/ClearSky-Fox-Kitten-Campaign-v1.pdf",
          "https://learn.microsoft.com/en-us/archive/blogs/jonathantrull/detecting-sticky-key-backdoors"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_cmd_sticky_keys_replace.yml"
      }
    },
    {
      "id": "f0ca6c24-3225-47d5-b1f5-352bf07ecfa7",
      "title": "PUA - DefenderCheck Execution",
      "status": "test",
      "description": "Detects the use of DefenderCheck, a tool to evaluate the signatures used in Microsoft Defender. It can be used to figure out the strings / byte chains used in Microsoft Defender to detect a tool and thus used for AV evasion.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027.005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\DefenderCheck.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "DefenderCheck",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1027.005"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-08-30",
        "modified": "2023-02-04",
        "references": [
          "https://github.com/matterpreter/DefenderCheck"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_defendercheck.yml"
      }
    },
    {
      "id": "6bba49bf-7f8c-47d6-a1bb-6b4dece4640e",
      "title": "Suspicious RASdial Activity",
      "status": "test",
      "description": "Detects suspicious process related to rasdial.exe",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.execution",
        "attack.t1059"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "rasdial.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "juju4",
        "date": "2019-01-16",
        "modified": "2021-11-27",
        "references": [
          "https://twitter.com/subTee/status/891298217907830785"
        ],
        "falsepositives": [
          "False positives depend on scripts and administrative tools used in the monitored environment"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_rasdial_execution.yml"
      }
    },
    {
      "id": "9f50fe98-fe5c-4a2d-86c7-fad7f63ed622",
      "title": "Potentially Suspicious ASP.NET Compilation Via AspNetCompiler",
      "status": "test",
      "description": "Detects execution of \"aspnet_compiler.exe\" with potentially suspicious paths for compilation.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1127"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  ":\\Windows\\Microsoft.NET\\Framework\\",
                  ":\\Windows\\Microsoft.NET\\Framework64\\",
                  ":\\Windows\\Microsoft.NET\\FrameworkArm\\",
                  ":\\Windows\\Microsoft.NET\\FrameworkArm64\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\aspnet_compiler.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\Users\\Public\\",
                  "\\AppData\\Local\\Temp\\",
                  "\\AppData\\Local\\Roaming\\",
                  ":\\Temp\\",
                  ":\\Windows\\Temp\\",
                  ":\\Windows\\System32\\Tasks\\",
                  ":\\Windows\\Tasks\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1127"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-08-14",
        "modified": "2025-02-24",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Aspnet_Compiler/",
          "https://ijustwannared.team/2020/08/01/the-curious-case-of-aspnet_compiler-exe/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_aspnet_compiler_susp_paths.yml"
      }
    },
    {
      "id": "f8d6a15e-4bc8-4c27-8e5d-2b10f0b73e5b",
      "title": "Suspicious Powercfg Execution To Change Lock Screen Timeout",
      "status": "test",
      "description": "Detects suspicious execution of 'Powercfg.exe' to change lock screen timeout",
      "level": "medium",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_power": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\powercfg.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "PowerCfg.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_standby": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "/setacvalueindex ",
                      "SCHEME_CURRENT",
                      "SUB_VIDEO",
                      "VIDEOCONLOCK"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "-change ",
                      "-standby-timeout-"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-11-18",
        "modified": "",
        "references": [
          "https://blogs.vmware.com/security/2022/11/batloader-the-evasive-downloader-malware.html",
          "https://learn.microsoft.com/en-us/windows-hardware/design/device-experiences/powercfg-command-line-options"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powercfg_execution.yml"
      }
    },
    {
      "id": "bac9fb54-2da7-44e9-988f-11e9a5edbc0c",
      "title": "Potential Password Spraying Attempt Using Dsacls.EXE",
      "status": "test",
      "description": "Detects possible password spraying attempts using Dsacls",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\dsacls.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "DSACLS.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/user:",
                  "/passwd:"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-06-20",
        "modified": "2023-02-04",
        "references": [
          "https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/using-dsacls-to-check-ad-object-permissions#password-spraying-anyone",
          "https://ss64.com/nt/dsacls.html",
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc771151(v=ws.11)"
        ],
        "falsepositives": [
          "Legitimate use of dsacls to bind to an LDAP session"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_dsacls_password_spray.yml"
      }
    },
    {
      "id": "3f5491e2-8db8-496b-9e95-1029fce852d4",
      "title": "Driver/DLL Installation Via Odbcconf.EXE",
      "status": "test",
      "description": "Detects execution of \"odbcconf\" with \"INSTALLDRIVER\" which installs a new ODBC driver. Attackers abuse this to install and run malicious DLLs.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.008"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\odbcconf.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "odbcconf.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "INSTALLDRIVER ",
                  ".dll"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.008"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-22",
        "modified": "",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Odbcconf/",
          "https://web.archive.org/web/20191023232753/https://twitter.com/Hexacorn/status/1187143326673330176",
          "https://www.hexacorn.com/blog/2020/08/23/odbcconf-lolbin-trifecta/"
        ],
        "falsepositives": [
          "Legitimate driver DLLs being registered via \"odbcconf\" will generate false positives. Investigate the path of the DLL and its contents to determine if the action is authorized."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_odbcconf_driver_install.yml"
      }
    },
    {
      "id": "ec570e53-4c76-45a9-804d-dc3f355ff7a7",
      "title": "7Zip Compressing Dump Files",
      "status": "test",
      "description": "Detects execution of 7z in order to compress a file with a \".dmp\"/\".dump\" extension, which could be a step in a process of dump file exfiltration.",
      "level": "medium",
      "tags": [
        "attack.collection",
        "attack.t1560.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Description__contains": {
                    "field": "Description",
                    "value": "7-Zip",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\7z.exe",
                      "\\7zr.exe",
                      "\\7za.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "7z.exe",
                      "7za.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_extension": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ".dmp",
                  ".dump",
                  ".hdmp"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1560.001"
        ],
        "tactics": [
          "collection"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-09-27",
        "modified": "2023-09-12",
        "references": [
          "https://thedfirreport.com/2022/09/26/bumblebee-round-two/"
        ],
        "falsepositives": [
          "Legitimate use of 7z with a command line in which \".dmp\" or \".dump\" appears accidentally",
          "Legitimate use of 7z to compress WER \".dmp\" files for troubleshooting"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_7zip_exfil_dmp_files.yml"
      }
    },
    {
      "id": "b97cd4b1-30b8-4a9d-bd72-6293928d52bc",
      "title": "Indirect Command Execution By Program Compatibility Wizard",
      "status": "test",
      "description": "Detect indirect command execution via Program Compatibility Assistant pcwrun.exe",
      "level": "low",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218",
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\pcwrun.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "A. Sungurov , oscd.community",
        "date": "2020-10-12",
        "modified": "2021-11-27",
        "references": [
          "https://twitter.com/pabraeken/status/991335019833708544",
          "https://lolbas-project.github.io/lolbas/Binaries/Pcwrun/"
        ],
        "falsepositives": [
          "Need to use extra processing with 'unique_count' / 'filter' to focus on outliers as opposed to commonly seen artifacts",
          "Legit usage of scripts"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_pcwrun.yml"
      }
    },
    {
      "id": "8150732a-0c9d-4a99-82b9-9efb9b90c40c",
      "title": "Suspicious Msiexec Quiet Install From Remote Location",
      "status": "test",
      "description": "Detects usage of Msiexec.exe to install packages hosted remotely quietly",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.007"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\msiexec.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "msiexec.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "-i",
                  "-package",
                  "-a",
                  "-j"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_quiet": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-q",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_remote": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "http",
                  "\\\\\\\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_openoffice": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "\\AppData\\Local\\Temp\\OpenOffice",
                  "Installation Files\\openoffice"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_optional_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.007"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-10-28",
        "modified": "2025-10-07",
        "references": [
          "https://www.microsoft.com/en-us/security/blog/2022/10/27/raspberry-robin-worm-part-of-larger-ecosystem-facilitating-pre-ransomware-activity/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_msiexec_install_remote.yml"
      }
    },
    {
      "id": "f38a82d2-fba3-4781-b549-525efbec8506",
      "title": "PUA - 3Proxy Execution",
      "status": "test",
      "description": "Detects the use of 3proxy, a tiny free proxy server",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1572"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\3proxy.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_pe": {
            "type": "field_match",
            "matchers": {
              "Description": {
                "field": "Description",
                "value": "3proxy - tiny proxy server",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_params": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": ".exe -i127.0.0.1 -p",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1572"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-09-13",
        "modified": "2023-02-21",
        "references": [
          "https://github.com/3proxy/3proxy",
          "https://blog.talosintelligence.com/2022/09/lazarus-three-rats.html"
        ],
        "falsepositives": [
          "Administrative activity"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_3proxy_execution.yml"
      }
    },
    {
      "id": "f37aba28-a9e6-4045-882c-d5004043b337",
      "title": "Potential Arbitrary File Download Via Cmdl32.EXE",
      "status": "test",
      "description": "Detects execution of Cmdl32 with the \"/vpn\" and \"/lan\" flags.\nAttackers can abuse this utility in order to download arbitrary files via a configuration file.\nInspect the location and the content of the file passed as an argument in order to determine if it is suspicious.\n",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.defense-evasion",
        "attack.t1218",
        "attack.t1202"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\cmdl32.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "CMDL32.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/vpn",
                  "/lan"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218",
          "T1202"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-11-03",
        "modified": "2024-04-22",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Cmdl32/",
          "https://twitter.com/SwiftOnSecurity/status/1455897435063074824",
          "https://github.com/LOLBAS-Project/LOLBAS/pull/151"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_cmdl32_arbitrary_file_download.yml"
      }
    },
    {
      "id": "77df53a5-1d78-4f32-bc5a-0e7465bd8f41",
      "title": "Portable Gpg.EXE Execution",
      "status": "test",
      "description": "Detects the execution of \"gpg.exe\" from uncommon location. Often used by ransomware and loaders to decrypt/encrypt data.",
      "level": "medium",
      "tags": [
        "attack.impact",
        "attack.t1486"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\gpg.exe",
                      "\\gpg2.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "gpg.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "GnuPG’s OpenPGP tool",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_main_legit_location": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  ":\\Program Files (x86)\\GNU\\GnuPG\\bin\\",
                  ":\\Program Files (x86)\\GnuPG VS-Desktop\\",
                  ":\\Program Files (x86)\\GnuPG\\bin\\",
                  ":\\Program Files (x86)\\Gpg4win\\bin\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1486"
        ],
        "tactics": [
          "impact"
        ]
      },
      "meta": {
        "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-08-06",
        "modified": "2023-11-10",
        "references": [
          "https://www.trendmicro.com/vinfo/vn/threat-encyclopedia/malware/ransom.bat.zarlock.a",
          "https://securelist.com/locked-out/68960/",
          "https://github.com/redcanaryco/atomic-red-team/blob/c4097dc7ed14d7f7d08c89d148c4307097e8c294/atomics/T1486/T1486.md"
        ],
        "falsepositives": [],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_gpg4win_portable_execution.yml"
      }
    },
    {
      "id": "a34f79a3-8e5f-4cc3-b765-de00695452c2",
      "title": "HackTool - PowerTool Execution",
      "status": "test",
      "description": "Detects the execution of the tool PowerTool which has the ability to kill a process, delete its process file, unload drivers, and delete the driver files",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\PowerTool.exe",
                      "\\PowerTool64.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "PowerTool.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-11-29",
        "modified": "2023-02-04",
        "references": [
          "https://thedfirreport.com/2022/11/28/emotet-strikes-again-lnk-file-leads-to-domain-wide-ransomware/",
          "https://www.trendmicro.com/en_us/research/22/i/play-ransomware-s-attack-playbook-unmasks-it-as-another-hive-aff.html",
          "https://twitter.com/gbti_sa/status/1249653895900602375?lang=en",
          "https://www.softpedia.com/get/Antivirus/Removal-Tools/ithurricane-PowerTool.shtml"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_powertool.yml"
      }
    },
    {
      "id": "caa9a802-8bd8-4b9e-a5cd-4d6221670219",
      "title": "Suspicious Kerberos Ticket Request via CLI",
      "status": "experimental",
      "description": "Detects suspicious Kerberos ticket requests via command line using System.IdentityModel.Tokens.KerberosRequestorSecurityToken class.\nThreat actors may use command line interfaces to request Kerberos tickets for service accounts in order to\nperform offline password cracking attacks commonly known as Kerberoasting or other Kerberos ticket abuse\ntechniques like silver ticket attacks.\n",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1558.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "powershell.exe",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "System.IdentityModel.Tokens.KerberosRequestorSecurityToken",
                  ".GetRequest()"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1558.003"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-11-18",
        "modified": "",
        "references": [
          "https://www.huntress.com/blog/gootloader-threat-detection-woff2-obfuscation",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1558.003/T1558.003.md#atomic-test-4---request-a-single-ticket-via-powershell",
          "https://learn.microsoft.com/en-us/dotnet/api/system.identitymodel.tokens.kerberosrequestorsecuritytoken?view=netframework-4.8.1"
        ],
        "falsepositives": [
          "Legitimate command line usage by administrators or security tools."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_kerberos_kerberos_ticket_request_via_cli.yml"
      }
    },
    {
      "id": "e7888eb1-13b0-4616-bd99-4bc0c2b054b9",
      "title": "Dllhost.EXE Execution Anomaly",
      "status": "test",
      "description": "Detects a \"dllhost\" process spawning with no commandline arguments which is very rare to happen and could indicate process injection activity or malware mimicking similar system processes.",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.defense-evasion",
        "attack.t1055"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\dllhost.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine": {
                "field": "CommandLine",
                "value": [
                  "dllhost.exe",
                  "dllhost"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_null": {
            "type": "field_match",
            "matchers": {
              "CommandLine": {
                "field": "CommandLine",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1055"
        ],
        "tactics": [
          "privilege_escalation",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-06-27",
        "modified": "2023-05-15",
        "references": [
          "https://redcanary.com/blog/child-processes/",
          "https://nasbench.medium.com/what-is-the-dllhost-exe-process-actually-running-ef9fe4c19c08",
          "https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/goofy-guineapig/NCSC-MAR-Goofy-Guineapig.pdf"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_dllhost_no_cli_execution.yml"
      }
    },
    {
      "id": "33339be3-148b-4e16-af56-ad16ec6c7e7b",
      "title": "Findstr Launching .lnk File",
      "status": "test",
      "description": "Detects usage of findstr to identify and execute a lnk file as seen within the HHS redirect attack",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036",
        "attack.t1202",
        "attack.t1027.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\find.exe",
                      "\\findstr.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "FIND.EXE",
                      "FINDSTR.EXE"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": [
                  ".lnk",
                  ".lnk\"",
                  ".lnk'"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1036",
          "T1202",
          "T1027.003"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Trent Liffick",
        "date": "2020-05-01",
        "modified": "2024-01-15",
        "references": [
          "https://www.bleepingcomputer.com/news/security/hhsgov-open-redirect-used-by-coronavirus-phishing-to-spread-malware/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_findstr_lnk.yml"
      }
    },
    {
      "id": "b8b1b304-a60f-4999-9a6e-c547bde03ffd",
      "title": "DeviceCredentialDeployment Execution",
      "status": "test",
      "description": "Detects the execution of DeviceCredentialDeployment to hide a process from view.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\DeviceCredentialDeployment.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-19",
        "modified": "",
        "references": [
          "https://github.com/LOLBAS-Project/LOLBAS/pull/147"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_device_credential_deployment.yml"
      }
    },
    {
      "id": "fbd7c32d-db2a-4418-b92c-566eb8911133",
      "title": "SyncAppvPublishingServer Execute Arbitrary PowerShell Code",
      "status": "test",
      "description": "Executes arbitrary PowerShell code using SyncAppvPublishingServer.exe.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\SyncAppvPublishingServer.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "syncappvpublishingserver.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "\"n; ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-07-12",
        "modified": "2022-10-04",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1218/T1218.md",
          "https://lolbas-project.github.io/lolbas/Binaries/Syncappvpublishingserver/"
        ],
        "falsepositives": [
          "App-V clients"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_syncappvpublishingserver_execute_psh.yml"
      }
    },
    {
      "id": "438025f9-5856-4663-83f7-52f878a70a50",
      "title": "Suspicious Microsoft Office Child Process",
      "status": "test",
      "description": "Detects a suspicious process spawning from one of the Microsoft Office suite products (Word, Excel, PowerPoint, Publisher, Visio, etc.)",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.execution",
        "attack.t1047",
        "attack.t1204.002",
        "attack.t1218.010"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\EQNEDT32.EXE",
                  "\\EXCEL.EXE",
                  "\\MSACCESS.EXE",
                  "\\MSPUB.exe",
                  "\\ONENOTE.EXE",
                  "\\POWERPNT.exe",
                  "\\VISIO.exe",
                  "\\WINWORD.EXE",
                  "\\wordpad.exe",
                  "\\wordview.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_child_processes": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "bitsadmin.exe",
                      "CertOC.exe",
                      "CertUtil.exe",
                      "Cmd.Exe",
                      "CMSTP.EXE",
                      "cscript.exe",
                      "curl.exe",
                      "HH.exe",
                      "IEExec.exe",
                      "InstallUtil.exe",
                      "javaw.exe",
                      "Microsoft.Workflow.Compiler.exe",
                      "msdt.exe",
                      "MSHTA.EXE",
                      "msiexec.exe",
                      "Msxsl.exe",
                      "odbcconf.exe",
                      "pcalua.exe",
                      "PowerShell.EXE",
                      "RegAsm.exe",
                      "RegSvcs.exe",
                      "REGSVR32.exe",
                      "RUNDLL32.exe",
                      "schtasks.exe",
                      "ScriptRunner.exe",
                      "wmic.exe",
                      "WorkFolders.exe",
                      "wscript.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\AppVLP.exe",
                      "\\bash.exe",
                      "\\bitsadmin.exe",
                      "\\certoc.exe",
                      "\\certutil.exe",
                      "\\cmd.exe",
                      "\\cmstp.exe",
                      "\\control.exe",
                      "\\cscript.exe",
                      "\\curl.exe",
                      "\\forfiles.exe",
                      "\\hh.exe",
                      "\\ieexec.exe",
                      "\\installutil.exe",
                      "\\javaw.exe",
                      "\\mftrace.exe",
                      "\\Microsoft.Workflow.Compiler.exe",
                      "\\msbuild.exe",
                      "\\msdt.exe",
                      "\\mshta.exe",
                      "\\msidb.exe",
                      "\\msiexec.exe",
                      "\\msxsl.exe",
                      "\\odbcconf.exe",
                      "\\pcalua.exe",
                      "\\powershell.exe",
                      "\\pwsh.exe",
                      "\\regasm.exe",
                      "\\regsvcs.exe",
                      "\\regsvr32.exe",
                      "\\rundll32.exe",
                      "\\schtasks.exe",
                      "\\scrcons.exe",
                      "\\scriptrunner.exe",
                      "\\sh.exe",
                      "\\svchost.exe",
                      "\\verclsid.exe",
                      "\\wmic.exe",
                      "\\workfolders.exe",
                      "\\wscript.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_child_susp_paths": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  "\\AppData\\",
                  "\\Users\\Public\\",
                  "\\ProgramData\\",
                  "\\Windows\\Tasks\\",
                  "\\Windows\\Temp\\",
                  "\\Windows\\System32\\Tasks\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_parent and 1 of selection_child_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_parent"
            },
            {
              "type": "ref",
              "value": "1 of selection_child_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1047",
          "T1204.002",
          "T1218.010"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Markus Neis, FPT.EagleEye Team, Vadim Khrykov, Cyb3rEng, Michael Haag, Christopher Peacock @securepeacock, @scythe_io",
        "date": "2018-04-06",
        "modified": "2023-04-24",
        "references": [
          "https://www.hybrid-analysis.com/sample/465aabe132ccb949e75b8ab9c5bda36d80cf2fd503d52b8bad54e295f28bbc21?environmentId=100",
          "https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html",
          "https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware/",
          "https://doublepulsar.com/follina-a-microsoft-office-code-execution-vulnerability-1a47fce5629e",
          "https://github.com/vadim-hunter/Detection-Ideas-Rules/blob/02bcbfc2bfb8b4da601bb30de0344ae453aa1afe/Threat%20Intelligence/The%20DFIR%20Report/20210329_Sodinokibi_(aka_REvil)_Ransomware.yaml",
          "https://github.com/splunk/security_content/blob/300af51b88ad5d5b27ce4f5f54e4d6e6a3a2c06d/detections/endpoint/office_spawning_control.yml",
          "https://twitter.com/andythevariable/status/1576953781581144064?s=20&t=QiJILvK4ZiBdR8RJe24u-A",
          "https://www.elastic.co/security-labs/exploring-the-ref2731-intrusion-set",
          "https://github.com/elastic/detection-rules/blob/c76a39796972ecde44cb1da6df47f1b6562c9770/rules/windows/defense_evasion_execution_msbuild_started_by_office_app.toml",
          "https://www.vmray.com/analyses/2d2fa29185ad/report/overview.html",
          "https://app.any.run/tasks/c903e9c8-0350-440c-8688-3881b556b8e0/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_office_susp_child_processes.yml"
      }
    },
    {
      "id": "0e8cfe08-02c9-4815-a2f8-0d157b7ed33e",
      "title": "File Download with Headless Browser",
      "status": "test",
      "description": "Detects execution of chromium based browser in headless mode using the \"dump-dom\" command line to download files",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.command-and-control",
        "attack.t1105",
        "attack.t1564.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\brave.exe",
                  "\\chrome.exe",
                  "\\msedge.exe",
                  "\\opera.exe",
                  "\\vivaldi.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "--headless",
                  "dump-dom",
                  "http"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_edge_1": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\",
                  "C:\\Program Files (x86)\\Microsoft\\EdgeCore\\",
                  "C:\\Program Files (x86)\\Microsoft\\EdgeWebView\\",
                  "C:\\Program Files\\Microsoft\\Edge\\Application\\",
                  "C:\\Program Files\\Microsoft\\EdgeCore\\",
                  "C:\\Program Files\\Microsoft\\EdgeWebView\\",
                  "C:\\Program Files\\WindowsApps\\Microsoft.MicrosoftEdge"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\msedge.exe",
                  "\\msedgewebview2.exe",
                  "\\MicrosoftEdge.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "--headless --disable-gpu --disable-extensions --disable-plugins --mute-audio --no-first-run --incognito --aggressive-cache-discard --dump-dom",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_edge_2": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  "\\AppData\\Local\\Microsoft\\WindowsApps\\",
                  "\\Windows\\SystemApps\\Microsoft.MicrosoftEdge"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\msedge.exe",
                  "\\MicrosoftEdge.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "--headless --disable-gpu --disable-extensions --disable-plugins --mute-audio --no-first-run --incognito --aggressive-cache-discard --dump-dom",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1105",
          "T1564.003"
        ],
        "tactics": [
          "defense_evasion",
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Sreeman, Florian Roth (Nextron Systems)",
        "date": "2022-01-04",
        "modified": "2025-10-07",
        "references": [
          "https://twitter.com/mrd0x/status/1478234484881436672?s=12",
          "https://www.trendmicro.com/en_us/research/23/e/managed-xdr-investigation-of-ducktail-in-trend-micro-vision-one.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_browsers_chromium_headless_file_download.yml"
      }
    },
    {
      "id": "c260b6db-48ba-4b4a-a76f-2f67644e99d2",
      "title": "HackTool - Covenant PowerShell Launcher",
      "status": "test",
      "description": "Detects suspicious command lines used in Covenant luanchers",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.defense-evasion",
        "attack.t1059.001",
        "attack.t1564.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "-Sta",
                  "-Nop",
                  "-Window",
                  "Hidden"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "-Command",
                  "-EncodedCommand"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "sv o (New-Object IO.MemorySteam);sv d ",
                  "mshta file.hta",
                  "GruntHTTP",
                  "-EncodedCommand cwB2ACAAbwAgA"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001",
          "T1564.003"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Jonhnathan Ribeiro, oscd.community",
        "date": "2020-06-04",
        "modified": "2023-02-21",
        "references": [
          "https://posts.specterops.io/covenant-v0-5-eee0507b85ba"
        ],
        "falsepositives": [],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_covenant.yml"
      }
    },
    {
      "id": "16c37b52-b141-42a5-a3ea-bbe098444397",
      "title": "Suspect Svchost Activity",
      "status": "test",
      "description": "It is extremely abnormal for svchost.exe to spawn without any CLI arguments and is normally observed when a malicious process spawns the process and injects code into the process memory space.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1055"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": "svchost.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\svchost.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "ParentImage__endswith": {
                    "field": "ParentImage",
                    "value": [
                      "\\rpcnet.exe",
                      "\\rpcnetp.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine": {
                    "field": "CommandLine",
                    "value": null,
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1055"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "David Burkett, @signalblur",
        "date": "2019-12-28",
        "modified": "2022-06-27",
        "references": [
          "https://web.archive.org/web/20180718061628/https://securitybytes.io/blue-team-fundamentals-part-two-windows-processes-759fe15965e2"
        ],
        "falsepositives": [
          "Rpcnet.exe / rpcnetp.exe which is a lojack style software. https://www.blackhat.com/docs/us-14/materials/us-14-Kamlyuk-Kamluk-Computrace-Backdoor-Revisited.pdf"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_svchost_execution_with_no_cli_flags.yml"
      }
    },
    {
      "id": "d7654f02-e04b-4934-9838-65c46f187ebc",
      "title": "PUA- IOX Tunneling Tool Execution",
      "status": "test",
      "description": "Detects the use of IOX - a tool for port forwarding and intranet proxy purposes",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1090"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\iox.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_commandline": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ".exe fwd -l ",
                  ".exe fwd -r ",
                  ".exe proxy -l ",
                  ".exe proxy -r "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_hashes": {
            "type": "field_match",
            "matchers": {
              "Hashes__contains": {
                "field": "Hashes",
                "value": [
                  "MD5=9DB2D314DD3F704A02051EF5EA210993",
                  "SHA1=039130337E28A6623ECF9A0A3DA7D92C5964D8DD",
                  "SHA256=C6CF82919B809967D9D90EA73772A8AA1C1EB3BC59252D977500F64F1A0D6731"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1090"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-10-08",
        "modified": "2024-11-23",
        "references": [
          "https://github.com/EddieIvan01/iox"
        ],
        "falsepositives": [
          "Legitimate use"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_iox.yml"
      }
    },
    {
      "id": "3037d961-21e9-4732-b27a-637bcc7bf539",
      "title": "Suspicious High IntegrityLevel Conhost Legacy Option",
      "status": "test",
      "description": "ForceV1 asks for information directly from the kernel space. Conhost connects to the console application. High IntegrityLevel means the process is running with elevated privileges, such as an Administrator context.",
      "level": "informational",
      "tags": [
        "attack.defense-evasion",
        "attack.t1202"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "IntegrityLevel": {
                "field": "IntegrityLevel",
                "value": [
                  "High",
                  "S-1-16-12288"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "conhost.exe",
                  "0xffffffff",
                  "-ForceV1"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1202"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-12-09",
        "modified": "2024-12-01",
        "references": [
          "https://cybercryptosec.medium.com/covid-19-cyber-infection-c615ead7c29",
          "https://thedfirreport.com/2022/04/04/stolen-images-campaign-ends-in-conti-ransomware/",
          "https://learn.microsoft.com/en-us/windows/win32/secauthz/mandatory-integrity-control"
        ],
        "falsepositives": [
          "Very Likely, including launching cmd.exe via Run As Administrator"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_conhost_legacy_option.yml"
      }
    },
    {
      "id": "932fb0d8-692b-4b0f-a26e-5643a50fe7d6",
      "title": "Audio Capture via PowerShell",
      "status": "test",
      "description": "Detects audio capture via PowerShell Cmdlet.",
      "level": "medium",
      "tags": [
        "attack.collection",
        "attack.t1123"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "WindowsAudioDevice-Powershell-Cmdlet",
                  "Toggle-AudioDevice",
                  "Get-AudioDevice ",
                  "Set-AudioDevice ",
                  "Write-AudioDevice "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1123"
        ],
        "tactics": [
          "collection"
        ]
      },
      "meta": {
        "author": "E.M. Anhaus (originally from Atomic Blue Detections, Endgame), oscd.community, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2019-10-24",
        "modified": "2023-04-06",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1123/T1123.md",
          "https://eqllib.readthedocs.io/en/latest/analytics/ab7a6ef4-0983-4275-a4f1-5c6bd3c31c23.html",
          "https://github.com/frgnca/AudioDeviceCmdlets"
        ],
        "falsepositives": [
          "Legitimate audio capture by legitimate user."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_audio_capture.yml"
      }
    },
    {
      "id": "7050bba1-1aed-454e-8f73-3f46f09ce56a",
      "title": "Cloudflared Tunnel Connections Cleanup",
      "status": "test",
      "description": "Detects execution of the \"cloudflared\" tool with the tunnel \"cleanup\" flag in order to cleanup tunnel connections.",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1102",
        "attack.t1090",
        "attack.t1572"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " tunnel ",
                  "cleanup "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "-config ",
                  "-connector-id "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1102",
          "T1090",
          "T1572"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-17",
        "modified": "2023-12-21",
        "references": [
          "https://github.com/cloudflare/cloudflared",
          "https://developers.cloudflare.com/cloudflare-one/connections/connect-apps"
        ],
        "falsepositives": [
          "Legitimate usage of Cloudflared."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_cloudflared_tunnel_cleanup.yml"
      }
    },
    {
      "id": "54773c5f-f1cc-4703-9126-2f797d96a69d",
      "title": "PUA - Advanced Port Scanner Execution",
      "status": "test",
      "description": "Detects the use of Advanced Port Scanner.",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.t1046",
        "attack.t1135"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__contains": {
                    "field": "Image",
                    "value": "\\advanced_port_scanner",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName__contains": {
                    "field": "OriginalFileName",
                    "value": "advanced_port_scanner",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description__contains": {
                    "field": "Description",
                    "value": "Advanced Port Scanner",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/portable",
                  "/lng"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1046",
          "T1135"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2021-12-18",
        "modified": "2023-02-07",
        "references": [
          "https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Other/Advanced%20Port%20Scanner"
        ],
        "falsepositives": [
          "Legitimate administrative use",
          "Tools with similar commandline (very rare)"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_advanced_port_scanner.yml"
      }
    },
    {
      "id": "cc9d3712-6310-4320-b2df-7cb408274d53",
      "title": "Rebuild Performance Counter Values Via Lodctr.EXE",
      "status": "test",
      "description": "Detects the execution of \"lodctr.exe\" to rebuild the performance counter registry values. This can be abused by attackers by providing a malicious config file to overwrite performance counter configuration to confuse and evade monitoring and security solutions.",
      "level": "medium",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\lodctr.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "OriginalFileName": {
                "field": "OriginalFileName",
                "value": "LODCTR.EXE",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -r",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-06-15",
        "modified": "2024-03-05",
        "references": [
          "https://learn.microsoft.com/en-us/windows/security/identity-protection/virtual-smart-cards/virtual-smart-card-tpmvscmgr"
        ],
        "falsepositives": [
          "Legitimate usage by an administrator"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lodctr_performance_counter_tampering.yml"
      }
    },
    {
      "id": "e1561947-b4e3-4a74-9bdd-83baed21bdb5",
      "title": "Invoke-Obfuscation Via Use Clip",
      "status": "test",
      "description": "Detects Obfuscated Powershell via use Clip.exe in Scripts",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027",
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__re": {
                "field": "CommandLine",
                "value": "(?i)echo.*clip.*&&.*(Clipboard|i`?n`?v`?o`?k`?e`?)",
                "modifiers": [
                  "re"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1027",
          "T1059.001"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Nikita Nazarov, oscd.community",
        "date": "2020-10-09",
        "modified": "2024-04-15",
        "references": [
          "https://github.com/SigmaHQ/sigma/issues/1009"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_invoke_obfuscation_via_use_clip.yml"
      }
    },
    {
      "id": "9212f354-7775-4e28-9c9f-8f0a4544e664",
      "title": "Active Directory Database Snapshot Via ADExplorer",
      "status": "test",
      "description": "Detects the execution of Sysinternals ADExplorer with the \"-snapshot\" flag in order to save a local copy of the active directory database. This can be used by attackers to extract data for Bloodhound, usernames for password spraying or use the meta data for social engineering. The snapshot doesn't contain password hashes but there have been cases, where administrators put passwords in the comment field.",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.t1087.002",
        "attack.t1069.002",
        "attack.t1482"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\ADExp.exe",
                      "\\ADExplorer.exe",
                      "\\ADExplorer64.exe",
                      "\\ADExplorer64a.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "AdExp",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "Active Directory Editor",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Product": {
                    "field": "Product",
                    "value": "Sysinternals ADExplorer",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "snapshot",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1087.002",
          "T1069.002",
          "T1482"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-03-14",
        "modified": "2025-07-09",
        "references": [
          "https://www.documentcloud.org/documents/5743766-Global-Threat-Report-2019.html",
          "https://learn.microsoft.com/de-de/sysinternals/downloads/adexplorer",
          "https://github.com/c3c/ADExplorerSnapshot.py/tree/f700904defac330802bbfedd1d8ffd9248f4ee24",
          "https://www.packetlabs.net/posts/scattered-spider-is-a-young-ransomware-gang-exploiting-large-corporations/",
          "https://www.nccgroup.com/us/research-blog/lapsus-recent-techniques-tactics-and-procedures/",
          "https://trustedsec.com/blog/adexplorer-on-engagements"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sysinternals_adexplorer_execution.yml"
      }
    },
    {
      "id": "b1f73849-6329-4069-bc8f-78a604bb8b23",
      "title": "Remote Access Tool - ScreenConnect Remote Command Execution",
      "status": "test",
      "description": "Detects the execution of a system command via the ScreenConnect RMM service.",
      "level": "low",
      "tags": [
        "attack.execution",
        "attack.t1059.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\ScreenConnect.ClientService.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\cmd.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "Cmd.Exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "\\TEMP\\ScreenConnect\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.003"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Ali Alwashali",
        "date": "2023-10-10",
        "modified": "2024-02-26",
        "references": [
          "https://github.com/SigmaHQ/sigma/pull/4467"
        ],
        "falsepositives": [
          "Legitimate use of ScreenConnect. Disable this rule if ScreenConnect is heavily used."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_remote_access_tools_screenconnect_remote_execution.yml"
      }
    },
    {
      "id": "f4264e47-f522-4c38-a420-04525d5b880f",
      "title": "Renamed AutoIt Execution",
      "status": "test",
      "description": "Detects the execution of a renamed AutoIt2.exe or AutoIt3.exe.\nAutoIt is a scripting language and automation tool for Windows systems. While primarily used for legitimate automation tasks, it can be misused in cyber attacks.\nAttackers can leverage AutoIt to create and distribute malware, including keyloggers, spyware, and botnets. A renamed AutoIt executable is particularly suspicious.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " /AutoIt3ExecuteScript",
                  " /ErrorStdOut"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_2": {
            "type": "field_match",
            "matchers": {
              "Hashes__contains": {
                "field": "Hashes",
                "value": [
                  "IMPHASH=FDC554B3A8683918D731685855683DDF",
                  "IMPHASH=CD30A61B60B3D60CECDB034C8C83C290",
                  "IMPHASH=F8A00C72F2D667D2EDBB234D0C0AE000"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_3": {
            "type": "field_match",
            "matchers": {
              "OriginalFileName": {
                "field": "OriginalFileName",
                "value": [
                  "AutoIt3.exe",
                  "AutoIt2.exe",
                  "AutoIt.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_legit_name": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\AutoIt.exe",
                  "\\AutoIt2.exe",
                  "\\AutoIt3_x64.exe",
                  "\\AutoIt3.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "1 of selection_* and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "1 of selection_*"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1027"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2023-06-04",
        "modified": "2024-11-23",
        "references": [
          "https://twitter.com/malmoeb/status/1665463817130725378?s=12&t=C0_T_re0wRP_NfKa27Xw9w",
          "https://www.autoitscript.com/site/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_renamed_autoit.yml"
      }
    },
    {
      "id": "01c42d3c-242d-4655-85b2-34f1739632f7",
      "title": "Potentially Over Permissive Permissions Granted Using Dsacls.EXE",
      "status": "test",
      "description": "Detects usage of Dsacls to grant over permissive permissions",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\dsacls.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "DSACLS.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_flag": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " /G ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_permissions": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "GR",
                  "GE",
                  "GW",
                  "GA",
                  "WP",
                  "WD"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-06-20",
        "modified": "2023-02-04",
        "references": [
          "https://ss64.com/nt/dsacls.html",
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc771151(v=ws.11)"
        ],
        "falsepositives": [
          "Legitimate administrators granting over permissive permissions to users"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_dsacls_abuse_permissions.yml"
      }
    },
    {
      "id": "651f87f7-12db-47f9-84c5-f27b081b94b6",
      "title": "RegAsm.EXE Execution Without CommandLine Flags or Files",
      "status": "experimental",
      "description": "Detects the execution of \"RegAsm.exe\" without a commandline flag or file, which might indicate potential process injection activity.\nUsually \"RegAsm.exe\" should point to a dedicated DLL file or call the help with the \"/?\" flag.\n",
      "level": "low",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.009"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\RegAsm.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "RegAsm.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": [
                  "RegAsm",
                  "RegAsm.exe",
                  "RegAsm.exe\"",
                  "RegAsm.exe'"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.009"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2025-06-04",
        "modified": "",
        "references": [
          "https://www.mcafee.com/blogs/other-blogs/mcafee-labs/agent-teslas-unique-approach-vbs-and-steganography-for-delivery-and-intrusion/",
          "https://www.zscaler.fr/blogs/security-research/threat-actors-exploit-cve-2017-11882-deliver-agent-tesla",
          "https://learn.microsoft.com/en-us/dotnet/framework/tools/regasm-exe-assembly-registration-tool",
          "https://app.any.run/tasks/ea944b89-69d8-49c8-ac1f-5c76ad300db2",
          "https://www.joesandbox.com/analysis/1467354/0/html"
        ],
        "falsepositives": [
          "Legitimate use of Regasm by developers."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_regasm_no_flag_or_dll_execution.yml"
      }
    },
    {
      "id": "49be8799-7b4d-4fda-ad23-cafbefdebbc5",
      "title": "Use of Wfc.exe",
      "status": "test",
      "description": "The Workflow Command-line Compiler can be used for AWL bypass and is listed in Microsoft's recommended block rules.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1127"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\wfc.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "wfc.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1127"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Christopher Peacock @SecurePeacock, SCYTHE @scythe_io",
        "date": "2022-06-01",
        "modified": "",
        "references": [
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Wfc/",
          "https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/design/applications-that-can-bypass-wdac"
        ],
        "falsepositives": [
          "Legitimate use by a software developer"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_wfc.yml"
      }
    },
    {
      "id": "9df0dd3a-1a5c-47e3-a2bc-30ed177646a0",
      "title": "Remote Code Execute via Winrm.vbs",
      "status": "test",
      "description": "Detects an attempt to execute code or create service on remote host via winrm.vbs.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1216"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\cscript.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "cscript.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "winrm",
                  "invoke Create wmicimv2/Win32_",
                  "-r:http"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1216"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Julia Fomina, oscd.community",
        "date": "2020-10-07",
        "modified": "2023-03-03",
        "references": [
          "https://twitter.com/bohops/status/994405551751815170",
          "https://redcanary.com/blog/lateral-movement-winrm-wmi/",
          "https://lolbas-project.github.io/lolbas/Scripts/Winrm/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_winrm_execution_via_scripting_api_winrm_vbs.yml"
      }
    },
    {
      "id": "e01fa958-6893-41d4-ae03-182477c5e77d",
      "title": "Remote Access Tool - RURAT Execution From Unusual Location",
      "status": "test",
      "description": "Detects execution of Remote Utilities RAT (RURAT) from an unusual location (outside of 'C:\\Program Files')",
      "level": "medium",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\rutserv.exe",
                      "\\rfusclient.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Product": {
                    "field": "Product",
                    "value": "Remote Utilities",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Remote Utilities",
                  "C:\\Program Files (x86)\\Remote Utilities"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-09-19",
        "modified": "2023-03-05",
        "references": [
          "https://redcanary.com/blog/misbehaving-rats/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_remote_access_tools_rurat_non_default_location.yml"
      }
    },
    {
      "id": "0e4164da-94bc-450d-a7be-a4b176179f1f",
      "title": "Firewall Configuration Discovery Via Netsh.EXE",
      "status": "test",
      "description": "Adversaries may look for details about the network configuration and settings of systems they access or through information discovery of remote systems",
      "level": "low",
      "tags": [
        "attack.discovery",
        "attack.t1016"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\netsh.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "netsh.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "netsh",
                  "show ",
                  "firewall "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "config ",
                  "state ",
                  "rule ",
                  "name=all"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1016"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "frack113, Christopher Peacock '@securepeacock', SCYTHE '@scythe_io'",
        "date": "2021-12-07",
        "modified": "2025-10-18",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1016/T1016.md#atomic-test-2---list-windows-firewall-rules",
          "https://ss64.com/nt/netsh.html"
        ],
        "falsepositives": [
          "Administrative activity"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_netsh_fw_rules_discovery.yml"
      }
    },
    {
      "id": "4beb6ae0-f85b-41e2-8f18-8668abc8af78",
      "title": "Sysinternals PsSuspend Suspicious Execution",
      "status": "test",
      "description": "Detects suspicious execution of Sysinternals PsSuspend, where the utility is used to suspend critical processes such as AV or EDR to bypass defenses",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "pssuspend.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\pssuspend.exe",
                      "\\pssuspend64.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "msmpeng.exe",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-03-23",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/sysinternals/downloads/pssuspend",
          "https://twitter.com/0gtweet/status/1638069413717975046"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sysinternals_pssuspend_susp_execution.yml"
      }
    },
    {
      "id": "3e8207c5-fcd2-4ea6-9418-15d45b4890e4",
      "title": "Potential Data Stealing Via Chromium Headless Debugging",
      "status": "test",
      "description": "Detects chromium based browsers starting in headless and debugging mode and pointing to a user profile. This could be a sign of data stealing or remote control",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.credential-access",
        "attack.collection",
        "attack.t1185",
        "attack.t1564.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "--remote-debugging-",
                  "--user-data-dir",
                  "--headless"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1185",
          "T1564.003"
        ],
        "tactics": [
          "defense_evasion",
          "credential_access",
          "collection"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-12-23",
        "modified": "",
        "references": [
          "https://github.com/defaultnamehere/cookie_crimes/",
          "https://mango.pdf.zone/stealing-chrome-cookies-without-a-password",
          "https://embracethered.com/blog/posts/2020/cookie-crimes-on-mirosoft-edge/",
          "https://embracethered.com/blog/posts/2020/chrome-spy-remote-control/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_browsers_chromium_headless_debugging.yml"
      }
    },
    {
      "id": "4833155a-4053-4c9c-a997-777fcea0baa7",
      "title": "SQLite Firefox Profile Data DB Access",
      "status": "test",
      "description": "Detect usage of the \"sqlite\" binary to query databases in Firefox and other Gecko-based browsers for potential data stealing.",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1539",
        "attack.collection",
        "attack.t1005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_sql": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Product": {
                    "field": "Product",
                    "value": "SQLite",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\sqlite.exe",
                      "\\sqlite3.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_firefox": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "cookies.sqlite",
                  "places.sqlite"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1539",
          "T1005"
        ],
        "tactics": [
          "credential_access",
          "collection"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-04-08",
        "modified": "2023-01-19",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1539/T1539.md#atomic-test-1---steal-firefox-cookies-windows",
          "https://blog.cyble.com/2022/04/21/prynt-stealer-a-new-info-stealer-performing-clipper-and-keylogger-activities/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sqlite_firefox_gecko_profile_data.yml"
      }
    },
    {
      "id": "4281cb20-2994-4580-aa63-c8b86d019934",
      "title": "Hiding Files with Attrib.exe",
      "status": "test",
      "description": "Detects usage of attrib.exe to hide files from users.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1564.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\attrib.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "ATTRIB.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " +h ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_msiexec": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "\\desktop.ini ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_intel": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\cmd.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine": {
                "field": "CommandLine",
                "value": "+R +H +S +A \\\\\\*.cui",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ParentCommandLine": {
                "field": "ParentCommandLine",
                "value": "C:\\\\WINDOWS\\\\system32\\\\\\*.bat",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "all of selection_*"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1564.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Sami Ruohonen",
        "date": "2019-01-16",
        "modified": "2023-03-14",
        "references": [
          "https://unit42.paloaltonetworks.com/unit42-sure-ill-take-new-combojack-malware-alters-clipboards-steal-cryptocurrency/",
          "https://www.uptycs.com/blog/lolbins-are-no-laughing-matter"
        ],
        "falsepositives": [
          "IgfxCUIService.exe hiding *.cui files via .bat script (attrib.exe a child of cmd.exe and igfxCUIService.exe is the parent of the cmd.exe)",
          "Msiexec.exe hiding desktop.ini"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_attrib_hiding_files.yml"
      }
    },
    {
      "id": "954f0af7-62dd-418f-b3df-a84bc2c7a774",
      "title": "New Remote Desktop Connection Initiated Via Mstsc.EXE",
      "status": "test",
      "description": "Detects the usage of \"mstsc.exe\" with the \"/v\" flag to initiate a connection to a remote server.\nAdversaries may use valid accounts to log into a computer using the Remote Desktop Protocol (RDP). The adversary may then perform actions as the logged-on user.\n",
      "level": "medium",
      "tags": [
        "attack.lateral-movement",
        "attack.t1021.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\mstsc.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "mstsc.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " /v:",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_wsl": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": "C:\\Windows\\System32\\lxss\\wslhost.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "C:\\ProgramData\\Microsoft\\WSL\\wslg.rdp",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_optional_"
        }
      },
      "mitre": {
        "techniques": [
          "T1021.001"
        ],
        "tactics": [
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-07",
        "modified": "2024-06-04",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1021.001/T1021.001.md#t1021001---remote-desktop-protocol",
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/mstsc"
        ],
        "falsepositives": [
          "WSL (Windows Sub System For Linux)"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_mstsc_remote_connection.yml"
      }
    },
    {
      "id": "871b9555-69ca-4993-99d3-35a59f9f3599",
      "title": "Suspicious UltraVNC Execution",
      "status": "test",
      "description": "Detects suspicious UltraVNC command line flag combination that indicate a auto reconnect upon execution, e.g. startup (as seen being used by Gamaredon threat group)",
      "level": "high",
      "tags": [
        "attack.lateral-movement",
        "attack.g0047",
        "attack.t1021.005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "-autoreconnect ",
                  "-connect ",
                  "-id:"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1021.005"
        ],
        "tactics": [
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Bhabesh Raj",
        "date": "2022-03-04",
        "modified": "2022-03-09",
        "references": [
          "https://web.archive.org/web/20220224045756/https://www.ria.ee/sites/default/files/content-editors/kuberturve/tale_of_gamaredon_infection.pdf",
          "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/shuckworm-gamaredon-espionage-ukraine",
          "https://unit42.paloaltonetworks.com/unit-42-title-gamaredon-group-toolset-evolution",
          "https://uvnc.com/docs/uvnc-viewer/52-ultravnc-viewer-commandline-parameters.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_ultravnc_susp_execution.yml"
      }
    },
    {
      "id": "f8ad2e2c-40b6-4117-84d7-20b89896ab23",
      "title": "Suspicious Scan Loop Network",
      "status": "test",
      "description": "Adversaries may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059",
        "attack.discovery",
        "attack.t1018"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_loop": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "for ",
                  "foreach "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_tools": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "nslookup",
                  "ping"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059",
          "T1018"
        ],
        "tactics": [
          "execution",
          "discovery"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-03-12",
        "modified": "",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1018/T1018.md",
          "https://ss64.com/nt/for.html",
          "https://ss64.com/ps/foreach-object.html"
        ],
        "falsepositives": [
          "Legitimate script"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_network_scan_loop.yml"
      }
    },
    {
      "id": "4627c6ae-6899-46e2-aa0c-6ebcb1becd19",
      "title": "HackTool - Impacket Tools Execution",
      "status": "test",
      "description": "Detects the execution of different compiled Windows binaries of the impacket toolset (based on names or part of their names - could lead to false positives)",
      "level": "high",
      "tags": [
        "attack.collection",
        "attack.execution",
        "attack.credential-access",
        "attack.t1557.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__contains": {
                    "field": "Image",
                    "value": [
                      "\\goldenPac",
                      "\\karmaSMB",
                      "\\kintercept",
                      "\\ntlmrelayx",
                      "\\rpcdump",
                      "\\samrdump",
                      "\\secretsdump",
                      "\\smbexec",
                      "\\smbrelayx",
                      "\\wmiexec",
                      "\\wmipersist"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\atexec_windows.exe",
                      "\\dcomexec_windows.exe",
                      "\\dpapi_windows.exe",
                      "\\findDelegation_windows.exe",
                      "\\GetADUsers_windows.exe",
                      "\\GetNPUsers_windows.exe",
                      "\\getPac_windows.exe",
                      "\\getST_windows.exe",
                      "\\getTGT_windows.exe",
                      "\\GetUserSPNs_windows.exe",
                      "\\ifmap_windows.exe",
                      "\\mimikatz_windows.exe",
                      "\\netview_windows.exe",
                      "\\nmapAnswerMachine_windows.exe",
                      "\\opdump_windows.exe",
                      "\\psexec_windows.exe",
                      "\\rdp_check_windows.exe",
                      "\\sambaPipe_windows.exe",
                      "\\smbclient_windows.exe",
                      "\\smbserver_windows.exe",
                      "\\sniff_windows.exe",
                      "\\sniffer_windows.exe",
                      "\\split_windows.exe",
                      "\\ticketer_windows.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1557.001"
        ],
        "tactics": [
          "collection",
          "execution",
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-07-24",
        "modified": "2023-02-07",
        "references": [
          "https://github.com/ropnop/impacket_static_binaries/releases/tag/0.9.21-dev-binaries"
        ],
        "falsepositives": [
          "Legitimate use of the impacket tools"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_impacket_tools.yml"
      }
    },
    {
      "id": "48a61b29-389f-4032-b317-b30de6b95314",
      "title": "Suspicious Plink Port Forwarding",
      "status": "test",
      "description": "Detects suspicious Plink tunnel port forwarding to a local port",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1572",
        "attack.lateral-movement",
        "attack.t1021.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Description": {
                "field": "Description",
                "value": "Command-line SSH, Telnet, and Rlogin client",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -R ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1572",
          "T1021.001"
        ],
        "tactics": [
          "command_and_control",
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-01-19",
        "modified": "2022-10-09",
        "references": [
          "https://www.real-sec.com/2019/04/bypassing-network-restrictions-through-rdp-tunneling/",
          "https://medium.com/@informationsecurity/remote-ssh-tunneling-with-plink-exe-7831072b3d7d"
        ],
        "falsepositives": [
          "Administrative activity using a remote port forwarding to a local port"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_plink_port_forwarding.yml"
      }
    },
    {
      "id": "06b401f4-107c-4ff9-947f-9ec1e7649f1e",
      "title": "Potential Arbitrary Command Execution Via FTP.EXE",
      "status": "test",
      "description": "Detects execution of \"ftp.exe\" script with the \"-s\" or \"/s\" flag and any child processes ran by \"ftp.exe\".",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059",
        "attack.defense-evasion",
        "attack.t1202"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\ftp.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_child_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\ftp.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "ftp.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_child_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-s:",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_parent or all of selection_child_*",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection_parent",
            "all of selection_child_*"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1059",
          "T1202"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Victor Sergeev, oscd.community",
        "date": "2020-10-09",
        "modified": "2024-04-23",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Ftp/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_ftp_arbitrary_command_execution.yml"
      }
    },
    {
      "id": "9aa5106d-bce3-4b13-86df-3a20f1d5cf0b",
      "title": "Forfiles Command Execution",
      "status": "test",
      "description": "Detects the execution of \"forfiles\" with the \"/c\" flag.\nWhile this is an expected behavior of the tool, it can be abused in order to proxy execution through it with any binary.\nCan be used to bypass application whitelisting.\n",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\forfiles.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "forfiles.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -c ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Tim Rauch, Elastic, E.M. Anhaus (originally from Atomic Blue Detections, Endgame), oscd.community",
        "date": "2022-06-14",
        "modified": "2024-03-05",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Forfiles/",
          "https://pentestlab.blog/2020/07/06/indirect-command-execution/"
        ],
        "falsepositives": [
          "Legitimate use via a batch script or by an administrator."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_forfiles_proxy_execution_.yml"
      }
    },
    {
      "id": "6d3a3952-6530-44a3-8554-cf17c116c615",
      "title": "Potentially Suspicious JWT Token Search Via CLI",
      "status": "test",
      "description": "Detects potentially suspicious search for JWT tokens via CLI by looking for the string \"eyJ0eX\" or \"eyJhbG\".\nJWT tokens are often used for access-tokens across various applications and services like Microsoft 365, Azure, AWS, Google Cloud, and others.\nThreat actors may search for these tokens to steal them for lateral movement or privilege escalation.\n",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.t1528",
        "attack.t1552.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_tools": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "find ",
                  "find.exe",
                  "findstr",
                  "select-string ",
                  "strings"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_jwt_string": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "eyJ0eXAiOi",
                  "eyJhbGciOi",
                  " eyJ0eX",
                  " \"eyJ0eX\"",
                  " 'eyJ0eX'",
                  " eyJhbG",
                  " \"eyJhbG\"",
                  " 'eyJhbG'"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1528",
          "T1552.001"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), kagebunsher",
        "date": "2022-10-25",
        "modified": "2025-10-21",
        "references": [
          "https://mrd0x.com/stealing-tokens-from-office-applications/",
          "https://www.scip.ch/en/?labs.20240523"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_jwt_token_search.yml"
      }
    },
    {
      "id": "b697e69c-746f-4a86-9f59-7bfff8eab881",
      "title": "UAC Bypass Using Disk Cleanup",
      "status": "test",
      "description": "Detects the pattern of UAC Bypass using scheduled tasks and variable expansion of cleanmgr.exe (UACMe 34)",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": "\"\\system32\\cleanmgr.exe /autoclean /d C:",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "ParentCommandLine": {
                "field": "ParentCommandLine",
                "value": "C:\\Windows\\system32\\svchost.exe -k netsvcs -p -s Schedule",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "IntegrityLevel": {
                "field": "IntegrityLevel",
                "value": [
                  "High",
                  "System",
                  "S-1-16-16384",
                  "S-1-16-12288"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Christian Burkard (Nextron Systems)",
        "date": "2021-08-30",
        "modified": "2024-12-01",
        "references": [
          "https://github.com/hfiref0x/UACME"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_uac_bypass_cleanmgr.yml"
      }
    },
    {
      "id": "8cbc9475-8d05-4e27-9c32-df960716c701",
      "title": "Potentially Suspicious Desktop Background Change Using Reg.EXE",
      "status": "test",
      "description": "Detects the execution of \"reg.exe\" to alter registry keys that would replace the user's desktop background.\nThis is a common technique used by malware to change the desktop background to a ransom note or other image.\n",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.impact",
        "attack.t1112",
        "attack.t1491.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_reg_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\reg.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "reg.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_reg_flag": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "add",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_keys": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Control Panel\\Desktop",
                  "CurrentVersion\\Policies\\ActiveDesktop",
                  "CurrentVersion\\Policies\\System"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_reg_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/v NoChangingWallpaper",
                  "/d 1"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_reg_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/v Wallpaper",
                  "/t REG_SZ"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_reg_3": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/v WallpaperStyle",
                  "/d 2"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_reg_* and selection_keys and 1 of selection_cli_reg_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "all of selection_reg_*"
            },
            {
              "type": "ref",
              "value": "selection_keys"
            },
            {
              "type": "ref",
              "value": "1 of selection_cli_reg_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1112",
          "T1491.001"
        ],
        "tactics": [
          "persistence",
          "defense_evasion",
          "impact"
        ]
      },
      "meta": {
        "author": "Stephen Lincoln @slincoln-aiq (AttackIQ)",
        "date": "2023-12-21",
        "modified": "",
        "references": [
          "https://www.attackiq.com/2023/09/20/emulating-rhysida/",
          "https://research.checkpoint.com/2023/the-rhysida-ransomware-activity-analysis-and-ties-to-vice-society/",
          "https://www.trendmicro.com/en_us/research/23/h/an-overview-of-the-new-rhysida-ransomware.html",
          "https://www.virustotal.com/gui/file/a864282fea5a536510ae86c77ce46f7827687783628e4f2ceb5bf2c41b8cd3c6/behavior",
          "https://admx.help/?Category=Windows_10_2016&Policy=Microsoft.Policies.WindowsDesktop::Wallpaper",
          "https://admx.help/?Category=Windows_10_2016&Policy=Microsoft.Policies.ControlPanelDisplay::CPL_Personalization_NoDesktopBackgroundUI"
        ],
        "falsepositives": [
          "Administrative scripts that change the desktop background to a company logo or other image."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_reg_desktop_background_change.yml"
      }
    },
    {
      "id": "1723e720-616d-4ddc-ab02-f7e3685a4713",
      "title": "Rundll32 Spawned Via Explorer.EXE",
      "status": "test",
      "description": "Detects execution of \"rundll32.exe\" with a parent process of Explorer.exe. This has been observed by variants of Raspberry Robin, as first reported by Red Canary.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\explorer.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\rundll32.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "RUNDLL32.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_main_generic": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": " C:\\Windows\\System32\\",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__endswith": {
                    "field": "CommandLine",
                    "value": " -localserver 22d8c27b-47a1-48d1-ad08-7da7abd79617",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "condition": "all of selection_* and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_main_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "CD_ROM_",
        "date": "2022-05-21",
        "modified": "2023-08-31",
        "references": [
          "https://redcanary.com/blog/raspberry-robin/",
          "https://thedfirreport.com/2022/09/26/bumblebee-round-two/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_rundll32_parent_explorer.yml"
      }
    },
    {
      "id": "28ac00d6-22d9-4a3c-927f-bbd770104573",
      "title": "RestrictedAdminMode Registry Value Tampering - ProcCreation",
      "status": "test",
      "description": "Detects changes to the \"DisableRestrictedAdmin\" registry value in order to disable or enable RestrictedAdmin mode.\nRestrictedAdmin mode prevents the transmission of reusable credentials to the remote system to which you connect using Remote Desktop.\nThis prevents your credentials from being harvested during the initial connection process if the remote server has been compromise\n",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "\\System\\CurrentControlSet\\Control\\Lsa",
                  "DisableRestrictedAdmin"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2023-01-13",
        "modified": "2025-08-28",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/a8e3cf63e97b973a25903d3df9fd55da6252e564/atomics/T1112/T1112.md",
          "https://social.technet.microsoft.com/wiki/contents/articles/32905.remote-desktop-services-enable-restricted-admin-mode.aspx",
          "https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_reg_lsa_disable_restricted_admin.yml"
      }
    },
    {
      "id": "53ef0cef-fa24-4f25-a34a-6c72dfa2e6e2",
      "title": "Query Usage To Exfil Data",
      "status": "test",
      "description": "Detects usage of \"query.exe\" a system binary to exfil information such as \"sessions\" and \"processes\" for later use",
      "level": "medium",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": ":\\Windows\\System32\\query.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "session >",
                  "process >"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-01",
        "modified": "2023-01-19",
        "references": [
          "https://twitter.com/MichalKoczwara/status/1553634816016498688"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_query_session_exfil.yml"
      }
    },
    {
      "id": "431a1fdb-4799-4f3b-91c3-a683b003fc49",
      "title": "New Kernel Driver Via SC.EXE",
      "status": "test",
      "description": "Detects creation of a new service (kernel driver) with the type \"kernel\"",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.privilege-escalation",
        "attack.t1543.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\sc.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "create",
                  "config"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "binPath",
                  "type",
                  "kernel"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_avira_driver": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "create netprotection_network_filter",
                      "type= kernel start= ",
                      "binPath= System32\\drivers\\netprotection_network_filter",
                      "DisplayName= netprotection_network_filter",
                      "group= PNP_TDI tag= yes"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "create avelam binpath=C:\\Windows\\system32\\drivers\\avelam.sys",
                      "type=kernel start=boot error=critical group=Early-Launch"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "condition": "selection and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1543.003"
        ],
        "tactics": [
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-07-14",
        "modified": "2025-10-07",
        "references": [
          "https://www.aon.com/cyber-solutions/aon_cyber_labs/yours-truly-signed-av-driver-weaponizing-an-antivirus-driver/"
        ],
        "falsepositives": [
          "Rare legitimate installation of kernel drivers via sc.exe"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sc_new_kernel_driver.yml"
      }
    },
    {
      "id": "56454143-524f-49fb-b1c6-3fb8b1ad41fb",
      "title": "Suspicious File Download From File Sharing Domain Via Curl.EXE",
      "status": "test",
      "description": "Detects potentially suspicious file download from file sharing domains using curl.exe",
      "level": "high",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\curl.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "curl.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_websites": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ".githubusercontent.com",
                  "anonfiles.com",
                  "cdn.discordapp.com",
                  "ddns.net",
                  "dl.dropboxusercontent.com",
                  "ghostbin.co",
                  "github.com",
                  "glitch.me",
                  "gofile.io",
                  "hastebin.com",
                  "mediafire.com",
                  "mega.nz",
                  "onrender.com",
                  "pages.dev",
                  "paste.ee",
                  "pastebin.com",
                  "pastebin.pl",
                  "pastetext.net",
                  "pixeldrain.com",
                  "privatlab.com",
                  "privatlab.net",
                  "send.exploit.in",
                  "sendspace.com",
                  "storage.googleapis.com",
                  "storjshare.io",
                  "supabase.co",
                  "temp.sh",
                  "transfer.sh",
                  "trycloudflare.com",
                  "ufile.io",
                  "w3spaces.com",
                  "workers.dev"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_http": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "http",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_flag": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -O",
                  "--remote-name",
                  "--output"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_ext": {
            "type": "field_match",
            "matchers": {
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": [
                  ".ps1",
                  ".ps1'",
                  ".ps1\"",
                  ".dat",
                  ".dat'",
                  ".dat\"",
                  ".msi",
                  ".msi'",
                  ".msi\"",
                  ".bat",
                  ".bat'",
                  ".bat\"",
                  ".exe",
                  ".exe'",
                  ".exe\"",
                  ".vbs",
                  ".vbs'",
                  ".vbs\"",
                  ".vbe",
                  ".vbe'",
                  ".vbe\"",
                  ".hta",
                  ".hta'",
                  ".hta\"",
                  ".dll",
                  ".dll'",
                  ".dll\"",
                  ".psm1",
                  ".psm1'",
                  ".psm1\""
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-05",
        "modified": "2025-12-10",
        "references": [
          "https://labs.withsecure.com/publications/fin7-target-veeam-servers",
          "https://github.com/WithSecureLabs/iocs/blob/344203de742bb7e68bd56618f66d34be95a9f9fc/FIN7VEEAM/iocs.csv"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_curl_download_susp_file_sharing_domains.yml"
      }
    },
    {
      "id": "bdeb2cff-af74-4094-8426-724dc937f20a",
      "title": "PowerShell Script Change Permission Via Set-Acl",
      "status": "test",
      "description": "Detects PowerShell execution to set the ACL of a file or a folder",
      "level": "high",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cmdlet": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "Set-Acl ",
                  "-AclObject ",
                  "-Path "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-10-18",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.security/set-acl?view=powershell-5.1",
          "https://github.com/redcanaryco/atomic-red-team/blob/74438b0237d141ee9c99747976447dc884cb1a39/atomics/T1505.005/T1505.005.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_set_acl.yml"
      }
    },
    {
      "id": "43d91656-a9b2-4541-b7e2-6a9bd3a13f4e",
      "title": "DSInternals Suspicious PowerShell Cmdlets",
      "status": "test",
      "description": "Detects execution and usage of the DSInternals PowerShell module. Which can be used to perform what might be considered as suspicious activity such as dumping DPAPI backup keys or manipulating NTDS.DIT files.\nThe DSInternals PowerShell Module exposes several internal features of Active Directory and Azure Active Directory. These include FIDO2 and NGC key auditing, offline ntds.dit file manipulation, password auditing, DC recovery from IFM backups and password hash calculation.\n",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Add-ADDBSidHistory",
                  "Add-ADNgcKey",
                  "Add-ADReplNgcKey",
                  "ConvertFrom-ADManagedPasswordBlob",
                  "ConvertFrom-GPPrefPassword",
                  "ConvertFrom-ManagedPasswordBlob",
                  "ConvertFrom-UnattendXmlPassword",
                  "ConvertFrom-UnicodePassword",
                  "ConvertTo-AADHash",
                  "ConvertTo-GPPrefPassword",
                  "ConvertTo-KerberosKey",
                  "ConvertTo-LMHash",
                  "ConvertTo-MsoPasswordHash",
                  "ConvertTo-NTHash",
                  "ConvertTo-OrgIdHash",
                  "ConvertTo-UnicodePassword",
                  "Disable-ADDBAccount",
                  "Enable-ADDBAccount",
                  "Get-ADDBAccount",
                  "Get-ADDBBackupKey",
                  "Get-ADDBDomainController",
                  "Get-ADDBGroupManagedServiceAccount",
                  "Get-ADDBKdsRootKey",
                  "Get-ADDBSchemaAttribute",
                  "Get-ADDBServiceAccount",
                  "Get-ADDefaultPasswordPolicy",
                  "Get-ADKeyCredential",
                  "Get-ADPasswordPolicy",
                  "Get-ADReplAccount",
                  "Get-ADReplBackupKey",
                  "Get-ADReplicationAccount",
                  "Get-ADSIAccount",
                  "Get-AzureADUserEx",
                  "Get-BootKey",
                  "Get-KeyCredential",
                  "Get-LsaBackupKey",
                  "Get-LsaPolicy",
                  "Get-SamPasswordPolicy",
                  "Get-SysKey",
                  "Get-SystemKey",
                  "New-ADDBRestoreFromMediaScript",
                  "New-ADKeyCredential",
                  "New-ADNgcKey",
                  "New-NTHashSet",
                  "Remove-ADDBObject",
                  "Save-DPAPIBlob",
                  "Set-ADAccountPasswordHash",
                  "Set-ADDBAccountPassword",
                  "Set-ADDBBootKey",
                  "Set-ADDBDomainController",
                  "Set-ADDBPrimaryGroup",
                  "Set-ADDBSysKey",
                  "Set-AzureADUserEx",
                  "Set-LsaPolicy",
                  "Set-SamAccountPasswordHash",
                  "Set-WinUserPasswordHash",
                  "Test-ADDBPasswordQuality",
                  "Test-ADPasswordQuality",
                  "Test-ADReplPasswordQuality",
                  "Test-PasswordQuality",
                  "Unlock-ADDBAccount",
                  "Write-ADNgcKey",
                  "Write-ADReplNgcKey"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), Nounou Mbeiri",
        "date": "2024-06-26",
        "modified": "",
        "references": [
          "https://github.com/MichaelGrafnetter/DSInternals/blob/39ee8a69bbdc1cfd12c9afdd7513b4788c4895d4/Src/DSInternals.PowerShell/DSInternals.psd1"
        ],
        "falsepositives": [
          "Legitimate usage of DSInternals for administration or audit purpose."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_dsinternals_cmdlets.yml"
      }
    },
    {
      "id": "037dcd71-33a8-4392-bb01-293c94663e5a",
      "title": "File Decryption Using Gpg4win",
      "status": "test",
      "description": "Detects usage of Gpg4win to decrypt files",
      "level": "medium",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_metadata": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\gpg.exe",
                      "\\gpg2.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "GnuPG’s OpenPGP tool",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " -d ",
                  "passphrase"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-08-09",
        "modified": "",
        "references": [
          "https://blogs.vmware.com/security/2022/11/batloader-the-evasive-downloader-malware.html",
          "https://www.gpg4win.de/documentation.html",
          "https://news.sophos.com/en-us/2022/01/19/zloader-installs-remote-access-backdoors-and-delivers-cobalt-strike/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_gpg4win_decryption.yml"
      }
    },
    {
      "id": "575dce0c-8139-4e30-9295-1ee75969f7fe",
      "title": "Potential Reconnaissance Activity Via GatherNetworkInfo.VBS",
      "status": "test",
      "description": "Detects execution of the built-in script located in \"C:\\Windows\\System32\\gatherNetworkInfo.vbs\". Which can be used to gather information about the target machine",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.execution",
        "attack.t1615",
        "attack.t1059.005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\cscript.exe",
                      "\\wscript.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "cscript.exe",
                      "wscript.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "gatherNetworkInfo.vbs",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1615",
          "T1059.005"
        ],
        "tactics": [
          "discovery",
          "execution"
        ]
      },
      "meta": {
        "author": "blueteamer8699",
        "date": "2022-01-03",
        "modified": "2023-02-08",
        "references": [
          "https://posts.slayerlabs.com/living-off-the-land/#gathernetworkinfovbs",
          "https://www.mandiant.com/resources/blog/trojanized-windows-installers-ukrainian-government"
        ],
        "falsepositives": [
          "Administrative activity"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_gather_network_info.yml"
      }
    },
    {
      "id": "8b0e12da-d3c3-49db-bb4f-256703f380e5",
      "title": "PUA - Chisel Tunneling Tool Execution",
      "status": "test",
      "description": "Detects usage of the Chisel tunneling tool via the commandline arguments",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1090.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\chisel.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_param1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "exe client ",
                  "exe server "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_param2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "-socks5",
                  "-reverse",
                  " r:",
                  ":127.0.0.1:",
                  "-tls-skip-verify ",
                  ":socks"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_img or all of selection_param*",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection_img",
            "all of selection_param*"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1090.001"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-09-13",
        "modified": "2023-02-13",
        "references": [
          "https://github.com/jpillora/chisel/",
          "https://arcticwolf.com/resources/blog/lorenz-ransomware-chiseling-in/",
          "https://blog.sekoia.io/lucky-mouse-incident-response-to-detection-engineering/"
        ],
        "falsepositives": [
          "Some false positives may occur with other tools with similar commandlines"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_chisel.yml"
      }
    },
    {
      "id": "c7942406-33dd-4377-a564-0f62db0593a3",
      "title": "Suspicious CodePage Switch Via CHCP",
      "status": "test",
      "description": "Detects a code page switch in command line or batch scripts to a rare language",
      "level": "medium",
      "tags": [
        "attack.t1036",
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\chcp.com",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": [
                  " 936",
                  " 1258"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1036"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Jonhnathan Ribeiro, oscd.community",
        "date": "2019-10-14",
        "modified": "2023-03-07",
        "references": [
          "https://learn.microsoft.com/en-us/windows/win32/intl/code-page-identifiers",
          "https://twitter.com/cglyer/status/1183756892952248325"
        ],
        "falsepositives": [
          "Administrative activity (adjust code pages according to your organization's region)"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_chcp_codepage_switch.yml"
      }
    },
    {
      "id": "631b22a4-70f4-4e2f-9ea8-42f84d9df6d8",
      "title": "Suspicious AddinUtil.EXE CommandLine Execution",
      "status": "test",
      "description": "Detects execution of the Add-In deployment cache updating utility (AddInutil.exe) with suspicious Addinroot or Pipelineroot paths. An adversary may execute AddinUtil.exe with uncommon Addinroot/Pipelineroot paths that point to the adversaries Addins.Store payload.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\addinutil.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "AddInUtil.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_susp_1_flags": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "-AddInRoot:",
                  "-PipelineRoot:"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_susp_1_paths": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\AppData\\Local\\Temp\\",
                  "\\Desktop\\",
                  "\\Downloads\\",
                  "\\Users\\Public\\",
                  "\\Windows\\Temp\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_susp_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "-AddInRoot:.",
                  "-AddInRoot:\".\"",
                  "-PipelineRoot:.",
                  "-PipelineRoot:\".\""
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "CurrentDirectory__contains": {
                "field": "CurrentDirectory",
                "value": [
                  "\\AppData\\Local\\Temp\\",
                  "\\Desktop\\",
                  "\\Downloads\\",
                  "\\Users\\Public\\",
                  "\\Windows\\Temp\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_img and (all of selection_susp_1_* or selection_susp_2)",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection_img and (all of selection_susp_1_*",
            "selection_susp_2)"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), Michael McKinley (@McKinleyMike), Tony Latteri (@TheLatteri)",
        "date": "2023-09-18",
        "modified": "",
        "references": [
          "https://www.blue-prints.blog/content/blog/posts/lolbin/addinutil-lolbas.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_addinutil_suspicious_cmdline.yml"
      }
    },
    {
      "id": "b99a1518-1ad5-4f65-bc95-1ffff97a8fd0",
      "title": "HackTool - Inveigh Execution",
      "status": "test",
      "description": "Detects the use of Inveigh a cross-platform .NET IPv4/IPv6 machine-in-the-middle tool",
      "level": "critical",
      "tags": [
        "attack.credential-access",
        "attack.t1003.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\Inveigh.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "\\Inveigh.exe",
                      "\\Inveigh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "Inveigh",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      " -SpooferIP",
                      " -ReplyToIPs ",
                      " -ReplyToDomains ",
                      " -ReplyToMACs ",
                      " -SnifferIP"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.001"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-10-24",
        "modified": "2023-02-04",
        "references": [
          "https://github.com/Kevin-Robertson/Inveigh",
          "https://thedfirreport.com/2020/11/23/pysa-mespinoza-ransomware/"
        ],
        "falsepositives": [
          "Very unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_inveigh.yml"
      }
    },
    {
      "id": "2433a154-bb3d-42e4-86c3-a26bdac91c45",
      "title": "Renamed PingCastle Binary Execution",
      "status": "test",
      "description": "Detects the execution of a renamed \"PingCastle\" binary based on the PE metadata fields.",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059",
        "attack.defense-evasion",
        "attack.t1202"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PingCastleReporting.exe",
                      "PingCastleCloud.exe",
                      "PingCastle.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      "--scanner aclcheck",
                      "--scanner antivirus",
                      "--scanner computerversion",
                      "--scanner foreignusers",
                      "--scanner laps_bitlocker",
                      "--scanner localadmin",
                      "--scanner nullsession",
                      "--scanner nullsession-trust",
                      "--scanner oxidbindings",
                      "--scanner remote",
                      "--scanner share",
                      "--scanner smb",
                      "--scanner smb3querynetwork",
                      "--scanner spooler",
                      "--scanner startup",
                      "--scanner zerologon"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": "--no-enum-limit",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "--healthcheck",
                      "--level Full"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "--healthcheck",
                      "--server "
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_main_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\PingCastleReporting.exe",
                  "\\PingCastleCloud.exe",
                  "\\PingCastle.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1059",
          "T1202"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), X__Junior (Nextron Systems)",
        "date": "2024-01-11",
        "modified": "",
        "references": [
          "https://thedfirreport.com/2023/10/30/netsupport-intrusion-results-in-domain-compromise/",
          "https://www.pingcastle.com/documentation/scanner/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_renamed_pingcastle.yml"
      }
    },
    {
      "id": "c73124a7-3e89-44a3-bdc1-25fe4df754b1",
      "title": "Copy From VolumeShadowCopy Via Cmd.EXE",
      "status": "test",
      "description": "Detects the execution of the builtin \"copy\" command that targets a shadow copy (sometimes used to copy registry hives that are in use)",
      "level": "high",
      "tags": [
        "attack.impact",
        "attack.t1490"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "copy ",
                  "\\\\\\\\\\?\\\\GLOBALROOT\\\\Device\\\\HarddiskVolumeShadowCopy"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1490"
        ],
        "tactics": [
          "impact"
        ]
      },
      "meta": {
        "author": "Max Altgelt (Nextron Systems), Tobias Michalski (Nextron Systems)",
        "date": "2021-08-09",
        "modified": "2023-03-07",
        "references": [
          "https://twitter.com/vxunderground/status/1423336151860002816?s=20",
          "https://www.virustotal.com/gui/file/03e9b8c2e86d6db450e5eceec057d7e369ee2389b9daecaf06331a95410aa5f8/detection",
          "https://pentestlab.blog/2018/07/04/dumping-domain-password-hashes/"
        ],
        "falsepositives": [
          "Backup scenarios using the commandline"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_cmd_shadowcopy_access.yml"
      }
    },
    {
      "id": "1e8a9b4d-3c2a-4f9b-8d1e-7c6a5b4f3d2e",
      "title": "PowerShell Defender Threat Severity Default Action Set to 'Allow' or 'NoAction'",
      "status": "experimental",
      "description": "Detects the use of PowerShell to execute the 'Set-MpPreference' cmdlet to configure Windows Defender's threat severity default action to 'Allow' (value '6') or 'NoAction' (value '9').\nThis is a highly suspicious configuration change that effectively disables Defender's ability to automatically mitigate threats of a certain severity level.\nAn attacker might use this technique via the command line to bypass defenses before executing payloads.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_cmdlet": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "Set-MpPreference",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_action": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "-LowThreatDefaultAction",
                  "-ModerateThreatDefaultAction",
                  "-HighThreatDefaultAction",
                  "-SevereThreatDefaultAction",
                  "-ltdefac ",
                  "-mtdefac ",
                  "-htdefac ",
                  "-stdefac "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_value": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Allow",
                  "6",
                  "NoAction",
                  "9"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Matt Anderson (Huntress)",
        "date": "2025-07-11",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/powershell/module/defender/set-mppreference",
          "https://learn.microsoft.com/en-us/windows-hardware/customize/desktop/unattend/security-malware-windows-defender-threatseveritydefaultaction",
          "https://research.splunk.com/endpoint/7215831c-8252-4ae3-8d43-db588e82f952",
          "https://gist.github.com/Dump-GUY/8daef859f382b895ac6fd0cf094555d2",
          "https://thedfirreport.com/2021/10/18/icedid-to-xinglocker-ransomware-in-24-hours/"
        ],
        "falsepositives": [
          "Highly unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_defender_default_action_modified.yml"
      }
    },
    {
      "id": "4782eb5a-a513-4523-a0ac-f3082b26ac5c",
      "title": "Mshtml.DLL RunHTMLApplication Suspicious Usage",
      "status": "test",
      "description": "Detects execution of commands that leverage the \"mshtml.dll\" RunHTMLApplication export to run arbitrary code via different protocol handlers (vbscript, javascript, file, http...)\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "\\..\\",
                  "mshtml"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "#135",
                  "RunHTMLApplication"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems),  Florian Roth (Nextron Systems), Josh Nickels, frack113, Zaw Min Htun (ZETA)",
        "date": "2022-08-14",
        "modified": "2024-02-23",
        "references": [
          "https://twitter.com/n1nj4sec/status/1421190238081277959",
          "https://hyp3rlinx.altervista.org/advisories/MICROSOFT_WINDOWS_DEFENDER_TROJAN.WIN32.POWESSERE.G_MITIGATION_BYPASS_PART2.txt",
          "http://hyp3rlinx.altervista.org/advisories/MICROSOFT_WINDOWS_DEFENDER_DETECTION_BYPASS.txt"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_rundll32_mshtml_runhtmlapplication.yml"
      }
    },
    {
      "id": "e66779cc-383e-4224-a3a4-267eeb585c40",
      "title": "Bypass UAC via CMSTP",
      "status": "test",
      "description": "Detect commandline usage of Microsoft Connection Manager Profile Installer (cmstp.exe) to install specially formatted local .INF files",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.defense-evasion",
        "attack.t1548.002",
        "attack.t1218.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\cmstp.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "CMSTP.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "/s",
                  "-s",
                  "/au",
                  "-au",
                  "/ni",
                  "-ni"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002",
          "T1218.003"
        ],
        "tactics": [
          "privilege_escalation",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "E.M. Anhaus (originally from Atomic Blue Detections, Endgame), oscd.community",
        "date": "2019-10-24",
        "modified": "2022-08-30",
        "references": [
          "https://eqllib.readthedocs.io/en/latest/analytics/e584f1a1-c303-4885-8a66-21360c90995b.html",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1218.003/T1218.003.md",
          "https://lolbas-project.github.io/lolbas/Binaries/Cmstp/"
        ],
        "falsepositives": [
          "Legitimate use of cmstp.exe utility by legitimate user"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_uac_bypass_cmstp.yml"
      }
    },
    {
      "id": "75d0a94e-6252-448d-a7be-d953dff527bb",
      "title": "Remote XSL Execution Via Msxsl.EXE",
      "status": "test",
      "description": "Detects the execution of the \"msxsl\" binary with an \"http\" keyword in the command line. This might indicate a potential remote execution of XSL files.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1220"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\msxsl.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "http",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1220"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel",
        "date": "2023-11-09",
        "modified": "",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1220/T1220.md",
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Msxsl/"
        ],
        "falsepositives": [
          "Msxsl is not installed by default and is deprecated, so unlikely on most systems."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_msxsl_remote_execution.yml"
      }
    },
    {
      "id": "dff1e1cc-d3fd-47c8-bfc2-aeb878a754c0",
      "title": "Shell Process Spawned by Java.EXE",
      "status": "test",
      "description": "Detects shell spawned from Java host process, which could be a sign of exploitation (e.g. log4j exploitation)",
      "level": "medium",
      "tags": [
        "attack.initial-access",
        "attack.persistence",
        "attack.privilege-escalation"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\java.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\bash.exe",
                  "\\cmd.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_build": {
            "type": "field_match",
            "matchers": {
              "ParentImage__contains": {
                "field": "ParentImage",
                "value": "build",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "build",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "initial_access",
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Andreas Hunkeler (@Karneades), Nasreddine Bencherchali",
        "date": "2021-12-17",
        "modified": "2024-01-18",
        "references": [
          "https://web.archive.org/web/20231230220738/https://www.lunasec.io/docs/blog/log4j-zero-day/"
        ],
        "falsepositives": [
          "Legitimate calls to system binaries",
          "Company specific internal usage"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_java_susp_child_process_2.yml"
      }
    },
    {
      "id": "30d07da2-83ab-45d8-ae75-ec7c0edcaffc",
      "title": "Renamed BOINC Client Execution",
      "status": "test",
      "description": "Detects the execution of a renamed BOINC binary.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1553"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "OriginalFileName": {
                "field": "OriginalFileName",
                "value": "BOINC.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_legit_name": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\BOINC.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1553"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Matt Anderson (Huntress)",
        "date": "2024-07-23",
        "modified": "",
        "references": [
          "https://boinc.berkeley.edu/",
          "https://www.virustotal.com/gui/file/91e405e8a527023fb8696624e70498ae83660fe6757cef4871ce9bcc659264d3/details",
          "https://www.huntress.com/blog/fake-browser-updates-lead-to-boinc-volunteer-computing-software"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_renamed_boinc.yml"
      }
    },
    {
      "id": "4bf943c6-5146-4273-98dd-e958fd1e3abf",
      "title": "Invoke-Obfuscation Obfuscated IEX Invocation",
      "status": "test",
      "description": "Detects all variations of obfuscated powershell IEX invocation code generated by Invoke-Obfuscation framework from the following code block",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027",
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__re": {
                    "field": "CommandLine",
                    "value": "\\$PSHome\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$PSHome\\[",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__re": {
                    "field": "CommandLine",
                    "value": "\\$ShellId\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$ShellId\\[",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__re": {
                    "field": "CommandLine",
                    "value": "\\$env:Public\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$env:Public\\[",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__re": {
                    "field": "CommandLine",
                    "value": "\\$env:ComSpec\\[(\\s*\\d{1,3}\\s*,){2}",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__re": {
                    "field": "CommandLine",
                    "value": "\\*mdr\\*\\W\\s*\\)\\.Name",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__re": {
                    "field": "CommandLine",
                    "value": "\\$VerbosePreference\\.ToString\\(",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__re": {
                    "field": "CommandLine",
                    "value": "\\[String\\]\\s*\\$VerbosePreference",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1027",
          "T1059.001"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Daniel Bohannon (@Mandiant/@FireEye), oscd.community",
        "date": "2019-11-08",
        "modified": "2022-12-31",
        "references": [
          "https://github.com/danielbohannon/Invoke-Obfuscation/blob/f20e7f843edd0a3a7716736e9eddfa423395dd26/Out-ObfuscatedStringCommand.ps1#L873-L888"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_invoke_obfuscation_obfuscated_iex_commandline.yml"
      }
    },
    {
      "id": "07aa184a-870d-413d-893a-157f317f6f58",
      "title": "Suspicious Reconnaissance Activity Via GatherNetworkInfo.VBS",
      "status": "test",
      "description": "Detects execution of the built-in script located in \"C:\\Windows\\System32\\gatherNetworkInfo.vbs\". Which can be used to gather information about the target machine",
      "level": "high",
      "tags": [
        "attack.discovery",
        "attack.execution",
        "attack.t1615",
        "attack.t1059.005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "gatherNetworkInfo.vbs",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\cscript.exe",
                  "\\wscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1615",
          "T1059.005"
        ],
        "tactics": [
          "discovery",
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-02-08",
        "modified": "",
        "references": [
          "https://posts.slayerlabs.com/living-off-the-land/#gathernetworkinfovbs",
          "https://www.mandiant.com/resources/blog/trojanized-windows-installers-ukrainian-government"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_gather_network_info_execution.yml"
      }
    },
    {
      "id": "0ba863e6-def5-4e50-9cea-4dd8c7dc46a4",
      "title": "Control Panel Items",
      "status": "test",
      "description": "Detects the malicious use of a control panel item",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.execution",
        "attack.defense-evasion",
        "attack.t1218.002",
        "attack.persistence",
        "attack.t1546"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_reg_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\reg.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "reg.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_reg_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "add",
                  "CurrentVersion\\Control Panel\\CPLs"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cpl": {
            "type": "field_match",
            "matchers": {
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": ".cpl",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_cpl_sys": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\System32\\",
                  "%System%",
                  "|C:\\Windows\\system32|"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_cpl_igfx": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "regsvr32 ",
                  " /s ",
                  "igfxCPL.cpl"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_reg_* or (selection_cpl and not 1 of filter_cpl_*)",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "all of selection_reg_*",
            "(selection_cpl and not 1 of filter_cpl_*)"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218.002",
          "T1546"
        ],
        "tactics": [
          "privilege_escalation",
          "execution",
          "defense_evasion",
          "persistence"
        ]
      },
      "meta": {
        "author": "Kyaw Min Thein, Furkan Caliskan (@caliskanfurkan_)",
        "date": "2020-06-22",
        "modified": "2023-10-11",
        "references": [
          "https://ired.team/offensive-security/code-execution/code-execution-through-control-panel-add-ins"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_control_panel_item.yml"
      }
    },
    {
      "id": "69ca006d-b9a9-47f5-80ff-ecd4d25d481a",
      "title": "HackTool - TruffleSnout Execution",
      "status": "test",
      "description": "Detects the use of TruffleSnout.exe an iterative AD discovery toolkit for offensive operators, situational awareness and targeted low noise enumeration.",
      "level": "high",
      "tags": [
        "attack.discovery",
        "attack.t1482"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "TruffleSnout.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\TruffleSnout.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1482"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-08-20",
        "modified": "2023-02-13",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1482/T1482.md",
          "https://github.com/dsnezhkov/TruffleSnout",
          "https://github.com/dsnezhkov/TruffleSnout/blob/7c2f22e246ef704bc96c396f66fa854e9ca742b9/TruffleSnout/Docs/USAGE.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_trufflesnout.yml"
      }
    },
    {
      "id": "178e615d-e666-498b-9630-9ed363038101",
      "title": "Elevated System Shell Spawned From Uncommon Parent Location",
      "status": "test",
      "description": "Detects when a shell program such as the Windows command prompt or PowerShell is launched with system privileges from a uncommon parent location.",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.defense-evasion",
        "attack.execution",
        "attack.t1059"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_shell": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell.exe",
                      "\\powershell_ise.exe",
                      "\\pwsh.exe",
                      "\\cmd.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell.EXE",
                      "powershell_ise.EXE",
                      "pwsh.dll",
                      "Cmd.Exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_user": {
            "type": "field_match",
            "matchers": {
              "User__contains": {
                "field": "User",
                "value": [
                  "AUTHORI",
                  "AUTORI"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "LogonId": {
                "field": "LogonId",
                "value": "0x3e7",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_generic": {
            "type": "field_match",
            "matchers": {
              "ParentImage__contains": {
                "field": "ParentImage",
                "value": [
                  ":\\Program Files (x86)\\",
                  ":\\Program Files\\",
                  ":\\ProgramData\\",
                  ":\\Windows\\System32\\",
                  ":\\Windows\\SysWOW64\\",
                  ":\\Windows\\Temp\\",
                  ":\\Windows\\WinSxS\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_manageengine": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": ":\\ManageEngine\\ADManager Plus\\pgsql\\bin\\postgres.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\cmd.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_asgard": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": ":\\WINDOWS\\system32\\cmd.exe /c \"",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "CurrentDirectory__contains": {
                "field": "CurrentDirectory",
                "value": ":\\WINDOWS\\Temp\\asgard2-agent\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_ibm_spectrumprotect": {
            "type": "field_match",
            "matchers": {
              "ParentImage__contains": {
                "field": "ParentImage",
                "value": ":\\IBM\\SpectrumProtect\\webserver\\scripts\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": ":\\IBM\\SpectrumProtect\\webserver\\scripts\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_parent_null": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_parent_empty": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": [
                  "",
                  "-"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "all of selection_*"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1059"
        ],
        "tactics": [
          "privilege_escalation",
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "frack113, Tim Shelton (update fp)",
        "date": "2022-12-05",
        "modified": "2025-03-06",
        "references": [
          "https://github.com/Wh04m1001/SysmonEoP"
        ],
        "falsepositives": [
          "Some legitimate applications may spawn shells from uncommon parent locations. Apply additional filters and perform an initial baseline before deploying."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_elevated_system_shell_uncommon_parent.yml"
      }
    },
    {
      "id": "b5c7395f-e501-4a08-94d4-57fe7a9da9d2",
      "title": "Potential Binary Proxy Execution Via Cdb.EXE",
      "status": "test",
      "description": "Detects usage of \"cdb.exe\" to launch arbitrary processes or commands from a debugger script file",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1106",
        "attack.defense-evasion",
        "attack.t1218",
        "attack.t1127"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\cdb.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "CDB.Exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -c ",
                  " -cf "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1106",
          "T1218",
          "T1127"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Beyu Denis, oscd.community, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2019-10-26",
        "modified": "2024-04-22",
        "references": [
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Cdb/",
          "https://web.archive.org/web/20170715043507/http://www.exploit-monday.com/2016/08/windbg-cdb-shellcode-runner.html",
          "https://twitter.com/nas_bench/status/1534957360032120833"
        ],
        "falsepositives": [
          "Legitimate use of debugging tools"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_cdb_arbitrary_command_execution.yml"
      }
    },
    {
      "id": "bf361876-6620-407a-812f-bfe11e51e924",
      "title": "Compressed File Extraction Via Tar.EXE",
      "status": "test",
      "description": "Detects execution of \"tar.exe\" in order to extract compressed file.\nAdversaries may abuse various utilities in order to decompress data to avoid detection.\n",
      "level": "low",
      "tags": [
        "attack.collection",
        "attack.exfiltration",
        "attack.t1560",
        "attack.t1560.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\tar.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "bsdtar",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_extract": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-x",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1560",
          "T1560.001"
        ],
        "tactics": [
          "collection",
          "exfiltration"
        ]
      },
      "meta": {
        "author": "AdmU3",
        "date": "2023-12-19",
        "modified": "",
        "references": [
          "https://unit42.paloaltonetworks.com/chromeloader-malware/",
          "https://lolbas-project.github.io/lolbas/Binaries/Tar/",
          "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/cicada-apt10-japan-espionage"
        ],
        "falsepositives": [
          "Likely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_tar_extraction.yml"
      }
    },
    {
      "id": "ebea773c-a8f1-42ad-a856-00cb221966e8",
      "title": "DLL Sideloading by VMware Xfer Utility",
      "status": "test",
      "description": "Detects execution of VMware Xfer utility (VMwareXferlogs.exe) from the non-default directory which may be an attempt to sideload arbitrary DLL",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1574.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\VMwareXferlogs.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Program Files\\VMware\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1574.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-02",
        "modified": "",
        "references": [
          "https://www.sentinelone.com/labs/lockbit-ransomware-side-loads-cobalt-strike-beacon-with-legitimate-vmware-utility/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_dll_sideload_vmware_xfer.yml"
      }
    },
    {
      "id": "12fbff88-16b5-4b42-9754-cd001a789fb3",
      "title": "CodePage Modification Via MODE.COM To Russian Language",
      "status": "test",
      "description": "Detects a CodePage modification using the \"mode.com\" utility to Russian language.\nThis behavior has been used by threat actors behind Dharma ransomware.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\mode.com",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "MODE.COM",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " con ",
                  " cp ",
                  " select="
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": [
                  "=1251",
                  "=866"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1036"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Joseliyo Sanchez, @Joseliyo_Jstnk",
        "date": "2024-01-17",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/windows/win32/intl/code-page-identifiers",
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/mode",
          "https://strontic.github.io/xcyclopedia/library/mode.com-59D1ED51ACB8C3D50F1306FD75F20E99.html",
          "https://www.virustotal.com/gui/file/5e75ef02517afd6e8ba6462b19217dc4a5a574abb33d10eb0f2bab49d8d48c22/behavior"
        ],
        "falsepositives": [
          "Russian speaking people changing the CodePage"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_mode_codepage_russian.yml"
      }
    },
    {
      "id": "023394c4-29d5-46ab-92b8-6a534c6f447b",
      "title": "Suspicious HWP Sub Processes",
      "status": "test",
      "description": "Detects suspicious Hangul Word Processor (Hanword) sub processes that could indicate an exploitation",
      "level": "high",
      "tags": [
        "attack.initial-access",
        "attack.t1566.001",
        "attack.execution",
        "attack.t1203",
        "attack.t1059.003",
        "attack.g0032"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\Hwp.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\gbb.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1566.001",
          "T1203",
          "T1059.003"
        ],
        "tactics": [
          "initial_access",
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2019-10-24",
        "modified": "2021-11-27",
        "references": [
          "https://www.securitynewspaper.com/2016/11/23/technical-teardown-exploit-malware-hwp-files/",
          "https://www.hybrid-analysis.com/search?query=context:74940dcc5b38f9f9b1a0fea760d344735d7d91b610e6d5bd34533dd0153402c5&from_sample=5db135000388385a7644131f&block_redirect=1",
          "https://twitter.com/cyberwar_15/status/1187287262054076416",
          "https://blog.alyac.co.kr/1901",
          "https://en.wikipedia.org/wiki/Hangul_(word_processor)"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hwp_exploits.yml"
      }
    },
    {
      "id": "f26c6093-6f14-4b12-800f-0fcb46f5ffd0",
      "title": "Malicious Base64 Encoded PowerShell Keywords in Command Lines",
      "status": "test",
      "description": "Detects base64 encoded strings used in hidden malicious PowerShell command lines",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_hidden": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " hidden ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_encoded": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "AGkAdABzAGEAZABtAGkAbgAgAC8AdAByAGEAbgBzAGYAZQByA",
                  "aXRzYWRtaW4gL3RyYW5zZmVy",
                  "IAaQB0AHMAYQBkAG0AaQBuACAALwB0AHIAYQBuAHMAZgBlAHIA",
                  "JpdHNhZG1pbiAvdHJhbnNmZX",
                  "YgBpAHQAcwBhAGQAbQBpAG4AIAAvAHQAcgBhAG4AcwBmAGUAcg",
                  "Yml0c2FkbWluIC90cmFuc2Zlc",
                  "AGMAaAB1AG4AawBfAHMAaQB6AGUA",
                  "JABjAGgAdQBuAGsAXwBzAGkAegBlA",
                  "JGNodW5rX3Npem",
                  "QAYwBoAHUAbgBrAF8AcwBpAHoAZQ",
                  "RjaHVua19zaXpl",
                  "Y2h1bmtfc2l6Z",
                  "AE8ALgBDAG8AbQBwAHIAZQBzAHMAaQBvAG4A",
                  "kATwAuAEMAbwBtAHAAcgBlAHMAcwBpAG8Abg",
                  "lPLkNvbXByZXNzaW9u",
                  "SQBPAC4AQwBvAG0AcAByAGUAcwBzAGkAbwBuA",
                  "SU8uQ29tcHJlc3Npb2",
                  "Ty5Db21wcmVzc2lvb",
                  "AE8ALgBNAGUAbQBvAHIAeQBTAHQAcgBlAGEAbQ",
                  "kATwAuAE0AZQBtAG8AcgB5AFMAdAByAGUAYQBtA",
                  "lPLk1lbW9yeVN0cmVhb",
                  "SQBPAC4ATQBlAG0AbwByAHkAUwB0AHIAZQBhAG0A",
                  "SU8uTWVtb3J5U3RyZWFt",
                  "Ty5NZW1vcnlTdHJlYW",
                  "4ARwBlAHQAQwBoAHUAbgBrA",
                  "5HZXRDaHVua",
                  "AEcAZQB0AEMAaAB1AG4Aaw",
                  "LgBHAGUAdABDAGgAdQBuAGsA",
                  "LkdldENodW5r",
                  "R2V0Q2h1bm",
                  "AEgAUgBFAEEARABfAEkATgBGAE8ANgA0A",
                  "QASABSAEUAQQBEAF8ASQBOAEYATwA2ADQA",
                  "RIUkVBRF9JTkZPNj",
                  "SFJFQURfSU5GTzY0",
                  "VABIAFIARQBBAEQAXwBJAE4ARgBPADYANA",
                  "VEhSRUFEX0lORk82N",
                  "AHIAZQBhAHQAZQBSAGUAbQBvAHQAZQBUAGgAcgBlAGEAZA",
                  "cmVhdGVSZW1vdGVUaHJlYW",
                  "MAcgBlAGEAdABlAFIAZQBtAG8AdABlAFQAaAByAGUAYQBkA",
                  "NyZWF0ZVJlbW90ZVRocmVhZ",
                  "Q3JlYXRlUmVtb3RlVGhyZWFk",
                  "QwByAGUAYQB0AGUAUgBlAG0AbwB0AGUAVABoAHIAZQBhAGQA",
                  "0AZQBtAG0AbwB2AGUA",
                  "1lbW1vdm",
                  "AGUAbQBtAG8AdgBlA",
                  "bQBlAG0AbQBvAHYAZQ",
                  "bWVtbW92Z",
                  "ZW1tb3Zl"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "John Lambert (rule)",
        "date": "2019-01-16",
        "modified": "2023-01-05",
        "references": [
          "http://www.leeholmes.com/blog/2017/09/21/searching-for-content-in-base-64-strings/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_base64_hidden_flag.yml"
      }
    },
    {
      "id": "baef1ec6-2ca9-47a3-97cc-4cf2bda10b77",
      "title": "Potential Credential Dumping Attempt Using New NetworkProvider - CLI",
      "status": "test",
      "description": "Detects when an attacker tries to add a new network provider in order to dump clear text credentials, similar to how the NPPSpy tool does it",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "\\System\\CurrentControlSet\\Services\\",
                  "\\NetworkProvider"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-23",
        "modified": "2023-02-02",
        "references": [
          "https://learn.microsoft.com/en-us/troubleshoot/windows-client/setup-upgrade-and-drivers/network-provider-settings-removed-in-place-upgrade",
          "https://github.com/gtworek/PSBits/tree/master/PasswordStealing/NPPSpy"
        ],
        "falsepositives": [
          "Other legitimate network providers used and not filtred in this rule"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_registry_new_network_provider.yml"
      }
    },
    {
      "id": "60fc936d-2eb0-4543-8a13-911c750a1dfc",
      "title": "Interactive AT Job",
      "status": "test",
      "description": "Detects an interactive AT job, which may be used as a form of privilege escalation.",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.execution",
        "attack.privilege-escalation",
        "attack.t1053.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\at.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "interactive",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1053.002"
        ],
        "tactics": [
          "persistence",
          "execution",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "E.M. Anhaus (originally from Atomic Blue Detections, Endgame), oscd.community",
        "date": "2019-10-24",
        "modified": "2021-11-27",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1053.002/T1053.002.md",
          "https://eqllib.readthedocs.io/en/latest/analytics/d8db43cf-ed52-4f5c-9fb3-c9a4b95a0b56.html"
        ],
        "falsepositives": [
          "Unlikely (at.exe deprecated as of Windows 8)"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_at_interactive_execution.yml"
      }
    },
    {
      "id": "ff992eac-6449-4c60-8c1d-91c9722a1d48",
      "title": "New Root Certificate Installed Via CertMgr.EXE",
      "status": "test",
      "description": "Detects execution of \"certmgr\" with the \"add\" flag in order to install a new certificate on the system.\nAdversaries may install a root certificate on a compromised system to avoid warnings when connecting to adversary controlled web servers.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1553.004"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\CertMgr.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "CERTMGT.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/add",
                  "root"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1553.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "oscd.community, @redcanary, Zach Stanford @svch0st",
        "date": "2023-03-05",
        "modified": "",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1553.004/T1553.004.md",
          "https://securelist.com/to-crypt-or-to-mine-that-is-the-question/86307/"
        ],
        "falsepositives": [
          "Help Desk or IT may need to manually add a corporate Root CA on occasion. Need to test if GPO push doesn't trigger FP"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_certmgr_certificate_installation.yml"
      }
    },
    {
      "id": "8a8379b8-780b-4dbf-b1e9-31c8d112fefb",
      "title": "Schtasks From Suspicious Folders",
      "status": "test",
      "description": "Detects scheduled task creations that have suspicious action command and folder combinations",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.execution",
        "attack.t1053.005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\schtasks.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "schtasks.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_create": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " /create ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_command": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "powershell",
                  "pwsh",
                  "cmd /c ",
                  "cmd /k ",
                  "cmd /r ",
                  "cmd.exe /c ",
                  "cmd.exe /k ",
                  "cmd.exe /r "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_all_folders": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "C:\\ProgramData\\",
                  "%ProgramData%"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1053.005"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-04-15",
        "modified": "2022-11-18",
        "references": [
          "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/lazarus-dream-job-chemical"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_schtasks_folder_combos.yml"
      }
    },
    {
      "id": "fca949cc-79ca-446e-8064-01aa7e52ece5",
      "title": "HackTool - PCHunter Execution",
      "status": "test",
      "description": "Detects suspicious use of PCHunter, a tool like Process Hacker to view and manipulate processes, kernel options and other low level stuff",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.discovery",
        "attack.t1082",
        "attack.t1057",
        "attack.t1012",
        "attack.t1083",
        "attack.t1007"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_image": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\PCHunter64.exe",
                  "\\PCHunter32.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_pe": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "PCHunter.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "Epoolsoft Windows Information View Tools",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_hashes": {
            "type": "field_match",
            "matchers": {
              "Hashes__contains": {
                "field": "Hashes",
                "value": [
                  "SHA1=5F1CBC3D99558307BC1250D084FA968521482025",
                  "MD5=987B65CD9B9F4E9A1AFD8F8B48CF64A7",
                  "SHA256=2B214BDDAAB130C274DE6204AF6DBA5AEEC7433DA99AA950022FA306421A6D32",
                  "IMPHASH=444D210CEA1FF8112F256A4997EED7FF",
                  "SHA1=3FB89787CB97D902780DA080545584D97FB1C2EB",
                  "MD5=228DD0C2E6287547E26FFBD973A40F14",
                  "SHA256=55F041BF4E78E9BFA6D4EE68BE40E496CE3A1353E1CA4306598589E19802522C",
                  "IMPHASH=0479F44DF47CFA2EF1CCC4416A538663"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1082",
          "T1057",
          "T1012",
          "T1083",
          "T1007"
        ],
        "tactics": [
          "execution",
          "discovery"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali",
        "date": "2022-10-10",
        "modified": "2024-11-23",
        "references": [
          "https://web.archive.org/web/20231210115125/http://www.xuetr.com/",
          "https://www.crowdstrike.com/blog/falcon-overwatch-report-finds-increase-in-ecrime/",
          "https://www.hexacorn.com/blog/2018/04/20/kernel-hacking-tool-you-might-have-never-heard-of-xuetr-pchunter/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_pchunter.yml"
      }
    },
    {
      "id": "c2b86e67-b880-4eec-b045-50bc98ef4844",
      "title": "HackTool - LaZagne Execution",
      "status": "experimental",
      "description": "Detects the execution of the LaZagne. A utility used to retrieve multiple types of passwords stored on a local computer.\nLaZagne has been leveraged multiple times by threat actors in order to dump credentials.\n",
      "level": "medium",
      "tags": [
        "attack.credential-access"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img_metadata": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\lazagne.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_img_cli": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  ":\\PerfLogs\\",
                  ":\\ProgramData\\",
                  ":\\Temp\\",
                  ":\\Tmp\\",
                  ":\\Users\\Public\\",
                  ":\\Windows\\Temp\\",
                  "\\$Recycle.bin",
                  "\\AppData\\",
                  "\\Desktop\\",
                  "\\Downloads\\",
                  "\\Favorites\\",
                  "\\Links\\",
                  "\\Music\\",
                  "\\Photos\\",
                  "\\Pictures\\",
                  "\\Saved Games\\",
                  "\\Searches\\",
                  "\\Users\\Contacts\\",
                  "\\Users\\Default\\",
                  "\\Users\\Searches\\",
                  "\\Videos\\",
                  "\\Windows\\addins\\",
                  "\\Windows\\Fonts\\",
                  "\\Windows\\IME\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": [
                  ".exe all",
                  ".exe browsers",
                  ".exe chats",
                  ".exe databases",
                  ".exe games",
                  ".exe git",
                  ".exe mails",
                  ".exe maven",
                  ".exe memory",
                  ".exe multimedia",
                  ".exe sysadmin",
                  ".exe unused",
                  ".exe wifi",
                  ".exe windows"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_modules": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " all ",
                  " browsers ",
                  " chats ",
                  " databases ",
                  " games ",
                  " mails ",
                  " maven ",
                  " memory ",
                  " multimedia ",
                  " php ",
                  " svn ",
                  " sysadmin ",
                  " unused ",
                  " wifi "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_options": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "-1Password",
                  "-apachedirectorystudio",
                  "-autologon",
                  "-ChromiumBased",
                  "-coreftp",
                  "-credfiles",
                  "-credman",
                  "-cyberduck",
                  "-dbvis",
                  "-EyeCon",
                  "-filezilla",
                  "-filezillaserver",
                  "-ftpnavigator",
                  "-galconfusion",
                  "-gitforwindows",
                  "-hashdump",
                  "-iisapppool",
                  "-IISCentralCertP",
                  "-kalypsomedia",
                  "-keepass",
                  "-keepassconfig",
                  "-lsa_secrets",
                  "-mavenrepositories",
                  "-memory_dump",
                  "-Mozilla",
                  "-mRemoteNG",
                  "-mscache",
                  "-opensshforwindows",
                  "-openvpn",
                  "-outlook",
                  "-pidgin",
                  "-postgresql",
                  "-psi-im",
                  "-puttycm",
                  "-pypykatz",
                  "-Rclone",
                  "-rdpmanager",
                  "-robomongo",
                  "-roguestale",
                  "-skype",
                  "-SQLDeveloper",
                  "-squirrel",
                  "-tortoise",
                  "-turba",
                  "-UCBrowser",
                  "-unattended",
                  "-vault",
                  "-vaultfiles",
                  "-vnc",
                  "-winscp"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_img_* or all of selection_cli_*",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "1 of selection_img_*",
            "all of selection_cli_*"
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali, Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2024-06-24",
        "modified": "2025-10-07",
        "references": [
          "https://github.com/AlessandroZ/LaZagne/tree/master",
          "https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/",
          "https://cloud.google.com/blog/topics/threat-intelligence/alphv-ransomware-backup/",
          "https://securelist.com/defttorero-tactics-techniques-and-procedures/107610/",
          "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/800c0e06571993a54e39571cf27fd474dcc5c0bc/2017/2017.11.14.Muddying_the_Water/muddying-the-water-targeted-attacks.pdf"
        ],
        "falsepositives": [
          "Some false positive is expected from tools with similar command line flags."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_lazagne.yml"
      }
    },
    {
      "id": "c0b40568-b1e9-4b03-8d6c-b096da6da9ab",
      "title": "Suspicious AgentExecutor PowerShell Execution",
      "status": "test",
      "description": "Detects execution of the AgentExecutor.exe binary. Which can be abused as a LOLBIN to execute powershell scripts with the ExecutionPolicy \"Bypass\" or any binary named \"powershell.exe\" located in the path provided by 6th positional argument",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\AgentExecutor.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "AgentExecutor.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -powershell",
                  " -remediationScript"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_pwsh": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\",
                  "C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_intune": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\Microsoft.Management.Services.IntuneWindowsAgent.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_main_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), memory-shards",
        "date": "2022-12-24",
        "modified": "2024-08-07",
        "references": [
          "https://twitter.com/lefterispan/status/1286259016436514816",
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Agentexecutor/",
          "https://learn.microsoft.com/en-us/mem/intune/apps/intune-management-extension",
          "https://twitter.com/jseerden/status/1247985304667066373/photo/1"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_agentexecutor_susp_usage.yml"
      }
    },
    {
      "id": "ed5d72a6-f8f4-479d-ba79-02f6a80d7471",
      "title": "Potential LethalHTA Technique Execution",
      "status": "test",
      "description": "Detects potential LethalHTA technique where the \"mshta.exe\" is spawned by an \"svchost.exe\" process",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\svchost.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\mshta.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.005"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Markus Neis",
        "date": "2018-06-07",
        "modified": "2023-02-07",
        "references": [
          "https://codewhitesec.blogspot.com/2018/07/lethalhta.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_mshta_lethalhta_technique.yml"
      }
    },
    {
      "id": "dbc1f800-0fe0-4bc0-9c66-292c2abe3f78",
      "title": "Delete Important Scheduled Task",
      "status": "test",
      "description": "Detects when adversaries stop services or processes by deleting their respective scheduled tasks in order to conduct data destructive activities",
      "level": "high",
      "tags": [
        "attack.impact",
        "attack.t1489"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\schtasks.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/delete",
                  "/tn"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\Windows\\BitLocker",
                  "\\Windows\\ExploitGuard",
                  "\\Windows\\SystemRestore\\SR",
                  "\\Windows\\UpdateOrchestrator\\",
                  "\\Windows\\Windows Defender\\",
                  "\\Windows\\WindowsBackup\\",
                  "\\Windows\\WindowsUpdate\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1489"
        ],
        "tactics": [
          "impact"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-09-09",
        "modified": "",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_schtasks_delete.yml"
      }
    },
    {
      "id": "99b7460d-c9f1-40d7-a316-1f36f61d52ee",
      "title": "Cscript/Wscript Uncommon Script Extension Execution",
      "status": "test",
      "description": "Detects Wscript/Cscript executing a file with an uncommon (i.e. non-script) extension",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059.005",
        "attack.t1059.007"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "wscript.exe",
                      "cscript.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\wscript.exe",
                      "\\cscript.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_extension": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ".csv",
                  ".dat",
                  ".doc",
                  ".gif",
                  ".jpeg",
                  ".jpg",
                  ".png",
                  ".ppt",
                  ".txt",
                  ".xls",
                  ".xml"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.005",
          "T1059.007"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-15",
        "modified": "2023-06-19",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wscript_cscript_uncommon_extension_exec.yml"
      }
    },
    {
      "id": "09576804-7a05-458e-a817-eb718ca91f54",
      "title": "Suspicious PowerShell IEX Execution Patterns",
      "status": "test",
      "description": "Detects suspicious ways to run Invoke-Execution using IEX alias",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_combined_1": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\powershell.exe",
                  "\\pwsh.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " | iex;",
                  " | iex ",
                  " | iex}",
                  " | IEX ;",
                  " | IEX -Error",
                  " | IEX (new",
                  ");IEX "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_combined_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "::FromBase64String",
                  ".GetString([System.Convert]::"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_standalone": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ")|iex;$",
                  ");iex($",
                  ");iex $",
                  " | IEX | ",
                  " | iex\\\""
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_combined_* or selection_standalone",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "all of selection_combined_*",
            "selection_standalone"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-03-24",
        "modified": "2022-11-28",
        "references": [
          "https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/invoke-expression?view=powershell-7.2",
          "https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708"
        ],
        "falsepositives": [
          "Legitimate scripts that use IEX"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_iex_patterns.yml"
      }
    },
    {
      "id": "f64e5c19-879c-4bae-b471-6d84c8339677",
      "title": "Webshell Tool Reconnaissance Activity",
      "status": "test",
      "description": "Detects processes spawned from web servers (PHP, Tomcat, IIS, etc.) that perform reconnaissance looking for the existence of popular scripting tools (perl, python, wget) on the system via the help commands\n",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.t1505.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_webserver_image": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\caddy.exe",
                  "\\httpd.exe",
                  "\\nginx.exe",
                  "\\php-cgi.exe",
                  "\\w3wp.exe",
                  "\\ws_tomcatservice.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_webserver_characteristics_tomcat1": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\java.exe",
                  "\\javaw.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "ParentImage__contains": {
                "field": "ParentImage",
                "value": [
                  "-tomcat-",
                  "\\tomcat"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_webserver_characteristics_tomcat2": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\java.exe",
                  "\\javaw.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "CATALINA_HOME",
                  "catalina.jar"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_recon": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "perl --help",
                  "perl -h",
                  "python --help",
                  "python -h",
                  "python3 --help",
                  "python3 -h",
                  "wget --help"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_webserver_* and selection_recon",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "1 of selection_webserver_*"
            },
            {
              "type": "ref",
              "value": "selection_recon"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1505.003"
        ],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "Cian Heasley, Florian Roth (Nextron Systems)",
        "date": "2020-07-22",
        "modified": "2023-11-09",
        "references": [
          "https://ragged-lab.blogspot.com/2020/07/webshells-automating-reconnaissance.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_webshell_tool_recon.yml"
      }
    },
    {
      "id": "b66474aa-bd92-4333-a16c-298155b120df",
      "title": "Potential Persistence Via Powershell Search Order Hijacking - Task",
      "status": "test",
      "description": "Detects suspicious powershell execution via a schedule task where the command ends with an suspicious flags to hide the powershell instance instead of executeing scripts or commands. This could be a sign of persistence via PowerShell \"Get-Variable\" technique as seen being used in Colibri Loader",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.execution",
        "attack.persistence",
        "attack.t1053.005",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": "C:\\WINDOWS\\System32\\svchost.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ParentCommandLine__contains_all": {
                "field": "ParentCommandLine",
                "value": [
                  "-k netsvcs",
                  "-s Schedule"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": [
                  " -windowstyle hidden",
                  " -w hidden",
                  " -ep bypass",
                  " -noni"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1053.005",
          "T1059.001"
        ],
        "tactics": [
          "privilege_escalation",
          "execution",
          "persistence"
        ]
      },
      "meta": {
        "author": "pH-T (Nextron Systems), Florian Roth (Nextron Systems)",
        "date": "2022-04-08",
        "modified": "2023-02-03",
        "references": [
          "https://blog.malwarebytes.com/threat-intelligence/2022/04/colibri-loader-combines-task-scheduler-and-powershell-in-clever-persistence-technique/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_schtasks_powershell_persistence.yml"
      }
    },
    {
      "id": "395907ee-96e5-4666-af2e-2ca91688e151",
      "title": "Wab Execution From Non Default Location",
      "status": "test",
      "description": "Detects execution of wab.exe (Windows Contacts) and Wabmig.exe (Microsoft Address Book Import Tool) from non default locations as seen with bumblebee activity",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\wab.exe",
                  "\\wabmig.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Windows\\WinSxS\\",
                  "C:\\Program Files\\Windows Mail\\",
                  "C:\\Program Files (x86)\\Windows Mail\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-12",
        "modified": "2022-09-27",
        "references": [
          "https://thedfirreport.com/2022/08/08/bumblebee-roasts-its-way-to-domain-admin/",
          "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/bumblebee-loader-cybercrime",
          "https://thedfirreport.com/2022/09/26/bumblebee-round-two/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wab_execution_from_non_default_location.yml"
      }
    },
    {
      "id": "a7ee1722-c3c5-aeff-3212-c777e4733217",
      "title": "Disable Windows Defender AV Security Monitoring",
      "status": "test",
      "description": "Detects attackers attempting to disable Windows Defender using Powershell",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_pwsh_binary": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_pwsh_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "-DisableBehaviorMonitoring $true",
                  "-DisableRuntimeMonitoring $true"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_sc_binary": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\sc.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "sc.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_sc_tamper_cmd_stop": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "stop",
                  "WinDefend"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_sc_tamper_cmd_delete": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "delete",
                  "WinDefend"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_sc_tamper_cmd_disabled": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "config",
                  "WinDefend",
                  "start=disabled"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_pwsh_* or (selection_sc_binary and 1 of selection_sc_tamper_*)",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "all of selection_pwsh_*",
            "(selection_sc_binary and 1 of selection_sc_tamper_*)"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "ok @securonix invrep-de, oscd.community, frack113",
        "date": "2020-10-12",
        "modified": "2022-11-18",
        "references": [
          "https://research.nccgroup.com/2020/06/23/wastedlocker-a-new-ransomware-variant-developed-by-the-evil-corp-group/",
          "https://rvsec0n.wordpress.com/2020/01/24/malwares-that-bypass-windows-defender/",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md"
        ],
        "falsepositives": [
          "Minimal, for some older versions of dev tools, such as pycharm, developers were known to sometimes disable Windows Defender to improve performance, but this generally is not considered a good security practice."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_disable_defender_av_security_monitoring.yml"
      }
    },
    {
      "id": "327ff235-94eb-4f06-b9de-aaee571324be",
      "title": "Regsvr32 Execution From Highly Suspicious Location",
      "status": "test",
      "description": "Detects execution of regsvr32 where the DLL is located in a highly suspicious locations",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.010"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\regsvr32.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "REGSVR32.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_path_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ":\\PerfLogs\\",
                  ":\\Temp\\",
                  "\\Windows\\Registration\\CRMLog",
                  "\\Windows\\System32\\com\\dmp\\",
                  "\\Windows\\System32\\FxsTmp\\",
                  "\\Windows\\System32\\Microsoft\\Crypto\\RSA\\MachineKeys\\",
                  "\\Windows\\System32\\spool\\drivers\\color\\",
                  "\\Windows\\System32\\spool\\PRINTERS\\",
                  "\\Windows\\System32\\spool\\SERVERS\\",
                  "\\Windows\\System32\\Tasks_Migrated\\",
                  "\\Windows\\System32\\Tasks\\Microsoft\\Windows\\SyncCenter\\",
                  "\\Windows\\SysWOW64\\com\\dmp\\",
                  "\\Windows\\SysWOW64\\FxsTmp\\",
                  "\\Windows\\SysWOW64\\Tasks\\Microsoft\\Windows\\PLA\\System\\",
                  "\\Windows\\SysWOW64\\Tasks\\Microsoft\\Windows\\SyncCenter\\",
                  "\\Windows\\Tasks\\",
                  "\\Windows\\Tracing\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_path_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " \"C:\\",
                  " C:\\",
                  " 'C:\\",
                  "D:\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_exclude_known_dirs": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "C:\\Program Files (x86)\\",
                  "C:\\Program Files\\",
                  "C:\\ProgramData\\",
                  "C:\\Users\\",
                  " C:\\Windows\\",
                  " \"C:\\Windows\\",
                  " 'C:\\Windows\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_empty": {
            "type": "field_match",
            "matchers": {
              "CommandLine": {
                "field": "CommandLine",
                "value": "",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_null": {
            "type": "field_match",
            "matchers": {
              "CommandLine": {
                "field": "CommandLine",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection_img and (selection_path_1 or (selection_path_2 and not selection_exclude_known_dirs)) and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection_img and (selection_path_1",
            "(selection_path_2 and not selection_exclude_known_dirs)) and not 1 of filter_main_*"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218.010"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-26",
        "modified": "",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_regsvr32_susp_exec_path_2.yml"
      }
    },
    {
      "id": "e32f92d1-523e-49c3-9374-bdb13b46a3ba",
      "title": "Suspicious Mshta.EXE Execution Patterns",
      "status": "test",
      "description": "Detects suspicious mshta process execution patterns",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1106"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\mshta.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "MSHTA.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_susp": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\cmd.exe",
                  "\\cscript.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\regsvr32.exe",
                  "\\rundll32.exe",
                  "\\wscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\AppData\\Local\\",
                  "C:\\ProgramData\\",
                  "C:\\Users\\Public\\",
                  "C:\\Windows\\Temp\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__startswith": {
                    "field": "Image",
                    "value": [
                      "C:\\Windows\\System32\\",
                      "C:\\Windows\\SysWOW64\\"
                    ],
                    "modifiers": [
                      "startswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      ".htm",
                      ".hta"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__endswith": {
                    "field": "CommandLine",
                    "value": [
                      "mshta.exe",
                      "mshta"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "condition": "all of selection_* or (selection_img and not filter_img)",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "all of selection_*",
            "(selection_img and not filter_img)"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1106"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2021-07-17",
        "modified": "2023-02-21",
        "references": [
          "https://en.wikipedia.org/wiki/HTML_Application",
          "https://www.echotrail.io/insights/search/mshta.exe",
          "https://app.any.run/tasks/34221348-072d-4b70-93f3-aa71f6ebecad/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_mshta_susp_pattern.yml"
      }
    },
    {
      "id": "f35c5d71-b489-4e22-a115-f003df287317",
      "title": "Potential CobaltStrike Process Patterns",
      "status": "test",
      "description": "Detects potential process patterns related to Cobalt Strike beacon activity",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_generic_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": "cmd.exe /C whoami",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "ParentImage__startswith": {
                "field": "ParentImage",
                "value": "C:\\Temp\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_generic_2": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\runonce.exe",
                  "\\dllhost.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "cmd.exe /c echo",
                  "> \\\\\\\\.\\\\pipe"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_conhost_1": {
            "type": "field_match",
            "matchers": {
              "ParentCommandLine__contains_all": {
                "field": "ParentCommandLine",
                "value": [
                  "cmd.exe /C echo",
                  " > \\\\\\\\.\\\\pipe"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": "conhost.exe 0xffffffff -ForceV1",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_conhost_2": {
            "type": "field_match",
            "matchers": {
              "ParentCommandLine__endswith": {
                "field": "ParentCommandLine",
                "value": "/C whoami",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": "conhost.exe 0xffffffff -ForceV1",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2021-07-27",
        "modified": "2023-03-29",
        "references": [
          "https://hausec.com/2021/07/26/cobalt-strike-and-tradecraft/",
          "https://thedfirreport.com/2021/08/29/cobalt-strike-a-defenders-guide/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_cobaltstrike_process_patterns.yml"
      }
    },
    {
      "id": "0ef56343-059e-4cb6-adc1-4c3c967c5e46",
      "title": "Suspicious Execution of Systeminfo",
      "status": "test",
      "description": "Detects usage of the \"systeminfo\" command to retrieve information",
      "level": "low",
      "tags": [
        "attack.discovery",
        "attack.t1082"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\systeminfo.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "sysinfo.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1082"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-01",
        "modified": "2022-07-14",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1082/T1082.md#atomic-test-1---system-information-discovery",
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/systeminfo"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_systeminfo_execution.yml"
      }
    },
    {
      "id": "cdf05894-89e7-4ead-b2b0-0a5f97a90f2f",
      "title": "Potential Encoded PowerShell Patterns In CommandLine",
      "status": "test",
      "description": "Detects specific combinations of encoding methods in PowerShell via the commandline",
      "level": "low",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027",
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_to_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "ToInt",
                  "ToDecimal",
                  "ToByte",
                  "ToUint",
                  "ToSingle",
                  "ToSByte"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_to_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "ToChar",
                  "ToString",
                  "String"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_gen_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "char",
                  "join"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_gen_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "split",
                  "join"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_img and (all of selection_to_* or 1 of selection_gen_*)",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection_img and (all of selection_to_*",
            "1 of selection_gen_*)"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1027",
          "T1059.001"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Teymur Kheirkhabarov (idea), Vasiliy Burov (rule), oscd.community, Tim Shelton",
        "date": "2020-10-11",
        "modified": "2023-01-26",
        "references": [
          "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse?slide=65"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_encoding_patterns.yml"
      }
    },
    {
      "id": "9ccba514-7cb6-4c5c-b377-700758f2f120",
      "title": "Suspicious Child Process of AspNetCompiler",
      "status": "test",
      "description": "Detects potentially suspicious child processes of \"aspnet_compiler.exe\".",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1127"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\aspnet_compiler.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_child": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\calc.exe",
                      "\\notepad.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__contains": {
                    "field": "Image",
                    "value": [
                      "\\Users\\Public\\",
                      "\\AppData\\Local\\Temp\\",
                      "\\AppData\\Local\\Roaming\\",
                      ":\\Temp\\",
                      ":\\Windows\\Temp\\",
                      ":\\Windows\\System32\\Tasks\\",
                      ":\\Windows\\Tasks\\"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1127"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-08-14",
        "modified": "",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Aspnet_Compiler/",
          "https://ijustwannared.team/2020/08/01/the-curious-case-of-aspnet_compiler-exe/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_aspnet_compiler_susp_child_process.yml"
      }
    },
    {
      "id": "ca2092a1-c273-4878-9b4b-0d60115bf5ea",
      "title": "Suspicious Encoded PowerShell Command Line",
      "status": "test",
      "description": "Detects suspicious powershell process starts with base64 encoded commands (e.g. Emotet)",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_enc": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -e",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli_content": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " JAB",
                  " SUVYI",
                  " SQBFAFgA",
                  " aQBlAHgA",
                  " aWV4I",
                  " IAA",
                  " IAB",
                  " UwB",
                  " cwB"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_standalone": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ".exe -ENCOD ",
                  " BA^J e-"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_remote_signed": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -ExecutionPolicy remotesigned ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection_img and (all of selection_cli_* or selection_standalone) and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection_img and (all of selection_cli_*",
            "selection_standalone) and not 1 of filter_optional_*"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Markus Neis, Jonhnathan Ribeiro, Daniil Yugoslavskiy, Anton Kutepov, oscd.community",
        "date": "2018-09-03",
        "modified": "2023-04-06",
        "references": [
          "https://app.any.run/tasks/6217d77d-3189-4db2-a957-8ab239f3e01e"
        ],
        "falsepositives": [],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_base64_encoded_cmd.yml"
      }
    },
    {
      "id": "b236190c-1c61-41e9-84b3-3fe03f6d76b0",
      "title": "Potential Regsvr32 Commandline Flag Anomaly",
      "status": "test",
      "description": "Detects a potential command line flag anomaly related to \"regsvr32\" in which the \"/i\" flag is used without the \"/n\" which should be uncommon.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.010"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\regsvr32.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -i:",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_flag": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -n ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218.010"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2019-07-13",
        "modified": "2024-03-13",
        "references": [
          "https://twitter.com/sbousseaden/status/1282441816986484737?s=12"
        ],
        "falsepositives": [
          "Administrator typo might cause some false positives"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_regsvr32_flags_anomaly.yml"
      }
    },
    {
      "id": "ad720b90-25ad-43ff-9b5e-5c841facc8e5",
      "title": "User Added to Local Administrators Group",
      "status": "test",
      "description": "Detects addition of users to the local administrator group via \"Net\" or \"Add-LocalGroupMember\".",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1098"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_main": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "localgroup ",
                      " /add"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "Add-LocalGroupMember ",
                      " -Group "
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_group": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " administrators ",
                  " administrateur"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1098"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-12",
        "modified": "2023-03-02",
        "references": [
          "https://blog.talosintelligence.com/2022/08/recent-cyber-attack.html?m=1"
        ],
        "falsepositives": [
          "Administrative activity"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_add_user_local_admin_group.yml"
      }
    },
    {
      "id": "1e0e1a81-e79b-44bc-935b-ddb9c8006b3d",
      "title": "Potential Script Proxy Execution Via CL_Mutexverifiers.ps1",
      "status": "test",
      "description": "Detects the use of the Microsoft signed script \"CL_mutexverifiers\" to proxy the execution of additional PowerShell script commands",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1216"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_pwsh": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\powershell.exe",
                  "\\pwsh.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\powershell.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -nologo -windowstyle minimized -file ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_temp": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\AppData\\Local\\Temp\\",
                  "\\Windows\\Temp\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1216"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), oscd.community, Natalia Shornikova, frack113",
        "date": "2022-05-21",
        "modified": "2023-08-17",
        "references": [
          "https://lolbas-project.github.io/lolbas/Scripts/CL_mutexverifiers/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_cl_mutexverifiers.yml"
      }
    },
    {
      "id": "bafac3d6-7de9-4dd9-8874-4a1194b493ed",
      "title": "Abusing Print Executable",
      "status": "test",
      "description": "Attackers can use print.exe for remote file copy",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\print.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__startswith": {
                "field": "CommandLine",
                "value": "print",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/D",
                  ".exe"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_print": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "print.exe",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter_print",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter_print"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Furkan CALISKAN, @caliskanfurkan_, @oscd_initiative",
        "date": "2020-10-05",
        "modified": "2022-07-07",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Print/",
          "https://twitter.com/Oddvarmoe/status/985518877076541440"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_print_remote_file_copy.yml"
      }
    },
    {
      "id": "c86500e9-a645-4680-98d7-f882c70c1ea3",
      "title": "AADInternals PowerShell Cmdlets Execution - ProccessCreation",
      "status": "test",
      "description": "Detects ADDInternals Cmdlet execution. A tool for administering Azure AD and Office 365. Which can be abused by threat actors to attack Azure AD or Office 365.",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.reconnaissance",
        "attack.discovery",
        "attack.credential-access",
        "attack.impact"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell.exe",
                      "\\powershell_ise.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell.Exe",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Add-AADInt",
                  "ConvertTo-AADInt",
                  "Disable-AADInt",
                  "Enable-AADInt",
                  "Export-AADInt",
                  "Find-AADInt",
                  "Get-AADInt",
                  "Grant-AADInt",
                  "Initialize-AADInt",
                  "Install-AADInt",
                  "Invoke-AADInt",
                  "Join-AADInt",
                  "New-AADInt",
                  "Open-AADInt",
                  "Read-AADInt",
                  "Register-AADInt",
                  "Remove-AADInt",
                  "Reset-AADInt",
                  "Resolve-AADInt",
                  "Restore-AADInt",
                  "Save-AADInt",
                  "Search-AADInt",
                  "Send-AADInt",
                  "Set-AADInt",
                  "Start-AADInt",
                  "Unprotect-AADInt",
                  "Update-AADInt"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution",
          "reconnaissance",
          "discovery",
          "credential_access",
          "impact"
        ]
      },
      "meta": {
        "author": "Austin Songer (@austinsonger), Nasreddine Bencherchali (Nextron Systems), Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2022-12-23",
        "modified": "2025-02-06",
        "references": [
          "https://o365blog.com/aadinternals/",
          "https://github.com/Gerenios/AADInternals"
        ],
        "falsepositives": [
          "Legitimate use of the library for administrative activity"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_aadinternals_cmdlets_execution.yml"
      }
    },
    {
      "id": "10344bb3-7f65-46c2-b915-2d00d47be5b0",
      "title": "IE ZoneMap Setting Downgraded To MyComputer Zone For HTTP Protocols Via CLI",
      "status": "test",
      "description": "Detects changes to Internet Explorer's (IE / Windows Internet properties) ZoneMap configuration of the \"HTTP\" and \"HTTPS\" protocols to point to the \"My Computer\" zone. This allows downloaded files from the Internet to be granted the same level of trust as files stored locally.\n",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\ProtocolDefaults",
                  "http",
                  " 0"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-09-05",
        "modified": "",
        "references": [
          "https://twitter.com/M_haggis/status/1699056847154725107",
          "https://twitter.com/JAMESWT_MHT/status/1699042827261391247",
          "https://learn.microsoft.com/en-us/troubleshoot/developer/browsers/security-privacy/ie-security-zones-registry-entries",
          "https://www.virustotal.com/gui/file/339ff720c74dc44265b917b6d3e3ba0411d61f3cd3c328e9a2bae81592c8a6e5/content"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_registry_ie_security_zone_protocol_defaults_downgrade.yml"
      }
    },
    {
      "id": "ffa28e60-bdb1-46e0-9f82-05f7a61cc06e",
      "title": "User Added to Remote Desktop Users Group",
      "status": "test",
      "description": "Detects addition of users to the local Remote Desktop Users group via \"Net\" or \"Add-LocalGroupMember\".",
      "level": "high",
      "tags": [
        "attack.initial-access",
        "attack.persistence",
        "attack.lateral-movement",
        "attack.t1133",
        "attack.t1136.001",
        "attack.t1021.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_main": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "localgroup ",
                      " /add"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "Add-LocalGroupMember ",
                      " -Group "
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_group": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Remote Desktop Users",
                  "Utilisateurs du Bureau à distance",
                  "Usuarios de escritorio remoto"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1133",
          "T1136.001",
          "T1021.001"
        ],
        "tactics": [
          "initial_access",
          "persistence",
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-12-06",
        "modified": "2022-09-09",
        "references": [
          "https://www.microsoft.com/security/blog/2021/11/16/evolving-trends-in-iranian-threat-actor-activity-mstic-presentation-at-cyberwarcon-2021/"
        ],
        "falsepositives": [
          "Administrative activity"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_add_user_remote_desktop_group.yml"
      }
    },
    {
      "id": "dd2a821e-3b07-4d3b-a9ac-929fe4c6ca0c",
      "title": "Suspicious Scheduled Task Creation via Masqueraded XML File",
      "status": "test",
      "description": "Detects the creation of a scheduled task using the \"-XML\" flag with a file without the '.xml' extension. This behavior could be indicative of potential defense evasion attempt during persistence",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.execution",
        "attack.defense-evasion",
        "attack.persistence",
        "attack.t1036.005",
        "attack.t1053.005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\schtasks.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "schtasks.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_create": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "/create",
                  "-create"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_xml": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "/xml",
                  "-xml"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_extension_xml": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": ".xml",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_system_process": {
            "type": "field_match",
            "matchers": {
              "IntegrityLevel": {
                "field": "IntegrityLevel",
                "value": [
                  "System",
                  "S-1-16-16384"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_rundll32": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\rundll32.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "ParentCommandLine__contains_all": {
                "field": "ParentCommandLine",
                "value": [
                  ":\\WINDOWS\\Installer\\MSI",
                  ".tmp,zzzzInvokeManagedCustomActionOutOfProc"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_third_party": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  ":\\ProgramData\\OEM\\UpgradeTool\\CareCenter_*\\BUnzip\\Setup_msi.exe",
                  ":\\Program Files\\Axis Communications\\AXIS Camera Station\\SetupActions.exe",
                  ":\\Program Files\\Axis Communications\\AXIS Device Manager\\AdmSetupActions.exe",
                  ":\\Program Files (x86)\\Zemana\\AntiMalware\\AntiMalware.exe",
                  ":\\Program Files\\Dell\\SupportAssist\\pcdrcui.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "all of selection_*"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1036.005",
          "T1053.005"
        ],
        "tactics": [
          "privilege_escalation",
          "execution",
          "defense_evasion",
          "persistence"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel, Elastic (idea)",
        "date": "2023-04-20",
        "modified": "2024-12-01",
        "references": [
          "https://learn.microsoft.com/en-us/windows/win32/taskschd/daily-trigger-example--xml-",
          "https://github.com/elastic/protections-artifacts/blob/084067123d3328a823b1c3fdde305b694275c794/behavior/rules/persistence_suspicious_scheduled_task_creation_via_masqueraded_xml_file.toml"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_schtasks_schedule_via_masqueraded_xml_file.yml"
      }
    },
    {
      "id": "c9783e20-4793-4164-ba96-d9ee483992c4",
      "title": "Logged-On User Password Change Via Ksetup.EXE",
      "status": "test",
      "description": "Detects password change for the logged-on user's via \"ksetup.exe\"",
      "level": "medium",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\ksetup.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "ksetup.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " /ChangePassword ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-04-06",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-gb/windows-server/administration/windows-commands/ksetup"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_ksetup_password_change_user.yml"
      }
    },
    {
      "id": "77946e79-97f1-45a2-84b4-f37b5c0d8682",
      "title": "Suspicious Registry Modification From ADS Via Regini.EXE",
      "status": "test",
      "description": "Detects the import of an alternate data stream with regini.exe, regini.exe can be used to modify registry keys.",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.t1112",
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\regini.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "REGINI.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_re": {
            "type": "field_match",
            "matchers": {
              "CommandLine__re": {
                "field": "CommandLine",
                "value": ":[^ \\\\]",
                "modifiers": [
                  "re"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Eli Salem, Sander Wiebing, oscd.community",
        "date": "2020-10-12",
        "modified": "2023-02-08",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Regini/",
          "https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f",
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/regini"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_regini_ads.yml"
      }
    },
    {
      "id": "9f107a84-532c-41af-b005-8d12a607639f",
      "title": "Potentially Suspicious Cabinet File Expansion",
      "status": "test",
      "description": "Detects the expansion or decompression of cabinet files from potentially suspicious or uncommon locations, e.g. seen in Iranian MeteorExpress related attacks",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_cmd": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\expand.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-F:",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_folders_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ":\\Perflogs\\",
                  ":\\ProgramData",
                  ":\\Users\\Public\\",
                  ":\\Windows\\Temp\\",
                  "\\Admin$\\",
                  "\\AppData\\Local\\Temp\\",
                  "\\AppData\\Roaming\\",
                  "\\C$\\",
                  "\\Temporary Internet"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_folders_2": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      ":\\Users\\",
                      "\\Favorites\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      ":\\Users\\",
                      "\\Favourites\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      ":\\Users\\",
                      "\\Contacts\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_optional_dell": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": "C:\\Program Files (x86)\\Dell\\UpdateService\\ServiceShell.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "C:\\ProgramData\\Dell\\UpdateService\\Temp\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection_cmd and 1 of selection_folders_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_cmd"
            },
            {
              "type": "ref",
              "value": "1 of selection_folders_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Bhabesh Raj, X__Junior (Nextron Systems)",
        "date": "2021-07-30",
        "modified": "2024-11-13",
        "references": [
          "https://labs.sentinelone.com/meteorexpress-mysterious-wiper-paralyzes-iranian-trains-with-epic-troll",
          "https://blog.malwarebytes.com/threat-intelligence/2021/08/new-variant-of-konni-malware-used-in-campaign-targetting-russia/"
        ],
        "falsepositives": [
          "System administrator Usage"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_expand_cabinet_files.yml"
      }
    },
    {
      "id": "7d4cdc5a-0076-40ca-aac8-f7e714570e47",
      "title": "CMSTP Execution Process Creation",
      "status": "stable",
      "description": "Detects various indicators of Microsoft Connection Manager Profile Installer execution",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.execution",
        "attack.t1218.003",
        "attack.g0069",
        "car.2019-04-001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\cmstp.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.003"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Nik Seetharaman",
        "date": "2018-07-16",
        "modified": "2020-12-23",
        "references": [
          "https://web.archive.org/web/20190720093911/http://www.endurant.io/cmstp/detecting-cmstp-enabled-code-execution-and-uac-bypass-with-sysmon/"
        ],
        "falsepositives": [
          "Legitimate CMSTP use (unlikely in modern enterprise environments)"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_cmstp_execution_by_creation.yml"
      }
    },
    {
      "id": "fff9d2b7-e11c-4a69-93d3-40ef66189767",
      "title": "Suspicious Copy From or To System Directory",
      "status": "test",
      "description": "Detects a suspicious copy operation that tries to copy a program from system (System32, SysWOW64, WinSxS) directories to another on disk.\nOften used to move LOLBINs such as 'certutil' or 'desktopimgdownldr' to a different location with a different name in order to bypass detections based on locations.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img_cmd": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\cmd.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "copy ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_img_pwsh": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\powershell.exe",
                  "\\pwsh.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "copy-item",
                  " copy ",
                  "cpi ",
                  " cp "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_img_other": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\robocopy.exe",
                      "\\xcopy.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "robocopy.exe",
                      "XCOPY.EXE"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_target": {
            "type": "field_match",
            "matchers": {
              "CommandLine__re": {
                "field": "CommandLine",
                "value": "\\s['\"]?C:\\\\Windows\\\\(System32|SysWOW64|WinSxS)",
                "modifiers": [
                  "re"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_avira": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\cmd.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/c copy",
                  "\\Temp\\",
                  "\\avira_system_speedup.exe"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "C:\\Program Files\\Avira\\",
                  "C:\\Program Files (x86)\\Avira\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "1 of selection_img_* and selection_target and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "1 of selection_img_*"
            },
            {
              "type": "ref",
              "value": "selection_target"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1036.003"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Markus Neis, Tim Shelton (HAWK.IO), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2020-07-03",
        "modified": "2025-11-27",
        "references": [
          "https://www.hybrid-analysis.com/sample/8da5b75b6380a41eee3a399c43dfe0d99eeefaa1fd21027a07b1ecaa4cd96fdd?environmentId=120",
          "https://web.archive.org/web/20180331144337/https://www.fireeye.com/blog/threat-research/2018/03/sanny-malware-delivery-method-updated-in-recently-observed-attacks.html",
          "https://thedfirreport.com/2023/08/28/html-smuggling-leads-to-domain-wide-ransomware/"
        ],
        "falsepositives": [
          "Depend on scripts and administrative tools used in the monitored environment (For example an admin scripts like https://www.itexperience.net/sccm-batch-files-and-32-bits-processes-on-64-bits-os/)",
          "When cmd.exe and xcopy.exe are called directly",
          "When the command contains the keywords but not in the correct order"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_copy_system_dir.yml"
      }
    },
    {
      "id": "47147b5b-9e17-4d76-b8d2-7bac24c5ce1b",
      "title": "Potential Browser Data Stealing",
      "status": "test",
      "description": "Adversaries may acquire credentials from web browsers by reading files specific to the target browser.\nWeb browsers commonly save credentials such as website usernames and passwords so that they do not need to be entered manually in the future.\nWeb browsers typically store the credentials in an encrypted format within a credential store.\n",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.t1555.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_cmd": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      "copy-item",
                      "copy ",
                      "cpi ",
                      " cp ",
                      "move ",
                      "move-item",
                      " mi ",
                      " mv "
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\esentutl.exe",
                      "\\xcopy.exe",
                      "\\robocopy.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "esentutl.exe",
                      "XCOPY.EXE",
                      "robocopy.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_path": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\Amigo\\User Data",
                  "\\BraveSoftware\\Brave-Browser\\User Data",
                  "\\CentBrowser\\User Data",
                  "\\Chromium\\User Data",
                  "\\CocCoc\\Browser\\User Data",
                  "\\Comodo\\Dragon\\User Data",
                  "\\Elements Browser\\User Data",
                  "\\Epic Privacy Browser\\User Data",
                  "\\Google\\Chrome Beta\\User Data",
                  "\\Google\\Chrome SxS\\User Data",
                  "\\Google\\Chrome\\User Data\\",
                  "\\Kometa\\User Data",
                  "\\Maxthon5\\Users",
                  "\\Microsoft\\Edge\\User Data",
                  "\\Mozilla\\Firefox\\Profiles",
                  "\\Nichrome\\User Data",
                  "\\Opera Software\\Opera GX Stable\\",
                  "\\Opera Software\\Opera Neon\\User Data",
                  "\\Opera Software\\Opera Stable\\",
                  "\\Orbitum\\User Data",
                  "\\QIP Surf\\User Data",
                  "\\Sputnik\\User Data",
                  "\\Torch\\User Data",
                  "\\uCozMedia\\Uran\\User Data",
                  "\\Vivaldi\\User Data"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1555.003"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-12-23",
        "modified": "2025-03-19",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1555.003/T1555.003.md",
          "https://www.cisa.gov/sites/default/files/2024-04/aa24-109a-stopransomware-akira-ransomware_2.pdf"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_copy_browser_data.yml"
      }
    },
    {
      "id": "54786ddc-5b8a-11ed-9b6a-0242ac120002",
      "title": "Suspicious Ping/Del Command Combination",
      "status": "test",
      "description": "Detects a method often used by ransomware. Which combines the \"ping\" to wait a couple of seconds and then \"del\" to delete the file in question. Its used to hide the file responsible for the initial infection for example",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1070.004"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_count": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -n ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_nul": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "Nul",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_del_param": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -f ",
                  " -q "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_all": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "ping",
                  "del "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1070.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Ilya Krestinichev",
        "date": "2022-11-03",
        "modified": "2024-03-05",
        "references": [
          "https://blog.sygnia.co/kaseya-ransomware-supply-chain-attack",
          "https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2022/06/23093553/Common-TTPs-of-the-modern-ransomware_low-res.pdf",
          "https://www.acronis.com/en-us/blog/posts/lockbit-ransomware/",
          "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/blackbyte-exbyte-ransomware"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_cmd_ping_del_combined_execution.yml"
      }
    },
    {
      "id": "e32d4572-9826-4738-b651-95fa63747e8a",
      "title": "Base64 Encoded PowerShell Command Detected",
      "status": "test",
      "description": "Detects usage of the \"FromBase64String\" function in the commandline which is used to decode a base64 encoded string",
      "level": "high",
      "tags": [
        "attack.t1027",
        "attack.defense-evasion",
        "attack.execution",
        "attack.t1140",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "::FromBase64String(",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1027",
          "T1140",
          "T1059.001"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2020-01-29",
        "modified": "2023-01-26",
        "references": [
          "https://gist.github.com/Neo23x0/6af876ee72b51676c82a2db8d2cd3639"
        ],
        "falsepositives": [
          "Administrative script libraries"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_frombase64string.yml"
      }
    },
    {
      "id": "f57f8d16-1f39-4dcb-a604-6c73d9b54b3d",
      "title": "Sensitive File Access Via Volume Shadow Copy Backup",
      "status": "test",
      "description": "Detects a command that accesses the VolumeShadowCopy in order to extract sensitive files such as the Security or SAM registry hives or the AD database (ntds.dit)\n",
      "level": "high",
      "tags": [
        "attack.impact",
        "attack.t1490"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "\\\\\\\\\\?\\\\GLOBALROOT\\\\Device\\\\HarddiskVolumeShadowCopy",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\\\NTDS.dit",
                  "\\\\SYSTEM",
                  "\\\\SECURITY"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1490"
        ],
        "tactics": [
          "impact"
        ]
      },
      "meta": {
        "author": "Max Altgelt (Nextron Systems), Tobias Michalski (Nextron Systems)",
        "date": "2021-08-09",
        "modified": "2024-01-18",
        "references": [
          "https://twitter.com/vxunderground/status/1423336151860002816?s=20",
          "https://www.virustotal.com/gui/file/03e9b8c2e86d6db450e5eceec057d7e369ee2389b9daecaf06331a95410aa5f8/detection",
          "https://pentestlab.blog/2018/07/04/dumping-domain-password-hashes/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_sensitive_file_access_shadowcopy.yml"
      }
    },
    {
      "id": "38879043-7e1e-47a9-8d46-6bec88e201df",
      "title": "Potential Persistence Attempt Via Existing Service Tampering",
      "status": "test",
      "description": "Detects the modification of an existing service in order to execute an arbitrary payload when the service is started or killed as a potential method for persistence.",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.defense-evasion",
        "attack.persistence",
        "attack.t1543.003",
        "attack.t1574.011"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_sc": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "sc ",
                      "config ",
                      "binpath="
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "sc ",
                      "failure",
                      "command="
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_reg_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "reg ",
                      "add ",
                      "FailureCommand"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "reg ",
                      "add ",
                      "ImagePath"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_reg_ext": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ".sh",
                  ".exe",
                  ".dll",
                  ".bin$",
                  ".bat",
                  ".cmd",
                  ".js",
                  ".msh$",
                  ".reg$",
                  ".scr",
                  ".ps",
                  ".vb",
                  ".jar",
                  ".pl"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_sc or all of selection_reg_*",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection_sc",
            "all of selection_reg_*"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1543.003",
          "T1574.011"
        ],
        "tactics": [
          "privilege_escalation",
          "defense_evasion",
          "persistence"
        ]
      },
      "meta": {
        "author": "Sreeman",
        "date": "2020-09-29",
        "modified": "2023-02-04",
        "references": [
          "https://pentestlab.blog/2020/01/22/persistence-modify-existing-service/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sc_service_tamper_for_persistence.yml"
      }
    },
    {
      "id": "3abd6094-7027-475f-9630-8ab9be7b9725",
      "title": "Windows Admin Share Mount Via Net.EXE",
      "status": "test",
      "description": "Detects when an admin share is mounted using net.exe",
      "level": "medium",
      "tags": [
        "attack.lateral-movement",
        "attack.t1021.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\net.exe",
                      "\\net1.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "net.exe",
                      "net1.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " use ",
                  " \\\\\\\\*\\\\*$"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1021.002"
        ],
        "tactics": [
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "oscd.community, Teymur Kheirkhabarov @HeirhabarovT, Zach Stanford @svch0st, wagga",
        "date": "2020-10-05",
        "modified": "2023-02-21",
        "references": [
          "https://drive.google.com/file/d/1lKya3_mLnR3UQuCoiYruO3qgu052_iS_/view"
        ],
        "falsepositives": [
          "Administrators"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_net_use_mount_admin_share.yml"
      }
    },
    {
      "id": "043c4b8b-3a54-4780-9682-081cb6b8185c",
      "title": "Suspicious IIS Module Registration",
      "status": "test",
      "description": "Detects a suspicious IIS module registration as described in Microsoft threat report on IIS backdoors",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.t1505.004"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\w3wp.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "appcmd.exe add module",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " system.enterpriseservices.internal.publish",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\powershell.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli_3": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "gacutil",
                  " /I"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_parent and 1 of selection_cli_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_parent"
            },
            {
              "type": "ref",
              "value": "1 of selection_cli_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1505.004"
        ],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Microsoft (idea)",
        "date": "2022-08-04",
        "modified": "2023-01-23",
        "references": [
          "https://www.microsoft.com/security/blog/2022/07/26/malicious-iis-extensions-quietly-open-persistent-backdoors-into-servers/"
        ],
        "falsepositives": [
          "Administrative activity"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_iis_susp_module_registration.yml"
      }
    },
    {
      "id": "6e30c82f-a9f8-4aab-b79c-7c12bce6f248",
      "title": "File Download Via Bitsadmin To An Uncommon Target Folder",
      "status": "test",
      "description": "Detects usage of bitsadmin downloading a file to uncommon target folder",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.persistence",
        "attack.t1197",
        "attack.s0190",
        "attack.t1036.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\bitsadmin.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "bitsadmin.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_flags": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " /transfer ",
                  " /create ",
                  " /addfile "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_folder": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "%AppData%",
                  "%temp%",
                  "%tmp%",
                  "\\AppData\\Local\\",
                  "C:\\Windows\\Temp\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1197",
          "T1036.003"
        ],
        "tactics": [
          "defense_evasion",
          "persistence"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-06-28",
        "modified": "2023-02-15",
        "references": [
          "https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin",
          "https://isc.sans.edu/diary/22264",
          "https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/",
          "https://blog.talosintelligence.com/breaking-the-silence-recent-truebot-activity/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_bitsadmin_download_uncommon_targetfolder.yml"
      }
    },
    {
      "id": "5817e76f-4804-41e6-8f1d-5fa0b3ecae2d",
      "title": "PUA - Radmin Viewer Utility Execution",
      "status": "test",
      "description": "Detects the execution of Radmin which can be abused by an adversary to remotely control Windows machines",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.lateral-movement",
        "attack.t1072"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "Radmin Viewer",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Product": {
                    "field": "Product",
                    "value": "Radmin Viewer",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "Radmin.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1072"
        ],
        "tactics": [
          "execution",
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-22",
        "modified": "2023-12-11",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1072/T1072.md",
          "https://www.radmin.fr/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_radmin.yml"
      }
    },
    {
      "id": "214641c2-c579-4ecb-8427-0cf19df6842e",
      "title": "Remote File Download Via Desktopimgdownldr Utility",
      "status": "test",
      "description": "Detects the desktopimgdownldr utility being used to download a remote file. An adversary may use desktopimgdownldr to download arbitrary files as an alternative to certutil.",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1105"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\desktopimgdownldr.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\desktopimgdownldr.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "/lockscreenurl:http",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1105"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Tim Rauch, Elastic (idea)",
        "date": "2022-09-27",
        "modified": "",
        "references": [
          "https://www.elastic.co/guide/en/security/current/remote-file-download-via-desktopimgdownldr-utility.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_desktopimgdownldr_remote_file_download.yml"
      }
    },
    {
      "id": "6385697e-9f1b-40bd-8817-f4a91f40508e",
      "title": "PowerShell Base64 Encoded Invoke Keyword",
      "status": "test",
      "description": "Detects UTF-8 and UTF-16 Base64 encoded powershell 'Invoke-' calls",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059.001",
        "attack.defense-evasion",
        "attack.t1027"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_enc": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -e",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli_invoke": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "SQBuAHYAbwBrAGUALQ",
                  "kAbgB2AG8AawBlAC0A",
                  "JAG4AdgBvAGsAZQAtA",
                  "SW52b2tlL",
                  "ludm9rZS",
                  "JbnZva2Ut"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001",
          "T1027"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "pH-T (Nextron Systems), Harjot Singh, @cyb3rjy0t",
        "date": "2022-05-20",
        "modified": "2023-04-06",
        "references": [
          "https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_base64_invoke.yml"
      }
    },
    {
      "id": "6f0947a4-1c5e-4e0d-8ac7-53159b8f23ca",
      "title": "Potentially Suspicious Child Process Of Regsvr32",
      "status": "test",
      "description": "Detects potentially suspicious child processes of \"regsvr32.exe\".",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.010"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\regsvr32.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\calc.exe",
                  "\\cscript.exe",
                  "\\explorer.exe",
                  "\\mshta.exe",
                  "\\net.exe",
                  "\\net1.exe",
                  "\\nltest.exe",
                  "\\notepad.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\reg.exe",
                  "\\schtasks.exe",
                  "\\werfault.exe",
                  "\\wscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_werfault": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\werfault.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -u -p ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218.010"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "elhoim, Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-05-05",
        "modified": "2023-05-26",
        "references": [
          "https://redcanary.com/blog/intelligence-insights-april-2022/",
          "https://www.echotrail.io/insights/search/regsvr32.exe",
          "https://www.ired.team/offensive-security/code-execution/t1117-regsvr32-aka-squiblydoo"
        ],
        "falsepositives": [
          "Unlikely, but can rarely occur. Apply additional filters accordingly."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_regsvr32_susp_child_process.yml"
      }
    },
    {
      "id": "3268b746-88d8-4cd3-bffc-30077d02c787",
      "title": "HackTool - Empire PowerShell UAC Bypass",
      "status": "stable",
      "description": "Detects some Empire PowerShell UAC bypass methods",
      "level": "critical",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548.002",
        "car.2019-04-001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -NoP -NonI -w Hidden -c $x=$((gp HKCU:Software\\Microsoft\\Windows Update).Update)",
                  " -NoP -NonI -c $x=$((gp HKCU:Software\\Microsoft\\Windows Update).Update);"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Ecco",
        "date": "2019-08-30",
        "modified": "2023-02-21",
        "references": [
          "https://github.com/EmpireProject/Empire/blob/e37fb2eef8ff8f5a0a689f1589f424906fe13055/data/module_source/privesc/Invoke-EventVwrBypass.ps1#L64",
          "https://github.com/EmpireProject/Empire/blob/e37fb2eef8ff8f5a0a689f1589f424906fe13055/data/module_source/privesc/Invoke-FodHelperBypass.ps1#L64"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_empire_powershell_uac_bypass.yml"
      }
    },
    {
      "id": "a018fdc3-46a3-44e5-9afb-2cd4af1d4b39",
      "title": "Suspicious Execution From Outlook Temporary Folder",
      "status": "test",
      "description": "Detects a suspicious program execution in Outlook temp folder",
      "level": "high",
      "tags": [
        "attack.initial-access",
        "attack.t1566.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": "\\Temporary Internet Files\\Content.Outlook\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1566.001"
        ],
        "tactics": [
          "initial_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2019-10-01",
        "modified": "2022-10-09",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_office_outlook_execution_from_temp.yml"
      }
    },
    {
      "id": "74a2b202-73e0-4693-9a3a-9d36146d0775",
      "title": "Remote Access Tool - MeshAgent Command Execution via MeshCentral",
      "status": "test",
      "description": "Detects the use of MeshAgent to execute commands on the target host, particularly when threat actors might abuse it to execute commands directly.\nMeshAgent can execute commands on the target host by leveraging win-console to obscure their activities and win-dispatcher to run malicious code through IPC with child processes.\n",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1219.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\meshagent.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\cmd.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1219.002"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "@Kostastsale",
        "date": "2024-09-22",
        "modified": "",
        "references": [
          "https://github.com/Ylianst/MeshAgent",
          "https://github.com/Ylianst/MeshAgent/blob/52cf129ca43d64743181fbaf940e0b4ddb542a37/modules/win-dispatcher.js#L173",
          "https://github.com/Ylianst/MeshAgent/blob/52cf129ca43d64743181fbaf940e0b4ddb542a37/modules/win-info.js#L55"
        ],
        "falsepositives": [
          "False positives can be found in environments using MeshAgent for remote management, analysis should prioritize the grandparent process, MeshAgent.exe, and scrutinize the resulting child processes triggered by any suspicious interactive commands directed at the target host."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_remote_access_tools_meshagent_exec.yml"
      }
    },
    {
      "id": "1ac8666b-046f-4201-8aba-1951aaec03a3",
      "title": "Command Line Execution with Suspicious URL and AppData Strings",
      "status": "test",
      "description": "Detects a suspicious command line execution that includes an URL and AppData string in the command line parameters as used by several droppers (js/vbs > powershell)",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.command-and-control",
        "attack.t1059.003",
        "attack.t1059.001",
        "attack.t1105"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\cmd.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "http",
                  "://",
                  "%AppData%"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.003",
          "T1059.001",
          "T1105"
        ],
        "tactics": [
          "execution",
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Jonhnathan Ribeiro, oscd.community",
        "date": "2019-01-16",
        "modified": "2021-11-27",
        "references": [
          "https://www.hybrid-analysis.com/sample/3a1f01206684410dbe8f1900bbeaaa543adfcd07368ba646b499fa5274b9edf6?environmentId=100",
          "https://www.hybrid-analysis.com/sample/f16c729aad5c74f19784a24257236a8bbe27f7cdc4a89806031ec7f1bebbd475?environmentId=100"
        ],
        "falsepositives": [
          "High"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_cmd_http_appdata.yml"
      }
    },
    {
      "id": "f5240972-3938-4e56-8e4b-e33893176c1f",
      "title": "Suspicious Query of MachineGUID",
      "status": "test",
      "description": "Use of reg to get MachineGuid information",
      "level": "low",
      "tags": [
        "attack.discovery",
        "attack.t1082"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\reg.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "SOFTWARE\\Microsoft\\Cryptography",
                  "/v ",
                  "MachineGuid"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1082"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-01",
        "modified": "",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1082/T1082.md#atomic-test-8---windows-machineguid-discovery"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_reg_machineguid.yml"
      }
    },
    {
      "id": "63d1ccc0-2a43-4f4b-9289-361b308991ff",
      "title": "Wab/Wabmig Unusual Parent Or Child Processes",
      "status": "test",
      "description": "Detects unusual parent or children of the wab.exe (Windows Contacts) and Wabmig.exe (Microsoft Address Book Import Tool) processes as seen being used with bumblebee activity",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\WmiPrvSE.exe",
                  "\\svchost.exe",
                  "\\dllhost.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\wab.exe",
                  "\\wabmig.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_child": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\wab.exe",
                  "\\wabmig.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-12",
        "modified": "2022-09-27",
        "references": [
          "https://thedfirreport.com/2022/08/08/bumblebee-roasts-its-way-to-domain-admin/",
          "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/bumblebee-loader-cybercrime",
          "https://thedfirreport.com/2022/09/26/bumblebee-round-two/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wab_unusual_parents.yml"
      }
    },
    {
      "id": "065b00ca-5d5c-4557-ac95-64a6d0b64d86",
      "title": "Remote Access Tool - Anydesk Execution From Suspicious Folder",
      "status": "test",
      "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1219.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\AnyDesk.exe",
                      "\\AnyDeskMSI.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "AnyDesk",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Product": {
                    "field": "Product",
                    "value": "AnyDesk",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Company": {
                    "field": "Company",
                    "value": "AnyDesk Software GmbH",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  "\\AppData\\",
                  "Program Files (x86)\\AnyDesk",
                  "Program Files\\AnyDesk"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1219.002"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-05-20",
        "modified": "2025-02-24",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-2---anydesk-files-detected-test-on-windows",
          "https://thedfirreport.com/2025/02/24/confluence-exploit-leads-to-lockbit-ransomware/"
        ],
        "falsepositives": [
          "Legitimate use of AnyDesk from a non-standard folder"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_remote_access_tools_anydesk_susp_exec.yml"
      }
    },
    {
      "id": "ec290c06-9b6b-4338-8b6b-095c0f284f10",
      "title": "Suspicious Execution of Shutdown to Log Out",
      "status": "test",
      "description": "Detects the rare use of the command line tool shutdown to logoff a user",
      "level": "medium",
      "tags": [
        "attack.impact",
        "attack.t1529"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\shutdown.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "/l",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1529"
        ],
        "tactics": [
          "impact"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-10-01",
        "modified": "",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/9e5b12c4912c07562aec7500447b11fa3e17e254/atomics/T1529/T1529.md",
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/shutdown"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_shutdown_logoff.yml"
      }
    },
    {
      "id": "18749301-f1c5-4efc-a4c3-276ff1f5b6f8",
      "title": "Use of VSIISExeLauncher.exe",
      "status": "test",
      "description": "The \"VSIISExeLauncher.exe\" binary part of the Visual Studio/VS Code can be used to execute arbitrary binaries",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1127"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\VSIISExeLauncher.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "VSIISExeLauncher.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -p ",
                  " -a "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1127"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-06-09",
        "modified": "",
        "references": [
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/VSIISExeLauncher/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_vsiisexelauncher.yml"
      }
    },
    {
      "id": "9847f263-4a81-424f-970c-875dab15b79b",
      "title": "Suspicious TSCON Start as SYSTEM",
      "status": "test",
      "description": "Detects a tscon.exe start as LOCAL SYSTEM",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1219.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "User__contains": {
                "field": "User",
                "value": [
                  "AUTHORI",
                  "AUTORI"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\tscon.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1219.002"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2018-03-17",
        "modified": "2022-05-27",
        "references": [
          "http://www.korznikov.com/2017/03/0-day-or-feature-privilege-escalation.html",
          "https://medium.com/@networksecurity/rdp-hijacking-how-to-hijack-rds-and-remoteapp-sessions-transparently-to-move-through-an-da2a1e73a5f6",
          "https://www.ired.team/offensive-security/lateral-movement/t1076-rdp-hijacking-for-lateral-movement"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_tscon_localsystem.yml"
      }
    },
    {
      "id": "6345b048-8441-43a7-9bed-541133633d7a",
      "title": "ManageEngine Endpoint Central Dctask64.EXE Potential Abuse",
      "status": "test",
      "description": "Detects the execution of \"dctask64.exe\", a signed binary by ZOHO Corporation part of ManageEngine Endpoint Central.\nThis binary can be abused for DLL injection, arbitrary command and process execution.\n",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.defense-evasion",
        "attack.t1055.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\dctask64.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Hashes__contains": {
                    "field": "Hashes",
                    "value": [
                      "IMPHASH=6834B1B94E49701D77CCB3C0895E1AFD",
                      "IMPHASH=1BB6F93B129F398C7C4A76BB97450BBA",
                      "IMPHASH=FAA2AC19875FADE461C8D89DCF2710A3",
                      "IMPHASH=F1039CED4B91572AB7847D26032E6BBF"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " executecmd64 ",
                  " invokeexe ",
                  " injectDll "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1055.001"
        ],
        "tactics": [
          "privilege_escalation",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2020-01-28",
        "modified": "2025-01-22",
        "references": [
          "https://twitter.com/gN3mes1s/status/1222088214581825540",
          "https://twitter.com/gN3mes1s/status/1222095963789111296",
          "https://twitter.com/gN3mes1s/status/1222095371175911424"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_dctask64_arbitrary_command_and_dll_execution.yml"
      }
    },
    {
      "id": "bd8b828d-0dca-48e1-8a63-8a58ecf2644f",
      "title": "Group Membership Reconnaissance Via Whoami.EXE",
      "status": "test",
      "description": "Detects the execution of whoami.exe with the /group command line flag to show group membership for the current user, account type, security identifiers (SID), and attributes.",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.t1033"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\whoami.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "whoami.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " /groups",
                  " -groups"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1033"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-02-28",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/whoami"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_whoami_groups_discovery.yml"
      }
    },
    {
      "id": "3b5b0213-0460-4e3f-8937-3abf98ff7dcc",
      "title": "Suspicious Workstation Locking via Rundll32",
      "status": "test",
      "description": "Detects a suspicious call to the user32.dll function that locks the user workstation",
      "level": "medium",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_call_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\rundll32.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "RUNDLL32.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_call_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\cmd.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_call_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "user32.dll,",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_function": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "LockWorkStation",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-06-04",
        "modified": "2023-02-09",
        "references": [
          "https://app.any.run/tasks/2aef9c63-f944-4763-b3ef-81eee209d128/"
        ],
        "falsepositives": [
          "Scripts or links on the user desktop used to lock the workstation instead of Windows+L or the menu option"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_rundll32_user32_dll.yml"
      }
    },
    {
      "id": "551d9c1f-816c-445b-a7a6-7a3864720d60",
      "title": "Potential Excel.EXE DCOM Lateral Movement Via ActivateMicrosoftApp",
      "status": "test",
      "description": "Detects suspicious child processes of Excel which could be an indicator of lateral movement leveraging the \"ActivateMicrosoftApp\" Excel DCOM object.\n",
      "level": "high",
      "tags": [
        "attack.t1021.003",
        "attack.lateral-movement"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\excel.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_child": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "foxprow.exe",
                      "schdplus.exe",
                      "winproj.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\foxprow.exe",
                      "\\schdplus.exe",
                      "\\winproj.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1021.003"
        ],
        "tactics": [
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Aaron Stratton",
        "date": "2023-11-13",
        "modified": "",
        "references": [
          "https://posts.specterops.io/lateral-movement-abuse-the-power-of-dcom-excel-application-3c016d0d9922",
          "https://github.com/grayhatkiller/SharpExShell",
          "https://learn.microsoft.com/en-us/office/vba/api/excel.xlmsapplication"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_office_excel_dcom_lateral_movement.yml"
      }
    },
    {
      "id": "9082ff1f-88ab-4678-a3cc-5bcff99fc74d",
      "title": "HackTool - GMER Rootkit Detector and Remover Execution",
      "status": "test",
      "description": "Detects the execution GMER tool based on image and hash fields.",
      "level": "high",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\gmer.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_sysmon_hash": {
            "type": "field_match",
            "matchers": {
              "Hashes__contains": {
                "field": "Hashes",
                "value": [
                  "MD5=E9DC058440D321AA17D0600B3CA0AB04",
                  "SHA1=539C228B6B332F5AA523E5CE358C16647D8BBE57",
                  "SHA256=E8A3E804A96C716A3E9B69195DB6FFB0D33E2433AF871E4D4E1EAB3097237173"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-10-05",
        "modified": "2024-11-23",
        "references": [
          "http://www.gmer.net/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_gmer.yml"
      }
    },
    {
      "id": "b86f6dea-0b2f-41f5-bdcc-a057bd19cd6a",
      "title": "File Download From IP Based URL Via CertOC.EXE",
      "status": "test",
      "description": "Detects when a user downloads a file from an IP based URL using CertOC.exe",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.execution",
        "attack.t1105"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\certoc.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "CertOC.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_ip": {
            "type": "field_match",
            "matchers": {
              "CommandLine__re": {
                "field": "CommandLine",
                "value": "://[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}",
                "modifiers": [
                  "re"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-GetCACAPS",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1105"
        ],
        "tactics": [
          "command_and_control",
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-10-18",
        "modified": "",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Certoc/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_certoc_download_direct_ip.yml"
      }
    },
    {
      "id": "ee218c12-627a-4d27-9e30-d6fb2fe22ed2",
      "title": "Powershell Inline Execution From A File",
      "status": "test",
      "description": "Detects inline execution of PowerShell code from a file",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_exec": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "iex ",
                  "Invoke-Expression ",
                  "Invoke-Command ",
                  "icm "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_read": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "cat ",
                  "get-content ",
                  "type "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_raw": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -raw",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-12-25",
        "modified": "",
        "references": [
          "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse?slide=50"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_exec_data_file.yml"
      }
    },
    {
      "id": "058f4380-962d-40a5-afce-50207d36d7e2",
      "title": "HackTool - CrackMapExec Execution Patterns",
      "status": "stable",
      "description": "Detects various execution patterns of the CrackMapExec pentesting framework",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.execution",
        "attack.t1047",
        "attack.t1053",
        "attack.t1059.003",
        "attack.t1059.001",
        "attack.s0106"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "cmd.exe /Q /c * 1> \\\\\\\\*\\\\*\\\\* 2>&1",
                  "cmd.exe /C * > \\\\\\\\*\\\\*\\\\* 2>&1",
                  "cmd.exe /C * > *\\\\Temp\\\\* 2>&1",
                  "powershell.exe -exec bypass -noni -nop -w 1 -C \"",
                  "powershell.exe -noni -nop -w 1 -enc "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1047",
          "T1053",
          "T1059.003",
          "T1059.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "execution"
        ]
      },
      "meta": {
        "author": "Thomas Patzke",
        "date": "2020-05-22",
        "modified": "2023-11-06",
        "references": [
          "https://github.com/byt3bl33d3r/CrackMapExec"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_crackmapexec_execution_patterns.yml"
      }
    },
    {
      "id": "e6c54d94-498c-4562-a37c-b469d8e9a275",
      "title": "Suspicious PowerShell Download and Execute Pattern",
      "status": "test",
      "description": "Detects suspicious PowerShell download patterns that are often used in malicious scripts, stagers or downloaders (make sure that your backend applies the strings case-insensitive)",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "IEX ((New-Object Net.WebClient).DownloadString",
                  "IEX (New-Object Net.WebClient).DownloadString",
                  "IEX((New-Object Net.WebClient).DownloadString",
                  "IEX(New-Object Net.WebClient).DownloadString",
                  " -command (New-Object System.Net.WebClient).DownloadFile(",
                  " -c (New-Object System.Net.WebClient).DownloadFile("
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-02-28",
        "modified": "2022-03-01",
        "references": [
          "https://gist.github.com/jivoi/c354eaaf3019352ce32522f916c03d70",
          "https://www.trendmicro.com/en_us/research/22/j/lv-ransomware-exploits-proxyshell-in-attack.html"
        ],
        "falsepositives": [
          "Software installers that pull packages from remote systems and execute them"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_susp_download_patterns.yml"
      }
    },
    {
      "id": "c443012c-7928-43bf-ac20-7eda5efe61ad",
      "title": "Suspicious Uninstall of Windows Defender Feature via PowerShell",
      "status": "experimental",
      "description": "Detects the use of PowerShell with Uninstall-WindowsFeature or Remove-WindowsFeature cmdlets to disable or remove the Windows Defender GUI feature, a common technique used by adversaries to evade defenses.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell_ise.exe",
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell_ISE.EXE",
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_uninstall": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Uninstall-WindowsFeature",
                  "Remove-WindowsFeature"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_defender_feature": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "Windows-Defender",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "yxinmiracle",
        "date": "2025-08-22",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/powershell/module/microsoft.windows.servermanager.migration/uninstall-windowsfeature",
          "https://thedfirreport.com/2023/04/03/malicious-iso-file-leads-to-domain-wide-ransomware"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_uninstall_defender_feature.yml"
      }
    },
    {
      "id": "515c8be5-e5df-4c5e-8f6d-a4a2f05e4b48",
      "title": "CreateDump Process Dump",
      "status": "test",
      "description": "Detects uses of the createdump.exe LOLOBIN utility to dump process memory",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036",
        "attack.t1003.001",
        "attack.credential-access"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\createdump.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "FX_VER_INTERNALNAME_STR",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -u ",
                  " --full ",
                  " -f ",
                  " --name ",
                  ".dmp "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1036",
          "T1003.001"
        ],
        "tactics": [
          "defense_evasion",
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-01-04",
        "modified": "2022-08-19",
        "references": [
          "https://www.crowdstrike.com/blog/overwatch-exposes-aquatic-panda-in-possession-of-log-4-shell-exploit-tools/",
          "https://twitter.com/bopin2020/status/1366400799199272960"
        ],
        "falsepositives": [
          "Command lines that use the same flags"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_createdump_lolbin_execution.yml"
      }
    },
    {
      "id": "d55b793d-f847-4eea-b59a-5ab09908ac90",
      "title": "Suspicious Child Process Of Veeam Dabatase",
      "status": "test",
      "description": "Detects suspicious child processes of the Veeam service process. This could indicate potential RCE or SQL Injection.",
      "level": "critical",
      "tags": [
        "attack.initial-access",
        "attack.persistence",
        "attack.privilege-escalation"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\sqlservr.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "ParentCommandLine__contains": {
                "field": "ParentCommandLine",
                "value": "VEEAMSQL",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_child_1": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\cmd.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\wsl.exe",
                  "\\wt.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "-ex ",
                  "bypass",
                  "cscript",
                  "DownloadString",
                  "http://",
                  "https://",
                  "mshta",
                  "regsvr32",
                  "rundll32",
                  "wscript",
                  "copy "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_child_2": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\net.exe",
                  "\\net1.exe",
                  "\\netstat.exe",
                  "\\nltest.exe",
                  "\\ping.exe",
                  "\\tasklist.exe",
                  "\\whoami.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_parent and 1 of selection_child_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_parent"
            },
            {
              "type": "ref",
              "value": "1 of selection_child_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "initial_access",
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-04",
        "modified": "",
        "references": [
          "https://labs.withsecure.com/publications/fin7-target-veeam-servers"
        ],
        "falsepositives": [],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_mssql_veaam_susp_child_processes.yml"
      }
    },
    {
      "id": "e212d415-0e93-435f-9e1a-f29005bb4723",
      "title": "Suspicious Remote Child Process From Outlook",
      "status": "test",
      "description": "Detects a suspicious child process spawning from Outlook where the image is located in a remote location (SMB/WebDav shares).",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.defense-evasion",
        "attack.t1059",
        "attack.t1202"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\outlook.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__startswith": {
                "field": "Image",
                "value": "\\\\\\\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059",
          "T1202"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Markus Neis, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2018-12-27",
        "modified": "2023-02-09",
        "references": [
          "https://github.com/sensepost/ruler",
          "https://www.fireeye.com/blog/threat-research/2018/12/overruled-containing-a-potentially-destructive-adversary.html",
          "https://speakerdeck.com/heirhabarov/hunting-for-persistence-via-microsoft-exchange-server-or-outlook?slide=49"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_office_outlook_susp_child_processes_remote.yml"
      }
    },
    {
      "id": "5bac7a56-da88-4c27-922e-c81e113b20cb",
      "title": "Github Self-Hosted Runner Execution",
      "status": "test",
      "description": "Detects GitHub self-hosted runners executing workflows on local infrastructure that could be abused for persistence and code execution.\nShai-Hulud is an npm supply chain worm targeting CI/CD environments.\nIt installs runners on compromised systems to maintain access after credential theft, leveraging their access to secrets and internal networks.\n",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1102.002",
        "attack.t1071"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_worker_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\Runner.Worker.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "Runner.Worker.dll",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_worker_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "spawnclient",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_listener_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\Runner.Listener.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "Runner.Listener.dll",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_listener_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "run",
                  "configure"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_worker_* or all of selection_listener_*",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "all of selection_worker_*",
            "all of selection_listener_*"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1102.002",
          "T1071"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Daniel Koifman (KoifSec)",
        "date": "2025-11-29",
        "modified": "",
        "references": [
          "https://about.gitlab.com/blog/gitlab-discovers-widespread-npm-supply-chain-attack/",
          "https://securitylabs.datadoghq.com/articles/shai-hulud-2.0-npm-worm/"
        ],
        "falsepositives": [
          "Legitimate GitHub self-hosted runner installations on designated CI/CD infrastructure",
          "Authorized runner deployments by DevOps/Platform teams following change management",
          "Scheduled runner updates or reconfigurations on existing build agents",
          "Self-hosted runners that follow expected/known naming patterns",
          "Installation via expected/known configuration management tools (reflected mostly as parent process name)"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_github_self_hosted_runner.yml"
      }
    },
    {
      "id": "05c36dd6-79d6-4a9a-97da-3db20298ab2d",
      "title": "XSL Script Execution Via WMIC.EXE",
      "status": "test",
      "description": "Detects the execution of WMIC with the \"format\" flag to potentially load XSL files.\nAdversaries abuse this functionality to execute arbitrary files while potentially bypassing application whitelisting defenses.\nExtensible Stylesheet Language (XSL) files are commonly used to describe the processing and rendering of data within XML files.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1220"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\wmic.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-format",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_known_format": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Format:List",
                  "Format:htable",
                  "Format:hform",
                  "Format:table",
                  "Format:mof",
                  "Format:value",
                  "Format:rawxml",
                  "Format:xml",
                  "Format:csv"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1220"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Timur Zinniatullin, oscd.community, Swachchhanda Shrawan Poudel",
        "date": "2019-10-21",
        "modified": "2024-03-05",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1220/T1220.md"
        ],
        "falsepositives": [
          "WMIC.exe FP depend on scripts and administrative methods used in the monitored environment.",
          "Static format arguments - https://petri.com/command-line-wmi-part-3"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wmic_xsl_script_processing.yml"
      }
    },
    {
      "id": "f26eb764-fd89-464b-85e2-dc4a8e6e77b8",
      "title": "Suspicious Electron Application Child Processes",
      "status": "test",
      "description": "Detects suspicious child processes of electron apps (teams, discord, slack, etc.). This could be a potential sign of \".asar\" file tampering (See reference section for more information) or binary execution proxy through specific CLI arguments (see related rule)\n",
      "level": "medium",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\chrome.exe",
                  "\\discord.exe",
                  "\\GitHubDesktop.exe",
                  "\\keybase.exe",
                  "\\msedge.exe",
                  "\\msedgewebview2.exe",
                  "\\msteams.exe",
                  "\\slack.exe",
                  "\\teams.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_child_image": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\cmd.exe",
                  "\\cscript.exe",
                  "\\mshta.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\regsvr32.exe",
                  "\\whoami.exe",
                  "\\wscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_child_paths": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  ":\\ProgramData\\",
                  ":\\Temp\\",
                  "\\AppData\\Local\\Temp\\",
                  "\\Users\\Public\\",
                  "\\Windows\\Temp\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_discord": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\Discord.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\cmd.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "\\NVSMI\\nvidia-smi.exe",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection_parent and 1 of selection_child_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_parent"
            },
            {
              "type": "ref",
              "value": "1 of selection_child_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-10-21",
        "modified": "2024-07-12",
        "references": [
          "https://taggart-tech.com/quasar-electron/",
          "https://github.com/mttaggart/quasar",
          "https://positive.security/blog/ms-officecmd-rce",
          "https://lolbas-project.github.io/lolbas/Binaries/Msedge/",
          "https://lolbas-project.github.io/lolbas/Binaries/Teams/",
          "https://lolbas-project.github.io/lolbas/Binaries/msedgewebview2/",
          "https://medium.com/@MalFuzzer/one-electron-to-rule-them-all-dc2e9b263daf"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_electron_app_children.yml"
      }
    },
    {
      "id": "d797268e-28a9-49a7-b9a8-2f5039011c5c",
      "title": "Bypass UAC via WSReset.exe",
      "status": "test",
      "description": "Detects use of WSReset.exe to bypass User Account Control (UAC). Adversaries use this technique to execute privileged processes.",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.defense-evasion",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\wsreset.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\conhost.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "CONHOST.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "privilege_escalation",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "E.M. Anhaus (originally from Atomic Blue Detections, Tony Lambert), oscd.community, Florian Roth",
        "date": "2019-10-24",
        "modified": "2022-05-13",
        "references": [
          "https://eqllib.readthedocs.io/en/latest/analytics/532b5ed4-7930-11e9-8f5c-d46d6d62a49e.html",
          "https://lolbas-project.github.io/lolbas/Binaries/Wsreset/",
          "https://www.activecyber.us/activelabs/windows-uac-bypass",
          "https://twitter.com/ReaQta/status/1222548288731217921"
        ],
        "falsepositives": [
          "Unknown sub processes of Wsreset.exe"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_uac_bypass_wsreset.yml"
      }
    },
    {
      "id": "204b17ae-4007-471b-917b-b917b315c5db",
      "title": "Greedy File Deletion Using Del",
      "status": "test",
      "description": "Detects execution of the \"del\" builtin command to remove files using greedy/wildcard expression. This is often used by malware to delete content of folders that perhaps contains the initial malware infection or to delete evidence.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1070.004"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\cmd.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "Cmd.Exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_del": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "del ",
                  "erase "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_extensions": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\\\\\*.au3",
                  "\\\\\\*.dll",
                  "\\\\\\*.exe",
                  "\\\\\\*.js"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1070.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113 , X__Junior (Nextron Systems)",
        "date": "2021-12-02",
        "modified": "2023-09-11",
        "references": [
          "https://www.joesandbox.com/analysis/509330/0/html#1044F3BDBE3BB6F734E357235F4D5898582D",
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/erase"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_cmd_del_greedy_deletion.yml"
      }
    },
    {
      "id": "1cdd9a09-06c9-4769-99ff-626e2b3991b8",
      "title": "Suspicious Double Extension File Execution",
      "status": "stable",
      "description": "Detects suspicious use of an .exe extension after a non-executable file extension like .pdf.exe, a set of spaces or underlines to cloak the executable file in spear phishing campaigns",
      "level": "high",
      "tags": [
        "attack.initial-access",
        "attack.t1566.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "      .exe",
                  "______.exe",
                  ".doc.exe",
                  ".doc.js",
                  ".docx.exe",
                  ".docx.js",
                  ".gif.exe",
                  ".jpeg.exe",
                  ".jpg.exe",
                  ".mkv.exe",
                  ".mov.exe",
                  ".mp3.exe",
                  ".mp4.exe",
                  ".pdf.exe",
                  ".pdf.js",
                  ".png.exe",
                  ".ppt.exe",
                  ".ppt.js",
                  ".pptx.exe",
                  ".pptx.js",
                  ".rtf.exe",
                  ".rtf.js",
                  ".svg.exe",
                  ".txt.exe",
                  ".txt.js",
                  ".xls.exe",
                  ".xls.js",
                  ".xlsx.exe",
                  ".xlsx.js",
                  "⠀⠀⠀⠀⠀⠀.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "      .exe",
                  "______.exe",
                  ".doc.exe",
                  ".doc.js",
                  ".docx.exe",
                  ".docx.js",
                  ".gif.exe",
                  ".jpeg.exe",
                  ".jpg.exe",
                  ".mkv.exe",
                  ".mov.exe",
                  ".mp3.exe",
                  ".mp4.exe",
                  ".pdf.exe",
                  ".pdf.js",
                  ".png.exe",
                  ".ppt.exe",
                  ".ppt.js",
                  ".pptx.exe",
                  ".pptx.js",
                  ".rtf.exe",
                  ".rtf.js",
                  ".svg.exe",
                  ".txt.exe",
                  ".txt.js",
                  ".xls.exe",
                  ".xls.js",
                  ".xlsx.exe",
                  ".xlsx.js",
                  "⠀⠀⠀⠀⠀⠀.exe"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1566.001"
        ],
        "tactics": [
          "initial_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), @blu3_team (idea), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2019-06-26",
        "modified": "2025-05-30",
        "references": [
          "https://blu3-team.blogspot.com/2019/06/misleading-extensions-xlsexe-docexe.html",
          "https://twitter.com/blackorbird/status/1140519090961825792",
          "https://cloud.google.com/blog/topics/threat-intelligence/cybercriminals-weaponize-fake-ai-websites"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_double_extension.yml"
      }
    },
    {
      "id": "98dedfdd-8333-49d4-9f23-d7018cccae53",
      "title": "Enable LM Hash Storage - ProcCreation",
      "status": "test",
      "description": "Detects changes to the \"NoLMHash\" registry value in order to allow Windows to store LM Hashes.\nBy setting this registry value to \"0\" (DWORD), Windows will be allowed to store a LAN manager hash of your password in Active Directory and local SAM databases.\n",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "\\System\\CurrentControlSet\\Control\\Lsa",
                  "NoLMHash",
                  " 0"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-12-15",
        "modified": "2023-12-22",
        "references": [
          "https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-347a",
          "https://learn.microsoft.com/en-us/troubleshoot/windows-server/windows-security/prevent-windows-store-lm-hash-password",
          "https://www.sans.org/blog/protecting-privileged-domain-accounts-lm-hashes-the-good-the-bad-and-the-ugly/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_reg_nolmhash.yml"
      }
    },
    {
      "id": "9a019ffc-3580-4c9d-8d87-079f7e8d3fd4",
      "title": "Cloudflared Tunnel Execution",
      "status": "test",
      "description": "Detects execution of the \"cloudflared\" tool to connect back to a tunnel. This was seen used by threat actors to maintain persistence and remote access to compromised networks.",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1102",
        "attack.t1090",
        "attack.t1572"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " tunnel ",
                  " run "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "-config ",
                  "-credentials-contents ",
                  "-credentials-file ",
                  "-token "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1102",
          "T1090",
          "T1572"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Janantha Marasinghe, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-17",
        "modified": "2023-12-20",
        "references": [
          "https://blog.reconinfosec.com/emergence-of-akira-ransomware-group",
          "https://github.com/cloudflare/cloudflared",
          "https://developers.cloudflare.com/cloudflare-one/connections/connect-apps"
        ],
        "falsepositives": [
          "Legitimate usage of Cloudflared tunnel."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_cloudflared_tunnel_run.yml"
      }
    },
    {
      "id": "a743ceba-c771-4d75-97eb-8a90f7f4844c",
      "title": "UAC Bypass Using PkgMgr and DISM",
      "status": "test",
      "description": "Detects the pattern of UAC Bypass using pkgmgr.exe and dism.exe (UACMe 23)",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\pkgmgr.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\dism.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "IntegrityLevel": {
                "field": "IntegrityLevel",
                "value": [
                  "High",
                  "System",
                  "S-1-16-16384",
                  "S-1-16-12288"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Christian Burkard (Nextron Systems)",
        "date": "2021-08-23",
        "modified": "2024-12-01",
        "references": [
          "https://github.com/hfiref0x/UACME"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_uac_bypass_pkgmgr_dism.yml"
      }
    },
    {
      "id": "8537c866-072e-460d-bfff-aaf39cbd73d3",
      "title": "Potentially Suspicious Inline JavaScript Execution via NodeJS Binary",
      "status": "experimental",
      "description": "Detects potentially suspicious inline JavaScript execution using Node.js with specific keywords in the command line.",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059.007"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\node.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "node.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Product": {
                    "field": "Product",
                    "value": "Node.js",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cmd": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "http",
                  "execSync",
                  "spawn",
                  "fs",
                  "path",
                  "zlib"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.007"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Microsoft (idea), Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-04-21",
        "modified": "",
        "references": [
          "https://www.microsoft.com/en-us/security/blog/2025/04/15/threat-actors-misuse-node-js-to-deliver-malware-and-other-malicious-payloads/"
        ],
        "falsepositives": [
          "Legitimate scripts using Node.js with these modules"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_inline_node_js_execution.yml"
      }
    },
    {
      "id": "ad691d92-15f2-4181-9aa4-723c74f9ddc3",
      "title": "Potential Defense Evasion Via Right-to-Left Override",
      "status": "test",
      "description": "Detects the presence of the \"u202+E\" character, which causes a terminal, browser, or operating system to render text in a right-to-left sequence.\nThis is used as an obfuscation and masquerading techniques.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\u202e",
                  "[U+202E]"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1036.002"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Micah Babinski, @micahbabinski, Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2023-02-15",
        "modified": "2025-02-06",
        "references": [
          "https://redcanary.com/blog/right-to-left-override/",
          "https://www.malwarebytes.com/blog/news/2014/01/the-rtlo-method",
          "https://unicode-explorer.com/c/202E",
          "https://tria.ge/241015-l98snsyeje/behavioral2"
        ],
        "falsepositives": [
          "Commandlines that contains scriptures such as arabic or hebrew might make use of this character"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_right_to_left_override.yml"
      }
    },
    {
      "id": "7dc2dedd-7603-461a-bc13-15803d132355",
      "title": "Uncommon Child Process Of Conhost.EXE",
      "status": "test",
      "description": "Detects uncommon \"conhost\" child processes. This could be a sign of \"conhost\" usage as a LOLBIN or potential process injection activity.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1202"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\conhost.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_conhost": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": ":\\Windows\\System32\\conhost.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_null": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_empty": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_provider": {
            "type": "field_match",
            "matchers": {
              "Provider_Name": {
                "field": "Provider_Name",
                "value": "SystemTraceProvider-Process",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1202"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "omkar72",
        "date": "2020-10-25",
        "modified": "2023-12-11",
        "references": [
          "http://www.hexacorn.com/blog/2020/05/25/how-to-con-your-host/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_conhost_susp_child_process.yml"
      }
    },
    {
      "id": "889719ef-dd62-43df-86c3-768fb08dc7c0",
      "title": "Suspicious PowerShell Mailbox Export to Share",
      "status": "test",
      "description": "Detects usage of the powerShell New-MailboxExportRequest Cmdlet to exports a mailbox to a remote or local share, as used in ProxyShell exploitations",
      "level": "critical",
      "tags": [
        "attack.exfiltration"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "New-MailboxExportRequest",
                  " -Mailbox ",
                  " -FilePath \\\\\\\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "exfiltration"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-08-07",
        "modified": "2022-10-26",
        "references": [
          "https://youtu.be/5mqid-7zp8k?t=2481",
          "https://blog.orange.tw/2021/08/proxylogon-a-new-attack-surface-on-ms-exchange-part-1.html",
          "https://peterjson.medium.com/reproducing-the-proxyshell-pwn2own-exploit-49743a4ea9a1",
          "https://m365internals.com/2022/10/07/hunting-in-on-premises-exchange-server-logs/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_mailboxexport_share.yml"
      }
    },
    {
      "id": "867356ee-9352-41c9-a8f2-1be690d78216",
      "title": "Potentially Suspicious Regsvr32 HTTP/FTP Pattern",
      "status": "test",
      "description": "Detects regsvr32 execution to download/install/register new DLLs that are hosted on Web or FTP servers.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.010"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\regsvr32.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "REGSVR32.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_flag": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " /i",
                  " -i"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_protocol": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "ftp",
                  "http"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.010"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2023-05-24",
        "modified": "2023-05-26",
        "references": [
          "https://twitter.com/mrd0x/status/1461041276514623491",
          "https://twitter.com/tccontre18/status/1480950986650832903",
          "https://lolbas-project.github.io/lolbas/Binaries/Regsvr32/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_regsvr32_network_pattern.yml"
      }
    },
    {
      "id": "9719a8aa-401c-41af-8108-ced7ec9cd75c",
      "title": "Windows Defender Definition Files Removed",
      "status": "test",
      "description": "Adversaries may disable security tools to avoid possible detection of their tools and activities by removing Windows Defender Definition Files",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\MpCmdRun.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "MpCmdRun.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " -RemoveDefinitions",
                  " -All"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-07-07",
        "modified": "2023-07-18",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md",
          "https://unit42.paloaltonetworks.com/unit42-gorgon-group-slithering-nation-state-cybercrime/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_mpcmdrun_remove_windows_defender_definition.yml"
      }
    },
    {
      "id": "850d55f9-6eeb-4492-ad69-a72338f65ba4",
      "title": "C# IL Code Compilation Via Ilasm.EXE",
      "status": "test",
      "description": "Detects the use of \"Ilasm.EXE\" in order to compile C# intermediate (IL) code to EXE or DLL.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1127"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\ilasm.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "ilasm.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " /dll",
                  " /exe"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1127"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-05-07",
        "modified": "2022-05-16",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Ilasm/",
          "https://www.echotrail.io/insights/search/ilasm.exe"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_ilasm_il_code_compilation.yml"
      }
    },
    {
      "id": "2a072a96-a086-49fa-bcb5-15cc5a619093",
      "title": "Start Windows Service Via Net.EXE",
      "status": "test",
      "description": "Detects the usage of the \"net.exe\" command to start a service using the \"start\" flag",
      "level": "low",
      "tags": [
        "attack.execution",
        "attack.t1569.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\net.exe",
                      "\\net1.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "net.exe",
                      "net1.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " start ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1569.002"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Timur Zinniatullin, Daniil Yugoslavskiy, oscd.community",
        "date": "2019-10-21",
        "modified": "2023-03-05",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1569.002/T1569.002.md"
        ],
        "falsepositives": [
          "Legitimate administrator or user executes a service for legitimate reasons."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_net_start_service.yml"
      }
    },
    {
      "id": "ba4cfc11-d0fa-4d94-bf20-7c332c412e76",
      "title": "Potentially Suspicious DLL Registered Via Odbcconf.EXE",
      "status": "test",
      "description": "Detects execution of \"odbcconf\" with the \"REGSVR\" action where the DLL in question doesn't contain a \".dll\" extension. Which is often used as a method to evade defenses.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.008"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\odbcconf.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "odbcconf.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "REGSVR ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_dll_ext": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": ".dll",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_main_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.008"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-22",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/sql/odbc/odbcconf-exe?view=sql-server-ver16",
          "https://lolbas-project.github.io/lolbas/Binaries/Odbcconf/",
          "https://www.trendmicro.com/en_us/research/17/h/backdoor-carrying-emails-set-sights-on-russian-speaking-businesses.html"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_odbcconf_register_dll_regsvr_susp.yml"
      }
    },
    {
      "id": "c5c00f49-b3f9-45a6-997e-cfdecc6e1967",
      "title": "Suspicious Schtasks Execution AppData Folder",
      "status": "test",
      "description": "Detects the creation of a schtask that executes a file from C:\\Users\\<USER>\\AppData\\Local",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.execution",
        "attack.persistence",
        "attack.t1053.005",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\schtasks.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/Create",
                  "/RU",
                  "/TR",
                  "C:\\Users\\",
                  "\\AppData\\Local\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "NT AUT",
                  " SYSTEM "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "ParentImage__contains_all": {
                "field": "ParentImage",
                "value": [
                  "\\AppData\\Local\\Temp\\",
                  "TeamViewer_.exe"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\schtasks.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "/TN TVInstallRestore",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1053.005",
          "T1059.001"
        ],
        "tactics": [
          "privilege_escalation",
          "execution",
          "persistence"
        ]
      },
      "meta": {
        "author": "pH-T (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-03-15",
        "modified": "2022-07-28",
        "references": [
          "https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_schtasks_appdata_local_system.yml"
      }
    },
    {
      "id": "9525dc73-0327-438c-8c04-13c0e037e9da",
      "title": "Regsvr32 Execution From Potential Suspicious Location",
      "status": "test",
      "description": "Detects execution of regsvr32 where the DLL is located in a potentially suspicious location.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.010"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\regsvr32.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "REGSVR32.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ":\\ProgramData\\",
                  ":\\Temp\\",
                  ":\\Users\\Public\\",
                  ":\\Windows\\Temp\\",
                  "\\AppData\\Local\\Temp\\",
                  "\\AppData\\Roaming\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.010"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-26",
        "modified": "",
        "references": [
          "https://web.archive.org/web/20171001085340/https://subt0x10.blogspot.com/2017/04/bypass-application-whitelisting-script.html",
          "https://app.any.run/tasks/34221348-072d-4b70-93f3-aa71f6ebecad/"
        ],
        "falsepositives": [
          "Some installers might execute \"regsvr32\" with DLLs located in %TEMP% or in %PROGRAMDATA%. Apply additional filters if necessary."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_regsvr32_susp_exec_path_1.yml"
      }
    },
    {
      "id": "d4ca7c59-e9e4-42d8-bf57-91a776efcb87",
      "title": "LOLBIN Execution From Abnormal Drive",
      "status": "test",
      "description": "Detects LOLBINs executing from an abnormal or uncommon drive such as a mounted ISO.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\calc.exe",
                      "\\certutil.exe",
                      "\\cmstp.exe",
                      "\\cscript.exe",
                      "\\installutil.exe",
                      "\\mshta.exe",
                      "\\regsvr32.exe",
                      "\\rundll32.exe",
                      "\\wscript.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "CALC.EXE",
                      "CertUtil.exe",
                      "CMSTP.EXE",
                      "cscript.exe",
                      "installutil.exe",
                      "MSHTA.EXE",
                      "REGSVR32.EXE",
                      "RUNDLL32.EXE",
                      "wscript.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_main_currentdirectory": {
            "type": "field_match",
            "matchers": {
              "CurrentDirectory__contains": {
                "field": "CurrentDirectory",
                "value": "C:\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_empty": {
            "type": "field_match",
            "matchers": {
              "CurrentDirectory": {
                "field": "CurrentDirectory",
                "value": "",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_null": {
            "type": "field_match",
            "matchers": {
              "CurrentDirectory": {
                "field": "CurrentDirectory",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Christopher Peacock '@securepeacock', SCYTHE '@scythe_io', Angelo Violetti - SEC Consult '@angelo_violetti', Aaron Herman",
        "date": "2022-01-25",
        "modified": "2023-08-29",
        "references": [
          "https://thedfirreport.com/2021/12/13/diavol-ransomware/",
          "https://www.scythe.io/library/threat-emulation-qakbot",
          "https://sec-consult.com/blog/detail/bumblebee-hunting-with-a-velociraptor/"
        ],
        "falsepositives": [
          "Rare false positives could occur on servers with multiple drives."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_lolbin_exec_from_non_c_drive.yml"
      }
    },
    {
      "id": "efec536f-72e8-4656-8960-5e85d091345b",
      "title": "Set Suspicious Files as System Files Using Attrib.EXE",
      "status": "test",
      "description": "Detects the usage of attrib with the \"+s\" option to set scripts or executables located in suspicious locations as system files to hide them from users and make them unable to be deleted with simple rights. The rule limits the search to specific extensions and directories to avoid FPs\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1564.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\attrib.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "ATTRIB.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " +s",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_paths": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " %",
                  "\\Users\\Public\\",
                  "\\AppData\\Local\\",
                  "\\ProgramData\\",
                  "\\Downloads\\",
                  "\\Windows\\Temp\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_ext": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ".bat",
                  ".dll",
                  ".exe",
                  ".hta",
                  ".ps1",
                  ".vbe",
                  ".vbs"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_installer": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "\\Windows\\TEMP\\",
                  ".exe"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection",
          "none_of": "filter_optional_"
        }
      },
      "mitre": {
        "techniques": [
          "T1564.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-06-28",
        "modified": "2023-03-14",
        "references": [
          "https://app.any.run/tasks/c28cabc8-a19f-40f3-a78b-cae506a5c0d4",
          "https://app.any.run/tasks/cfc8870b-ccd7-4210-88cf-a8087476a6d0",
          "https://unit42.paloaltonetworks.com/unit42-sure-ill-take-new-combojack-malware-alters-clipboards-steal-cryptocurrency/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_attrib_system_susp_paths.yml"
      }
    },
    {
      "id": "1dde5376-a648-492e-9e54-4241dd9b0c7f",
      "title": "Diskshadow Script Mode - Uncommon Script Extension Execution",
      "status": "test",
      "description": "Detects execution of \"Diskshadow.exe\" in script mode to execute an script with a potentially uncommon extension.\nInitial baselining of the allowed extension list is required.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "diskshadow.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\diskshadow.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_flag": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-s ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_ext": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": ".txt",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_main_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-09-15",
        "modified": "2024-03-05",
        "references": [
          "https://bohops.com/2018/03/26/diskshadow-the-return-of-vss-evasion-persistence-and-active-directory-database-extraction/",
          "https://www.ired.team/offensive-security/credential-access-and-credential-dumping/ntds.dit-enumeration",
          "https://medium.com/@cyberjyot/lolbin-execution-via-diskshadow-f6ff681a27a4",
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/diskshadow",
          "https://www.lifars.com/wp-content/uploads/2022/01/GriefRansomware_Whitepaper-2.pdf",
          "https://www.zscaler.com/blogs/security-research/technical-analysis-crytox-ransomware",
          "https://research.checkpoint.com/2022/evilplayout-attack-against-irans-state-broadcaster/"
        ],
        "falsepositives": [
          "False postitve might occur with legitimate or uncommon extensions used internally. Initial baseline is required."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_diskshadow_script_mode_susp_ext.yml"
      }
    },
    {
      "id": "863218bd-c7d0-4c52-80cd-0a96c09f54af",
      "title": "Arbitrary File Download Via IMEWDBLD.EXE",
      "status": "test",
      "description": "Detects usage of \"IMEWDBLD.exe\" to download arbitrary files",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.execution",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\IMEWDBLD.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "imewdbld.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "http://",
                  "https://"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel",
        "date": "2023-11-09",
        "modified": "",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1105/T1105.md#atomic-test-10---windows---powershell-download",
          "https://lolbas-project.github.io/lolbas/Binaries/IMEWDBLD/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_imewbdld_download.yml"
      }
    },
    {
      "id": "b6e04788-29e1-4557-bb14-77f761848ab8",
      "title": "Potentially Suspicious File Download From File Sharing Domain Via PowerShell.EXE",
      "status": "test",
      "description": "Detects potentially suspicious file downloads from file sharing domains using PowerShell.exe",
      "level": "high",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_websites": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "anonfiles.com",
                  "cdn.discordapp.com",
                  "ddns.net",
                  "dl.dropboxusercontent.com",
                  "ghostbin.co",
                  "glitch.me",
                  "gofile.io",
                  "hastebin.com",
                  "mediafire.com",
                  "mega.nz",
                  "onrender.com",
                  "pages.dev",
                  "paste.ee",
                  "pastebin.com",
                  "pastebin.pl",
                  "pastetext.net",
                  "pixeldrain.com",
                  "privatlab.com",
                  "privatlab.net",
                  "send.exploit.in",
                  "sendspace.com",
                  "storage.googleapis.com",
                  "storjshare.io",
                  "supabase.co",
                  "temp.sh",
                  "transfer.sh",
                  "trycloudflare.com",
                  "ufile.io",
                  "w3spaces.com",
                  "workers.dev"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_download": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ".DownloadString(",
                  ".DownloadFile(",
                  "Invoke-WebRequest ",
                  "iwr ",
                  "wget "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2024-02-23",
        "modified": "2024-12-10",
        "references": [
          "https://labs.withsecure.com/publications/fin7-target-veeam-servers",
          "https://github.com/WithSecureLabs/iocs/blob/344203de742bb7e68bd56618f66d34be95a9f9fc/FIN7VEEAM/iocs.csv",
          "https://www.microsoft.com/en-us/security/blog/2024/01/17/new-ttps-observed-in-mint-sandstorm-campaign-targeting-high-profile-individuals-at-universities-and-research-orgs/",
          "https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_download_susp_file_sharing_domains.yml"
      }
    },
    {
      "id": "899133d5-4d7c-4a7f-94ee-27355c879d90",
      "title": "Python Inline Command Execution",
      "status": "test",
      "description": "Detects execution of python using the \"-c\" flag. This is could be used as a way to launch a reverse shell or execute live python code.",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "python.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "python.exe",
                      "python3.exe",
                      "python2.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -c",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_python_1": {
            "type": "field_match",
            "matchers": {
              "ParentImage__startswith": {
                "field": "ParentImage",
                "value": [
                  "C:\\Program Files\\Python",
                  "C:\\Program Files (x86)\\Python"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\python.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "ParentCommandLine__contains": {
                "field": "ParentCommandLine",
                "value": "-E -s -m ensurepip -U --default-pip",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_python_trace": {
            "type": "field_match",
            "matchers": {
              "ParentImage__startswith": {
                "field": "ParentImage",
                "value": [
                  "C:\\Program Files\\Python",
                  "C:\\Program Files (x86)\\Python"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "-W ignore::DeprecationWarning",
                  "['install', '--no-cache-dir', '--no-index', '--find-links',",
                  "'--upgrade', 'pip'"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_vscode": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "ParentImage__endswith": {
                    "field": "ParentImage",
                    "value": "\\AppData\\Local\\Programs\\Microsoft VS Code\\Code.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "ParentImage": {
                    "field": "ParentImage",
                    "value": [
                      "C:\\Program Files\\Microsoft VS Code\\Code.exe",
                      "C:\\Program Files (x86)\\Microsoft VS Code\\Code.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "filter_optional_pip": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "<pip-setuptools-caller>",
                  "exec(compile("
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "all of selection_*"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1059"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-01-02",
        "modified": "2025-10-07",
        "references": [
          "https://docs.python.org/3/using/cmdline.html#cmdoption-c",
          "https://www.revshells.com/",
          "https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet"
        ],
        "falsepositives": [
          "Python libraries that use a flag starting with \"-c\". Filter according to your environment"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_python_inline_command_execution.yml"
      }
    },
    {
      "id": "30e92f50-bb5a-4884-98b5-d20aa80f3d7a",
      "title": "Hidden Powershell in Link File Pattern",
      "status": "test",
      "description": "Detects events that appear when a user click on a link file with a powershell command in it",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": "C:\\Windows\\explorer.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\System32\\cmd.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "powershell",
                  ".lnk"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-02-06",
        "modified": "",
        "references": [
          "https://www.x86matthew.com/view_post?id=embed_exe_lnk"
        ],
        "falsepositives": [
          "Legitimate commands in .lnk files"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_embed_exe_lnk.yml"
      }
    },
    {
      "id": "fa1a7e52-3d02-435b-81b8-00da14dd66c1",
      "title": "Diskshadow Script Mode - Execution From Potential Suspicious Location",
      "status": "test",
      "description": "Detects execution of \"Diskshadow.exe\" in script mode using the \"/s\" flag where the script is located in a potentially suspicious location.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "diskshadow.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\diskshadow.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-s ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_paths": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ":\\Temp\\",
                  ":\\Windows\\Temp\\",
                  "\\AppData\\Local\\",
                  "\\AppData\\Roaming\\",
                  "\\ProgramData\\",
                  "\\Users\\Public\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-09-15",
        "modified": "2024-03-05",
        "references": [
          "https://bohops.com/2018/03/26/diskshadow-the-return-of-vss-evasion-persistence-and-active-directory-database-extraction/",
          "https://www.ired.team/offensive-security/credential-access-and-credential-dumping/ntds.dit-enumeration",
          "https://medium.com/@cyberjyot/lolbin-execution-via-diskshadow-f6ff681a27a4",
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/diskshadow",
          "https://www.lifars.com/wp-content/uploads/2022/01/GriefRansomware_Whitepaper-2.pdf",
          "https://www.zscaler.com/blogs/security-research/technical-analysis-crytox-ransomware",
          "https://research.checkpoint.com/2022/evilplayout-attack-against-irans-state-broadcaster/"
        ],
        "falsepositives": [
          "False positives may occur if you execute the script from one of the paths mentioned in the rule. Apply additional filters that fits your org needs."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_diskshadow_script_mode_susp_location.yml"
      }
    },
    {
      "id": "6c6d9280-e6d0-4b9d-80ac-254701b64916",
      "title": "Potential NTLM Coercion Via Certutil.EXE",
      "status": "test",
      "description": "Detects possible NTLM coercion via certutil using the 'syncwithWU' flag",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\certutil.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "CertUtil.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " -syncwithWU ",
                  " \\\\\\\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-09-01",
        "modified": "2023-02-14",
        "references": [
          "https://github.com/LOLBAS-Project/LOLBAS/issues/243"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_certutil_ntlm_coercion.yml"
      }
    },
    {
      "id": "5cc90652-4cbd-4241-aa3b-4b462fa5a248",
      "title": "Potential Recon Activity Via Nltest.EXE",
      "status": "test",
      "description": "Detects nltest commands that can be used for information discovery",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.t1016",
        "attack.t1482"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_nltest": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\nltest.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "nltestrk.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_recon": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "server",
                      "query"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      "/user",
                      "all_trusts",
                      "dclist:",
                      "dnsgetdc:",
                      "domain_trusts",
                      "dsgetdc:",
                      "parentdomain",
                      "trusted_domains"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1016",
          "T1482"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Craig Young, oscd.community, Georg Lauenstein",
        "date": "2021-07-24",
        "modified": "2023-12-15",
        "references": [
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc731935(v=ws.11)",
          "https://thedfirreport.com/2021/08/16/trickbot-leads-up-to-fake-1password-installation/",
          "https://thedfirreport.com/2020/10/18/ryuk-in-5-hours/",
          "https://book.hacktricks.xyz/windows/basic-cmd-for-pentesters",
          "https://research.nccgroup.com/2022/08/19/back-in-black-unlocking-a-lockbit-3-0-ransomware-attack/",
          "https://eqllib.readthedocs.io/en/latest/analytics/03e231a6-74bc-467a-acb1-e5676b0fb55e.html",
          "https://redcanary.com/blog/how-one-hospital-thwarted-a-ryuk-ransomware-outbreak/",
          "https://github.com/redcanaryco/atomic-red-team/blob/5360c9d9ffa3b25f6495f7a16e267b719eba2c37/atomics/T1482/T1482.md#atomic-test-2---windows---discover-domain-trusts-with-nltest"
        ],
        "falsepositives": [
          "Legitimate administration use but user and host must be investigated"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_nltest_recon.yml"
      }
    },
    {
      "id": "1eeed653-dbc8-4187-ad0c-eeebb20e6599",
      "title": "Potential SPN Enumeration Via Setspn.EXE",
      "status": "test",
      "description": "Detects service principal name (SPN) enumeration used for Kerberoasting",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.t1558.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_pe": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\setspn.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "setspn.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description__contains_all": {
                    "field": "Description",
                    "value": [
                      "Query or reset the computer",
                      "SPN attribute"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -q ",
                  " /q "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1558.003"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Markus Neis, keepwatch",
        "date": "2018-11-14",
        "modified": "2023-10-23",
        "references": [
          "https://web.archive.org/web/20200329173843/https://p16.praetorian.com/blog/how-to-use-kerberoasting-t1208-for-privilege-escalation",
          "https://www.praetorian.com/blog/how-to-use-kerberoasting-t1208-for-privilege-escalation/?edition=2019"
        ],
        "falsepositives": [
          "Administration activity"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_setspn_spn_enumeration.yml"
      }
    },
    {
      "id": "38a1ac5f-9c74-47d2-a345-dd6f5eb4e7c8",
      "title": "HKTL - SharpSuccessor Privilege Escalation Tool Execution",
      "status": "experimental",
      "description": "Detects the execution of SharpSuccessor, a tool used to exploit the BadSuccessor attack for privilege escalation in WinServer 2025 Active Directory environments.\nSuccessful usage of this tool can let the attackers gain the domain admin privileges by exploiting the BadSuccessor vulnerability.\n",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.t1068"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\SharpSuccessor.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "SharpSuccessor.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": "SharpSuccessor",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      " add ",
                      " /impersonate",
                      " /path",
                      " /account",
                      " /name"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1068"
        ],
        "tactics": [
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-06-06",
        "modified": "",
        "references": [
          "https://github.com/logangoins/SharpSuccessor"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_sharpsuccessor_execution.yml"
      }
    },
    {
      "id": "435e10e4-992a-4281-96f3-38b11106adde",
      "title": "Computer Discovery And Export Via Get-ADComputer Cmdlet",
      "status": "test",
      "description": "Detects usage of the Get-ADComputer cmdlet to collect computer information and output it to a file",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.t1033"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "Get-ADComputer ",
                  " -Filter \\*"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " > ",
                  " | Select ",
                  "Out-File",
                  "Set-Content",
                  "Add-Content"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1033"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-11-10",
        "modified": "2022-11-17",
        "references": [
          "http://blog.talosintelligence.com/2022/09/lazarus-three-rats.html",
          "https://www.microsoft.com/en-us/security/blog/2022/10/18/defenders-beware-a-case-for-post-ransomware-investigations/",
          "https://www.cisa.gov/uscert/sites/default/files/publications/aa22-320a_joint_csa_iranian_government-sponsored_apt_actors_compromise_federal%20network_deploy_crypto%20miner_credential_harvester.pdf"
        ],
        "falsepositives": [
          "Legitimate admin scripts may use the same technique, it's better to exclude specific computers or users who execute these commands or scripts often"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_computer_discovery_get_adcomputer.yml"
      }
    },
    {
      "id": "68c8acb4-1b60-4890-8e82-3ddf7a6dba84",
      "title": "HH.EXE Execution",
      "status": "test",
      "description": "Detects the execution of \"hh.exe\" to open \".chm\" files.",
      "level": "low",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "HH.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\hh.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": ".chm",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "E.M. Anhaus (originally from Atomic Blue Detections, Dan Beavin), oscd.community",
        "date": "2019-10-24",
        "modified": "2023-12-11",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1218.001/T1218.001.md",
          "https://eqllib.readthedocs.io/en/latest/analytics/b25aa548-7937-11e9-8f5c-d46d6d62a49e.html",
          "https://www.zscaler.com/blogs/security-research/unintentional-leak-glimpse-attack-vectors-apt37"
        ],
        "falsepositives": [
          "False positives are expected with legitimate \".CHM\""
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hh_chm_execution.yml"
      }
    },
    {
      "id": "4ae3e30b-b03f-43aa-87e3-b622f4048eed",
      "title": "Potential Arbitrary File Download Using Office Application",
      "status": "test",
      "description": "Detects potential arbitrary file download using a Microsoft Office application",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1202"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\EXCEL.EXE",
                      "\\POWERPNT.EXE",
                      "\\WINWORD.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "Excel.exe",
                      "POWERPNT.EXE",
                      "WinWord.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_http": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "http://",
                  "https://"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1202"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), Beyu Denis, oscd.community",
        "date": "2022-05-17",
        "modified": "2023-06-22",
        "references": [
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Winword/",
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Powerpnt/",
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Excel/",
          "https://medium.com/@reegun/unsanitized-file-validation-leads-to-malicious-payload-download-via-office-binaries-202d02db7191"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_office_arbitrary_cli_download.yml"
      }
    },
    {
      "id": "17a1be64-8d88-40bf-b5ff-a4f7a50ebcc8",
      "title": "Suspicious New Service Creation",
      "status": "test",
      "description": "Detects creation of a new service via \"sc\" command or the powershell \"new-service\" cmdlet with suspicious binary paths",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.privilege-escalation",
        "attack.t1543.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_sc": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\sc.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "create",
                  "binPath="
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_posh": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "New-Service",
                  "-BinaryPathName"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "susp_binpath": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "powershell",
                  "mshta",
                  "wscript",
                  "cscript",
                  "svchost",
                  "dllhost",
                  "cmd ",
                  "cmd.exe /c",
                  "cmd.exe /k",
                  "cmd.exe /r",
                  "rundll32",
                  "C:\\Users\\Public",
                  "\\Downloads\\",
                  "\\Desktop\\",
                  "\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\",
                  "C:\\Windows\\TEMP\\",
                  "\\AppData\\Local\\Temp"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection* and susp_binpath",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "1 of selection*"
            },
            {
              "type": "ref",
              "value": "susp_binpath"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1543.003"
        ],
        "tactics": [
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-07-14",
        "modified": "2022-11-18",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1543.003/T1543.003.md",
          "https://web.archive.org/web/20180331144337/https://www.fireeye.com/blog/threat-research/2018/03/sanny-malware-delivery-method-updated-in-recently-observed-attacks.html"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_service_creation.yml"
      }
    },
    {
      "id": "138d3531-8793-4f50-a2cd-f291b2863d78",
      "title": "Suspicious Service Path Modification",
      "status": "test",
      "description": "Detects service path modification via the \"sc\" binary to a suspicious command or path",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.privilege-escalation",
        "attack.t1543.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\sc.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "config",
                  "binPath"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "powershell",
                  "cmd ",
                  "mshta",
                  "wscript",
                  "cscript",
                  "rundll32",
                  "svchost",
                  "dllhost",
                  "cmd.exe /c",
                  "cmd.exe /k",
                  "cmd.exe /r",
                  "cmd /c",
                  "cmd /k",
                  "cmd /r",
                  "C:\\Users\\Public",
                  "\\Downloads\\",
                  "\\Desktop\\",
                  "\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\",
                  "C:\\Windows\\TEMP\\",
                  "\\AppData\\Local\\Temp"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1543.003"
        ],
        "tactics": [
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Victor Sergeev, oscd.community, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2019-10-21",
        "modified": "2022-11-18",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1543.003/T1543.003.md",
          "https://web.archive.org/web/20180331144337/https://www.fireeye.com/blog/threat-research/2018/03/sanny-malware-delivery-method-updated-in-recently-observed-attacks.html"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sc_service_path_modification.yml"
      }
    },
    {
      "id": "b96b2031-7c17-4473-afe7-a30ce714db29",
      "title": "Use of FSharp Interpreters",
      "status": "test",
      "description": "Detects the execution of FSharp Interpreters \"FsiAnyCpu.exe\" and \"FSi.exe\"\nBoth can be used for AWL bypass and to execute F# code via scripts or inline.\n",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\fsi.exe",
                      "\\fsianycpu.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "fsi.exe",
                      "fsianycpu.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Christopher Peacock @SecurePeacock, SCYTHE @scythe_io",
        "date": "2022-06-02",
        "modified": "2024-04-23",
        "references": [
          "https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/design/applications-that-can-bypass-wdac",
          "https://bohops.com/2020/11/02/exploring-the-wdac-microsoft-recommended-block-rules-part-ii-wfc-fsi/",
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/FsiAnyCpu/",
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Fsi/"
        ],
        "falsepositives": [
          "Legitimate use by a software developer."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_fsi_fsharp_code_execution.yml"
      }
    },
    {
      "id": "a70dcb37-3bee-453a-99df-d0c683151be6",
      "title": "Firewall Rule Update Via Netsh.EXE",
      "status": "test",
      "description": "Detects execution of netsh with the \"advfirewall\" and the \"set\" option in order to set new values for properties of a existing rule",
      "level": "medium",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\netsh.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "netsh.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " firewall ",
                  " set "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "X__Junior (Nextron Systems)",
        "date": "2023-07-18",
        "modified": "",
        "references": [
          "https://ss64.com/nt/netsh.html"
        ],
        "falsepositives": [
          "Legitimate administration activity",
          "Software installations and removal"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_netsh_fw_set_rule.yml"
      }
    },
    {
      "id": "f6d1dd2f-b8ce-40ca-bc23-062efb686b34",
      "title": "Script Event Consumer Spawning Process",
      "status": "test",
      "description": "Detects a suspicious child process of Script Event Consumer (scrcons.exe).",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1047"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\scrcons.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\svchost.exe",
                  "\\dllhost.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\wscript.exe",
                  "\\cscript.exe",
                  "\\schtasks.exe",
                  "\\regsvr32.exe",
                  "\\mshta.exe",
                  "\\rundll32.exe",
                  "\\msiexec.exe",
                  "\\msbuild.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1047"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Sittikorn S",
        "date": "2021-06-21",
        "modified": "2022-07-14",
        "references": [
          "https://redcanary.com/blog/child-processes/",
          "https://docs.paloaltonetworks.com/cortex/cortex-xdr/cortex-xdr-analytics-alert-reference/cortex-xdr-analytics-alert-reference/scrcons-exe-rare-child-process.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_scrcons_susp_child_process.yml"
      }
    },
    {
      "id": "52cad028-0ff0-4854-8f67-d25dfcbc78b4",
      "title": "HTML Help HH.EXE Suspicious Child Process",
      "status": "test",
      "description": "Detects a suspicious child process of a Microsoft HTML Help (HH.exe)",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.execution",
        "attack.initial-access",
        "attack.t1047",
        "attack.t1059.001",
        "attack.t1059.003",
        "attack.t1059.005",
        "attack.t1059.007",
        "attack.t1218",
        "attack.t1218.001",
        "attack.t1218.010",
        "attack.t1218.011",
        "attack.t1566",
        "attack.t1566.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\hh.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\CertReq.exe",
                  "\\CertUtil.exe",
                  "\\cmd.exe",
                  "\\cscript.exe",
                  "\\installutil.exe",
                  "\\MSbuild.exe",
                  "\\MSHTA.EXE",
                  "\\msiexec.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\regsvr32.exe",
                  "\\rundll32.exe",
                  "\\schtasks.exe",
                  "\\wmic.exe",
                  "\\wscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1047",
          "T1059.001",
          "T1059.003",
          "T1059.005",
          "T1059.007",
          "T1218",
          "T1218.001",
          "T1218.010",
          "T1218.011",
          "T1566",
          "T1566.001"
        ],
        "tactics": [
          "defense_evasion",
          "execution",
          "initial_access"
        ]
      },
      "meta": {
        "author": "Maxim Pavlunin, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2020-04-01",
        "modified": "2023-04-12",
        "references": [
          "https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/chm-badness-delivers-a-banking-trojan/",
          "https://github.com/elastic/protections-artifacts/commit/746086721fd385d9f5c6647cada1788db4aea95f#diff-27939090904026cc396b0b629c8e4314acd6f5dac40a676edbc87f4567b47eb7",
          "https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/higaisa-or-winnti-apt-41-backdoors-old-and-new/",
          "https://www.zscaler.com/blogs/security-research/unintentional-leak-glimpse-attack-vectors-apt37"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hh_html_help_susp_child_process.yml"
      }
    },
    {
      "id": "d08a2711-ee8b-4323-bdec-b7d85e892b31",
      "title": "PUA - CsExec Execution",
      "status": "test",
      "description": "Detects the use of the lesser known remote execution tool named CsExec a PsExec alternative",
      "level": "high",
      "tags": [
        "attack.resource-development",
        "attack.t1587.001",
        "attack.execution",
        "attack.t1569.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\csexec.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_pe": {
            "type": "field_match",
            "matchers": {
              "Description": {
                "field": "Description",
                "value": "csexec",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1587.001",
          "T1569.002"
        ],
        "tactics": [
          "resource_development",
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-08-22",
        "modified": "2023-02-21",
        "references": [
          "https://github.com/malcomvetter/CSExec",
          "https://www.microsoft.com/security/blog/2022/05/09/ransomware-as-a-service-understanding-the-cybercrime-gig-economy-and-how-to-protect-yourself/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_csexec.yml"
      }
    },
    {
      "id": "9637e8a5-7131-4f7f-bdc7-2b05d8670c43",
      "title": "Suspicious File Characteristics Due to Missing Fields",
      "status": "test",
      "description": "Detects Executables in the Downloads folder without FileVersion,Description,Product,Company likely created with py2exe",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059.006"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection1": {
            "type": "field_match",
            "matchers": {
              "Description": {
                "field": "Description",
                "value": "\\?",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "FileVersion": {
                "field": "FileVersion",
                "value": "\\?",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection2": {
            "type": "field_match",
            "matchers": {
              "Description": {
                "field": "Description",
                "value": "\\?",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Product": {
                "field": "Product",
                "value": "\\?",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection3": {
            "type": "field_match",
            "matchers": {
              "Description": {
                "field": "Description",
                "value": "\\?",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Company": {
                "field": "Company",
                "value": "\\?",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "folder": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": "\\Downloads\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "(selection1 or selection2 or selection3) and folder",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "(selection1",
            "selection2",
            "selection3) and folder"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1059.006"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Markus Neis, Sander Wiebing",
        "date": "2018-11-22",
        "modified": "2022-10-09",
        "references": [
          "https://securelist.com/muddywater/88059/",
          "https://www.virustotal.com/#/file/276a765a10f98cda1a38d3a31e7483585ca3722ecad19d784441293acf1b7beb/detection"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_file_characteristics.yml"
      }
    },
    {
      "id": "de16d92c-c446-4d53-8938-10aeef41c8b6",
      "title": "Computer Password Change Via Ksetup.EXE",
      "status": "test",
      "description": "Detects password change for the computer's domain account or host principal via \"ksetup.exe\"",
      "level": "medium",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\ksetup.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "ksetup.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " /setcomputerpassword ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-04-06",
        "modified": "",
        "references": [
          "https://twitter.com/Oddvarmoe/status/1641712700605513729",
          "https://learn.microsoft.com/en-gb/windows-server/administration/windows-commands/ksetup"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_ksetup_password_change_computer.yml"
      }
    },
    {
      "id": "9fb6b26e-7f9e-4517-a48b-8cac4a1b6c60",
      "title": "Uncommon FileSystem Load Attempt By Format.com",
      "status": "test",
      "description": "Detects the execution of format.com with an uncommon filesystem selection that could indicate a defense evasion activity in which \"format.com\" is used to load malicious DLL files or other programs.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\format.com",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "/fs:",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_known_fs": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "/fs:exFAT",
                  "/fs:FAT",
                  "/fs:NTFS",
                  "/fs:ReFS",
                  "/fs:UDF"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-01-04",
        "modified": "2024-05-13",
        "references": [
          "https://twitter.com/0gtweet/status/1477925112561209344",
          "https://twitter.com/wdormann/status/1478011052130459653?s=20"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_format_uncommon_filesystem_load.yml"
      }
    },
    {
      "id": "8e95e73e-ba02-4a87-b4d7-0929b8053038",
      "title": "Suspicious ArcSOC.exe Child Process",
      "status": "experimental",
      "description": "Detects script interpreters, command-line tools, and similar suspicious child processes of ArcSOC.exe.\nArcSOC.exe is the process name which hosts ArcGIS Server REST services. If an attacker compromises an ArcGIS\nServer system and uploads a malicious Server Object Extension (SOE), they can send crafted requests to the corresponding\nservice endpoint and remotely execute code from the ArcSOC.exe process.\n",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059",
        "attack.t1203"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\ArcSOC.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\cmd.exe",
                  "\\cscript.exe",
                  "\\mshta.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\regsvr32.exe",
                  "\\rundll32.exe",
                  "\\wmic.exe",
                  "\\wscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_cmd": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\cmd.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine": {
                "field": "CommandLine",
                "value": "cmd.exe /c \"ver\"",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1059",
          "T1203"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Micah Babinski",
        "date": "2025-11-25",
        "modified": "",
        "references": [
          "https://reliaquest.com/blog/threat-spotlight-inside-flax-typhoons-arcgis-compromise/",
          "https://enterprise.arcgis.com/en/server/12.0/administer/windows/inside-an-arcgis-server-site.htm"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_arcsoc_susp_child_process.yml"
      }
    },
    {
      "id": "00d49ed5-4491-4271-a8db-650a4ef6f8c1",
      "title": "Suspicious Download from Office Domain",
      "status": "test",
      "description": "Detects suspicious ways to download files from Microsoft domains that are used to store attachments in Emails or OneNote documents",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.resource-development",
        "attack.t1105",
        "attack.t1608"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_download": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\curl.exe",
                      "\\wget.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      "Invoke-WebRequest",
                      "iwr ",
                      "curl ",
                      "wget ",
                      "Start-BitsTransfer",
                      ".DownloadFile(",
                      ".DownloadString("
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_domains": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "https://attachment.outlook.live.net/owa/",
                  "https://onenoteonlinesync.onenote.com/onenoteonlinesync/"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1105",
          "T1608"
        ],
        "tactics": [
          "command_and_control",
          "resource_development"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2021-12-27",
        "modified": "2022-08-02",
        "references": [
          "https://twitter.com/an0n_r0/status/1474698356635193346?s=12",
          "https://twitter.com/mrd0x/status/1475085452784844803?s=12"
        ],
        "falsepositives": [
          "Scripts or tools that download attachments from these domains (OneNote, Outlook 365)"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_download_office_domain.yml"
      }
    },
    {
      "id": "7df1713a-1a5b-4a4b-a071-dc83b144a101",
      "title": "Esentutl Gather Credentials",
      "status": "test",
      "description": "Conti recommendation to its affiliates to use esentutl to access NTDS dumped file. Trickbot also uses this utilities to get MSEdge info via its module pwgrab.",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.t1003",
        "attack.t1003.003",
        "attack.s0404"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "esentutl",
                  " /p"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003",
          "T1003.003"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "sam0x90",
        "date": "2021-08-06",
        "modified": "2022-10-09",
        "references": [
          "https://twitter.com/vxunderground/status/1423336151860002816",
          "https://thedfirreport.com/2021/08/01/bazarcall-to-conti-ransomware-via-trickbot-and-cobalt-strike/"
        ],
        "falsepositives": [
          "To be determined"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_esentutl_params.yml"
      }
    },
    {
      "id": "b9d9cc83-380b-4ba3-8d8f-60c0e7e2930c",
      "title": "Suspicious PowerShell Encoded Command Patterns",
      "status": "test",
      "description": "Detects PowerShell command line patterns in combincation with encoded commands that often appear in malware infection chains",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell.Exe",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_flags": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -e ",
                  " -en ",
                  " -enc ",
                  " -enco"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_encoded": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " JAB",
                  " SUVYI",
                  " SQBFAFgA",
                  " aWV4I",
                  " IAB",
                  " PAA",
                  " aQBlAHgA"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_gcworker": {
            "type": "field_match",
            "matchers": {
              "ParentImage__contains": {
                "field": "ParentImage",
                "value": [
                  "C:\\Packages\\Plugins\\Microsoft.GuestConfiguration.ConfigurationforWindows\\",
                  "\\gc_worker.exe"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-05-24",
        "modified": "2023-01-05",
        "references": [
          "https://app.any.run/tasks/b9040c63-c140-479b-ad59-f1bb56ce7a97/"
        ],
        "falsepositives": [
          "Other tools that work with encoded scripts in the command line instead of script files"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_base64_encoded_cmd_patterns.yml"
      }
    },
    {
      "id": "83865853-59aa-449e-9600-74b9d89a6d6e",
      "title": "Audio Capture via SoundRecorder",
      "status": "test",
      "description": "Detect attacker collecting audio via SoundRecorder application.",
      "level": "medium",
      "tags": [
        "attack.collection",
        "attack.t1123"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\SoundRecorder.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "/FILE",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1123"
        ],
        "tactics": [
          "collection"
        ]
      },
      "meta": {
        "author": "E.M. Anhaus (originally from Atomic Blue Detections, Endgame), oscd.community",
        "date": "2019-10-24",
        "modified": "2021-11-27",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1123/T1123.md",
          "https://eqllib.readthedocs.io/en/latest/analytics/f72a98cb-7b3d-4100-99c3-a138b6e9ff6e.html"
        ],
        "falsepositives": [
          "Legitimate audio capture by legitimate user."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_soundrecorder_audio_capture.yml"
      }
    },
    {
      "id": "56d19cb4-6414-4769-9644-1ed35ffbb148",
      "title": "Obfuscated IP Via CLI",
      "status": "test",
      "description": "Detects usage of an encoded/obfuscated version of an IP address (hex, octal, etc.) via command line",
      "level": "medium",
      "tags": [
        "attack.discovery"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\ping.exe",
                  "\\arp.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_ip_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " 0x",
                  "//0x",
                  ".0x",
                  ".00x"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_ip_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "http://%",
                  "%2e"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_ip_3": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__re": {
                    "field": "CommandLine",
                    "value": "https?://[0-9]{1,3}\\.[0-9]{1,3}\\.0[0-9]{3,4}",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__re": {
                    "field": "CommandLine",
                    "value": "https?://[0-9]{1,3}\\.0[0-9]{3,7}",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__re": {
                    "field": "CommandLine",
                    "value": "https?://0[0-9]{3,11}",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__re": {
                    "field": "CommandLine",
                    "value": "https?://(0[0-9]{1,11}\\.){3}0[0-9]{1,11}",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__re": {
                    "field": "CommandLine",
                    "value": "https?://0[0-9]{1,11}",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__re": {
                    "field": "CommandLine",
                    "value": " [0-7]{7,13}",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_main_valid_ip": {
            "type": "field_match",
            "matchers": {
              "CommandLine__re": {
                "field": "CommandLine",
                "value": "https?://((25[0-5]|(2[0-4]|1\\d|[1-9])?\\d)(\\.|\\b)){4}",
                "modifiers": [
                  "re"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection_img and 1 of selection_ip_* and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_img"
            },
            {
              "type": "ref",
              "value": "1 of selection_ip_*"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), X__Junior (Nextron Systems)",
        "date": "2022-08-03",
        "modified": "2023-11-06",
        "references": [
          "https://h.43z.one/ipconverter/",
          "https://twitter.com/Yasser_Elsnbary/status/1553804135354564608"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_obfuscated_ip_via_cli.yml"
      }
    },
    {
      "id": "99c8be4f-3087-4f9f-9c24-8c7e257b442e",
      "title": "Setup16.EXE Execution With Custom .Lst File",
      "status": "test",
      "description": "Detects the execution of \"Setup16.EXE\" and old installation utility with a custom \".lst\" file.\nThese \".lst\" file can contain references to external program that \"Setup16.EXE\" will execute.\nAttackers and adversaries might leverage this as a living of the land utility.\n",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1574.005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": "C:\\Windows\\SysWOW64\\setup16.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ParentCommandLine__contains": {
                "field": "ParentCommandLine",
                "value": " -m ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_valid_path": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\~MSSETUP.T\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1574.005"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2024-12-01",
        "modified": "",
        "references": [
          "https://www.hexacorn.com/blog/2024/10/12/the-sweet16-the-oldbin-lolbin-called-setup16-exe/"
        ],
        "falsepositives": [
          "On modern Windows system, the \"Setup16\" utility is practically never used, hence false positive should be very rare."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_setup16_custom_lst_execution.yml"
      }
    },
    {
      "id": "883835a7-df45-43e4-bf1d-4268768afda4",
      "title": "Regedit as Trusted Installer",
      "status": "test",
      "description": "Detects a regedit started with TrustedInstaller privileges or by ProcessHacker.exe",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\regedit.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\TrustedInstaller.exe",
                  "\\ProcessHacker.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1548"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-05-27",
        "modified": "2022-10-09",
        "references": [
          "https://twitter.com/1kwpeter/status/1397816101455765504"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_regedit_trustedinstaller.yml"
      }
    },
    {
      "id": "cea2b7ea-792b-405f-95a1-b903ea06458f",
      "title": "Suspicious Child Process Of Manage Engine ServiceDesk",
      "status": "test",
      "description": "Detects suspicious child processes of the \"Manage Engine ServiceDesk Plus\" Java web service",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1102"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__contains_all": {
                "field": "ParentImage",
                "value": [
                  "\\ManageEngine\\ServiceDesk\\",
                  "\\java.exe"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\AppVLP.exe",
                  "\\bash.exe",
                  "\\bitsadmin.exe",
                  "\\calc.exe",
                  "\\certutil.exe",
                  "\\cscript.exe",
                  "\\curl.exe",
                  "\\forfiles.exe",
                  "\\mftrace.exe",
                  "\\mshta.exe",
                  "\\net.exe",
                  "\\net1.exe",
                  "\\notepad.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\query.exe",
                  "\\reg.exe",
                  "\\schtasks.exe",
                  "\\scrcons.exe",
                  "\\sh.exe",
                  "\\systeminfo.exe",
                  "\\whoami.exe",
                  "\\wmic.exe",
                  "\\wscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_net": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\net.exe",
                  "\\net1.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " stop",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1102"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2023-01-18",
        "modified": "2023-08-29",
        "references": [
          "https://www.horizon3.ai/manageengine-cve-2022-47966-technical-deep-dive/",
          "https://github.com/horizon3ai/CVE-2022-47966/blob/3a51c6b72ebbd87392babd955a8fbeaee2090b35/CVE-2022-47966.py",
          "https://blog.viettelcybersecurity.com/saml-show-stopper/"
        ],
        "falsepositives": [
          "Legitimate sub processes started by Manage Engine ServiceDesk Pro"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_java_manageengine_susp_child_process.yml"
      }
    },
    {
      "id": "455b9d50-15a1-4b99-853f-8d37655a4c1b",
      "title": "PUA - Suspicious ActiveDirectory Enumeration Via AdFind.EXE",
      "status": "test",
      "description": "Detects active directory enumeration activity using known AdFind CLI flags",
      "level": "high",
      "tags": [
        "attack.discovery",
        "attack.t1087.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_password": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "lockoutduration",
                  "lockoutthreshold",
                  "lockoutobservationwindow",
                  "maxpwdage",
                  "minpwdage",
                  "minpwdlength",
                  "pwdhistorylength",
                  "pwdproperties"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_enum_ad": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-sc admincountdmp",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_enum_exchange": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-sc exchaddresses",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1087.002"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-12-13",
        "modified": "2023-03-05",
        "references": [
          "https://www.joeware.net/freetools/tools/adfind/",
          "https://social.technet.microsoft.com/wiki/contents/articles/7535.adfind-command-examples.aspx",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1087.002/T1087.002.md"
        ],
        "falsepositives": [
          "Authorized administrative activity"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_adfind_enumeration.yml"
      }
    },
    {
      "id": "3d7679bd-0c00-440c-97b0-3f204273e6c7",
      "title": "New Process Created Via Taskmgr.EXE",
      "status": "test",
      "description": "Detects the creation of a process via the Windows task manager. This might be an attempt to bypass UAC",
      "level": "low",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\taskmgr.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_generic": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  ":\\Windows\\System32\\mmc.exe",
                  ":\\Windows\\System32\\resmon.exe",
                  ":\\Windows\\System32\\Taskmgr.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1036"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2018-03-13",
        "modified": "2024-01-18",
        "references": [
          "https://twitter.com/ReneFreingruber/status/1172244989335810049"
        ],
        "falsepositives": [
          "Administrative activity"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_taskmgr_susp_child_process.yml"
      }
    },
    {
      "id": "1e59c230-6670-45bf-83b0-98903780607e",
      "title": "Gpscript Execution",
      "status": "test",
      "description": "Detects the execution of the LOLBIN gpscript, which executes logon or startup scripts configured in Group Policy",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\gpscript.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "GPSCRIPT.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " /logon",
                  " /startup"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_svchost": {
            "type": "field_match",
            "matchers": {
              "ParentCommandLine": {
                "field": "ParentCommandLine",
                "value": "C:\\windows\\system32\\svchost.exe -k netsvcs -p -s gpsvc",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_main_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-05-16",
        "modified": "2023-06-14",
        "references": [
          "https://oddvar.moe/2018/04/27/gpscript-exe-another-lolbin-to-the-list/",
          "https://lolbas-project.github.io/lolbas/Binaries/Gpscript/"
        ],
        "falsepositives": [
          "Legitimate uses of logon scripts distributed via group policy"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_gpscript.yml"
      }
    },
    {
      "id": "9292293b-8496-4715-9db6-37028dcda4b3",
      "title": "Replace.exe Usage",
      "status": "test",
      "description": "Detects the use of Replace.exe which can be used to replace file with another file",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1105"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\replace.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "argument": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-a",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection and argument",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "ref",
              "value": "argument"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1105"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-03-06",
        "modified": "2024-03-13",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Replace/",
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/replace"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_replace.yml"
      }
    },
    {
      "id": "da2738f2-fadb-4394-afa7-0a0674885afa",
      "title": "Sdclt Child Processes",
      "status": "test",
      "description": "A General detection for sdclt spawning new processes. This could be an indicator of sdclt being used for bypass UAC techniques.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\sdclt.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
        "date": "2020-05-02",
        "modified": "2021-11-27",
        "references": [
          "https://github.com/OTRF/detection-hackathon-apt29/issues/6",
          "https://github.com/OTRF/ThreatHunter-Playbook/blob/2d4257f630f4c9770f78d0c1df059f891ffc3fec/docs/evals/apt29/detections/3.B.2_C36B49B5-DF58-4A34-9FE9-56189B9DEFEA.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sdclt_child_process.yml"
      }
    },
    {
      "id": "7ec2c172-dceb-4c10-92c9-87c1881b7e18",
      "title": "HackTool - Rubeus Execution",
      "status": "stable",
      "description": "Detects the execution of the hacktool Rubeus via PE information of command line parameters",
      "level": "critical",
      "tags": [
        "attack.defense-evasion",
        "attack.credential-access",
        "attack.t1003",
        "attack.t1558.003",
        "attack.lateral-movement",
        "attack.t1550.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\Rubeus.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "Rubeus.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "Rubeus",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      "asreproast ",
                      "dump /service:krbtgt ",
                      "dump /luid:0x",
                      "kerberoast ",
                      "createnetonly /program:",
                      "ptt /ticket:",
                      "/impersonateuser:",
                      "renew /ticket:",
                      "asktgt /user:",
                      "harvest /interval:",
                      "s4u /user:",
                      "s4u /ticket:",
                      "hash /password:",
                      "golden /aes256:",
                      "silver /user:"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003",
          "T1558.003",
          "T1550.003"
        ],
        "tactics": [
          "defense_evasion",
          "credential_access",
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2018-12-19",
        "modified": "2023-04-20",
        "references": [
          "https://blog.harmj0y.net/redteaming/from-kekeo-to-rubeus",
          "https://m0chan.github.io/2019/07/31/How-To-Attack-Kerberos-101.html",
          "https://github.com/GhostPack/Rubeus"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_rubeus.yml"
      }
    },
    {
      "id": "49f2f17b-b4c8-4172-a68b-d5bf95d05130",
      "title": "UAC Bypass via ICMLuaUtil",
      "status": "test",
      "description": "Detects the pattern of UAC Bypass using ICMLuaUtil Elevated COM interface",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\dllhost.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "ParentCommandLine__contains": {
                "field": "ParentCommandLine",
                "value": [
                  "/Processid:{3E5FC7F9-9A51-4367-9063-A120244FBEC7}",
                  "/Processid:{D2E7041B-2927-42FB-8E9F-7CE93B6DC937}"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\WerFault.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "WerFault.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Elastic (idea)",
        "date": "2022-09-13",
        "modified": "2022-09-27",
        "references": [
          "https://www.elastic.co/guide/en/security/current/uac-bypass-via-icmluautil-elevated-com-interface.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_uac_bypass_icmluautil.yml"
      }
    },
    {
      "id": "074e0ded-6ced-4ebd-8b4d-53f55908119d",
      "title": "AWL Bypass with Winrm.vbs and Malicious WsmPty.xsl/WsmTxt.xsl",
      "status": "test",
      "description": "Detects execution of attacker-controlled WsmPty.xsl or WsmTxt.xsl via winrm.vbs and copied cscript.exe (can be renamed)",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1216"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "contains_format_pretty_arg": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "format:pretty",
                  "format:\"pretty\"",
                  "format:\"text\"",
                  "format:text"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "image_from_system_folder": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Windows\\System32\\",
                  "C:\\Windows\\SysWOW64\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "contains_winrm": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "winrm",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "contains_winrm and (contains_format_pretty_arg and not image_from_system_folder)",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "contains_winrm"
            },
            {
              "type": "ref",
              "value": "(contains_format_pretty_arg"
            },
            {
              "type": "not",
              "value": "image_from_system_folder)"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1216"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Julia Fomina, oscd.community",
        "date": "2020-10-06",
        "modified": "2022-10-09",
        "references": [
          "https://posts.specterops.io/application-whitelisting-bypass-and-arbitrary-unsigned-code-execution-technique-in-winrm-vbs-c8c24fb40404"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_winrm_awl_bypass.yml"
      }
    },
    {
      "id": "ef9dcfed-690c-4c5d-a9d1-482cd422225c",
      "title": "Browser Execution In Headless Mode",
      "status": "test",
      "description": "Detects execution of Chromium based browser in headless mode",
      "level": "low",
      "tags": [
        "attack.defense-evasion",
        "attack.command-and-control",
        "attack.t1105",
        "attack.t1564.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\brave.exe",
                  "\\chrome.exe",
                  "\\msedge.exe",
                  "\\opera.exe",
                  "\\vivaldi.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "--headless",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1105",
          "T1564.003"
        ],
        "tactics": [
          "defense_evasion",
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-09-12",
        "modified": "",
        "references": [
          "https://twitter.com/mrd0x/status/1478234484881436672?s=12",
          "https://www.trendmicro.com/en_us/research/23/e/managed-xdr-investigation-of-ducktail-in-trend-micro-vision-one.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_browsers_chromium_headless_exec.yml"
      }
    },
    {
      "id": "27ba3207-dd30-4812-abbf-5d20c57d474e",
      "title": "Suspicious Chromium Browser Instance Executed With Custom Extension",
      "status": "test",
      "description": "Detects a suspicious process spawning a Chromium based browser process with the 'load-extension' flag to start an instance with a custom extension",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.t1176.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\cmd.exe",
                  "\\cscript.exe",
                  "\\mshta.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\regsvr32.exe",
                  "\\rundll32.exe",
                  "\\wscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\brave.exe",
                  "\\chrome.exe",
                  "\\msedge.exe",
                  "\\opera.exe",
                  "\\vivaldi.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "--load-extension=",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1176.001"
        ],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "Aedan Russell, frack113, X__Junior (Nextron Systems)",
        "date": "2022-06-19",
        "modified": "2023-11-28",
        "references": [
          "https://redcanary.com/blog/chromeloader/",
          "https://emkc.org/s/RJjuLa",
          "https://www.mandiant.com/resources/blog/lnk-between-browsers"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_browsers_chromium_susp_load_extension.yml"
      }
    },
    {
      "id": "ae215552-081e-44c7-805f-be16f975c8a2",
      "title": "Suspicious Debugger Registration Cmdline",
      "status": "test",
      "description": "Detects the registration of a debugger for a program that is available in the logon screen (sticky key backdoor).",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.privilege-escalation",
        "attack.t1546.008"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "\\CurrentVersion\\Image File Execution Options\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "sethc.exe",
                  "utilman.exe",
                  "osk.exe",
                  "magnify.exe",
                  "narrator.exe",
                  "displayswitch.exe",
                  "atbroker.exe",
                  "HelpPane.exe"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1546.008"
        ],
        "tactics": [
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), oscd.community, Jonhnathan Ribeiro",
        "date": "2019-09-06",
        "modified": "2022-08-06",
        "references": [
          "https://blogs.technet.microsoft.com/jonathantrull/2016/10/03/detecting-sticky-key-backdoors/",
          "https://bazaar.abuse.ch/sample/6f3aa9362d72e806490a8abce245331030d1ab5ac77e400dd475748236a6cc81/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_registry_install_reg_debugger_backdoor.yml"
      }
    },
    {
      "id": "ab9e3b40-0c85-4ba1-aede-455d226fd124",
      "title": "Suspicious Redirection to Local Admin Share",
      "status": "test",
      "description": "Detects a suspicious output redirection to the local admins share, this technique is often found in malicious scripts or hacktool stagers",
      "level": "high",
      "tags": [
        "attack.exfiltration",
        "attack.t1048"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_redirect": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": ">",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_share": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\\\\\\\127.0.0.1\\\\admin$\\\\",
                  "\\\\\\\\localhost\\\\admin$\\\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1048"
        ],
        "tactics": [
          "exfiltration"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-01-16",
        "modified": "2023-12-28",
        "references": [
          "https://www.microsoft.com/security/blog/2022/01/15/destructive-malware-targeting-ukrainian-organizations/",
          "http://blog.talosintelligence.com/2022/09/lazarus-three-rats.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_redirect_local_admin_share.yml"
      }
    },
    {
      "id": "cd5cfd80-aa5f-44c0-9c20-108c4ae12e3c",
      "title": "New Firewall Rule Added Via Netsh.EXE",
      "status": "test",
      "description": "Detects the addition of a new rule to the Windows firewall via netsh",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.004",
        "attack.s0246"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\netsh.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "netsh.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " firewall ",
                  " add "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_dropbox": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "advfirewall firewall add rule name=Dropbox dir=in action=allow \"program=?:\\Program Files (x86)\\Dropbox\\Client\\Dropbox.exe\" enable=yes profile=Any",
                  "advfirewall firewall add rule name=Dropbox dir=in action=allow \"program=?:\\Program Files\\Dropbox\\Client\\Dropbox.exe\" enable=yes profile=Any"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_optional_"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Markus Neis, Sander Wiebing",
        "date": "2019-01-29",
        "modified": "2023-02-10",
        "references": [
          "https://web.archive.org/web/20190508165435/https://www.operationblockbuster.com/wp-content/uploads/2016/02/Operation-Blockbuster-RAT-and-Staging-Report.pdf"
        ],
        "falsepositives": [
          "Legitimate administration activity",
          "Software installations"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_netsh_fw_add_rule.yml"
      }
    },
    {
      "id": "7d1aaf3d-4304-425c-b7c3-162055e0b3ab",
      "title": "Potential Data Exfiltration Activity Via CommandLine Tools",
      "status": "test",
      "description": "Detects the use of various CLI utilities exfiltrating data via web requests",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_iwr": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\powershell_ise.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\cmd.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "curl ",
                  "Invoke-RestMethod",
                  "Invoke-WebRequest",
                  "irm ",
                  "iwr ",
                  "wget "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " -ur",
                  " -me",
                  " -b",
                  " POST "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_curl": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\curl.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "--ur",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_curl_data": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -d ",
                  " --data "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_wget": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\wget.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "--post-data",
                  "--post-file"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "payloads": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__re": {
                    "field": "CommandLine",
                    "value": [
                      "net\\s+view",
                      "sc\\s+query"
                    ],
                    "modifiers": [
                      "re"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      "Get-Content",
                      "GetBytes",
                      "hostname",
                      "ifconfig",
                      "ipconfig",
                      "netstat",
                      "nltest",
                      "qprocess",
                      "systeminfo",
                      "tasklist",
                      "ToBase64String",
                      "whoami"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "type ",
                      " > ",
                      " C:\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "(selection_iwr or all of selection_curl* or selection_wget) and payloads",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "(selection_iwr",
            "all of selection_curl*",
            "selection_wget) and payloads"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-02",
        "modified": "2025-10-19",
        "references": [
          "https://www.sentinelone.com/blog/living-off-windows-defender-lockbit-ransomware-sideloads-cobalt-strike-through-microsoft-security-tool/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_data_exfiltration_via_cli.yml"
      }
    },
    {
      "id": "d042284c-a296-4988-9be5-f424fadcc28c",
      "title": "Suspicious Execution of InstallUtil Without Log",
      "status": "test",
      "description": "Uses the .NET InstallUtil.exe application in order to execute image without log",
      "level": "medium",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\InstallUtil.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__contains": {
                "field": "Image",
                "value": "Microsoft.NET\\Framework",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/logfile= ",
                  "/LogToConsole=false"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-23",
        "modified": "2022-02-04",
        "references": [
          "https://securelist.com/moonbounce-the-dark-side-of-uefi-firmware/105468/",
          "https://learn.microsoft.com/en-us/dotnet/framework/tools/installutil-exe-installer-tool"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_instalutil_no_log_execution.yml"
      }
    },
    {
      "id": "b3d34dc5-2efd-4ae3-845f-8ec14921f449",
      "title": "Browser Started with Remote Debugging",
      "status": "test",
      "description": "Detects browsers starting with the remote debugging flags. Which is a technique often used to perform browser injection attacks",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.collection",
        "attack.t1185"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_chromium_based": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " --remote-debugging-",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_firefox": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\firefox.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -start-debugger-server",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1185"
        ],
        "tactics": [
          "credential_access",
          "collection"
        ]
      },
      "meta": {
        "author": "pH-T (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-07-27",
        "modified": "2022-12-23",
        "references": [
          "https://yoroi.company/wp-content/uploads/2022/05/EternityGroup_report_compressed.pdf",
          "https://www.mdsec.co.uk/2022/10/analysing-lastpass-part-1/",
          "https://github.com/defaultnamehere/cookie_crimes/",
          "https://github.com/wunderwuzzi23/firefox-cookiemonster"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_browsers_remote_debugging.yml"
      }
    },
    {
      "id": "91edcfb1-2529-4ac2-9ecc-7617f895c7e4",
      "title": "Weak or Abused Passwords In CLI",
      "status": "test",
      "description": "Detects weak passwords or often abused passwords (seen used by threat actors) via the CLI.\nAn example would be a threat actor creating a new user via the net command and providing the password inline\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "123456789",
                  "123123qwE",
                  "Asd123.aaaa",
                  "Decryptme",
                  "P@ssw0rd!",
                  "Pass8080",
                  "password123",
                  "test@202"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-09-14",
        "modified": "2024-02-23",
        "references": [
          "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/espionage-asia-governments",
          "https://thedfirreport.com/2022/09/26/bumblebee-round-two/",
          "https://www.microsoft.com/en-us/security/blog/2022/10/25/dev-0832-vice-society-opportunistic-ransomware-campaigns-impacting-us-education-sector/",
          "https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708"
        ],
        "falsepositives": [
          "Legitimate usage of the passwords by users via commandline (should be discouraged)",
          "Other currently unknown false positives"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_weak_or_abused_passwords.yml"
      }
    },
    {
      "id": "de587dce-915e-4218-aac4-835ca6af6f70",
      "title": "Potential Persistence Attempt Via Run Keys Using Reg.EXE",
      "status": "test",
      "description": "Detects suspicious command line reg.exe tool adding key to RUN key in Registry",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\reg.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "reg",
                  " add "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Software\\Microsoft\\Windows\\CurrentVersion\\Run",
                  "\\Software\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Run",
                  "\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1547.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2021-06-28",
        "modified": "2025-02-17",
        "references": [
          "https://app.any.run/tasks/9c0f37bc-867a-4314-b685-e101566766d7/",
          "https://learn.microsoft.com/en-us/windows/win32/setupapi/run-and-runonce-registry-keys",
          "https://github.com/HackTricks-wiki/hacktricks/blob/e4c7b21b8f36c97c35b7c622732b38a189ce18f7/src/windows-hardening/windows-local-privilege-escalation/privilege-escalation-with-autorun-binaries.md"
        ],
        "falsepositives": [
          "Legitimate software automatically (mostly, during installation) sets up autorun keys for legitimate reasons.",
          "Legitimate administrator sets up autorun keys for legitimate reasons.",
          "Discord"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_reg_add_run_key.yml"
      }
    },
    {
      "id": "0152550d-3a26-4efd-9f0e-54a0b28ae2f3",
      "title": "Detection of PowerShell Execution via Sqlps.exe",
      "status": "test",
      "description": "This rule detects execution of a PowerShell code through the sqlps.exe utility, which is included in the standard set of utilities supplied with the MSSQL Server.\nScript blocks are not logged in this case, so this utility helps to bypass protection mechanisms based on the analysis of these logs.\n",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059.001",
        "attack.defense-evasion",
        "attack.t1127"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\sqlps.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_image": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\sqlps.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "sqlps.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_image": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\sqlagent.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection_parent or (selection_image and not filter_image)",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection_parent",
            "(selection_image and not filter_image)"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001",
          "T1127"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Agro (@agro_sev) oscd.community",
        "date": "2020-10-10",
        "modified": "2022-12-09",
        "references": [
          "https://learn.microsoft.com/en-us/sql/tools/sqlps-utility?view=sql-server-ver15",
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Sqlps/",
          "https://twitter.com/bryon_/status/975835709587075072"
        ],
        "falsepositives": [
          "Direct PS command execution through SQLPS.exe is uncommon, childprocess sqlps.exe spawned by sqlagent.exe is a legitimate action."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_mssql_sqlps_susp_execution.yml"
      }
    },
    {
      "id": "a4824fca-976f-4964-b334-0621379e84c4",
      "title": "Potential File Overwrite Via Sysinternals SDelete",
      "status": "test",
      "description": "Detects the use of SDelete to erase a file not the free space",
      "level": "high",
      "tags": [
        "attack.impact",
        "attack.t1485"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "OriginalFileName": {
                "field": "OriginalFileName",
                "value": "sdelete.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -h",
                  " -c",
                  " -z",
                  " /\\?"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1485"
        ],
        "tactics": [
          "impact"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-06-03",
        "modified": "2023-02-28",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1485/T1485.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sysinternals_sdelete.yml"
      }
    },
    {
      "id": "8a4519e8-e64a-40b6-ae85-ba8ad2177559",
      "title": "Renamed BrowserCore.EXE Execution",
      "status": "test",
      "description": "Detects process creation with a renamed BrowserCore.exe (used to extract Azure tokens)",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.defense-evasion",
        "attack.t1528",
        "attack.t1036.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "OriginalFileName": {
                "field": "OriginalFileName",
                "value": "BrowserCore.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_realbrowsercore": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\BrowserCore.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1528",
          "T1036.003"
        ],
        "tactics": [
          "credential_access",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Max Altgelt (Nextron Systems)",
        "date": "2022-06-02",
        "modified": "2023-02-03",
        "references": [
          "https://twitter.com/mariuszbit/status/1531631015139102720"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_renamed_browsercore.yml"
      }
    },
    {
      "id": "c79da740-5030-45ec-a2e0-479e824a562c",
      "title": "System Disk And Volume Reconnaissance Via Wmic.EXE",
      "status": "test",
      "description": "An adversary might use WMI to discover information about the system, such as the volume name, size,\nfree space, and other disk information. This can be done using the 'wmic' command-line utility and has been\nobserved being used by threat actors such as Volt Typhoon.\n",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.discovery",
        "attack.t1047",
        "attack.t1082"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\WMIC.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "wmic.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      " volumename",
                      " logicaldisk"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "path",
                      "win32_logicaldisk"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      " volume",
                      " list "
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1047",
          "T1082"
        ],
        "tactics": [
          "execution",
          "discovery"
        ]
      },
      "meta": {
        "author": "Stephen Lincoln '@slincoln-aiq' (AttackIQ)",
        "date": "2024-02-02",
        "modified": "2025-10-20",
        "references": [
          "https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-144a",
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wmic"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wmic_recon_volume.yml"
      }
    },
    {
      "id": "9bd04a79-dabe-4f1f-a5ff-92430265c96b",
      "title": "Privilege Escalation via Named Pipe Impersonation",
      "status": "test",
      "description": "Detects a remote file copy attempt to a hidden network share. This may indicate lateral movement or data staging activity.",
      "level": "high",
      "tags": [
        "attack.lateral-movement",
        "attack.t1021"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_name": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\cmd.exe",
                      "\\powershell.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "Cmd.Exe",
                      "PowerShell.EXE"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_args": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "echo",
                  ">",
                  "\\\\\\\\.\\\\pipe\\\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1021"
        ],
        "tactics": [
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Tim Rauch, Elastic (idea)",
        "date": "2022-09-27",
        "modified": "2022-12-30",
        "references": [
          "https://www.elastic.co/guide/en/security/current/privilege-escalation-via-named-pipe-impersonation.html"
        ],
        "falsepositives": [
          "Other programs that cause these patterns (please report)"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_priv_escalation_via_named_pipe.yml"
      }
    },
    {
      "id": "65c3ca2c-525f-4ced-968e-246a713d164f",
      "title": "Visual Studio NodejsTools PressAnyKey Renamed Execution",
      "status": "test",
      "description": "Detects renamed execution of \"Microsoft.NodejsTools.PressAnyKey.exe\", which can be abused as a LOLBIN to execute arbitrary binaries",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "OriginalFileName": {
                "field": "OriginalFileName",
                "value": "Microsoft.NodejsTools.PressAnyKey.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_legit_name": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\Microsoft.NodejsTools.PressAnyKey.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), Florian Roth (Nextron Systems)",
        "date": "2023-04-11",
        "modified": "",
        "references": [
          "https://twitter.com/mrd0x/status/1463526834918854661",
          "https://gist.github.com/nasbench/a989ce64cefa8081bd50cf6ad8c491b5"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_renamed_pressanykey.yml"
      }
    },
    {
      "id": "242301bc-f92f-4476-8718-78004a6efd9f",
      "title": "DLL Loaded via CertOC.EXE",
      "status": "test",
      "description": "Detects when a user installs certificates by using CertOC.exe to loads the target DLL file.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\certoc.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "CertOC.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -LoadDLL ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Austin Songer @austinsonger",
        "date": "2021-10-23",
        "modified": "2024-03-05",
        "references": [
          "https://twitter.com/sblmsrsn/status/1445758411803480072?s=20",
          "https://github.com/elastic/protections-artifacts/commit/746086721fd385d9f5c6647cada1788db4aea95f#diff-fe98e74189873d6df72a15df2eaa0315c59ba9cdaca93ecd68afc4ea09194ef2",
          "https://lolbas-project.github.io/lolbas/Binaries/Certoc/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_certoc_load_dll.yml"
      }
    },
    {
      "id": "d5b9ae7a-e6fc-405e-80ff-2ff9dcc64e7e",
      "title": "Sysprep on AppData Folder",
      "status": "test",
      "description": "Detects suspicious sysprep process start with AppData folder as target (as used by Trojan Syndicasec in Thrip report by Symantec)",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\sysprep.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "\\AppData\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2018-06-22",
        "modified": "2021-11-27",
        "references": [
          "https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets",
          "https://app.any.run/tasks/61a296bb-81ad-4fee-955f-3b399f4aaf4b"
        ],
        "falsepositives": [
          "False positives depend on scripts and administrative tools used in the monitored environment"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sysprep_appdata.yml"
      }
    },
    {
      "id": "0685b176-c816-4837-8e7b-1216f346636b",
      "title": "HackTool - Quarks PwDump Execution",
      "status": "test",
      "description": "Detects usage of the Quarks PwDump tool via commandline arguments",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\QuarksPwDump.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine": {
                "field": "CommandLine",
                "value": [
                  " -dhl",
                  " --dump-hash-local",
                  " -dhdc",
                  " --dump-hash-domain-cached",
                  " --dump-bitlocker",
                  " -dhd ",
                  " --dump-hash-domain ",
                  "--ntds-file"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.002"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-09-05",
        "modified": "2023-02-05",
        "references": [
          "https://github.com/quarkslab/quarkspwdump",
          "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/seedworm-apt-iran-middle-east"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_quarks_pwdump.yml"
      }
    },
    {
      "id": "24357373-078f-44ed-9ac4-6d334a668a11",
      "title": "Direct Autorun Keys Modification",
      "status": "test",
      "description": "Detects direct modification of autostart extensibility point (ASEP) in registry using reg.exe.",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\reg.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "reg.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_add": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "add",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli_keys": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\software\\Microsoft\\Windows\\CurrentVersion\\Run",
                  "\\software\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Run",
                  "\\software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run",
                  "\\software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Userinit",
                  "\\software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Shell",
                  "\\software\\Microsoft\\Windows NT\\CurrentVersion\\Windows",
                  "\\software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders",
                  "\\system\\CurrentControlSet\\Control\\SafeBoot\\AlternateShell"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1547.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Victor Sergeev, Daniil Yugoslavskiy, oscd.community, Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2019-10-25",
        "modified": "2025-02-17",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md",
          "https://github.com/HackTricks-wiki/hacktricks/blob/e4c7b21b8f36c97c35b7c622732b38a189ce18f7/src/windows-hardening/windows-local-privilege-escalation/privilege-escalation-with-autorun-binaries.md"
        ],
        "falsepositives": [
          "Legitimate software automatically (mostly, during installation) sets up autorun keys for legitimate reasons.",
          "Legitimate administrator sets up autorun keys for legitimate reasons.",
          "Discord"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_reg_direct_asep_registry_keys_modification.yml"
      }
    },
    {
      "id": "02b64f1b-3f33-4e67-aede-ef3b0a5a8fcf",
      "title": "Potential COM Objects Download Cradles Usage - Process Creation",
      "status": "test",
      "description": "Detects usage of COM objects that can be abused to download files in PowerShell by CLSID",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1105"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "[Type]::GetTypeFromCLSID(",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "0002DF01-0000-0000-C000-000000000046",
                  "F6D90F16-9C73-11D3-B32E-00C04F990BB4",
                  "F5078F35-C551-11D3-89B9-0000F81FE221",
                  "88d96a0a-f192-11d4-a65f-0040963251e5",
                  "AFBA6B42-5692-48EA-8141-DC517DCF0EF1",
                  "AFB40FFD-B609-40A3-9828-F88BBE11E4E3",
                  "88d96a0b-f192-11d4-a65f-0040963251e5",
                  "2087c2f4-2cef-4953-a8ab-66779b670495",
                  "000209FF-0000-0000-C000-000000000046",
                  "00024500-0000-0000-C000-000000000046"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1105"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-12-25",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/dotnet/api/system.type.gettypefromclsid?view=net-7.0",
          "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse?slide=57"
        ],
        "falsepositives": [
          "Legitimate use of the library"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_download_com_cradles.yml"
      }
    },
    {
      "id": "e312efd0-35a1-407f-8439-b8d434b438a6",
      "title": "Potential PowerShell Obfuscation Via WCHAR/CHAR",
      "status": "test",
      "description": "Detects suspicious encoded character syntax often used for defense evasion",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059.001",
        "attack.defense-evasion",
        "attack.t1027"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "[char]0x",
                  "(WCHAR)0x"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001",
          "T1027"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2020-07-09",
        "modified": "2025-03-03",
        "references": [
          "https://twitter.com/0gtweet/status/1281103918693482496"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_obfuscation_via_utf8.yml"
      }
    },
    {
      "id": "aa8e035d-7be4-48d3-a944-102aec04400d",
      "title": "Suspicious Extrac32 Execution",
      "status": "test",
      "description": "Download or Copy file with Extrac32",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1105"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_lolbas": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": "extrac32.exe",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\extrac32.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "extrac32.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_archive": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": ".cab",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_options": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "/C",
                  "/Y",
                  " \\\\\\\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1105"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-11-26",
        "modified": "2022-08-13",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Extrac32/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_extrac32.yml"
      }
    },
    {
      "id": "f0507c0f-a3a2-40f5-acc6-7f543c334993",
      "title": "Suspicious File Execution From Internet Hosted WebDav Share",
      "status": "test",
      "description": "Detects the execution of the \"net use\" command to mount a WebDAV server and then immediately execute some content in it. As seen being used in malicious LNK files",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__contains": {
                    "field": "Image",
                    "value": "\\cmd.exe",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "Cmd.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_base": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " net use http",
                  "& start /b ",
                  "\\DavWWWRoot\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_ext": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ".exe ",
                  ".dll ",
                  ".bat ",
                  ".vbs ",
                  ".ps1 "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "pH-T (Nextron Systems)",
        "date": "2022-09-01",
        "modified": "2023-02-21",
        "references": [
          "https://twitter.com/ShadowChasing1/status/1552595370961944576",
          "https://www.virustotal.com/gui/file/a63376ee1dba76361df73338928e528ca5b20171ea74c24581605366dcaa0104/behavior"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_cmd_net_use_and_exec_combo.yml"
      }
    },
    {
      "id": "fd877b94-9bb5-4191-bb25-d79cbd93c167",
      "title": "Dumping of Sensitive Hives Via Reg.EXE",
      "status": "test",
      "description": "Detects the usage of \"reg.exe\" in order to dump sensitive registry hives. This includes SAM, SYSTEM and SECURITY hives.",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003.002",
        "attack.t1003.004",
        "attack.t1003.005",
        "car.2013-07-001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\reg.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "reg.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_flag": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " save ",
                  " export ",
                  " ˢave ",
                  " eˣport "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_hklm": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "hklm",
                  "hk˪m",
                  "hkey_local_machine",
                  "hkey_˪ocal_machine",
                  "hkey_loca˪_machine",
                  "hkey_˪oca˪_machine"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_hive": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\system",
                  "\\sam",
                  "\\security",
                  "\\ˢystem",
                  "\\syˢtem",
                  "\\ˢyˢtem",
                  "\\ˢam",
                  "\\ˢecurity"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.002",
          "T1003.004",
          "T1003.005"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Teymur Kheirkhabarov, Endgame, JHasenbusch, Daniil Yugoslavskiy, oscd.community, frack113",
        "date": "2019-10-22",
        "modified": "2023-12-13",
        "references": [
          "https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment",
          "https://eqllib.readthedocs.io/en/latest/analytics/aed95fc6-5e3f-49dc-8b35-06508613f979.html",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1003/T1003.md",
          "https://www.wietzebeukema.nl/blog/windows-command-line-obfuscation",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1003.002/T1003.002.md#atomic-test-1---registry-dump-of-sam-creds-and-secrets"
        ],
        "falsepositives": [
          "Dumping hives for legitimate purpouse i.e. backup or forensic investigation"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_reg_dumping_sensitive_hives.yml"
      }
    },
    {
      "id": "ba3874b9-0fae-465f-836c-eb5d071a1789",
      "title": "NodeJS Execution of JavaScript File",
      "status": "experimental",
      "description": "Detects execution of JavaScript or JSC files using NodeJs binary node.exe, that could be potentially suspicious.\nNode.js is a popular open-source JavaScript runtime that runs code outside browsers and is widely used for both frontend and backend development.\nAdversaries have been observed abusing Node.js to disguise malware as legitimate processes, evade security defenses, and maintain persistence within target systems.\nBecause Node.js is commonly used, this rule may generate false positives in some environments. However, if such activity is unusual in your environment, it is highly suspicious and warrants immediate investigation.\n",
      "level": "low",
      "tags": [
        "attack.execution",
        "attack.t1059.007"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\node.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "node.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Product": {
                    "field": "Product",
                    "value": "Node.js",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cmd": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": ".js",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.007"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-04-21",
        "modified": "",
        "references": [
          "https://www.microsoft.com/en-us/security/blog/2025/04/15/threat-actors-misuse-node-js-to-deliver-malware-and-other-malicious-payloads/"
        ],
        "falsepositives": [
          "Legitimate use of node.exe to execute JavaScript or JSC files on your environment"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_security_susp_node_js_execution.yml"
      }
    },
    {
      "id": "584bca0f-3608-4402-80fd-4075ff6072e3",
      "title": "Potential CommandLine Obfuscation Using Unicode Characters From Suspicious Image",
      "status": "test",
      "description": "Detects potential commandline obfuscation using unicode characters.\nAdversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\cmd.exe",
                  "\\cscript.exe",
                  "\\powershell.exe",
                  "\\powershell_ise.exe",
                  "\\pwsh.exe",
                  "\\wscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "OriginalFileName": {
                "field": "OriginalFileName",
                "value": [
                  "Cmd.EXE",
                  "cscript.exe",
                  "PowerShell.EXE",
                  "PowerShell_ISE.EXE",
                  "pwsh.dll",
                  "wscript.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_special_chars": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "ˣ",
                  "˪",
                  "ˢ",
                  "∕",
                  "⁄",
                  "―",
                  "—",
                  " ",
                  "¯",
                  "®",
                  "¶",
                  "⠀"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1027"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113, Florian Roth (Nextron Systems), Josh Nickels",
        "date": "2024-09-02",
        "modified": "2025-05-30",
        "references": [
          "https://www.wietzebeukema.nl/blog/windows-command-line-obfuscation",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1027/T1027.md#atomic-test-6---dlp-evasion-via-sensitive-data-in-vba-macro-over-http"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_cli_obfuscation_unicode_img.yml"
      }
    },
    {
      "id": "e0c69ebd-b54f-4aed-8ae3-e3467843f3f0",
      "title": "Renamed Cloudflared.EXE Execution",
      "status": "test",
      "description": "Detects the execution of a renamed \"cloudflared\" binary.",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1090.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_cleanup": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " tunnel ",
                  "cleanup "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "-config ",
                  "-connector-id "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_tunnel": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " tunnel ",
                  " run "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "-config ",
                  "-credentials-contents ",
                  "-credentials-file ",
                  "-token "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_accountless": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "-url",
                  "tunnel"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_hashes": {
            "type": "field_match",
            "matchers": {
              "Hashes__contains": {
                "field": "Hashes",
                "value": [
                  "SHA256=2fb6c04c4f95fb8d158af94c137f90ac820716deaf88d8ebec956254e046cb29",
                  "SHA256=b3d21940a10fdef5e415ad70331ce257c24fe3bcf7722262302e0421791f87e8",
                  "SHA256=1fbd8362b2d2d2e6a5750ae3db69cd1815e6c1d31da48a98b796450971a8e039",
                  "SHA256=0409c9b12f9d0eda86e461ed9bdabeefb00172b26322079681a0bdf48e68dc28",
                  "SHA256=7cfb411d04bac42ef93d1f0c93c0a481e38c6f4612b97ae89d4702595988edc7",
                  "SHA256=5b3c2d846ab162dc6bc595cce3a49de5731afde5d6060be7066d21b013a28373",
                  "SHA256=ce95df7f69664c3df19b76028e115931919a71517b776da7b42d353e2ff4a670",
                  "SHA256=1293525a19cfe3bc8296b62fbfe19f083632ed644a1c18c10b045a1d3030d81a",
                  "SHA256=af2b9161cfcb654b16408cd6b098afe9d1fb61a037d18d7090a119d4c0c8e0f0",
                  "SHA256=39ddceb56a15798826a5fc4892fa2b474c444bb4d7a8bf2fa95e41cab10fa7a1",
                  "SHA256=ccd11f2328023a0e7929e845d5b6e7bc783fb4650d65faef3ae090239d4bbce2",
                  "SHA256=b6e5c5d2567ae8c69cc012ebcae30e6c9b5359d64a58d17ba75ec89f8bce71ac",
                  "SHA256=f813484ea441404f18caad96f28138e8aaf0cb256163c09c2ab8a3acab87f69f",
                  "SHA256=fc4a0802ab9c7409b892ca00636bec61e2acfc911bccfdeb9978b8ab5a2f828d",
                  "SHA256=083150724b49604c8765c1ba19541fa260b133be0acb0647fcd936d81f054499",
                  "SHA256=44303d6572956f28a0f2e4b188934fb9874f2584f5c81fa431a463cfbf28083b",
                  "SHA256=5d38c46032a58e28ae5f7d174d8761ec3d64d186677f3ec53af5f51afb9bfd2f",
                  "SHA256=e1e70fa42059911bc6685fafef957f9a73fc66f214d0704a9b932683a5204032",
                  "SHA256=c01356092a365b84f84f0e66870bd1a05ba3feb53cafd973fa5fea2534bee234",
                  "SHA256=b3f9c06151e30ee43d39e788a79cd918a314f24e04fe87f3de8272a2057b624f",
                  "SHA256=cd81b2792f0739f473c31c9cb7cf2313154bfa28b839975802b90e8790bb5058",
                  "SHA256=9ec7e6c8e1bfd883663d8d9d62c9e4f9ae373b731407181e32491b27a7218a2c",
                  "SHA256=c2cfd23fdc6c0e1b1ffa0e545cbe556f18d11b362b4a89ba0713f6ab01c4827f",
                  "SHA256=53f8adbd76c0eb16f5e43cadde422474d8a06f9c8f959389c1930042ad8beaa5",
                  "SHA256=648c8d2f8001c113d2986dd00b7bbd181593d462bef73522cee212c4f71f95b3",
                  "SHA256=ae047e2095e46c3f9c518b2be67ec753f4f0aad23b261a361fcb6144dcdb63b4",
                  "SHA256=3153d2baa462978dd22ab33d1c2274ecc88c200225d6a3327f98d5b752d08f5c",
                  "SHA256=f49cde976e628012c9db73e1c8d76081944ecf2297cdafeb78bb13290da274c4",
                  "SHA256=d2513e58bb03ccc83affde685c6ef987924c37ce6707d8e9857e2524b0d7e90f",
                  "SHA256=bb67c7623ba92fe64ffd9816b8d5b3b1ea3013960a30bd4cf6e295b3eb5b1bad",
                  "SHA256=b34b3c3a91e3165d1481f0b3ec23eab93a1cfba94345a6cbfe5b18ddbd48eac7",
                  "SHA256=f7848034e010d55f15e474ca998f96391e320ff29b00cfcc4c5e536529703e75",
                  "SHA256=b6fc9493778cbe3bfc062d73f5cc604bc0ff058bc5e5dc6aac87f3a4008b54b6",
                  "SHA256=f5c5e962577e2293c4ad10603816dce7cc273585969615fbf4e4bfa9eaff1688",
                  "SHA256=d14c52d9220b606f428a8fe9f7c108b0d6f14cf71e7384749e98e6a95962e68f",
                  "SHA256=d3a0e1a79158f3985cd49607ebe0cdfcc49cb9af96b8f43aefd0cdfe2f22e663",
                  "SHA256=2fbbfc8299537ff80cadf9d0e27c223fe0ccb9052bf9d8763ad717bbfa521c77",
                  "SHA256=19074674c6fbdaa573b3081745e5e26144fdf7a086d14e0e220d1814f1f13078"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_known_names": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\cloudflared.exe",
                  "\\cloudflared-windows-386.exe",
                  "\\cloudflared-windows-amd64.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "1 of selection_* and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "1 of selection_*"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1090.001"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-12-20",
        "modified": "",
        "references": [
          "https://github.com/cloudflare/cloudflared/releases",
          "https://developers.cloudflare.com/cloudflare-one/connections/connect-networks/do-more-with-tunnels/trycloudflare/",
          "https://github.com/cloudflare/cloudflared",
          "https://www.intrinsec.com/akira_ransomware/",
          "https://www.guidepointsecurity.com/blog/tunnel-vision-cloudflared-abused-in-the-wild/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_renamed_cloudflared.yml"
      }
    },
    {
      "id": "1012f107-b8f1-4271-af30-5aed2de89b39",
      "title": "Terminal Service Process Spawn",
      "status": "test",
      "description": "Detects a process spawned by the terminal service server process (this could be an indicator for an exploitation of CVE-2019-0708)",
      "level": "high",
      "tags": [
        "attack.initial-access",
        "attack.t1190",
        "attack.lateral-movement",
        "attack.t1210",
        "car.2013-07-002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentCommandLine__contains_all": {
                "field": "ParentCommandLine",
                "value": [
                  "\\svchost.exe",
                  "termsvcs"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\rdpclip.exe",
                  ":\\Windows\\System32\\csrss.exe",
                  ":\\Windows\\System32\\wininit.exe",
                  ":\\Windows\\System32\\winlogon.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_null": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1190",
          "T1210"
        ],
        "tactics": [
          "initial_access",
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2019-05-22",
        "modified": "2023-01-25",
        "references": [
          "https://securingtomorrow.mcafee.com/other-blogs/mcafee-labs/rdp-stands-for-really-do-patch-understanding-the-wormable-rdp-vulnerability-cve-2019-0708/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_svchost_termserv_proc_spawn.yml"
      }
    },
    {
      "id": "c598cc0c-9e70-4852-b9eb-8921af79f598",
      "title": "Hacktool - EDR-Freeze Execution",
      "status": "experimental",
      "description": "Detects execution of EDR-Freeze, a tool that exploits the MiniDumpWriteDump function and WerFaultSecure.exe to suspend EDR and Antivirus processes on Windows.\nEDR-Freeze leverages a race-condition attack to put security processes into a dormant state by suspending WerFaultSecure at the moment it freezes the target process.\nThis technique does not require kernel-level exploits or BYOVD, but instead abuses user-mode functionality to temporarily disable monitoring by EDR or Antimalware solutions.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  "\\EDR-Freeze",
                  "\\EDRFreeze"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": ".exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_imphash": {
            "type": "field_match",
            "matchers": {
              "Hashes__contains": {
                "field": "Hashes",
                "value": [
                  "IMPHASH=1195F7935954A2CD09157390C33F8E8C",
                  "IMPHASH=129F58DE3D687FB7F012BF6C3D679997",
                  "IMPHASH=2C617A175D0086251642C6619F7CC8BA",
                  "IMPHASH=8828F0B906F7844358FB92A899E9520F",
                  "IMPHASH=AF76D95157EC554DC1EF178E4E66D447",
                  "IMPHASH=E1B04316B61ACA31DD52ABBEC0A37FD5",
                  "IMPHASH=8B2D5B54AFCFEC60D54F6B31D80ED4A0",
                  "IMPHASH=AB8BB31EDD91D2A05FE7B62A535E9EB7"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-09-24",
        "modified": "2025-11-27",
        "references": [
          "https://www.zerosalarium.com/2025/09/EDR-Freeze-Puts-EDRs-Antivirus-Into-Coma.html",
          "https://github.com/TwoSevenOneT/EDR-Freeze"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_edr_freeze.yml"
      }
    },
    {
      "id": "c15a46a0-07d4-4c87-b4b6-89207835a83b",
      "title": "Add Potential Suspicious New Download Source To Winget",
      "status": "test",
      "description": "Detects usage of winget to add new potentially suspicious download sources",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.execution",
        "attack.t1059"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\winget.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "winget.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "source ",
                  "add "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_source_direct_ip": {
            "type": "field_match",
            "matchers": {
              "CommandLine__re": {
                "field": "CommandLine",
                "value": "://\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}",
                "modifiers": [
                  "re"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-04-17",
        "modified": "2023-12-04",
        "references": [
          "https://learn.microsoft.com/en-us/windows/package-manager/winget/source",
          "https://github.com/nasbench/Misc-Research/tree/b9596e8109dcdb16ec353f316678927e507a5b8d/LOLBINs/Winget"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_winget_add_susp_custom_source.yml"
      }
    },
    {
      "id": "90d6bd71-dffb-4989-8d86-a827fedd6624",
      "title": "Visual Studio Code Tunnel Execution",
      "status": "test",
      "description": "Detects Visual Studio Code tunnel execution. Attackers can abuse this functionality to establish a C2 channel",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1071.001",
        "attack.t1219"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_only_tunnel": {
            "type": "field_match",
            "matchers": {
              "OriginalFileName": {
                "field": "OriginalFileName",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": ".exe tunnel",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_tunnel_args": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  ".exe tunnel",
                  "--accept-server-license-terms"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_parent_tunnel": {
            "type": "field_match",
            "matchers": {
              "ParentCommandLine__endswith": {
                "field": "ParentCommandLine",
                "value": " tunnel",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\cmd.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/d /c ",
                  "\\servers\\Stable-",
                  "code-server.cmd"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1071.001",
          "T1219"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), citron_ninja",
        "date": "2023-10-25",
        "modified": "2025-10-29",
        "references": [
          "https://ipfyx.fr/post/visual-studio-code-tunnel/",
          "https://badoption.eu/blog/2023/01/31/code_c2.html",
          "https://code.visualstudio.com/docs/remote/tunnels"
        ],
        "falsepositives": [
          "Legitimate use of Visual Studio Code tunnel"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_vscode_tunnel_execution.yml"
      }
    },
    {
      "id": "c248c896-e412-4279-8c15-1c558067b6fa",
      "title": "Enumerate All Information With Whoami.EXE",
      "status": "test",
      "description": "Detects the execution of \"whoami.exe\" with the \"/all\" flag",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.t1033",
        "car.2016-03-001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_main_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\whoami.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "whoami.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_main_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -all",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_main_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_main_"
        }
      },
      "mitre": {
        "techniques": [
          "T1033"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-12-04",
        "modified": "2024-03-05",
        "references": [
          "https://brica.de/alerts/alert/public/1247926/agent-tesla-keylogger-delivered-inside-a-power-iso-daa-archive/",
          "https://app.any.run/tasks/7eaba74e-c1ea-400f-9c17-5e30eee89906/",
          "https://www.youtube.com/watch?v=DsJ9ByX84o4&t=6s"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_whoami_all_execution.yml"
      }
    },
    {
      "id": "4ac47ed3-44c2-4b1f-9d51-bf46e8914126",
      "title": "TrustedPath UAC Bypass Pattern",
      "status": "test",
      "description": "Detects indicators of a UAC bypass method by mocking directories",
      "level": "critical",
      "tags": [
        "attack.privilege-escalation",
        "attack.defense-evasion",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  "C:\\Windows \\System32\\",
                  "C:\\Windows \\SysWOW64\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "privilege_escalation",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-08-27",
        "modified": "2025-06-17",
        "references": [
          "https://medium.com/tenable-techblog/uac-bypass-by-mocking-trusted-directories-24a96675f6e",
          "https://www.wietzebeukema.nl/blog/hijacking-dlls-in-windows",
          "https://github.com/netero1010/TrustedPath-UACBypass-BOF",
          "https://x.com/Wietze/status/1933495426952421843"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_uac_bypass_trustedpath.yml"
      }
    },
    {
      "id": "76f55eaa-d27f-4213-9d45-7b0e4b60bbae",
      "title": "Service Reconnaissance Via Wmic.EXE",
      "status": "test",
      "description": "An adversary might use WMI to check if a certain remote service is running on a remote device.\nWhen the test completes, a service information will be displayed on the screen if it exists.\nA common feedback message is that \"No instance(s) Available\" if the service queried is not running.\nA common error message is \"Node - (provided IP or default) ERROR Description =The RPC server is unavailable\" if the provided remote host is unreachable\n",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1047"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\WMIC.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "wmic.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "service",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1047"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-02-14",
        "modified": "",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1047/T1047.md",
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wmic"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wmic_recon_service.yml"
      }
    },
    {
      "id": "f0f7be61-9cf5-43be-9836-99d6ef448a18",
      "title": "Uninstall Crowdstrike Falcon Sensor",
      "status": "test",
      "description": "Adversaries may disable security tools to avoid possible detection of their tools and activities by uninstalling Crowdstrike Falcon",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "\\WindowsSensor.exe",
                  " /uninstall",
                  " /quiet"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-07-12",
        "modified": "2023-03-09",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md"
        ],
        "falsepositives": [
          "Administrator might leverage the same command line for debugging or other purposes. However this action must be always investigated"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_uninstall_crowdstrike_falcon.yml"
      }
    },
    {
      "id": "222129f7-f4dc-4568-b0d2-22440a9639ba",
      "title": "Cloudflared Quick Tunnel Execution",
      "status": "test",
      "description": "Detects creation of an ad-hoc Cloudflare Quick Tunnel, which can be used to tunnel local services such as HTTP, RDP, SSH and SMB.\nThe free TryCloudflare Quick Tunnel will generate a random subdomain on trycloudflare[.]com, following a call to api[.]trycloudflare[.]com.\nThe tool has been observed in use by threat groups including Akira ransomware.\n",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1090.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\cloudflared.exe",
                      "\\cloudflared-windows-386.exe",
                      "\\cloudflared-windows-amd64.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Hashes__contains": {
                    "field": "Hashes",
                    "value": [
                      "SHA256=2fb6c04c4f95fb8d158af94c137f90ac820716deaf88d8ebec956254e046cb29",
                      "SHA256=b3d21940a10fdef5e415ad70331ce257c24fe3bcf7722262302e0421791f87e8",
                      "SHA256=1fbd8362b2d2d2e6a5750ae3db69cd1815e6c1d31da48a98b796450971a8e039",
                      "SHA256=0409c9b12f9d0eda86e461ed9bdabeefb00172b26322079681a0bdf48e68dc28",
                      "SHA256=7cfb411d04bac42ef93d1f0c93c0a481e38c6f4612b97ae89d4702595988edc7",
                      "SHA256=5b3c2d846ab162dc6bc595cce3a49de5731afde5d6060be7066d21b013a28373",
                      "SHA256=ce95df7f69664c3df19b76028e115931919a71517b776da7b42d353e2ff4a670",
                      "SHA256=1293525a19cfe3bc8296b62fbfe19f083632ed644a1c18c10b045a1d3030d81a",
                      "SHA256=af2b9161cfcb654b16408cd6b098afe9d1fb61a037d18d7090a119d4c0c8e0f0",
                      "SHA256=39ddceb56a15798826a5fc4892fa2b474c444bb4d7a8bf2fa95e41cab10fa7a1",
                      "SHA256=ccd11f2328023a0e7929e845d5b6e7bc783fb4650d65faef3ae090239d4bbce2",
                      "SHA256=b6e5c5d2567ae8c69cc012ebcae30e6c9b5359d64a58d17ba75ec89f8bce71ac",
                      "SHA256=f813484ea441404f18caad96f28138e8aaf0cb256163c09c2ab8a3acab87f69f",
                      "SHA256=fc4a0802ab9c7409b892ca00636bec61e2acfc911bccfdeb9978b8ab5a2f828d",
                      "SHA256=083150724b49604c8765c1ba19541fa260b133be0acb0647fcd936d81f054499",
                      "SHA256=44303d6572956f28a0f2e4b188934fb9874f2584f5c81fa431a463cfbf28083b",
                      "SHA256=5d38c46032a58e28ae5f7d174d8761ec3d64d186677f3ec53af5f51afb9bfd2f",
                      "SHA256=e1e70fa42059911bc6685fafef957f9a73fc66f214d0704a9b932683a5204032",
                      "SHA256=c01356092a365b84f84f0e66870bd1a05ba3feb53cafd973fa5fea2534bee234",
                      "SHA256=b3f9c06151e30ee43d39e788a79cd918a314f24e04fe87f3de8272a2057b624f",
                      "SHA256=cd81b2792f0739f473c31c9cb7cf2313154bfa28b839975802b90e8790bb5058",
                      "SHA256=9ec7e6c8e1bfd883663d8d9d62c9e4f9ae373b731407181e32491b27a7218a2c",
                      "SHA256=c2cfd23fdc6c0e1b1ffa0e545cbe556f18d11b362b4a89ba0713f6ab01c4827f",
                      "SHA256=53f8adbd76c0eb16f5e43cadde422474d8a06f9c8f959389c1930042ad8beaa5",
                      "SHA256=648c8d2f8001c113d2986dd00b7bbd181593d462bef73522cee212c4f71f95b3",
                      "SHA256=ae047e2095e46c3f9c518b2be67ec753f4f0aad23b261a361fcb6144dcdb63b4",
                      "SHA256=3153d2baa462978dd22ab33d1c2274ecc88c200225d6a3327f98d5b752d08f5c",
                      "SHA256=f49cde976e628012c9db73e1c8d76081944ecf2297cdafeb78bb13290da274c4",
                      "SHA256=d2513e58bb03ccc83affde685c6ef987924c37ce6707d8e9857e2524b0d7e90f",
                      "SHA256=bb67c7623ba92fe64ffd9816b8d5b3b1ea3013960a30bd4cf6e295b3eb5b1bad",
                      "SHA256=b34b3c3a91e3165d1481f0b3ec23eab93a1cfba94345a6cbfe5b18ddbd48eac7",
                      "SHA256=f7848034e010d55f15e474ca998f96391e320ff29b00cfcc4c5e536529703e75",
                      "SHA256=b6fc9493778cbe3bfc062d73f5cc604bc0ff058bc5e5dc6aac87f3a4008b54b6",
                      "SHA256=f5c5e962577e2293c4ad10603816dce7cc273585969615fbf4e4bfa9eaff1688",
                      "SHA256=d14c52d9220b606f428a8fe9f7c108b0d6f14cf71e7384749e98e6a95962e68f",
                      "SHA256=d3a0e1a79158f3985cd49607ebe0cdfcc49cb9af96b8f43aefd0cdfe2f22e663",
                      "SHA256=2fbbfc8299537ff80cadf9d0e27c223fe0ccb9052bf9d8763ad717bbfa521c77",
                      "SHA256=19074674c6fbdaa573b3081745e5e26144fdf7a086d14e0e220d1814f1f13078"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_param": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "-url",
                      "tunnel"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      ".exe -url",
                      ".exe --url"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_other": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "-url",
                  "-no-autoupdate"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "(selection_img and selection_param) or selection_other",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "(selection_img and selection_param)",
            "selection_other"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1090.001"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Sajid Nawaz Khan",
        "date": "2023-12-20",
        "modified": "",
        "references": [
          "https://developers.cloudflare.com/cloudflare-one/connections/connect-networks/do-more-with-tunnels/trycloudflare/",
          "https://github.com/cloudflare/cloudflared",
          "https://www.intrinsec.com/akira_ransomware/",
          "https://www.guidepointsecurity.com/blog/tunnel-vision-cloudflared-abused-in-the-wild/"
        ],
        "falsepositives": [
          "Legitimate usage of Cloudflare Quick Tunnel"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_cloudflared_quicktunnel_execution.yml"
      }
    },
    {
      "id": "0b0cd537-fc77-4e6e-a973-e53495c1083d",
      "title": "Renamed Office Binary Execution",
      "status": "test",
      "description": "Detects the execution of a renamed office binary",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "Excel.exe",
                      "MSACCESS.EXE",
                      "MSPUB.EXE",
                      "OneNote.exe",
                      "OneNoteM.exe",
                      "OUTLOOK.EXE",
                      "POWERPNT.EXE",
                      "WinWord.exe",
                      "Olk.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": [
                      "Microsoft Access",
                      "Microsoft Excel",
                      "Microsoft OneNote",
                      "Microsoft Outlook",
                      "Microsoft PowerPoint",
                      "Microsoft Publisher",
                      "Microsoft Word",
                      "Sent to OneNote Tool"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_main_legit_names": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\EXCEL.exe",
                  "\\excelcnv.exe",
                  "\\MSACCESS.exe",
                  "\\MSPUB.EXE",
                  "\\ONENOTE.EXE",
                  "\\ONENOTEM.EXE",
                  "\\OUTLOOK.EXE",
                  "\\POWERPNT.EXE",
                  "\\WINWORD.exe",
                  "\\OLK.EXE"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1036.003"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-12-20",
        "modified": "2025-12-09",
        "references": [
          "https://infosec.exchange/@sbousseaden/109542254124022664"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_renamed_office_processes.yml"
      }
    },
    {
      "id": "89f75308-5b1b-4390-b2d8-d6b2340efaf8",
      "title": "Windows Backup Deleted Via Wbadmin.EXE",
      "status": "test",
      "description": "Detects the deletion of backups or system state backups via \"wbadmin.exe\".\nThis technique is used by numerous ransomware families and actors.\nThis may only be successful on server platforms that have Windows Backup enabled.\n",
      "level": "medium",
      "tags": [
        "attack.impact",
        "attack.t1490"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\wbadmin.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "WBADMIN.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "delete ",
                  "backup"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_keep_versions": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "keepVersions:0",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_main_"
        }
      },
      "mitre": {
        "techniques": [
          "T1490"
        ],
        "tactics": [
          "impact"
        ]
      },
      "meta": {
        "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2021-12-13",
        "modified": "2024-05-10",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1490/T1490.md#atomic-test-5---windows---delete-volume-shadow-copies-via-wmi-with-powershell",
          "https://github.com/albertzsigovits/malware-notes/blob/558898932c1579ff589290092a2c8febefc3a4c9/Ransomware/Lockbit.md",
          "https://www.sentinelone.com/labs/ranzy-ransomware-better-encryption-among-new-features-of-thunderx-derivative/",
          "https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/ransomware-report-avaddon-and-new-techniques-emerge-industrial-sector-targeted",
          "https://www.trendmicro.com/content/dam/trendmicro/global/en/research/24/b/lockbit-attempts-to-stay-afloat-with-a-new-version/technical-appendix-lockbit-ng-dev-analysis.pdf",
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wbadmin-delete-systemstatebackup"
        ],
        "falsepositives": [
          "Legitimate backup activity from administration scripts and software."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wbadmin_delete_backups.yml"
      }
    },
    {
      "id": "b7e2a8d4-74bb-4b78-adc9-3f92af2d4829",
      "title": "Reg Add Suspicious Paths",
      "status": "test",
      "description": "Detects when an adversary uses the reg.exe utility to add or modify new keys or subkeys",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_reg": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\reg.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "reg.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_path": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\AppDataLow\\Software\\Microsoft\\",
                  "\\Policies\\Microsoft\\Windows\\OOBE",
                  "\\Policies\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon",
                  "\\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\Winlogon",
                  "\\CurrentControlSet\\Control\\SecurityProviders\\WDigest",
                  "\\Microsoft\\Windows Defender\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1112",
          "T1562.001"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-19",
        "modified": "2022-10-10",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1112/T1112.md",
          "https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1562.001/T1562.001.md",
          "https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/"
        ],
        "falsepositives": [
          "Rare legitimate add to registry via cli (to these locations)"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_reg_susp_paths.yml"
      }
    },
    {
      "id": "ff2fff64-4cd6-4a2b-ba7d-e28a30bbe66b",
      "title": "Suspicious Scheduled Task Name As GUID",
      "status": "test",
      "description": "Detects creation of a scheduled task with a GUID like name",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.execution",
        "attack.t1053.005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\schtasks.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "/Create ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_tn": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "/TN \"{",
                  "/TN '{",
                  "/TN {"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_end": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "}\"",
                  "}'",
                  "} "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1053.005"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-10-31",
        "modified": "",
        "references": [
          "https://thedfirreport.com/2022/10/31/follina-exploit-leads-to-domain-compromise/",
          "https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/"
        ],
        "falsepositives": [
          "Legitimate software naming their tasks as GUIDs"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_schtasks_guid_task_name.yml"
      }
    },
    {
      "id": "97dbf6e2-e436-44d8-abee-4261b24d3e41",
      "title": "Microsoft IIS Connection Strings Decryption",
      "status": "test",
      "description": "Detects use of aspnet_regiis to decrypt Microsoft IIS connection strings. An attacker with Microsoft IIS web server access via a webshell or alike can decrypt and dump any hardcoded connection strings, such as the MSSQL service account password using aspnet_regiis command.",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_name": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\aspnet_regiis.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "aspnet_regiis.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_args": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "connectionStrings",
                  " -pdf"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Tim Rauch, Elastic (idea)",
        "date": "2022-09-28",
        "modified": "2022-12-30",
        "references": [
          "https://www.elastic.co/guide/en/security/current/microsoft-iis-connection-strings-decryption.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_iis_connection_strings_decryption.yml"
      }
    },
    {
      "id": "536e2947-3729-478c-9903-745aaffe60d2",
      "title": "Suspicious PowerShell Invocations - Specific - ProcessCreation",
      "status": "test",
      "description": "Detects suspicious PowerShell invocation command parameters",
      "level": "medium",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_convert_b64": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "-nop",
                  " -w ",
                  "hidden",
                  " -c ",
                  "[Convert]::FromBase64String"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_iex": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " -w ",
                  "hidden",
                  "-noni",
                  "-nop",
                  " -c ",
                  "iex",
                  "New-Object"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_enc": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " -w ",
                  "hidden",
                  "-ep",
                  "bypass",
                  "-Enc"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_reg": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "powershell",
                  "reg",
                  "add",
                  "\\software\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_webclient": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "bypass",
                  "-noprofile",
                  "-windowstyle",
                  "hidden",
                  "new-object",
                  "system.net.webclient",
                  ".download"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_iex_webclient": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "iex",
                  "New-Object",
                  "Net.WebClient",
                  ".Download"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_chocolatey": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "(New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1",
                  "Write-ChocolateyWarning"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "1 of selection_* and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "1 of selection_*"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-01-05",
        "modified": "",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_invocation_specific.yml"
      }
    },
    {
      "id": "36d88494-1d43-4dc0-b3fa-35c8fea0ca9d",
      "title": "HackTool - CreateMiniDump Execution",
      "status": "test",
      "description": "Detects the use of CreateMiniDump hack tool used to dump the LSASS process memory for credential extraction on the attacker's machine",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\CreateMiniDump.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Hashes__contains": {
                    "field": "Hashes",
                    "value": "IMPHASH=4a07f944a83e8a7c2525efa35dd30e2f",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.001"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2019-12-22",
        "modified": "2024-11-23",
        "references": [
          "https://ired.team/offensive-security/credential-access-and-credential-dumping/dumping-lsass-passwords-without-mimikatz-minidumpwritedump-av-signature-bypass"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_createminidump.yml"
      }
    },
    {
      "id": "0b4ae027-2a2d-4b93-8c7e-962caaba5b2a",
      "title": "Time Travel Debugging Utility Usage",
      "status": "test",
      "description": "Detects usage of Time Travel Debugging Utility. Adversaries can execute malicious processes and dump processes, such as lsass.exe, via tttracer.exe.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.credential-access",
        "attack.t1218",
        "attack.t1003.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\tttracer.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218",
          "T1003.001"
        ],
        "tactics": [
          "defense_evasion",
          "credential_access"
        ]
      },
      "meta": {
        "author": "Ensar Şamil, @sblmsrsn, @oscd_initiative",
        "date": "2020-10-06",
        "modified": "2022-10-09",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Tttracer/",
          "https://twitter.com/mattifestation/status/1196390321783025666",
          "https://twitter.com/oulusoyum/status/1191329746069655553"
        ],
        "falsepositives": [
          "Legitimate usage by software developers/testers"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_tttracer_mod_load.yml"
      }
    },
    {
      "id": "73bba97f-a82d-42ce-b315-9182e76c57b1",
      "title": "Imports Registry Key From a File",
      "status": "test",
      "description": "Detects the import of the specified file to the registry with regedit.exe.",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.t1112",
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\regedit.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "REGEDIT.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " /i ",
                  " /s ",
                  ".reg"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -e ",
                  " -a ",
                  " -c "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__re": {
                "field": "CommandLine",
                "value": ":[^ \\\\]",
                "modifiers": [
                  "re"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not all of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "all of selection_*"
            },
            {
              "type": "not",
              "value": "all of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Oddvar Moe, Sander Wiebing, oscd.community",
        "date": "2020-10-07",
        "modified": "2024-03-13",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Regedit/",
          "https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f"
        ],
        "falsepositives": [
          "Legitimate import of keys",
          "Evernote"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_regedit_import_keys.yml"
      }
    },
    {
      "id": "1cc50f3f-1fc8-4acf-b2e9-6f172e1fdebd",
      "title": "Suspicious Rundll32 Invoking Inline VBScript",
      "status": "test",
      "description": "Detects suspicious process related to rundll32 based on command line that invokes inline VBScript as seen being used by UNC2452",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.defense-evasion",
        "attack.t1055"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "rundll32.exe",
                  "Execute",
                  "RegRead",
                  "window.close"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1055"
        ],
        "tactics": [
          "privilege_escalation",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-03-05",
        "modified": "2022-10-09",
        "references": [
          "https://www.microsoft.com/security/blog/2021/03/04/goldmax-goldfinder-sibot-analyzing-nobelium-malware/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_rundll32_inline_vbs.yml"
      }
    },
    {
      "id": "dcdbc940-0bff-46b2-95f3-2d73f848e33b",
      "title": "Suspicious Spool Service Child Process",
      "status": "test",
      "description": "Detects suspicious print spool service (spoolsv.exe) child processes.",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1203",
        "attack.privilege-escalation",
        "attack.t1068"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "spoolsv": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\spoolsv.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "IntegrityLevel": {
                "field": "IntegrityLevel",
                "value": [
                  "System",
                  "S-1-16-16384"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "suspicious_unrestricted": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\gpupdate.exe",
                  "\\whoami.exe",
                  "\\nltest.exe",
                  "\\taskkill.exe",
                  "\\wmic.exe",
                  "\\taskmgr.exe",
                  "\\sc.exe",
                  "\\findstr.exe",
                  "\\curl.exe",
                  "\\wget.exe",
                  "\\certutil.exe",
                  "\\bitsadmin.exe",
                  "\\accesschk.exe",
                  "\\wevtutil.exe",
                  "\\bcdedit.exe",
                  "\\fsutil.exe",
                  "\\cipher.exe",
                  "\\schtasks.exe",
                  "\\write.exe",
                  "\\wuauclt.exe",
                  "\\systeminfo.exe",
                  "\\reg.exe",
                  "\\query.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "suspicious_net": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\net.exe",
                  "\\net1.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "suspicious_net_filter": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "start",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "suspicious_cmd": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\cmd.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "suspicious_cmd_filter": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ".spl",
                  "route add",
                  "program files"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "suspicious_netsh": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\netsh.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "suspicious_netsh_filter": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "add portopening",
                  "rule name"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "suspicious_powershell": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\powershell.exe",
                  "\\pwsh.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "suspicious_powershell_filter": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": ".spl",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "suspicious_rundll32_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\rundll32.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "RUNDLL32.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "suspicious_rundll32_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": "rundll32.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "spoolsv and ( suspicious_unrestricted or (suspicious_net and not suspicious_net_filter) or (suspicious_cmd and not suspicious_cmd_filter) or (suspicious_netsh and not suspicious_netsh_filter) or (suspicious_powershell and not suspicious_powershell_filter) or all of suspicious_rundll32_* )",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "spoolsv and ( suspicious_unrestricted",
            "(suspicious_net and not suspicious_net_filter)",
            "(suspicious_cmd and not suspicious_cmd_filter)",
            "(suspicious_netsh and not suspicious_netsh_filter)",
            "(suspicious_powershell and not suspicious_powershell_filter)",
            "all of suspicious_rundll32_* )"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1203",
          "T1068"
        ],
        "tactics": [
          "execution",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Justin C. (@endisphotic), @dreadphones (detection), Thomas Patzke (Sigma rule)",
        "date": "2021-07-11",
        "modified": "2024-12-01",
        "references": [
          "https://github.com/microsoft/Microsoft-365-Defender-Hunting-Queries/blob/efa17a600b43c897b4b7463cc8541daa1987eeb4/Exploits/Print%20Spooler%20RCE/Suspicious%20Spoolsv%20Child%20Process.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_spoolsv_susp_child_processes.yml"
      }
    },
    {
      "id": "21ff4ca9-f13a-41ad-b828-0077b2af2e40",
      "title": "Deletion of Volume Shadow Copies via WMI with PowerShell",
      "status": "test",
      "description": "Detects deletion of Windows Volume Shadow Copies with PowerShell code and Get-WMIObject. This technique is used by numerous ransomware families such as Sodinokibi/REvil",
      "level": "high",
      "tags": [
        "attack.impact",
        "attack.t1490"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_get": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Get-WmiObject",
                  "gwmi",
                  "Get-CimInstance",
                  "gcim"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_shadowcopy": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "Win32_ShadowCopy",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_delete": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ".Delete()",
                  "Remove-WmiObject",
                  "rwmi",
                  "Remove-CimInstance",
                  "rcim"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1490"
        ],
        "tactics": [
          "impact"
        ]
      },
      "meta": {
        "author": "Tim Rauch, Elastic (idea)",
        "date": "2022-09-20",
        "modified": "2022-12-30",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1490/T1490.md#atomic-test-5---windows---delete-volume-shadow-copies-via-wmi-with-powershell",
          "https://www.elastic.co/guide/en/security/current/volume-shadow-copy-deletion-via-powershell.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_shadowcopy_deletion.yml"
      }
    },
    {
      "id": "7a02e22e-b885-4404-b38b-1ddc7e65258a",
      "title": "Suspicious Schtasks Schedule Type With High Privileges",
      "status": "test",
      "description": "Detects scheduled task creations or modification to be run with high privileges on a suspicious schedule type",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.execution",
        "attack.t1053.005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\schtasks.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "schtasks.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_time": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " ONLOGON ",
                  " ONSTART ",
                  " ONCE ",
                  " ONIDLE "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_privs": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "NT AUT",
                  " SYSTEM",
                  "HIGHEST"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1053.005"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-31",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/schtasks-change",
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/schtasks-create"
        ],
        "falsepositives": [
          "Some installers were seen using this method of creation unfortunately. Filter them in your environment"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_schtasks_schedule_type_system.yml"
      }
    },
    {
      "id": "e4ed6030-ffe5-4e6a-8a8a-ab3c1ab9d94e",
      "title": "Disable Windows IIS HTTP Logging",
      "status": "test",
      "description": "Disables HTTP logging on a Windows IIS web server as seen by Threat Group 3390 (Bronze Union)",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\appcmd.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "appcmd.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "set",
                  "config",
                  "section:httplogging",
                  "dontLog:true"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.002"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-09",
        "modified": "2023-01-22",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.002/T1562.002.md#atomic-test-1---disable-windows-iis-http-logging"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_iis_appcmd_http_logging.yml"
      }
    },
    {
      "id": "63de06b9-a385-40b5-8b32-73f2b9ef84b6",
      "title": "Fsutil Drive Enumeration",
      "status": "test",
      "description": "Attackers may leverage fsutil to enumerated connected drives.",
      "level": "low",
      "tags": [
        "attack.discovery",
        "attack.t1120"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\fsutil.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "fsutil.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "drives",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1120"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Christopher Peacock '@securepeacock', SCYTHE '@scythe_io'",
        "date": "2022-03-29",
        "modified": "2022-07-14",
        "references": [
          "Turla has used fsutil fsinfo drives to list connected drives.",
          "https://github.com/elastic/detection-rules/blob/414d32027632a49fb239abb8fbbb55d3fa8dd861/rules/windows/discovery_peripheral_device.toml"
        ],
        "falsepositives": [
          "Certain software or administrative tasks may trigger false positives."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_fsutil_drive_enumeration.yml"
      }
    },
    {
      "id": "f4a623c2-4ef5-4c33-b811-0642f702c9f1",
      "title": "Visual Studio Code Tunnel Shell Execution",
      "status": "test",
      "description": "Detects the execution of a shell (powershell, bash, wsl...) via Visual Studio Code tunnel. Attackers can abuse this functionality to establish a C2 channel and execute arbitrary commands on the system.",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1071.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__contains": {
                "field": "ParentImage",
                "value": "\\servers\\Stable-",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\server\\node.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "ParentCommandLine__contains": {
                "field": "ParentCommandLine",
                "value": ".vscode-server",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_child_1": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\powershell.exe",
                  "\\pwsh.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "\\terminal\\browser\\media\\shellIntegration.ps1",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_child_2": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\wsl.exe",
                  "\\bash.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_parent and 1 of selection_child_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_parent"
            },
            {
              "type": "ref",
              "value": "1 of selection_child_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1071.001"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-10-25",
        "modified": "",
        "references": [
          "https://ipfyx.fr/post/visual-studio-code-tunnel/",
          "https://badoption.eu/blog/2023/01/31/code_c2.html",
          "https://code.visualstudio.com/docs/remote/tunnels"
        ],
        "falsepositives": [
          "Legitimate use of Visual Studio Code tunnel and running code from there"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_vscode_tunnel_remote_shell_.yml"
      }
    },
    {
      "id": "1114e048-b69c-4f41-bc20-657245ae6e3f",
      "title": "User Discovery And Export Via Get-ADUser Cmdlet",
      "status": "test",
      "description": "Detects usage of the Get-ADUser cmdlet to collect user information and output it to a file",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.t1033"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "Get-ADUser ",
                  " -Filter \\*"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " > ",
                  " | Select ",
                  "Out-File",
                  "Set-Content",
                  "Add-Content"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1033"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-09-09",
        "modified": "2022-11-17",
        "references": [
          "http://blog.talosintelligence.com/2022/09/lazarus-three-rats.html",
          "https://www.microsoft.com/en-us/security/blog/2022/10/18/defenders-beware-a-case-for-post-ransomware-investigations/"
        ],
        "falsepositives": [
          "Legitimate admin scripts may use the same technique, it's better to exclude specific computers or users who execute these commands or scripts often"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_user_discovery_get_aduser.yml"
      }
    },
    {
      "id": "0b7163dc-7eee-4960-af17-c0cd517f92da",
      "title": "Service Started/Stopped Via Wmic.EXE",
      "status": "test",
      "description": "Detects usage of wmic to start or stop a service",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1047"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "wmic.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\WMIC.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " service ",
                  " call "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "stopservice",
                  "startservice"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1047"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-06-20",
        "modified": "2023-02-14",
        "references": [
          "https://sushant747.gitbooks.io/total-oscp-guide/content/privilege_escalation_windows.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wmic_service_manipulation.yml"
      }
    },
    {
      "id": "99c840f2-2012-46fd-9141-c761987550ef",
      "title": "Suspicious Download From Direct IP Via Bitsadmin",
      "status": "test",
      "description": "Detects usage of bitsadmin downloading a file using an URL that contains an IP",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.persistence",
        "attack.t1197",
        "attack.s0190",
        "attack.t1036.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\bitsadmin.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "bitsadmin.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_flags": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " /transfer ",
                  " /create ",
                  " /addfile "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_extension": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "://1",
                  "://2",
                  "://3",
                  "://4",
                  "://5",
                  "://6",
                  "://7",
                  "://8",
                  "://9"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_seven_zip": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "://7-",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_"
        }
      },
      "mitre": {
        "techniques": [
          "T1197",
          "T1036.003"
        ],
        "tactics": [
          "defense_evasion",
          "persistence"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-06-28",
        "modified": "2023-02-15",
        "references": [
          "https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin",
          "https://isc.sans.edu/diary/22264",
          "https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/",
          "https://blog.talosintelligence.com/breaking-the-silence-recent-truebot-activity/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_bitsadmin_download_direct_ip.yml"
      }
    },
    {
      "id": "c625d754-6a3d-4f65-9c9a-536aea960d37",
      "title": "Permission Check Via Accesschk.EXE",
      "status": "test",
      "description": "Detects the usage of the \"Accesschk\" utility, an access and privilege audit tool developed by SysInternal and often being abused by attacker to verify process privileges",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.t1069.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Product__endswith": {
                    "field": "Product",
                    "value": "AccessChk",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description__contains": {
                    "field": "Description",
                    "value": "Reports effective permissions",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\accesschk.exe",
                      "\\accesschk64.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "accesschk.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "uwcqv ",
                  "kwsu ",
                  "qwsu ",
                  "uwdqs "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1069.001"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Teymur Kheirkhabarov (idea), Mangatas Tondang, oscd.community, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2020-10-13",
        "modified": "2023-02-20",
        "references": [
          "https://speakerdeck.com/heirhabarov/hunting-for-privilege-escalation-in-windows-environment?slide=43",
          "https://www.youtube.com/watch?v=JGs-aKf2OtU&ab_channel=OFFZONEMOSCOW",
          "https://github.com/carlospolop/PEASS-ng/blob/fa0f2e17fbc1d86f1fd66338a40e665e7182501d/winPEAS/winPEASbat/winPEAS.bat",
          "https://github.com/gladiatx0r/Powerless/blob/04f553bbc0c65baf4e57344deff84e3f016e6b51/Powerless.bat"
        ],
        "falsepositives": [
          "System administrator Usage"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sysinternals_accesschk_check_permissions.yml"
      }
    },
    {
      "id": "737e618a-a410-49b5-bec3-9e55ff7fbc15",
      "title": "Suspicious Calculator Usage",
      "status": "test",
      "description": "Detects suspicious use of 'calc.exe' with command line parameters or in a suspicious directory, which is likely caused by some PoC or detection evasion.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "\\calc.exe ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_2": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\calc.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_known_locations": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  ":\\Windows\\System32\\",
                  ":\\Windows\\SysWOW64\\",
                  ":\\Windows\\WinSxS\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection_1 or ( selection_2 and not filter_main_known_locations )",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection_1",
            "( selection_2 and not filter_main_known_locations )"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1036"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2019-02-09",
        "modified": "2023-11-09",
        "references": [
          "https://twitter.com/ItsReallyNick/status/1094080242686312448"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_calc_uncommon_exec.yml"
      }
    },
    {
      "id": "9248c7e1-2bf3-4661-a22c-600a8040b446",
      "title": "Potential Rundll32 Execution With DLL Stored In ADS",
      "status": "test",
      "description": "Detects execution of rundll32 where the DLL being called is stored in an Alternate Data Stream (ADS).",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1564.004"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\rundll32.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "RUNDLL32.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__re": {
                "field": "CommandLine",
                "value": "[Rr][Uu][Nn][Dd][Ll][Ll]32(\\.[Ee][Xx][Ee])? \\S+?\\w:\\S+?:",
                "modifiers": [
                  "re"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1564.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Harjot Singh, '@cyb3rjy0t'",
        "date": "2023-01-21",
        "modified": "2023-02-08",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Rundll32"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_rundll32_ads_stored_dll_execution.yml"
      }
    },
    {
      "id": "41ca393d-538c-408a-ac27-cf1e038be80c",
      "title": "Directory Removal Via Rmdir",
      "status": "test",
      "description": "Detects execution of the builtin \"rmdir\" command in order to delete directories.\nAdversaries may delete files left behind by the actions of their intrusion activity.\nMalware, tools, or other non-native files dropped or created on a system by an adversary may leave traces to indicate to what was done within a network and how.\nRemoval of these files can occur during an intrusion, or as part of a post-intrusion process to minimize the adversary's footprint.\n",
      "level": "low",
      "tags": [
        "attack.defense-evasion",
        "attack.t1070.004"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\cmd.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "Cmd.Exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_rmdir": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "rmdir",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_flags": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "/s",
                  "/q"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1070.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-15",
        "modified": "2023-03-07",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.004/T1070.004.md",
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/erase"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_cmd_rmdir_execution.yml"
      }
    },
    {
      "id": "1c12727d-02bf-45ff-a9f3-d49806a3cf43",
      "title": "Renamed Plink Execution",
      "status": "test",
      "description": "Detects the execution of a renamed version of the Plink binary",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "Plink",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      " -l forward",
                      " -P ",
                      " -R "
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\plink.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1036"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-06-06",
        "modified": "2023-02-03",
        "references": [
          "https://thedfirreport.com/2022/06/06/will-the-real-msiexec-please-stand-up-exploit-leads-to-data-exfiltration/",
          "https://the.earth.li/~sgtatham/putty/0.58/htmldoc/Chapter7.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_renamed_plink.yml"
      }
    },
    {
      "id": "d059842b-6b9d-4ed1-b5c3-5b89143c6ede",
      "title": "File Download Via Bitsadmin",
      "status": "test",
      "description": "Detects usage of bitsadmin downloading a file",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.persistence",
        "attack.t1197",
        "attack.s0190",
        "attack.t1036.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\bitsadmin.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "bitsadmin.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cmd": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " /transfer ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " /create ",
                  " /addfile "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "http",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_img and (selection_cmd or all of selection_cli_*)",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection_img and (selection_cmd",
            "all of selection_cli_*)"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1197",
          "T1036.003"
        ],
        "tactics": [
          "defense_evasion",
          "persistence"
        ]
      },
      "meta": {
        "author": "Michael Haag, FPT.EagleEye",
        "date": "2017-03-09",
        "modified": "2023-02-15",
        "references": [
          "https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin",
          "https://isc.sans.edu/diary/22264",
          "https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/"
        ],
        "falsepositives": [
          "Some legitimate apps use this, but limited."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_bitsadmin_download.yml"
      }
    },
    {
      "id": "ba3f5c1b-6272-4119-9dbd-0bc8d21c2702",
      "title": "Potential WinAPI Calls Via CommandLine",
      "status": "test",
      "description": "Detects the use of WinAPI Functions via the commandline. As seen used by threat actors via the tool winapiexec",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1106"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "AddSecurityPackage",
                  "AdjustTokenPrivileges",
                  "Advapi32",
                  "CloseHandle",
                  "CreateProcessWithToken",
                  "CreatePseudoConsole",
                  "CreateRemoteThread",
                  "CreateThread",
                  "CreateUserThread",
                  "DangerousGetHandle",
                  "DuplicateTokenEx",
                  "EnumerateSecurityPackages",
                  "FreeHGlobal",
                  "FreeLibrary",
                  "GetDelegateForFunctionPointer",
                  "GetLogonSessionData",
                  "GetModuleHandle",
                  "GetProcAddress",
                  "GetProcessHandle",
                  "GetTokenInformation",
                  "ImpersonateLoggedOnUser",
                  "kernel32",
                  "LoadLibrary",
                  "memcpy",
                  "MiniDumpWriteDump",
                  "ntdll",
                  "OpenDesktop",
                  "OpenProcess",
                  "OpenProcessToken",
                  "OpenThreadToken",
                  "OpenWindowStation",
                  "PtrToString",
                  "QueueUserApc",
                  "ReadProcessMemory",
                  "RevertToSelf",
                  "RtlCreateUserThread",
                  "secur32",
                  "SetThreadToken",
                  "VirtualAlloc",
                  "VirtualFree",
                  "VirtualProtect",
                  "WaitForSingleObject",
                  "WriteInt32",
                  "WriteProcessMemory",
                  "ZeroFreeGlobalAllocUnicode"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_mpcmdrun": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\MpCmdRun.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "GetLoadLibraryWAddress32",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_compatTelRunner": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\CompatTelRunner.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "FreeHGlobal",
                  "PtrToString",
                  "kernel32",
                  "CloseHandle"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1106"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-09-06",
        "modified": "2025-03-06",
        "references": [
          "https://twitter.com/m417z/status/1566674631788007425"
        ],
        "falsepositives": [
          "Some legitimate action or applications may use these functions. Investigate further to determine the legitimacy of the activity."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_inline_win_api_access.yml"
      }
    },
    {
      "id": "2db93a3f-3249-4f73-9e68-0e77a0f8ae7e",
      "title": "Remote Access Tool - TacticalRMM Agent Registration to Potentially Attacker-Controlled Server",
      "status": "experimental",
      "description": "Detects TacticalRMM agent installations where the --api, --auth, and related flags are used on the command line.\nThese parameters configure the agent to connect to a specific RMM server with authentication, client ID, and site ID.\nThis technique could indicate a threat actor attempting to register the agent with an attacker-controlled RMM infrastructure silently.\n",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1219",
        "attack.t1105"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": "\\TacticalAgent\\tacticalrmm.exe",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "--api",
                  "--auth",
                  "--client-id",
                  "--site-id",
                  "--agent-type"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1219",
          "T1105"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Ahmed Nosir (@egycondor)",
        "date": "2025-05-29",
        "modified": "",
        "references": [
          "https://github.com/amidaware/tacticalrmm",
          "https://apophis133.medium.com/powershell-script-tactical-rmm-installation-45afb639eff3"
        ],
        "falsepositives": [
          "Legitimate system administrator deploying TacticalRMM"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_remote_access_tools_tacticalrmm_agent_registration_via_cli.yml"
      }
    },
    {
      "id": "817f252c-5143-4dae-b418-48c3e9f63728",
      "title": "Windows Recall Feature Enabled Via Reg.EXE",
      "status": "test",
      "description": "Detects the enabling of the Windows Recall feature via registry manipulation.\nWindows Recall can be enabled by deleting the existing \"DisableAIDataAnalysis\" value, or setting it to 0.\nAdversaries may enable Windows Recall as part of post-exploitation discovery and collection activities.\nThis rule assumes that Recall is already explicitly disabled on the host, and subsequently enabled by the adversary.\n",
      "level": "medium",
      "tags": [
        "attack.collection",
        "attack.t1113"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\reg.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "reg.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_value": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "Microsoft\\Windows\\WindowsAI",
                  "DisableAIDataAnalysis"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_action_add": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "add",
                  "0"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_action_delete": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "delete",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_img and selection_value and 1 of selection_action_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_img"
            },
            {
              "type": "ref",
              "value": "selection_value"
            },
            {
              "type": "ref",
              "value": "1 of selection_action_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1113"
        ],
        "tactics": [
          "collection"
        ]
      },
      "meta": {
        "author": "Sajid Nawaz Khan",
        "date": "2024-06-02",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/windows/client-management/manage-recall",
          "https://learn.microsoft.com/en-us/windows/client-management/mdm/policy-csp-windowsai#disableaidataanalysis"
        ],
        "falsepositives": [
          "Legitimate use/activation of Windows Recall"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_reg_enable_windows_recall.yml"
      }
    },
    {
      "id": "145322e4-0fd3-486b-81ca-9addc75736d8",
      "title": "Use of UltraVNC Remote Access Software",
      "status": "test",
      "description": "An adversary may use legitimate desktop support and remote access software,to establish an interactive command and control channel to target systems within networks",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1219.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "VNCViewer",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Product": {
                    "field": "Product",
                    "value": "UltraVNC VNCViewer",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Company": {
                    "field": "Company",
                    "value": "UltraVNC",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "VNCViewer.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1219.002"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-10-02",
        "modified": "",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/9e5b12c4912c07562aec7500447b11fa3e17e254/atomics/T1219/T1219.md"
        ],
        "falsepositives": [
          "Legitimate use"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_ultravnc.yml"
      }
    },
    {
      "id": "1412aa78-a24c-4abd-83df-767dfb2c5bbe",
      "title": "Potentially Suspicious WebDAV LNK Execution",
      "status": "test",
      "description": "Detects possible execution via LNK file accessed on a WebDAV server.",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059.001",
        "attack.t1204"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\explorer.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\cmd.exe",
                  "\\cscript.exe",
                  "\\mshta.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\wscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "\\DavWWWRoot\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001",
          "T1204"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Micah Babinski",
        "date": "2023-08-21",
        "modified": "",
        "references": [
          "https://www.trellix.com/en-us/about/newsroom/stories/research/beyond-file-search-a-novel-method.html",
          "https://micahbabinski.medium.com/search-ms-webdav-and-chill-99c5b23ac462"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_webdav_lnk_execution.yml"
      }
    },
    {
      "id": "277a4393-446c-449a-b0ed-7fdc7795244c",
      "title": "Renamed FTP.EXE Execution",
      "status": "test",
      "description": "Detects the execution of a renamed \"ftp.exe\" binary based on the PE metadata fields",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059",
        "attack.defense-evasion",
        "attack.t1202"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_original": {
            "type": "field_match",
            "matchers": {
              "OriginalFileName": {
                "field": "OriginalFileName",
                "value": "ftp.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\ftp.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection_original and not filter_img",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection_original",
          "exclude": "filter_img"
        }
      },
      "mitre": {
        "techniques": [
          "T1059",
          "T1202"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Victor Sergeev, oscd.community",
        "date": "2020-10-09",
        "modified": "2023-02-03",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Ftp/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_renamed_ftp.yml"
      }
    },
    {
      "id": "f4ff7323-b5fc-4323-8b52-6b9408e15788",
      "title": "Potential PowerShell Console History Access Attempt via History File",
      "status": "experimental",
      "description": "Detects potential access attempts to the PowerShell console history directly via history file (ConsoleHost_history.txt).\nThis can give access to plaintext passwords used in PowerShell commands or used for general reconnaissance.\n",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.t1552.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "ConsoleHost_history.txt",
                  "(Get-PSReadLineOption).HistorySavePath"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1552.001"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Luc Génaux",
        "date": "2025-04-03",
        "modified": "",
        "references": [
          "https://0xdf.gitlab.io/2018/11/08/powershell-history-file.html"
        ],
        "falsepositives": [
          "Legitimate access of the console history file is possible"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_console_history_file_access.yml"
      }
    },
    {
      "id": "3ae9974a-eb09-4044-8e70-8980a50c12c8",
      "title": "Suspicious Explorer Process with Whitespace Padding - ClickFix/FileFix",
      "status": "experimental",
      "description": "Detects process creation with suspicious whitespace padding followed by a '#' character, which may indicate ClickFix or FileFix techniques used to conceal malicious commands from visual inspection.\nClickFix and FileFix are social engineering attack techniques where adversaries distribute phishing documents or malicious links that deceive users into opening the Windows Run dialog box or File Explorer search bar.\nThe victims are then instructed to paste commands from their clipboard, which contain extensive whitespace padding using various Unicode space characters to push the actual malicious command far to the right, effectively hiding it from immediate view.\n",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1204.004",
        "attack.defense-evasion",
        "attack.t1027.010"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_explorer": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\explorer.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "#",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_space_variation": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "            ",
                  "            ",
                  "            ",
                  "            ",
                  "            ",
                  "            ",
                  "            ",
                  "            ",
                  "            ",
                  "            ",
                  "            ",
                  "            ",
                  "            "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1204.004",
          "T1027.010"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-11-04",
        "modified": "2025-11-26",
        "references": [
          "https://expel.com/blog/cache-smuggling-when-a-picture-isnt-a-thousand-words/",
          "https://mrd0x.com/filefix-clickfix-alternative/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_clickfix_filefix_whitespace_padding.yml"
      }
    },
    {
      "id": "be58d2e2-06c8-4f58-b666-b99f6dc3b6cd",
      "title": "Suspicious Process Masquerading As SvcHost.EXE",
      "status": "test",
      "description": "Detects a suspicious process that is masquerading as the legitimate \"svchost.exe\" by naming its binary \"svchost.exe\" and executing from an uncommon location.\nAdversaries often disguise their malicious binaries by naming them after legitimate system processes like \"svchost.exe\" to evade detection.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036.005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\svchost.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_img_location": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Windows\\System32\\svchost.exe",
                  "C:\\Windows\\SysWOW64\\svchost.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_ofn": {
            "type": "field_match",
            "matchers": {
              "OriginalFileName": {
                "field": "OriginalFileName",
                "value": "svchost.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1036.005"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel",
        "date": "2024-08-07",
        "modified": "",
        "references": [
          "https://tria.ge/240731-jh4crsycnb/behavioral2",
          "https://redcanary.com/blog/threat-detection/process-masquerading/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_svchost_masqueraded_execution.yml"
      }
    },
    {
      "id": "fcdf69e5-a3d3-452a-9724-26f2308bf2b1",
      "title": "Phishing Pattern ISO in Archive",
      "status": "test",
      "description": "Detects cases in which an ISO files is opend within an archiver like 7Zip or Winrar, which is a sign of phishing as threat actors put small ISO files in archives as email attachments to bypass certain filters and protective measures (mark of web)",
      "level": "high",
      "tags": [
        "attack.initial-access",
        "attack.t1566"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\Winrar.exe",
                  "\\7zFM.exe",
                  "\\peazip.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\isoburn.exe",
                  "\\PowerISO.exe",
                  "\\ImgBurn.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1566"
        ],
        "tactics": [
          "initial_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-06-07",
        "modified": "",
        "references": [
          "https://twitter.com/1ZRR4H/status/1534259727059787783",
          "https://app.any.run/tasks/e1fe6a62-bce8-4323-a49a-63795d9afd5d/"
        ],
        "falsepositives": [
          "Legitimate cases in which archives contain ISO or IMG files and the user opens the archive and the image via clicking and not extraction"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_archiver_iso_phishing.yml"
      }
    },
    {
      "id": "2158f96f-43c2-43cb-952a-ab4580f32382",
      "title": "Screen Capture Activity Via Psr.EXE",
      "status": "test",
      "description": "Detects execution of Windows Problem Steps Recorder (psr.exe), a utility used to record the user screen and clicks.",
      "level": "medium",
      "tags": [
        "attack.collection",
        "attack.t1113"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\Psr.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "/start",
                  "-start"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1113"
        ],
        "tactics": [
          "collection"
        ]
      },
      "meta": {
        "author": "Beyu Denis, oscd.community",
        "date": "2019-10-12",
        "modified": "2024-01-04",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Psr/",
          "https://web.archive.org/web/20200229201156/https://www.sans.org/cyber-security-summit/archives/file/summit-archive-1493861893.pdf",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1560.001/T1560.001.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_psr_capture_screenshots.yml"
      }
    },
    {
      "id": "67bc0e75-c0a9-4cfc-8754-84a505b63c04",
      "title": "Potentially Suspicious Child Process Of ClickOnce Application",
      "status": "test",
      "description": "Detects potentially suspicious child processes of a ClickOnce deployment application",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__contains": {
                "field": "ParentImage",
                "value": "\\AppData\\Local\\Apps\\2.0\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\calc.exe",
                  "\\cmd.exe",
                  "\\cscript.exe",
                  "\\explorer.exe",
                  "\\mshta.exe",
                  "\\net.exe",
                  "\\net1.exe",
                  "\\nltest.exe",
                  "\\notepad.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\reg.exe",
                  "\\regsvr32.exe",
                  "\\rundll32.exe",
                  "\\schtasks.exe",
                  "\\werfault.exe",
                  "\\wscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-06-12",
        "modified": "",
        "references": [
          "https://posts.specterops.io/less-smartscreen-more-caffeine-ab-using-clickonce-for-trusted-code-execution-1446ea8051c5"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_dfsvc_suspicious_child_processes.yml"
      }
    },
    {
      "id": "313d6012-51a0-4d93-8dfc-de8553239e25",
      "title": "Install New Package Via Winget Local Manifest",
      "status": "test",
      "description": "Detects usage of winget to install applications via manifest file. Adversaries can abuse winget to download payloads remotely and execute them.\nThe manifest option enables you to install an application by passing in a YAML file directly to the client.\nWinget can be used to download and install exe, msi or msix files later.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.execution",
        "attack.t1059"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\winget.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "winget.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_install_flag": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "install",
                  " add "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_manifest_flag": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "-m ",
                  "--manifest"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Sreeman, Florian Roth (Nextron Systems), frack113",
        "date": "2020-04-21",
        "modified": "2023-04-17",
        "references": [
          "https://learn.microsoft.com/en-us/windows/package-manager/winget/install#local-install",
          "https://lolbas-project.github.io/lolbas/Binaries/Winget/",
          "https://github.com/nasbench/Misc-Research/tree/b9596e8109dcdb16ec353f316678927e507a5b8d/LOLBINs/Winget"
        ],
        "falsepositives": [
          "Some false positives are expected in some environment that may use this functionality to install and test their custom applications"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_winget_local_install_via_manifest.yml"
      }
    },
    {
      "id": "dcaa3f04-70c3-427a-80b4-b870d73c94c4",
      "title": "Dynamic .NET Compilation Via Csc.EXE",
      "status": "test",
      "description": "Detects execution of \"csc.exe\" to compile .NET code. Attackers often leverage this to compile code on the fly and use it in other stages.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027.004"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\csc.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_susp_location_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ":\\Perflogs\\",
                  ":\\Users\\Public\\",
                  "\\AppData\\Local\\Temp\\",
                  "\\Temporary Internet",
                  "\\Windows\\Temp\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_susp_location_2": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      ":\\Users\\",
                      "\\Favorites\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      ":\\Users\\",
                      "\\Favourites\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      ":\\Users\\",
                      "\\Contacts\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      ":\\Users\\",
                      "\\Pictures\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_susp_location_3": {
            "type": "field_match",
            "matchers": {
              "CommandLine__re": {
                "field": "CommandLine",
                "value": "([Pp]rogram[Dd]ata|%([Ll]ocal)?[Aa]pp[Dd]ata%|\\\\[Aa]pp[Dd]ata\\\\([Ll]ocal([Ll]ow)?|[Rr]oaming))\\\\[^\\\\]{1,256}$",
                "modifiers": [
                  "re"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_programfiles": {
            "type": "field_match",
            "matchers": {
              "ParentImage__startswith": {
                "field": "ParentImage",
                "value": [
                  "C:\\Program Files (x86)\\",
                  "C:\\Program Files\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_sdiagnhost": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": "C:\\Windows\\System32\\sdiagnhost.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_w3p": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": "C:\\Windows\\System32\\inetsrv\\w3wp.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_chocolatey": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": [
                  "C:\\ProgramData\\chocolatey\\choco.exe",
                  "C:\\ProgramData\\chocolatey\\tools\\shimgen.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_defender": {
            "type": "field_match",
            "matchers": {
              "ParentCommandLine__contains": {
                "field": "ParentCommandLine",
                "value": "\\ProgramData\\Microsoft\\Windows Defender Advanced Threat Protection",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_ansible": {
            "type": "field_match",
            "matchers": {
              "ParentCommandLine__contains": {
                "field": "ParentCommandLine",
                "value": [
                  "JwB7ACIAZgBhAGkAbABlAGQAIgA6AHQAcgB1AGUALAAiAG0AcwBnACIAOgAiAEEAbgBzAGkAYgBsAGUAIAByAGUAcQB1AGkAcgBlAHMAIABQAG8AdwBlAHIAUwBoAGUAbABsACAAdgAzAC4AMAAgAG8AcgAgAG4AZQB3AGUAcgAiAH0AJw",
                  "cAewAiAGYAYQBpAGwAZQBkACIAOgB0AHIAdQBlACwAIgBtAHMAZwAiADoAIgBBAG4AcwBpAGIAbABlACAAcgBlAHEAdQBpAHIAZQBzACAAUABvAHcAZQByAFMAaABlAGwAbAAgAHYAMwAuADAAIABvAHIAIABuAGUAdwBlAHIAIgB9ACcA",
                  "nAHsAIgBmAGEAaQBsAGUAZAAiADoAdAByAHUAZQAsACIAbQBzAGcAIgA6ACIAQQBuAHMAaQBiAGwAZQAgAHIAZQBxAHUAaQByAGUAcwAgAFAAbwB3AGUAcgBTAGgAZQBsAGwAIAB2ADMALgAwACAAbwByACAAbgBlAHcAZQByACIAfQAnA"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection_img and 1 of selection_susp_location_* and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_img"
            },
            {
              "type": "ref",
              "value": "1 of selection_susp_location_*"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1027.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), X__Junior (Nextron Systems)",
        "date": "2019-08-24",
        "modified": "2024-05-27",
        "references": [
          "https://securityboulevard.com/2019/08/agent-tesla-evading-edr-by-removing-api-hooks/",
          "https://www.clearskysec.com/wp-content/uploads/2018/11/MuddyWater-Operations-in-Lebanon-and-Oman.pdf",
          "https://app.any.run/tasks/c6993447-d1d8-414e-b856-675325e5aa09/",
          "https://twitter.com/gN3mes1s/status/1206874118282448897",
          "https://github.com/redcanaryco/atomic-red-team/blob/b27a3cb25025161d49ac861cb216db68c46a3537/atomics/T1027.004/T1027.004.md#atomic-test-1---compile-after-delivery-using-cscexe"
        ],
        "falsepositives": [
          "Legitimate software from program files - https://twitter.com/gN3mes1s/status/1206874118282448897",
          "Legitimate Microsoft software - https://twitter.com/gabriele_pippi/status/1206907900268072962",
          "Ansible"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_csc_susp_dynamic_compilation.yml"
      }
    },
    {
      "id": "fadb84f0-4e84-4f6d-a1ce-9ef2bffb6ccd",
      "title": "Cloudflared Portable Execution",
      "status": "test",
      "description": "Detects the execution of the \"cloudflared\" binary from a non standard location.\n",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1090.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\cloudflared.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_admin_location": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  ":\\Program Files (x86)\\cloudflared\\",
                  ":\\Program Files\\cloudflared\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1090.001"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-12-20",
        "modified": "",
        "references": [
          "https://developers.cloudflare.com/cloudflare-one/connections/connect-networks/do-more-with-tunnels/trycloudflare/",
          "https://github.com/cloudflare/cloudflared",
          "https://www.intrinsec.com/akira_ransomware/",
          "https://www.guidepointsecurity.com/blog/tunnel-vision-cloudflared-abused-in-the-wild/",
          "https://github.com/cloudflare/cloudflared/releases"
        ],
        "falsepositives": [
          "Legitimate usage of Cloudflared portable versions"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_cloudflared_portable_execution.yml"
      }
    },
    {
      "id": "208748f7-881d-47ac-a29c-07ea84bf691d",
      "title": "Suspicious Outlook Child Process",
      "status": "test",
      "description": "Detects a suspicious process spawning from an Outlook process.",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1204.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\OUTLOOK.EXE",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\AppVLP.exe",
                  "\\bash.exe",
                  "\\cmd.exe",
                  "\\cscript.exe",
                  "\\forfiles.exe",
                  "\\hh.exe",
                  "\\mftrace.exe",
                  "\\msbuild.exe",
                  "\\msdt.exe",
                  "\\mshta.exe",
                  "\\msiexec.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\regsvr32.exe",
                  "\\schtasks.exe",
                  "\\scrcons.exe",
                  "\\scriptrunner.exe",
                  "\\sh.exe",
                  "\\svchost.exe",
                  "\\wmic.exe",
                  "\\wscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1204.002"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Michael Haag, Florian Roth (Nextron Systems), Markus Neis, Elastic, FPT.EagleEye Team",
        "date": "2022-02-28",
        "modified": "2023-02-04",
        "references": [
          "https://www.hybrid-analysis.com/sample/465aabe132ccb949e75b8ab9c5bda36d80cf2fd503d52b8bad54e295f28bbc21?environmentId=100",
          "https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_office_outlook_susp_child_processes.yml"
      }
    },
    {
      "id": "982e9f2d-1a85-4d5b-aea4-31f5e97c6555",
      "title": "Suspicious WebDav Client Execution Via Rundll32.EXE",
      "status": "test",
      "description": "Detects \"svchost.exe\" spawning \"rundll32.exe\" with command arguments like C:\\windows\\system32\\davclnt.dll,DavSetCookie. This could be an indicator of exfiltration or use of WebDav to launch code (hosted on WebDav Server) or potentially a sign of exploitation of CVE-2023-23397\n",
      "level": "high",
      "tags": [
        "attack.exfiltration",
        "attack.t1048.003",
        "cve.2023-23397"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\svchost.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "ParentCommandLine__contains": {
                "field": "ParentCommandLine",
                "value": "-s WebClient",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\rundll32.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "C:\\windows\\system32\\davclnt.dll,DavSetCookie",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__re": {
                "field": "CommandLine",
                "value": "://\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}",
                "modifiers": [
                  "re"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_local_ips": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "://10.",
                  "://192.168.",
                  "://172.16.",
                  "://172.17.",
                  "://172.18.",
                  "://172.19.",
                  "://172.20.",
                  "://172.21.",
                  "://172.22.",
                  "://172.23.",
                  "://172.24.",
                  "://172.25.",
                  "://172.26.",
                  "://172.27.",
                  "://172.28.",
                  "://172.29.",
                  "://172.30.",
                  "://172.31.",
                  "://127.",
                  "://169.254."
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1048.003"
        ],
        "tactics": [
          "exfiltration"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), Florian Roth (Nextron Systems)",
        "date": "2023-03-16",
        "modified": "2023-09-18",
        "references": [
          "https://twitter.com/aceresponder/status/1636116096506818562",
          "https://www.mdsec.co.uk/2023/03/exploiting-cve-2023-23397-microsoft-outlook-elevation-of-privilege-vulnerability/",
          "https://www.pwndefend.com/2023/03/15/the-long-game-persistent-hash-theft/",
          "https://www.microsoft.com/en-us/security/blog/wp-content/uploads/2023/03/Figure-7-sample-webdav-process-create-event.png",
          "https://www.microsoft.com/en-us/security/blog/2023/03/24/guidance-for-investigating-attacks-using-cve-2023-23397/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_rundll32_webdav_client_susp_execution.yml"
      }
    },
    {
      "id": "9a4ccd1a-3526-4d99-b980-9f9c5d3a6ff3",
      "title": "Potential Credential Dumping Via WER",
      "status": "test",
      "description": "Detects potential credential dumping via Windows Error Reporting LSASS Shtinkering technique which uses the Windows Error Reporting to dump lsass",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\Werfault.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "WerFault.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "ParentUser__contains": {
                "field": "ParentUser",
                "value": [
                  "AUTHORI",
                  "AUTORI"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "User__contains": {
                "field": "User",
                "value": [
                  "AUTHORI",
                  "AUTORI"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " -u -p ",
                  " -ip ",
                  " -s "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_lsass": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": "C:\\Windows\\System32\\lsass.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.001"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "@pbssubhash , Nasreddine Bencherchali",
        "date": "2022-12-08",
        "modified": "2022-12-09",
        "references": [
          "https://github.com/deepinstinct/Lsass-Shtinkering",
          "https://media.defcon.org/DEF%20CON%2030/DEF%20CON%2030%20presentations/Asaf%20Gilboa%20-%20LSASS%20Shtinkering%20Abusing%20Windows%20Error%20Reporting%20to%20Dump%20LSASS.pdf"
        ],
        "falsepositives": [
          "Windows Error Reporting might produce similar behavior. In that case, check the PID associated with the \"-p\" parameter in the CommandLine."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_werfault_lsass_shtinkering.yml"
      }
    },
    {
      "id": "df55196f-f105-44d3-a675-e9dfb6cc2f2b",
      "title": "Renamed AdFind Execution",
      "status": "test",
      "description": "Detects the use of a renamed Adfind.exe. AdFind continues to be seen across majority of breaches. It is used to domain trust discovery to plan out subsequent steps in the attack chain.",
      "level": "high",
      "tags": [
        "attack.discovery",
        "attack.t1018",
        "attack.t1087.002",
        "attack.t1482",
        "attack.t1069.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "domainlist",
                  "trustdmp",
                  "dcmodes",
                  "adinfo",
                  " dclist ",
                  "computer_pwdnotreqd",
                  "objectcategory=",
                  "-subnets -f",
                  "name=\"Domain Admins\"",
                  "-sc u:",
                  "domainncs",
                  "dompol",
                  " oudmp ",
                  "subnetdmp",
                  "gpodmp",
                  "fspdmp",
                  "users_noexpire",
                  "computers_active",
                  "computers_pwdnotreqd"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_2": {
            "type": "field_match",
            "matchers": {
              "Hashes__contains": {
                "field": "Hashes",
                "value": [
                  "IMPHASH=BCA5675746D13A1F246E2DA3C2217492",
                  "IMPHASH=53E117A96057EAF19C41380D0E87F1C2",
                  "IMPHASH=d144de8117df2beceaba2201ad304764",
                  "IMPHASH=12ce1c0f3f5837ecc18a3782408fa975",
                  "IMPHASH=4fbf3f084fbbb2470b80b2013134df35",
                  "IMPHASH=49b639b4acbecc49d72a01f357aa4930",
                  "IMPHASH=680dad9e300346e05a85023965867201",
                  "IMPHASH=21aa085d54992511b9f115355e468782"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_3": {
            "type": "field_match",
            "matchers": {
              "OriginalFileName": {
                "field": "OriginalFileName",
                "value": "AdFind.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\AdFind.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "1 of selection* and not filter",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "1 of selection*"
            },
            {
              "type": "not",
              "value": "filter"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1018",
          "T1087.002",
          "T1482",
          "T1069.002"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-08-21",
        "modified": "2025-02-26",
        "references": [
          "https://www.joeware.net/freetools/tools/adfind/",
          "https://thedfirreport.com/2020/05/08/adfind-recon/",
          "https://thedfirreport.com/2021/01/11/trickbot-still-alive-and-well/",
          "https://www.microsoft.com/security/blog/2021/01/20/deep-dive-into-the-solorigate-second-stage-activation-from-sunburst-to-teardrop-and-raindrop/",
          "https://social.technet.microsoft.com/wiki/contents/articles/7535.adfind-command-examples.aspx",
          "https://github.com/center-for-threat-informed-defense/adversary_emulation_library/blob/bf62ece1c679b07b5fb49c4bae947fe24c81811f/fin6/Emulation_Plan/Phase1.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_renamed_adfind.yml"
      }
    },
    {
      "id": "f576a613-2392-4067-9d1a-9345fb58d8d1",
      "title": "Automated Collection Command Prompt",
      "status": "test",
      "description": "Once established within a system or network, an adversary may use automated techniques for collecting internal data.",
      "level": "medium",
      "tags": [
        "attack.collection",
        "attack.t1119",
        "attack.credential-access",
        "attack.t1552.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_ext": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ".doc",
                  ".docx",
                  ".xls",
                  ".xlsx",
                  ".ppt",
                  ".pptx",
                  ".rtf",
                  ".pdf",
                  ".txt"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_other_dir": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "dir ",
                  " /b ",
                  " /s "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_other_findstr": {
            "type": "field_match",
            "matchers": {
              "OriginalFileName": {
                "field": "OriginalFileName",
                "value": "FINDSTR.EXE",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " /e ",
                  " /si "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_ext and 1 of selection_other_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_ext"
            },
            {
              "type": "ref",
              "value": "1 of selection_other_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1119",
          "T1552.001"
        ],
        "tactics": [
          "collection",
          "credential_access"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-07-28",
        "modified": "2022-11-11",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1119/T1119.md",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1552.001/T1552.001.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_automated_collection.yml"
      }
    },
    {
      "id": "9e716b33-63b2-46da-86a4-bd3c3b9b5dfb",
      "title": "Certificate Exported Via PowerShell",
      "status": "test",
      "description": "Detects calls to cmdlets that are used to export certificates from the local certificate store. Threat actors were seen abusing this to steal private keys from compromised machines.",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.execution",
        "attack.t1552.004",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Export-PfxCertificate ",
                  "Export-Certificate "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1552.004",
          "T1059.001"
        ],
        "tactics": [
          "credential_access",
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-18",
        "modified": "",
        "references": [
          "https://us-cert.cisa.gov/ncas/analysis-reports/ar21-112a",
          "https://learn.microsoft.com/en-us/powershell/module/pki/export-pfxcertificate?view=windowsserver2022-ps",
          "https://www.splunk.com/en_us/blog/security/breaking-the-chain-defending-against-certificate-services-abuse.html"
        ],
        "falsepositives": [
          "Legitimate certificate exports by administrators. Additional filters might be required."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_export_certificate.yml"
      }
    },
    {
      "id": "2cf29f11-e356-4f61-98c0-1bdb9393d6da",
      "title": "Renamed Visual Studio Code Tunnel Execution",
      "status": "test",
      "description": "Detects renamed Visual Studio Code tunnel execution. Attackers can abuse this functionality to establish a C2 channel",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1071.001",
        "attack.t1219"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_image_only_tunnel": {
            "type": "field_match",
            "matchers": {
              "OriginalFileName": {
                "field": "OriginalFileName",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": ".exe tunnel",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_image_tunnel_args": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  ".exe tunnel",
                  "--accept-server-license-terms"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_image_tunnel_service": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "tunnel ",
                  "service",
                  "internal-run",
                  "tunnel-service.log"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_parent_tunnel": {
            "type": "field_match",
            "matchers": {
              "ParentCommandLine__endswith": {
                "field": "ParentCommandLine",
                "value": " tunnel",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\cmd.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/d /c ",
                  "\\servers\\Stable-",
                  "code-server.cmd"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_parent_code": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\code-tunnel.exe",
                  "\\code.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_image_code": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\code-tunnel.exe",
                  "\\code.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "(1 of selection_image_* and not 1 of filter_main_image_*) or (selection_parent_tunnel and not 1 of filter_main_parent_*)",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "(1 of selection_image_* and not 1 of filter_main_image_*)",
            "(selection_parent_tunnel and not 1 of filter_main_parent_*)"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1071.001",
          "T1219"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-09-28",
        "modified": "2025-10-29",
        "references": [
          "https://ipfyx.fr/post/visual-studio-code-tunnel/",
          "https://badoption.eu/blog/2023/01/31/code_c2.html",
          "https://code.visualstudio.com/docs/remote/tunnels"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_vscode_tunnel_renamed_execution.yml"
      }
    },
    {
      "id": "550bbb84-ce5d-4e61-84ad-e590f0024dcd",
      "title": "File Encryption Using Gpg4win",
      "status": "test",
      "description": "Detects usage of Gpg4win to encrypt files",
      "level": "medium",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_metadata": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\gpg.exe",
                      "\\gpg2.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "GnuPG’s OpenPGP tool",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " -c ",
                  "passphrase"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-08-09",
        "modified": "",
        "references": [
          "https://blogs.vmware.com/security/2022/11/batloader-the-evasive-downloader-malware.html",
          "https://www.gpg4win.de/documentation.html",
          "https://news.sophos.com/en-us/2022/01/19/zloader-installs-remote-access-backdoors-and-delivers-cobalt-strike/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_gpg4win_encryption.yml"
      }
    },
    {
      "id": "e13f668e-7f95-443d-98d2-1816a7648a7b",
      "title": "Detected Windows Software Discovery",
      "status": "test",
      "description": "Adversaries may attempt to enumerate software for a variety of reasons, such as figuring out what security measures are present or if the compromised system has a version of software that is vulnerable.",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.t1518"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\reg.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "query",
                  "\\software\\",
                  "/v",
                  "svcversion"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1518"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Nikita Nazarov, oscd.community",
        "date": "2020-10-16",
        "modified": "2022-10-09",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1518/T1518.md",
          "https://github.com/harleyQu1nn/AggressorScripts"
        ],
        "falsepositives": [
          "Legitimate administration activities"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_reg_software_discovery.yml"
      }
    },
    {
      "id": "c2c76b77-32be-4d1f-82c9-7e544bdfe0eb",
      "title": "Potential Suspicious Activity Using SeCEdit",
      "status": "test",
      "description": "Detects potential suspicious behaviour using secedit.exe. Such as exporting or modifying the security policy",
      "level": "medium",
      "tags": [
        "attack.collection",
        "attack.discovery",
        "attack.persistence",
        "attack.defense-evasion",
        "attack.credential-access",
        "attack.privilege-escalation",
        "attack.t1562.002",
        "attack.t1547.001",
        "attack.t1505.005",
        "attack.t1556.002",
        "attack.t1562",
        "attack.t1574.007",
        "attack.t1564.002",
        "attack.t1546.008",
        "attack.t1546.007",
        "attack.t1547.014",
        "attack.t1547.010",
        "attack.t1547.002",
        "attack.t1557",
        "attack.t1082"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\secedit.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "SeCEdit",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_flags_discovery": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/export",
                  "/cfg"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_flags_configure": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/configure",
                  "/db"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_img and (1 of selection_flags_*)",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_img"
            },
            {
              "type": "ref",
              "value": "(1 of selection_flags_*)"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1562.002",
          "T1547.001",
          "T1505.005",
          "T1556.002",
          "T1562",
          "T1574.007",
          "T1564.002",
          "T1546.008",
          "T1546.007",
          "T1547.014",
          "T1547.010",
          "T1547.002",
          "T1557",
          "T1082"
        ],
        "tactics": [
          "collection",
          "discovery",
          "persistence",
          "defense_evasion",
          "credential_access",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Janantha Marasinghe",
        "date": "2022-11-18",
        "modified": "2022-12-30",
        "references": [
          "https://blueteamops.medium.com/secedit-and-i-know-it-595056dee53d",
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/secedit"
        ],
        "falsepositives": [
          "Legitimate administrative use"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_secedit_execution.yml"
      }
    },
    {
      "id": "05b2aa93-1210-42c8-8d9a-2fcc13b284f5",
      "title": "Service Registry Key Deleted Via Reg.EXE",
      "status": "test",
      "description": "Detects execution of \"reg.exe\" commands with the \"delete\" flag on services registry key. Often used by attacker to remove AV software services",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "reg.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "reg.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_delete": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " delete ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_key": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "\\SYSTEM\\CurrentControlSet\\services\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-01",
        "modified": "2023-02-04",
        "references": [
          "https://www.virustotal.com/gui/file/2bcd5702a7565952c44075ac6fb946c7780526640d1264f692c7664c02c68465"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_reg_delete_services.yml"
      }
    },
    {
      "id": "bdeeabc9-ff2a-4a51-be59-bb253aac7891",
      "title": "PUA - Wsudo Suspicious Execution",
      "status": "test",
      "description": "Detects usage of wsudo (Windows Sudo Utility). Which is a tool that let the user execute programs with different permissions (System, Trusted Installer, Administrator...etc)",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.privilege-escalation",
        "attack.t1059"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_metadata": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\wsudo.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "wsudo.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "Windows sudo utility",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "ParentImage__endswith": {
                    "field": "ParentImage",
                    "value": "\\wsudo-bridge.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "-u System",
                  "-uSystem",
                  "-u TrustedInstaller",
                  "-uTrustedInstaller",
                  " --ti "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059"
        ],
        "tactics": [
          "execution",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-12-02",
        "modified": "2023-02-14",
        "references": [
          "https://github.com/M2Team/Privexec/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_wsudo_susp_execution.yml"
      }
    },
    {
      "id": "cea72823-df4d-4567-950c-0b579eaf0846",
      "title": "Potential Dropper Script Execution Via WScript/CScript",
      "status": "test",
      "description": "Detects wscript/cscript executions of scripts located in user directories",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059.005",
        "attack.t1059.007"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_exec": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\wscript.exe",
                  "\\cscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_paths": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ":\\Temp\\",
                  ":\\Tmp\\",
                  ":\\Users\\Public\\",
                  ":\\Windows\\Temp\\",
                  "\\AppData\\Local\\Temp\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_ext": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ".js",
                  ".jse",
                  ".vba",
                  ".vbe",
                  ".vbs",
                  ".wsf"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.005",
          "T1059.007"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Margaritis Dimitrios (idea), Florian Roth (Nextron Systems), oscd.community, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2019-01-16",
        "modified": "2024-01-30",
        "references": [
          "https://thedfirreport.com/2023/10/30/netsupport-intrusion-results-in-domain-compromise/",
          "https://redcanary.com/blog/gootloader/"
        ],
        "falsepositives": [
          "Some installers might generate a similar behavior. An initial baseline is required"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wscript_cscript_dropper.yml"
      }
    },
    {
      "id": "24c8392b-aa3c-46b7-a545-43f71657fe98",
      "title": "Suspicious Schtasks Schedule Types",
      "status": "test",
      "description": "Detects scheduled task creations or modification on a suspicious schedule type",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.execution",
        "attack.t1053.005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\schtasks.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "schtasks.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_time": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " ONLOGON ",
                  " ONSTART ",
                  " ONCE ",
                  " ONIDLE "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_privs": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "NT AUT",
                  " SYSTEM",
                  "HIGHEST"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_"
        }
      },
      "mitre": {
        "techniques": [
          "T1053.005"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-09-09",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/schtasks-change",
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/schtasks-create",
          "http://blog.talosintelligence.com/2022/09/lazarus-three-rats.html"
        ],
        "falsepositives": [
          "Legitimate processes that run at logon. Filter according to your environment"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_schtasks_schedule_type.yml"
      }
    },
    {
      "id": "6bd75993-9888-4f91-9404-e1e4e4e34b77",
      "title": "HackTool - LocalPotato Execution",
      "status": "test",
      "description": "Detects the execution of the LocalPotato POC based on basic PE metadata information and default CLI examples",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "cve.2023-21746"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\LocalPotato.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  ".exe -i C:\\",
                  "-o Windows\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_hash_plain": {
            "type": "field_match",
            "matchers": {
              "Hashes__contains": {
                "field": "Hashes",
                "value": [
                  "IMPHASH=E1742EE971D6549E8D4D81115F88F1FC",
                  "IMPHASH=DD82066EFBA94D7556EF582F247C8BB5"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-02-14",
        "modified": "2024-11-23",
        "references": [
          "https://www.localpotato.com/localpotato_html/LocalPotato.html",
          "https://github.com/decoder-it/LocalPotato"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_localpotato.yml"
      }
    },
    {
      "id": "32e280f1-8ad4-46ef-9e80-910657611fbc",
      "title": "Potential Homoglyph Attack Using Lookalike Characters",
      "status": "test",
      "description": "Detects the presence of unicode characters which are homoglyphs, or identical in appearance, to ASCII letter characters.\nThis is used as an obfuscation and masquerading techniques. Only \"perfect\" homoglyphs are included; these are characters that\nare indistinguishable from ASCII characters and thus may make excellent candidates for homoglyph attack characters.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036",
        "attack.t1036.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_upper": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "А",
                  "В",
                  "Е",
                  "К",
                  "М",
                  "Н",
                  "О",
                  "Р",
                  "С",
                  "Т",
                  "Х",
                  "Ѕ",
                  "І",
                  "Ј",
                  "Ү",
                  "Ӏ",
                  "Ԍ",
                  "Ԛ",
                  "Ԝ",
                  "Α",
                  "Β",
                  "Ε",
                  "Ζ",
                  "Η",
                  "Ι",
                  "Κ",
                  "Μ",
                  "Ν",
                  "Ο",
                  "Ρ",
                  "Τ",
                  "Υ",
                  "Χ"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_lower": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "а",
                  "е",
                  "о",
                  "р",
                  "с",
                  "х",
                  "ѕ",
                  "і",
                  "ӏ",
                  "ј",
                  "һ",
                  "ԁ",
                  "ԛ",
                  "ԝ",
                  "ο"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1036",
          "T1036.003"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Micah Babinski, @micahbabinski",
        "date": "2023-05-07",
        "modified": "",
        "references": [
          "https://redcanary.com/threat-detection-report/threats/socgholish/#threat-socgholish",
          "http://www.irongeek.com/homoglyph-attack-generator.php"
        ],
        "falsepositives": [
          "Commandlines with legitimate Cyrillic text; will likely require tuning (or not be usable) in countries where these alphabets are in use."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_homoglyph_cyrillic_lookalikes.yml"
      }
    },
    {
      "id": "7d6d30b8-5b91-4b90-a891-46cccaf29598",
      "title": "Program Executed Using Proxy/Local Command Via SSH.EXE",
      "status": "test",
      "description": "Detect usage of the \"ssh.exe\" binary as a proxy to launch other programs.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": "C:\\Windows\\System32\\OpenSSH\\sshd.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\ssh.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Product": {
                    "field": "Product",
                    "value": "OpenSSH for Windows",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Hashes__contains": {
                    "field": "Hashes",
                    "value": [
                      "IMPHASH=55b4964d29aad5438b9e950052dbbbc0",
                      "IMPHASH=334d66c33503ccbf647c15b47c27eef4",
                      "IMPHASH=27b0da080ef92afb37983d30d839141e",
                      "IMPHASH=977eb4c263d384e47daa0712d34713ab",
                      "IMPHASH=3eaadce9ae43d5a918bb082065815c3b",
                      "IMPHASH=980fe6cf0d996ab1eedf877222e722aa",
                      "IMPHASH=5f959422308ac3d721010d66647e100e",
                      "IMPHASH=a49aaa3d03d1cd9c8dc7fca60f7f480b",
                      "IMPHASH=dd335f759b6d5d6a8382b71dd9d65791"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_flags": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": "ProxyCommand=",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "PermitLocalCommand=yes",
                      " LocalCommand"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection_parent or all of selection_cli_*",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection_parent",
            "all of selection_cli_*"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113, Nasreddine Bencherchali",
        "date": "2022-12-29",
        "modified": "2025-10-16",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Ssh/",
          "https://github.com/LOLBAS-Project/LOLBAS/pull/211/files",
          "https://gtfobins.github.io/gtfobins/ssh/",
          "https://man.openbsd.org/ssh_config#ProxyCommand",
          "https://man.openbsd.org/ssh_config#LocalCommand"
        ],
        "falsepositives": [
          "Legitimate usage for administration purposes"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_ssh_proxy_execution.yml"
      }
    },
    {
      "id": "9cfc00b6-bfb7-49ce-9781-ef78503154bb",
      "title": "Wlrmdr.EXE Uncommon Argument Or Child Process",
      "status": "experimental",
      "description": "Detects the execution of \"Wlrmdr.exe\" with the \"-u\" command line flag which allows anything passed to it to be an argument of the ShellExecute API, which would allow an attacker to execute arbitrary binaries.\nThis detection also focuses on any uncommon child processes spawned from \"Wlrmdr.exe\" as a supplement for those that posses \"ParentImage\" telemetry.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\wlrmdr.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_child_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\wlrmdr.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "WLRMNDR.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_child_cli_flags_s": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-s ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_child_cli_flags_f": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-f ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_child_cli_flags_t": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-t ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_child_cli_flags_m": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-m ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_child_cli_flags_a": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-a ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_child_cli_flags_u": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-u ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_winlogon": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": "C:\\Windows\\System32\\winlogon.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_empty": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": [
                  "",
                  "-"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_null": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection_parent or (all of selection_child_* and not 1 of filter_main_*)",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection_parent",
            "(all of selection_child_* and not 1 of filter_main_*)"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113, manasmbellani",
        "date": "2022-02-16",
        "modified": "2025-10-31",
        "references": [
          "https://twitter.com/0gtweet/status/1493963591745220608?s=20&t=xUg9DsZhJy1q9bPTUWgeIQ",
          "https://lolbas-project.github.io/lolbas/Binaries/Wlrmdr/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wlrmdr_uncommon_child_process.yml"
      }
    },
    {
      "id": "3bad990e-4848-4a78-9530-b427d854aac0",
      "title": "Domain Trust Discovery Via Dsquery",
      "status": "test",
      "description": "Detects execution of \"dsquery.exe\" for domain trust discovery",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.t1482"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\dsquery.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "dsquery.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "trustedDomain",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1482"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "E.M. Anhaus, Tony Lambert, oscd.community, omkar72",
        "date": "2019-10-24",
        "modified": "2023-02-02",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1482/T1482.md",
          "https://posts.specterops.io/an-introduction-to-manual-active-directory-querying-with-dsquery-and-ldapsearch-84943c13d7eb?gi=41b97a644843"
        ],
        "falsepositives": [
          "Legitimate use of the utilities by legitimate user for legitimate reason"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_dsquery_domain_trust_discovery.yml"
      }
    },
    {
      "id": "1c0e41cd-21bb-4433-9acc-4a2cd6367b9b",
      "title": "Suspicious Modification Of Scheduled Tasks",
      "status": "test",
      "description": "Detects when an attacker tries to modify an already existing scheduled tasks to run from a suspicious location\nAttackers can create a simple looking task in order to avoid detection on creation as it's often the most focused on\nInstead they modify the task after creation to include their malicious payload\n",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.execution",
        "attack.t1053.005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_schtasks": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\schtasks.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " /Change ",
                  " /TN "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_susp_locations": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\AppData\\Local\\Temp",
                  "\\AppData\\Roaming\\",
                  "\\Users\\Public\\",
                  "\\WINDOWS\\Temp\\",
                  "\\Desktop\\",
                  "\\Downloads\\",
                  "\\Temporary Internet",
                  "C:\\ProgramData\\",
                  "C:\\Perflogs\\",
                  "%ProgramData%",
                  "%appdata%",
                  "%comspec%",
                  "%localappdata%"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_susp_images": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "regsvr32",
                  "rundll32",
                  "cmd /c ",
                  "cmd /k ",
                  "cmd /r ",
                  "cmd.exe /c ",
                  "cmd.exe /k ",
                  "cmd.exe /r ",
                  "powershell",
                  "mshta",
                  "wscript",
                  "cscript",
                  "certutil",
                  "bitsadmin",
                  "bash.exe",
                  "bash ",
                  "scrcons",
                  "wmic ",
                  "wmic.exe",
                  "forfiles",
                  "scriptrunner",
                  "hh.exe",
                  "hh "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1053.005"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-07-28",
        "modified": "2022-11-18",
        "references": [
          "Internal Research",
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/schtasks"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_schtasks_change.yml"
      }
    },
    {
      "id": "10fb649c-3600-4d37-b1e6-56ea90bb7e09",
      "title": "User Added To Highly Privileged Group",
      "status": "test",
      "description": "Detects addition of users to highly privileged groups via \"Net\" or \"Add-LocalGroupMember\".",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1098"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_main": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "localgroup ",
                      " /add"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "Add-LocalGroupMember ",
                      " -Group "
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_group": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Group Policy Creator Owners",
                  "Schema Admins"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1098"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2024-02-23",
        "modified": "",
        "references": [
          "https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708"
        ],
        "falsepositives": [
          "Administrative activity that must be investigated"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_add_user_privileged_group.yml"
      }
    },
    {
      "id": "74a12f18-505c-4114-8d0b-8448dd5485c6",
      "title": "PUA - Nimgrab Execution",
      "status": "test",
      "description": "Detects the usage of nimgrab, a tool bundled with the Nim programming framework and used for downloading files.",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1105"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_name": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\nimgrab.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_hashes": {
            "type": "field_match",
            "matchers": {
              "Hashes__contains": {
                "field": "Hashes",
                "value": [
                  "MD5=2DD44C3C29D667F5C0EF5F9D7C7FFB8B",
                  "SHA256=F266609E91985F0FE3E31C5E8FAEEEC4FFA5E0322D8B6F15FE69F4C5165B9559",
                  "IMPHASH=C07FDDD21D123EA9B3A08EEF44AAAC45"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1105"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-08-28",
        "modified": "2024-11-23",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/28d190330fe44de6ff4767fc400cc10fa7cd6540/atomics/T1105/T1105.md"
        ],
        "falsepositives": [
          "Legitimate use of Nim on a developer systems"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_nimgrab.yml"
      }
    },
    {
      "id": "730fc21b-eaff-474b-ad23-90fd265d4988",
      "title": "Psexec Execution",
      "status": "test",
      "description": "Detects user accept agreement execution in psexec commandline",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.lateral-movement",
        "attack.t1569",
        "attack.t1021"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\psexec.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "psexec.c",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1569",
          "T1021"
        ],
        "tactics": [
          "execution",
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "omkar72",
        "date": "2020-10-30",
        "modified": "2023-02-28",
        "references": [
          "https://www.fireeye.com/blog/threat-research/2020/10/kegtap-and-singlemalt-with-a-ransomware-chaser.html"
        ],
        "falsepositives": [
          "Administrative scripts."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sysinternals_psexec_execution.yml"
      }
    },
    {
      "id": "bbc865e4-7fcd-45a6-8ff1-95ced28ec5b2",
      "title": "NtdllPipe Like Activity Execution",
      "status": "test",
      "description": "Detects command that type the content of ntdll.dll to a different file or a pipe in order to evade AV / EDR detection. As seen being used in the POC NtdllPipe",
      "level": "high",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "type %windir%\\system32\\ntdll.dll",
                  "type %systemroot%\\system32\\ntdll.dll",
                  "type c:\\windows\\system32\\ntdll.dll",
                  "\\\\ntdll.dll > \\\\\\\\.\\\\pipe\\\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-03-05",
        "modified": "2023-03-07",
        "references": [
          "https://web.archive.org/web/20220306121156/https://www.x86matthew.com/view_post?id=ntdll_pipe"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_cmd_ntdllpipe_redirect.yml"
      }
    },
    {
      "id": "3b4e950b-a3ea-44d3-877e-432071990709",
      "title": "Notepad Password Files Discovery",
      "status": "experimental",
      "description": "Detects the execution of Notepad to open a file that has the string \"password\" which may indicate unauthorized access to credentials or suspicious activity.",
      "level": "low",
      "tags": [
        "attack.discovery",
        "attack.t1083"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\explorer.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\notepad.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": [
                  "password*.txt",
                  "password*.csv",
                  "password*.doc",
                  "password*.xls"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1083"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "The DFIR Report",
        "date": "2025-02-21",
        "modified": "",
        "references": [
          "https://thedfirreport.com/2025/02/24/confluence-exploit-leads-to-lockbit-ransomware/",
          "https://intel.thedfirreport.com/eventReports/view/57"
        ],
        "falsepositives": [
          "Legitimate use of opening files from remote hosts by administrators or users. However, storing passwords in text readable format could potentially be a violation of the organization's policy. Any match should be investigated further."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_notepad_local_passwd_discovery.yml"
      }
    },
    {
      "id": "c11aecef-9c37-45a6-9c07-bc0782f963fd",
      "title": "RunMRU Registry Key Deletion",
      "status": "experimental",
      "description": "Detects deletion of the RunMRU registry key, which stores the history of commands executed via the Run dialog.\nIn the clickfix techniques, the phishing lures instruct users to open a run dialog through (Win + R) and execute malicious commands.\nAdversaries may delete this key to cover their tracks after executing commands.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1070.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\reg.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "reg.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " del",
                  "\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RunMRU"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1070.003"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-09-25",
        "modified": "",
        "references": [
          "https://www.zscaler.com/blogs/security-research/coldriver-updates-arsenal-baitswitch-and-simplefix"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_reg_delete_runmru.yml"
      }
    },
    {
      "id": "b52e84a3-029e-4529-b09b-71d19dd27e94",
      "title": "Remote Access Tool - AnyDesk Execution",
      "status": "test",
      "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1219.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\AnyDesk.exe",
                      "\\AnyDeskMSI.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "AnyDesk",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Product": {
                    "field": "Product",
                    "value": "AnyDesk",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Company": {
                    "field": "Company",
                    "value": "AnyDesk Software GmbH",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1219.002"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-02-11",
        "modified": "2025-02-24",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-2---anydesk-files-detected-test-on-windows",
          "https://thedfirreport.com/2025/02/24/confluence-exploit-leads-to-lockbit-ransomware/"
        ],
        "falsepositives": [
          "Legitimate use"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_remote_access_tools_anydesk.yml"
      }
    },
    {
      "id": "cc1abf27-78a3-4ac5-a51c-f3070b1d8e40",
      "title": "Registry Export of Third-Party Credentials",
      "status": "experimental",
      "description": "Detects the use of reg.exe to export registry paths associated with third-party credentials.\nCredential stealers have been known to use this technique to extract sensitive information from the registry.\n",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1552.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\reg.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "reg.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_save": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "save",
                  "export"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_path": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\Software\\Aerofox\\Foxmail\\V3.1",
                  "\\Software\\Aerofox\\FoxmailPreview",
                  "\\Software\\DownloadManager\\Passwords",
                  "\\Software\\FTPWare\\COREFTP\\Sites",
                  "\\Software\\IncrediMail\\Identities",
                  "\\Software\\Martin Prikryl\\WinSCP 2\\Sessions",
                  "\\Software\\Mobatek\\MobaXterm",
                  "\\Software\\OpenSSH\\Agent\\Keys",
                  "\\Software\\OpenVPN-GUI\\configs",
                  "\\Software\\ORL\\WinVNC3\\Password",
                  "\\Software\\Qualcomm\\Eudora\\CommandLine",
                  "\\Software\\RealVNC\\WinVNC4",
                  "\\Software\\RimArts\\B2\\Settings",
                  "\\Software\\SimonTatham\\PuTTY\\Sessions",
                  "\\Software\\SimonTatham\\PuTTY\\SshHostKeys",
                  "\\Software\\Sota\\FFFTP",
                  "\\Software\\TightVNC\\Server",
                  "\\Software\\WOW6432Node\\Radmin\\v3.0\\Server\\Parameters\\Radmin"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1552.002"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-05-22",
        "modified": "",
        "references": [
          "https://www.virustotal.com/gui/file/fdc86a5b3d7df37a72c3272836f743747c47bfbc538f05af9ecf78547fa2e789/behavior"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_registry_export_of_thirdparty_creds.yml"
      }
    },
    {
      "id": "b222df08-0e07-11eb-adc1-0242ac120002",
      "title": "Invoke-Obfuscation CLIP+ Launcher",
      "status": "test",
      "description": "Detects Obfuscated use of Clip.exe to execute PowerShell",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027",
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "cmd",
                  "&&",
                  "clipboard]::",
                  "-f"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "/c",
                  "/r"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1027",
          "T1059.001"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Jonathan Cheong, oscd.community",
        "date": "2020-10-13",
        "modified": "2022-11-17",
        "references": [
          "https://github.com/SigmaHQ/sigma/issues/1009"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_invoke_obfuscation_clip.yml"
      }
    },
    {
      "id": "15c7904e-6ad1-4a45-9b46-5fb25df37fd2",
      "title": "Malicious PE Execution by Microsoft Visual Studio Debugger",
      "status": "test",
      "description": "There is an option for a MS VS Just-In-Time Debugger \"vsjitdebugger.exe\" to launch specified executable and attach a debugger.\nThis option may be used adversaries to execute malicious code by signed verified binary.\nThe debugger is installed alongside with Microsoft Visual Studio package.\n",
      "level": "medium",
      "tags": [
        "attack.t1218",
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\vsjitdebugger.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "reduction1": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\vsimmersiveactivatehelper*.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "reduction2": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\devenv.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection and not (reduction1 or reduction2)",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection and not (reduction1",
            "reduction2)"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Agro (@agro_sev), Ensar Şamil (@sblmsrsn), oscd.community",
        "date": "2020-10-14",
        "modified": "2022-10-09",
        "references": [
          "https://twitter.com/pabraeken/status/990758590020452353",
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Vsjitdebugger/",
          "https://learn.microsoft.com/en-us/visualstudio/debugger/debug-using-the-just-in-time-debugger?view=vs-2019"
        ],
        "falsepositives": [
          "The process spawned by vsjitdebugger.exe is uncommon."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_use_of_vsjitdebugger_bin.yml"
      }
    },
    {
      "id": "90fb5e62-ca1f-4e22-b42e-cc521874c938",
      "title": "Suspicious Shells Spawn by Java Utility Keytool",
      "status": "test",
      "description": "Detects suspicious shell spawn from Java utility keytool process (e.g. adselfservice plus exploitation)",
      "level": "high",
      "tags": [
        "attack.initial-access",
        "attack.persistence",
        "attack.privilege-escalation"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\keytool.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\cmd.exe",
                  "\\sh.exe",
                  "\\bash.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\schtasks.exe",
                  "\\certutil.exe",
                  "\\whoami.exe",
                  "\\bitsadmin.exe",
                  "\\wscript.exe",
                  "\\cscript.exe",
                  "\\scrcons.exe",
                  "\\regsvr32.exe",
                  "\\hh.exe",
                  "\\wmic.exe",
                  "\\mshta.exe",
                  "\\rundll32.exe",
                  "\\forfiles.exe",
                  "\\scriptrunner.exe",
                  "\\mftrace.exe",
                  "\\AppVLP.exe",
                  "\\systeminfo.exe",
                  "\\reg.exe",
                  "\\query.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "initial_access",
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Andreas Hunkeler (@Karneades)",
        "date": "2021-12-22",
        "modified": "2023-01-21",
        "references": [
          "https://redcanary.com/blog/intelligence-insights-december-2021",
          "https://www.synacktiv.com/en/publications/how-to-exploit-cve-2021-40539-on-manageengine-adselfservice-plus.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_java_keytool_susp_child_process.yml"
      }
    },
    {
      "id": "146aace8-9bd6-42ba-be7a-0070d8027b76",
      "title": "Potentially Suspicious Child Process Of WinRAR.EXE",
      "status": "test",
      "description": "Detects potentially suspicious child processes of WinRAR.exe.",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1203"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\WinRAR.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_binaries": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\cmd.exe",
                      "\\cscript.exe",
                      "\\mshta.exe",
                      "\\powershell.exe",
                      "\\pwsh.exe",
                      "\\regsvr32.exe",
                      "\\rundll32.exe",
                      "\\wscript.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "Cmd.Exe",
                      "cscript.exe",
                      "mshta.exe",
                      "PowerShell.EXE",
                      "pwsh.dll",
                      "regsvr32.exe",
                      "RUNDLL32.EXE",
                      "wscript.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1203"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-08-31",
        "modified": "",
        "references": [
          "https://www.group-ib.com/blog/cve-2023-38831-winrar-zero-day/",
          "https://github.com/knight0x07/WinRAR-Code-Execution-Vulnerability-CVE-2023-38831/blob/26ab6c40b6d2c09bb4fc60feaa4a3a90cfd20c23/Part-1-Overview.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_winrar_susp_child_process.yml"
      }
    },
    {
      "id": "2c28c248-7f50-417a-9186-a85b223010ee",
      "title": "Wscript Shell Run In CommandLine",
      "status": "test",
      "description": "Detects the presence of the keywords \"Wscript\", \"Shell\" and \"Run\" in the command, which could indicate a suspicious activity",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "Wscript.",
                  ".Shell",
                  ".Run"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-31",
        "modified": "2023-05-15",
        "references": [
          "https://web.archive.org/web/20220830122045/http://blog.talosintelligence.com/2022/08/modernloader-delivers-multiple-stealers.html",
          "https://blog.talosintelligence.com/modernloader-delivers-multiple-stealers-cryptominers-and-rats/"
        ],
        "falsepositives": [
          "Inline scripting can be used by some rare third party applications or administrators. Investigate and apply additional filters accordingly"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_mshta_inline_vbscript.yml"
      }
    },
    {
      "id": "30edb182-aa75-42c0-b0a9-e998bb29067c",
      "title": "Potential AMSI Bypass Via .NET Reflection",
      "status": "test",
      "description": "Detects Request to \"amsiInitFailed\" that can be used to disable AMSI Scanning",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "System.Management.Automation.AmsiUtils",
                      "amsiInitFailed"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "[Ref].Assembly.GetType",
                      "SetValue($null,$true)",
                      "NonPublic,Static"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Markus Neis, @Kostastsale",
        "date": "2018-08-17",
        "modified": "2023-02-03",
        "references": [
          "https://s3cur3th1ssh1t.github.io/Bypass_AMSI_by_manual_modification/",
          "https://www.mdsec.co.uk/2018/06/exploring-powershell-amsi-and-logging-evasion/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_amsi_init_failed_bypass.yml"
      }
    },
    {
      "id": "1775e15e-b61b-4d14-a1a3-80981298085a",
      "title": "Rundll32 Execution Without CommandLine Parameters",
      "status": "test",
      "description": "Detects suspicious start of rundll32.exe without any parameters as found in CobaltStrike beacon activity",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1202"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": [
                  "\\rundll32.exe",
                  "\\rundll32.exe\"",
                  "\\rundll32"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "ParentImage__contains": {
                "field": "ParentImage",
                "value": [
                  "\\AppData\\Local\\",
                  "\\Microsoft\\Edge\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1202"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-05-27",
        "modified": "2023-08-31",
        "references": [
          "https://www.cobaltstrike.com/help-opsec",
          "https://twitter.com/ber_m1ng/status/1397948048135778309"
        ],
        "falsepositives": [
          "Possible but rare"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_rundll32_no_params.yml"
      }
    },
    {
      "id": "aaafa146-074c-11eb-adc1-0242ac120002",
      "title": "HackTool - Hydra Password Bruteforce Execution",
      "status": "test",
      "description": "Detects command line parameters used by Hydra password guessing hack tool",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1110",
        "attack.t1110.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "-u ",
                  "-p "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "^USER^",
                  "^PASS^"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1110",
          "T1110.001"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Vasiliy Burov",
        "date": "2020-10-05",
        "modified": "2023-02-04",
        "references": [
          "https://github.com/vanhauser-thc/thc-hydra"
        ],
        "falsepositives": [
          "Software that uses the caret encased keywords PASS and USER in its command line"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_hydra.yml"
      }
    },
    {
      "id": "95eadcb2-92e4-4ed1-9031-92547773a6db",
      "title": "Suspicious PowerShell Invocation From Script Engines",
      "status": "test",
      "description": "Detects suspicious powershell invocations from interpreters or unusual programs",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\wscript.exe",
                  "\\cscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\powershell.exe",
                  "\\pwsh.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_health_service": {
            "type": "field_match",
            "matchers": {
              "CurrentDirectory__contains": {
                "field": "CurrentDirectory",
                "value": "\\Health Service State\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2019-01-16",
        "modified": "2023-01-05",
        "references": [
          "https://www.securitynewspaper.com/2017/03/20/attackers-leverage-excel-powershell-dns-latest-non-malware-attack/"
        ],
        "falsepositives": [
          "Microsoft Operations Manager (MOM)",
          "Other scripts"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_script_engine_parent.yml"
      }
    },
    {
      "id": "087790e3-3287-436c-bccf-cbd0184a7db1",
      "title": "Potential CommandLine Path Traversal Via Cmd.EXE",
      "status": "test",
      "description": "Detects potential path traversal attempt via cmd.exe. Could indicate possible command/argument confusion/hijacking",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "ParentImage__endswith": {
                    "field": "ParentImage",
                    "value": "\\cmd.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\cmd.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "cmd.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_flags": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "ParentCommandLine__contains": {
                    "field": "ParentCommandLine",
                    "value": [
                      "/c",
                      "/k",
                      "/r"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      "/c",
                      "/k",
                      "/r"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_path_traversal": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "ParentCommandLine": {
                    "field": "ParentCommandLine",
                    "value": "/../../",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": "/../../",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_java": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "\\Tasktop\\keycloak\\bin\\/../../jre\\bin\\java",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.003"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "xknow @xknow_infosec, Tim Shelton",
        "date": "2020-06-11",
        "modified": "2023-03-06",
        "references": [
          "https://hackingiscool.pl/cmdhijack-command-argument-confusion-with-path-traversal-in-cmd-exe/",
          "https://twitter.com/Oddvarmoe/status/1270633613449723905"
        ],
        "falsepositives": [
          "Java tools are known to produce false-positive when loading libraries"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_cmd_path_traversal.yml"
      }
    },
    {
      "id": "eb2d07d4-49cb-4523-801a-da002df36602",
      "title": "HackTool - EDRSilencer Execution",
      "status": "test",
      "description": "Detects the execution of EDRSilencer, a tool that leverages Windows Filtering Platform (WFP) to block Endpoint Detection and Response (EDR) agents from reporting security events to the server based on PE metadata information.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\EDRSilencer.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "EDRSilencer.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description__contains": {
                    "field": "Description",
                    "value": "EDRSilencer",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "@gott_cyber",
        "date": "2024-01-02",
        "modified": "",
        "references": [
          "https://github.com/netero1010/EDRSilencer"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_edrsilencer.yml"
      }
    },
    {
      "id": "bb58aa4a-b80b-415a-a2c0-2f65a4c81009",
      "title": "Suspicious Desktopimgdownldr Command",
      "status": "test",
      "description": "Detects a suspicious Microsoft desktopimgdownldr execution with parameters used to download files from the Internet",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1105"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " /lockscreenurl:",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection1_filter": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ".jpg",
                  ".jpeg",
                  ".png"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_reg": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "reg delete",
                  "\\PersonalizationCSP"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "( selection1 and not selection1_filter ) or selection_reg",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "( selection1 and not selection1_filter )",
            "selection_reg"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1105"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2020-07-03",
        "modified": "2021-11-27",
        "references": [
          "https://labs.sentinelone.com/living-off-windows-land-a-new-native-file-downldr/",
          "https://twitter.com/SBousseaden/status/1278977301745741825"
        ],
        "falsepositives": [
          "False positives depend on scripts and administrative tools used in the monitored environment"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_desktopimgdownldr_susp_execution.yml"
      }
    },
    {
      "id": "69bd9b97-2be2-41b6-9816-fb08757a4d1a",
      "title": "Potentially Suspicious Execution From Parent Process In Public Folder",
      "status": "test",
      "description": "Detects a potentially suspicious execution of a parent process located in the \"\\Users\\Public\" folder executing a child process containing references to shell or scripting binaries and commandlines.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.execution",
        "attack.t1564",
        "attack.t1059"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__contains": {
                "field": "ParentImage",
                "value": ":\\Users\\Public\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_child": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\bitsadmin.exe",
                      "\\certutil.exe",
                      "\\cmd.exe",
                      "\\cscript.exe",
                      "\\mshta.exe",
                      "\\powershell.exe",
                      "\\pwsh.exe",
                      "\\regsvr32.exe",
                      "\\rundll32.exe",
                      "\\wscript.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      "bitsadmin",
                      "certutil",
                      "cscript",
                      "mshta",
                      "powershell",
                      "regsvr32",
                      "rundll32",
                      "wscript"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1564",
          "T1059"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-02-25",
        "modified": "2024-07-12",
        "references": [
          "https://redcanary.com/blog/blackbyte-ransomware/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_execution_from_public_folder_as_parent.yml"
      }
    },
    {
      "id": "6f4191bb-912b-48a8-9ce7-682769541e6d",
      "title": "Suspicious Msiexec Execute Arbitrary DLL",
      "status": "test",
      "description": "Adversaries may abuse msiexec.exe to proxy execution of malicious payloads.\nMsiexec.exe is the command-line utility for the Windows Installer and is thus commonly associated with executing installation packages (.msi)\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.007"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\msiexec.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -y",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_apple": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\MsiExec.exe\" /Y \"C:\\Program Files\\Bonjour\\mdnsNSP.dll",
                  "\\MsiExec.exe\" /Y \"C:\\Program Files (x86)\\Bonjour\\mdnsNSP.dll",
                  "\\MsiExec.exe\" /Y \"C:\\Program Files (x86)\\Apple Software Update\\ScriptingObjectModel.dll",
                  "\\MsiExec.exe\" /Y \"C:\\Program Files (x86)\\Apple Software Update\\SoftwareUpdateAdmin.dll",
                  "\\MsiExec.exe\" /Y \"C:\\Windows\\CCM\\",
                  "\\MsiExec.exe\" /Y C:\\Windows\\CCM\\",
                  "\\MsiExec.exe\" -Y \"C:\\Program Files\\Bonjour\\mdnsNSP.dll",
                  "\\MsiExec.exe\" -Y \"C:\\Program Files (x86)\\Bonjour\\mdnsNSP.dll",
                  "\\MsiExec.exe\" -Y \"C:\\Program Files (x86)\\Apple Software Update\\ScriptingObjectModel.dll",
                  "\\MsiExec.exe\" -Y \"C:\\Program Files (x86)\\Apple Software Update\\SoftwareUpdateAdmin.dll",
                  "\\MsiExec.exe\" -Y \"C:\\Windows\\CCM\\",
                  "\\MsiExec.exe\" -Y C:\\Windows\\CCM\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218.007"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-16",
        "modified": "2024-03-13",
        "references": [
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/msiexec",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1218.007/T1218.007.md",
          "https://twitter.com/_st0pp3r_/status/1583914515996897281"
        ],
        "falsepositives": [
          "Legitimate script"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_msiexec_execute_dll.yml"
      }
    },
    {
      "id": "39ed3c80-e6a1-431b-9df3-911ac53d08a7",
      "title": "UAC Bypass Using NTFS Reparse Point - Process",
      "status": "test",
      "description": "Detects the pattern of UAC Bypass using NTFS reparse point and wusa.exe DLL hijacking (UACMe 36)",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__startswith": {
                "field": "CommandLine",
                "value": "\"C:\\Windows\\system32\\wusa.exe\"  /quiet C:\\Users\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": "\\AppData\\Local\\Temp\\update.msu",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "IntegrityLevel": {
                "field": "IntegrityLevel",
                "value": [
                  "High",
                  "System",
                  "S-1-16-16384",
                  "S-1-16-12288"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection2": {
            "type": "field_match",
            "matchers": {
              "ParentCommandLine": {
                "field": "ParentCommandLine",
                "value": "\"C:\\Windows\\system32\\dism.exe\" /online /quiet /norestart /add-package /packagepath:\"C:\\Windows\\system32\\pe386\" /ignorecheck",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "IntegrityLevel": {
                "field": "IntegrityLevel",
                "value": [
                  "High",
                  "System"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "C:\\Users\\",
                  "\\AppData\\Local\\Temp\\",
                  "\\dismhost.exe {"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\DismHost.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Christian Burkard (Nextron Systems)",
        "date": "2021-08-30",
        "modified": "2024-12-01",
        "references": [
          "https://github.com/hfiref0x/UACME"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_uac_bypass_ntfs_reparse_point.yml"
      }
    },
    {
      "id": "5687f942-867b-4578-ade7-1e341c46e99a",
      "title": "VMToolsd Suspicious Child Process",
      "status": "test",
      "description": "Detects suspicious child process creations of VMware Tools process which may indicate persistence setup",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.persistence",
        "attack.t1059"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\vmtoolsd.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\cmd.exe",
                      "\\cscript.exe",
                      "\\mshta.exe",
                      "\\powershell.exe",
                      "\\pwsh.exe",
                      "\\regsvr32.exe",
                      "\\rundll32.exe",
                      "\\wscript.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "Cmd.Exe",
                      "cscript.exe",
                      "MSHTA.EXE",
                      "PowerShell.EXE",
                      "pwsh.dll",
                      "REGSVR32.EXE",
                      "RUNDLL32.EXE",
                      "wscript.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_main_vmwaretools_script": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\cmd.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\VMware\\VMware Tools\\poweron-vm-default.bat",
                  "\\VMware\\VMware Tools\\poweroff-vm-default.bat",
                  "\\VMware\\VMware Tools\\resume-vm-default.bat",
                  "\\VMware\\VMware Tools\\suspend-vm-default.bat"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_empty": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\cmd.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine": {
                "field": "CommandLine",
                "value": "",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_null": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\cmd.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine": {
                "field": "CommandLine",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection* and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection",
          "none_of": "filter_main_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059"
        ],
        "tactics": [
          "execution",
          "persistence"
        ]
      },
      "meta": {
        "author": "bohops, Bhabesh Raj",
        "date": "2021-10-08",
        "modified": "2023-07-25",
        "references": [
          "https://bohops.com/2021/10/08/analyzing-and-detecting-a-vmtools-persistence-technique/",
          "https://user-images.githubusercontent.com/61026070/136518004-b68cce7d-f9b8-4e9a-9b7b-53b1568a9a94.png",
          "https://github.com/vmware/open-vm-tools/blob/master/open-vm-tools/tools.conf"
        ],
        "falsepositives": [
          "Legitimate use by VM administrator"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_vmware_vmtoolsd_susp_child_process.yml"
      }
    },
    {
      "id": "62b20d44-1546-4e61-afce-8e175eb9473c",
      "title": "Service StartupType Change Via PowerShell Set-Service",
      "status": "test",
      "description": "Detects the use of the PowerShell \"Set-Service\" cmdlet to change the startup type of a service to \"disabled\" or \"manual\"",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\powershell.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "PowerShell.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "Set-Service",
                  "-StartupType"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Disabled",
                  "Manual"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-03-04",
        "modified": "",
        "references": [
          "https://www.virustotal.com/gui/file/38283b775552da8981452941ea74191aa0d203edd3f61fb2dee7b0aea3514955"
        ],
        "falsepositives": [
          "False positives may occur with troubleshooting scripts"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_set_service_disabled.yml"
      }
    },
    {
      "id": "21d856f9-9281-4ded-9377-51a1a6e2a432",
      "title": "Potential Persistence Via Logon Scripts - CommandLine",
      "status": "test",
      "description": "Detects the addition of a new LogonScript to the registry value \"UserInitMprLogonScript\" for potential persistence",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1037.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "UserInitMprLogonScript",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1037.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Tom Ueltschi (@c_APT_ure)",
        "date": "2019-01-12",
        "modified": "2023-06-09",
        "references": [
          "https://cocomelonc.github.io/persistence/2022/12/09/malware-pers-20.html"
        ],
        "falsepositives": [
          "Legitimate addition of Logon Scripts via the command line by administrators or third party tools"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_registry_logon_script.yml"
      }
    },
    {
      "id": "264982dc-dbad-4dce-b707-1e0d3e0f73d9",
      "title": "Renamed NirCmd.EXE Execution",
      "status": "test",
      "description": "Detects the execution of a renamed \"NirCmd.exe\" binary based on the PE metadata fields.",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059",
        "attack.defense-evasion",
        "attack.t1202"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "OriginalFileName": {
                "field": "OriginalFileName",
                "value": "NirCmd.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\nircmd.exe",
                  "\\nircmdc.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1059",
          "T1202"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "X__Junior (Nextron Systems)",
        "date": "2024-03-11",
        "modified": "",
        "references": [
          "https://www.microsoft.com/en-us/security/blog/2024/01/17/new-ttps-observed-in-mint-sandstorm-campaign-targeting-high-profile-individuals-at-universities-and-research-orgs/",
          "https://www.nirsoft.net/utils/nircmd.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_renamed_nircmd.yml"
      }
    },
    {
      "id": "7002aa10-b8d4-47ae-b5ba-51ab07e228b9",
      "title": "Potential Mpclient.DLL Sideloading Via Defender Binaries",
      "status": "test",
      "description": "Detects potential sideloading of \"mpclient.dll\" by Windows Defender processes (\"MpCmdRun\" and \"NisSrv\") from their non-default directory.",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1574.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\MpCmdRun.exe",
                  "\\NisSrv.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_known_locations": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\Windows Defender\\",
                  "C:\\Program Files\\Microsoft Security Client\\",
                  "C:\\Program Files\\Windows Defender\\",
                  "C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\",
                  "C:\\Windows\\WinSxS\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1574.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Bhabesh Raj",
        "date": "2022-08-01",
        "modified": "2023-08-04",
        "references": [
          "https://www.sentinelone.com/blog/living-off-windows-defender-lockbit-ransomware-sideloads-cobalt-strike-through-microsoft-security-tool"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_mpcmdrun_dll_sideload_defender.yml"
      }
    },
    {
      "id": "cf2e938e-9a3e-4fe8-a347-411642b28a9f",
      "title": "Potential PowerShell Execution Policy Tampering - ProcCreation",
      "status": "test",
      "description": "Detects changes to the PowerShell execution policy registry key in order to bypass signing requirements for script execution from the CommandLine",
      "level": "high",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_path": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\ShellIds\\Microsoft.PowerShell\\ExecutionPolicy",
                  "\\Policies\\Microsoft\\Windows\\PowerShell\\ExecutionPolicy"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_values": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Bypass",
                  "RemoteSigned",
                  "Unrestricted"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-01-11",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/de-de/powershell/module/microsoft.powershell.security/set-executionpolicy?view=powershell-7.3"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_registry_set_unsecure_powershell_policy.yml"
      }
    },
    {
      "id": "d20ee2f4-822c-4827-9e15-41500b1fff10",
      "title": "Potential Amazon SSM Agent Hijacking",
      "status": "test",
      "description": "Detects potential Amazon SSM agent hijack attempts as outlined in the Mitiga research report.",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.persistence",
        "attack.t1219.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\amazon-ssm-agent.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "-register ",
                  "-code ",
                  "-id ",
                  "-region "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1219.002"
        ],
        "tactics": [
          "command_and_control",
          "persistence"
        ]
      },
      "meta": {
        "author": "Muhammad Faisal",
        "date": "2023-08-02",
        "modified": "",
        "references": [
          "https://www.mitiga.io/blog/mitiga-security-advisory-abusing-the-ssm-agent-as-a-remote-access-trojan",
          "https://www.bleepingcomputer.com/news/security/amazons-aws-ssm-agent-can-be-used-as-post-exploitation-rat-malware/",
          "https://www.helpnetsecurity.com/2023/08/02/aws-instances-attackers-access/"
        ],
        "falsepositives": [
          "Legitimate activity of system administrators"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_ssm_agent_abuse.yml"
      }
    },
    {
      "id": "aa6f6ea6-0676-40dd-b510-6e46f02d8867",
      "title": "Local File Read Using Curl.EXE",
      "status": "test",
      "description": "Detects execution of \"curl.exe\" with the \"file://\" protocol handler in order to read local files.",
      "level": "medium",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\curl.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "curl.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "file:///",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-07-27",
        "modified": "",
        "references": [
          "https://curl.se/docs/manpage.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_curl_local_file_read.yml"
      }
    },
    {
      "id": "cf93e05e-d798-4d9e-b522-b0248dc61eaf",
      "title": "HackTool - SharpChisel Execution",
      "status": "test",
      "description": "Detects usage of the Sharp Chisel via the commandline arguments",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1090.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\SharpChisel.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Product": {
                    "field": "Product",
                    "value": "SharpChisel",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1090.001"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-09-05",
        "modified": "2023-02-13",
        "references": [
          "https://github.com/shantanu561993/SharpChisel",
          "https://www.sentinelone.com/labs/wading-through-muddy-waters-recent-activity-of-an-iranian-state-sponsored-threat-actor/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_sharp_chisel.yml"
      }
    },
    {
      "id": "ba1f7802-adc7-48b4-9ecb-81e227fddfd5",
      "title": "Potential Network Sniffing Activity Using Network Tools",
      "status": "test",
      "description": "Detects potential network sniffing via use of network tools such as \"tshark\", \"windump\".\nNetwork sniffing refers to using the network interface on a system to monitor or capture information sent over a wired or wireless connection.\nAn adversary may place a network interface into promiscuous mode to passively access data in transit over the network, or use span ports to capture a larger amount of data.\n",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.discovery",
        "attack.t1040"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_tshark": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\tshark.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-i",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_windump": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\windump.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1040"
        ],
        "tactics": [
          "credential_access",
          "discovery"
        ]
      },
      "meta": {
        "author": "Timur Zinniatullin, oscd.community, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2019-10-21",
        "modified": "2023-02-20",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1040/T1040.md"
        ],
        "falsepositives": [
          "Legitimate administration activity to troubleshoot network issues"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_network_sniffing.yml"
      }
    },
    {
      "id": "edc2f8ae-2412-4dfd-b9d5-0c57727e70be",
      "title": "Potential Powershell ReverseShell Connection",
      "status": "stable",
      "description": "Detects usage of the \"TcpClient\" class. Which can be abused to establish remote connections and reverse-shells. As seen used by the Nishang \"Invoke-PowerShellTcpOneLine\" reverse shell and other.",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " Net.Sockets.TCPClient",
                  ".GetStream(",
                  ".Write("
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "FPT.EagleEye, wagga, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2021-03-03",
        "modified": "2023-04-05",
        "references": [
          "https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero-day-vulnerabilities/",
          "https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/",
          "https://github.com/samratashok/nishang/blob/414ee1104526d7057f9adaeee196d91ae447283e/Shells/Invoke-PowerShellTcpOneLine.ps1"
        ],
        "falsepositives": [
          "In rare administrative cases, this function might be used to check network connectivity"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_reverse_shell_connection.yml"
      }
    },
    {
      "id": "c740d4cf-a1e9-41de-bb16-8a46a4f57918",
      "title": "Potential Suspicious Windows Feature Enabled - ProcCreation",
      "status": "test",
      "description": "Detects usage of the built-in PowerShell cmdlet \"Enable-WindowsOptionalFeature\" used as a Deployment Image Servicing and Management tool.\nSimilar to DISM.exe, this cmdlet is used to enumerate, install, uninstall, configure, and update features and packages in Windows images\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_cmd": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "Enable-WindowsOptionalFeature",
                  "-Online",
                  "-FeatureName"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_feature": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "TelnetServer",
                  "Internet-Explorer-Optional-amd64",
                  "TFTP",
                  "SMB1Protocol",
                  "Client-ProjFS",
                  "Microsoft-Windows-Subsystem-Linux"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-12-29",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/powershell/module/dism/enable-windowsoptionalfeature?view=windowsserver2022-ps",
          "https://learn.microsoft.com/en-us/windows/win32/projfs/enabling-windows-projected-file-system",
          "https://learn.microsoft.com/en-us/windows/wsl/install-on-server"
        ],
        "falsepositives": [
          "Legitimate usage of the features listed in the rule."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_enable_susp_windows_optional_feature.yml"
      }
    },
    {
      "id": "e218595b-bbe7-4ee5-8a96-f32a24ad3468",
      "title": "Suspicious Curl.EXE Download",
      "status": "test",
      "description": "Detects a suspicious curl process start on Windows and outputs the requested document to a local file",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1105"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_curl": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\curl.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Product": {
                    "field": "Product",
                    "value": "The curl executable",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_susp_locations": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "%AppData%",
                  "%Public%",
                  "%Temp%",
                  "%tmp%",
                  "\\AppData\\",
                  "\\Desktop\\",
                  "\\Temp\\",
                  "\\Users\\Public\\",
                  "C:\\PerfLogs\\",
                  "C:\\ProgramData\\",
                  "C:\\Windows\\Temp\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_susp_extensions": {
            "type": "field_match",
            "matchers": {
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": [
                  ".dll",
                  ".gif",
                  ".jpeg",
                  ".jpg",
                  ".png",
                  ".temp",
                  ".tmp",
                  ".txt",
                  ".vbe",
                  ".vbs"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_git_windows": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": "C:\\Program Files\\Git\\usr\\bin\\sh.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Image": {
                "field": "Image",
                "value": "C:\\Program Files\\Git\\mingw64\\bin\\curl.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "--silent --show-error --output ",
                  "gfw-httpget-",
                  "AppData"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection_curl and 1 of selection_susp_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_curl"
            },
            {
              "type": "ref",
              "value": "1 of selection_susp_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1105"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2020-07-03",
        "modified": "2023-02-21",
        "references": [
          "https://twitter.com/max_mal_/status/1542461200797163522",
          "https://web.archive.org/web/20200128160046/https://twitter.com/reegun21/status/1222093798009790464",
          "https://github.com/pr0xylife/Qakbot/blob/4f0795d79dabee5bc9dd69f17a626b48852e7869/Qakbot_AA_23.06.2022.txt",
          "https://www.volexity.com/blog/2022/07/28/sharptongue-deploys-clever-mail-stealing-browser-extension-sharpext/",
          "https://github.com/redcanaryco/atomic-red-team/blob/0f229c0e42bfe7ca736a14023836d65baa941ed2/atomics/T1105/T1105.md#atomic-test-18---curl-download-file"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_curl_susp_download.yml"
      }
    },
    {
      "id": "c453ab7a-1f5c-4716-a3b4-dea8135fb43a",
      "title": "Registry Manipulation via WMI Stdregprov",
      "status": "experimental",
      "description": "Detects the usage of wmic.exe to manipulate Windows registry via the WMI StdRegProv class.\nThis behaviour could be potentially suspicious because it uses an alternative method to modify registry keys instead of legitimate registry tools like reg.exe or regedit.exe.\nAttackers specifically choose this technique to evade detection and bypass security monitoring focused on traditional registry modification commands.\n",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.execution",
        "attack.defense-evasion",
        "attack.discovery",
        "attack.t1047",
        "attack.t1112",
        "attack.t1012"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\wmic.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "wmic.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "call",
                  "stdregprov"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1047",
          "T1112",
          "T1012"
        ],
        "tactics": [
          "persistence",
          "execution",
          "defense_evasion",
          "discovery"
        ]
      },
      "meta": {
        "author": "Daniel Koifman (KoifSec)",
        "date": "2025-07-30",
        "modified": "",
        "references": [
          "https://www.bitdefender.com/en-us/blog/businessinsights/shrinklocker-decryptor-from-friend-to-foe-and-back-again",
          "https://trustedsec.com/blog/command-line-underdog-wmic-in-action",
          "https://trustedsec.com/blog/wmi-for-script-kiddies"
        ],
        "falsepositives": [
          "Legitimate administrative activity"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wmic_stdregprov_reg_modification.yml"
      }
    },
    {
      "id": "ccb5742c-c248-4982-8c5c-5571b9275ad3",
      "title": "Recon Command Output Piped To Findstr.EXE",
      "status": "test",
      "description": "Detects the execution of a potential recon command where the results are piped to \"findstr\". This is meant to trigger on inline calls of \"cmd.exe\" via the \"/c\" or \"/k\" for example.\nAttackers often time use this technique to extract specific information they require in their reconnaissance phase.\n",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.t1057"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "ipconfig*|*find",
                  "net*|*find",
                  "netstat*|*find",
                  "ping*|*find",
                  "systeminfo*|*find",
                  "tasklist*|*find",
                  "whoami*|*find"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_xampp": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "cmd.exe /c TASKLIST /V |",
                  "FIND /I",
                  "\\xampp\\",
                  "\\catalina_start.bat"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1057"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), frack113",
        "date": "2023-07-06",
        "modified": "2025-10-08",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/02cb591f75064ffe1e0df9ac3ed5972a2e491c97/atomics/T1057/T1057.md#atomic-test-6---discover-specific-process---tasklist",
          "https://www.hhs.gov/sites/default/files/manage-engine-vulnerability-sector-alert-tlpclear.pdf",
          "https://www.trendmicro.com/en_us/research/22/d/spring4shell-exploited-to-deploy-cryptocurrency-miners.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_findstr_recon_pipe_output.yml"
      }
    },
    {
      "id": "ac175779-025a-4f12-98b0-acdaeb77ea85",
      "title": "PowerShell Script Run in AppData",
      "status": "test",
      "description": "Detects a suspicious command line execution that invokes PowerShell with reference to an AppData folder",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "powershell.exe",
                  "\\powershell",
                  "\\pwsh",
                  "pwsh.exe"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/c ",
                  "\\AppData\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Local\\",
                  "Roaming\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Jonhnathan Ribeiro, oscd.community",
        "date": "2019-01-09",
        "modified": "2022-07-14",
        "references": [
          "https://twitter.com/JohnLaTwC/status/1082851155481288706",
          "https://app.any.run/tasks/f87f1c4e-47e2-4c46-9cf4-31454c06ce03"
        ],
        "falsepositives": [
          "Administrative scripts"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_susp_ps_appdata.yml"
      }
    },
    {
      "id": "f208d6d8-d83a-4c2c-960d-877c37da84e5",
      "title": "Process Launched Without Image Name",
      "status": "test",
      "description": "Detect the use of processes with no name (\".exe\"), which can be used to evade Image-based detections.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Matt Anderson (Huntress)",
        "date": "2024-07-23",
        "modified": "",
        "references": [
          "https://www.huntress.com/blog/fake-browser-updates-lead-to-boinc-volunteer-computing-software"
        ],
        "falsepositives": [
          "Rare legitimate software."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_no_image_name.yml"
      }
    },
    {
      "id": "f26307d8-14cd-47e3-a26b-4b4769f24af6",
      "title": "HackTool - CrackMapExec Process Patterns",
      "status": "test",
      "description": "Detects suspicious process patterns found in logs when CrackMapExec is used",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_lsass_dump1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "tasklist /fi ",
                  "Imagename eq lsass.exe"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "cmd.exe /c ",
                  "cmd.exe /r ",
                  "cmd.exe /k ",
                  "cmd /c ",
                  "cmd /r ",
                  "cmd /k "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "User__contains": {
                "field": "User",
                "value": [
                  "AUTHORI",
                  "AUTORI"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_lsass_dump2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "do rundll32.exe C:\\windows\\System32\\comsvcs.dll, MiniDump",
                  "\\Windows\\Temp\\",
                  " full",
                  "%%B"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_procdump": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "tasklist /v /fo csv",
                  "findstr /i \"lsass\""
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.001"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-03-12",
        "modified": "2023-02-13",
        "references": [
          "https://mpgn.gitbook.io/crackmapexec/smb-protocol/obtaining-credentials/dump-lsass"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_crackmapexec_patterns.yml"
      }
    },
    {
      "id": "d4498716-1d52-438f-8084-4a603157d131",
      "title": "Password Provided In Command Line Of Net.EXE",
      "status": "test",
      "description": "Detects a when net.exe is called with a password in the command line",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.initial-access",
        "attack.persistence",
        "attack.privilege-escalation",
        "attack.lateral-movement",
        "attack.t1021.002",
        "attack.t1078"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\net.exe",
                      "\\net1.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "net.exe",
                      "net1.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " use ",
                  ":*\\\\",
                  "/USER:* *"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_empty": {
            "type": "field_match",
            "matchers": {
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": " ",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_main_"
        }
      },
      "mitre": {
        "techniques": [
          "T1021.002",
          "T1078"
        ],
        "tactics": [
          "defense_evasion",
          "initial_access",
          "persistence",
          "privilege_escalation",
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Tim Shelton (HAWK.IO)",
        "date": "2021-12-09",
        "modified": "2023-02-21",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_net_use_password_plaintext.yml"
      }
    },
    {
      "id": "cd1f961e-0b96-436b-b7c6-38da4583ec00",
      "title": "Suspicious Windows Trace ETW Session Tamper Via Logman.EXE",
      "status": "test",
      "description": "Detects the execution of \"logman\" utility in order to disable or delete Windows trace sessions",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001",
        "attack.t1070.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\logman.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "Logman.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_action": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "stop ",
                  "delete "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_service": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Circular Kernel Context Logger",
                  "EventLog-",
                  "SYSMON TRACE",
                  "SysmonDnsEtwSession"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001",
          "T1070.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-02-11",
        "modified": "2023-02-21",
        "references": [
          "https://twitter.com/0gtweet/status/1359039665232306183?s=21",
          "https://ss64.com/nt/logman.html"
        ],
        "falsepositives": [
          "Legitimate deactivation by administrative staff",
          "Installer tools that disable services, e.g. before log collection agent installation"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_logman_disable_eventlog.yml"
      }
    },
    {
      "id": "e6474a1b-5390-49cd-ab41-8d88655f7394",
      "title": "Renamed Mavinject.EXE Execution",
      "status": "test",
      "description": "Detects the execution of a renamed version of the \"Mavinject\" process. Which can be abused to perform process injection using the \"/INJECTRUNNING\" flag",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1055.001",
        "attack.t1218.013"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "OriginalFileName": {
                "field": "OriginalFileName",
                "value": [
                  "mavinject32.exe",
                  "mavinject64.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\mavinject32.exe",
                  "\\mavinject64.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1055.001",
          "T1218.013"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "frack113, Florian Roth",
        "date": "2022-12-05",
        "modified": "2023-02-03",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1218/T1218.md",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1056.004/T1056.004.md",
          "https://posts.specterops.io/mavinject-exe-functionality-deconstructed-c29ab2cf5c0e",
          "https://twitter.com/gN3mes1s/status/941315826107510784",
          "https://reaqta.com/2017/12/mavinject-microsoft-injector/",
          "https://twitter.com/Hexacorn/status/776122138063409152",
          "https://github.com/SigmaHQ/sigma/issues/3742",
          "https://github.com/keyboardcrunch/SentinelOne-ATTACK-Queries/blob/6a228d23eefe963ca81f2d52f94b815f61ef5ee0/Tactics/DefenseEvasion.md#t1055-process-injection"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_renamed_mavinject.yml"
      }
    },
    {
      "id": "42a5f1e7-9603-4f6d-97ae-3f37d130d794",
      "title": "Suspicious File Downloaded From File-Sharing Website Via Certutil.EXE",
      "status": "test",
      "description": "Detects the execution of certutil with certain flags that allow the utility to download files from file-sharing websites.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027",
        "attack.command-and-control",
        "attack.t1105"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\certutil.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "CertUtil.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_flags": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "urlcache ",
                  "verifyctl ",
                  "URL "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_http": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ".githubusercontent.com",
                  "anonfiles.com",
                  "cdn.discordapp.com",
                  "ddns.net",
                  "dl.dropboxusercontent.com",
                  "ghostbin.co",
                  "github.com",
                  "glitch.me",
                  "gofile.io",
                  "hastebin.com",
                  "mediafire.com",
                  "mega.nz",
                  "onrender.com",
                  "pages.dev",
                  "paste.ee",
                  "pastebin.com",
                  "pastebin.pl",
                  "pastetext.net",
                  "privatlab.com",
                  "privatlab.net",
                  "send.exploit.in",
                  "sendspace.com",
                  "storage.googleapis.com",
                  "storjshare.io",
                  "supabase.co",
                  "temp.sh",
                  "transfer.sh",
                  "trycloudflare.com",
                  "ufile.io",
                  "w3spaces.com",
                  "workers.dev"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1027",
          "T1105"
        ],
        "tactics": [
          "defense_evasion",
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-02-15",
        "modified": "2025-12-10",
        "references": [
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/certutil",
          "https://forensicitguy.github.io/agenttesla-vba-certutil-download/",
          "https://news.sophos.com/en-us/2021/04/13/compromised-exchange-server-hosting-cryptojacker-targeting-other-exchange-servers/",
          "https://twitter.com/egre55/status/1087685529016193025",
          "https://lolbas-project.github.io/lolbas/Binaries/Certutil/",
          "https://www.microsoft.com/en-us/security/blog/2024/01/17/new-ttps-observed-in-mint-sandstorm-campaign-targeting-high-profile-individuals-at-universities-and-research-orgs/",
          "https://www.hexacorn.com/blog/2020/08/23/certutil-one-more-gui-lolbin"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_certutil_download_file_sharing_domains.yml"
      }
    },
    {
      "id": "aa3a6f94-890e-4e22-b634-ffdfd54792cc",
      "title": "Suspicious Binary In User Directory Spawned From Office Application",
      "status": "test",
      "description": "Detects an executable in the users directory started from one of the Microsoft Office suite applications (Word, Excel, PowerPoint, Publisher, Visio)",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1204.002",
        "attack.g0046",
        "car.2013-05-002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\WINWORD.EXE",
                  "\\EXCEL.EXE",
                  "\\POWERPNT.exe",
                  "\\MSPUB.exe",
                  "\\VISIO.exe",
                  "\\MSACCESS.exe",
                  "\\EQNEDT32.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\users\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": ".exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\Teams.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1204.002"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Jason Lynch",
        "date": "2019-04-02",
        "modified": "2023-02-04",
        "references": [
          "https://blog.morphisec.com/fin7-not-finished-morphisec-spots-new-campaign",
          "https://www.virustotal.com/gui/file/23160972c6ae07f740800fa28e421a81d7c0ca5d5cab95bc082b4a986fbac57"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_office_spawn_exe_from_users_directory.yml"
      }
    },
    {
      "id": "52ff7941-8211-46f9-84f8-9903efb7077d",
      "title": "HackTool - PPID Spoofing SelectMyParent Tool Execution",
      "status": "test",
      "description": "Detects the use of parent process ID spoofing tools like Didier Stevens tool SelectMyParent",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.defense-evasion",
        "attack.t1134.004"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\SelectMyParent.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      "PPID-spoof",
                      "ppid_spoof",
                      "spoof-ppid",
                      "spoof_ppid",
                      "ppidspoof",
                      "spoofppid",
                      "spoofedppid",
                      " -spawnto "
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName__contains": {
                    "field": "OriginalFileName",
                    "value": [
                      "PPID-spoof",
                      "ppid_spoof",
                      "spoof-ppid",
                      "spoof_ppid",
                      "ppidspoof",
                      "spoofppid",
                      "spoofedppid"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "SelectMyParent",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Hashes__contains": {
                    "field": "Hashes",
                    "value": [
                      "IMPHASH=04D974875BD225F00902B4CAD9AF3FBC",
                      "IMPHASH=A782AF154C9E743DDF3F3EB2B8F3D16E",
                      "IMPHASH=89059503D7FBF470E68F7E63313DA3AD",
                      "IMPHASH=CA28337632625C8281AB8A130B3D6BAD"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1134.004"
        ],
        "tactics": [
          "privilege_escalation",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-07-23",
        "modified": "2024-11-23",
        "references": [
          "https://pentestlab.blog/2020/02/24/parent-pid-spoofing/",
          "https://www.picussecurity.com/resource/blog/how-to-detect-parent-pid-ppid-spoofing-attacks",
          "https://www.ired.team/offensive-security/defense-evasion/parent-process-id-ppid-spoofing",
          "https://www.virustotal.com/gui/search/filename%253A*spoof*%2520filename%253A*ppid*/files"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_selectmyparent.yml"
      }
    },
    {
      "id": "f89b08d0-77ad-4728-817b-9b16c5a69c7a",
      "title": "HackTool - SharpImpersonation Execution",
      "status": "test",
      "description": "Detects execution of the SharpImpersonation tool. Which can be used to manipulate tokens on a Windows computers remotely (PsExec/WmiExec) or interactively",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.defense-evasion",
        "attack.t1134.001",
        "attack.t1134.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\SharpImpersonation.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "SharpImpersonation.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      " user:",
                      " binary:"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      " user:",
                      " shellcode:"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      " technique:CreateProcessAsUserW",
                      " technique:ImpersonateLoggedOnuser"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1134.001",
          "T1134.003"
        ],
        "tactics": [
          "privilege_escalation",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Sai Prashanth Pulisetti @pulisettis, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-12-27",
        "modified": "2023-02-13",
        "references": [
          "https://s3cur3th1ssh1t.github.io/SharpImpersonation-Introduction/",
          "https://github.com/S3cur3Th1sSh1t/SharpImpersonation"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_sharp_impersonation.yml"
      }
    },
    {
      "id": "c615d676-f655-46b9-b913-78729021e5d7",
      "title": "Data Export From MSSQL Table Via BCP.EXE",
      "status": "test",
      "description": "Detects the execution of the BCP utility in order to export data from the database.\nAttackers were seen saving their malware to a database column or table and then later extracting it via \"bcp.exe\" into a file.\n",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.exfiltration",
        "attack.t1048"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\bcp.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "BCP.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " out ",
                  " queryout "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1048"
        ],
        "tactics": [
          "execution",
          "exfiltration"
        ]
      },
      "meta": {
        "author": "Omar Khaled (@beacon_exe), MahirAli Khan (in/mahiralikhan), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2024-08-20",
        "modified": "",
        "references": [
          "https://docs.microsoft.com/en-us/sql/tools/bcp-utility",
          "https://asec.ahnlab.com/en/61000/",
          "https://asec.ahnlab.com/en/78944/",
          "https://www.huntress.com/blog/attacking-mssql-servers",
          "https://www.huntress.com/blog/attacking-mssql-servers-pt-ii",
          "https://news.sophos.com/en-us/2024/08/07/sophos-mdr-hunt-tracks-mimic-ransomware-campaign-against-organizations-in-india/",
          "https://research.nccgroup.com/2018/03/10/apt15-is-alive-and-strong-an-analysis-of-royalcli-and-royaldns/"
        ],
        "falsepositives": [
          "Legitimate data export operations."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_bcp_export_data.yml"
      }
    },
    {
      "id": "bcfece3d-56fe-4545-9931-3b8e92927db1",
      "title": "Winrs Local Command Execution",
      "status": "experimental",
      "description": "Detects the execution of Winrs.exe where it is used to execute commands locally.\nCommands executed this way are launched under Winrshost.exe and can represent proxy execution used for defense evasion or lateral movement.\n",
      "level": "high",
      "tags": [
        "attack.lateral-movement",
        "attack.defense-evasion",
        "attack.t1021.006",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\winrs.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "winrs.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_local_ip": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "/r:localhost",
                  "/r:127.0.0.1",
                  "/r:[::1]",
                  "/remote:localhost",
                  "/remote:127.0.0.1",
                  "/remote:[::1]"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_remote": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "/r:",
                  "/remote:"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* or (selection_img and not 1 of filter_main_*)",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "all of selection_*",
            "(selection_img and not 1 of filter_main_*)"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1021.006",
          "T1218"
        ],
        "tactics": [
          "lateral_movement",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Liran Ravich, Nasreddine Bencherchali",
        "date": "2025-10-22",
        "modified": "",
        "references": [
          "https://cardinalops.com/blog/living-off-winrm-abusing-complexity-in-remote-management/",
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/winrs"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_winrs_local_command_execution.yml"
      }
    },
    {
      "id": "6a69f62d-ce75-4b57-8dce-6351eb55b362",
      "title": "Esentutl Steals Browser Information",
      "status": "test",
      "description": "One way Qbot steals sensitive information is by extracting browser data from Internet Explorer and Microsoft Edge by using the built-in utility esentutl.exe",
      "level": "medium",
      "tags": [
        "attack.collection",
        "attack.t1005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\esentutl.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "esentutl.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_flag": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-r",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_webcache": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "\\Windows\\WebCache",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1005"
        ],
        "tactics": [
          "collection"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-02-13",
        "modified": "2024-03-05",
        "references": [
          "https://thedfirreport.com/2022/02/07/qbot-likes-to-move-it-move-it/",
          "https://redcanary.com/threat-detection-report/threats/qbot/",
          "https://thedfirreport.com/2022/10/31/follina-exploit-leads-to-domain-compromise/"
        ],
        "falsepositives": [
          "Legitimate use"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_esentutl_webcache.yml"
      }
    },
    {
      "id": "32410e29-5f94-4568-b6a3-d91a8adad863",
      "title": "PUA - Fast Reverse Proxy (FRP) Execution",
      "status": "test",
      "description": "Detects the use of Fast Reverse Proxy. frp is a fast reverse proxy to help you expose a local server behind a NAT or firewall to the Internet.",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1090"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\frpc.exe",
                  "\\frps.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "\\frpc.ini",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_hashes": {
            "type": "field_match",
            "matchers": {
              "Hashes__contains": {
                "field": "Hashes",
                "value": [
                  "MD5=7D9C233B8C9E3F0EA290D2B84593C842",
                  "SHA1=06DDC9280E1F1810677935A2477012960905942F",
                  "SHA256=57B0936B8D336D8E981C169466A15A5FD21A7D5A2C7DAF62D5E142EE860E387C"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1090"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "frack113, Florian Roth",
        "date": "2022-09-02",
        "modified": "2024-11-23",
        "references": [
          "https://asec.ahnlab.com/en/38156/",
          "https://github.com/fatedier/frp"
        ],
        "falsepositives": [
          "Legitimate use"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_frp.yml"
      }
    },
    {
      "id": "7efd2c8d-8b18-45b7-947d-adfe9ed04f61",
      "title": "AgentExecutor PowerShell Execution",
      "status": "test",
      "description": "Detects execution of the AgentExecutor.exe binary. Which can be abused as a LOLBIN to execute powershell scripts with the ExecutionPolicy \"Bypass\" or any binary named \"powershell.exe\" located in the path provided by 6th positional argument",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image": {
                    "field": "Image",
                    "value": "\\AgentExecutor.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "AgentExecutor.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -powershell",
                  " -remediationScript"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_intune": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\Microsoft.Management.Services.IntuneWindowsAgent.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_main_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), memory-shards",
        "date": "2022-12-24",
        "modified": "2024-08-07",
        "references": [
          "https://twitter.com/lefterispan/status/1286259016436514816",
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Agentexecutor/",
          "https://learn.microsoft.com/en-us/mem/intune/apps/intune-management-extension",
          "https://twitter.com/jseerden/status/1247985304667066373/photo/1"
        ],
        "falsepositives": [
          "Legitimate use via Intune management. You exclude script paths and names to reduce FP rate"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_agentexecutor_potential_abuse.yml"
      }
    },
    {
      "id": "99cf1e02-00fb-4c0d-8375-563f978dfd37",
      "title": "Deny Service Access Using Security Descriptor Tampering Via Sc.EXE",
      "status": "test",
      "description": "Detects suspicious DACL modifications to deny access to a service that affects critical trustees. This can be used to hide services or make them unstoppable.",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1543.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_sc": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\sc.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "sc.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_sdset": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "sdset",
                  "D;"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_trustee": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ";IU",
                  ";SU",
                  ";BA",
                  ";SY",
                  ";WD"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1543.003"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Jonhnathan Ribeiro, oscd.community",
        "date": "2020-10-16",
        "modified": "2023-02-28",
        "references": [
          "https://www.sans.org/blog/red-team-tactics-hiding-windows-services/",
          "https://itconnect.uw.edu/tools-services-support/it-systems-infrastructure/msinf/other-help/understanding-sddl-syntax/",
          "https://learn.microsoft.com/en-us/windows/win32/secauthz/sid-strings"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sc_sdset_deny_service_access.yml"
      }
    },
    {
      "id": "e8a95b5e-c891-46e2-b33a-93937d3abc31",
      "title": "Suspicious HH.EXE Execution",
      "status": "test",
      "description": "Detects a suspicious execution of a Microsoft HTML Help (HH.exe)",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.execution",
        "attack.initial-access",
        "attack.t1047",
        "attack.t1059.001",
        "attack.t1059.003",
        "attack.t1059.005",
        "attack.t1059.007",
        "attack.t1218",
        "attack.t1218.001",
        "attack.t1218.010",
        "attack.t1218.011",
        "attack.t1566",
        "attack.t1566.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "HH.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\hh.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_paths": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ".application",
                  "\\AppData\\Local\\Temp\\",
                  "\\Content.Outlook\\",
                  "\\Downloads\\",
                  "\\Users\\Public\\",
                  "\\Windows\\Temp\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1047",
          "T1059.001",
          "T1059.003",
          "T1059.005",
          "T1059.007",
          "T1218",
          "T1218.001",
          "T1218.010",
          "T1218.011",
          "T1566",
          "T1566.001"
        ],
        "tactics": [
          "defense_evasion",
          "execution",
          "initial_access"
        ]
      },
      "meta": {
        "author": "Maxim Pavlunin",
        "date": "2020-04-01",
        "modified": "2023-04-12",
        "references": [
          "https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/chm-badness-delivers-a-banking-trojan/",
          "https://github.com/elastic/protections-artifacts/commit/746086721fd385d9f5c6647cada1788db4aea95f#diff-27939090904026cc396b0b629c8e4314acd6f5dac40a676edbc87f4567b47eb7",
          "https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/higaisa-or-winnti-apt-41-backdoors-old-and-new/",
          "https://www.zscaler.com/blogs/security-research/unintentional-leak-glimpse-attack-vectors-apt37"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hh_susp_execution.yml"
      }
    },
    {
      "id": "782d6f3e-4c5d-4b8c-92a3-1d05fed72e63",
      "title": "RDP Port Forwarding Rule Added Via Netsh.EXE",
      "status": "test",
      "description": "Detects the execution of netsh to configure a port forwarding of port 3389 (RDP) rule",
      "level": "high",
      "tags": [
        "attack.lateral-movement",
        "attack.defense-evasion",
        "attack.command-and-control",
        "attack.t1090"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\netsh.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "netsh.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " i",
                  " p",
                  "=3389",
                  " c"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1090"
        ],
        "tactics": [
          "lateral_movement",
          "defense_evasion",
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), oscd.community",
        "date": "2019-01-29",
        "modified": "2023-02-13",
        "references": [
          "https://www.fireeye.com/blog/threat-research/2019/01/bypassing-network-restrictions-through-rdp-tunneling.html"
        ],
        "falsepositives": [
          "Legitimate administration activity"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_netsh_port_forwarding_3389.yml"
      }
    },
    {
      "id": "729ce0ea-5d8f-4769-9762-e35de441586d",
      "title": "MpiExec Lolbin",
      "status": "test",
      "description": "Detects a certain command line flag combination used by mpiexec.exe LOLBIN from HPC pack that can be used to execute any other binary",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_binary": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\mpiexec.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Hashes__contains": {
                    "field": "Hashes",
                    "value": "IMPHASH=d8b52ef6aaa3a81501bdfff9dbb96217",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_flags": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " /n 1 ",
                  " -n 1 "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-01-11",
        "modified": "2024-11-23",
        "references": [
          "https://twitter.com/mrd0x/status/1465058133303246867",
          "https://learn.microsoft.com/en-us/powershell/high-performance-computing/mpiexec?view=hpc19-ps"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_mpiexec.yml"
      }
    },
    {
      "id": "a58353df-af43-4753-bad0-cd83ef35eef5",
      "title": "Suspicious Usage Of Active Directory Diagnostic Tool (ntdsutil.exe)",
      "status": "test",
      "description": "Detects execution of ntdsutil.exe to perform different actions such as restoring snapshots...etc.",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.t1003.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\ntdsutil.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "ntdsutil.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "snapshot",
                      "mount "
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "ac",
                      " i",
                      " ntds"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.003"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-09-14",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc731620(v=ws.11)",
          "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/espionage-asia-governments"
        ],
        "falsepositives": [
          "Legitimate usage to restore snapshots",
          "Legitimate admin activity"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_ntdsutil_susp_usage.yml"
      }
    },
    {
      "id": "e92a4287-e072-4a40-9739-370c106bb750",
      "title": "HackTool - SOAPHound Execution",
      "status": "test",
      "description": "Detects the execution of SOAPHound, a .NET tool for collecting Active Directory data, using specific command-line arguments that may indicate an attempt to extract sensitive AD information.\n",
      "level": "high",
      "tags": [
        "attack.discovery",
        "attack.t1087"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " --buildcache ",
                  " --bhdump ",
                  " --certdump ",
                  " --dnsdump "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -c ",
                  " --cachefilename ",
                  " -o ",
                  " --outputdirectory"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1087"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "@kostastsale",
        "date": "2024-01-26",
        "modified": "",
        "references": [
          "https://github.com/FalconForceTeam/SOAPHound",
          "https://medium.com/falconforce/soaphound-tool-to-collect-active-directory-data-via-adws-165aca78288c"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_soaphound_execution.yml"
      }
    },
    {
      "id": "91a2c315-9ee6-4052-a853-6f6a8238f90d",
      "title": "Findstr GPP Passwords",
      "status": "test",
      "description": "Look for the encrypted cpassword value within Group Policy Preference files on the Domain Controller. This value can be decrypted with gpp-decrypt.",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1552.006"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\find.exe",
                      "\\findstr.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "FIND.EXE",
                      "FINDSTR.EXE"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "cpassword",
                  "\\sysvol\\",
                  ".xml"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1552.006"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-12-27",
        "modified": "2023-11-11",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1552.006/T1552.006.md#atomic-test-1---gpp-passwords-findstr"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_findstr_gpp_passwords.yml"
      }
    },
    {
      "id": "7cccd811-7ae9-4ebe-9afd-cb5c406b824b",
      "title": "Potential Execution of Sysinternals Tools",
      "status": "test",
      "description": "Detects command lines that contain the 'accepteula' flag which could be a sign of execution of one of the Sysinternals tools",
      "level": "low",
      "tags": [
        "attack.resource-development",
        "attack.t1588.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -accepteula",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1588.002"
        ],
        "tactics": [
          "resource_development"
        ]
      },
      "meta": {
        "author": "Markus Neis",
        "date": "2017-08-28",
        "modified": "2024-03-13",
        "references": [
          "https://twitter.com/Moti_B/status/1008587936735035392"
        ],
        "falsepositives": [
          "Legitimate use of SysInternals tools",
          "Programs that use the same command line flag"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sysinternals_eula_accepted.yml"
      }
    },
    {
      "id": "15b75071-74cc-47e0-b4c6-b43744a62a2b",
      "title": "Suspicious Process Start Locations",
      "status": "test",
      "description": "Detects suspicious process run from unusual locations",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036",
        "car.2013-05-002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__contains": {
                    "field": "Image",
                    "value": [
                      ":\\RECYCLER\\",
                      ":\\SystemVolumeInformation\\"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__startswith": {
                    "field": "Image",
                    "value": [
                      "C:\\Windows\\Tasks\\",
                      "C:\\Windows\\debug\\",
                      "C:\\Windows\\fonts\\",
                      "C:\\Windows\\help\\",
                      "C:\\Windows\\drivers\\",
                      "C:\\Windows\\addins\\",
                      "C:\\Windows\\cursors\\",
                      "C:\\Windows\\system32\\tasks\\"
                    ],
                    "modifiers": [
                      "startswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1036"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "juju4, Jonhnathan Ribeiro, oscd.community",
        "date": "2019-01-16",
        "modified": "2022-01-07",
        "references": [
          "https://car.mitre.org/wiki/CAR-2013-05-002"
        ],
        "falsepositives": [
          "False positives depend on scripts and administrative tools used in the monitored environment"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_rundll32_run_locations.yml"
      }
    },
    {
      "id": "8d01b53f-456f-48ee-90f6-bc28e67d4e35",
      "title": "Suspicious Obfuscated PowerShell Code",
      "status": "test",
      "description": "Detects suspicious UTF16 and base64 encoded and often obfuscated PowerShell code often used in command lines",
      "level": "high",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "IAAtAGIAeABvAHIAIAAwAHgA",
                  "AALQBiAHgAbwByACAAMAB4A",
                  "gAC0AYgB4AG8AcgAgADAAeA",
                  "AC4ASQBuAHYAbwBrAGUAKAApACAAfAAg",
                  "AuAEkAbgB2AG8AawBlACgAKQAgAHwAI",
                  "ALgBJAG4AdgBvAGsAZQAoACkAIAB8AC",
                  "AHsAMQB9AHsAMAB9ACIAIAAtAGYAI",
                  "B7ADEAfQB7ADAAfQAiACAALQBmAC",
                  "AewAxAH0AewAwAH0AIgAgAC0AZgAg",
                  "AHsAMAB9AHsAMwB9ACIAIAAtAGYAI",
                  "B7ADAAfQB7ADMAfQAiACAALQBmAC",
                  "AewAwAH0AewAzAH0AIgAgAC0AZgAg",
                  "AHsAMgB9AHsAMAB9ACIAIAAtAGYAI",
                  "B7ADIAfQB7ADAAfQAiACAALQBmAC",
                  "AewAyAH0AewAwAH0AIgAgAC0AZgAg",
                  "AHsAMQB9AHsAMAB9ACcAIAAtAGYAI",
                  "B7ADEAfQB7ADAAfQAnACAALQBmAC",
                  "AewAxAH0AewAwAH0AJwAgAC0AZgAg",
                  "AHsAMAB9AHsAMwB9ACcAIAAtAGYAI",
                  "B7ADAAfQB7ADMAfQAnACAALQBmAC",
                  "AewAwAH0AewAzAH0AJwAgAC0AZgAg",
                  "AHsAMgB9AHsAMAB9ACcAIAAtAGYAI",
                  "B7ADIAfQB7ADAAfQAnACAALQBmAC",
                  "AewAyAH0AewAwAH0AJwAgAC0AZgAg"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-07-11",
        "modified": "2023-02-14",
        "references": [
          "https://app.any.run/tasks/fcadca91-3580-4ede-aff4-4d2bf809bf99/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_base64_encoded_obfusc.yml"
      }
    },
    {
      "id": "ddeff553-5233-4ae9-bbab-d64d2bd634be",
      "title": "Data Copied To Clipboard Via Clip.EXE",
      "status": "test",
      "description": "Detects the execution of clip.exe in order to copy data to the clipboard. Adversaries may collect data stored in the clipboard from users copying information within or between applications.",
      "level": "low",
      "tags": [
        "attack.collection",
        "attack.t1115"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\clip.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "clip.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1115"
        ],
        "tactics": [
          "collection"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-07-27",
        "modified": "2023-02-21",
        "references": [
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/clip",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1115/T1115.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_clip_execution.yml"
      }
    },
    {
      "id": "7c8af9b2-dcae-41a2-a9db-b28c288b5f08",
      "title": "Suspicious IIS URL GlobalRules Rewrite Via AppCmd",
      "status": "test",
      "description": "Detects usage of \"appcmd\" to create new global URL rewrite rules. This behaviour has been observed being used by threat actors to add new rules so they can access their webshells.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\appcmd.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "appcmd.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "set",
                  "config",
                  "section:system.webServer/rewrite/globalRules",
                  "commit:"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-01-22",
        "modified": "",
        "references": [
          "https://twitter.com/malmoeb/status/1616702107242971144",
          "https://learn.microsoft.com/en-us/answers/questions/739120/how-to-add-re-write-global-rule-with-action-type-r"
        ],
        "falsepositives": [
          "Legitimate usage of appcmd to add new URL rewrite rules"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_iis_appcmd_susp_rewrite_rule.yml"
      }
    },
    {
      "id": "05a2ab7e-ce11-4b63-86db-ab32e763e11d",
      "title": "MMC Spawning Windows Shell",
      "status": "test",
      "description": "Detects a Windows command line executable started from MMC",
      "level": "high",
      "tags": [
        "attack.lateral-movement",
        "attack.t1021.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection1": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\mmc.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection2": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\cmd.exe",
                      "\\powershell.exe",
                      "\\pwsh.exe",
                      "\\wscript.exe",
                      "\\cscript.exe",
                      "\\sh.exe",
                      "\\bash.exe",
                      "\\reg.exe",
                      "\\regsvr32.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__contains": {
                    "field": "Image",
                    "value": "\\BITSADMIN",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1021.003"
        ],
        "tactics": [
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Karneades, Swisscom CSIRT",
        "date": "2019-08-05",
        "modified": "2022-07-14",
        "references": [
          "https://enigma0x3.net/2017/01/05/lateral-movement-using-the-mmc20-application-com-object/"
        ],
        "falsepositives": [],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_mmc_susp_child_process.yml"
      }
    },
    {
      "id": "459f2f98-397b-4a4a-9f47-6a5ec2f1c69d",
      "title": "Arbitrary File Download Via MSOHTMED.EXE",
      "status": "test",
      "description": "Detects usage of \"MSOHTMED\" to download arbitrary files",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.execution",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\MSOHTMED.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "MsoHtmEd.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "ftp://",
                  "http://",
                  "https://"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-19",
        "modified": "2023-11-09",
        "references": [
          "https://github.com/LOLBAS-Project/LOLBAS/pull/238/files"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_msohtmed_download.yml"
      }
    },
    {
      "id": "418a3163-3247-4b7b-9933-dcfcb7c52ea9",
      "title": "Compressed File Creation Via Tar.EXE",
      "status": "test",
      "description": "Detects execution of \"tar.exe\" in order to create a compressed file.\nAdversaries may abuse various utilities to compress or encrypt data before exfiltration.\n",
      "level": "low",
      "tags": [
        "attack.collection",
        "attack.exfiltration",
        "attack.t1560",
        "attack.t1560.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\tar.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "bsdtar",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_create": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "-c",
                  "-r",
                  "-u"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1560",
          "T1560.001"
        ],
        "tactics": [
          "collection",
          "exfiltration"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), AdmU3",
        "date": "2023-12-19",
        "modified": "",
        "references": [
          "https://unit42.paloaltonetworks.com/chromeloader-malware/",
          "https://lolbas-project.github.io/lolbas/Binaries/Tar/",
          "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/cicada-apt10-japan-espionage"
        ],
        "falsepositives": [
          "Likely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_tar_compression.yml"
      }
    },
    {
      "id": "98a96a5a-64a0-4c42-92c5-489da3866cb0",
      "title": "DNS Exfiltration and Tunneling Tools Execution",
      "status": "test",
      "description": "Well-known DNS Exfiltration tools execution",
      "level": "high",
      "tags": [
        "attack.exfiltration",
        "attack.t1048.001",
        "attack.command-and-control",
        "attack.t1071.004",
        "attack.t1132.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\iodine.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__contains": {
                    "field": "Image",
                    "value": "\\dnscat2",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1048.001",
          "T1071.004",
          "T1132.001"
        ],
        "tactics": [
          "exfiltration",
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Daniil Yugoslavskiy, oscd.community",
        "date": "2019-10-24",
        "modified": "2021-11-27",
        "references": [
          "https://github.com/iagox86/dnscat2",
          "https://github.com/yarrick/iodine"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_dns_exfiltration_tools_execution.yml"
      }
    },
    {
      "id": "ee5e119b-1f75-4b34-add8-3be976961e39",
      "title": "Conhost.exe CommandLine Path Traversal",
      "status": "test",
      "description": "detects the usage of path traversal in conhost.exe indicating possible command/argument confusion/hijacking",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentCommandLine__contains": {
                "field": "ParentCommandLine",
                "value": "conhost",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "/../../",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.003"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-06-14",
        "modified": "",
        "references": [
          "https://pentestlab.blog/2020/07/06/indirect-command-execution/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_conhost_path_traversal.yml"
      }
    },
    {
      "id": "c9fbe8e9-119d-40a6-9b59-dd58a5d84429",
      "title": "Potential Ransomware or Unauthorized MBR Tampering Via Bcdedit.EXE",
      "status": "test",
      "description": "Detects potential malicious and unauthorized usage of bcdedit.exe",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1070",
        "attack.persistence",
        "attack.t1542.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\bcdedit.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "bcdedit.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "delete",
                  "deletevalue",
                  "import",
                  "safeboot",
                  "network"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1070",
          "T1542.003"
        ],
        "tactics": [
          "defense_evasion",
          "persistence"
        ]
      },
      "meta": {
        "author": "@neu5ron",
        "date": "2019-02-07",
        "modified": "2023-02-15",
        "references": [
          "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/bcdedit--set",
          "https://twitter.com/malwrhunterteam/status/1372536434125512712/photo/2"
        ],
        "falsepositives": [],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_bcdedit_susp_execution.yml"
      }
    },
    {
      "id": "a642964e-bead-4bed-8910-1bb4d63e3b4d",
      "title": "HackTool - Mimikatz Execution",
      "status": "test",
      "description": "Detection well-known mimikatz command line arguments",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003.001",
        "attack.t1003.002",
        "attack.t1003.004",
        "attack.t1003.005",
        "attack.t1003.006"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_tools_name": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "DumpCreds",
                  "mimikatz"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_function_names": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "::aadcookie",
                  "::detours",
                  "::memssp",
                  "::mflt",
                  "::ncroutemon",
                  "::ngcsign",
                  "::printnightmare",
                  "::skeleton",
                  "::preshutdown",
                  "::mstsc",
                  "::multirdp"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_module_names": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "rpc::",
                  "token::",
                  "crypto::",
                  "dpapi::",
                  "sekurlsa::",
                  "kerberos::",
                  "lsadump::",
                  "privilege::",
                  "process::",
                  "vault::"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.001",
          "T1003.002",
          "T1003.004",
          "T1003.005",
          "T1003.006"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Teymur Kheirkhabarov, oscd.community, David ANDRE (additional keywords), Tim Shelton",
        "date": "2019-10-22",
        "modified": "2023-02-21",
        "references": [
          "https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment",
          "https://tools.thehacker.recipes/mimikatz/modules"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_mimikatz_command_line.yml"
      }
    },
    {
      "id": "45d3a03d-f441-458c-8883-df101a3bb146",
      "title": "Launch-VsDevShell.PS1 Proxy Execution",
      "status": "test",
      "description": "Detects the use of the 'Launch-VsDevShell.ps1' Microsoft signed script to execute commands.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1216.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_script": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "Launch-VsDevShell.ps1",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_flags": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "VsWherePath ",
                  "VsInstallationPath "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1216.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-19",
        "modified": "",
        "references": [
          "https://twitter.com/nas_bench/status/1535981653239255040"
        ],
        "falsepositives": [
          "Legitimate usage of the script by a developer"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_launch_vsdevshell.yml"
      }
    },
    {
      "id": "8a3038e8-9c9d-46f8-b184-66234a160f6f",
      "title": "Potential Remote Desktop Tunneling",
      "status": "test",
      "description": "Detects potential use of an SSH utility to establish RDP over a reverse SSH Tunnel. This can be used by attackers to enable routing of network packets that would otherwise not reach their intended destination.",
      "level": "medium",
      "tags": [
        "attack.lateral-movement",
        "attack.t1021"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": ":3389",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_opt": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -L ",
                  " -P ",
                  " -R ",
                  " -pw ",
                  " -ssh "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1021"
        ],
        "tactics": [
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Tim Rauch, Elastic (idea)",
        "date": "2022-09-27",
        "modified": "",
        "references": [
          "https://www.elastic.co/guide/en/security/current/potential-remote-desktop-tunneling-detected.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_remote_desktop_tunneling.yml"
      }
    },
    {
      "id": "970823b7-273b-460a-8afc-3a6811998529",
      "title": "Uncommon One Time Only Scheduled Task At 00:00",
      "status": "test",
      "description": "Detects scheduled task creation events that include suspicious actions, and is run once at 00:00",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.persistence",
        "attack.privilege-escalation",
        "attack.t1053.005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__contains": {
                    "field": "Image",
                    "value": "\\schtasks.exe",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "schtasks.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "wscript",
                  "vbscript",
                  "cscript",
                  "wmic ",
                  "wmic.exe",
                  "regsvr32.exe",
                  "powershell",
                  "\\AppData\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_time": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "once",
                  "00:00"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1053.005"
        ],
        "tactics": [
          "execution",
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "pH-T (Nextron Systems)",
        "date": "2022-07-15",
        "modified": "2023-02-03",
        "references": [
          "https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-blackbyte"
        ],
        "falsepositives": [
          "Software installation"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_schtasks_one_time_only_midnight_task.yml"
      }
    },
    {
      "id": "89ca78fd-b37c-4310-b3d3-81a023f83936",
      "title": "Schtasks Creation Or Modification With SYSTEM Privileges",
      "status": "test",
      "description": "Detects the creation or update of a scheduled task to run with \"NT AUTHORITY\\SYSTEM\" privileges",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.execution",
        "attack.persistence",
        "attack.t1053.005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_root": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\schtasks.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " /change ",
                  " /create "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_run": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "/ru ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_user": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "NT AUT",
                  " SYSTEM "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_teamviewer": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\schtasks.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/TN TVInstallRestore",
                  "\\TeamViewer_.exe"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_office": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "Subscription Heartbeat",
                  "\\HeartbeatConfig.xml",
                  "\\Microsoft Shared\\OFFICE"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_avira": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "/Create /F /RU System /SC WEEKLY /TN AviraSystemSpeedupVerify /TR ",
                  ":\\Program Files (x86)\\Avira\\System Speedup\\setup\\avira_speedup_setup.exe",
                  "/VERIFY /VERYSILENT /NOSTART /NODOTNET /NORESTART\" /RL HIGHEST"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_optional_"
        }
      },
      "mitre": {
        "techniques": [
          "T1053.005"
        ],
        "tactics": [
          "privilege_escalation",
          "execution",
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-07-28",
        "modified": "2025-02-15",
        "references": [
          "https://www.elastic.co/security-labs/exploring-the-qbot-attack-pattern",
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/schtasks"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_schtasks_system.yml"
      }
    },
    {
      "id": "a2ea3ae7-d3d0-40a0-a55c-25a45c87cac1",
      "title": "Suspicious Driver Install by pnputil.exe",
      "status": "test",
      "description": "Detects when a possible suspicious driver is being installed via pnputil.exe lolbin",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "-i",
                  "/install",
                  "-a",
                  "/add-driver",
                  ".inf"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\pnputil.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1547"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Hai Vaknin @LuxNoBulIshit, Avihay eldad  @aloneliassaf, Austin Songer @austinsonger",
        "date": "2021-09-30",
        "modified": "2022-10-09",
        "references": [
          "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/pnputil-command-syntax",
          "https://strontic.github.io/xcyclopedia/library/pnputil.exe-60EDC5E6BDBAEE441F2E3AEACD0340D2.html"
        ],
        "falsepositives": [
          "Pnputil.exe being used may be performed by a system administrator.",
          "Verify whether the user identity, user agent, and/or hostname should be making changes in your environment.",
          "Pnputil.exe being executed from unfamiliar users should be investigated. If known behavior is causing false positives, it can be exempted from the rule."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_susp_driver_installed_by_pnputil.yml"
      }
    },
    {
      "id": "1c8774a0-44d4-4db0-91f8-e792359c70bd",
      "title": "REGISTER_APP.VBS Proxy Execution",
      "status": "test",
      "description": "Detects the use of a Microsoft signed script 'REGISTER_APP.VBS' to register a VSS/VDS Provider as a COM+ application.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "\\register_app.vbs",
                  "-register"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-19",
        "modified": "",
        "references": [
          "https://twitter.com/sblmsrsn/status/1456613494783160325?s=20"
        ],
        "falsepositives": [
          "Legitimate usage of the script. Always investigate what's being registered to confirm if it's benign"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_register_app.yml"
      }
    },
    {
      "id": "d3bf399f-b0cf-4250-8bb4-dfc192ab81dc",
      "title": "Ie4uinit Lolbin Use From Invalid Path",
      "status": "test",
      "description": "Detect use of ie4uinit.exe to execute commands from a specially prepared ie4uinit.inf file from a directory other than the usual directories",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "lolbin": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\ie4uinit.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "IE4UINIT.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_correct": {
            "type": "field_match",
            "matchers": {
              "CurrentDirectory": {
                "field": "CurrentDirectory",
                "value": [
                  "c:\\windows\\system32\\",
                  "c:\\windows\\sysWOW64\\"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_missing": {
            "type": "field_match",
            "matchers": {
              "CurrentDirectory": {
                "field": "CurrentDirectory",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "lolbin and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "lolbin"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-05-07",
        "modified": "2022-05-16",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Ie4uinit/",
          "https://bohops.com/2018/03/10/leveraging-inf-sct-fetch-execute-techniques-for-bypass-evasion-persistence-part-2/"
        ],
        "falsepositives": [
          "ViberPC updater calls this binary with the following commandline \"ie4uinit.exe -ClearIconCache\""
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_ie4uinit.yml"
      }
    },
    {
      "id": "6120ac2a-a34b-42c0-a9bd-1fb9f459f348",
      "title": "AddinUtil.EXE Execution From Uncommon Directory",
      "status": "test",
      "description": "Detects execution of the Add-In deployment cache updating utility (AddInutil.exe) from a non-standard directory.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\addinutil.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "AddInUtil.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_main_legit_location": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  ":\\Windows\\Microsoft.NET\\Framework\\",
                  ":\\Windows\\Microsoft.NET\\Framework64\\",
                  ":\\Windows\\Microsoft.NET\\FrameworkArm\\",
                  ":\\Windows\\Microsoft.NET\\FrameworkArm64\\",
                  ":\\Windows\\WinSxS\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Michael McKinley (@McKinleyMike), Tony Latteri (@TheLatteri)",
        "date": "2023-09-18",
        "modified": "2025-02-24",
        "references": [
          "https://www.blue-prints.blog/content/blog/posts/lolbin/addinutil-lolbas.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_addinutil_uncommon_dir_exec.yml"
      }
    },
    {
      "id": "07f8bdc2-c9b3-472a-9817-5a670b872f53",
      "title": "Potential Reconnaissance For Cached Credentials Via Cmdkey.EXE",
      "status": "test",
      "description": "Detects usage of cmdkey to look for cached credentials on the system",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003.005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\cmdkey.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "cmdkey.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -l",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.005"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "jmallette, Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2019-01-16",
        "modified": "2024-03-05",
        "references": [
          "https://www.peew.pw/blog/2017/11/26/exploring-cmdkey-an-edge-case-for-privilege-escalation",
          "https://technet.microsoft.com/en-us/library/cc754243(v=ws.11).aspx",
          "https://github.com/redcanaryco/atomic-red-team/blob/b27a3cb25025161d49ac861cb216db68c46a3537/atomics/T1003.005/T1003.005.md#atomic-test-1---cached-credential-dump-via-cmdkey"
        ],
        "falsepositives": [
          "Legitimate administrative tasks"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_cmdkey_recon.yml"
      }
    },
    {
      "id": "2704ab9e-afe2-4854-a3b1-0c0706d03578",
      "title": "HackTool - Dumpert Process Dumper Execution",
      "status": "test",
      "description": "Detects the use of Dumpert process dumper, which dumps the lsass.exe process memory",
      "level": "critical",
      "tags": [
        "attack.credential-access",
        "attack.t1003.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Hashes__contains": {
                    "field": "Hashes",
                    "value": "MD5=09D278F9DE118EF09163C6140255C690",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": "Dumpert.dll",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.001"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2020-02-04",
        "modified": "2025-01-22",
        "references": [
          "https://github.com/outflanknl/Dumpert",
          "https://unit42.paloaltonetworks.com/actors-still-exploiting-sharepoint-vulnerability/"
        ],
        "falsepositives": [
          "Very unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_dumpert.yml"
      }
    },
    {
      "id": "4cbef972-f347-4170-b62a-8253f6168e6d",
      "title": "UAC Bypass Using IDiagnostic Profile",
      "status": "test",
      "description": "Detects the \"IDiagnosticProfileUAC\" UAC bypass technique",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\DllHost.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "ParentCommandLine__contains": {
                "field": "ParentCommandLine",
                "value": " /Processid:{12C21EA7-2EB8-4B55-9249-AC243DA8C666}",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "IntegrityLevel": {
                "field": "IntegrityLevel",
                "value": [
                  "High",
                  "System",
                  "S-1-16-16384",
                  "S-1-16-12288"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "execution",
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-07-03",
        "modified": "2024-12-01",
        "references": [
          "https://github.com/Wh04m1001/IDiagnosticProfileUAC"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_uac_bypass_idiagnostic_profile.yml"
      }
    },
    {
      "id": "b3512211-c67e-4707-bedc-66efc7848863",
      "title": "Potential PowerShell Downgrade Attack",
      "status": "test",
      "description": "Detects PowerShell downgrade attack by comparing the host versions with the actually used engine version 2.0",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\powershell.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -version 2 ",
                  " -versio 2 ",
                  " -versi 2 ",
                  " -vers 2 ",
                  " -ver 2 ",
                  " -ve 2 ",
                  " -v 2 "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Harish Segar (rule)",
        "date": "2020-03-20",
        "modified": "2023-01-04",
        "references": [
          "http://www.leeholmes.com/blog/2017/03/17/detecting-and-preventing-powershell-downgrade-attacks/",
          "https://github.com/r00t-3xp10it/hacking-material-books/blob/43cb1e1932c16ff1f58b755bc9ab6b096046853f/obfuscation/simple_obfuscation.md#bypass-or-avoid-amsi-by-version-downgrade-"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_downgrade_attack.yml"
      }
    },
    {
      "id": "70ad0861-d1fe-491c-a45f-fa48148a300d",
      "title": "File Download via CertOC.EXE",
      "status": "test",
      "description": "Detects when a user downloads a file by using CertOC.exe",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1105"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\certoc.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "CertOC.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "-GetCACAPS",
                  "http"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1105"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-05-16",
        "modified": "2023-10-18",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Certoc/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_certoc_download.yml"
      }
    },
    {
      "id": "2fbbe9ff-0afc-470b-bdc0-592198339968",
      "title": "Remote Access Tool - Potential MeshAgent Execution - Windows",
      "status": "experimental",
      "description": "Detects potential execution of MeshAgent which is a tool used for remote access.\nHistorical data shows that threat actors rename MeshAgent binary to evade detection.\nMatching command lines with the '--meshServiceName' argument can indicate that the MeshAgent is being used for remote access.\n",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1219.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "--meshServiceName",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1219.002"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Norbert Jaśniewicz (AlphaSOC)",
        "date": "2025-05-19",
        "modified": "",
        "references": [
          "https://www.huntress.com/blog/know-thy-enemy-a-novel-november-case-on-persistent-remote-access",
          "https://thecyberexpress.com/ukraine-hit-by-meshagent-malware-campaign/",
          "https://wazuh.com/blog/how-to-detect-meshagent-with-wazuh/",
          "https://www.security.com/threat-intelligence/medusa-ransomware-attacks"
        ],
        "falsepositives": [
          "Environments that legitimately use MeshAgent"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_remote_access_tools_meshagent_arguments.yml"
      }
    },
    {
      "id": "347906f3-e207-4d18-ae5b-a9403d6bcdef",
      "title": "Netsh Allow Group Policy on Microsoft Defender Firewall",
      "status": "test",
      "description": "Adversaries may modify system firewalls in order to bypass controls limiting network usage",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.004"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\netsh.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "netsh.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "advfirewall",
                  "firewall",
                  "set",
                  "rule",
                  "group=",
                  "new",
                  "enable=Yes"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-09",
        "modified": "2023-02-14",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.004/T1562.004.md#atomic-test-3---allow-smb-and-rdp-on-microsoft-defender-firewall",
          "https://learn.microsoft.com/en-us/troubleshoot/windows-server/networking/netsh-advfirewall-firewall-control-firewall-behavior"
        ],
        "falsepositives": [
          "Legitimate administration activity"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_netsh_fw_enable_group_rule.yml"
      }
    },
    {
      "id": "9fc51a3c-81b3-4fa7-b35f-7c02cf10fd2d",
      "title": "Usage Of Web Request Commands And Cmdlets",
      "status": "test",
      "description": "Detects the use of various web request commands with commandline tools and Windows PowerShell cmdlets (including aliases) via CommandLine",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "[System.Net.WebRequest]::create",
                  "curl ",
                  "Invoke-RestMethod",
                  "Invoke-WebRequest",
                  " irm ",
                  "iwr ",
                  "Resume-BitsTransfer",
                  "Start-BitsTransfer",
                  "wget ",
                  "WinHttp.WinHttpRequest"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "James Pemberton / @4A616D6573, Endgame, JHasenbusch, oscd.community, Austin Songer @austinsonger",
        "date": "2019-10-24",
        "modified": "2025-10-20",
        "references": [
          "https://4sysops.com/archives/use-powershell-to-download-a-file-with-http-https-and-ftp/",
          "https://blog.jourdant.me/post/3-ways-to-download-files-with-powershell",
          "https://learn.microsoft.com/en-us/powershell/module/bitstransfer/add-bitsfile?view=windowsserver2019-ps"
        ],
        "falsepositives": [
          "Use of Get-Command and Get-Help modules to reference Invoke-WebRequest and Start-BitsTransfer."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_web_request_cmd_and_cmdlets.yml"
      }
    },
    {
      "id": "0ba1da6d-b6ce-4366-828c-18826c9de23e",
      "title": "Potential Defense Evasion Via Rename Of Highly Relevant Binaries",
      "status": "test",
      "description": "Detects the execution of a renamed binary often used by attackers or malware leveraging new Sysmon OriginalFileName datapoint.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036.003",
        "car.2013-05-009"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "Execute processes remotely",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Product": {
                    "field": "Product",
                    "value": "Sysinternals PsExec",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description__startswith": {
                    "field": "Description",
                    "value": [
                      "Windows PowerShell",
                      "pwsh"
                    ],
                    "modifiers": [
                      "startswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "certutil.exe",
                      "cmstp.exe",
                      "cscript.exe",
                      "IE4UINIT.EXE",
                      "mshta.exe",
                      "msiexec.exe",
                      "msxsl.exe",
                      "powershell_ise.exe",
                      "powershell.exe",
                      "psexec.c",
                      "psexec.exe",
                      "psexesvc.exe",
                      "pwsh.dll",
                      "reg.exe",
                      "regsvr32.exe",
                      "rundll32.exe",
                      "WerMgr",
                      "wmic.exe",
                      "wscript.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\certutil.exe",
                  "\\cmstp.exe",
                  "\\cscript.exe",
                  "\\ie4uinit.exe",
                  "\\mshta.exe",
                  "\\msiexec.exe",
                  "\\msxsl.exe",
                  "\\powershell_ise.exe",
                  "\\powershell.exe",
                  "\\psexec.exe",
                  "\\psexec64.exe",
                  "\\PSEXESVC.exe",
                  "\\pwsh.exe",
                  "\\reg.exe",
                  "\\regsvr32.exe",
                  "\\rundll32.exe",
                  "\\wermgr.exe",
                  "\\wmic.exe",
                  "\\wscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1036.003"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Matthew Green - @mgreen27, Florian Roth (Nextron Systems), frack113",
        "date": "2019-06-15",
        "modified": "2024-12-03",
        "references": [
          "https://mgreen27.github.io/posts/2019/05/12/BinaryRename.html",
          "https://mgreen27.github.io/posts/2019/05/29/BinaryRename2.html",
          "https://www.trendmicro.com/vinfo/hk-en/security/news/cybercrime-and-digital-threats/megacortex-ransomware-spotted-attacking-enterprise-networks",
          "https://twitter.com/christophetd/status/1164506034720952320",
          "https://threatresearch.ext.hp.com/svcready-a-new-loader-reveals-itself/"
        ],
        "falsepositives": [
          "Custom applications use renamed binaries adding slight change to binary name. Typically this is easy to spot and add to whitelist",
          "PsExec installed via Windows Store doesn't contain original filename field (False negative)"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_renamed_binary_highly_relevant.yml"
      }
    },
    {
      "id": "95e60a2b-4705-444b-b7da-ba0ea81a3ee2",
      "title": "Remote Access Tool - Simple Help Execution",
      "status": "test",
      "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1219.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  "\\JWrapper-Remote Access\\",
                  "\\JWrapper-Remote Support\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\SimpleService.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1219.002"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2024-02-23",
        "modified": "",
        "references": [
          "https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708"
        ],
        "falsepositives": [
          "Legitimate usage of the tool"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_remote_access_tools_simple_help.yml"
      }
    },
    {
      "id": "0d5675be-bc88-4172-86d3-1e96a4476536",
      "title": "Potential Tampering With RDP Related Registry Keys Via Reg.EXE",
      "status": "test",
      "description": "Detects the execution of \"reg.exe\" for enabling/disabling the RDP service on the host by tampering with the 'CurrentControlSet\\Control\\Terminal Server' values",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.lateral-movement",
        "attack.t1021.001",
        "attack.t1112"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_main_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\reg.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "reg.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_main_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " add ",
                  "\\CurrentControlSet\\Control\\Terminal Server",
                  "REG_DWORD",
                  " /f"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_values_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "Licensing Core",
                  "EnableConcurrentSessions"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_values_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "AllowTSConnections",
                  "fDenyTSConnections",
                  "fEnableWinStation",
                  "fSingleSessionPerUser",
                  "IdleWinStationPoolCount",
                  "MaxInstanceCount",
                  "SecurityLayer",
                  "TSAdvertise",
                  "TSAppCompat",
                  "TSEnabled",
                  "TSUserEnabled",
                  "WinStations\\RDP-Tcp"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_values_tls": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "SecurityLayer",
                  "02"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_main_* and 1 of selection_values_* and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "all of selection_main_*"
            },
            {
              "type": "ref",
              "value": "1 of selection_values_*"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1021.001",
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion",
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "pH-T (Nextron Systems), @Kostastsale, TheDFIRReport",
        "date": "2022-02-12",
        "modified": "2025-11-22",
        "references": [
          "https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/",
          "http://etutorials.org/Microsoft+Products/microsoft+windows+server+2003+terminal+services/Chapter+6+Registry/Registry+Keys+for+Terminal+Services/",
          "http://woshub.com/rds-shadow-how-to-connect-to-a-user-session-in-windows-server-2012-r2/",
          "https://admx.help/HKLM/SOFTWARE/Policies/Microsoft/Windows%20NT/Terminal%20Services",
          "https://bazaar.abuse.ch/sample/6f3aa9362d72e806490a8abce245331030d1ab5ac77e400dd475748236a6cc81/",
          "https://blog.sekoia.io/darkgate-internals/",
          "https://blog.talosintelligence.com/understanding-the-phobos-affiliate-structure/",
          "https://github.com/redcanaryco/atomic-red-team/blob/02c7d02fe1f1feb0fc7944550408ea8224273994/atomics/T1112/T1112.md#atomic-test-63---disable-remote-desktop-anti-alias-setting-through-registry",
          "https://github.com/redcanaryco/atomic-red-team/blob/02c7d02fe1f1feb0fc7944550408ea8224273994/atomics/T1112/T1112.md#atomic-test-64---disable-remote-desktop-security-settings-through-registry",
          "https://github.com/redcanaryco/atomic-red-team/blob/dd526047b8c399c312fee47d1e6fb531164da54d/atomics/T1112/T1112.yaml#L790",
          "https://learn.microsoft.com/en-us/windows-hardware/customize/desktop/unattend/microsoft-windows-terminalservices-rdp-winstationextensions-securitylayer",
          "https://threathunterplaybook.com/hunts/windows/190407-RegModEnableRDPConnections/notebook.html",
          "https://twitter.com/SagieSec/status/1469001618863624194?t=HRf0eA0W1YYzkTSHb-Ky1A&s=03",
          "https://web.archive.org/web/20200929062532/https://blog.menasec.net/2019/02/threat-hunting-rdp-hijacking-via.html",
          "https://www.trendmicro.com/en_us/research/25/i/unmasking-the-gentlemen-ransomware.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_reg_rdp_keys_tamper.yml"
      }
    },
    {
      "id": "c4eeeeae-89f4-43a7-8b48-8d1bdfa66c78",
      "title": "Scheduled Task Executing Encoded Payload from Registry",
      "status": "test",
      "description": "Detects the creation of a schtask that potentially executes a base64 encoded payload stored in the Windows Registry using PowerShell.",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.execution",
        "attack.persistence",
        "attack.t1053.005",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\schtasks.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "schtasks.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_create": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "/Create",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli_encoding": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "FromBase64String",
                  "encodedcommand"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_get": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Get-ItemProperty",
                  " gp "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_hive": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "HKCU:",
                  "HKLM:",
                  "registry::",
                  "HKEY_"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1053.005",
          "T1059.001"
        ],
        "tactics": [
          "privilege_escalation",
          "execution",
          "persistence"
        ]
      },
      "meta": {
        "author": "pH-T (Nextron Systems), @Kostastsale, TheDFIRReport, X__Junior (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-02-12",
        "modified": "2023-02-04",
        "references": [
          "https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_schtasks_reg_loader_encoded.yml"
      }
    },
    {
      "id": "98c5aeef-32d5-492f-b174-64a691896d25",
      "title": "Service Security Descriptor Tampering Via Sc.EXE",
      "status": "test",
      "description": "Detection of sc.exe utility adding a new service with special permission which hides that service.",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1574.011"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\sc.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "sc.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "sdset",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1574.011"
        ],
        "tactics": [
          "persistence",
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-02-28",
        "modified": "",
        "references": [
          "https://blog.talosintelligence.com/2021/10/threat-hunting-in-large-datasets-by.html",
          "https://www.sans.org/blog/red-team-tactics-hiding-windows-services/",
          "https://twitter.com/Alh4zr3d/status/1580925761996828672",
          "https://twitter.com/0gtweet/status/1628720819537936386",
          "https://itconnect.uw.edu/tools-services-support/it-systems-infrastructure/msinf/other-help/understanding-sddl-syntax/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sc_sdset_modification.yml"
      }
    },
    {
      "id": "bab049ca-7471-4828-9024-38279a4c04da",
      "title": "Virtualbox Driver Installation or Starting of VMs",
      "status": "test",
      "description": "Adversaries can carry out malicious operations using a virtual instance to avoid detection. This rule is built to detect the registration of the Virtualbox driver or start of a Virtualbox VM.",
      "level": "low",
      "tags": [
        "attack.defense-evasion",
        "attack.t1564.006",
        "attack.t1564"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "VBoxRT.dll,RTR3Init",
                  "VBoxC.dll",
                  "VBoxDrv.sys"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "startvm",
                  "controlvm"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1564.006",
          "T1564"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Janantha Marasinghe",
        "date": "2020-09-26",
        "modified": "2025-07-29",
        "references": [
          "https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/",
          "https://threatpost.com/maze-ransomware-ragnar-locker-virtual-machine/159350/"
        ],
        "falsepositives": [
          "This may have false positives on hosts where Virtualbox is legitimately being used for operations"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_virtualbox_execution.yml"
      }
    },
    {
      "id": "d2eb17db-1d39-41dc-b57f-301f6512fa75",
      "title": "Potentially Suspicious Command Targeting Teams Sensitive Files",
      "status": "test",
      "description": "Detects a commandline containing references to the Microsoft Teams database or cookies files from a process other than Teams.\nThe database might contain authentication tokens and other sensitive information about the logged in accounts.\n",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.t1528"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\Microsoft\\Teams\\Cookies",
                  "\\Microsoft\\Teams\\Local Storage\\leveldb"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_legit_locations": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\Microsoft\\Teams\\current\\Teams.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1528"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "@SerkinValery",
        "date": "2022-09-16",
        "modified": "2023-12-18",
        "references": [
          "https://www.bleepingcomputer.com/news/security/microsoft-teams-stores-auth-tokens-as-cleartext-in-windows-linux-macs/",
          "https://www.vectra.ai/blogpost/undermining-microsoft-teams-security-by-mining-tokens"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_teams_suspicious_command_line_cred_access.yml"
      }
    },
    {
      "id": "646ea171-dded-4578-8a4d-65e9822892e3",
      "title": "Process Memory Dump Via Comsvcs.DLL",
      "status": "test",
      "description": "Detects a process memory dump via \"comsvcs.dll\" using rundll32, covering multiple different techniques (ordinal, minidump function, etc.)",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.credential-access",
        "attack.t1036",
        "attack.t1003.001",
        "car.2013-05-009"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\rundll32.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "RUNDLL32.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": "rundll32",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "comsvcs",
                  "full"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "#-",
                  "#+",
                  "#24",
                  "24 ",
                  "MiniDump",
                  "#65560"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_generic": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "24",
                  "comsvcs",
                  "full"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " #",
                  ",#",
                  ", #",
                  "\"#"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "(selection_img and 1 of selection_cli_*) or selection_generic",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "(selection_img and 1 of selection_cli_*)",
            "selection_generic"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1036",
          "T1003.001"
        ],
        "tactics": [
          "defense_evasion",
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Modexp, Nasreddine Bencherchali (Nextron Systems), Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2020-02-18",
        "modified": "2025-02-23",
        "references": [
          "https://twitter.com/shantanukhande/status/1229348874298388484",
          "https://twitter.com/pythonresponder/status/1385064506049630211?s=21",
          "https://twitter.com/Hexacorn/status/1224848930795552769",
          "https://modexp.wordpress.com/2019/08/30/minidumpwritedump-via-com-services-dll/",
          "https://twitter.com/SBousseaden/status/1167417096374050817",
          "https://twitter.com/Wietze/status/1542107456507203586",
          "https://github.com/Hackndo/lsassy/blob/14d8f8ae596ecf22b449bfe919829173b8a07635/lsassy/dumpmethod/comsvcs.py",
          "https://www.youtube.com/watch?v=52tAmVLg1KM&t=2070s"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_rundll32_process_dump_via_comsvcs.yml"
      }
    },
    {
      "id": "f5e3b62f-e577-4e59-931e-0a15b2b94e1e",
      "title": "HackTool - Htran/NATBypass Execution",
      "status": "test",
      "description": "Detects executable names or flags used by Htran or Htran-like tools (e.g. NATBypass)",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1090",
        "attack.s0040"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\htran.exe",
                  "\\lcx.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ".exe -tran ",
                  ".exe -slave "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1090"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-12-27",
        "modified": "2023-02-04",
        "references": [
          "https://github.com/HiwinCN/HTran",
          "https://github.com/cw1997/NATBypass"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_htran_or_natbypass.yml"
      }
    },
    {
      "id": "d38d2fa4-98e6-4a24-aff1-410b0c9ad177",
      "title": "HackTool - UACMe Akagi Execution",
      "status": "test",
      "description": "Detects the execution of UACMe, a tool used for UAC bypasses, via default PE metadata",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_pe": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Product": {
                    "field": "Product",
                    "value": "UACMe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Company": {
                    "field": "Company",
                    "value": [
                      "REvol Corp",
                      "APT 92",
                      "UG North",
                      "Hazardous Environments",
                      "CD Project Rekt"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": [
                      "UACMe main module",
                      "Pentesting utility"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "Akagi.exe",
                      "Akagi64.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\Akagi64.exe",
                  "\\Akagi.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_hashes_sysmon": {
            "type": "field_match",
            "matchers": {
              "Hashes__contains": {
                "field": "Hashes",
                "value": [
                  "IMPHASH=767637C23BB42CD5D7397CF58B0BE688",
                  "IMPHASH=14C4E4C72BA075E9069EE67F39188AD8",
                  "IMPHASH=3C782813D4AFCE07BBFC5A9772ACDBDC",
                  "IMPHASH=7D010C6BB6A3726F327F7E239166D127",
                  "IMPHASH=89159BA4DD04E4CE5559F132A9964EB3",
                  "IMPHASH=6F33F4A5FC42B8CEC7314947BD13F30F",
                  "IMPHASH=5834ED4291BDEB928270428EBBAF7604",
                  "IMPHASH=5A8A8A43F25485E7EE1B201EDCBC7A38",
                  "IMPHASH=DC7D30B90B2D8ABF664FBED2B1B59894",
                  "IMPHASH=41923EA1F824FE63EA5BEB84DB7A3E74",
                  "IMPHASH=3DE09703C8E79ED2CA3F01074719906B"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Christian Burkard (Nextron Systems), Florian Roth (Nextron Systems)",
        "date": "2021-08-30",
        "modified": "2024-11-23",
        "references": [
          "https://github.com/hfiref0x/UACME"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_uacme.yml"
      }
    },
    {
      "id": "1a5fefe6-734f-452e-a07d-fc1c35bce4b2",
      "title": "Firewall Rule Deleted Via Netsh.EXE",
      "status": "test",
      "description": "Detects the removal of a port or application rule in the Windows Firewall configuration using netsh",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.004"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\netsh.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "netsh.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "firewall",
                  "delete "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_dropbox": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\Dropbox.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "name=Dropbox",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_avast": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\instup.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "advfirewall firewall delete rule name=\"Avast Antivirus Admin Client\"",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_optional_"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-08-14",
        "modified": "2025-10-07",
        "references": [
          "https://app.any.run/tasks/8bbd5b4c-b82d-4e6d-a3ea-d454594a37cc/"
        ],
        "falsepositives": [
          "Legitimate administration activity",
          "Software installations and removal"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_netsh_fw_delete_rule.yml"
      }
    },
    {
      "id": "1af57a4b-460a-4738-9034-db68b880c665",
      "title": "PowerShell SAM Copy",
      "status": "test",
      "description": "Detects suspicious PowerShell scripts accessing SAM hives",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "\\HarddiskVolumeShadowCopy",
                  "System32\\config\\sam"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Copy-Item",
                  "cp $_.",
                  "cpi $_.",
                  "copy $_.",
                  ".File]::Copy("
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.002"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-07-29",
        "modified": "2023-01-06",
        "references": [
          "https://twitter.com/splinter_code/status/1420546784250769408"
        ],
        "falsepositives": [
          "Some rare backup scenarios",
          "PowerShell scripts fixing HiveNightmare / SeriousSAM ACLs"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_sam_access.yml"
      }
    },
    {
      "id": "a7c3d773-caef-227e-a7e7-c2f13c622329",
      "title": "Bad Opsec Defaults Sacrificial Processes With Improper Arguments",
      "status": "test",
      "description": "Detects attackers using tooling with bad opsec defaults.\nE.g. spawning a sacrificial process to inject a capability into the process without taking into account how the process is normally run.\nOne trivial example of this is using rundll32.exe without arguments as a sacrificial process (default in CS, now highlighted by c2lint), running WerFault without arguments (Kraken - credit am0nsec), and other examples.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.011"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_werfault": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\WerFault.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": "WerFault.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_rundll32": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\rundll32.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": "rundll32.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_regsvcs": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\regsvcs.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": "regsvcs.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_regasm": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\regasm.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": "regasm.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_regsvr32": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\regsvr32.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": "regsvr32.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_edge_update": {
            "type": "field_match",
            "matchers": {
              "ParentImage__contains": {
                "field": "ParentImage",
                "value": "\\AppData\\Local\\Microsoft\\EdgeUpdate\\Install\\{",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\rundll32.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": "rundll32.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_chromium_installer": {
            "type": "field_match",
            "matchers": {
              "ParentImage__contains": {
                "field": "ParentImage",
                "value": [
                  "\\AppData\\Local\\BraveSoftware\\Brave-Browser\\Application\\",
                  "\\AppData\\Local\\Google\\Chrome\\Application\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\Installer\\setup.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "ParentCommandLine__contains": {
                "field": "ParentCommandLine",
                "value": "--uninstall ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\rundll32.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": "rundll32.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "1 of selection_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "1 of selection_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218.011"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Oleg Kolesnikov @securonix invrep_de, oscd.community, Florian Roth (Nextron Systems), Christian Burkard (Nextron Systems)",
        "date": "2020-10-23",
        "modified": "2024-08-15",
        "references": [
          "https://blog.malwarebytes.com/malwarebytes-news/2020/10/kraken-attack-abuses-wer-service/",
          "https://www.cobaltstrike.com/help-opsec",
          "https://twitter.com/CyberRaiju/status/1251492025678983169",
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/regsvr32",
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/rundll32",
          "https://learn.microsoft.com/en-us/dotnet/framework/tools/regasm-exe-assembly-registration-tool",
          "https://learn.microsoft.com/en-us/dotnet/framework/tools/regsvcs-exe-net-services-installation-tool"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_bad_opsec_sacrificial_processes.yml"
      }
    },
    {
      "id": "bb76d96b-821c-47cf-944b-7ce377864492",
      "title": "Suspicious NTLM Authentication on the Printer Spooler Service",
      "status": "test",
      "description": "Detects a privilege elevation attempt by coercing NTLM authentication on the Printer Spooler service",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.credential-access",
        "attack.t1212"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\rundll32.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "RUNDLL32.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "C:\\windows\\system32\\davclnt.dll,DavSetCookie",
                  "http"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "spoolss",
                  "srvsvc",
                  "/print/pipe/"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1212"
        ],
        "tactics": [
          "privilege_escalation",
          "credential_access"
        ]
      },
      "meta": {
        "author": "Elastic (idea), Tobias Michalski (Nextron Systems)",
        "date": "2022-05-04",
        "modified": "2023-02-09",
        "references": [
          "https://twitter.com/med0x2e/status/1520402518685200384",
          "https://github.com/elastic/detection-rules/blob/dd224fb3f81d0b4bf8593c5f02a029d647ba2b2d/rules/windows/credential_access_relay_ntlm_auth_via_http_spoolss.toml"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_rundll32_ntlmrelay.yml"
      }
    },
    {
      "id": "50d66fb0-03f8-4da0-8add-84e77d12a020",
      "title": "Suspicious RunAs-Like Flag Combination",
      "status": "test",
      "description": "Detects suspicious command line flags that let the user set a target user and command as e.g. seen in PsExec-like tools",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_user": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -u system ",
                  " --user system ",
                  " -u NT",
                  " -u \"NT",
                  " -u 'NT",
                  " --system ",
                  " -u administrator "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_command": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -c cmd",
                  " -c \"cmd",
                  " -c powershell",
                  " -c \"powershell",
                  " --command cmd",
                  " --command powershell",
                  " -c whoami",
                  " -c wscript",
                  " -c cscript"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-11-11",
        "modified": "",
        "references": [
          "https://www.trendmicro.com/en_us/research/22/k/hack-the-real-box-apt41-new-subgroup-earth-longzhi.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_privilege_escalation_cli_patterns.yml"
      }
    },
    {
      "id": "f548a603-c9f2-4c89-b511-b089f7e94549",
      "title": "Potential Persistence Via Microsoft Compatibility Appraiser",
      "status": "test",
      "description": "Detects manual execution of the \"Microsoft Compatibility Appraiser\" task via schtasks.\nIn order to trigger persistence stored in the \"\\AppCompatFlags\\TelemetryController\" registry key.\n",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.execution",
        "attack.persistence",
        "attack.t1053.005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\schtasks.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "schtasks.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "run ",
                  "\\Application Experience\\Microsoft Compatibility Appraiser"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1053.005"
        ],
        "tactics": [
          "privilege_escalation",
          "execution",
          "persistence"
        ]
      },
      "meta": {
        "author": "Sreeman",
        "date": "2020-09-29",
        "modified": "2023-02-10",
        "references": [
          "https://www.trustedsec.com/blog/abusing-windows-telemetry-for-persistence/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_schtasks_persistence_windows_telemetry.yml"
      }
    },
    {
      "id": "452bce90-6fb0-43cc-97a5-affc283139b3",
      "title": "Suspicious Windows Defender Registry Key Tampering Via Reg.EXE",
      "status": "test",
      "description": "Detects the usage of \"reg.exe\" to tamper with different Windows Defender registry keys in order to disable some important features related to protection and detection\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_root_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\reg.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "reg.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_root_path": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "SOFTWARE\\Microsoft\\Windows Defender\\",
                  "SOFTWARE\\Policies\\Microsoft\\Windows Defender Security Center",
                  "SOFTWARE\\Policies\\Microsoft\\Windows Defender\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_dword_0": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " add ",
                  "d 0"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "DisallowExploitProtectionOverride",
                  "EnableControlledFolderAccess",
                  "MpEnablePus",
                  "PUAProtection",
                  "SpynetReporting",
                  "SubmitSamplesConsent",
                  "TamperProtection"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_dword_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " add ",
                  "d 1"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "DisableAccess",
                  "DisableAntiSpyware",
                  "DisableAntiSpywareRealtimeProtection",
                  "DisableAntiVirus",
                  "DisableAntiVirusSignatures",
                  "DisableArchiveScanning",
                  "DisableBehaviorMonitoring",
                  "DisableBlockAtFirstSeen",
                  "DisableCloudProtection",
                  "DisableConfig",
                  "DisableEnhancedNotifications",
                  "DisableIntrusionPreventionSystem",
                  "DisableIOAVProtection",
                  "DisableNetworkProtection",
                  "DisableOnAccessProtection",
                  "DisablePrivacyMode",
                  "DisableRealtimeMonitoring",
                  "DisableRoutinelyTakingAction",
                  "DisableScanOnRealtimeEnable",
                  "DisableScriptScanning",
                  "DisableSecurityCenter",
                  "Notification_Suppress",
                  "SignatureDisableUpdateOnStartupWithoutEngine"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_root_* and 1 of selection_dword_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "all of selection_root_*"
            },
            {
              "type": "ref",
              "value": "1 of selection_dword_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Swachchhanda Shrawan Poudel, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-03-22",
        "modified": "2025-06-04",
        "references": [
          "https://thedfirreport.com/2022/03/21/apt35-automates-initial-access-using-proxyshell/",
          "https://github.com/swagkarna/Defeat-Defender-V1.2.0/tree/ae4059c4276da6f6303b8f53cdff085ecae88a91",
          "https://www.elevenforum.com/t/video-guide-how-to-completely-disable-microsoft-defender-antivirus.14608/page-2",
          "https://tria.ge/241231-j9yatstqbm/behavioral1"
        ],
        "falsepositives": [
          "Rare legitimate use by administrators to test software (should always be investigated)"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_reg_windows_defender_tamper.yml"
      }
    },
    {
      "id": "1e53dd56-8d83-4eb4-a43e-b790a05510aa",
      "title": "Always Install Elevated MSI Spawned Cmd And Powershell",
      "status": "test",
      "description": "Detects Windows Installer service (msiexec.exe) spawning \"cmd\" or \"powershell\"",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\cmd.exe",
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "Cmd.Exe",
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__contains_all": {
                "field": "ParentImage",
                "value": [
                  "\\Windows\\Installer\\",
                  "msi"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "tmp",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Teymur Kheirkhabarov (idea), Mangatas Tondang (rule), oscd.community",
        "date": "2020-10-13",
        "modified": "2022-10-20",
        "references": [
          "https://image.slidesharecdn.com/kheirkhabarovoffzonefinal-181117201458/95/hunting-for-privilege-escalation-in-windows-environment-50-638.jpg"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_elavated_msi_spawned_shell.yml"
      }
    },
    {
      "id": "c3d76afc-93df-461e-8e67-9b2bad3f2ac4",
      "title": "File Explorer Folder Opened Using Explorer Folder Shortcut Via Shell",
      "status": "test",
      "description": "Detects the initial execution of \"cmd.exe\" which spawns \"explorer.exe\" with the appropriate command line arguments for opening the \"My Computer\" folder.\n",
      "level": "high",
      "tags": [
        "attack.discovery",
        "attack.t1135"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\cmd.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\explorer.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "shell:mycomputerfolder",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1135"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "@Kostastsale",
        "date": "2022-12-22",
        "modified": "2024-08-23",
        "references": [
          "https://ss64.com/nt/shell.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_explorer_folder_shortcut_via_shell_binary.yml"
      }
    },
    {
      "id": "5ce0f04e-3efc-42af-839d-5b3a543b76c0",
      "title": "Suspicious Process Execution From Fake Recycle.Bin Folder",
      "status": "test",
      "description": "Detects process execution from a fake recycle bin folder, often used to avoid security solution.",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  "RECYCLERS.BIN\\",
                  "RECYCLER.BIN\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "X__Junior (Nextron Systems)",
        "date": "2023-07-12",
        "modified": "2023-12-11",
        "references": [
          "https://www.mandiant.com/resources/blog/infected-usb-steal-secrets",
          "https://unit42.paloaltonetworks.com/cloaked-ursa-phishing/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_recycle_bin_fake_execution.yml"
      }
    },
    {
      "id": "caa06de8-fdef-4c91-826a-7f9e163eef4b",
      "title": "RunDLL32 Spawning Explorer",
      "status": "test",
      "description": "Detects RunDLL32.exe spawning explorer.exe as child, which is very uncommon, often observes Gamarue spawning the explorer.exe process in an unusual way",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.011"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\rundll32.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\explorer.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "ParentCommandLine__contains": {
                "field": "ParentCommandLine",
                "value": "\\shell32.dll,Control_RunDLL",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.011"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "elhoim, CD_ROM_",
        "date": "2022-04-27",
        "modified": "2022-05-25",
        "references": [
          "https://redcanary.com/blog/intelligence-insights-november-2021/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_rundll32_spawn_explorer.yml"
      }
    },
    {
      "id": "ae9b0bd7-8888-4606-b444-0ed7410cb728",
      "title": "Writing Of Malicious Files To The Fonts Folder",
      "status": "test",
      "description": "Monitors for the hiding possible malicious files in the C:\\Windows\\Fonts\\ location. This folder doesn't require admin privillege to be written and executed from.",
      "level": "medium",
      "tags": [
        "attack.t1211",
        "attack.t1059",
        "attack.defense-evasion",
        "attack.persistence",
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "echo",
                  "copy",
                  "type",
                  "file createnew",
                  "cacls"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "C:\\Windows\\Fonts\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_3": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ".sh",
                  ".exe",
                  ".dll",
                  ".bin",
                  ".bat",
                  ".cmd",
                  ".js",
                  ".msh",
                  ".reg",
                  ".scr",
                  ".ps",
                  ".vb",
                  ".jar",
                  ".pl",
                  ".inf",
                  ".cpl",
                  ".hta",
                  ".msi",
                  ".vbs"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1211",
          "T1059"
        ],
        "tactics": [
          "defense_evasion",
          "persistence",
          "execution"
        ]
      },
      "meta": {
        "author": "Sreeman",
        "date": "2020-04-21",
        "modified": "2022-03-08",
        "references": [
          "https://thedfirreport.com/2020/04/20/sqlserver-or-the-miner-in-the-basement/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_hiding_malware_in_fonts_folder.yml"
      }
    },
    {
      "id": "4c0aaedc-154c-4427-ada0-d80ef9c9deb6",
      "title": "Process Access via TrolleyExpress Exclusion",
      "status": "test",
      "description": "Detects a possible process memory dump that uses the white-listed Citrix TrolleyExpress.exe filename as a way to dump the lsass process memory",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.011",
        "attack.credential-access",
        "attack.t1003.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\TrolleyExpress 7",
                  "\\TrolleyExpress 8",
                  "\\TrolleyExpress 9",
                  "\\TrolleyExpress.exe 7",
                  "\\TrolleyExpress.exe 8",
                  "\\TrolleyExpress.exe 9",
                  "\\TrolleyExpress.exe -ma "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "renamed": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\TrolleyExpress.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_renamed": {
            "type": "field_match",
            "matchers": {
              "OriginalFileName__contains": {
                "field": "OriginalFileName",
                "value": "CtxInstall",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_empty": {
            "type": "field_match",
            "matchers": {
              "OriginalFileName": {
                "field": "OriginalFileName",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection or ( renamed and not 1 of filter* )",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection",
            "( renamed and not 1 of filter* )"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218.011",
          "T1003.001"
        ],
        "tactics": [
          "defense_evasion",
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-02-10",
        "modified": "2022-05-13",
        "references": [
          "https://twitter.com/_xpn_/status/1491557187168178176",
          "https://www.youtube.com/watch?v=Ie831jF0bb0"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_citrix_trolleyexpress_procdump.yml"
      }
    },
    {
      "id": "6e22722b-dfb1-4508-a911-49ac840b40f8",
      "title": "Suspicious Mstsc.EXE Execution With Local RDP File",
      "status": "test",
      "description": "Detects potential RDP connection via Mstsc using a local \".rdp\" file located in suspicious locations.",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1219.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\mstsc.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "mstsc.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_extension": {
            "type": "field_match",
            "matchers": {
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": [
                  ".rdp",
                  ".rdp\""
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_paths": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ":\\Users\\Public\\",
                  ":\\Windows\\System32\\spool\\drivers\\color",
                  ":\\Windows\\System32\\Tasks_Migrated ",
                  ":\\Windows\\Tasks\\",
                  ":\\Windows\\Temp\\",
                  ":\\Windows\\Tracing\\",
                  "\\AppData\\Local\\Temp\\",
                  "\\Downloads\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1219.002"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-04-18",
        "modified": "",
        "references": [
          "https://www.blackhillsinfosec.com/rogue-rdp-revisiting-initial-access-methods/",
          "https://web.archive.org/web/20230726144748/https://blog.thickmints.dev/mintsights/detecting-rogue-rdp/"
        ],
        "falsepositives": [
          "Likelihood is related to how often the paths are used in the environment"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_mstsc_run_local_rdp_file_susp_location.yml"
      }
    },
    {
      "id": "2daa93a0-a5fb-41c5-8cd8-3c11294bfd1f",
      "title": "Potential SSH Tunnel Persistence Install Using A Scheduled Task",
      "status": "experimental",
      "description": "Detects the creation of new scheduled tasks via commandline, using Schtasks.exe. This rule detects tasks creating that call OpenSSH, which may indicate the creation of reverse SSH tunnel to the attacker's server.",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.execution",
        "attack.t1053.005",
        "attack.command-and-control"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\schtasks.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "schtasks.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_sshd": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " /create ",
                  "sshd.exe",
                  "-f"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_ssh": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " /create ",
                  "ssh.exe",
                  "-i"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_img and 1 of selection_cli_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_img"
            },
            {
              "type": "ref",
              "value": "1 of selection_cli_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1053.005"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "execution",
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Rory Duncan",
        "date": "2025-07-14",
        "modified": "",
        "references": [
          "https://thedfirreport.com/2023/10/30/netsupport-intrusion-results-in-domain-compromise/",
          "https://www.kroll.com/en/insights/publications/cyber/cactus-ransomware-prickly-new-variant-evades-detection"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_schtasks_openssh_tunnelling.yml"
      }
    },
    {
      "id": "4eddc365-79b4-43ff-a9d7-99422dc34b93",
      "title": "Use of Remote.exe",
      "status": "test",
      "description": "Remote.exe is part of WinDbg in the Windows SDK and can be used for AWL bypass and running remote files.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1127"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\remote.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "remote.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1127"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Christopher Peacock @SecurePeacock, SCYTHE @scythe_io",
        "date": "2022-06-02",
        "modified": "",
        "references": [
          "https://blog.thecybersecuritytutor.com/Exeuction-AWL-Bypass-Remote-exe-LOLBin/",
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Remote/"
        ],
        "falsepositives": [
          "Approved installs of Windows SDK with Debugging Tools for Windows (WinDbg)."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_remote.yml"
      }
    },
    {
      "id": "fdfcbd78-48f1-4a4b-90ac-d82241e368c5",
      "title": "PsExec Service Execution",
      "status": "test",
      "description": "Detects launch of the PSEXESVC service, which means that this system was the target of a psexec remote execution",
      "level": "medium",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image": {
                    "field": "Image",
                    "value": "C:\\Windows\\PSEXESVC.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "psexesvc.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Thomas Patzke, Romaissa Adjailia, Florian Roth (Nextron Systems)",
        "date": "2017-06-12",
        "modified": "2023-02-28",
        "references": [
          "https://learn.microsoft.com/en-us/sysinternals/downloads/psexec",
          "https://www.youtube.com/watch?v=ro2QuZTIMBM"
        ],
        "falsepositives": [
          "Legitimate administrative tasks"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sysinternals_psexesvc.yml"
      }
    },
    {
      "id": "d3c3861d-c504-4c77-ba55-224ba82d0118",
      "title": "New Network Trace Capture Started Via Netsh.EXE",
      "status": "test",
      "description": "Detects the execution of netsh with the \"trace\" flag in order to start a network capture",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.credential-access",
        "attack.t1040"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\netsh.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "netsh.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "trace",
                  "start"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1040"
        ],
        "tactics": [
          "discovery",
          "credential_access"
        ]
      },
      "meta": {
        "author": "Kutepov Anton, oscd.community",
        "date": "2019-10-24",
        "modified": "2023-02-13",
        "references": [
          "https://blogs.msdn.microsoft.com/canberrapfe/2012/03/30/capture-a-network-trace-without-installing-anything-capture-a-network-trace-of-a-reboot/",
          "https://klausjochem.me/2016/02/03/netsh-the-cyber-attackers-tool-of-choice/"
        ],
        "falsepositives": [
          "Legitimate administration activity"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_netsh_packet_capture.yml"
      }
    },
    {
      "id": "dd3ee8cc-f751-41c9-ba53-5a32ed47e563",
      "title": "Suspicious Reg Add Open Command",
      "status": "test",
      "description": "Threat actors performed dumping of SAM, SECURITY and SYSTEM registry hives using DelegateExecute key",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.t1003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "reg",
                  "add",
                  "hkcu\\software\\classes\\ms-settings\\shell\\open\\command",
                  "/ve ",
                  "/d"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "reg",
                  "add",
                  "hkcu\\software\\classes\\ms-settings\\shell\\open\\command",
                  "/v",
                  "DelegateExecute"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_3": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "reg",
                  "delete",
                  "hkcu\\software\\classes\\ms-settings"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1003"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-12-20",
        "modified": "2022-12-25",
        "references": [
          "https://thedfirreport.com/2021/12/13/diavol-ransomware/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_reg_open_command.yml"
      }
    },
    {
      "id": "8834e2f7-6b4b-4f09-8906-d2276470ee23",
      "title": "PsExec/PAExec Escalation to LOCAL SYSTEM",
      "status": "test",
      "description": "Detects suspicious commandline flags used by PsExec and PAExec to escalate a command line to LOCAL_SYSTEM rights",
      "level": "high",
      "tags": [
        "attack.resource-development",
        "attack.t1587.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_sys": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -s cmd",
                  " -s -i cmd",
                  " -i -s cmd",
                  " -s pwsh",
                  " -s -i pwsh",
                  " -i -s pwsh",
                  " -s powershell",
                  " -s -i powershell",
                  " -i -s powershell"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_other": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "psexec",
                  "paexec",
                  "accepteula"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1587.001"
        ],
        "tactics": [
          "resource_development"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2021-11-23",
        "modified": "2024-03-05",
        "references": [
          "https://learn.microsoft.com/en-us/sysinternals/downloads/psexec",
          "https://www.poweradmin.com/paexec/",
          "https://www.fireeye.com/blog/threat-research/2020/10/kegtap-and-singlemalt-with-a-ransomware-chaser.html"
        ],
        "falsepositives": [
          "Admins that use PsExec or PAExec to escalate to the SYSTEM account for maintenance purposes (rare)",
          "Users that debug Microsoft Intune issues using the commands mentioned in the official documentation; see https://learn.microsoft.com/en-us/mem/intune/apps/intune-management-extension"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sysinternals_psexec_paexec_escalate_system.yml"
      }
    },
    {
      "id": "c86133ad-4725-4bd0-8170-210788e0a7ba",
      "title": "Net WebClient Casing Anomalies",
      "status": "test",
      "description": "Detects PowerShell command line contents that include a suspicious abnormal casing in the Net.Webclient (e.g. nEt.WEbCliEnT) string as used in obfuscation techniques",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_encoded": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "TgBlAFQALgB3AEUAQg",
                  "4AZQBUAC4AdwBFAEIA",
                  "OAGUAVAAuAHcARQBCA",
                  "bgBFAHQALgB3AGUAYg",
                  "4ARQB0AC4AdwBlAGIA",
                  "uAEUAdAAuAHcAZQBiA",
                  "TgBFAHQALgB3AGUAYg",
                  "OAEUAdAAuAHcAZQBiA",
                  "bgBlAFQALgB3AGUAYg",
                  "4AZQBUAC4AdwBlAGIA",
                  "uAGUAVAAuAHcAZQBiA",
                  "TgBlAFQALgB3AGUAYg",
                  "OAGUAVAAuAHcAZQBiA",
                  "bgBFAFQALgB3AGUAYg",
                  "4ARQBUAC4AdwBlAGIA",
                  "uAEUAVAAuAHcAZQBiA",
                  "bgBlAHQALgBXAGUAYg",
                  "4AZQB0AC4AVwBlAGIA",
                  "uAGUAdAAuAFcAZQBiA",
                  "bgBFAHQALgBXAGUAYg",
                  "4ARQB0AC4AVwBlAGIA",
                  "uAEUAdAAuAFcAZQBiA",
                  "TgBFAHQALgBXAGUAYg",
                  "OAEUAdAAuAFcAZQBiA",
                  "bgBlAFQALgBXAGUAYg",
                  "4AZQBUAC4AVwBlAGIA",
                  "uAGUAVAAuAFcAZQBiA",
                  "TgBlAFQALgBXAGUAYg",
                  "OAGUAVAAuAFcAZQBiA",
                  "bgBFAFQALgBXAGUAYg",
                  "4ARQBUAC4AVwBlAGIA",
                  "uAEUAVAAuAFcAZQBiA",
                  "bgBlAHQALgB3AEUAYg",
                  "4AZQB0AC4AdwBFAGIA",
                  "uAGUAdAAuAHcARQBiA",
                  "TgBlAHQALgB3AEUAYg",
                  "OAGUAdAAuAHcARQBiA",
                  "bgBFAHQALgB3AEUAYg",
                  "4ARQB0AC4AdwBFAGIA",
                  "uAEUAdAAuAHcARQBiA",
                  "TgBFAHQALgB3AEUAYg",
                  "OAEUAdAAuAHcARQBiA",
                  "bgBlAFQALgB3AEUAYg",
                  "4AZQBUAC4AdwBFAGIA",
                  "uAGUAVAAuAHcARQBiA",
                  "TgBlAFQALgB3AEUAYg",
                  "OAGUAVAAuAHcARQBiA",
                  "bgBFAFQALgB3AEUAYg",
                  "4ARQBUAC4AdwBFAGIA",
                  "uAEUAVAAuAHcARQBiA",
                  "TgBFAFQALgB3AEUAYg",
                  "OAEUAVAAuAHcARQBiA",
                  "bgBlAHQALgBXAEUAYg",
                  "4AZQB0AC4AVwBFAGIA",
                  "uAGUAdAAuAFcARQBiA",
                  "TgBlAHQALgBXAEUAYg",
                  "OAGUAdAAuAFcARQBiA",
                  "bgBFAHQALgBXAEUAYg",
                  "4ARQB0AC4AVwBFAGIA",
                  "uAEUAdAAuAFcARQBiA",
                  "TgBFAHQALgBXAEUAYg",
                  "OAEUAdAAuAFcARQBiA",
                  "bgBlAFQALgBXAEUAYg",
                  "4AZQBUAC4AVwBFAGIA",
                  "uAGUAVAAuAFcARQBiA",
                  "TgBlAFQALgBXAEUAYg",
                  "OAGUAVAAuAFcARQBiA",
                  "bgBFAFQALgBXAEUAYg",
                  "4ARQBUAC4AVwBFAGIA",
                  "uAEUAVAAuAFcARQBiA",
                  "TgBFAFQALgBXAEUAYg",
                  "OAEUAVAAuAFcARQBiA",
                  "bgBlAHQALgB3AGUAQg",
                  "4AZQB0AC4AdwBlAEIA",
                  "uAGUAdAAuAHcAZQBCA",
                  "TgBlAHQALgB3AGUAQg",
                  "OAGUAdAAuAHcAZQBCA",
                  "bgBFAHQALgB3AGUAQg",
                  "4ARQB0AC4AdwBlAEIA",
                  "uAEUAdAAuAHcAZQBCA",
                  "TgBFAHQALgB3AGUAQg",
                  "OAEUAdAAuAHcAZQBCA",
                  "bgBlAFQALgB3AGUAQg",
                  "4AZQBUAC4AdwBlAEIA",
                  "uAGUAVAAuAHcAZQBCA",
                  "TgBlAFQALgB3AGUAQg",
                  "OAGUAVAAuAHcAZQBCA",
                  "bgBFAFQALgB3AGUAQg",
                  "4ARQBUAC4AdwBlAEIA",
                  "uAEUAVAAuAHcAZQBCA",
                  "TgBFAFQALgB3AGUAQg",
                  "OAEUAVAAuAHcAZQBCA",
                  "bgBlAHQALgBXAGUAQg",
                  "4AZQB0AC4AVwBlAEIA",
                  "uAGUAdAAuAFcAZQBCA",
                  "TgBlAHQALgBXAGUAQg",
                  "OAGUAdAAuAFcAZQBCA",
                  "bgBFAHQALgBXAGUAQg",
                  "4ARQB0AC4AVwBlAEIA",
                  "uAEUAdAAuAFcAZQBCA",
                  "TgBFAHQALgBXAGUAQg",
                  "OAEUAdAAuAFcAZQBCA",
                  "bgBlAFQALgBXAGUAQg",
                  "4AZQBUAC4AVwBlAEIA",
                  "uAGUAVAAuAFcAZQBCA",
                  "TgBlAFQALgBXAGUAQg",
                  "OAGUAVAAuAFcAZQBCA",
                  "bgBFAFQALgBXAGUAQg",
                  "4ARQBUAC4AVwBlAEIA",
                  "uAEUAVAAuAFcAZQBCA",
                  "TgBFAFQALgBXAGUAQg",
                  "OAEUAVAAuAFcAZQBCA",
                  "bgBlAHQALgB3AEUAQg",
                  "4AZQB0AC4AdwBFAEIA",
                  "uAGUAdAAuAHcARQBCA",
                  "TgBlAHQALgB3AEUAQg",
                  "OAGUAdAAuAHcARQBCA",
                  "bgBFAHQALgB3AEUAQg",
                  "4ARQB0AC4AdwBFAEIA",
                  "uAEUAdAAuAHcARQBCA",
                  "TgBFAHQALgB3AEUAQg",
                  "OAEUAdAAuAHcARQBCA",
                  "bgBlAFQALgB3AEUAQg",
                  "uAGUAVAAuAHcARQBCA",
                  "bgBFAFQALgB3AEUAQg",
                  "4ARQBUAC4AdwBFAEIA",
                  "uAEUAVAAuAHcARQBCA",
                  "TgBFAFQALgB3AEUAQg",
                  "OAEUAVAAuAHcARQBCA",
                  "TgBlAHQALgBXAEUAQg",
                  "4AZQB0AC4AVwBFAEIA",
                  "OAGUAdAAuAFcARQBCA",
                  "bgBFAHQALgBXAEUAQg",
                  "4ARQB0AC4AVwBFAEIA",
                  "uAEUAdAAuAFcARQBCA",
                  "TgBFAHQALgBXAEUAQg",
                  "OAEUAdAAuAFcARQBCA",
                  "bgBlAFQALgBXAEUAQg",
                  "4AZQBUAC4AVwBFAEIA",
                  "uAGUAVAAuAFcARQBCA",
                  "TgBlAFQALgBXAEUAQg",
                  "OAGUAVAAuAFcARQBCA",
                  "bgBFAFQALgBXAEUAQg",
                  "4ARQBUAC4AVwBFAEIA",
                  "uAEUAVAAuAFcARQBCA"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-05-24",
        "modified": "2023-01-05",
        "references": [
          "https://app.any.run/tasks/b9040c63-c140-479b-ad59-f1bb56ce7a97/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_webclient_casing.yml"
      }
    },
    {
      "id": "d7bcd677-645d-4691-a8d4-7a5602b780d1",
      "title": "Potential PowerShell Command Line Obfuscation",
      "status": "test",
      "description": "Detects the PowerShell command lines with special characters",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.defense-evasion",
        "attack.t1027",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_re": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__re": {
                    "field": "CommandLine",
                    "value": "\\+.*\\+.*\\+.*\\+.*\\+.*\\+.*\\+.*\\+.*\\+.*\\+.*\\+.*\\+.*\\+.*\\+",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__re": {
                    "field": "CommandLine",
                    "value": "\\{.*\\{.*\\{.*\\{.*\\{.*\\{.*\\{.*\\{.*\\{.*\\{",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__re": {
                    "field": "CommandLine",
                    "value": "\\^.*\\^.*\\^.*\\^.*\\^",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__re": {
                    "field": "CommandLine",
                    "value": "`.*`.*`.*`.*`",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_optional_amazonSSM": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": "C:\\Program Files\\Amazon\\SSM\\ssm-document-worker.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_defender_atp": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "new EventSource(\"Microsoft.Windows.Sense.Client.Management\"",
                  "public static extern bool InstallELAMCertificateInfo(SafeFileHandle handle);"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_optional_"
        }
      },
      "mitre": {
        "techniques": [
          "T1027",
          "T1059.001"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Teymur Kheirkhabarov (idea), Vasiliy Burov (rule), oscd.community, Tim Shelton (fp)",
        "date": "2020-10-15",
        "modified": "2024-04-15",
        "references": [
          "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse?slide=64"
        ],
        "falsepositives": [
          "Amazon SSM Document Worker",
          "Windows Defender ATP"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_cmdline_special_characters.yml"
      }
    },
    {
      "id": "0a98a10c-685d-4ab0-bddc-b6bdd1d48458",
      "title": "Uncommon Userinit Child Process",
      "status": "test",
      "description": "Detects uncommon \"userinit.exe\" child processes, which could be a sign of uncommon shells or login scripts used for persistence.",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.t1037.001",
        "attack.persistence"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\userinit.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_explorer": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": ":\\WINDOWS\\explorer.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_logonscripts": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "netlogon.bat",
                  "UsrLogon.cmd"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_windows_core": {
            "type": "field_match",
            "matchers": {
              "CommandLine": {
                "field": "CommandLine",
                "value": "PowerShell.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_proquota": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  ":\\Windows\\System32\\proquota.exe",
                  ":\\Windows\\SysWOW64\\proquota.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_citrix": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  ":\\Program Files (x86)\\Citrix\\HDX\\bin\\cmstart.exe",
                  ":\\Program Files (x86)\\Citrix\\HDX\\bin\\icast.exe",
                  ":\\Program Files (x86)\\Citrix\\System32\\icast.exe",
                  ":\\Program Files\\Citrix\\HDX\\bin\\cmstart.exe",
                  ":\\Program Files\\Citrix\\HDX\\bin\\icast.exe",
                  ":\\Program Files\\Citrix\\System32\\icast.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_image_null": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1037.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Tom Ueltschi (@c_APT_ure), Tim Shelton",
        "date": "2019-01-12",
        "modified": "2023-11-14",
        "references": [
          "https://cocomelonc.github.io/persistence/2022/12/09/malware-pers-20.html",
          "https://learn.microsoft.com/en-us/windows-server/administration/server-core/server-core-sconfig#powershell-is-the-default-shell-on-server-core"
        ],
        "falsepositives": [
          "Legitimate logon scripts or custom shells may trigger false positives. Apply additional filters accordingly."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_userinit_uncommon_child_processes.yml"
      }
    },
    {
      "id": "97a80ec7-0e2f-4d05-9ef4-65760e634f6b",
      "title": "Security Privileges Enumeration Via Whoami.EXE",
      "status": "test",
      "description": "Detects a whoami.exe executed with the /priv command line flag instructing the tool to show all current user privileges. This is often used after a privilege escalation attempt.",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.discovery",
        "attack.t1033"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\whoami.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "whoami.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " /priv",
                  " -priv"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1033"
        ],
        "tactics": [
          "privilege_escalation",
          "discovery"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-05-05",
        "modified": "2023-02-28",
        "references": [
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/whoami"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_whoami_priv_discovery.yml"
      }
    },
    {
      "id": "8e0bb260-d4b2-4fff-bb8d-3f82118e6892",
      "title": "Potentially Suspicious CMD Shell Output Redirect",
      "status": "test",
      "description": "Detects inline Windows shell commands redirecting output via the \">\" symbol to a suspicious location.\nThis technique is sometimes used by malicious actors in order to redirect the output of reconnaissance commands such as \"hostname\" and \"dir\" to files for future exfiltration.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\cmd.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "Cmd.Exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ">?%APPDATA%\\",
                  ">?%TEMP%\\",
                  ">?%TMP%\\",
                  ">?%USERPROFILE%\\",
                  ">?C:\\ProgramData\\",
                  ">?C:\\Temp\\",
                  ">?C:\\Users\\Public\\",
                  ">?C:\\Windows\\Temp\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " >",
                  "\">",
                  "'>"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "C:\\Users\\",
                  "\\AppData\\Local\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_img and 1 of selection_cli_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_img"
            },
            {
              "type": "ref",
              "value": "1 of selection_cli_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-07-12",
        "modified": "2024-03-19",
        "references": [
          "https://thedfirreport.com/2022/07/11/select-xmrig-from-sqlserver/"
        ],
        "falsepositives": [
          "Legitimate admin or third party scripts used for diagnostic collection might generate some false positives"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_cmd_redirection_susp_folder.yml"
      }
    },
    {
      "id": "48bbc537-b652-4b4e-bd1d-281172df448f",
      "title": "Sysinternals PsSuspend Execution",
      "status": "test",
      "description": "Detects usage of Sysinternals PsSuspend which can be abused to suspend critical processes",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.discovery",
        "attack.persistence",
        "attack.t1543.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "pssuspend.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\pssuspend.exe",
                      "\\pssuspend64.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1543.003"
        ],
        "tactics": [
          "privilege_escalation",
          "discovery",
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-03-23",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/sysinternals/downloads/pssuspend",
          "https://twitter.com/0gtweet/status/1638069413717975046"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sysinternals_pssuspend_execution.yml"
      }
    },
    {
      "id": "3e3ceccd-6c06-48b8-b5ff-ab1d25db8c1d",
      "title": "Hardware Model Reconnaissance Via Wmic.EXE",
      "status": "test",
      "description": "Detects the execution of WMIC with the \"csproduct\" which is used to obtain information such as hardware models and vendor information",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1047",
        "car.2016-03-002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\wmic.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "wmic.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "csproduct",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1047"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2023-02-14",
        "modified": "",
        "references": [
          "https://jonconwayuk.wordpress.com/2014/01/31/wmic-csproduct-using-wmi-to-identify-make-and-model-of-hardware/",
          "https://www.uptycs.com/blog/kuraystealer-a-bandit-using-discord-webhooks"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wmic_recon_csproduct.yml"
      }
    },
    {
      "id": "4e762605-34a8-406d-b72e-c1a089313320",
      "title": "Potential Fake Instance Of Hxtsr.EXE Executed",
      "status": "test",
      "description": "HxTsr.exe is a Microsoft compressed executable file called Microsoft Outlook Communications.\nHxTsr.exe is part of Outlook apps, because it resides in a hidden \"WindowsApps\" subfolder of \"C:\\Program Files\".\nAny instances of hxtsr.exe not in this folder may be malware camouflaging itself as HxTsr.exe\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\hxtsr.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_hxtsr": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": ":\\program files\\windowsapps\\microsoft.windowscommunicationsapps_",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\hxtsr.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1036"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Sreeman",
        "date": "2020-04-17",
        "modified": "2024-02-08",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hxtsr_masquerading.yml"
      }
    },
    {
      "id": "add64136-62e5-48ea-807e-88638d02df1e",
      "title": "Fsutil Suspicious Invocation",
      "status": "stable",
      "description": "Detects suspicious parameters of fsutil (deleting USN journal, configuring it with small size, etc).\nMight be used by ransomwares during the attack (seen by NotPetya and others).\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.impact",
        "attack.t1070",
        "attack.t1485"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\fsutil.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "fsutil.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "deletejournal",
                  "createjournal",
                  "setZeroData"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1070",
          "T1485"
        ],
        "tactics": [
          "defense_evasion",
          "impact"
        ]
      },
      "meta": {
        "author": "Ecco, E.M. Anhaus, oscd.community",
        "date": "2019-09-26",
        "modified": "2023-09-09",
        "references": [
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/fsutil-usn",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070/T1070.md",
          "https://eqllib.readthedocs.io/en/latest/analytics/c91f422a-5214-4b17-8664-c5fcf115c0a2.html",
          "https://github.com/albertzsigovits/malware-notes/blob/558898932c1579ff589290092a2c8febefc3a4c9/Ransomware/Lockbit.md",
          "https://blog.cluster25.duskrise.com/2023/05/22/back-in-black-blackbyte-nt"
        ],
        "falsepositives": [
          "Admin activity",
          "Scripts and administrative tools used in the monitored environment"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_fsutil_usage.yml"
      }
    },
    {
      "id": "4f7a6757-ff79-46db-9687-66501a02d9ec",
      "title": "Active Directory Structure Export Via Ldifde.EXE",
      "status": "test",
      "description": "Detects the execution of \"ldifde.exe\" in order to export organizational Active Directory structure.",
      "level": "medium",
      "tags": [
        "attack.exfiltration"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_ldif": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\ldifde.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "ldifde.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cmd": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-f",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_import": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -i",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "exfiltration"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-03-14",
        "modified": "",
        "references": [
          "https://businessinsights.bitdefender.com/deep-dive-into-a-backdoordiplomacy-attack-a-study-of-an-attackers-toolkit",
          "https://www.documentcloud.org/documents/5743766-Global-Threat-Report-2019.html",
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc731033(v=ws.11)"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_ldifde_export.yml"
      }
    },
    {
      "id": "26d3f0a2-f514-4a3f-a8a7-e7e48a8d9160",
      "title": "PUA - Adidnsdump Execution",
      "status": "test",
      "description": "This tool enables enumeration and exporting of all DNS records in the zone for recon purposes of internal networks Python 3 and python.exe must be installed,\nUsee to Query/modify DNS records for Active Directory integrated DNS via LDAP\n",
      "level": "low",
      "tags": [
        "attack.discovery",
        "attack.t1018"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\python.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "adidnsdump",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1018"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-01",
        "modified": "2023-02-21",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1018/T1018.md#atomic-test-9---remote-system-discovery---adidnsdump"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_python_adidnsdump.yml"
      }
    },
    {
      "id": "3c89a1e8-0fba-449e-8f1b-8409d6267ec8",
      "title": "Suspicious Process Created Via Wmic.EXE",
      "status": "test",
      "description": "Detects WMIC executing \"process call create\" with suspicious calls to processes such as \"rundll32\", \"regsrv32\", etc.",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1047"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "process ",
                  "call ",
                  "create "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "rundll32",
                  "bitsadmin",
                  "regsvr32",
                  "cmd.exe /c ",
                  "cmd.exe /k ",
                  "cmd.exe /r ",
                  "cmd /c ",
                  "cmd /k ",
                  "cmd /r ",
                  "powershell",
                  "pwsh",
                  "certutil",
                  "cscript",
                  "wscript",
                  "mshta",
                  "\\Users\\Public\\",
                  "\\Windows\\Temp\\",
                  "\\AppData\\Local\\",
                  "%temp%",
                  "%tmp%",
                  "%ProgramData%",
                  "%appdata%",
                  "%comspec%",
                  "%localappdata%"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1047"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2020-10-12",
        "modified": "2023-02-14",
        "references": [
          "https://thedfirreport.com/2020/10/08/ryuks-return/",
          "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ransomware-hive-conti-avoslocker"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wmic_susp_process_creation.yml"
      }
    },
    {
      "id": "c4e49831-1496-40cf-8ce1-b53f942b02f9",
      "title": "Renamed PAExec Execution",
      "status": "test",
      "description": "Detects execution of renamed version of PAExec. Often used by attackers",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1202"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "PAExec Application",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "PAExec.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Product__contains": {
                    "field": "Product",
                    "value": "PAExec",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Hashes__contains": {
                    "field": "Hashes",
                    "value": [
                      "IMPHASH=11D40A7B7876288F919AB819CC2D9802",
                      "IMPHASH=6444f8a34e99b8f7d9647de66aabe516",
                      "IMPHASH=dfd6aa3f7b2b1035b76b718f1ddc689f",
                      "IMPHASH=1a6cca4d5460b1710a12dea39e4a592c"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_main_known_location": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\paexec.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__startswith": {
                    "field": "Image",
                    "value": "C:\\Windows\\PAExec-",
                    "modifiers": [
                      "startswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1202"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Jason Lynch",
        "date": "2021-05-22",
        "modified": "2024-11-23",
        "references": [
          "https://www.poweradmin.com/paexec/",
          "https://summit.fireeye.com/content/dam/fireeye-www/summit/cds-2018/presentations/cds18-technical-s05-att&cking-fin7.pdf"
        ],
        "falsepositives": [
          "Weird admins that rename their tools",
          "Software companies that bundle PAExec with their software and rename it, so that it is less embarrassing",
          "When executed with the \"-s\" flag. PAExec will copy itself to the \"C:\\Windows\\\" directory with a different name. Usually like this \"PAExec-[XXXXX]-[ComputerName]\""
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_renamed_paexec.yml"
      }
    },
    {
      "id": "1ac14d38-3dfc-4635-92c7-e3fd1c5f5bfc",
      "title": "Winrar Compressing Dump Files",
      "status": "test",
      "description": "Detects execution of WinRAR in order to compress a file with a \".dmp\"/\".dump\" extension, which could be a step in a process of dump file exfiltration.",
      "level": "medium",
      "tags": [
        "attack.collection",
        "attack.t1560.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\rar.exe",
                      "\\winrar.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "Command line RAR",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_extension": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ".dmp",
                  ".dump",
                  ".hdmp"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1560.001"
        ],
        "tactics": [
          "collection"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-01-04",
        "modified": "2023-09-12",
        "references": [
          "https://www.crowdstrike.com/blog/overwatch-exposes-aquatic-panda-in-possession-of-log-4-shell-exploit-tools/"
        ],
        "falsepositives": [
          "Legitimate use of WinRAR with a command line in which \".dmp\" or \".dump\" appears accidentally",
          "Legitimate use of WinRAR to compress WER \".dmp\" files for troubleshooting"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_winrar_exfil_dmp_files.yml"
      }
    },
    {
      "id": "129966c9-de17-4334-a123-8b58172e664d",
      "title": "Potential Windows Defender AV Bypass Via Dump64.EXE Rename",
      "status": "test",
      "description": "Detects when a user is potentially trying to bypass the Windows Defender AV by renaming a tool to dump64.exe and placing it in the Visual Studio folder.\nCurrently the rule is covering only usage of procdump but other utilities can be added in order to increase coverage.\n",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_dump": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": ":\\Program Files",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__contains": {
                "field": "Image",
                "value": "\\Microsoft Visual Studio\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\dump64.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_tools_procdump": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "procdump",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      " -ma ",
                      " -mp "
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection_dump and 1 of selection_tools_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_dump"
            },
            {
              "type": "ref",
              "value": "1 of selection_tools_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1003.001"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Austin Songer @austinsonger, Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2021-11-26",
        "modified": "2024-06-21",
        "references": [
          "https://twitter.com/mrd0x/status/1460597833917251595"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_dump64_defender_av_bypass_rename.yml"
      }
    },
    {
      "id": "4fd6b1c7-19b8-4488-97f6-00f0924991a3",
      "title": "PUA - NimScan Execution",
      "status": "test",
      "description": "Detects usage of NimScan, a portscanner utility.\nIn early 2025, adversaries were observed using this utility to scan for open ports on remote hosts in a compromised environment.\nThis rule identifies the execution of NimScan based on the process image name and specific hash values associated with different versions of the tool.\n",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.t1046"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\NimScan.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Hashes__contains": {
                    "field": "Hashes",
                    "value": [
                      "IMPHASH=41BB1C7571B3A724EB83A1D2B96DBB8C",
                      "IMPHASH=B1B6ADACB172795480179EFD18A29549",
                      "IMPHASH=0D1F896DC7642AD8384F9042F30279C2"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1046"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-02-05",
        "modified": "",
        "references": [
          "https://x.com/cyberfeeddigest/status/1887041526397587859",
          "https://github.com/elddy/NimScan"
        ],
        "falsepositives": [
          "Legitimate administrator activity"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_nimscan.yml"
      }
    },
    {
      "id": "58f50261-c53b-4c88-bd12-1d71f12eda4c",
      "title": "Windows Credential Manager Access via VaultCmd",
      "status": "test",
      "description": "List credentials currently stored in Windows Credential Manager via the native Windows utility vaultcmd.exe",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.t1555.004"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\VaultCmd.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "VAULTCMD.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "/listcreds:",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1555.004"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-04-08",
        "modified": "2022-05-13",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1555.004/T1555.004.md#atomic-test-1---access-saved-credentials-via-vaultcmd"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_vaultcmd_list_creds.yml"
      }
    },
    {
      "id": "20a5ffa1-3848-4584-b6f8-c7c7fd9f69c8",
      "title": "Ruby Inline Command Execution",
      "status": "test",
      "description": "Detects execution of ruby using the \"-e\" flag. This is could be used as a way to launch a reverse shell or execute live ruby code.",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\ruby.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "ruby.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -e",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-01-02",
        "modified": "",
        "references": [
          "https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet",
          "https://www.revshells.com/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_ruby_inline_command_execution.yml"
      }
    },
    {
      "id": "d7662ff6-9e97-4596-a61d-9839e32dee8d",
      "title": "Add SafeBoot Keys Via Reg Utility",
      "status": "test",
      "description": "Detects execution of \"reg.exe\" commands with the \"add\" or \"copy\" flags on safe boot registry keys. Often used by attacker to allow the ransomware to work in safe mode as some security products do not",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\reg.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "reg.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_safeboot": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_flag": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " copy ",
                  " add "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-09-02",
        "modified": "2024-03-19",
        "references": [
          "https://redacted.com/blog/bianlian-ransomware-gang-gives-it-a-go/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_reg_add_safeboot.yml"
      }
    },
    {
      "id": "f5d19838-41b5-476c-98d8-ba8af4929ee2",
      "title": "LOL-Binary Copied From System Directory",
      "status": "test",
      "description": "Detects a suspicious copy operation that tries to copy a known LOLBIN from system (System32, SysWOW64, WinSxS) directories to another on disk in order to bypass detections based on locations.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_tools_cmd": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\cmd.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "copy ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_tools_pwsh": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\powershell.exe",
                  "\\pwsh.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "copy-item",
                  " copy ",
                  "cpi ",
                  " cp "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_tools_other": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\robocopy.exe",
                      "\\xcopy.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "robocopy.exe",
                      "XCOPY.EXE"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_target_path": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\System32",
                  "\\SysWOW64",
                  "\\WinSxS"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_target_lolbin": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\bitsadmin.exe",
                  "\\calc.exe",
                  "\\certutil.exe",
                  "\\cmdl32.exe",
                  "\\cscript.exe",
                  "\\mshta.exe",
                  "\\rundll32.exe",
                  "\\wscript.exe",
                  "\\ie4uinit.exe"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_tools_* and all of selection_target_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "1 of selection_tools_*"
            },
            {
              "type": "ref",
              "value": "all of selection_target_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1036.003"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-08-29",
        "modified": "2025-11-27",
        "references": [
          "https://www.hybrid-analysis.com/sample/8da5b75b6380a41eee3a399c43dfe0d99eeefaa1fd21027a07b1ecaa4cd96fdd?environmentId=120",
          "https://web.archive.org/web/20180331144337/https://www.fireeye.com/blog/threat-research/2018/03/sanny-malware-delivery-method-updated-in-recently-observed-attacks.html",
          "https://thedfirreport.com/2023/08/28/html-smuggling-leads-to-domain-wide-ransomware/",
          "https://www.virustotal.com/gui/file/14e722855605ba78dc1d21153f0e1be90e7528149f2cd2d7d6eba8ef27534bdc/behavior"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_copy_system_dir_lolbin.yml"
      }
    },
    {
      "id": "89a9a0e0-f61a-42e5-8957-b1479565a658",
      "title": "UAC Bypass WSReset",
      "status": "test",
      "description": "Detects the pattern of UAC Bypass via WSReset usable by default sysmon-config",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\wsreset.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "IntegrityLevel": {
                "field": "IntegrityLevel",
                "value": [
                  "High",
                  "System",
                  "S-1-16-16384",
                  "S-1-16-12288"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Christian Burkard (Nextron Systems)",
        "date": "2021-08-23",
        "modified": "2024-12-01",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Wsreset/",
          "https://github.com/hfiref0x/UACME",
          "https://medium.com/falconforce/falconfriday-detecting-uac-bypasses-0xff16-86c2a9107abf"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_uac_bypass_wsreset_integrity_level.yml"
      }
    },
    {
      "id": "0ea52357-cd59-4340-9981-c46c7e900428",
      "title": "Potentially Suspicious Rundll32.EXE Execution of UDL File",
      "status": "test",
      "description": "Detects the execution of rundll32.exe with the oledb32.dll library to open a UDL file.\nThreat actors can abuse this technique as a phishing vector to capture authentication credentials or other sensitive data.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.execution",
        "attack.command-and-control",
        "attack.t1218.011",
        "attack.t1071"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\explorer.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\rundll32.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "RUNDLL32.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "oledb32.dll",
                  ",OpenDSLFile ",
                  "\\\\Users\\\\*\\\\Downloads\\\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": ".udl",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.011",
          "T1071"
        ],
        "tactics": [
          "defense_evasion",
          "execution",
          "command_and_control"
        ]
      },
      "meta": {
        "author": "@kostastsale",
        "date": "2024-08-16",
        "modified": "",
        "references": [
          "https://trustedsec.com/blog/oops-i-udld-it-again"
        ],
        "falsepositives": [
          "UDL files serve as a convenient and flexible tool for managing and testing database connections in various development and administrative scenarios."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_rundll32_udl_exec.yml"
      }
    },
    {
      "id": "a29c1813-ab1f-4dde-b489-330b952e91ae",
      "title": "Suspicious Network Command",
      "status": "test",
      "description": "Adversaries may look for details about the network configuration and settings of systems they access or through information discovery of remote systems",
      "level": "low",
      "tags": [
        "attack.discovery",
        "attack.t1016"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__re": {
                "field": "CommandLine",
                "value": [
                  "ipconfig\\s+/all",
                  "netsh\\s+interface show interface",
                  "arp\\s+-a",
                  "nbtstat\\s+-n",
                  "net\\s+config",
                  "route\\s+print"
                ],
                "modifiers": [
                  "re"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1016"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "frack113, Christopher Peacock '@securepeacock', SCYTHE '@scythe_io'",
        "date": "2021-12-07",
        "modified": "2025-10-19",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1016/T1016.md#atomic-test-1---system-network-configuration-discovery-on-windows"
        ],
        "falsepositives": [
          "Administrator, hotline ask to user"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_network_command.yml"
      }
    },
    {
      "id": "a383dec4-deec-4e6e-913b-ed9249670848",
      "title": "Potential Signing Bypass Via Windows Developer Features",
      "status": "test",
      "description": "Detects when a user enable developer features such as \"Developer Mode\" or \"Application Sideloading\". Which allows the user to install untrusted packages.",
      "level": "high",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\SystemSettingsAdminFlows.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "SystemSettingsAdminFlows.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_flag": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "TurnOnDeveloperFeatures",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_options": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "DeveloperUnlock",
                  "EnableSideloading"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-01-11",
        "modified": "",
        "references": [
          "Internal Research",
          "https://www.sentinelone.com/labs/inside-malicious-windows-apps-for-malware-deployment/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_systemsettingsadminflows_turn_on_dev_features.yml"
      }
    },
    {
      "id": "1c67a717-32ba-409b-a45d-0fb704a73a81",
      "title": "System Network Connections Discovery Via Net.EXE",
      "status": "test",
      "description": "Adversaries may attempt to get a listing of network connections to or from the compromised system they are currently accessing or from remote systems by querying for information over the network.",
      "level": "low",
      "tags": [
        "attack.discovery",
        "attack.t1049"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\net.exe",
                      "\\net1.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "net.exe",
                      "net1.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__endswith": {
                    "field": "CommandLine",
                    "value": [
                      " use",
                      " sessions"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      " use ",
                      " sessions "
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1049"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-12-10",
        "modified": "2023-02-21",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1049/T1049.md#atomic-test-1---system-network-connections-discovery"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_net_use_network_connections_discovery.yml"
      }
    },
    {
      "id": "83809e84-4475-4b69-bc3e-4aad8568612f",
      "title": "MSExchange Transport Agent Installation",
      "status": "test",
      "description": "Detects the Installation of a Exchange Transport Agent",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.t1505.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "Install-TransportAgent",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1505.002"
        ],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "Tobias Michalski (Nextron Systems)",
        "date": "2021-06-08",
        "modified": "2022-10-09",
        "references": [
          "https://speakerdeck.com/heirhabarov/hunting-for-persistence-via-microsoft-exchange-server-or-outlook?slide=7"
        ],
        "falsepositives": [
          "Legitimate installations of exchange TransportAgents. AssemblyPath is a good indicator for this."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_msexchange_transport_agent.yml"
      }
    },
    {
      "id": "05f3c945-dcc8-4393-9f3d-af65077a8f86",
      "title": "Suspicious SYSVOL Domain Group Policy Access",
      "status": "test",
      "description": "Detects Access to Domain Group Policies stored in SYSVOL",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.t1552.006"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "\\SYSVOL\\",
                  "\\policies\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1552.006"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Markus Neis, Jonhnathan Ribeiro, oscd.community",
        "date": "2018-04-09",
        "modified": "2022-01-07",
        "references": [
          "https://adsecurity.org/?p=2288",
          "https://www.hybrid-analysis.com/sample/f2943f5e45befa52fb12748ca7171d30096e1d4fc3c365561497c618341299d5?environmentId=100"
        ],
        "falsepositives": [
          "Administrative activity"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_sysvol_access.yml"
      }
    },
    {
      "id": "f63b56ee-3f79-4b8a-97fb-5c48007e8573",
      "title": "New DNS ServerLevelPluginDll Installed Via Dnscmd.EXE",
      "status": "test",
      "description": "Detects the installation of a DNS plugin DLL via ServerLevelPluginDll parameter in registry, which can be used to execute code in context of the DNS server (restart required)",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1574.001",
        "attack.t1112"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\dnscmd.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/config",
                  "/serverlevelplugindll"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1574.001",
          "T1112"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2017-05-08",
        "modified": "2023-02-05",
        "references": [
          "https://medium.com/@esnesenon/feature-not-bug-dnsadmin-to-dc-compromise-in-one-line-a0f779b8dc83",
          "https://blog.3or.de/hunting-dns-server-level-plugin-dll-injection.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_dnscmd_install_new_server_level_plugin_dll.yml"
      }
    },
    {
      "id": "87911521-7098-470b-a459-9a57fc80bdfd",
      "title": "Sysmon Configuration Update",
      "status": "test",
      "description": "Detects updates to Sysmon's configuration. Attackers might update or replace the Sysmon configuration with a bare bone one to avoid monitoring without shutting down the service completely",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_pe": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\Sysmon64.exe",
                      "\\Sysmon.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "System activity monitor",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-c",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-03-09",
        "modified": "2024-03-13",
        "references": [
          "https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon"
        ],
        "falsepositives": [
          "Legitimate administrators might use this command to update Sysmon configuration."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sysinternals_sysmon_config_update.yml"
      }
    },
    {
      "id": "7124aebe-4cd7-4ccb-8df0-6d6b93c96795",
      "title": "Suspicious Kernel Dump Using Dtrace",
      "status": "test",
      "description": "Detects suspicious way to dump the kernel on Windows systems using dtrace.exe, which is available on Windows systems since Windows 10 19H1",
      "level": "high",
      "tags": [
        "attack.discovery",
        "attack.t1082"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_plain": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\dtrace.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "lkd(0)",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_obfuscated": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "syscall:::return",
                  "lkd("
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1082"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-12-28",
        "modified": "",
        "references": [
          "https://twitter.com/0gtweet/status/1474899714290208777?s=12",
          "https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/dtrace"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_dtrace_kernel_dump.yml"
      }
    },
    {
      "id": "24c77512-782b-448a-8950-eddb0785fc71",
      "title": "SQLite Chromium Profile Data DB Access",
      "status": "test",
      "description": "Detect usage of the \"sqlite\" binary to query databases in Chromium-based browsers for potential data stealing.",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1539",
        "attack.t1555.003",
        "attack.collection",
        "attack.t1005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_sql": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Product": {
                    "field": "Product",
                    "value": "SQLite",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\sqlite.exe",
                      "\\sqlite3.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_chromium": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\User Data\\",
                  "\\Opera Software\\",
                  "\\ChromiumViewer\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_data": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Login Data",
                  "Cookies",
                  "Web Data",
                  "History",
                  "Bookmarks"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1539",
          "T1555.003",
          "T1005"
        ],
        "tactics": [
          "credential_access",
          "collection"
        ]
      },
      "meta": {
        "author": "TropChaud",
        "date": "2022-12-19",
        "modified": "2023-01-19",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/84d9edaaaa2c5511144521b0e4af726d1c7276ce/atomics/T1539/T1539.md#atomic-test-2---steal-chrome-cookies-windows",
          "https://blog.cyble.com/2022/04/21/prynt-stealer-a-new-info-stealer-performing-clipper-and-keylogger-activities/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sqlite_chromium_profile_data.yml"
      }
    },
    {
      "id": "d557dc06-62e8-4468-a8e8-7984124908ce",
      "title": "HackTool - WinPwn Execution",
      "status": "test",
      "description": "Detects commandline keywords indicative of potential usge of the tool WinPwn. A tool for Windows and Active Directory reconnaissance and exploitation.\n",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.defense-evasion",
        "attack.discovery",
        "attack.execution",
        "attack.privilege-escalation",
        "attack.t1046",
        "attack.t1082",
        "attack.t1106",
        "attack.t1518",
        "attack.t1548.002",
        "attack.t1552.001",
        "attack.t1555",
        "attack.t1555.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Offline_Winpwn",
                  "WinPwn ",
                  "WinPwn.exe",
                  "WinPwn.ps1"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1046",
          "T1082",
          "T1106",
          "T1518",
          "T1548.002",
          "T1552.001",
          "T1555",
          "T1555.003"
        ],
        "tactics": [
          "credential_access",
          "defense_evasion",
          "discovery",
          "execution",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel",
        "date": "2023-12-04",
        "modified": "",
        "references": [
          "https://github.com/S3cur3Th1sSh1t/WinPwn",
          "https://www.publicnow.com/view/EB87DB49C654D9B63995FAD4C9DE3D3CC4F6C3ED?1671634841",
          "https://reconshell.com/winpwn-tool-for-internal-windows-pentesting-and-ad-security/",
          "https://github.com/redcanaryco/atomic-red-team/blob/4d6c4e8e23d465af7a2388620cfe3f8c76e16cf0/atomics/T1082/T1082.md",
          "https://grep.app/search?q=winpwn&filter[repo][0]=redcanaryco/atomic-red-team"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_winpwn.yml"
      }
    },
    {
      "id": "7eedcc9d-9fdb-4d94-9c54-474e8affc0c7",
      "title": "Invoke-Obfuscation COMPRESS OBFUSCATION",
      "status": "test",
      "description": "Detects Obfuscated Powershell via COMPRESS OBFUSCATION",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027",
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "new-object",
                  "text.encoding]::ascii"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "system.io.compression.deflatestream",
                  "system.io.streamreader",
                  "readtoend("
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1027",
          "T1059.001"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Timur Zinniatullin, oscd.community",
        "date": "2020-10-18",
        "modified": "2022-12-29",
        "references": [
          "https://github.com/SigmaHQ/sigma/issues/1009"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_invoke_obfuscation_via_compress.yml"
      }
    },
    {
      "id": "94771a71-ba41-4b6e-a757-b531372eaab6",
      "title": "File Download From Browser Process Via Inline URL",
      "status": "test",
      "description": "Detects execution of a browser process with a URL argument pointing to a file with a potentially interesting extension. This can be abused to download arbitrary files or to hide from the user for example by launching the browser in a minimized state.",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1105"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\brave.exe",
                  "\\chrome.exe",
                  "\\msedge.exe",
                  "\\opera.exe",
                  "\\vivaldi.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_http": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "http",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_extensions": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__endswith": {
                    "field": "CommandLine",
                    "value": [
                      ".7z",
                      ".dat",
                      ".dll",
                      ".exe",
                      ".hta",
                      ".ps1",
                      ".psm1",
                      ".txt",
                      ".vbe",
                      ".vbs",
                      ".zip"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      ".7z\"",
                      ".dat\"",
                      ".dll\"",
                      ".hta\"",
                      ".ps1\"",
                      ".psm1\"",
                      ".txt\"",
                      ".vbe\"",
                      ".vbs\"",
                      ".zip\""
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1105"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-01-11",
        "modified": "2025-10-27",
        "references": [
          "https://twitter.com/mrd0x/status/1478116126005641220",
          "https://lolbas-project.github.io/lolbas/Binaries/Msedge/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_browsers_inline_file_download.yml"
      }
    },
    {
      "id": "82343930-652f-43f5-ab70-2ee9fdd6d5e9",
      "title": "Potential ShellDispatch.DLL Functionality Abuse",
      "status": "test",
      "description": "Detects potential \"ShellDispatch.dll\" functionality abuse to execute arbitrary binaries via \"ShellExecute\"",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\rundll32.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "RUNDLL32.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "RunDll_ShellExecuteW",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "X__Junior (Nextron Systems)",
        "date": "2023-06-20",
        "modified": "",
        "references": [
          "https://www.hexacorn.com/blog/2023/06/07/this-lolbin-doesnt-exist/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_rundll32_shelldispatch_potential_abuse.yml"
      }
    },
    {
      "id": "6004abd0-afa4-4557-ba90-49d172e0a299",
      "title": "Execute Pcwrun.EXE To Leverage Follina",
      "status": "test",
      "description": "Detects indirect command execution via Program Compatibility Assistant \"pcwrun.exe\" leveraging the follina (CVE-2022-30190) vulnerability",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218",
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\pcwrun.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "../",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-06-13",
        "modified": "",
        "references": [
          "https://twitter.com/nas_bench/status/1535663791362519040"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_pcwrun_follina.yml"
      }
    },
    {
      "id": "5fc297ae-25b6-488a-8f25-cc12ac29b744",
      "title": "Potentially Suspicious Usage Of Qemu",
      "status": "test",
      "description": "Detects potentially suspicious execution of the Qemu utility in a Windows environment.\nThreat actors have leveraged this utility and this technique for achieving network access as reported by Kaspersky.\n",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1090",
        "attack.t1572"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "-m 1M",
                  "-m 2M",
                  "-m 3M"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "restrict=off",
                  "-netdev ",
                  "connect=",
                  "-nographic"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_normal_usecase": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -cdrom ",
                  " type=virt ",
                  " -blockdev "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1090",
          "T1572"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Muhammad Faisal (@faisalusuf), Hunter Juhan (@threatHNTR)",
        "date": "2024-06-03",
        "modified": "",
        "references": [
          "https://securelist.com/network-tunneling-with-qemu/111803/",
          "https://www.qemu.org/docs/master/system/invocation.html#hxtool-5"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_qemu_suspicious_execution.yml"
      }
    },
    {
      "id": "236d8e89-ed95-4789-a982-36f4643738ba",
      "title": "Suspicious Persistence Via VMwareToolBoxCmd.EXE VM State Change Script",
      "status": "test",
      "description": "Detects execution of the \"VMwareToolBoxCmd.exe\" with the \"script\" and \"set\" flag to setup a specific script that's located in a potentially suspicious location to run for a specific VM state",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.persistence",
        "attack.t1059"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_bin_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\VMwareToolBoxCmd.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "toolbox-cmd.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_bin_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " script ",
                  " set "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_susp_paths": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ":\\PerfLogs\\",
                  ":\\Temp\\",
                  ":\\Windows\\System32\\Tasks\\",
                  ":\\Windows\\Tasks\\",
                  ":\\Windows\\Temp\\",
                  "\\AppData\\Local\\Temp"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059"
        ],
        "tactics": [
          "execution",
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-06-14",
        "modified": "",
        "references": [
          "https://bohops.com/2021/10/08/analyzing-and-detecting-a-vmtools-persistence-technique/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_vmware_toolbox_cmd_persistence_susp.yml"
      }
    },
    {
      "id": "81bcb81b-5b1f-474b-b373-52c871aaa7b1",
      "title": "Stop Windows Service Via Sc.EXE",
      "status": "test",
      "description": "Detects the stopping of a Windows service via the \"sc.exe\" utility",
      "level": "low",
      "tags": [
        "attack.impact",
        "attack.t1489"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "sc.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\sc.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " stop ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1489"
        ],
        "tactics": [
          "impact"
        ]
      },
      "meta": {
        "author": "Jakob Weinzettl, oscd.community, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-03-05",
        "modified": "2024-01-18",
        "references": [
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc742107(v=ws.11)"
        ],
        "falsepositives": [
          "There are many legitimate reasons to stop a service. This rule isn't looking for any suspicious behavior in particular. Filter legitimate activity accordingly"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sc_stop_service.yml"
      }
    },
    {
      "id": "88f680b8-070e-402c-ae11-d2914f2257f1",
      "title": "PowerShell Base64 Encoded IEX Cmdlet",
      "status": "test",
      "description": "Detects usage of a base64 encoded \"IEX\" cmdlet in a process command line",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__base64offset_contains": {
                    "field": "CommandLine",
                    "value": [
                      "IEX ([",
                      "iex ([",
                      "iex (New",
                      "IEX (New",
                      "IEX([",
                      "iex([",
                      "iex(New",
                      "IEX(New",
                      "IEX(('",
                      "iex(('"
                    ],
                    "modifiers": [
                      "base64offset",
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      "SQBFAFgAIAAoAFsA",
                      "kARQBYACAAKABbA",
                      "JAEUAWAAgACgAWw",
                      "aQBlAHgAIAAoAFsA",
                      "kAZQB4ACAAKABbA",
                      "pAGUAeAAgACgAWw",
                      "aQBlAHgAIAAoAE4AZQB3A",
                      "kAZQB4ACAAKABOAGUAdw",
                      "pAGUAeAAgACgATgBlAHcA",
                      "SQBFAFgAIAAoAE4AZQB3A",
                      "kARQBYACAAKABOAGUAdw",
                      "JAEUAWAAgACgATgBlAHcA"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2019-08-23",
        "modified": "2023-04-06",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_base64_iex.yml"
      }
    },
    {
      "id": "e96253b8-6b3b-4f90-9e59-3b24b99cf9b4",
      "title": "HackTool - KrbRelay Execution",
      "status": "test",
      "description": "Detects the use of KrbRelay, a Kerberos relaying tool",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1558.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\KrbRelay.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "KrbRelay.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " -spn ",
                  " -clsid ",
                  " -rbcd "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "shadowcred",
                  "clsid",
                  "spn"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_3": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "spn ",
                  "session ",
                  "clsid "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1558.003"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-04-27",
        "modified": "2023-02-04",
        "references": [
          "https://github.com/cube0x0/KrbRelay"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_krbrelay.yml"
      }
    },
    {
      "id": "d7eb979b-c2b5-4a6f-a3a7-c87ce6763819",
      "title": "Suspicious Control Panel DLL Load",
      "status": "test",
      "description": "Detects suspicious Rundll32 execution from control.exe as used by Equation Group and Exploit Kits",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.011"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\System32\\control.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\rundll32.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "RUNDLL32.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "Shell32.dll",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not filter",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "all of selection_*"
            },
            {
              "type": "not",
              "value": "filter"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218.011"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2017-04-15",
        "modified": "2023-02-09",
        "references": [
          "https://twitter.com/rikvduijn/status/853251879320662017",
          "https://twitter.com/felixw3000/status/853354851128025088"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_rundll32_susp_control_dll_load.yml"
      }
    },
    {
      "id": "d22e2925-cfd8-463f-96f6-89cec9d9bc5f",
      "title": "XBAP Execution From Uncommon Locations Via PresentationHost.EXE",
      "status": "test",
      "description": "Detects the execution of \".xbap\" (Browser Applications) files via PresentationHost.EXE from an uncommon location. These files can be abused to run malicious \".xbap\" files any bypass AWL\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.execution",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\presentationhost.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "PresentationHost.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": ".xbap",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_generic": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " C:\\Windows\\",
                  " C:\\Program Files"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection* and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection",
          "none_of": "filter_main_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-07-01",
        "modified": "2023-11-09",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Presentationhost/"
        ],
        "falsepositives": [
          "Legitimate \".xbap\" being executed via \"PresentationHost\""
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_presentationhost_uncommon_location_exec.yml"
      }
    },
    {
      "id": "68d37776-61db-42f5-bf54-27e87072d17e",
      "title": "PUA - NPS Tunneling Tool Execution",
      "status": "test",
      "description": "Detects the use of NPS, a port forwarding and intranet penetration proxy server",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1090"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\npc.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " -server=",
                  " -vkey=",
                  " -password="
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -config=npc",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_hashes": {
            "type": "field_match",
            "matchers": {
              "Hashes__contains": {
                "field": "Hashes",
                "value": [
                  "MD5=AE8ACF66BFE3A44148964048B826D005",
                  "SHA1=CEA49E9B9B67F3A13AD0BE1C2655293EA3C18181",
                  "SHA256=5A456283392FFCEEEACA3D3426C306EB470304637520D72FED1CC1FEBBBD6856"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1090"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-10-08",
        "modified": "2024-11-23",
        "references": [
          "https://github.com/ehang-io/nps"
        ],
        "falsepositives": [
          "Legitimate use"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_nps.yml"
      }
    },
    {
      "id": "49d9671b-0a0a-4c09-8280-d215bfd30662",
      "title": "Application Terminated Via Wmic.EXE",
      "status": "test",
      "description": "Detects calls to the \"terminate\" function via wmic in order to kill an application",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1047"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\WMIC.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "wmic.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "call",
                  "terminate"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1047"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-09-11",
        "modified": "",
        "references": [
          "https://cyble.com/blog/lockfile-ransomware-using-proxyshell-attack-to-deploy-ransomware/",
          "https://www.bitdefender.com/files/News/CaseStudies/study/377/Bitdefender-Whitepaper-WMI-creat4871-en-EN-GenericUse.pdf"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wmic_terminate_application.yml"
      }
    },
    {
      "id": "88656cec-6c3b-487c-82c0-f73ebb805503",
      "title": "Remote Access Tool - UltraViewer Execution",
      "status": "test",
      "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1219.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Product": {
                    "field": "Product",
                    "value": "UltraViewer",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Company": {
                    "field": "Company",
                    "value": "DucFabulous Co,ltd",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "UltraViewer_Desktop.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1219.002"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-09-25",
        "modified": "2024-03-14",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md"
        ],
        "falsepositives": [
          "Legitimate use"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_remote_access_tools_ultraviewer.yml"
      }
    },
    {
      "id": "9fbf5927-5261-4284-a71d-f681029ea574",
      "title": "Compress Data and Lock With Password for Exfiltration With 7-ZIP",
      "status": "test",
      "description": "An adversary may compress or encrypt data that is collected prior to exfiltration using 3rd party utilities",
      "level": "medium",
      "tags": [
        "attack.collection",
        "attack.t1560.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Description__contains": {
                    "field": "Description",
                    "value": "7-Zip",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\7z.exe",
                      "\\7zr.exe",
                      "\\7za.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "7z.exe",
                      "7za.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_password": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -p",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_action": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " a ",
                  " u "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1560.001"
        ],
        "tactics": [
          "collection"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-07-27",
        "modified": "2023-03-13",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1560.001/T1560.001.md"
        ],
        "falsepositives": [
          "Legitimate activity is expected since compressing files with a password is common."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_7zip_password_compression.yml"
      }
    },
    {
      "id": "d78b5d61-187d-44b6-bf02-93486a80de5a",
      "title": "HackTool - DInjector PowerShell Cradle Execution",
      "status": "test",
      "description": "Detects the use of the Dinject PowerShell cradle based on the specific flags",
      "level": "critical",
      "tags": [
        "attack.privilege-escalation",
        "attack.defense-evasion",
        "attack.t1055"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " /am51",
                  " /password"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1055"
        ],
        "tactics": [
          "privilege_escalation",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-12-07",
        "modified": "2023-02-04",
        "references": [
          "https://web.archive.org/web/20211001064856/https://github.com/snovvcrash/DInjector"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_dinjector.yml"
      }
    },
    {
      "id": "731231b9-0b5d-4219-94dd-abb6959aa7ea",
      "title": "Suspicious Rundll32 Activity Invoking Sys File",
      "status": "test",
      "description": "Detects suspicious process related to rundll32 based on command line that includes a *.sys file as seen being used by UNC2452",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.011"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "rundll32.exe",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ".sys,",
                  ".sys "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.011"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-03-05",
        "modified": "2022-10-09",
        "references": [
          "https://www.microsoft.com/security/blog/2021/03/04/goldmax-goldfinder-sibot-analyzing-nobelium-malware/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_rundll32_sys.yml"
      }
    },
    {
      "id": "18988e1b-9087-4f8a-82fe-0414dce49878",
      "title": "Execute Code with Pester.bat as Parent",
      "status": "test",
      "description": "Detects code execution via Pester.bat (Pester - Powershell Modulte for testing)",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059.001",
        "attack.defense-evasion",
        "attack.t1216"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_module": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\powershell.exe",
                  "\\pwsh.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "ParentCommandLine__contains": {
                "field": "ParentCommandLine",
                "value": "\\WindowsPowerShell\\Modules\\Pester\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "ParentCommandLine__contains": {
                "field": "ParentCommandLine",
                "value": [
                  "{ Invoke-Pester -EnableExit ;",
                  "{ Get-Help \""
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001",
          "T1216"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113, Nasreddine Bencherchali",
        "date": "2022-08-20",
        "modified": "",
        "references": [
          "https://twitter.com/Oddvarmoe/status/993383596244258816",
          "https://twitter.com/_st0pp3r_/status/1560072680887525378"
        ],
        "falsepositives": [
          "Legitimate use of Pester for writing tests for Powershell scripts and modules"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_pester.yml"
      }
    },
    {
      "id": "d7c75059-2901-4578-b209-8837fd31c6a8",
      "title": "Proxy Execution via Vshadow",
      "status": "experimental",
      "description": "Detects the invocation of vshadow.exe with the -exec parameter that executes a specified script or command after the shadow copies are created but before the VShadow tool exits.\nVShadow is a command-line tool that you can use to create and manage volume shadow copies. While legitimate backup or administrative scripts may use this flag,\nattackers can leverage this parameter to proxy the execution of malware.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1202"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\vshadow.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "vshadow.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-exec",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1202"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "David Faiss",
        "date": "2025-05-26",
        "modified": "",
        "references": [
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Vshadow/",
          "https://learn.microsoft.com/en-us/windows/win32/vss/vshadow-tool-and-sample"
        ],
        "falsepositives": [
          "System backup or administrator tools",
          "Legitimate administrative scripts"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_vshadow_exec.yml"
      }
    },
    {
      "id": "b1377339-fda6-477a-b455-ac0923f9ec2c",
      "title": "Remote Access Tool - AnyDesk Piped Password Via CLI",
      "status": "test",
      "description": "Detects piping the password to an anydesk instance via CMD and the '--set-password' flag.",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1219.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/c ",
                  "echo ",
                  ".exe --set-password"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1219.002"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-09-28",
        "modified": "2023-03-05",
        "references": [
          "https://redcanary.com/blog/misbehaving-rats/"
        ],
        "falsepositives": [
          "Legitimate piping of the password to anydesk",
          "Some FP could occur with similar tools that uses the same command line '--set-password'"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_remote_access_tools_anydesk_piped_password_via_cli.yml"
      }
    },
    {
      "id": "b7966f4a-b333-455b-8370-8ca53c229762",
      "title": "Dropping Of Password Filter DLL",
      "status": "test",
      "description": "Detects dropping of dll files in system32 that may be used to retrieve user credentials from LSASS",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.credential-access",
        "attack.t1556.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_cmdline": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa",
                  "scecli\\0*",
                  "reg add"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_cmdline",
        "condition_parsed": {
          "op": "single",
          "selection": "selection_cmdline"
        }
      },
      "mitre": {
        "techniques": [
          "T1556.002"
        ],
        "tactics": [
          "persistence",
          "defense_evasion",
          "credential_access"
        ]
      },
      "meta": {
        "author": "Sreeman",
        "date": "2020-10-29",
        "modified": "2022-10-09",
        "references": [
          "https://pentestlab.blog/2020/02/10/credential-access-password-filter-dll/",
          "https://github.com/3gstudent/PasswordFilter/tree/master/PasswordFilter"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_reg_credential_access_via_password_filter.yml"
      }
    },
    {
      "id": "2c32b543-1058-4808-91c6-5b31b8bed6c5",
      "title": "PUA - Crassus Execution",
      "status": "test",
      "description": "Detects Crassus, a Windows privilege escalation discovery tool, based on PE metadata characteristics.",
      "level": "high",
      "tags": [
        "attack.discovery",
        "attack.reconnaissance",
        "attack.t1590.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\Crassus.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "Crassus.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description__contains": {
                    "field": "Description",
                    "value": "Crassus",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1590.001"
        ],
        "tactics": [
          "discovery",
          "reconnaissance"
        ]
      },
      "meta": {
        "author": "pH-T (Nextron Systems)",
        "date": "2023-04-17",
        "modified": "",
        "references": [
          "https://github.com/vu-ls/Crassus"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_crassus.yml"
      }
    },
    {
      "id": "5cdb711b-5740-4fb2-ba88-f7945027afac",
      "title": "Rundll32 UNC Path Execution",
      "status": "test",
      "description": "Detects rundll32 execution where the DLL is located on a remote location (share)",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.execution",
        "attack.lateral-movement",
        "attack.t1021.002",
        "attack.t1218.011"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\rundll32.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "RUNDLL32.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": "rundll32",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " \\\\\\\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1021.002",
          "T1218.011"
        ],
        "tactics": [
          "defense_evasion",
          "execution",
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-10",
        "modified": "",
        "references": [
          "https://www.cybereason.com/blog/rundll32-the-infamous-proxy-for-executing-malicious-code"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_rundll32_unc_path.yml"
      }
    },
    {
      "id": "ada4b0c4-758b-46ac-9033-9004613a150d",
      "title": "Modify Group Policy Settings",
      "status": "test",
      "description": "Detect malicious GPO modifications can be used to implement many other malicious behaviors.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1484.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_reg": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\reg.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "reg.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_path": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "\\SOFTWARE\\Policies\\Microsoft\\Windows\\System",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_key": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "GroupPolicyRefreshTimeDC",
                  "GroupPolicyRefreshTimeOffsetDC",
                  "GroupPolicyRefreshTime",
                  "GroupPolicyRefreshTimeOffset",
                  "EnableSmartScreen",
                  "ShellSmartScreenLevel"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1484.001"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-08-19",
        "modified": "",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1484.001/T1484.001.md"
        ],
        "falsepositives": [
          "Legitimate use"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_reg_modify_group_policy_settings.yml"
      }
    },
    {
      "id": "1f0f6176-6482-4027-b151-00071af39d7e",
      "title": "Arbitrary File Download Via ConfigSecurityPolicy.EXE",
      "status": "test",
      "description": "Detects the execution of \"ConfigSecurityPolicy.EXE\", a binary part of Windows Defender used to manage settings in Windows Defender.\nUsers can configure different pilot collections for each of the co-management workloads.\nIt can be abused by attackers in order to upload or download files.\n",
      "level": "medium",
      "tags": [
        "attack.exfiltration",
        "attack.t1567"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": "ConfigSecurityPolicy.exe",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\ConfigSecurityPolicy.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "ConfigSecurityPolicy.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_url": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "ftp://",
                  "http://",
                  "https://"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1567"
        ],
        "tactics": [
          "exfiltration"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-11-26",
        "modified": "2022-05-16",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/ConfigSecurityPolicy/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_configsecuritypolicy_download_file.yml"
      }
    },
    {
      "id": "044ba588-dff4-4918-9808-3f95e8160606",
      "title": "Copy .DMP/.DUMP Files From Remote Share Via Cmd.EXE",
      "status": "test",
      "description": "Detects usage of the copy builtin cmd command to copy files with the \".dmp\"/\".dump\" extension from a remote share",
      "level": "high",
      "tags": [
        "attack.credential-access"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\cmd.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "Cmd.Exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "copy ",
                  " \\\\\\\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ".dmp",
                  ".dump",
                  ".hdmp"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-09-27",
        "modified": "2023-09-12",
        "references": [
          "https://thedfirreport.com/2022/09/26/bumblebee-round-two/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_cmd_copy_dmp_from_share.yml"
      }
    },
    {
      "id": "f376c8a7-a2d0-4ddc-aa0c-16c17236d962",
      "title": "HackTool - Bloodhound/Sharphound Execution",
      "status": "test",
      "description": "Detects command line parameters used by Bloodhound and Sharphound hack tools",
      "level": "high",
      "tags": [
        "attack.discovery",
        "attack.t1087.001",
        "attack.t1087.002",
        "attack.t1482",
        "attack.t1069.001",
        "attack.t1069.002",
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Product__contains": {
                    "field": "Product",
                    "value": "SharpHound",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description__contains": {
                    "field": "Description",
                    "value": "SharpHound",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Company__contains": {
                    "field": "Company",
                    "value": [
                      "SpecterOps",
                      "evil corp"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__contains": {
                    "field": "Image",
                    "value": [
                      "\\Bloodhound.exe",
                      "\\SharpHound.exe"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -CollectionMethod All ",
                  " --CollectionMethods Session ",
                  " --Loop --Loopduration ",
                  " --PortScanTimeout ",
                  ".exe -c All -d ",
                  "Invoke-Bloodhound",
                  "Get-BloodHoundData"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " -JsonFolder ",
                  " -ZipFileName "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_3": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " DCOnly ",
                  " --NoSaveCache "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1087.001",
          "T1087.002",
          "T1482",
          "T1069.001",
          "T1069.002",
          "T1059.001"
        ],
        "tactics": [
          "discovery",
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2019-12-20",
        "modified": "2023-02-04",
        "references": [
          "https://github.com/BloodHoundAD/BloodHound",
          "https://github.com/BloodHoundAD/SharpHound"
        ],
        "falsepositives": [
          "Other programs that use these command line option and accepts an 'All' parameter"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_bloodhound_sharphound.yml"
      }
    },
    {
      "id": "86588b36-c6d3-465f-9cee-8f9093e07798",
      "title": "Scheduled Task Executing Payload from Registry",
      "status": "test",
      "description": "Detects the creation of a schtasks that potentially executes a payload stored in the Windows Registry using PowerShell.",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.execution",
        "attack.persistence",
        "attack.t1053.005",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\schtasks.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "schtasks.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_create": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "/Create",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli_get": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Get-ItemProperty",
                  " gp "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_hive": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "HKCU:",
                  "HKLM:",
                  "registry::",
                  "HKEY_"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_encoding": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "FromBase64String",
                  "encodedcommand"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_"
        }
      },
      "mitre": {
        "techniques": [
          "T1053.005",
          "T1059.001"
        ],
        "tactics": [
          "privilege_escalation",
          "execution",
          "persistence"
        ]
      },
      "meta": {
        "author": "X__Junior (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-07-18",
        "modified": "",
        "references": [
          "https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_schtasks_reg_loader.yml"
      }
    },
    {
      "id": "7aa4e81a-a65c-4e10-9f81-b200eb229d7d",
      "title": "Potential Persistence Via VMwareToolBoxCmd.EXE VM State Change Script",
      "status": "test",
      "description": "Detects execution of the \"VMwareToolBoxCmd.exe\" with the \"script\" and \"set\" flag to setup a specific script to run for a specific VM state",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.persistence",
        "attack.t1059"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\VMwareToolBoxCmd.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "toolbox-cmd.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " script ",
                  " set "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059"
        ],
        "tactics": [
          "execution",
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-06-14",
        "modified": "",
        "references": [
          "https://bohops.com/2021/10/08/analyzing-and-detecting-a-vmtools-persistence-technique/",
          "https://www.hexacorn.com/blog/2017/01/14/beyond-good-ol-run-key-part-53/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_vmware_toolbox_cmd_persistence.yml"
      }
    },
    {
      "id": "222720a7-047f-4054-baa5-bab9be757db0",
      "title": "PowerShell MSI Install via WindowsInstaller COM From Remote Location",
      "status": "experimental",
      "description": "Detects the execution of PowerShell commands that attempt to install MSI packages via the\nWindows Installer COM object (`WindowsInstaller.Installer`) hosted remotely.\nThis could be indication of malicious software deployment or lateral movement attempts using Windows Installer functionality.\nAnd the usage of WindowsInstaller COM object rather than msiexec could be an attempt to bypass the detection.\n",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059.001",
        "attack.defense-evasion",
        "attack.t1218",
        "attack.command-and-control",
        "attack.t1105"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell_ise.exe",
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell_ISE.EXE",
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "-ComObject",
                  "InstallProduct("
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_remote": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "http",
                  "\\\\\\\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_localhost": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "://127.0.0.1",
                  "://localhost"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_main_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001",
          "T1218",
          "T1105"
        ],
        "tactics": [
          "execution",
          "defense_evasion",
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Meroujan Antonyan (vx3r)",
        "date": "2025-06-05",
        "modified": "",
        "references": [
          "https://informationsecuritybuzz.com/the-real-danger-behind-a-simple-windows-shortcut/",
          "https://redcanary.com/blog/threat-intelligence/intelligence-insights-may-2025/",
          "https://www.virustotal.com/gui/file/f9710b0ba4de5fa0e7ec27da462d4d2fc6838eba83a19f23f6617a466bbad457"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_comobject_msi_remote.yml"
      }
    },
    {
      "id": "e6313acd-208c-44fc-a0ff-db85d572e90e",
      "title": "Network Reconnaissance Activity",
      "status": "test",
      "description": "Detects a set of suspicious network related commands often used in recon stages",
      "level": "high",
      "tags": [
        "attack.discovery",
        "attack.t1087",
        "attack.t1082",
        "car.2016-03-001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "nslookup",
                  "_ldap._tcp.dc._msdcs."
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1087",
          "T1082"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-02-07",
        "modified": "",
        "references": [
          "https://thedfirreport.com/2022/02/07/qbot-likes-to-move-it-move-it/"
        ],
        "falsepositives": [
          "False positives depend on scripts and administrative tools used in the monitored environment"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_nslookup_domain_discovery.yml"
      }
    },
    {
      "id": "55f0a3a1-846e-40eb-8273-677371b8d912",
      "title": "Outlook EnableUnsafeClientMailRules Setting Enabled",
      "status": "test",
      "description": "Detects an attacker trying to enable the outlook security setting \"EnableUnsafeClientMailRules\" which allows outlook to run applications or execute macros",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.defense-evasion",
        "attack.t1059",
        "attack.t1202"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "\\Outlook\\Security\\EnableUnsafeClientMailRules",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059",
          "T1202"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Markus Neis, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2018-12-27",
        "modified": "2023-02-09",
        "references": [
          "https://www.fireeye.com/blog/threat-research/2018/12/overruled-containing-a-potentially-destructive-adversary.html",
          "https://speakerdeck.com/heirhabarov/hunting-for-persistence-via-microsoft-exchange-server-or-outlook?slide=44",
          "https://support.microsoft.com/en-us/topic/how-to-control-the-rule-actions-to-start-an-application-or-run-a-macro-in-outlook-2016-and-outlook-2013-e4964b72-173c-959d-5d7b-ead562979048"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_office_outlook_enable_unsafe_client_mail_rules.yml"
      }
    },
    {
      "id": "ec0722a3-eb5c-4a56-8ab2-bf6f20708592",
      "title": "Renamed Gpg.EXE Execution",
      "status": "test",
      "description": "Detects the execution of a renamed \"gpg.exe\". Often used by ransomware and loaders to decrypt/encrypt data.",
      "level": "high",
      "tags": [
        "attack.impact",
        "attack.t1486"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "OriginalFileName": {
                "field": "OriginalFileName",
                "value": "gpg.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\gpg.exe",
                  "\\gpg2.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1486"
        ],
        "tactics": [
          "impact"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), frack113",
        "date": "2023-08-09",
        "modified": "",
        "references": [
          "https://securelist.com/locked-out/68960/"
        ],
        "falsepositives": [],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_renamed_gpg4win.yml"
      }
    },
    {
      "id": "4a2a2c3e-209f-4d01-b513-4155a540b469",
      "title": "Suspicious MsiExec Embedding Parent",
      "status": "test",
      "description": "Adversaries may abuse msiexec.exe to proxy the execution of malicious payloads",
      "level": "medium",
      "tags": [
        "attack.t1218.007",
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\cmd.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "ParentCommandLine__contains_all": {
                "field": "ParentCommandLine",
                "value": [
                  "MsiExec.exe",
                  "-Embedding "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_splunk_ufw": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": ":\\Windows\\System32\\cmd.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "C:\\Program Files\\SplunkUniversalForwarder\\bin\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_vs": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": "\\DismFoDInstall.cmd",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "ParentCommandLine__contains_all": {
                    "field": "ParentCommandLine",
                    "value": [
                      "\\MsiExec.exe -Embedding ",
                      "Global\\MSI0000"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "condition": "selection and not 1 of filter*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218.007"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-04-16",
        "modified": "2022-07-14",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1218.007/T1218.007.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_msiexec_embedding.yml"
      }
    },
    {
      "id": "b2317cfa-4a47-4ead-b3ff-297438c0bc2d",
      "title": "HackTool - SharpView Execution",
      "status": "test",
      "description": "Adversaries may look for details about the network configuration and settings of systems they access or through information discovery of remote systems",
      "level": "high",
      "tags": [
        "attack.discovery",
        "attack.t1049",
        "attack.t1069.002",
        "attack.t1482",
        "attack.t1135",
        "attack.t1033"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "SharpView.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\SharpView.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      "Add-RemoteConnection",
                      "Convert-ADName",
                      "ConvertFrom-SID",
                      "ConvertFrom-UACValue",
                      "Convert-SidToName",
                      "Export-PowerViewCSV",
                      "Find-DomainObjectPropertyOutlier",
                      "Find-DomainProcess",
                      "Find-DomainShare",
                      "Find-DomainUserEvent",
                      "Find-DomainUserLocation",
                      "Find-ForeignGroup",
                      "Find-ForeignUser",
                      "Find-GPOComputerAdmin",
                      "Find-GPOLocation",
                      "Find-Interesting",
                      "Find-LocalAdminAccess",
                      "Find-ManagedSecurityGroups",
                      "Get-CachedRDPConnection",
                      "Get-DFSshare",
                      "Get-DomainComputer",
                      "Get-DomainController",
                      "Get-DomainDFSShare",
                      "Get-DomainDNSRecord",
                      "Get-DomainFileServer",
                      "Get-DomainForeign",
                      "Get-DomainGPO",
                      "Get-DomainGroup",
                      "Get-DomainGUIDMap",
                      "Get-DomainManagedSecurityGroup",
                      "Get-DomainObject",
                      "Get-DomainOU",
                      "Get-DomainPolicy",
                      "Get-DomainSID",
                      "Get-DomainSite",
                      "Get-DomainSPNTicket",
                      "Get-DomainSubnet",
                      "Get-DomainTrust",
                      "Get-DomainUserEvent",
                      "Get-ForestDomain",
                      "Get-ForestGlobalCatalog",
                      "Get-ForestTrust",
                      "Get-GptTmpl",
                      "Get-GroupsXML",
                      "Get-LastLoggedOn",
                      "Get-LoggedOnLocal",
                      "Get-NetComputer",
                      "Get-NetDomain",
                      "Get-NetFileServer",
                      "Get-NetForest",
                      "Get-NetGPO",
                      "Get-NetGroupMember",
                      "Get-NetLocalGroup",
                      "Get-NetLoggedon",
                      "Get-NetOU",
                      "Get-NetProcess",
                      "Get-NetRDPSession",
                      "Get-NetSession",
                      "Get-NetShare",
                      "Get-NetSite",
                      "Get-NetSubnet",
                      "Get-NetUser",
                      "Get-PathAcl",
                      "Get-PrincipalContext",
                      "Get-RegistryMountedDrive",
                      "Get-RegLoggedOn",
                      "Get-WMIRegCachedRDPConnection",
                      "Get-WMIRegLastLoggedOn",
                      "Get-WMIRegMountedDrive",
                      "Get-WMIRegProxy",
                      "Invoke-ACLScanner",
                      "Invoke-CheckLocalAdminAccess",
                      "Invoke-Kerberoast",
                      "Invoke-MapDomainTrust",
                      "Invoke-RevertToSelf",
                      "Invoke-Sharefinder",
                      "Invoke-UserImpersonation",
                      "Remove-DomainObjectAcl",
                      "Remove-RemoteConnection",
                      "Request-SPNTicket",
                      "Set-DomainObject",
                      "Test-AdminAccess"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1049",
          "T1069.002",
          "T1482",
          "T1135",
          "T1033"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-12-10",
        "modified": "2023-02-14",
        "references": [
          "https://github.com/tevora-threat/SharpView/",
          "https://github.com/PowerShellMafia/PowerSploit/blob/d943001a7defb5e0d1657085a77a0e78609be58f/Recon/PowerView.ps1",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1049/T1049.md#atomic-test-4---system-discovery-using-sharpview"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_sharpview.yml"
      }
    },
    {
      "id": "e9b61244-893f-427c-b287-3e708f321c6b",
      "title": "Potential Privilege Escalation Using Symlink Between Osk and Cmd",
      "status": "test",
      "description": "Detects the creation of a symbolic link between \"cmd.exe\" and the accessibility on-screen keyboard binary (osk.exe) using \"mklink\". This technique provides an elevated command prompt to the user from the login screen without the need to log in.",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1546.008"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\cmd.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "Cmd.Exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "mklink",
                  "\\osk.exe",
                  "\\cmd.exe"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1546.008"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-12-11",
        "modified": "2022-12-20",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/5c1e6f1b4fafd01c8d1ece85f510160fc1275fbf/atomics/T1546.008/T1546.008.md",
          "https://ss64.com/nt/mklink.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_cmd_mklink_osk_cmd.yml"
      }
    },
    {
      "id": "cd3d1298-eb3b-476c-ac67-12847de55813",
      "title": "DLL Execution via Rasautou.exe",
      "status": "test",
      "description": "Detects using Rasautou.exe for loading arbitrary .DLL specified in -d option and executes the export specified in -p.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\rasautou.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "rasdlui.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " -d ",
                  " -p "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Julia Fomina, oscd.community",
        "date": "2020-10-09",
        "modified": "",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Rasautou/",
          "https://github.com/fireeye/DueDLLigence",
          "https://www.fireeye.com/blog/threat-research/2019/10/staying-hidden-on-the-endpoint-evading-detection-with-shellcode.html"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_rasautou_dll_execution.yml"
      }
    },
    {
      "id": "c7d33b50-f690-4b51-8cfb-0fb912a31e57",
      "title": "HackTool - SharpDPAPI Execution",
      "status": "test",
      "description": "Detects the execution of the SharpDPAPI tool based on CommandLine flags and PE metadata.\nSharpDPAPI is a C# port of some DPAPI functionality from the Mimikatz project.\n",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.defense-evasion",
        "attack.t1134.001",
        "attack.t1134.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\SharpDPAPI.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "SharpDPAPI.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_other_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " backupkey ",
                  " blob ",
                  " certificates ",
                  " credentials ",
                  " keepass ",
                  " masterkeys ",
                  " rdg ",
                  " vaults "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_other_options_guid": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " {",
                  "}:"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_other_options_flags": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " /file:",
                  " /machine",
                  " /mkfile:",
                  " /password:",
                  " /pvk:",
                  " /server:",
                  " /target:",
                  " /unprotect"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_img or (selection_other_cli and 1 of selection_other_options_*)",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection_img",
            "(selection_other_cli and 1 of selection_other_options_*)"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1134.001",
          "T1134.003"
        ],
        "tactics": [
          "privilege_escalation",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2024-06-26",
        "modified": "",
        "references": [
          "https://github.com/GhostPack/SharpDPAPI"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_sharp_dpapi_execution.yml"
      }
    },
    {
      "id": "3dfd06d2-eaf4-4532-9555-68aca59f57c4",
      "title": "Process Execution From A Potentially Suspicious Folder",
      "status": "test",
      "description": "Detects a potentially suspicious execution from an uncommon folder.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  ":\\Perflogs\\",
                  ":\\Users\\All Users\\",
                  ":\\Users\\Default\\",
                  ":\\Users\\NetworkService\\",
                  ":\\Windows\\addins\\",
                  ":\\Windows\\debug\\",
                  ":\\Windows\\Fonts\\",
                  ":\\Windows\\Help\\",
                  ":\\Windows\\IME\\",
                  ":\\Windows\\Media\\",
                  ":\\Windows\\repair\\",
                  ":\\Windows\\security\\",
                  ":\\Windows\\System32\\Tasks\\",
                  ":\\Windows\\Tasks\\",
                  "$Recycle.bin",
                  "\\config\\systemprofile\\",
                  "\\Intel\\Logs\\",
                  "\\RSA\\MachineKeys\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_ibm": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Users\\Public\\IBM\\ClientSolutions\\Start_Programs\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_citrix": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Windows\\SysWOW64\\config\\systemprofile\\Citrix\\UpdaterBinaries\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\CitrixReceiverUpdater.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1036"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Tim Shelton",
        "date": "2019-01-16",
        "modified": "2024-07-12",
        "references": [
          "https://github.com/mbevilacqua/appcompatprocessor/blob/6c847937c5a836e2ce2fe2b915f213c345a3c389/AppCompatSearch.txt",
          "https://www.secureworks.com/research/bronze-butler-targets-japanese-businesses",
          "https://www.crowdstrike.com/resources/reports/2019-crowdstrike-global-threat-report/",
          "https://github.com/ThreatHuntingProject/ThreatHunting/blob/cb22598bb70651f88e0285abc8d835757d2cb596/hunts/suspicious_process_creation_via_windows_event_logs.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_execution_path.yml"
      }
    },
    {
      "id": "8bc64091-6875-4881-aaf9-7bd25b5dda08",
      "title": "Suspicious Process Patterns NTDS.DIT Exfil",
      "status": "test",
      "description": "Detects suspicious process patterns used in NTDS.DIT exfiltration",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_tool": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\NTDSDump.exe",
                      "\\NTDSDumpEx.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "ntds.dit",
                      "system.hiv"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": "NTDSgrab.ps1",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_oneliner_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "ac i ntds",
                  "create full"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_onliner_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/c copy ",
                  "\\windows\\ntds\\ntds.dit"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_onliner_3": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "activate instance ntds",
                  "create full"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_powershell": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "powershell",
                  "ntds.dit"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "set1_selection_ntds_dit": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "ntds.dit",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "set1_selection_image_folder": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "ParentImage__contains": {
                    "field": "ParentImage",
                    "value": [
                      "\\apache",
                      "\\tomcat",
                      "\\AppData\\",
                      "\\Temp\\",
                      "\\Public\\",
                      "\\PerfLogs\\"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__contains": {
                    "field": "Image",
                    "value": [
                      "\\apache",
                      "\\tomcat",
                      "\\AppData\\",
                      "\\Temp\\",
                      "\\Public\\",
                      "\\PerfLogs\\"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "1 of selection* or all of set1*",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "1 of selection*",
            "all of set1*"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1003.003"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-03-11",
        "modified": "2022-11-10",
        "references": [
          "https://www.ired.team/offensive-security/credential-access-and-credential-dumping/ntds.dit-enumeration",
          "https://www.n00py.io/2022/03/manipulating-user-passwords-without-mimikatz/",
          "https://pentestlab.blog/tag/ntds-dit/",
          "https://github.com/samratashok/nishang/blob/414ee1104526d7057f9adaeee196d91ae447283e/Gather/Copy-VSS.ps1",
          "https://github.com/zcgonvh/NTDSDumpEx",
          "https://github.com/rapid7/metasploit-framework/blob/d297adcebb5c1df6fe30b12ca79b161deb71571c/data/post/powershell/NTDSgrab.ps1",
          "https://blog.talosintelligence.com/2022/08/recent-cyber-attack.html?m=1"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_ntds.yml"
      }
    },
    {
      "id": "a01b8329-5953-4f73-ae2d-aa01e1f35f00",
      "title": "AspNetCompiler Execution",
      "status": "test",
      "description": "Detects execution of \"aspnet_compiler.exe\" which can be abused to compile and execute C# code.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1127"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  ":\\Windows\\Microsoft.NET\\Framework\\",
                  ":\\Windows\\Microsoft.NET\\Framework64\\",
                  ":\\Windows\\Microsoft.NET\\FrameworkArm\\",
                  ":\\Windows\\Microsoft.NET\\FrameworkArm64\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\aspnet_compiler.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1127"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-11-24",
        "modified": "2025-02-24",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Aspnet_Compiler/",
          "https://ijustwannared.team/2020/08/01/the-curious-case-of-aspnet_compiler-exe/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_aspnet_compiler_exectuion.yml"
      }
    },
    {
      "id": "e31033fc-33f0-4020-9a16-faf9b31cbf08",
      "title": "PUA - Netcat Suspicious Execution",
      "status": "test",
      "description": "Detects execution of Netcat. Adversaries may use a non-application layer protocol for communication between host and C2 server or among infected hosts within a network",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1095"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\nc.exe",
                  "\\ncat.exe",
                  "\\netcat.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cmdline": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -lvp ",
                  " -lvnp",
                  " -l -v -p ",
                  " -lv -p ",
                  " -l --proxy-type http ",
                  " -vnl --exec ",
                  " -vnl -e ",
                  " --lua-exec ",
                  " --sh-exec "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1095"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "frack113, Florian Roth (Nextron Systems)",
        "date": "2021-07-21",
        "modified": "2023-02-08",
        "references": [
          "https://nmap.org/ncat/",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1095/T1095.md",
          "https://www.revshells.com/"
        ],
        "falsepositives": [
          "Legitimate ncat use"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_netcat.yml"
      }
    },
    {
      "id": "1a1ed54a-2ba4-4221-94d5-01dee560d71e",
      "title": "Renamed CreateDump Utility Execution",
      "status": "test",
      "description": "Detects uses of a renamed legitimate createdump.exe LOLOBIN utility to dump process memory",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036",
        "attack.t1003.001",
        "attack.credential-access"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_pe": {
            "type": "field_match",
            "matchers": {
              "OriginalFileName": {
                "field": "OriginalFileName",
                "value": "FX_VER_INTERNALNAME_STR",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      " -u ",
                      " -f ",
                      ".dmp"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      " --full ",
                      " --name ",
                      ".dmp"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\createdump.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "1 of selection_* and not filter",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "1 of selection_*"
            },
            {
              "type": "not",
              "value": "filter"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1036",
          "T1003.001"
        ],
        "tactics": [
          "defense_evasion",
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-09-20",
        "modified": "2023-02-14",
        "references": [
          "https://www.crowdstrike.com/blog/overwatch-exposes-aquatic-panda-in-possession-of-log-4-shell-exploit-tools/",
          "https://twitter.com/bopin2020/status/1366400799199272960"
        ],
        "falsepositives": [
          "Command lines that use the same flags"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_renamed_createdump.yml"
      }
    },
    {
      "id": "90d50722-0483-4065-8e35-57efaadd354d",
      "title": "Arbitrary MSI Download Via Devinit.EXE",
      "status": "test",
      "description": "Detects a certain command line flag combination used by \"devinit.exe\", which can be abused as a LOLBIN to download arbitrary MSI packages on a Windows system",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " -t msi-install ",
                  " -i http"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-01-11",
        "modified": "2023-04-06",
        "references": [
          "https://twitter.com/mrd0x/status/1460815932402679809",
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Devinit/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_devinit_lolbin_usage.yml"
      }
    },
    {
      "id": "340a090b-c4e9-412e-bb36-b4b16fe96f9b",
      "title": "Renamed ZOHO Dctask64 Execution",
      "status": "test",
      "description": "Detects a renamed \"dctask64.exe\" execution, a signed binary by ZOHO Corporation part of ManageEngine Endpoint Central.\nThis binary can be abused for DLL injection, arbitrary command and process execution.\n",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.defense-evasion",
        "attack.t1036",
        "attack.t1055.001",
        "attack.t1202",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Hashes__contains": {
                "field": "Hashes",
                "value": [
                  "IMPHASH=6834B1B94E49701D77CCB3C0895E1AFD",
                  "IMPHASH=1BB6F93B129F398C7C4A76BB97450BBA",
                  "IMPHASH=FAA2AC19875FADE461C8D89DCF2710A3",
                  "IMPHASH=F1039CED4B91572AB7847D26032E6BBF"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_legit_name": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\dctask64.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1036",
          "T1055.001",
          "T1202",
          "T1218"
        ],
        "tactics": [
          "privilege_escalation",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2020-01-28",
        "modified": "2025-01-22",
        "references": [
          "https://twitter.com/gN3mes1s/status/1222088214581825540",
          "https://twitter.com/gN3mes1s/status/1222095963789111296",
          "https://twitter.com/gN3mes1s/status/1222095371175911424"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_renamed_dctask64.yml"
      }
    },
    {
      "id": "023c654f-8f16-44d9-bb2b-00ff36a62af9",
      "title": "Python Function Execution Security Warning Disabled In Excel",
      "status": "test",
      "description": "Detects changes to the registry value \"PythonFunctionWarnings\" that would prevent any warnings or alerts from showing when Python functions are about to be executed.\nThreat actors could run malicious code through the new Microsoft Excel feature that allows Python to run within the spreadsheet.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "\\Microsoft\\Office\\",
                  "\\Excel\\Security",
                  "PythonFunctionWarnings"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " 0",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "@Kostastsale",
        "date": "2023-08-22",
        "modified": "",
        "references": [
          "https://support.microsoft.com/en-us/office/data-security-and-python-in-excel-33cc88a4-4a87-485e-9ff9-f35958278327"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_registry_office_disable_python_security_warnings.yml"
      }
    },
    {
      "id": "883faa95-175a-4e22-8181-e5761aeb373c",
      "title": "Suspicious Service Binary Directory",
      "status": "test",
      "description": "Detects a service binary running in a suspicious directory",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1202"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  "\\Users\\Public\\",
                  "\\$Recycle.bin",
                  "\\Users\\All Users\\",
                  "\\Users\\Default\\",
                  "\\Users\\Contacts\\",
                  "\\Users\\Searches\\",
                  "C:\\Perflogs\\",
                  "\\config\\systemprofile\\",
                  "\\Windows\\Fonts\\",
                  "\\Windows\\IME\\",
                  "\\Windows\\addins\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\services.exe",
                  "\\svchost.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1202"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-03-09",
        "modified": "2022-10-09",
        "references": [
          "https://blog.truesec.com/2021/03/07/exchange-zero-day-proxylogon-and-hafnium/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_service_dir.yml"
      }
    },
    {
      "id": "5e95028c-5229-4214-afae-d653d573d0ec",
      "title": "Security Service Disabled Via Reg.EXE",
      "status": "test",
      "description": "Detects execution of \"reg.exe\" to disable security services such as Windows Defender.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_reg_add": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "reg",
                  "add"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_reg_start": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "d 4",
                  "v Start"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\AppIDSvc",
                  "\\MsMpSvc",
                  "\\NisSrv",
                  "\\SecurityHealthService",
                  "\\Sense",
                  "\\UsoSvc",
                  "\\WdBoot",
                  "\\WdFilter",
                  "\\WdNisDrv",
                  "\\WdNisSvc",
                  "\\WinDefend",
                  "\\wscsvc",
                  "\\wuauserv"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), John Lambert (idea), elhoim",
        "date": "2021-07-14",
        "modified": "2023-06-05",
        "references": [
          "https://twitter.com/JohnLaTwC/status/1415295021041979392",
          "https://github.com/gordonbay/Windows-On-Reins/blob/e587ac7a0407847865926d575e3c46f68cf7c68d/wor.ps1",
          "https://vms.drweb.fr/virus/?i=24144899",
          "https://bidouillesecurity.com/disable-windows-defender-in-powershell/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_reg_disable_sec_services.yml"
      }
    },
    {
      "id": "faa48cae-6b25-4f00-a094-08947fef582f",
      "title": "Rar Usage with Password and Compression Level",
      "status": "test",
      "description": "Detects the use of rar.exe, on the command line, to create an archive with password protection or with a specific compression level. This is pretty indicative of malicious actions.",
      "level": "high",
      "tags": [
        "attack.collection",
        "attack.t1560.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_password": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -hp",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_other": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -m",
                  " a "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_password and selection_other",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_password"
            },
            {
              "type": "ref",
              "value": "selection_other"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1560.001"
        ],
        "tactics": [
          "collection"
        ]
      },
      "meta": {
        "author": "@ROxPinTeddy",
        "date": "2020-05-12",
        "modified": "2022-03-16",
        "references": [
          "https://labs.sentinelone.com/the-anatomy-of-an-apt-attack-and-cobaltstrike-beacons-encoded-configuration/",
          "https://ss64.com/bash/rar.html",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1560.001/T1560.001.md"
        ],
        "falsepositives": [
          "Legitimate use of Winrar command line version",
          "Other command line tools, that use these flags"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_rar_compression_with_password.yml"
      }
    },
    {
      "id": "5cc2cda8-f261-4d88-a2de-e9e193c86716",
      "title": "Suspicious Processes Spawned by WinRM",
      "status": "test",
      "description": "Detects suspicious processes including shells spawnd from WinRM host process",
      "level": "high",
      "tags": [
        "attack.t1190",
        "attack.initial-access",
        "attack.persistence",
        "attack.privilege-escalation"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\wsmprovhost.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\cmd.exe",
                  "\\sh.exe",
                  "\\bash.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\wsl.exe",
                  "\\schtasks.exe",
                  "\\certutil.exe",
                  "\\whoami.exe",
                  "\\bitsadmin.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1190"
        ],
        "tactics": [
          "initial_access",
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Andreas Hunkeler (@Karneades), Markus Neis",
        "date": "2021-05-20",
        "modified": "2022-07-14",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Legitimate WinRM usage"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_winrm_susp_child_process.yml"
      }
    },
    {
      "id": "8f02c935-effe-45b3-8fc9-ef8696a9e41d",
      "title": "Non-privileged Usage of Reg or Powershell",
      "status": "test",
      "description": "Search for usage of reg or Powershell by non-privileged users to modify service configuration in registry",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_cli": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "reg ",
                      "add"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      "powershell",
                      "set-itemproperty",
                      " sp ",
                      "new-itemproperty"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_data": {
            "type": "field_match",
            "matchers": {
              "IntegrityLevel": {
                "field": "IntegrityLevel",
                "value": [
                  "Medium",
                  "S-1-16-8192"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "ControlSet",
                  "Services"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "ImagePath",
                  "FailureCommand",
                  "ServiceDLL"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Teymur Kheirkhabarov (idea), Ryan Plas (rule), oscd.community",
        "date": "2020-10-05",
        "modified": "2024-12-01",
        "references": [
          "https://image.slidesharecdn.com/kheirkhabarovoffzonefinal-181117201458/95/hunting-for-privilege-escalation-in-windows-environment-20-638.jpg"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_non_priv_reg_or_ps.yml"
      }
    },
    {
      "id": "03cc0c25-389f-4bf8-b48d-11878079f1ca",
      "title": "Suspicious MSHTA Child Process",
      "status": "test",
      "description": "Detects a suspicious process spawning from an \"mshta.exe\" process, which could be indicative of a malicious HTA script execution",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.005",
        "car.2013-02-003",
        "car.2013-03-001",
        "car.2014-04-003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\mshta.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_child": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\cmd.exe",
                      "\\powershell.exe",
                      "\\pwsh.exe",
                      "\\wscript.exe",
                      "\\cscript.exe",
                      "\\sh.exe",
                      "\\bash.exe",
                      "\\reg.exe",
                      "\\regsvr32.exe",
                      "\\bitsadmin.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "Cmd.Exe",
                      "PowerShell.EXE",
                      "pwsh.dll",
                      "wscript.exe",
                      "cscript.exe",
                      "Bash.exe",
                      "reg.exe",
                      "REGSVR32.EXE",
                      "bitsadmin.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.005"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Michael Haag",
        "date": "2019-01-16",
        "modified": "2023-02-06",
        "references": [
          "https://www.trustedsec.com/july-2015/malicious-htas/"
        ],
        "falsepositives": [
          "Printer software / driver installations",
          "HP software"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_mshta_susp_child_processes.yml"
      }
    },
    {
      "id": "207b0396-3689-42d9-8399-4222658efc99",
      "title": "Potential Privilege Escalation To LOCAL SYSTEM",
      "status": "test",
      "description": "Detects unknown program using commandline flags usually used by tools such as PsExec and PAExec to start programs with SYSTEM Privileges",
      "level": "high",
      "tags": [
        "attack.resource-development",
        "attack.t1587.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -s cmd",
                  " -s -i cmd",
                  " -i -s cmd",
                  " -s pwsh",
                  " -s -i pwsh",
                  " -i -s pwsh",
                  " -s powershell",
                  " -s -i powershell",
                  " -i -s powershell"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_exclude_coverage": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "paexec",
                  "PsExec",
                  "accepteula"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1587.001"
        ],
        "tactics": [
          "resource_development"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2021-05-22",
        "modified": "2024-03-05",
        "references": [
          "https://learn.microsoft.com/en-us/sysinternals/downloads/psexec",
          "https://www.poweradmin.com/paexec/",
          "https://www.fireeye.com/blog/threat-research/2020/10/kegtap-and-singlemalt-with-a-ransomware-chaser.html"
        ],
        "falsepositives": [
          "Weird admins that rename their tools",
          "Software companies that bundle PsExec/PAExec with their software and rename it, so that it is less embarrassing"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sysinternals_susp_psexec_paexec_flags.yml"
      }
    },
    {
      "id": "0f6da907-5854-4be6-859a-e9958747b0aa",
      "title": "Potential DLL Injection Via AccCheckConsole",
      "status": "test",
      "description": "Detects the execution \"AccCheckConsole\" a command-line tool for verifying the accessibility implementation of an application's UI.\nOne of the tests that this checker can run are called \"verification routine\", which tests for things like Consistency, Navigation, etc.\nThe tool allows a user to provide a DLL that can contain a custom \"verification routine\". An attacker can build such DLLs and pass it via the CLI, which would then be loaded in the context of the \"AccCheckConsole\" utility.\n",
      "level": "medium",
      "tags": [
        "attack.execution",
        "detection.threat-hunting"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\AccCheckConsole.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "AccCheckConsole.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -hwnd",
                  " -process ",
                  " -window "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-01-06",
        "modified": "2024-08-29",
        "references": [
          "https://gist.github.com/bohops/2444129419c8acf837aedda5f0e7f340",
          "https://twitter.com/bohops/status/1477717351017680899?s=12",
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/AccCheckConsole/"
        ],
        "falsepositives": [
          "Legitimate use of the UI Accessibility Checker"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_acccheckconsole_execution.yml"
      }
    },
    {
      "id": "88a87a10-384b-4ad7-8871-2f9bf9259ce5",
      "title": "Suspicious Regsvr32 Execution From Remote Share",
      "status": "test",
      "description": "Detects REGSVR32.exe to execute DLL hosted on remote shares",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.010"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\regsvr32.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "\\REGSVR32.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " \\\\\\\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.010"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-10-31",
        "modified": "",
        "references": [
          "https://thedfirreport.com/2022/10/31/follina-exploit-leads-to-domain-compromise/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_regsvr32_remote_share.yml"
      }
    },
    {
      "id": "921aa10f-2e74-4cca-9498-98f9ca4d6fdf",
      "title": "Registry Modification Attempt Via VBScript",
      "status": "experimental",
      "description": "Detects attempts to modify the registry using VBScript's CreateObject(\"Wscript.shell\") and RegWrite methods via common LOLBINs.\nIt could be an attempt to modify the registry for persistence without using straightforward methods like regedit.exe, reg.exe, or PowerShell.\nThreat Actors may use this technique to evade detection by security solutions that monitor for direct registry modifications through traditional tools.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.persistence",
        "attack.execution",
        "attack.t1112",
        "attack.t1059.005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "CreateObject",
                  "Wscript.shell",
                  ".RegWrite"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1112",
          "T1059.005"
        ],
        "tactics": [
          "defense_evasion",
          "persistence",
          "execution"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-08-13",
        "modified": "",
        "references": [
          "https://www.linkedin.com/posts/mauricefielenbach_livingofftheland-redteam-persistence-activity-7344801774182051843-TE00/",
          "https://www.nextron-systems.com/2025/07/29/detecting-the-most-popular-mitre-persistence-method-registry-run-keys-startup-folder/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_vbscript_registry_modification.yml"
      }
    },
    {
      "id": "50919691-7302-437f-8e10-1fe088afa145",
      "title": "Regsvr32 DLL Execution With Uncommon Extension",
      "status": "test",
      "description": "Detects a \"regsvr32\" execution where the DLL doesn't contain a common file extension.",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1574",
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\regsvr32.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "REGSVR32.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_main_legit_ext": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ".ax",
                  ".cpl",
                  ".dll",
                  ".ocx"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_pascal": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": ".ppl",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_avg": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": ".bav",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_null_4688": {
            "type": "field_match",
            "matchers": {
              "CommandLine": {
                "field": "CommandLine",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_empty_4688": {
            "type": "field_match",
            "matchers": {
              "CommandLine": {
                "field": "CommandLine",
                "value": "",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1574"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2019-07-17",
        "modified": "2023-05-24",
        "references": [
          "https://app.any.run/tasks/34221348-072d-4b70-93f3-aa71f6ebecad/"
        ],
        "falsepositives": [
          "Other legitimate extensions currently not in the list either from third party or specific Windows components."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_regsvr32_uncommon_extension.yml"
      }
    },
    {
      "id": "4f73421b-5a0b-4bbf-a892-5a7fb99bea66",
      "title": "Mavinject Inject DLL Into Running Process",
      "status": "test",
      "description": "Detects process injection using the signed Windows tool \"Mavinject\" via the \"INJECTRUNNING\" flag",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1055.001",
        "attack.t1218.013"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " /INJECTRUNNING ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": "C:\\Windows\\System32\\AppVClient.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1055.001",
          "T1218.013"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "frack113, Florian Roth",
        "date": "2021-07-12",
        "modified": "2022-12-05",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1218/T1218.md",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1056.004/T1056.004.md",
          "https://posts.specterops.io/mavinject-exe-functionality-deconstructed-c29ab2cf5c0e",
          "https://twitter.com/gN3mes1s/status/941315826107510784",
          "https://reaqta.com/2017/12/mavinject-microsoft-injector/",
          "https://twitter.com/Hexacorn/status/776122138063409152",
          "https://github.com/SigmaHQ/sigma/issues/3742",
          "https://github.com/keyboardcrunch/SentinelOne-ATTACK-Queries/blob/6a228d23eefe963ca81f2d52f94b815f61ef5ee0/Tactics/DefenseEvasion.md#t1055-process-injection"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_mavinject_process_injection.yml"
      }
    },
    {
      "id": "79df3f68-dccb-48e9-9171-b75cbc37c51d",
      "title": "Potential Lateral Movement via Windows Remote Shell",
      "status": "experimental",
      "description": "Detects a child process spawned by 'winrshost.exe', which suggests remote command execution through Windows Remote Shell (WinRs) and may indicate potential lateral movement activity.\n",
      "level": "medium",
      "tags": [
        "attack.lateral-movement",
        "attack.t1021.006"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\winrshost.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_conhost": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\System32\\conhost.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1021.006"
        ],
        "tactics": [
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Liran Ravich",
        "date": "2025-10-22",
        "modified": "",
        "references": [
          "https://cardinalops.com/blog/living-off-winrm-abusing-complexity-in-remote-management/",
          "https://www.ired.team/offensive-security/lateral-movement/winrs-for-lateral-movement"
        ],
        "falsepositives": [
          "Legitimate use of WinRM within the organization"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_winrshost_command_execution.yml"
      }
    },
    {
      "id": "75edd216-1939-4c73-8d61-7f3a0d85b5cc",
      "title": "File Download Via InstallUtil.EXE",
      "status": "test",
      "description": "Detects use of .NET InstallUtil.exe in order to download arbitrary files. The files will be written to \"%LOCALAPPDATA%\\Microsoft\\Windows\\INetCache\\IE\\\"\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\InstallUtil.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "InstallUtil.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "ftp://",
                  "http://",
                  "https://"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-19",
        "modified": "2023-11-09",
        "references": [
          "https://github.com/LOLBAS-Project/LOLBAS/pull/239"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_installutil_download.yml"
      }
    },
    {
      "id": "3a6586ad-127a-4d3b-a677-1e6eacdf8fde",
      "title": "Windows Shell/Scripting Processes Spawning Suspicious Programs",
      "status": "test",
      "description": "Detects suspicious child processes of a Windows shell and scripting processes such as wscript, rundll32, powershell, mshta...etc.",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.defense-evasion",
        "attack.t1059.005",
        "attack.t1059.001",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\mshta.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\rundll32.exe",
                  "\\cscript.exe",
                  "\\wscript.exe",
                  "\\wmiprvse.exe",
                  "\\regsvr32.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\schtasks.exe",
                  "\\nslookup.exe",
                  "\\certutil.exe",
                  "\\bitsadmin.exe",
                  "\\mshta.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_ccmcache": {
            "type": "field_match",
            "matchers": {
              "CurrentDirectory__contains": {
                "field": "CurrentDirectory",
                "value": "\\ccmcache\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_amazon": {
            "type": "field_match",
            "matchers": {
              "ParentCommandLine__contains": {
                "field": "ParentCommandLine",
                "value": [
                  "\\Program Files\\Amazon\\WorkSpacesConfig\\Scripts\\setup-scheduledtask.ps1",
                  "\\Program Files\\Amazon\\WorkSpacesConfig\\Scripts\\set-selfhealing.ps1",
                  "\\Program Files\\Amazon\\WorkSpacesConfig\\Scripts\\check-workspacehealth.ps1",
                  "\\nessus_"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_nessus": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "\\nessus_",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_sccm_install": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\mshta.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\mshta.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "ParentCommandLine__contains_all": {
                "field": "ParentCommandLine",
                "value": [
                  "C:\\MEM_Configmgr_",
                  "\\splash.hta",
                  "{1E460BD7-F1C3-4B2E-88BF-4E770A288AF5}"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "C:\\MEM_Configmgr_",
                  "\\SMSSETUP\\BIN\\",
                  "\\autorun.hta",
                  "{1E460BD7-F1C3-4B2E-88BF-4E770A288AF5}"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1059.005",
          "T1059.001",
          "T1218"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Tim Shelton",
        "date": "2018-04-06",
        "modified": "2023-05-23",
        "references": [
          "https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html"
        ],
        "falsepositives": [
          "Administrative scripts",
          "Microsoft SCCM"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_shell_spawn_susp_program.yml"
      }
    },
    {
      "id": "d0dae994-26c6-4d2d-83b5-b3c8b79ae513",
      "title": "PUA - WebBrowserPassView Execution",
      "status": "test",
      "description": "Detects the execution of WebBrowserPassView.exe. A password recovery tool that reveals the passwords stored by the following Web browsers, Internet Explorer (Version 4.0 - 11.0), Mozilla Firefox (All Versions), Google Chrome, Safari, and Opera",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.t1555.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "Web Browser Password Viewer",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\WebBrowserPassView.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1555.003"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-08-20",
        "modified": "2023-02-14",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1555.003/T1555.003.md"
        ],
        "falsepositives": [
          "Legitimate use"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_webbrowserpassview.yml"
      }
    },
    {
      "id": "e7be6119-fc37-43f0-ad4f-1f3f99be2f9f",
      "title": "Copying Sensitive Files with Credential Data",
      "status": "test",
      "description": "Files with well-known filenames (sensitive files with credential data) copying",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003.002",
        "attack.t1003.003",
        "car.2013-07-001",
        "attack.s0404"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_esent_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\esentutl.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "\\esentutl.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_esent_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "vss",
                  " /m ",
                  " /y "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_susp_paths": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\config\\RegBack\\sam",
                  "\\config\\RegBack\\security",
                  "\\config\\RegBack\\system",
                  "\\config\\sam",
                  "\\config\\security",
                  "\\config\\system ",
                  "\\repair\\sam",
                  "\\repair\\security",
                  "\\repair\\system",
                  "\\windows\\ntds\\ntds.dit"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_esent_* or selection_susp_paths",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "all of selection_esent_*",
            "selection_susp_paths"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1003.002",
          "T1003.003"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Teymur Kheirkhabarov, Daniil Yugoslavskiy, oscd.community",
        "date": "2019-10-22",
        "modified": "2024-06-04",
        "references": [
          "https://room362.com/post/2013/2013-06-10-volume-shadow-copy-ntdsdit-domain-hashes-remotely-part-1/",
          "https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment",
          "https://dfironthemountain.wordpress.com/2018/12/06/locked-file-access-using-esentutl-exe/",
          "https://github.com/LOLBAS-Project/LOLBAS/blob/2cc01b01132b5c304027a658c698ae09dd6a92bf/yml/OSBinaries/Esentutl.yml"
        ],
        "falsepositives": [
          "Copying sensitive files for legitimate use (eg. backup) or forensic investigation by legitimate incident responder or forensic investigator."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_esentutl_sensitive_file_copy.yml"
      }
    },
    {
      "id": "220457c1-1c9f-4c2e-afe6-9598926222c1",
      "title": "Delete All Scheduled Tasks",
      "status": "test",
      "description": "Detects the usage of schtasks with the delete flag and the asterisk symbol to delete all tasks from the schedule of the local computer, including tasks scheduled by other users.",
      "level": "high",
      "tags": [
        "attack.impact",
        "attack.t1489"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\schtasks.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " /delete ",
                  "/tn \\*",
                  " /f"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1489"
        ],
        "tactics": [
          "impact"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-09-09",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/schtasks-delete"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_schtasks_delete_all.yml"
      }
    },
    {
      "id": "ba42babc-0666-4393-a4f7-ceaf5a69191e",
      "title": "Uncommon Child Processes Of SndVol.exe",
      "status": "test",
      "description": "Detects potentially uncommon child processes of SndVol.exe (the Windows volume mixer)",
      "level": "medium",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\SndVol.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_rundll32": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\rundll32.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " shell32.dll,Control_RunDLL ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "X__Junior (Nextron Systems)",
        "date": "2023-06-09",
        "modified": "",
        "references": [
          "https://twitter.com/Max_Mal_/status/1661322732456353792"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sndvol_susp_child_processes.yml"
      }
    },
    {
      "id": "1a4bd6af-99ac-4466-b5b2-7b72b4a05462",
      "title": "Security Event Logging Disabled via MiniNt Registry Key - Process",
      "status": "experimental",
      "description": "Detects attempts to disable security event logging by adding the `MiniNt` registry key.\nThis key is used to disable the Windows Event Log service, which collects and stores event logs from the operating system and applications.\nAdversaries may want to disable this service to prevent logging of security events that could be used to detect their activities.\n",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1562.002",
        "attack.t1112",
        "car.2022-03-001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_reg_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\reg.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "reg.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_reg_cmd": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " add ",
                  "\\SYSTEM\\CurrentControlSet\\Control\\MiniNt"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_powershell_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell.exe",
                      "\\pwsh.exe",
                      "\\powershell_ise.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_powershell_cmd1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "New-Item ",
                  "ni "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_powershell_cmd2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "\\SYSTEM\\CurrentControlSet\\Control\\MiniNt",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_reg_* or all of selection_powershell_*",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "all of selection_reg_*",
            "all of selection_powershell_*"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1562.002",
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-04-09",
        "modified": "",
        "references": [
          "https://www.hackingarticles.in/defense-evasion-windows-event-logging-t1562-002/"
        ],
        "falsepositives": [
          "Highly Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_event_logging_disable_via_key_minint.yml"
      }
    },
    {
      "id": "c484e533-ee16-4a93-b6ac-f0ea4868b2f1",
      "title": "HackTool - SharpUp PrivEsc Tool Execution",
      "status": "test",
      "description": "Detects the use of SharpUp, a tool for local privilege escalation",
      "level": "critical",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.discovery",
        "attack.execution",
        "attack.t1615",
        "attack.t1569.002",
        "attack.t1574.005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\SharpUp.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "SharpUp",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      "HijackablePaths",
                      "UnquotedServicePath",
                      "ProcessDLLHijack",
                      "ModifiableServiceBinaries",
                      "ModifiableScheduledTask",
                      "DomainGPPPassword",
                      "CachedGPPPassword"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1615",
          "T1569.002",
          "T1574.005"
        ],
        "tactics": [
          "persistence",
          "defense_evasion",
          "privilege_escalation",
          "discovery",
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-08-20",
        "modified": "2023-02-13",
        "references": [
          "https://github.com/GhostPack/SharpUp"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_sharpup.yml"
      }
    },
    {
      "id": "cc7abbd0-762b-41e3-8a26-57ad50d2eea3",
      "title": "MSHTA Execution with Suspicious File Extensions",
      "status": "test",
      "description": "Detects execution of mshta.exe with file types that looks like they do not typically represent HTA (HTML Application) content,\nsuch as .png, .jpg, .zip, .pdf, and others, which are often polyglots. MSHTA is a legitimate Windows utility for executing HTML Applications\ncontaining VBScript or JScript. Threat actors often abuse this lolbin utility to download and\nexecute malicious scripts disguised as benign files or hosted under misleading extensions to evade detection.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1140",
        "attack.t1218.005",
        "attack.execution",
        "attack.t1059.007",
        "cve.2020-1599"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\mshta.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "mshta.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ".7z",
                  ".avi",
                  ".bat",
                  ".bmp",
                  ".conf",
                  ".csv",
                  ".dll",
                  ".doc",
                  ".gif",
                  ".gz",
                  ".ini",
                  ".jpe",
                  ".jpg",
                  ".json",
                  ".lnk",
                  ".log",
                  ".mkv",
                  ".mp3",
                  ".mp4",
                  ".pdf",
                  ".png",
                  ".ppt",
                  ".rar",
                  ".rtf",
                  ".svg",
                  ".tar",
                  ".tmp",
                  ".txt",
                  ".xls",
                  ".xml",
                  ".yaml",
                  ".yml",
                  ".zip",
                  "vbscript"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1140",
          "T1218.005",
          "T1059.007"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Diego Perez (@darkquassar), Markus Neis, Swisscom (Improve Rule), Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2019-02-22",
        "modified": "2025-05-12",
        "references": [
          "http://blog.sevagas.com/?Hacking-around-HTA-files",
          "https://0x00sec.org/t/clientside-exploitation-in-2018-how-pentesting-has-changed/7356",
          "https://learn.microsoft.com/en-us/previous-versions/dotnet/framework/data/xml/xslt/xslt-stylesheet-scripting-using-msxsl-script",
          "https://medium.com/tsscyber/pentesting-and-hta-bypassing-powershell-constrained-language-mode-53a42856c997",
          "https://twitter.com/mattifestation/status/1326228491302563846",
          "https://www.virustotal.com/gui/file/c1f27d9795a2eba630db8a043580a0761798f06370fb1317067805f8a845b00c"
        ],
        "falsepositives": [
          "False positives depend on scripts and administrative tools used in the monitored environment"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_mshta_susp_execution.yml"
      }
    },
    {
      "id": "bedfc8ad-d1c7-4e37-a20e-e2b0dbee759c",
      "title": "HackTool - SharpEvtMute Execution",
      "status": "test",
      "description": "Detects the use of SharpEvtHook, a tool that tampers with the Windows event logs",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\SharpEvtMute.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "SharpEvtMute",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      "--Filter \"rule ",
                      "--Encoded --Filter \\\""
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.002"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-09-07",
        "modified": "2023-02-14",
        "references": [
          "https://github.com/bats3c/EvtMute"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_sharpevtmute.yml"
      }
    },
    {
      "id": "9fc3072c-dc8f-4bf7-b231-18950000fadd",
      "title": "Potential Recon Activity Using DriverQuery.EXE",
      "status": "test",
      "description": "Detect usage of the \"driverquery\" utility to perform reconnaissance on installed drivers",
      "level": "high",
      "tags": [
        "attack.discovery"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "driverquery.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "drvqry.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_parent": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "ParentImage__endswith": {
                    "field": "ParentImage",
                    "value": [
                      "\\cscript.exe",
                      "\\mshta.exe",
                      "\\regsvr32.exe",
                      "\\rundll32.exe",
                      "\\wscript.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "ParentImage__contains": {
                    "field": "ParentImage",
                    "value": [
                      "\\AppData\\Local\\",
                      "\\Users\\Public\\",
                      "\\Windows\\Temp\\"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-01-19",
        "modified": "2023-09-29",
        "references": [
          "https://thedfirreport.com/2023/01/09/unwrapping-ursnifs-gifts/",
          "https://www.vmray.com/cyber-security-blog/analyzing-ursnif-behavior-malware-sandbox/",
          "https://www.fireeye.com/blog/threat-research/2020/01/saigon-mysterious-ursnif-fork.html"
        ],
        "falsepositives": [
          "Legitimate usage by some scripts might trigger this as well"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_driverquery_recon.yml"
      }
    },
    {
      "id": "cd71385d-fd9b-4691-9b98-2b1f7e508714",
      "title": "Lolbin Runexehelper Use As Proxy",
      "status": "test",
      "description": "Detect usage of the \"runexehelper.exe\" binary as a proxy to launch other programs",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\runexehelper.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-12-29",
        "modified": "",
        "references": [
          "https://twitter.com/0gtweet/status/1206692239839289344",
          "https://lolbas-project.github.io/lolbas/Binaries/Runexehelper/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_runexehelper.yml"
      }
    },
    {
      "id": "b9cbbc17-d00d-4e3d-a827-b06d03d2380d",
      "title": "Monitoring For Persistence Via BITS",
      "status": "test",
      "description": "BITS will allow you to schedule a command to execute after a successful download to notify you that the job is finished.\nWhen the job runs on the system the command specified in the BITS job will be executed.\nThis can be abused by actors to create a backdoor within the system and for persistence.\nIt will be chained in a BITS job to schedule the download of malware/additional binaries and execute the program after being downloaded.\n",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1197"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\bitsadmin.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "bitsadmin.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_notify_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "/SetNotifyCmdLine",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli_notify_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "%COMSPEC%",
                  "cmd.exe",
                  "regsvr32.exe"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_add_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "/Addfile",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli_add_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "http:",
                  "https:",
                  "ftp:",
                  "ftps:"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_img and (all of selection_cli_notify_* or all of selection_cli_add_*)",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection_img and (all of selection_cli_notify_*",
            "all of selection_cli_add_*)"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1197"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Sreeman",
        "date": "2020-10-29",
        "modified": "2024-01-25",
        "references": [
          "https://www.fireeye.com/blog/threat-research/2020/10/kegtap-and-singlemalt-with-a-ransomware-chaser.html",
          "http://0xthem.blogspot.com/2014/03/t-emporal-persistence-with-and-schtasks.html",
          "https://isc.sans.edu/diary/Wipe+the+drive+Stealthy+Malware+Persistence+Mechanism+-+Part+1/15394"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_bitsadmin_potential_persistence.yml"
      }
    },
    {
      "id": "bb780e0c-16cf-4383-8383-1e5471db6cf9",
      "title": "Suspicious XOR Encoded PowerShell Command",
      "status": "test",
      "description": "Detects presence of a potentially xor encoded powershell command",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.execution",
        "attack.t1059.001",
        "attack.t1140",
        "attack.t1027"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "Windows PowerShell",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Product": {
                    "field": "Product",
                    "value": "PowerShell Core 6",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_xor": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "bxor",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli_other": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "ForEach",
                  "for(",
                  "for ",
                  "-join ",
                  "-join'",
                  "-join\"",
                  "-join`",
                  "::Join",
                  "[char]"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001",
          "T1140",
          "T1027"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Sami Ruohonen, Harish Segar, Tim Shelton, Teymur Kheirkhabarov, Vasiliy Burov, oscd.community, Nasreddine Bencherchali",
        "date": "2018-09-05",
        "modified": "2023-01-30",
        "references": [
          "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse?slide=65",
          "https://redcanary.com/blog/yellow-cockatoo/",
          "https://zero2auto.com/2020/05/19/netwalker-re/",
          "https://mez0.cc/posts/cobaltstrike-powershell-exec/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_xor_commandline.yml"
      }
    },
    {
      "id": "d75d6b6b-adb9-48f7-824b-ac2e786efe1f",
      "title": "Suspicious FromBase64String Usage On Gzip Archive - Process Creation",
      "status": "test",
      "description": "Detects attempts of decoding a base64 Gzip archive via PowerShell. This technique is often used as a method to load malicious content into memory afterward.",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1132.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "FromBase64String",
                  "MemoryStream",
                  "H4sI"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1132.001"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-12-23",
        "modified": "",
        "references": [
          "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse?slide=43"
        ],
        "falsepositives": [
          "Legitimate administrative script"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_frombase64string_archive.yml"
      }
    },
    {
      "id": "b37998de-a70b-4f33-b219-ec36bf433dc0",
      "title": "PUA - PingCastle Execution From Potentially Suspicious Parent",
      "status": "test",
      "description": "Detects the execution of PingCastle, a tool designed to quickly assess the Active Directory security level via a script located in a potentially suspicious or uncommon location.\n",
      "level": "high",
      "tags": [
        "attack.reconnaissance",
        "attack.t1595"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent_ext": {
            "type": "field_match",
            "matchers": {
              "ParentCommandLine__contains": {
                "field": "ParentCommandLine",
                "value": [
                  ".bat",
                  ".chm",
                  ".cmd",
                  ".hta",
                  ".htm",
                  ".html",
                  ".js",
                  ".lnk",
                  ".ps1",
                  ".vbe",
                  ".vbs",
                  ".wsf"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_parent_path_1": {
            "type": "field_match",
            "matchers": {
              "ParentCommandLine__contains": {
                "field": "ParentCommandLine",
                "value": [
                  ":\\Perflogs\\",
                  ":\\Temp\\",
                  ":\\Users\\Public\\",
                  ":\\Windows\\Temp\\",
                  "\\AppData\\Local\\Temp",
                  "\\AppData\\Roaming\\",
                  "\\Temporary Internet"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_parent_path_2": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "ParentCommandLine__contains_all": {
                    "field": "ParentCommandLine",
                    "value": [
                      ":\\Users\\",
                      "\\Favorites\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "ParentCommandLine__contains_all": {
                    "field": "ParentCommandLine",
                    "value": [
                      ":\\Users\\",
                      "\\Favourites\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "ParentCommandLine__contains_all": {
                    "field": "ParentCommandLine",
                    "value": [
                      ":\\Users\\",
                      "\\Contacts\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\PingCastle.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "PingCastle.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Product": {
                    "field": "Product",
                    "value": "Ping Castle",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      "--scanner aclcheck",
                      "--scanner antivirus",
                      "--scanner computerversion",
                      "--scanner foreignusers",
                      "--scanner laps_bitlocker",
                      "--scanner localadmin",
                      "--scanner nullsession",
                      "--scanner nullsession-trust",
                      "--scanner oxidbindings",
                      "--scanner remote",
                      "--scanner share",
                      "--scanner smb",
                      "--scanner smb3querynetwork",
                      "--scanner spooler",
                      "--scanner startup",
                      "--scanner zerologon"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": "--no-enum-limit",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "--healthcheck",
                      "--level Full"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "--healthcheck",
                      "--server "
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "1 of selection_parent_* and selection_parent_ext and selection_cli",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "1 of selection_parent_*"
            },
            {
              "type": "ref",
              "value": "selection_parent_ext"
            },
            {
              "type": "ref",
              "value": "selection_cli"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1595"
        ],
        "tactics": [
          "reconnaissance"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), X__Junior (Nextron Systems)",
        "date": "2024-01-11",
        "modified": "",
        "references": [
          "https://github.com/vletoux/pingcastle",
          "https://thedfirreport.com/2023/10/30/netsupport-intrusion-results-in-domain-compromise/",
          "https://github.com/fengjixuchui/Start-ADEnum/blob/e237a739db98b6104427d833004836507da36a58/Functions/Start-ADEnum.ps1#L450",
          "https://github.com/lkys37en/Start-ADEnum/blob/5b42c54215fe5f57fc59abc52c20487d15764005/Functions/Start-ADEnum.ps1#L680",
          "https://github.com/projectHULK/AD_Recon/blob/dde2daba9b3393a9388cbebda87068972cc0bd3b/SecurityAssessment.ps1#L2699",
          "https://github.com/802-1x/Compliance/blob/2e53df8b6e89686a0b91116b3f42c8f717dca820/Ping%20Castle/Get-PingCastle-HTMLComplianceReport.ps1#L8",
          "https://github.com/EvotecIT/TheDashboard/blob/481a9ce8f82f2fd55fe65220ee6486bae6df0c9d/Examples/RunReports/PingCastle.ps1"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_pingcastle_script_parent.yml"
      }
    },
    {
      "id": "e4a6b256-3e47-40fc-89d2-7a477edd6915",
      "title": "System File Execution Location Anomaly",
      "status": "test",
      "description": "Detects the execution of a Windows system binary that is usually located in the system folder from an uncommon location.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\atbroker.exe",
                  "\\audiodg.exe",
                  "\\bcdedit.exe",
                  "\\bitsadmin.exe",
                  "\\certreq.exe",
                  "\\certutil.exe",
                  "\\cmstp.exe",
                  "\\conhost.exe",
                  "\\consent.exe",
                  "\\cscript.exe",
                  "\\csrss.exe",
                  "\\dashost.exe",
                  "\\defrag.exe",
                  "\\dfrgui.exe",
                  "\\dism.exe",
                  "\\dllhost.exe",
                  "\\dllhst3g.exe",
                  "\\dwm.exe",
                  "\\eventvwr.exe",
                  "\\logonui.exe",
                  "\\LsaIso.exe",
                  "\\lsass.exe",
                  "\\lsm.exe",
                  "\\msiexec.exe",
                  "\\ntoskrnl.exe",
                  "\\powershell_ise.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\regsvr32.exe",
                  "\\rundll32.exe",
                  "\\runonce.exe",
                  "\\RuntimeBroker.exe",
                  "\\schtasks.exe",
                  "\\services.exe",
                  "\\sihost.exe",
                  "\\smartscreen.exe",
                  "\\smss.exe",
                  "\\spoolsv.exe",
                  "\\svchost.exe",
                  "\\taskhost.exe",
                  "\\taskhostw.exe",
                  "\\Taskmgr.exe",
                  "\\userinit.exe",
                  "\\werfault.exe",
                  "\\werfaultsecure.exe",
                  "\\wininit.exe",
                  "\\winlogon.exe",
                  "\\winver.exe",
                  "\\wlanext.exe",
                  "\\wscript.exe",
                  "\\wsl.exe",
                  "\\wsmprovhost.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_generic": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\$WINDOWS.~BT\\",
                  "C:\\$WinREAgent\\",
                  "C:\\Windows\\SoftwareDistribution\\",
                  "C:\\Windows\\System32\\",
                  "C:\\Windows\\SystemTemp\\",
                  "C:\\Windows\\SysWOW64\\",
                  "C:\\Windows\\uus\\",
                  "C:\\Windows\\WinSxS\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_system32": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": "\\SystemRoot\\System32\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_powershell": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\PowerShell\\7\\",
                  "C:\\Program Files\\PowerShell\\7-preview\\",
                  "C:\\Program Files\\WindowsApps\\Microsoft.PowerShellPreview",
                  "\\AppData\\Local\\Microsoft\\WindowsApps\\Microsoft.PowerShellPreview"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\pwsh.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_wsl_programfiles": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\WindowsApps\\MicrosoftCorporationII.WindowsSubsystemForLinux",
                  "C:\\Program Files\\WSL\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\wsl.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_wsl_appdata": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Users\\'",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__contains": {
                "field": "Image",
                "value": "\\AppData\\Local\\Microsoft\\WindowsApps\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\wsl.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1036"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Patrick Bareiss, Anton Kutepov, oscd.community, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2017-11-27",
        "modified": "2025-11-23",
        "references": [
          "https://twitter.com/GelosSnake/status/934900723426439170",
          "https://asec.ahnlab.com/en/39828/",
          "https://www.splunk.com/en_us/blog/security/inno-setup-malware-redline-stealer-campaign.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_system_exe_anomaly.yml"
      }
    },
    {
      "id": "185d7418-f250-42d0-b72e-0c8b70661e93",
      "title": "Suspicious Diantz Download and Compress Into a CAB File",
      "status": "test",
      "description": "Download and compress a remote file and store it in a cab file on local machine.",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1105"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "diantz.exe",
                  " \\\\\\\\",
                  ".cab"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1105"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-11-26",
        "modified": "2022-08-13",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Diantz/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_diantz_remote_cab.yml"
      }
    },
    {
      "id": "51ae86a2-e2e1-4097-ad85-c46cb6851de4",
      "title": "Renamed PsExec Service Execution",
      "status": "test",
      "description": "Detects suspicious launch of a renamed version of the PSEXESVC service with, which is not often used by legitimate administrators",
      "level": "high",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "OriginalFileName": {
                "field": "OriginalFileName",
                "value": "psexesvc.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\PSEXESVC.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-07-21",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/sysinternals/downloads/psexec",
          "https://www.youtube.com/watch?v=ro2QuZTIMBM"
        ],
        "falsepositives": [
          "Legitimate administrative tasks"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_renamed_sysinternals_psexec_service.yml"
      }
    },
    {
      "id": "d65aee4d-2292-4cea-b832-83accd6cfa43",
      "title": "Arbitrary Binary Execution Using GUP Utility",
      "status": "test",
      "description": "Detects execution of the Notepad++ updater (gup) to launch other commands or executables",
      "level": "medium",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\gup.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\explorer.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\explorer.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "\\Notepad++\\notepad++.exe",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__contains": {
                "field": "ParentImage",
                "value": "\\Notepad++\\updater\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_null": {
            "type": "field_match",
            "matchers": {
              "CommandLine": {
                "field": "CommandLine",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-06-10",
        "modified": "2023-03-02",
        "references": [
          "https://twitter.com/nas_bench/status/1535322445439180803"
        ],
        "falsepositives": [
          "Other parent binaries using GUP not currently identified"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_gup_arbitrary_binary_execution.yml"
      }
    },
    {
      "id": "79b06761-465f-4f88-9ef2-150e24d3d737",
      "title": "Potential SysInternals ProcDump Evasion",
      "status": "test",
      "description": "Detects uses of the SysInternals ProcDump utility in which ProcDump or its output get renamed, or a dump file is moved or copied to a different name",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036",
        "attack.t1003.001",
        "attack.credential-access"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "copy procdump",
                  "move procdump"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "copy ",
                  ".dmp "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "2.dmp",
                  "lsass",
                  "out.dmp"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_3": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "copy lsass.exe_",
                  "move lsass.exe_"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1036",
          "T1003.001"
        ],
        "tactics": [
          "defense_evasion",
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-01-11",
        "modified": "2023-05-09",
        "references": [
          "https://twitter.com/mrd0x/status/1480785527901204481"
        ],
        "falsepositives": [
          "False positives are expected in cases in which ProcDump just gets copied to a different directory without any renaming"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sysinternals_procdump_evasion.yml"
      }
    },
    {
      "id": "99793437-3e16-439b-be0f-078782cf953d",
      "title": "Tap Installer Execution",
      "status": "test",
      "description": "Well-known TAP software installation. Possible preparation for data exfiltration using tunneling techniques",
      "level": "medium",
      "tags": [
        "attack.exfiltration",
        "attack.t1048"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\tapinstall.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_avast": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  ":\\Program Files\\Avast Software\\SecureLine VPN\\",
                  ":\\Program Files (x86)\\Avast Software\\SecureLine VPN\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_openvpn": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": ":\\Program Files\\OpenVPN Connect\\drivers\\tap\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_protonvpn": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": ":\\Program Files (x86)\\Proton Technologies\\ProtonVPNTap\\installer\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1048"
        ],
        "tactics": [
          "exfiltration"
        ]
      },
      "meta": {
        "author": "Daniil Yugoslavskiy, Ian Davis, oscd.community",
        "date": "2019-10-24",
        "modified": "2023-12-11",
        "references": [
          "https://community.openvpn.net/openvpn/wiki/ManagingWindowsTAPDrivers"
        ],
        "falsepositives": [
          "Legitimate OpenVPN TAP installation"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_tapinstall_execution.yml"
      }
    },
    {
      "id": "2fdefcb3-dbda-401e-ae23-f0db027628bc",
      "title": "Sticky Key Like Backdoor Execution",
      "status": "test",
      "description": "Detects the usage and installation of a backdoor that uses an option to register a malicious debugger for built-in tools that are accessible in the login screen",
      "level": "critical",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1546.008",
        "car.2014-11-003",
        "car.2014-11-008"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\winlogon.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\cmd.exe",
                  "\\cscript.exe",
                  "\\mshta.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\regsvr32.exe",
                  "\\rundll32.exe",
                  "\\wscript.exe",
                  "\\wt.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "sethc.exe",
                  "utilman.exe",
                  "osk.exe",
                  "Magnify.exe",
                  "Narrator.exe",
                  "DisplaySwitch.exe"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1546.008"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), @twjackomo, Jonhnathan Ribeiro, oscd.community",
        "date": "2018-03-15",
        "modified": "2023-03-07",
        "references": [
          "https://learn.microsoft.com/en-us/archive/blogs/jonathantrull/detecting-sticky-key-backdoors"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_cmd_sticky_key_like_backdoor_execution.yml"
      }
    },
    {
      "id": "45a594aa-1fbd-4972-a809-ff5a99dd81b8",
      "title": "Run PowerShell Script from ADS",
      "status": "test",
      "description": "Detects PowerShell script execution from Alternate Data Stream (ADS)",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1564.004"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\powershell.exe",
                  "\\pwsh.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\powershell.exe",
                  "\\pwsh.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "Get-Content",
                  "-Stream"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1564.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Sergey Soldatov, Kaspersky Lab, oscd.community",
        "date": "2019-10-30",
        "modified": "2022-07-14",
        "references": [
          "https://github.com/p0shkatz/Get-ADS/blob/1c3a3562e713c254edce1995a7d9879c687c7473/Get-ADS.ps1"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_run_script_from_ads.yml"
      }
    },
    {
      "id": "554601fb-9b71-4bcc-abf4-21a611be4fde",
      "title": "Suspicious Recursive Takeown",
      "status": "test",
      "description": "Adversaries can interact with the DACLs using built-in Windows commands takeown which can grant adversaries higher permissions on specific files and folders",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1222.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\takeown.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/f ",
                  "/r"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1222.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-30",
        "modified": "2022-11-21",
        "references": [
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/takeown",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1222.001/T1222.001.md#atomic-test-1---take-ownership-using-takeown-utility"
        ],
        "falsepositives": [
          "Scripts created by developers and admins",
          "Administrative activity"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_takeown_recursive_own.yml"
      }
    },
    {
      "id": "36475a7d-0f6d-4dce-9b01-6aeb473bbaf1",
      "title": "SyncAppvPublishingServer VBS Execute Arbitrary PowerShell Code",
      "status": "test",
      "description": "Executes arbitrary PowerShell code using SyncAppvPublishingServer.vbs",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218",
        "attack.t1216"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "\\SyncAppvPublishingServer.vbs",
                  ";"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218",
          "T1216"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-07-16",
        "modified": "2022-06-22",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1216/T1216.md",
          "https://lolbas-project.github.io/lolbas/Binaries/Syncappvpublishingserver/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_syncappvpublishingserver_vbs_execute_psh.yml"
      }
    },
    {
      "id": "1f1a8509-2cbb-44f5-8751-8e1571518ce2",
      "title": "Suspicious Splwow64 Without Params",
      "status": "test",
      "description": "Detects suspicious Splwow64.exe process without any command line parameters",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1202"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\splwow64.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": "splwow64.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1202"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-08-23",
        "modified": "2022-12-25",
        "references": [
          "https://twitter.com/sbousseaden/status/1429401053229891590?s=12"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_splwow64_cli_anomaly.yml"
      }
    },
    {
      "id": "f53714ec-5077-420e-ad20-907ff9bb2958",
      "title": "Forfiles.EXE Child Process Masquerading",
      "status": "test",
      "description": "Detects the execution of \"forfiles\" from a non-default location, in order to potentially spawn a custom \"cmd.exe\" from the current working directory.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentCommandLine__endswith": {
                "field": "ParentCommandLine",
                "value": [
                  ".exe",
                  ".exe\""
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\cmd.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__startswith": {
                "field": "CommandLine",
                "value": "/c echo \"",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_parent_not_sys": {
            "type": "field_match",
            "matchers": {
              "ParentImage__contains": {
                "field": "ParentImage",
                "value": [
                  ":\\Windows\\System32\\",
                  ":\\Windows\\SysWOW64\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\forfiles.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__contains": {
                "field": "Image",
                "value": [
                  ":\\Windows\\System32\\",
                  ":\\Windows\\SysWOW64\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\cmd.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1036"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), Anish Bogati",
        "date": "2024-01-05",
        "modified": "",
        "references": [
          "https://www.hexacorn.com/blog/2023/12/31/1-little-known-secret-of-forfiles-exe/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_forfiles_child_process_masquerading.yml"
      }
    },
    {
      "id": "6fe4aa1e-0531-4510-8be2-782154b73b48",
      "title": "File Recovery From Backup Via Wbadmin.EXE",
      "status": "test",
      "description": "Detects the recovery of files from backups via \"wbadmin.exe\".\nAttackers can restore sensitive files such as NTDS.DIT or Registry Hives from backups in order to potentially extract credentials.\n",
      "level": "medium",
      "tags": [
        "attack.impact",
        "attack.t1490"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\wbadmin.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "WBADMIN.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " recovery",
                  "recoveryTarget",
                  "itemtype:File"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1490"
        ],
        "tactics": [
          "impact"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), frack113",
        "date": "2024-05-10",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wbadmin-start-recovery",
          "https://lolbas-project.github.io/lolbas/Binaries/Wbadmin/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wbadmin_restore_file.yml"
      }
    },
    {
      "id": "f1086bf7-a0c4-4a37-9102-01e573caf4a0",
      "title": "Renamed Whoami Execution",
      "status": "test",
      "description": "Detects the execution of whoami that has been renamed to a different name to avoid detection",
      "level": "critical",
      "tags": [
        "attack.discovery",
        "attack.t1033",
        "car.2016-03-001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "OriginalFileName": {
                "field": "OriginalFileName",
                "value": "whoami.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\whoami.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1033"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-08-12",
        "modified": "2022-10-09",
        "references": [
          "https://brica.de/alerts/alert/public/1247926/agent-tesla-keylogger-delivered-inside-a-power-iso-daa-archive/",
          "https://app.any.run/tasks/7eaba74e-c1ea-400f-9c17-5e30eee89906/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_renamed_whoami.yml"
      }
    },
    {
      "id": "62f7c9bf-9135-49b2-8aeb-1e54a6ecc13c",
      "title": "Tor Client/Browser Execution",
      "status": "test",
      "description": "Detects the use of Tor or Tor-Browser to connect to onion routing networks",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1090.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "Tor Browser",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Product": {
                    "field": "Product",
                    "value": "Tor Browser",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\tor.exe",
                      "\\Tor Browser\\Browser\\firefox.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1090.003"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-02-20",
        "modified": "2025-10-27",
        "references": [
          "https://www.logpoint.com/en/blog/detecting-tor-use-with-logpoint/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_browsers_tor_execution.yml"
      }
    },
    {
      "id": "0f16d9cf-0616-45c8-8fad-becc11b5a41c",
      "title": "Renamed AutoHotkey.EXE Execution",
      "status": "test",
      "description": "Detects execution of a renamed autohotkey.exe binary based on PE metadata fields",
      "level": "medium",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Product__contains": {
                    "field": "Product",
                    "value": "AutoHotkey",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description__contains": {
                    "field": "Description",
                    "value": "AutoHotkey",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "AutoHotkey.exe",
                      "AutoHotkey.rc"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\AutoHotkey.exe",
                      "\\AutoHotkey32.exe",
                      "\\AutoHotkey32_UIA.exe",
                      "\\AutoHotkey64.exe",
                      "\\AutoHotkey64_UIA.exe",
                      "\\AutoHotkeyA32.exe",
                      "\\AutoHotkeyA32_UIA.exe",
                      "\\AutoHotkeyU32.exe",
                      "\\AutoHotkeyU32_UIA.exe",
                      "\\AutoHotkeyU64.exe",
                      "\\AutoHotkeyU64_UIA.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__contains": {
                    "field": "Image",
                    "value": "\\AutoHotkey",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali",
        "date": "2023-02-07",
        "modified": "",
        "references": [
          "https://www.autohotkey.com/download/",
          "https://thedfirreport.com/2023/02/06/collect-exfiltrate-sleep-repeat/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_renamed_autohotkey.yml"
      }
    },
    {
      "id": "9257c05b-4a4a-48e5-a670-b7b073cf401b",
      "title": "Binary Proxy Execution Via Dotnet-Trace.EXE",
      "status": "test",
      "description": "Detects commandline arguments for executing a child process via dotnet-trace.exe",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\dotnet-trace.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "dotnet-trace.dll",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "-- ",
                  "collect"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Jimmy Bayne (@bohops)",
        "date": "2024-01-02",
        "modified": "",
        "references": [
          "https://twitter.com/bohops/status/1740022869198037480"
        ],
        "falsepositives": [
          "Legitimate usage of the utility in order to debug and trace a program."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_dotnet_trace_lolbin_execution.yml"
      }
    },
    {
      "id": "1edff897-9146-48d2-9066-52e8d8f80a2f",
      "title": "Suspicious Invoke-WebRequest Execution With DirectIP",
      "status": "test",
      "description": "Detects calls to PowerShell with Invoke-WebRequest cmdlet using direct IP access",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1105"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell_ise.exe",
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "powershell_ise.EXE",
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_commands": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "curl ",
                  "Invoke-RestMethod",
                  "Invoke-WebRequest",
                  " irm ",
                  "iwr ",
                  "wget "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_ip": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "://1",
                  "://2",
                  "://3",
                  "://4",
                  "://5",
                  "://6",
                  "://7",
                  "://8",
                  "://9"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1105"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-04-21",
        "modified": "",
        "references": [
          "https://www.huntress.com/blog/critical-vulnerabilities-in-papercut-print-management-software"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_invoke_webrequest_direct_ip.yml"
      }
    },
    {
      "id": "57c4bf16-227f-4394-8ec7-1b745ee061c3",
      "title": "Firewall Disabled via Netsh.EXE",
      "status": "test",
      "description": "Detects netsh commands that turns off the Windows firewall",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.004",
        "attack.s0108"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\netsh.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "netsh.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "firewall",
                  "set",
                  "opmode",
                  "disable"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "advfirewall",
                  "set",
                  "state",
                  "off"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_img and 1 of selection_cli_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_img"
            },
            {
              "type": "ref",
              "value": "1 of selection_cli_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1562.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Fatih Sirin",
        "date": "2019-11-01",
        "modified": "2023-02-13",
        "references": [
          "https://www.winhelponline.com/blog/enable-and-disable-windows-firewall-quickly-using-command-line/",
          "https://app.any.run/tasks/210244b9-0b6b-4a2c-83a3-04bd3175d017/",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.004/T1562.004.md#atomic-test-1---disable-microsoft-defender-firewall"
        ],
        "falsepositives": [
          "Legitimate administration activity"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_netsh_fw_disable.yml"
      }
    },
    {
      "id": "0058b9e5-bcd7-40d4-9205-95ca5a16d7b2",
      "title": "UAC Bypass Using Windows Media Player - Process",
      "status": "test",
      "description": "Detects the pattern of UAC Bypass using Windows Media Player osksupport.dll (UACMe 32)",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img_1": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Program Files\\Windows Media Player\\osk.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_img_2": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\System32\\cmd.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ParentCommandLine": {
                "field": "ParentCommandLine",
                "value": "\"C:\\Windows\\system32\\mmc.exe\" \"C:\\Windows\\system32\\eventvwr.msc\" /s",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_integrity": {
            "type": "field_match",
            "matchers": {
              "IntegrityLevel": {
                "field": "IntegrityLevel",
                "value": [
                  "High",
                  "System",
                  "S-1-16-16384",
                  "S-1-16-12288"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_img_* and selection_integrity",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "1 of selection_img_*"
            },
            {
              "type": "ref",
              "value": "selection_integrity"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Christian Burkard (Nextron Systems)",
        "date": "2021-08-23",
        "modified": "2024-12-01",
        "references": [
          "https://github.com/hfiref0x/UACME"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_uac_bypass_wmp.yml"
      }
    },
    {
      "id": "4d7cda18-1b12-4e52-b45c-d28653210df8",
      "title": "Sysmon Driver Unloaded Via Fltmc.EXE",
      "status": "test",
      "description": "Detects possible Sysmon filter driver unloaded via fltmc.exe",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1070",
        "attack.t1562",
        "attack.t1562.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\fltMC.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "fltMC.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "unload",
                  "sysmon"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1070",
          "T1562",
          "T1562.002"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Kirill Kiryanov, oscd.community",
        "date": "2019-10-23",
        "modified": "2023-02-13",
        "references": [
          "https://www.darkoperator.com/blog/2018/10/5/operating-offensively-against-sysmon"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_fltmc_unload_driver_sysmon.yml"
      }
    },
    {
      "id": "b4dc61f5-6cce-468e-a608-b48b469feaa2",
      "title": "DirLister Execution",
      "status": "test",
      "description": "Detect the usage of \"DirLister.exe\" a utility for quickly listing folder or drive contents. It was seen used by BlackCat ransomware to create a list of accessible directories and files.",
      "level": "low",
      "tags": [
        "attack.discovery",
        "attack.t1083"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "DirLister.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\DirLister.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1083"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-08-20",
        "modified": "2023-02-04",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1083/T1083.md",
          "https://news.sophos.com/en-us/2022/07/14/blackcat-ransomware-attacks-not-merely-a-byproduct-of-bad-luck/"
        ],
        "falsepositives": [
          "Legitimate use by users"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_dirlister_execution.yml"
      }
    },
    {
      "id": "52d097e2-063e-4c9c-8fbb-855c8948d135",
      "title": "Suspicious Windows Update Agent Empty Cmdline",
      "status": "test",
      "description": "Detects suspicious Windows Update Agent activity in which a wuauclt.exe process command line doesn't contain any command line flags\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\Wuauclt.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "Wuauclt.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": [
                  "Wuauclt",
                  "Wuauclt.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1036"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-02-26",
        "modified": "2023-11-11",
        "references": [
          "https://redcanary.com/blog/blackbyte-ransomware/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wuauclt_no_cli_flags_execution.yml"
      }
    },
    {
      "id": "62e0298b-e994-4189-bc87-bc699aa62d97",
      "title": "Potential Suspicious Registry File Imported Via Reg.EXE",
      "status": "test",
      "description": "Detects the import of '.reg' files from suspicious paths using the 'reg.exe' utility",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.t1112",
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\reg.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "reg.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " import ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_paths": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "C:\\Users\\",
                  "%temp%",
                  "%tmp%",
                  "%appdata%",
                  "\\AppData\\Local\\Temp\\",
                  "C:\\Windows\\Temp\\",
                  "C:\\ProgramData\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113, Nasreddine Bencherchali",
        "date": "2022-08-01",
        "modified": "2023-02-05",
        "references": [
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/reg-import"
        ],
        "falsepositives": [
          "Legitimate import of keys"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_reg_import_from_suspicious_paths.yml"
      }
    },
    {
      "id": "d80d5c81-04ba-45b4-84e4-92eba40e0ad3",
      "title": "Arbitrary DLL or Csproj Code Execution Via Dotnet.EXE",
      "status": "test",
      "description": "Detects execution of arbitrary DLLs or unsigned code via a \".csproj\" files via Dotnet.EXE.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\dotnet.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": ".NET Host",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": [
                  ".csproj",
                  ".csproj\"",
                  ".dll",
                  ".dll\"",
                  ".csproj'",
                  ".dll'"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_notepadplus_plus": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": [
                  "C:\\Program Files (x86)\\Notepad++\\notepad++.exe",
                  "C:\\Program Files\\Notepad++\\notepad++.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "C:\\ProgramData\\CSScriptNpp\\",
                  "-cscs_path:",
                  "\\cs-script\\cscs.dll"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_optional_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Beyu Denis, oscd.community",
        "date": "2020-10-18",
        "modified": "2025-10-08",
        "references": [
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Dotnet/",
          "https://twitter.com/_felamos/status/1204705548668555264",
          "https://bohops.com/2019/08/19/dotnet-core-a-vector-for-awl-bypass-defense-evasion/"
        ],
        "falsepositives": [
          "Legitimate administrator usage"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_dotnet_arbitrary_dll_csproj_execution.yml"
      }
    },
    {
      "id": "cd764533-2e07-40d6-a718-cfeec7f2da7f",
      "title": "Renamed SysInternals DebugView Execution",
      "status": "test",
      "description": "Detects suspicious renamed SysInternals DebugView execution",
      "level": "high",
      "tags": [
        "attack.resource-development",
        "attack.t1588.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Product": {
                "field": "Product",
                "value": "Sysinternals DebugView",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "OriginalFileName": {
                "field": "OriginalFileName",
                "value": "Dbgview.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\Dbgview.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1588.002"
        ],
        "tactics": [
          "resource_development"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2020-05-28",
        "modified": "2023-02-14",
        "references": [
          "https://www.epicturla.com/blog/sysinturla"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_renamed_sysinternals_debugview.yml"
      }
    },
    {
      "id": "ebef4391-1a81-4761-a40a-1db446c0e625",
      "title": "New ActiveScriptEventConsumer Created Via Wmic.EXE",
      "status": "test",
      "description": "Detects WMIC executions in which an event consumer gets created. This could be used to establish persistence",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1546.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "ActiveScriptEventConsumer",
                  " CREATE "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1546.003"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-06-25",
        "modified": "2023-02-14",
        "references": [
          "https://twitter.com/johnlatwc/status/1408062131321270282?s=12",
          "https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/wp-windows-management-instrumentation.pdf"
        ],
        "falsepositives": [
          "Legitimate software creating script event consumers"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wmic_eventconsumer_creation.yml"
      }
    },
    {
      "id": "96036718-71cc-4027-a538-d1587e0006a7",
      "title": "Windows Processes Suspicious Parent Directory",
      "status": "test",
      "description": "Detect suspicious parent processes of well-known Windows processes",
      "level": "low",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036.003",
        "attack.t1036.005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\svchost.exe",
                  "\\taskhost.exe",
                  "\\lsm.exe",
                  "\\lsass.exe",
                  "\\services.exe",
                  "\\lsaiso.exe",
                  "\\csrss.exe",
                  "\\wininit.exe",
                  "\\winlogon.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_sys": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "ParentImage__endswith": {
                    "field": "ParentImage",
                    "value": [
                      "\\SavService.exe",
                      "\\ngen.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "ParentImage__contains": {
                    "field": "ParentImage",
                    "value": [
                      "\\System32\\",
                      "\\SysWOW64\\"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "filter_msmpeng": {
            "type": "field_match",
            "matchers": {
              "ParentImage__contains": {
                "field": "ParentImage",
                "value": [
                  "\\Windows Defender\\",
                  "\\Microsoft Security Client\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\MsMpEng.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_null": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "ParentImage": {
                    "field": "ParentImage",
                    "value": null,
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "ParentImage": {
                    "field": "ParentImage",
                    "value": [
                      "",
                      "-"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "condition": "selection and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1036.003",
          "T1036.005"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "vburov",
        "date": "2019-02-23",
        "modified": "2025-03-06",
        "references": [
          "https://web.archive.org/web/20180718061628/https://securitybytes.io/blue-team-fundamentals-part-two-windows-processes-759fe15965e2",
          "https://www.carbonblack.com/2014/06/10/screenshot-demo-hunt-evil-faster-than-ever-with-carbon-black/",
          "https://www.13cubed.com/downloads/windows_process_genealogy_v2.pdf"
        ],
        "falsepositives": [
          "Some security products seem to spawn these"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_proc_wrong_parent.yml"
      }
    },
    {
      "id": "7a74da6b-ea76-47db-92cc-874ad90df734",
      "title": "Suspicious MSDT Parent Process",
      "status": "test",
      "description": "Detects msdt.exe executed by a suspicious parent as seen in CVE-2022-30190 / Follina exploitation",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\cmd.exe",
                  "\\cscript.exe",
                  "\\mshta.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\regsvr32.exe",
                  "\\rundll32.exe",
                  "\\schtasks.exe",
                  "\\wmic.exe",
                  "\\wscript.exe",
                  "\\wsl.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_msdt": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\msdt.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "msdt.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1036",
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nextron Systems",
        "date": "2022-06-01",
        "modified": "2023-02-06",
        "references": [
          "https://twitter.com/nao_sec/status/1530196847679401984",
          "https://app.any.run/tasks/713f05d2-fe78-4b9d-a744-f7c133e3fafb/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_msdt_susp_parent.yml"
      }
    },
    {
      "id": "d85873ef-a0f8-4c48-a53a-6b621f11729d",
      "title": "Remote Access Tool - LogMeIn Execution",
      "status": "test",
      "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1219.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "LMIGuardianSvc",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Product": {
                    "field": "Product",
                    "value": "LMIGuardianSvc",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Company": {
                    "field": "Company",
                    "value": "LogMeIn, Inc.",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1219.002"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-02-11",
        "modified": "2023-03-05",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-3---logmein-files-detected-test-on-windows"
        ],
        "falsepositives": [
          "Legitimate use"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_remote_access_tools_logmein.yml"
      }
    },
    {
      "id": "c27515df-97a9-4162-8a60-dc0eeb51b775",
      "title": "Suspicious Microsoft OneNote Child Process",
      "status": "test",
      "description": "Detects suspicious child processes of the Microsoft OneNote application. This may indicate an attempt to execute malicious embedded objects from a .one file.",
      "level": "high",
      "tags": [
        "attack.t1566",
        "attack.t1566.001",
        "attack.initial-access"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\onenote.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_opt_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "bitsadmin.exe",
                      "CertOC.exe",
                      "CertUtil.exe",
                      "Cmd.Exe",
                      "CMSTP.EXE",
                      "cscript.exe",
                      "curl.exe",
                      "HH.exe",
                      "IEExec.exe",
                      "InstallUtil.exe",
                      "javaw.exe",
                      "Microsoft.Workflow.Compiler.exe",
                      "msdt.exe",
                      "MSHTA.EXE",
                      "msiexec.exe",
                      "Msxsl.exe",
                      "odbcconf.exe",
                      "pcalua.exe",
                      "PowerShell.EXE",
                      "RegAsm.exe",
                      "RegSvcs.exe",
                      "REGSVR32.exe",
                      "RUNDLL32.exe",
                      "schtasks.exe",
                      "ScriptRunner.exe",
                      "wmic.exe",
                      "WorkFolders.exe",
                      "wscript.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\AppVLP.exe",
                      "\\bash.exe",
                      "\\bitsadmin.exe",
                      "\\certoc.exe",
                      "\\certutil.exe",
                      "\\cmd.exe",
                      "\\cmstp.exe",
                      "\\control.exe",
                      "\\cscript.exe",
                      "\\curl.exe",
                      "\\forfiles.exe",
                      "\\hh.exe",
                      "\\ieexec.exe",
                      "\\installutil.exe",
                      "\\javaw.exe",
                      "\\mftrace.exe",
                      "\\Microsoft.Workflow.Compiler.exe",
                      "\\msbuild.exe",
                      "\\msdt.exe",
                      "\\mshta.exe",
                      "\\msidb.exe",
                      "\\msiexec.exe",
                      "\\msxsl.exe",
                      "\\odbcconf.exe",
                      "\\pcalua.exe",
                      "\\powershell.exe",
                      "\\pwsh.exe",
                      "\\regasm.exe",
                      "\\regsvcs.exe",
                      "\\regsvr32.exe",
                      "\\rundll32.exe",
                      "\\schtasks.exe",
                      "\\scrcons.exe",
                      "\\scriptrunner.exe",
                      "\\sh.exe",
                      "\\svchost.exe",
                      "\\verclsid.exe",
                      "\\wmic.exe",
                      "\\workfolders.exe",
                      "\\wscript.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_opt_explorer": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\explorer.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ".hta",
                  ".vb",
                  ".wsh",
                  ".js",
                  ".ps",
                  ".scr",
                  ".pif",
                  ".bat",
                  ".cmd"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_opt_paths": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  "\\AppData\\",
                  "\\Users\\Public\\",
                  "\\ProgramData\\",
                  "\\Windows\\Tasks\\",
                  "\\Windows\\Temp\\",
                  "\\Windows\\System32\\Tasks\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_teams": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\AppData\\Local\\Microsoft\\Teams\\current\\Teams.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": "-Embedding",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_onedrive": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": "\\AppData\\Local\\Microsoft\\OneDrive\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\FileCoAuth.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": "-Embedding",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection_parent and 1 of selection_opt_* and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_parent"
            },
            {
              "type": "ref",
              "value": "1 of selection_opt_*"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1566",
          "T1566.001"
        ],
        "tactics": [
          "initial_access"
        ]
      },
      "meta": {
        "author": "Tim Rauch (Nextron Systems), Nasreddine Bencherchali (Nextron Systems), Elastic (idea)",
        "date": "2022-10-21",
        "modified": "2023-02-10",
        "references": [
          "https://github.com/elastic/protections-artifacts/commit/746086721fd385d9f5c6647cada1788db4aea95f#diff-e34e43eb5666427602ddf488b2bf3b545bd9aae81af3e6f6c7949f9652abdf18",
          "https://micahbabinski.medium.com/detecting-onenote-one-malware-delivery-407e9321ecf0"
        ],
        "falsepositives": [
          "File located in the AppData folder with trusted signature"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_office_onenote_susp_child_processes.yml"
      }
    },
    {
      "id": "e84d89c4-f544-41ca-a6af-4b92fd38b023",
      "title": "Arbitrary File Download Via MSEDGE_PROXY.EXE",
      "status": "test",
      "description": "Detects usage of \"msedge_proxy.exe\" to download arbitrary files",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.execution",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\msedge_proxy.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "msedge_proxy.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "http://",
                  "https://"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel",
        "date": "2023-11-09",
        "modified": "",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/msedge_proxy/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_msedge_proxy_download.yml"
      }
    },
    {
      "id": "60bfeac3-0d35-4302-8efb-1dd16f715bc6",
      "title": "Suspicious SysAidServer Child",
      "status": "test",
      "description": "Detects suspicious child processes of SysAidServer (as seen in MERCURY threat actor intrusions)",
      "level": "medium",
      "tags": [
        "attack.lateral-movement",
        "attack.t1210"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\java.exe",
                  "\\javaw.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "ParentCommandLine__contains": {
                "field": "ParentCommandLine",
                "value": "SysAidServer",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1210"
        ],
        "tactics": [
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-08-26",
        "modified": "",
        "references": [
          "https://www.microsoft.com/security/blog/2022/08/25/mercury-leveraging-log4j-2-vulnerabilities-in-unpatched-systems-to-target-israeli-organizations/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_java_sysaidserver_susp_child_process.yml"
      }
    },
    {
      "id": "b6676963-0353-4f88-90f5-36c20d443c6a",
      "title": "Cscript/Wscript Potentially Suspicious Child Process",
      "status": "test",
      "description": "Detects potentially suspicious child processes of Wscript/Cscript. These include processes such as rundll32 with uncommon exports or PowerShell spawning rundll32 or regsvr32.\nMalware such as Pikabot and Qakbot were seen using similar techniques as well as many others.\n",
      "level": "medium",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\wscript.exe",
                  "\\cscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_script_main": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\cmd.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_script_option_mshta": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "mshta",
                  "http"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_script_option_other": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "rundll32",
                  "regsvr32",
                  "msiexec"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_standalone": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\rundll32.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_rundll32_known_exports": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\rundll32.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "UpdatePerUserSystemParameters",
                  "PrintUIEntry",
                  "ClearMyTracksByProcess"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection_parent and ( selection_cli_standalone or (selection_cli_script_main and 1 of selection_cli_script_option_*) ) and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection_parent and ( selection_cli_standalone",
            "(selection_cli_script_main and 1 of selection_cli_script_option_*) ) and not 1 of filter_main_*"
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), Alejandro Houspanossian ('@lekz86')",
        "date": "2023-05-15",
        "modified": "2024-01-02",
        "references": [
          "Internal Research",
          "https://github.com/pr0xylife/Pikabot/blob/fc58126127adf0f65e78f4eec59675523f48f086/Pikabot_30.10.2023.txt",
          "https://github.com/pr0xylife/Pikabot/blob/fc58126127adf0f65e78f4eec59675523f48f086/Pikabot_22.12.2023.txt"
        ],
        "falsepositives": [
          "Some false positives might occur with admin or third party software scripts. Investigate and apply additional filters accordingly."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wscript_cscript_susp_child_processes.yml"
      }
    },
    {
      "id": "f0cdd048-82dc-4f7a-8a7a-b87a52b6d0fd",
      "title": "Potential Commandline Obfuscation Using Escape Characters",
      "status": "test",
      "description": "Detects potential commandline obfuscation using known escape characters",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1140"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "h^t^t^p",
                  "h\"t\"t\"p"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1140"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "juju4",
        "date": "2018-12-11",
        "modified": "2023-03-03",
        "references": [
          "https://twitter.com/vysecurity/status/885545634958385153",
          "https://twitter.com/Hexacorn/status/885553465417756673",
          "https://twitter.com/Hexacorn/status/885570278637678592",
          "https://www.mandiant.com/resources/blog/obfuscation-wild-targeted-attackers-lead-way-evasion-techniques",
          "https://web.archive.org/web/20190213114956/http://www.windowsinspired.com/understanding-the-command-line-string-and-arguments-received-by-a-windows-program/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_cli_obfuscation_escape_char.yml"
      }
    },
    {
      "id": "9801abb8-e297-4dbf-9fbd-57dde0e830ad",
      "title": "File Download And Execution Via IEExec.EXE",
      "status": "test",
      "description": "Detects execution of the IEExec utility to download and execute files",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1105"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\IEExec.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "IEExec.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "http://",
                  "https://"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1105"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-05-16",
        "modified": "2023-11-09",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Ieexec/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_ieexec_download.yml"
      }
    },
    {
      "id": "b1cb4ab6-ac31-43f4-adf1-d9d08957419c",
      "title": "PUA - PingCastle Execution",
      "status": "test",
      "description": "Detects the execution of PingCastle, a tool designed to quickly assess the Active Directory security level.",
      "level": "medium",
      "tags": [
        "attack.reconnaissance",
        "attack.t1595"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Hashes__contains": {
                    "field": "Hashes",
                    "value": [
                      "MD5=f741f25ac909ee434e50812d436c73ff",
                      "MD5=d40acbfc29ee24388262e3d8be16f622",
                      "MD5=01bb2c16fadb992fa66228cd02d45c60",
                      "MD5=9e1b18e62e42b5444fc55b51e640355b",
                      "MD5=b7f8fe33ac471b074ca9e630ba0c7e79",
                      "MD5=324579d717c9b9b8e71d0269d13f811f",
                      "MD5=63257a1ddaf83cfa43fe24a3bc06c207",
                      "MD5=049e85963826b059c9bac273bb9c82ab",
                      "MD5=ecb98b7b4d4427eb8221381154ff4cb2",
                      "MD5=faf87749ac790ec3a10dd069d10f9d63",
                      "MD5=f296dba5d21ad18e6990b1992aea8f83",
                      "MD5=93ba94355e794b6c6f98204cf39f7a11",
                      "MD5=a258ef593ac63155523a461ecc73bdba",
                      "MD5=97000eb5d1653f1140ee3f47186463c4",
                      "MD5=95eb317fbbe14a82bd9fdf31c48b8d93",
                      "MD5=32fe9f0d2630ac40ea29023920f20f49",
                      "MD5=a05930dde939cfd02677fc18bb2b7df5",
                      "MD5=124283924e86933ff9054a549d3a268b",
                      "MD5=ceda6909b8573fdeb0351c6920225686",
                      "MD5=60ce120040f2cd311c810ae6f6bbc182",
                      "MD5=2f10cdc5b09100a260703a28eadd0ceb",
                      "MD5=011d967028e797a4c16d547f7ba1463f",
                      "MD5=2da9152c0970500c697c1c9b4a9e0360",
                      "MD5=b5ba72034b8f44d431f55275bace9f8b",
                      "MD5=d6ed9101df0f24e27ff92ddab42dacca",
                      "MD5=3ed3cdb6d12aa1ac562ad185cdbf2d1d",
                      "MD5=5e083cd0143ae95a6cb79b68c07ca573",
                      "MD5=28caff93748cb84be70486e79f04c2df",
                      "MD5=9d4f12c30f9b500f896efd1800e4dd11",
                      "MD5=4586f7dd14271ad65a5fb696b393f4c0",
                      "MD5=86ba9dddbdf49215145b5bcd081d4011",
                      "MD5=9dce0a481343874ef9a36c9a825ef991",
                      "MD5=85890f62e231ad964b1fda7a674747ec",
                      "MD5=599be548da6441d7fe3e9a1bb8cb0833",
                      "MD5=9b0c7fd5763f66e9b8c7b457fce53f96",
                      "MD5=32d45718164205aec3e98e0223717d1d",
                      "MD5=6ff5f373ee7f794cd17db50704d00ddb",
                      "MD5=88efbdf41f0650f8f58a3053b0ca0459",
                      "MD5=ef915f61f861d1fb7cbde9afd2e7bd93",
                      "MD5=781fa16511a595757154b4304d2dd350",
                      "MD5=5018ec39be0e296f4fc8c8575bfa8486",
                      "MD5=f4a84d6f1caf0875b50135423d04139f",
                      "SHA1=9c1431801fa6342ed68f047842b9a11778fc669b",
                      "SHA1=c36c862f40dad78cb065197aad15fef690c262f2",
                      "SHA1=bc8e23faea8b3c537f268b3e81d05b937012272d",
                      "SHA1=12e0357658614ff60d480d1a6709be68a2e40c5f",
                      "SHA1=18b33ab5719966393d424a3edbfa8dec225d98fa",
                      "SHA1=f14c9633040897d375e3069fddc71e859f283778",
                      "SHA1=08041b426c9f112ad2061bf3c8c718e34739d4fc",
                      "SHA1=7be77c885d0c9a4af4cecc64d512987cf93ba937",
                      "SHA1=72dbb719b05f89d9d2dbdf186714caf7639daa36",
                      "SHA1=5b1498beb2cfb4d971e377801e7abce62c0e315b",
                      "SHA1=292629c6ab33bddf123d26328025e2d157d9e8fc",
                      "SHA1=be59e621e83a2d4c87b0e6c69a2d22f175408b11",
                      "SHA1=0250ce9a716ab8cca1c70a9de4cbc49a51934995",
                      "SHA1=607e1fa810c799735221a609af3bfc405728c02d",
                      "SHA1=ab1c547f6d1c07a9e0a01e46adea3aae1cac12e3",
                      "SHA1=044cf5698a8e6b0aeba5acb56567f06366a9a70a",
                      "SHA1=ef2dea8c736d49607832986c6c2d6fdd68ba6491",
                      "SHA1=efffc2bfb8af2e3242233db9a7109b903fc3f178",
                      "SHA1=5a05d4320de9afbc84de8469dd02b3a109efb2d4",
                      "SHA1=a785d88cf8b862a420b9be793ee6a9616aa94c84",
                      "SHA1=5688d56cbaf0d934c4e37b112ba257e8fb63f4ea",
                      "SHA1=5cd2ada1c26815fbfd6a0cd746d5d429c0d83a17",
                      "SHA1=81d67b3d70c4e855cb11a453cc32997517708362",
                      "SHA1=9cffce9de95e0109f4dfecce0ab2cb0a59cc58ad",
                      "SHA1=09c6930d057f49c1c1e11cf9241fffc8c12df3a2",
                      "SHA1=e27bf7db8d96db9d4c8a06ee5e9b8e9fcb86ac92",
                      "SHA1=9e3c992415e390f9ada4d15c693b687f38a492d1",
                      "SHA1=3f34a5ee303d37916584c888c4928e1c1164f92a",
                      "SHA1=ea4c8c56a8f5c90a4c08366933e5fb2de611d0db",
                      "SHA1=3150f14508ee4cae19cf09083499d1cda8426540",
                      "SHA1=036ad9876fa552b1298c040e233d620ea44689c6",
                      "SHA1=3a3c1dcb146bb4616904157344ce1a82cd173bf5",
                      "SHA1=6230d6fca973fa26188dfbadede57afb4c15f75c",
                      "SHA1=8f7b2a9b8842f339b1e33602b7f926ab65de1a4d",
                      "SHA1=a586bb06b59a4736a47abff8423a54fe8e2c05c4",
                      "SHA1=c82152cddf9e5df49094686531872ecd545976db",
                      "SHA1=04c39ffc18533100aaa4f9c06baf2c719ac94a61",
                      "SHA1=e082affa5cdb2d46452c6601a9e85acb8446b836",
                      "SHA1=a075bfb6cf5c6451ce682197a87277c8bc188719",
                      "SHA1=34c0c5839af1c92bce7562b91418443a2044c90d",
                      "SHA1=74e10a9989e0ec8fe075537ac802bd3031ae7e08",
                      "SHA1=3a515551814775df0ccbe09f219bc972eae45a10",
                      "SHA256=90fd5b855b5107e7abaaefb6e658f50d5d6e08ac28e35f31d8b03dcabf77872b",
                      "SHA256=5836c24f233f77342fee825f3cad73caab7ab4fb65ec2aec309fd12bc1317e85",
                      "SHA256=e850e54b12331249c357a20604281b9abf8a91e6f3d957463fc625e6b126ef03",
                      "SHA256=9e752f29edcd0db9931c20b173eee8d4d8196f87382c68a6e7eb4c8a44d58795",
                      "SHA256=7a8c127d6c41f80d178d2315ed2f751ac91b1cd54d008af13680e04f068f426f",
                      "SHA256=9f65e1c142c4f814e056a197a2241fd09e09acf245c62897109871137321a72a",
                      "SHA256=c9b52d03c66d54d6391c643b3559184b1425c84a372081ec2bfed07ebf6af275",
                      "SHA256=1b96f6218498aa6baf6f6c15b8f99e542077e33feb1ab5472bbbf7d4de43eb6b",
                      "SHA256=768021fc242054decc280675750dec0a9e74e764b8646864c58756fa2386d2a2",
                      "SHA256=1e1b32bef31be040f0f038fcb5a2d68fb192daaef23c6167f91793d21e06ebae",
                      "SHA256=606bd75ed9d2d6107ea7ee67063d1761a99f2fb5e932c8344d11395d24587dd6",
                      "SHA256=b489d3cdd158f040322ae5c8d0139ad28eff743c738a10f2d0255c7e149bd92a",
                      "SHA256=ca7ecf04a8ad63aff330492c15270d56760cb223a607cdb1431fb00e1b9985d1",
                      "SHA256=9dc4fca72463078b70f6516559a179c78400b06534e63ee12fb38adbe2632559",
                      "SHA256=c00d2aee59bac087d769e09b5b7f832176f7714fefdc6af2502e6031e3eb37c2",
                      "SHA256=a8e96d564687064190eaf865774f773def05fdbf651aa5bbf66216c077b863ef",
                      "SHA256=84ed328cee2a0505e87662faf6fc57915e3a831c97ee88ad691f5c63522e139d",
                      "SHA256=c143de99c57965d3a44c1fce6a97c2773b050609c1ea7f45688a4ca2422a5524",
                      "SHA256=01d1efd5e552c59baa70c0778902233c05fde7de6e5cc156c62607df0804d36b",
                      "SHA256=9a8dfeb7e3174f3510691e2b32d0f9088e0ed67d9ed1b2afbe450d70dec2016b",
                      "SHA256=63b92a114075d855f706979d50ed3460fe39f8a2f5498b7657f0d14865117629",
                      "SHA256=2eb014130ff837b6481c26f0d0152f84de22ca7370b15a4f51921e0054a2a358",
                      "SHA256=7d5bb4271bf8ca2b63a59e731f3ec831dbda53adb8e28665e956afb4941f32ca",
                      "SHA256=e57098a75bf32e127c214b61bfba492d6b209e211f065fcc84ff10637a2143ea",
                      "SHA256=dd14dbcdbcfcf4bc108a926b9667af4944a3b6faf808cf1bb9a3a2554722e172",
                      "SHA256=dca2b1b824cb28bd15577eace45bde7ff8f8f44705b17085524659de31761de4",
                      "SHA256=8b95f339a07d59a8c8d8580283dffb9e8dfabdeb9171e42c948ab68c71afe7f2",
                      "SHA256=5428a840fab6ac4a0ecb2fc20dbc5f928432b00b9297dd1cb6e69336f44eba66",
                      "SHA256=e2517ae0fccaa4aefe039026a4fc855964f0c2a5f84177140200b0e58ddbfd27",
                      "SHA256=75d05880de2593480254181215dd9a0075373876f2f4a2a4a9a654b2e0729a41",
                      "SHA256=56490e14ce3817c3a1ddc0d97b96e90d6351bcd29914e7c9282f6a998cca84b1",
                      "SHA256=f25d0a5e77e4ed9e7c4204a33cfc8e46281b43adbee550b15701dd00f41bdbe0",
                      "SHA256=845a5fdcbb08e7efa7e0eabfcd881c9eebc0eec0a3a2f8689194e6b91b6eeaf8",
                      "SHA256=9a89e6652e563d26a3f328ba23d91f464c9549da734557c5a02559df24b2700d",
                      "SHA256=5614f2bc9b2ed414aab2c5c7997bdcbe8236e67ced8f91a63d1b6cfbe6e08726",
                      "SHA256=37bf92dcedb47a90d8d38ebda8d8dd168ef5803dcb01161f8cf6d68b70d49d90",
                      "SHA256=ec8590f91f5cc21e931c57345425f0625a6e37dfba026b222260450de40459f5",
                      "SHA256=3994eb72b1c227c593e14b8cad7001de11d1c247d4fbf84d0714bb8a17853140",
                      "SHA256=d654f870436d63c9d8e4390d9d4d898abdf0456736c7654d71cdf81a299c3f87",
                      "SHA256=63fbfabd4d8afb497dee47d112eb9d683671b75a8bf6407c4bd5027fd211b892",
                      "SHA256=47028053f05188e6a366fff19bedbcad2bc4daba8ff9e4df724b77d0181b7054",
                      "SHA256=7c1b1e8c880a30c43b3a52ee245f963a977e1f40284f4b83f4b9afe3821753dd"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\PingCastle.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "PingCastle.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Product": {
                    "field": "Product",
                    "value": "Ping Castle",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      "--scanner aclcheck",
                      "--scanner antivirus",
                      "--scanner computerversion",
                      "--scanner foreignusers",
                      "--scanner laps_bitlocker",
                      "--scanner localadmin",
                      "--scanner nullsession",
                      "--scanner nullsession-trust",
                      "--scanner oxidbindings",
                      "--scanner remote",
                      "--scanner share",
                      "--scanner smb",
                      "--scanner smb3querynetwork",
                      "--scanner spooler",
                      "--scanner startup",
                      "--scanner zerologon"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": "--no-enum-limit",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "--healthcheck",
                      "--level Full"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "--healthcheck",
                      "--server "
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1595"
        ],
        "tactics": [
          "reconnaissance"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), frack113",
        "date": "2024-01-11",
        "modified": "",
        "references": [
          "https://github.com/vletoux/pingcastle",
          "https://thedfirreport.com/2023/10/30/netsupport-intrusion-results-in-domain-compromise/",
          "https://github.com/fengjixuchui/Start-ADEnum/blob/e237a739db98b6104427d833004836507da36a58/Functions/Start-ADEnum.ps1#L450",
          "https://github.com/lkys37en/Start-ADEnum/blob/5b42c54215fe5f57fc59abc52c20487d15764005/Functions/Start-ADEnum.ps1#L680",
          "https://github.com/projectHULK/AD_Recon/blob/dde2daba9b3393a9388cbebda87068972cc0bd3b/SecurityAssessment.ps1#L2699",
          "https://github.com/802-1x/Compliance/blob/2e53df8b6e89686a0b91116b3f42c8f717dca820/Ping%20Castle/Get-PingCastle-HTMLComplianceReport.ps1#L8",
          "https://github.com/EvotecIT/TheDashboard/blob/481a9ce8f82f2fd55fe65220ee6486bae6df0c9d/Examples/RunReports/PingCastle.ps1"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_pingcastle.yml"
      }
    },
    {
      "id": "4ae81040-fc1c-4249-bfa3-938d260214d9",
      "title": "Use Icacls to Hide File to Everyone",
      "status": "test",
      "description": "Detect use of icacls to deny access for everyone in Users folder sometimes used to hide malicious files",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1564.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_icacls": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "iCACLS.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\icacls.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cmd": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/deny",
                  "*S-1-1-0:"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1564.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-07-18",
        "modified": "2024-04-29",
        "references": [
          "https://app.any.run/tasks/1df999e6-1cb8-45e3-8b61-499d1b7d5a9b/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_icacls_deny.yml"
      }
    },
    {
      "id": "39b31e81-5f5f-4898-9c0e-2160cfc0f9bf",
      "title": "HackTool - Hashcat Password Cracker Execution",
      "status": "test",
      "description": "Execute Hashcat.exe with provided SAM file from registry of Windows and Password list to crack against",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1110.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\hashcat.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "-a ",
                  "-m 1000 ",
                  "-r "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1110.002"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-12-27",
        "modified": "2023-02-04",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1110.002/T1110.002.md#atomic-test-1---password-cracking-with-hashcat",
          "https://hashcat.net/wiki/doku.php?id=hashcat"
        ],
        "falsepositives": [
          "Tools that use similar command line flags and values"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_hashcat.yml"
      }
    },
    {
      "id": "0a99eb3e-1617-41bd-b095-13dc767f3def",
      "title": "HackTool - Jlaive In-Memory Assembly Execution",
      "status": "test",
      "description": "Detects the use of Jlaive to execute assemblies in a copied PowerShell",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "parent_selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\cmd.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "ParentCommandLine__endswith": {
                "field": "ParentCommandLine",
                "value": ".bat",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection1": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\xcopy.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "powershell.exe",
                  ".bat.exe"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection2": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\xcopy.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "pwsh.exe",
                  ".bat.exe"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection3": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\attrib.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "+s",
                  "+h",
                  ".bat.exe"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "parent_selection and (1 of selection*)",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "parent_selection"
            },
            {
              "type": "ref",
              "value": "(1 of selection*)"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1059.003"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Jose Luis Sanchez Martinez (@Joseliyo_Jstnk)",
        "date": "2022-05-24",
        "modified": "2023-02-22",
        "references": [
          "https://jstnk9.github.io/jstnk9/research/Jlaive-Antivirus-Evasion-Tool",
          "https://web.archive.org/web/20220514073704/https://github.com/ch2sh/Jlaive"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_jlaive_batch_execution.yml"
      }
    },
    {
      "id": "2c1486f5-02e8-4f86-9099-b97f2da4ed77",
      "title": "Insecure Proxy/DOH Transfer Via Curl.EXE",
      "status": "test",
      "description": "Detects execution of \"curl.exe\" with the \"insecure\" flag over proxy or DOH.",
      "level": "medium",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\curl.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "curl.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "--doh-insecure",
                  "--proxy-insecure"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-07-27",
        "modified": "",
        "references": [
          "https://curl.se/docs/manpage.html"
        ],
        "falsepositives": [
          "Access to badly maintained internal or development systems"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_curl_insecure_proxy_or_doh.yml"
      }
    },
    {
      "id": "e1693bc8-7168-4eab-8718-cdcaa68a1738",
      "title": "Suspicious WMIC Execution Via Office Process",
      "status": "test",
      "description": "Office application called wmic to proxye execution through a LOLBIN process. This is often used to break suspicious parent-child chain (Office app spawns LOLBin).",
      "level": "high",
      "tags": [
        "attack.t1204.002",
        "attack.t1047",
        "attack.t1218.010",
        "attack.execution",
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\WINWORD.EXE",
                  "\\EXCEL.EXE",
                  "\\POWERPNT.exe",
                  "\\MSPUB.exe",
                  "\\VISIO.exe",
                  "\\MSACCESS.EXE",
                  "\\EQNEDT32.EXE",
                  "\\ONENOTE.EXE",
                  "\\wordpad.exe",
                  "\\wordview.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_wmic_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\wbem\\WMIC.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "wmic.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_wmic_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "process",
                  "create",
                  "call"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "regsvr32",
                  "rundll32",
                  "msiexec",
                  "mshta",
                  "verclsid",
                  "wscript",
                  "cscript"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1204.002",
          "T1047",
          "T1218.010"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Vadim Khrykov, Cyb3rEng",
        "date": "2021-08-23",
        "modified": "2023-02-14",
        "references": [
          "https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware/",
          "https://github.com/vadim-hunter/Detection-Ideas-Rules/blob/02bcbfc2bfb8b4da601bb30de0344ae453aa1afe/Threat%20Intelligence/The%20DFIR%20Report/20210329_Sodinokibi_(aka_REvil)_Ransomware.yaml"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wmic_susp_execution_via_office_process.yml"
      }
    },
    {
      "id": "2d3cdeec-c0db-45b4-aa86-082f7eb75701",
      "title": "Microsoft IIS Service Account Password Dumped",
      "status": "test",
      "description": "Detects the Internet Information Services (IIS) command-line tool, AppCmd, being used to list passwords",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_base_name": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\appcmd.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "appcmd.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_base_list": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "list ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_standalone": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " /config",
                  " /xml",
                  " -config",
                  " -xml"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cmd_flags": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " /@t",
                  " /text",
                  " /show",
                  " -@t",
                  " -text",
                  " -show"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cmd_grep": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ":\\*",
                  "password"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_base_* and (selection_standalone or all of selection_cmd_*)",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "all of selection_base_* and (selection_standalone",
            "all of selection_cmd_*)"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1003"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Tim Rauch, Janantha Marasinghe, Elastic (original idea)",
        "date": "2022-11-08",
        "modified": "2023-01-22",
        "references": [
          "https://www.elastic.co/guide/en/security/current/microsoft-iis-service-account-password-dumped.html",
          "https://twitter.com/0gtweet/status/1588815661085917186?cxt=HHwWhIDUyaDbzYwsAAAA",
          "https://www.netspi.com/blog/technical/network-penetration-testing/decrypting-iis-passwords-to-break-out-of-the-dmz-part-2/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_iis_appcmd_service_account_password_dumped.yml"
      }
    },
    {
      "id": "c0b2768a-dd06-4671-8339-b16ca8d1f27f",
      "title": "Potentially Suspicious NTFS Symlink Behavior Modification",
      "status": "test",
      "description": "Detects the modification of NTFS symbolic link behavior using fsutil, which could be used to enable remote to local or remote to remote symlinks for potential attacks.\n",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059",
        "attack.defense-evasion",
        "attack.t1222.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img_proxy": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\cmd.exe",
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "Cmd.Exe",
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_fsutil_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "fsutil",
                  "behavior",
                  "set",
                  "SymlinkEvaluation"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_symlink_params": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "R2L:1",
                  "R2R:1",
                  "L2L:1"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059",
          "T1222.001"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113, The DFIR Report",
        "date": "2022-03-02",
        "modified": "2025-11-13",
        "references": [
          "https://www.cybereason.com/blog/cybereason-vs.-blackcat-ransomware",
          "https://learn.microsoft.com/fr-fr/windows-server/administration/windows-commands/fsutil-behavior",
          "https://thedfirreport.com/2025/06/30/hide-your-rdp-password-spray-leads-to-ransomhub-deployment/"
        ],
        "falsepositives": [
          "Legitimate usage, investigate the parent process and context to determine if benign."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_fsutil_symlinkevaluation.yml"
      }
    },
    {
      "id": "7773b877-5abb-4a3e-b9c9-fd0369b59b00",
      "title": "WMIC Remote Command Execution",
      "status": "test",
      "description": "Detects the execution of WMIC to query information on a remote system",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1047"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\WMIC.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "wmic.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "/node:",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_localhost": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "localhost",
                  "127.0.0.1"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_main_"
        }
      },
      "mitre": {
        "techniques": [
          "T1047"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-02-14",
        "modified": "2025-10-22",
        "references": [
          "https://securelist.com/moonbounce-the-dark-side-of-uefi-firmware/105468/",
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wmic"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wmic_remote_execution.yml"
      }
    },
    {
      "id": "2afafd61-6aae-4df4-baed-139fa1f4c345",
      "title": "Invocation of Active Directory Diagnostic Tool (ntdsutil.exe)",
      "status": "test",
      "description": "Detects execution of ntdsutil.exe, which can be used for various attacks against the NTDS database (NTDS.DIT)",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.t1003.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\ntdsutil.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.003"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Thomas Patzke",
        "date": "2019-01-16",
        "modified": "2022-03-11",
        "references": [
          "https://jpcertcc.github.io/ToolAnalysisResultSheet/details/ntdsutil.htm"
        ],
        "falsepositives": [
          "NTDS maintenance"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_ntdsutil_usage.yml"
      }
    },
    {
      "id": "853e74f9-9392-4935-ad3b-2e8c040dae86",
      "title": "UAC Bypass Using DismHost",
      "status": "test",
      "description": "Detects the pattern of UAC Bypass using DismHost DLL hijacking (UACMe 63)",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__contains_all": {
                "field": "ParentImage",
                "value": [
                  "C:\\Users\\",
                  "\\AppData\\Local\\Temp\\",
                  "\\DismHost.exe"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "IntegrityLevel": {
                "field": "IntegrityLevel",
                "value": [
                  "High",
                  "System",
                  "S-1-16-16384",
                  "S-1-16-12288"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Christian Burkard (Nextron Systems)",
        "date": "2021-08-30",
        "modified": "2024-12-01",
        "references": [
          "https://github.com/hfiref0x/UACME"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_uac_bypass_dismhost.yml"
      }
    },
    {
      "id": "af77cf95-c469-471c-b6a0-946c685c4798",
      "title": "Proxy Execution Via Wuauclt.EXE",
      "status": "test",
      "description": "Detects the use of the Windows Update Client binary (wuauclt.exe) for proxy execution.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218",
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\wuauclt.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "wuauclt.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "UpdateDeploymentProvider",
                  "RunHandlerComServer"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_generic": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " /UpdateDeploymentProvider UpdateDeploymentProvider.dll ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_wuaueng": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " wuaueng.dll ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_uus": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ":\\Windows\\UUS\\Packages\\Preview\\amd64\\updatedeploy.dll /ClassId",
                  ":\\Windows\\UUS\\amd64\\UpdateDeploy.dll /ClassId"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_winsxs": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  ":\\Windows\\WinSxS\\",
                  "\\UpdateDeploy.dll /ClassId "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_main_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research), Florian Roth (Nextron Systems), Sreeman, FPT.EagleEye Team",
        "date": "2020-10-12",
        "modified": "2023-11-11",
        "references": [
          "https://dtm.uk/wuauclt/",
          "https://blog.malwarebytes.com/threat-intelligence/2022/01/north-koreas-lazarus-apt-leverages-windows-update-client-github-in-latest-campaign/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wuauclt_dll_loading.yml"
      }
    },
    {
      "id": "0afbd410-de03-4078-8491-f132303cb67d",
      "title": "Renamed NetSupport RAT Execution",
      "status": "test",
      "description": "Detects the execution of a renamed \"client32.exe\" (NetSupport RAT) via Imphash, Product and OriginalFileName strings",
      "level": "high",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Product__contains": {
                    "field": "Product",
                    "value": "NetSupport Remote Control",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName__contains": {
                    "field": "OriginalFileName",
                    "value": "client32.exe",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Hashes__contains": {
                    "field": "Hashes",
                    "value": "IMPHASH=A9D50692E95B79723F3E76FCF70D023E",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\client32.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-09-19",
        "modified": "2024-11-23",
        "references": [
          "https://redcanary.com/blog/misbehaving-rats/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_renamed_netsupport_rat.yml"
      }
    },
    {
      "id": "9c7e131a-0f2c-4ae0-9d43-b04f4e266d43",
      "title": "Uncommon Child Process Of Appvlp.EXE",
      "status": "test",
      "description": "Detects uncommon child processes of Appvlp.EXE\nAppvlp or the Application Virtualization Utility is included with Microsoft Office. Attackers are able to abuse \"AppVLP\" to execute shell commands.\nNormally, this binary is used for Application Virtualization, but it can also be abused to circumvent the ASR file path rule folder\nor to mark a file as a system file.\n",
      "level": "medium",
      "tags": [
        "attack.t1218",
        "attack.defense-evasion",
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\appvlp.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_generic": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  ":\\Windows\\SysWOW64\\rundll32.exe",
                  ":\\Windows\\System32\\rundll32.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_office_msoasb": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": ":\\Program Files\\Microsoft Office",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\msoasb.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_office_skype": {
            "type": "field_match",
            "matchers": {
              "Image__contains_all": {
                "field": "Image",
                "value": [
                  ":\\Program Files\\Microsoft Office",
                  "\\SkypeSrv\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\SKYPESERVER.EXE",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_office_msouc": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": ":\\Program Files\\Microsoft Office",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\MSOUC.EXE",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Sreeman",
        "date": "2020-03-13",
        "modified": "2023-11-09",
        "references": [
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Appvlp/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_appvlp_uncommon_child_process.yml"
      }
    },
    {
      "id": "322ed9ec-fcab-4f67-9a34-e7c6aef43614",
      "title": "New Port Forwarding Rule Added Via Netsh.EXE",
      "status": "test",
      "description": "Detects the execution of netsh commands that configure a new port forwarding (PortProxy) rule",
      "level": "medium",
      "tags": [
        "attack.lateral-movement",
        "attack.defense-evasion",
        "attack.command-and-control",
        "attack.t1090"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\netsh.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "netsh.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "interface",
                  "portproxy",
                  "add",
                  "v4tov4"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "i ",
                  "p ",
                  "a ",
                  "v "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_3": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "connectp",
                  "listena",
                  "c="
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_img and 1 of selection_cli_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_img"
            },
            {
              "type": "ref",
              "value": "1 of selection_cli_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1090"
        ],
        "tactics": [
          "lateral_movement",
          "defense_evasion",
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), omkar72, oscd.community, Swachchhanda Shrawan Poudel",
        "date": "2019-01-29",
        "modified": "2023-09-01",
        "references": [
          "https://www.fireeye.com/blog/threat-research/2019/01/bypassing-network-restrictions-through-rdp-tunneling.html",
          "https://adepts.of0x.cc/netsh-portproxy-code/",
          "https://www.dfirnotes.net/portproxy_detection/"
        ],
        "falsepositives": [
          "Legitimate administration activity",
          "WSL2 network bridge PowerShell script used for WSL/Kubernetes/Docker (e.g. https://github.com/microsoft/WSL/issues/4150#issuecomment-504209723)"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_netsh_port_forwarding.yml"
      }
    },
    {
      "id": "6f3e2987-db24-4c78-a860-b4f4095a7095",
      "title": "Files Added To An Archive Using Rar.EXE",
      "status": "test",
      "description": "Detects usage of \"rar\" to add files to an archive for potential compression. An adversary may compress data (e.g. sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network.",
      "level": "low",
      "tags": [
        "attack.collection",
        "attack.t1560.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\rar.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " a ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1560.001"
        ],
        "tactics": [
          "collection"
        ]
      },
      "meta": {
        "author": "Timur Zinniatullin, E.M. Anhaus, oscd.community",
        "date": "2019-10-21",
        "modified": "2023-02-05",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1560.001/T1560.001.md",
          "https://eqllib.readthedocs.io/en/latest/analytics/1ec33c93-3d0b-4a28-8014-dbdaae5c60ae.html"
        ],
        "falsepositives": [
          "Highly likely if rar is a default archiver in the monitored environment."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_rar_compress_data.yml"
      }
    },
    {
      "id": "93199800-b52a-4dec-b762-75212c196542",
      "title": "PUA - RunXCmd Execution",
      "status": "test",
      "description": "Detects the use of the RunXCmd tool to execute commands with System or TrustedInstaller accounts",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1569.002",
        "attack.s0029"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_account": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " /account=system ",
                  " /account=ti "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_exec": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "/exec=",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1569.002"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-01-24",
        "modified": "2023-02-14",
        "references": [
          "https://www.d7xtech.com/free-software/runx/",
          "https://www.winhelponline.com/blog/run-program-as-system-localsystem-account-windows/"
        ],
        "falsepositives": [
          "Legitimate use by administrators"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_runxcmd.yml"
      }
    },
    {
      "id": "6938366d-8954-4ddc-baff-c830b3ba8fcd",
      "title": "HackTool - Certipy Execution",
      "status": "test",
      "description": "Detects Certipy execution, a tool for Active Directory Certificate Services enumeration and abuse based on PE metadata characteristics and common command line arguments.\n",
      "level": "high",
      "tags": [
        "attack.discovery",
        "attack.credential-access",
        "attack.t1649"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\Certipy.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "Certipy.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description__contains": {
                    "field": "Description",
                    "value": "Certipy",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_commands": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " account ",
                  " auth ",
                  " cert ",
                  " find ",
                  " forge ",
                  " ptt ",
                  " relay ",
                  " req ",
                  " shadow ",
                  " template "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_flags": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -bloodhound",
                  " -ca-pfx ",
                  " -dc-ip ",
                  " -kirbi",
                  " -old-bloodhound",
                  " -pfx ",
                  " -target",
                  " -template",
                  " -username ",
                  " -vulnerable",
                  "auth -pfx",
                  "shadow auto",
                  "shadow list"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_img or all of selection_cli_*",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection_img",
            "all of selection_cli_*"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1649"
        ],
        "tactics": [
          "discovery",
          "credential_access"
        ]
      },
      "meta": {
        "author": "pH-T (Nextron Systems), Sittikorn Sangrattanapitak",
        "date": "2023-04-17",
        "modified": "2024-10-08",
        "references": [
          "https://github.com/ly4k/Certipy",
          "https://research.ifcr.dk/certipy-4-0-esc9-esc10-bloodhound-gui-new-authentication-and-request-methods-and-more-7237d88061f7"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_certipy.yml"
      }
    },
    {
      "id": "cb5a2333-56cf-4562-8fcb-22ba1bca728d",
      "title": "Obfuscated IP Download Activity",
      "status": "test",
      "description": "Detects use of an encoded/obfuscated version of an IP address (hex, octal...) in an URL combined with a download command",
      "level": "medium",
      "tags": [
        "attack.discovery"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_command": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Invoke-WebRequest",
                  "iwr ",
                  "Invoke-RestMethod",
                  "irm ",
                  "wget ",
                  "curl ",
                  "DownloadFile",
                  "DownloadString"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_ip_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " 0x",
                  "//0x",
                  ".0x",
                  ".00x"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_ip_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "http://%",
                  "%2e"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_ip_3": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__re": {
                    "field": "CommandLine",
                    "value": "https?://[0-9]{1,3}\\.[0-9]{1,3}\\.0[0-9]{3,4}",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__re": {
                    "field": "CommandLine",
                    "value": "https?://[0-9]{1,3}\\.0[0-9]{3,7}",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__re": {
                    "field": "CommandLine",
                    "value": "https?://0[0-9]{3,11}",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__re": {
                    "field": "CommandLine",
                    "value": "https?://(0[0-9]{1,11}\\.){3}0[0-9]{1,11}",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__re": {
                    "field": "CommandLine",
                    "value": "https?://0[0-9]{1,11}",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__re": {
                    "field": "CommandLine",
                    "value": " [0-7]{7,13}",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_main_valid_ip": {
            "type": "field_match",
            "matchers": {
              "CommandLine__re": {
                "field": "CommandLine",
                "value": "https?://((25[0-5]|(2[0-4]|1\\d|[1-9])?\\d)(\\.|\\b)){4}",
                "modifiers": [
                  "re"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection_command and 1 of selection_ip_* and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_command"
            },
            {
              "type": "ref",
              "value": "1 of selection_ip_*"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), X__Junior (Nextron Systems)",
        "date": "2022-08-03",
        "modified": "2025-07-18",
        "references": [
          "https://h.43z.one/ipconverter/",
          "https://twitter.com/Yasser_Elsnbary/status/1553804135354564608",
          "https://twitter.com/fr0s7_/status/1712780207105404948"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_obfuscated_ip_download.yml"
      }
    },
    {
      "id": "b7b19cb6-9b32-4fc4-a108-73f19acfe262",
      "title": "Suspicious VBoxDrvInst.exe Parameters",
      "status": "test",
      "description": "Detect VBoxDrvInst.exe run with parameters allowing processing INF file.\nThis allows to create values in the registry and install drivers.\nFor example one could use this technique to obtain persistence via modifying one of Run or RunOnce registry keys\n",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\VBoxDrvInst.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "driver",
                  "executeinf"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Konstantin Grishchenko, oscd.community",
        "date": "2020-10-06",
        "modified": "2021-11-27",
        "references": [
          "https://github.com/LOLBAS-Project/LOLBAS/blob/4db780e0f0b2e2bb8cb1fa13e09196da9b9f1834/yml/LOLUtilz/OtherBinaries/VBoxDrvInst.yml",
          "https://twitter.com/pabraeken/status/993497996179492864"
        ],
        "falsepositives": [
          "Legitimate use of VBoxDrvInst.exe utility by VirtualBox Guest Additions installation process"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_virtualbox_vboxdrvinst_execution.yml"
      }
    },
    {
      "id": "84b1ecf9-6eff-4004-bafb-bae5c0e251b2",
      "title": "Potentially Suspicious GoogleUpdate Child Process",
      "status": "test",
      "description": "Detects potentially suspicious child processes of \"GoogleUpdate.exe\"",
      "level": "high",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\GoogleUpdate.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_known_legit": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__contains": {
                    "field": "Image",
                    "value": "\\Google",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\setup.exe",
                      "chrome_updater.exe",
                      "chrome_installer.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "filter_main_image_null": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-15",
        "modified": "2023-05-22",
        "references": [
          "https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/goofy-guineapig/NCSC-MAR-Goofy-Guineapig.pdf"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_googleupdate_susp_child_process.yml"
      }
    },
    {
      "id": "480e7e51-e797-47e3-8d72-ebfce65b6d8d",
      "title": "Python Spawning Pretty TTY on Windows",
      "status": "test",
      "description": "Detects python spawning a pretty tty",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "python.exe",
                  "python3.exe",
                  "python2.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "import pty",
                  ".spawn("
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "from pty import spawn",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_img and 1 of selection_cli_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_img"
            },
            {
              "type": "ref",
              "value": "1 of selection_cli_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1059"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nextron Systems",
        "date": "2022-06-03",
        "modified": "",
        "references": [
          "https://www.volexity.com/blog/2022/06/02/zero-day-exploitation-of-atlassian-confluence/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_python_pty_spawn.yml"
      }
    },
    {
      "id": "42333b2c-b425-441c-b70e-99404a17170f",
      "title": "HackTool - Sliver C2 Implant Activity Pattern",
      "status": "test",
      "description": "Detects process activity patterns as seen being used by Sliver C2 framework implants",
      "level": "critical",
      "tags": [
        "attack.execution",
        "attack.t1059"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-NoExit -Command [Console]::OutputEncoding=[Text.UTF8Encoding]::UTF8",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), Florian Roth (Nextron Systems)",
        "date": "2022-08-25",
        "modified": "2023-03-05",
        "references": [
          "https://github.com/BishopFox/sliver/blob/79f2d48fcdfc2bee4713b78d431ea4b27f733f30/implant/sliver/shell/shell_windows.go#L36",
          "https://www.microsoft.com/security/blog/2022/08/24/looking-for-the-sliver-lining-hunting-for-emerging-command-and-control-frameworks/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_sliver_c2_execution_pattern.yml"
      }
    },
    {
      "id": "f9999590-1f94-4a34-a91e-951e47bedefd",
      "title": "Suspicious Provlaunch.EXE Child Process",
      "status": "test",
      "description": "Detects suspicious child processes of \"provlaunch.exe\" which might indicate potential abuse to proxy execution.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\provlaunch.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_child": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\calc.exe",
                      "\\cmd.exe",
                      "\\cscript.exe",
                      "\\mshta.exe",
                      "\\notepad.exe",
                      "\\powershell.exe",
                      "\\pwsh.exe",
                      "\\regsvr32.exe",
                      "\\rundll32.exe",
                      "\\wscript.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__contains": {
                    "field": "Image",
                    "value": [
                      ":\\PerfLogs\\",
                      ":\\Temp\\",
                      ":\\Users\\Public\\",
                      "\\AppData\\Temp\\",
                      "\\Windows\\System32\\Tasks\\",
                      "\\Windows\\Tasks\\",
                      "\\Windows\\Temp\\"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-08-08",
        "modified": "",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Provlaunch/",
          "https://twitter.com/0gtweet/status/1674399582162153472"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_provlaunch_susp_child_process.yml"
      }
    },
    {
      "id": "7a4d9232-92fc-404d-8ce1-4c92e7caf539",
      "title": "HackTool - Stracciatella Execution",
      "status": "test",
      "description": "Detects Stracciatella which executes a Powershell runspace from within C# (aka SharpPick technique) with AMSI, ETW and Script Block Logging disabled based on PE metadata characteristics.",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.defense-evasion",
        "attack.t1059",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\Stracciatella.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "Stracciatella.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "Stracciatella",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Hashes__contains": {
                    "field": "Hashes",
                    "value": [
                      "SHA256=9d25e61ec1527e2a69d7c2a4e3fe2fe15890710c198a66a9f25d99fdf6c7b956",
                      "SHA256=fd16609bd9830c63b9413671678bb159b89c357d21942ddbb6b93add808d121a"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059",
          "T1562.001"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "pH-T (Nextron Systems)",
        "date": "2023-04-17",
        "modified": "2024-11-23",
        "references": [
          "https://github.com/mgeeky/Stracciatella"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_stracciatella_execution.yml"
      }
    },
    {
      "id": "3c05e90d-7eba-4324-9972-5d7f711a60a8",
      "title": "UAC Bypass Tools Using ComputerDefaults",
      "status": "test",
      "description": "Detects tools such as UACMe used to bypass UAC with computerdefaults.exe (UACMe 59)",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "IntegrityLevel": {
                "field": "IntegrityLevel",
                "value": [
                  "High",
                  "System",
                  "S-1-16-16384",
                  "S-1-16-12288"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\System32\\ComputerDefaults.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "ParentImage__contains": {
                "field": "ParentImage",
                "value": [
                  ":\\Windows\\System32",
                  ":\\Program Files"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Christian Burkard (Nextron Systems)",
        "date": "2021-08-31",
        "modified": "2024-12-01",
        "references": [
          "https://github.com/hfiref0x/UACME"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_uac_bypass_computerdefaults.yml"
      }
    },
    {
      "id": "05ebafc8-7aa2-4bcd-a269-2aec93f9e842",
      "title": "Add New Download Source To Winget",
      "status": "test",
      "description": "Detects usage of winget to add new additional download sources",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.execution",
        "attack.t1059"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\winget.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "winget.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "source ",
                  "add "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-04-17",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/windows/package-manager/winget/source",
          "https://github.com/nasbench/Misc-Research/tree/b9596e8109dcdb16ec353f316678927e507a5b8d/LOLBINs/Winget"
        ],
        "falsepositives": [
          "False positive are expected with legitimate sources"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_winget_add_custom_source.yml"
      }
    },
    {
      "id": "f91e51c9-f344-4b32-969b-0b6f6b8537d4",
      "title": "Renamed Schtasks Execution",
      "status": "experimental",
      "description": "Detects the execution of renamed schtasks.exe binary, which is a legitimate Windows utility used for scheduling tasks.\nOne of the very common persistence techniques is schedule malicious tasks using schtasks.exe.\nSince, it is heavily abused, it is also heavily monitored by security products. To evade detection, threat actors may rename the schtasks.exe binary to schedule their malicious tasks.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.execution",
        "attack.persistence",
        "attack.privilege-escalation",
        "attack.t1036.003",
        "attack.t1053.005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_cmd_operation": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " /create ",
                  " /delete ",
                  " /query ",
                  " /change ",
                  " /run ",
                  " /end "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cmd_flags": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " /tn ",
                  " /tr ",
                  " /sc ",
                  " /st ",
                  " /ru ",
                  " /fo "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_pe": {
            "type": "field_match",
            "matchers": {
              "OriginalFileName": {
                "field": "OriginalFileName",
                "value": "schtasks.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_cmd": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "schtasks",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\schtasks.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "(all of selection_cmd_* and not filter_main_cmd) or (selection_pe and not filter_main_img)",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "(all of selection_cmd_* and not filter_main_cmd)",
            "(selection_pe and not filter_main_img)"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1036.003",
          "T1053.005"
        ],
        "tactics": [
          "defense_evasion",
          "execution",
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-11-27",
        "modified": "",
        "references": [
          "https://x.com/JangPr0/status/1932034543026065833",
          "https://ss64.com/nt/schtasks.html"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_renamed_schtasks_execution.yml"
      }
    },
    {
      "id": "3d48c9d3-1aa6-418d-98d3-8fd3c01a564e",
      "title": "Potential Mftrace.EXE Abuse",
      "status": "test",
      "description": "Detects child processes of the \"Trace log generation tool for Media Foundation Tools\" (Mftrace.exe) which can abused to execute arbitrary binaries.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1127"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\mftrace.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1127"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-06-09",
        "modified": "2023-08-03",
        "references": [
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Mftrace/"
        ],
        "falsepositives": [
          "Legitimate use for tracing purposes"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_mftrace_child_process.yml"
      }
    },
    {
      "id": "396f6630-f3ac-44e3-bfc8-1b161bc00c4e",
      "title": "Suspicious Child Process Of Wermgr.EXE",
      "status": "test",
      "description": "Detects suspicious Windows Error Reporting manager (wermgr.exe) child process",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1055",
        "attack.t1036"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\wermgr.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\cmd.exe",
                  "\\cscript.exe",
                  "\\ipconfig.exe",
                  "\\mshta.exe",
                  "\\net.exe",
                  "\\net1.exe",
                  "\\netstat.exe",
                  "\\nslookup.exe",
                  "\\powershell_ise.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\regsvr32.exe",
                  "\\rundll32.exe",
                  "\\systeminfo.exe",
                  "\\whoami.exe",
                  "\\wscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_rundll32": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\rundll32.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "C:\\Windows\\system32\\WerConCpl.dll",
                  "LaunchErcApp "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "-queuereporting",
                  "-responsepester"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1055",
          "T1036"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-10-14",
        "modified": "2024-08-29",
        "references": [
          "https://www.trendmicro.com/en_us/research/22/j/black-basta-infiltrates-networks-via-qakbot-brute-ratel-and-coba.html",
          "https://www.echotrail.io/insights/search/wermgr.exe",
          "https://github.com/binderlabs/DirCreate2System"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wermgr_susp_child_process.yml"
      }
    },
    {
      "id": "dee0a7a3-f200-4112-a99b-952196d81e42",
      "title": "DumpMinitool Execution",
      "status": "test",
      "description": "Detects the use of \"DumpMinitool.exe\" a tool that allows the dump of process memory via the use of the \"MiniDumpWriteDump\"",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036",
        "attack.t1003.001",
        "attack.credential-access"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\DumpMinitool.exe",
                      "\\DumpMinitool.x86.exe",
                      "\\DumpMinitool.arm64.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "DumpMinitool.exe",
                      "DumpMinitool.x86.exe",
                      "DumpMinitool.arm64.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " Full",
                  " Mini",
                  " WithHeap"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1036",
          "T1003.001"
        ],
        "tactics": [
          "defense_evasion",
          "credential_access"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), Florian Roth (Nextron Systems)",
        "date": "2022-04-06",
        "modified": "2023-04-12",
        "references": [
          "https://twitter.com/mrd0x/status/1511415432888131586",
          "https://twitter.com/mrd0x/status/1511489821247684615",
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/DumpMinitool/",
          "https://gist.github.com/nasbench/6d58c3c125e2fa1b8f7a09754c1b087f"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_dumpminitool_execution.yml"
      }
    },
    {
      "id": "b30a8bc5-e21b-4ca2-9420-0a94019ac56a",
      "title": "Use of VisualUiaVerifyNative.exe",
      "status": "test",
      "description": "VisualUiaVerifyNative.exe is a Windows SDK that can be used for AWL bypass and is listed in Microsoft's recommended block rules.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\VisualUiaVerifyNative.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "VisualUiaVerifyNative.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Christopher Peacock @SecurePeacock, SCYTHE @scythe_io",
        "date": "2022-06-01",
        "modified": "",
        "references": [
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/VisualUiaVerifyNative/",
          "https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/design/applications-that-can-bypass-wdac",
          "https://bohops.com/2020/10/15/exploring-the-wdac-microsoft-recommended-block-rules-visualuiaverifynative/",
          "https://github.com/MicrosoftDocs/windows-itpro-docs/commit/937db704b9148e9cee7c7010cad4d00ce9c4fdad"
        ],
        "falsepositives": [
          "Legitimate testing of Microsoft UI parts."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_visualuiaverifynative.yml"
      }
    },
    {
      "id": "e173ad47-4388-4012-ae62-bd13f71c18a8",
      "title": "Potential DLL Sideloading Via DeviceEnroller.EXE",
      "status": "test",
      "description": "Detects the use of the PhoneDeepLink parameter to potentially sideload a DLL file that does not exist. This non-existent DLL file is named \"ShellChromeAPI.dll\".\nAdversaries can drop their own renamed DLL and execute it via DeviceEnroller.exe using this parameter\n",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1574.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\deviceenroller.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "deviceenroller.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "/PhoneDeepLink",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1574.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "@gott_cyber",
        "date": "2022-08-29",
        "modified": "2023-02-04",
        "references": [
          "https://mobile.twitter.com/0gtweet/status/1564131230941122561",
          "https://strontic.github.io/xcyclopedia/library/DeviceEnroller.exe-24BEF0D6B0ECED36BB41831759FDE18D.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_deviceenroller_dll_sideloading.yml"
      }
    },
    {
      "id": "8c0eca51-0f88-4db2-9183-fdfb10c703f9",
      "title": "LSA PPL Protection Disabled Via Reg.EXE",
      "status": "test",
      "description": "Detects the usage of the \"reg.exe\" utility to disable PPL protection on the LSA process",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.010"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\reg.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "reg.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "SYSTEM\\CurrentControlSet\\Control\\Lsa",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " add ",
                  " /d 0",
                  " /v RunAsPPL "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.010"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-03-22",
        "modified": "2023-03-26",
        "references": [
          "https://thedfirreport.com/2022/03/21/apt35-automates-initial-access-using-proxyshell/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_reg_lsa_ppl_protection_disabled.yml"
      }
    },
    {
      "id": "c363385c-f75d-4753-a108-c1a8e28bdbda",
      "title": "Potential Manage-bde.wsf Abuse To Proxy Execution",
      "status": "test",
      "description": "Detects potential abuse of the \"manage-bde.wsf\" script as a LOLBIN to proxy execution",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1216"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_wscript_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\wscript.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "wscript.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_wscript_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "manage-bde.wsf",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\cscript.exe",
                  "\\wscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "ParentCommandLine__contains": {
                "field": "ParentCommandLine",
                "value": "manage-bde.wsf",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_filter_cmd": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\cmd.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_wscript_* or (selection_parent and not selection_filter_cmd)",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "all of selection_wscript_*",
            "(selection_parent and not selection_filter_cmd)"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1216"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "oscd.community, Natalia Shornikova, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2020-10-13",
        "modified": "2023-02-03",
        "references": [
          "https://lolbas-project.github.io/lolbas/Scripts/Manage-bde/",
          "https://gist.github.com/bohops/735edb7494fe1bd1010d67823842b712",
          "https://twitter.com/bohops/status/980659399495741441",
          "https://twitter.com/JohnLaTwC/status/1223292479270600706",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1216/T1216.md"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_manage_bde.yml"
      }
    },
    {
      "id": "b2309017-4235-44fe-b5af-b15363011957",
      "title": "Uncommon Child Process Of Defaultpack.EXE",
      "status": "test",
      "description": "Detects uncommon child processes of \"DefaultPack.EXE\" binary as a proxy to launch other programs",
      "level": "medium",
      "tags": [
        "attack.t1218",
        "attack.defense-evasion",
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\DefaultPack.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-12-31",
        "modified": "2024-04-22",
        "references": [
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/DefaultPack/",
          "https://www.echotrail.io/insights/search/defaultpack.exe"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_defaultpack_uncommon_child_process.yml"
      }
    },
    {
      "id": "148431ce-4b70-403d-8525-fcc2993f29ea",
      "title": "Potential DLL Injection Or Execution Using Tracker.exe",
      "status": "test",
      "description": "Detects potential DLL injection and execution using \"Tracker.exe\"",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.defense-evasion",
        "attack.t1055.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\tracker.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "Tracker",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " /d ",
                  " /c "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_msbuild1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " /ERRORREPORT:PROMPT ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_msbuild2": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\Msbuild\\Current\\Bin\\MSBuild.exe",
                  "\\Msbuild\\Current\\Bin\\amd64\\MSBuild.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_"
        }
      },
      "mitre": {
        "techniques": [
          "T1055.001"
        ],
        "tactics": [
          "privilege_escalation",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Avneet Singh @v3t0_, oscd.community",
        "date": "2020-10-18",
        "modified": "2023-01-09",
        "references": [
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Tracker/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_tracker.yml"
      }
    },
    {
      "id": "b17ea6f7-6e90-447e-a799-e6c0a493d6ce",
      "title": "Shadow Copies Creation Using Operating Systems Utilities",
      "status": "test",
      "description": "Shadow Copies creation using operating systems utilities, possible credential access",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.t1003",
        "attack.t1003.002",
        "attack.t1003.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell.exe",
                      "\\pwsh.exe",
                      "\\wmic.exe",
                      "\\vssadmin.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell.EXE",
                      "pwsh.dll",
                      "wmic.exe",
                      "VSSADMIN.EXE"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "shadow",
                  "create"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1003",
          "T1003.002",
          "T1003.003"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Teymur Kheirkhabarov, Daniil Yugoslavskiy, oscd.community",
        "date": "2019-10-22",
        "modified": "2022-11-10",
        "references": [
          "https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment",
          "https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/tutorial-for-ntds-goodness-vssadmin-wmis-ntdsdit-system/"
        ],
        "falsepositives": [
          "Legitimate administrator working with shadow copies, access for backup purposes"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_shadow_copies_creation.yml"
      }
    },
    {
      "id": "811e0002-b13b-4a15-9d00-a613fce66e42",
      "title": "PUA - Process Hacker Execution",
      "status": "test",
      "description": "Detects the execution of Process Hacker based on binary metadata information (Image, Hash, Imphash, etc).\nProcess Hacker is a tool to view and manipulate processes, kernel options and other low level options.\nThreat actors abused older vulnerable versions to manipulate system processes.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.discovery",
        "attack.persistence",
        "attack.privilege-escalation",
        "attack.t1622",
        "attack.t1564",
        "attack.t1543"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__contains": {
                    "field": "Image",
                    "value": "\\ProcessHacker_",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\ProcessHacker.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "ProcessHacker.exe",
                      "Process Hacker"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "Process Hacker",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Product": {
                    "field": "Product",
                    "value": "Process Hacker",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Hashes__contains": {
                    "field": "Hashes",
                    "value": [
                      "MD5=68F9B52895F4D34E74112F3129B3B00D",
                      "MD5=B365AF317AE730A67C936F21432B9C71",
                      "SHA1=A0BDFAC3CE1880B32FF9B696458327CE352E3B1D",
                      "SHA1=C5E2018BF7C0F314FED4FD7FE7E69FA2E648359E",
                      "SHA256=D4A0FE56316A2C45B9BA9AC1005363309A3EDC7ACF9E4DF64D326A0FF273E80F",
                      "SHA256=BD2C2CF0631D881ED382817AFCCE2B093F4E412FFB170A719E2762F250ABFEA4",
                      "IMPHASH=3695333C60DEDECDCAFF1590409AA462",
                      "IMPHASH=04DE0AD9C37EB7BD52043D2ECAC958DF"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1622",
          "T1564",
          "T1543"
        ],
        "tactics": [
          "defense_evasion",
          "discovery",
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-10-10",
        "modified": "2024-11-23",
        "references": [
          "https://processhacker.sourceforge.io/",
          "https://www.crowdstrike.com/blog/falcon-overwatch-report-finds-increase-in-ecrime/"
        ],
        "falsepositives": [
          "While sometimes 'Process Hacker is used by legitimate administrators, the execution of Process Hacker must be investigated and allowed on a case by case basis"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_process_hacker.yml"
      }
    },
    {
      "id": "e83e8899-c9b2-483b-b355-5decc942b959",
      "title": "Interesting Service Enumeration Via Sc.EXE",
      "status": "test",
      "description": "Detects the enumeration and query of interesting and in some cases sensitive services on the system via \"sc.exe\".\nAttackers often try to enumerate the services currently running on a system in order to find different attack vectors.\n",
      "level": "low",
      "tags": [
        "attack.t1003",
        "attack.credential-access"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\sc.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "sc.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "query",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cmd": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "termservice",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1003"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel",
        "date": "2024-02-12",
        "modified": "",
        "references": [
          "https://www.n00py.io/2021/05/dumping-plaintext-rdp-credentials-from-svchost-exe/",
          "https://pentestlab.blog/tag/svchost/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sc_query_interesting_services.yml"
      }
    },
    {
      "id": "d87bd452-6da1-456e-8155-7dc988157b7d",
      "title": "Suspicious Usage Of ShellExec_RunDLL",
      "status": "test",
      "description": "Detects suspicious usage of the ShellExec_RunDLL function to launch other commands as seen in the the raspberry-robin attack",
      "level": "high",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_openasrundll": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "ShellExec_RunDLL",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_suspcli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\Desktop\\",
                  "\\Temp\\",
                  "\\Users\\Public\\",
                  "comspec",
                  "iex",
                  "Invoke-",
                  "msiexec",
                  "odbcconf",
                  "regsvr32"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-09-01",
        "modified": "2022-12-30",
        "references": [
          "https://redcanary.com/blog/raspberry-robin/",
          "https://www.microsoft.com/en-us/security/blog/2022/10/27/raspberry-robin-worm-part-of-larger-ecosystem-facilitating-pre-ransomware-activity/",
          "https://github.com/SigmaHQ/sigma/issues/1009"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_rundll32_susp_shellexec_execution.yml"
      }
    },
    {
      "id": "a1b2c3d4-e5f6-a7b8-c9d0-e1f2a3b4c5d6",
      "title": "Disabling Windows Defender WMI Autologger Session via Reg.exe",
      "status": "experimental",
      "description": "Detects the use of reg.exe to disable the Event Tracing for Windows (ETW) Autologger session for Windows Defender API and Audit events.\nBy setting the 'Start' value to '0' for the 'DefenderApiLogger' or 'DefenderAuditLogger' session, an attacker can prevent these critical security events\nfrom being logged, effectively blinding monitoring tools that rely on this data. This is a powerful defense evasion technique.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\reg.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "reg.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_reg_path": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\Control\\WMI\\Autologger\\DefenderApiLogger\\Start",
                  "\\Control\\WMI\\Autologger\\DefenderAuditLogger\\Start"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_reg_add": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "add",
                  "0"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_enable": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "0x00000001",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_main_"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Matt Anderson (Huntress)",
        "date": "2025-07-09",
        "modified": "",
        "references": [
          "https://research.splunk.com/endpoint/76406a0f-f5e0-4167-8e1f-337fdc0f1b0c/",
          "https://docs.microsoft.com/en-us/windows/win32/etw/configuring-and-starting-an-autologger-session",
          "https://thedfirreport.com/2021/10/18/icedid-to-xinglocker-ransomware-in-24-hours/",
          "https://blog.malwarebytes.com/malwarebytes-news/2021/02/lazyscripter-from-empire-to-double-rat/",
          "https://www.binarly.io/blog/design-issues-of-modern-edrs-bypassing-etw-based-solutions"
        ],
        "falsepositives": [
          "Highly unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_reg_disable_defender_wmi_autologger.yml"
      }
    },
    {
      "id": "43103702-5886-11ed-9b6a-0242ac120002",
      "title": "Suspicious Vsls-Agent Command With AgentExtensionPath Load",
      "status": "test",
      "description": "Detects Microsoft Visual Studio vsls-agent.exe lolbin execution with a suspicious library load using the --agentExtensionPath parameter",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\vsls-agent.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "--agentExtensionPath",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "Microsoft.VisualStudio.LiveShare.Agent.",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "bohops",
        "date": "2022-10-30",
        "modified": "",
        "references": [
          "https://twitter.com/bohops/status/1583916360404729857"
        ],
        "falsepositives": [
          "False positives depend on custom use of vsls-agent.exe"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_vslsagent_agentextensionpath_load.yml"
      }
    },
    {
      "id": "ca621ba5-54ab-4035-9942-d378e6fcde3c",
      "title": "HackTool - HandleKatz LSASS Dumper Execution",
      "status": "test",
      "description": "Detects the use of HandleKatz, a tool that demonstrates the usage of cloned handles to Lsass in order to create an obfuscated memory dump of the same",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_loader_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\loader.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "--pid:",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_loader_imphash": {
            "type": "field_match",
            "matchers": {
              "Hashes__contains": {
                "field": "Hashes",
                "value": [
                  "IMPHASH=38D9E015591BBFD4929E0D0F47FA0055",
                  "IMPHASH=0E2216679CA6E1094D63322E3412D650"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_flags": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "--pid:",
                  "--outfile:"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ".dmp",
                  "lsass",
                  ".obf",
                  "dump"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.001"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-08-18",
        "modified": "2024-11-23",
        "references": [
          "https://github.com/codewhitesec/HandleKatz"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_handlekatz.yml"
      }
    },
    {
      "id": "17f0c0a8-8bd5-4ee0-8c5f-a342c0199f35",
      "title": "Suspicious File Download From IP Via Wget.EXE",
      "status": "test",
      "description": "Detects potentially suspicious file downloads directly from IP addresses using Wget.exe",
      "level": "high",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\wget.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "wget.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_ip": {
            "type": "field_match",
            "matchers": {
              "CommandLine__re": {
                "field": "CommandLine",
                "value": "://[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}",
                "modifiers": [
                  "re"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_http": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "http",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_flag": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__re": {
                    "field": "CommandLine",
                    "value": "\\s-O\\s",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": "--output-document",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_ext": {
            "type": "field_match",
            "matchers": {
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": [
                  ".ps1",
                  ".ps1'",
                  ".ps1\"",
                  ".dat",
                  ".dat'",
                  ".dat\"",
                  ".msi",
                  ".msi'",
                  ".msi\"",
                  ".bat",
                  ".bat'",
                  ".bat\"",
                  ".exe",
                  ".exe'",
                  ".exe\"",
                  ".vbs",
                  ".vbs'",
                  ".vbs\"",
                  ".vbe",
                  ".vbe'",
                  ".vbe\"",
                  ".hta",
                  ".hta'",
                  ".hta\"",
                  ".dll",
                  ".dll'",
                  ".dll\"",
                  ".psm1",
                  ".psm1'",
                  ".psm1\""
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-07-27",
        "modified": "",
        "references": [
          "https://www.gnu.org/software/wget/manual/wget.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wget_download_direct_ip.yml"
      }
    },
    {
      "id": "33be4333-2c6b-44f4-ae28-102cdbde0a31",
      "title": "Suspicious Msbuild Execution By Uncommon Parent Process",
      "status": "test",
      "description": "Detects suspicious execution of 'Msbuild.exe' by a uncommon parent process",
      "level": "medium",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\MSBuild.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "MSBuild.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\devenv.exe",
                  "\\cmd.exe",
                  "\\msbuild.exe",
                  "\\python.exe",
                  "\\explorer.exe",
                  "\\nuget.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter_parent",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter_parent"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-11-17",
        "modified": "",
        "references": [
          "https://app.any.run/tasks/abdf586e-df0c-4d39-89a7-06bf24913401/",
          "https://www.echotrail.io/insights/search/msbuild.exe"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_msbuild_susp_parent_process.yml"
      }
    },
    {
      "id": "beaa66d6-aa1b-4e3c-80f5-e0145369bfaf",
      "title": "Potentially Suspicious EventLog Recon Activity Using Log Query Utilities",
      "status": "test",
      "description": "Detects execution of different log query utilities and commands to search and dump the content of specific event logs or look for specific event IDs.\nThis technique is used by threat actors in order to extract sensitive information from events logs such as usernames, IP addresses, hostnames, etc.\n",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.discovery",
        "attack.t1552",
        "attack.t1087"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_wmi": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "Select",
                  "Win32_NTLogEvent"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_wevtutil_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\wevtutil.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "wevtutil.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_wevtutil_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " qe ",
                  " query-events "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_wmic_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\wmic.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "wmic.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_wmic_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " ntevent",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cmdlet": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Get-WinEvent ",
                  "get-eventlog "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_logs_name": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Microsoft-Windows-PowerShell",
                  "Microsoft-Windows-Security-Auditing",
                  "Microsoft-Windows-TerminalServices-LocalSessionManager",
                  "Microsoft-Windows-TerminalServices-RemoteConnectionManager",
                  "Microsoft-Windows-Windows Defender",
                  "PowerShellCore",
                  "Security",
                  "Windows PowerShell"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_logs_eid": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "-InstanceId 462?",
                  ".eventid -eq 462?",
                  ".ID -eq 462?",
                  "EventCode=?462?",
                  "EventIdentifier=?462?",
                  "System[EventID=462?]",
                  "-InstanceId 4778",
                  ".eventid -eq 4778",
                  ".ID -eq 4778",
                  "EventCode=?4778?",
                  "EventIdentifier=?4778?",
                  "System[EventID=4778]",
                  "-InstanceId 25",
                  ".eventid -eq 25",
                  ".ID -eq 25",
                  "EventCode=?25?",
                  "EventIdentifier=?25?",
                  "System[EventID=25]",
                  "-InstanceId 1149",
                  ".eventid -eq 1149",
                  ".ID -eq 1149",
                  "EventCode=?1149?",
                  "EventIdentifier=?1149?",
                  "System[EventID=1149]",
                  "-InstanceId 21",
                  ".eventid -eq 21",
                  ".ID -eq 21",
                  "EventCode=?21?",
                  "EventIdentifier=?21?",
                  "System[EventID=21]",
                  "-InstanceId 22",
                  ".eventid -eq 22",
                  ".ID -eq 22",
                  "EventCode=?22?",
                  "EventIdentifier=?22?",
                  "System[EventID=22]"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_logs_* and (selection_wmi or all of selection_wevtutil_* or all of selection_wmic_* or selection_cmdlet)",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "1 of selection_logs_* and (selection_wmi",
            "all of selection_wevtutil_*",
            "all of selection_wmic_*",
            "selection_cmdlet)"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1552",
          "T1087"
        ],
        "tactics": [
          "credential_access",
          "discovery"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), X__Junior (Nextron Systems)",
        "date": "2022-09-09",
        "modified": "2025-12-02",
        "references": [
          "http://blog.talosintelligence.com/2022/09/lazarus-three-rats.html",
          "https://thedfirreport.com/2023/10/30/netsupport-intrusion-results-in-domain-compromise/",
          "https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-144a",
          "https://www.group-ib.com/blog/apt41-world-tour-2021/",
          "https://labs.withsecure.com/content/dam/labs/docs/f-secureLABS-tlp-white-lazarus-threat-intel-report2.pdf",
          "https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.diagnostics/get-winevent?view=powershell-7.3",
          "https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-eventlog?view=powershell-5.1",
          "http://www.solomonson.com/posts/2010-07-09-reading-eventviewer-command-line/",
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wevtutil",
          "https://ptsecurity.com/research/pt-esc-threat-intelligence/striking-panda-attacks-apt31-today",
          "https://www.cybertriage.com/artifact/terminalservices_remoteconnectionmanager_log/",
          "https://ponderthebits.com/2018/02/windows-rdp-related-event-logs-identification-tracking-and-investigation/"
        ],
        "falsepositives": [
          "Legitimate usage of the utility by administrators to query the event log"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_eventlog_content_recon.yml"
      }
    },
    {
      "id": "285b85b1-a555-4095-8652-a8a4106af63f",
      "title": "Suspicious Rundll32 Setupapi.dll Activity",
      "status": "test",
      "description": "setupapi.dll library provide InstallHinfSection function for processing INF files. INF file may contain instructions allowing to create values in the registry, modify files and install drivers. This technique could be used to obtain persistence via modifying one of Run or RunOnce registry keys, run process or use other DLLs chain calls (see references) InstallHinfSection function in setupapi.dll calls runonce.exe executable regardless of actual content of INF file.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.011"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\runonce.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\rundll32.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "ParentCommandLine__contains_all": {
                "field": "ParentCommandLine",
                "value": [
                  "setupapi.dll",
                  "InstallHinfSection"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.011"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Konstantin Grishchenko, oscd.community",
        "date": "2020-10-07",
        "modified": "2021-11-27",
        "references": [
          "https://lolbas-project.github.io/lolbas/Libraries/Setupapi/",
          "https://gist.githubusercontent.com/bohops/0cc6586f205f3691e04a1ebf1806aabd/raw/baf7b29891bb91e76198e30889fbf7d6642e8974/calc_exe.inf",
          "https://raw.githubusercontent.com/huntresslabs/evading-autoruns/master/shady.inf",
          "https://twitter.com/Z3Jpa29z/status/1313742350292746241?s=20"
        ],
        "falsepositives": [
          "Scripts and administrative tools that use INF files for driver installation with setupapi.dll"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_rundll32_setupapi_installhinfsection.yml"
      }
    },
    {
      "id": "e593cf51-88db-4ee1-b920-37e89012a3c9",
      "title": "Potentially Suspicious Rundll32 Activity",
      "status": "test",
      "description": "Detects suspicious execution of rundll32, with specific calls to some DLLs with known LOLBIN functionalities",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.011"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "javascript:",
                      ".RegisterXLL"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "url.dll",
                      "OpenURL"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "url.dll",
                      "OpenURLA"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "url.dll",
                      "FileProtocolHandler"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "zipfldr.dll",
                      "RouteTheCall"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "shell32.dll",
                      "Control_RunDLL"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "shell32.dll",
                      "ShellExec_RunDLL"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "mshtml.dll",
                      "PrintHTML"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "advpack.dll",
                      "LaunchINFSection"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "advpack.dll",
                      "RegisterOCX"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "ieadvpack.dll",
                      "LaunchINFSection"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "ieadvpack.dll",
                      "RegisterOCX"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "ieframe.dll",
                      "OpenURL"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "shdocvw.dll",
                      "OpenURL"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "syssetup.dll",
                      "SetupInfObjectInstallAction"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "setupapi.dll",
                      "InstallHinfSection"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "pcwutl.dll",
                      "LaunchApplication"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "dfshim.dll",
                      "ShOpenVerbApplication"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "dfshim.dll",
                      "ShOpenVerbShortcut"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "scrobj.dll",
                      "GenerateTypeLib",
                      "http"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "shimgvw.dll",
                      "ImageView_Fullscreen",
                      "http"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "comsvcs.dll",
                      "MiniDump"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_main_screensaver": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "shell32.dll,Control_RunDLL desk.cpl,screensaver,@screensaver",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_parent_cpl": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": "C:\\Windows\\System32\\control.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ParentCommandLine__contains": {
                "field": "ParentCommandLine",
                "value": ".cpl",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "Shell32.dll",
                  "Control_RunDLL",
                  ".cpl"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_startmenu": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": "C:\\Windows\\System32\\control.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "CommandLine__startswith": {
                "field": "CommandLine",
                "value": "\"C:\\Windows\\system32\\rundll32.exe\" Shell32.dll,Control_RunDLL \"C:\\Windows\\System32\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": ".cpl\",",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218.011"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "juju4, Jonhnathan Ribeiro, oscd.community, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2019-01-16",
        "modified": "2023-05-17",
        "references": [
          "http://www.hexacorn.com/blog/2017/05/01/running-programs-via-proxy-jumping-on-a-edr-bypass-trampoline/",
          "https://twitter.com/Hexacorn/status/885258886428725250",
          "https://gist.github.com/ryhanson/227229866af52e2d963cf941af135a52",
          "https://twitter.com/nas_bench/status/1433344116071583746",
          "https://twitter.com/eral4m/status/1479106975967240209",
          "https://twitter.com/eral4m/status/1479080793003671557"
        ],
        "falsepositives": [
          "False positives depend on scripts and administrative tools used in the monitored environment"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_rundll32_susp_activity.yml"
      }
    },
    {
      "id": "7b582f1a-b318-4c6a-bf4e-66fe49bf55a5",
      "title": "Remote Access Tool - ScreenConnect Potential Suspicious Remote Command Execution",
      "status": "test",
      "description": "Detects potentially suspicious child processes launched via the ScreenConnect client service.\n",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1219.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentCommandLine__contains_all": {
                "field": "ParentCommandLine",
                "value": [
                  ":\\Windows\\TEMP\\ScreenConnect\\",
                  "run.cmd"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\bitsadmin.exe",
                  "\\cmd.exe",
                  "\\curl.exe",
                  "\\dllhost.exe",
                  "\\net.exe",
                  "\\nltest.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\rundll32.exe",
                  "\\wevtutil.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1219.002"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems), @Kostastsale",
        "date": "2022-02-25",
        "modified": "2024-02-28",
        "references": [
          "https://www.mandiant.com/resources/telegram-malware-iranian-espionage",
          "https://docs.connectwise.com/ConnectWise_Control_Documentation/Get_started/Host_client/View_menu/Backstage_mode",
          "https://www.huntress.com/blog/slashandgrab-screen-connect-post-exploitation-in-the-wild-cve-2024-1709-cve-2024-1708",
          "https://www.trendmicro.com/en_us/research/24/b/threat-actor-groups-including-black-basta-are-exploiting-recent-.html"
        ],
        "falsepositives": [
          "If the script being executed make use of any of the utilities mentioned in the detection then they should filtered out or allowed."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_remote_access_tools_screenconnect_remote_execution_susp.yml"
      }
    },
    {
      "id": "903076ff-f442-475a-b667-4f246bcc203b",
      "title": "Nltest.EXE Execution",
      "status": "test",
      "description": "Detects nltest commands that can be used for information discovery",
      "level": "low",
      "tags": [
        "attack.discovery",
        "attack.t1016",
        "attack.t1018",
        "attack.t1482"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\nltest.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "nltestrk.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1016",
          "T1018",
          "T1482"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Arun Chauhan",
        "date": "2023-02-03",
        "modified": "",
        "references": [
          "https://jpcertcc.github.io/ToolAnalysisResultSheet/details/nltest.htm"
        ],
        "falsepositives": [
          "Legitimate administration activity"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_nltest_execution.yml"
      }
    },
    {
      "id": "514e7e3e-b3b4-4a67-af60-be20f139198b",
      "title": "PUA - AdFind.EXE Execution",
      "status": "experimental",
      "description": "Detects execution of Adfind.exe utility, which can be used for reconnaissance in an Active Directory environment",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.t1087.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\AdFind.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "AdFind.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Hashes__contains": {
                    "field": "Hashes",
                    "value": [
                      "IMPHASH=d144de8117df2beceaba2201ad304764",
                      "IMPHASH=12ce1c0f3f5837ecc18a3782408fa975",
                      "IMPHASH=bca5675746d13a1f246e2da3c2217492",
                      "IMPHASH=4fbf3f084fbbb2470b80b2013134df35",
                      "IMPHASH=49b639b4acbecc49d72a01f357aa4930",
                      "IMPHASH=53e117a96057eaf19c41380d0e87f1c2",
                      "IMPHASH=680dad9e300346e05a85023965867201",
                      "IMPHASH=21aa085d54992511b9f115355e468782"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1087.002"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-02-26",
        "modified": "",
        "references": [
          "https://www.joeware.net/freetools/tools/adfind/",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1087.002/T1087.002.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_adfind_execution.yml"
      }
    },
    {
      "id": "1c526788-0abe-4713-862f-b520da5e5316",
      "title": "Chromium Browser Headless Execution To Mockbin Like Site",
      "status": "test",
      "description": "Detects the execution of a Chromium based browser process with the \"headless\" flag and a URL pointing to the mockbin.org service (which can be used to exfiltrate data).",
      "level": "high",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\brave.exe",
                  "\\chrome.exe",
                  "\\msedge.exe",
                  "\\opera.exe",
                  "\\vivaldi.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_headless": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "--headless",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_url": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "://run.mocky",
                  "://mockbin"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "X__Junior (Nextron Systems)",
        "date": "2023-09-11",
        "modified": "",
        "references": [
          "https://www.zscaler.com/blogs/security-research/steal-it-campaign"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_browsers_chromium_mockbin_abuse.yml"
      }
    },
    {
      "id": "04936b66-3915-43ad-a8e5-809eadfd1141",
      "title": "Insensitive Subfolder Search Via Findstr.EXE",
      "status": "test",
      "description": "Detects execution of findstr with the \"s\" and \"i\" flags for a \"subfolder\" and \"insensitive\" search respectively. Attackers sometimes leverage this built-in utility to search the system for interesting files or filter through results of commands.\n",
      "level": "low",
      "tags": [
        "attack.defense-evasion",
        "attack.credential-access",
        "attack.command-and-control",
        "attack.t1218",
        "attack.t1564.004",
        "attack.t1552.001",
        "attack.t1105"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_findstr": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": "findstr",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "findstr.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "FINDSTR.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_search_subfolder": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -s ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli_search_insensitive": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -i ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_findstr and all of selection_cli_search_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_findstr"
            },
            {
              "type": "ref",
              "value": "all of selection_cli_search_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218",
          "T1564.004",
          "T1552.001",
          "T1105"
        ],
        "tactics": [
          "defense_evasion",
          "credential_access",
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Furkan CALISKAN, @caliskanfurkan_, @oscd_initiative, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2020-10-05",
        "modified": "2024-03-05",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Findstr/",
          "https://oddvar.moe/2018/04/11/putting-data-in-alternate-data-streams-and-how-to-execute-it-part-2/",
          "https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f"
        ],
        "falsepositives": [
          "Administrative or software activity"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_findstr_subfolder_search.yml"
      }
    },
    {
      "id": "6da2c9f5-7c53-401b-aacb-92c040ce1215",
      "title": "Use of W32tm as Timer",
      "status": "test",
      "description": "When configured with suitable command line arguments, w32tm can act as a delay mechanism",
      "level": "high",
      "tags": [
        "attack.discovery",
        "attack.t1124"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_w32tm": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\w32tm.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "w32time.dll",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cmd": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/stripchart",
                  "/computer:",
                  "/period:",
                  "/dataonly",
                  "/samples:"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1124"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-09-25",
        "modified": "",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/d0dad62dbcae9c60c519368e82c196a3db577055/atomics/T1124/T1124.md",
          "https://blogs.blackberry.com/en/2022/05/dirty-deeds-done-dirt-cheap-russian-rat-offers-backdoor-bargains"
        ],
        "falsepositives": [
          "Legitimate use"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_w32tm.yml"
      }
    },
    {
      "id": "744a188b-0415-4792-896f-11ddb0588dbc",
      "title": "Potential Process Injection Via Msra.EXE",
      "status": "test",
      "description": "Detects potential process injection via Microsoft Remote Asssistance (Msra.exe) by looking at suspicious child processes spawned from the aforementioned process. It has been a target used by many threat actors and used for discovery and persistence tactics",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.defense-evasion",
        "attack.t1055"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\msra.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "ParentCommandLine__endswith": {
                "field": "ParentCommandLine",
                "value": "msra.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\arp.exe",
                  "\\cmd.exe",
                  "\\net.exe",
                  "\\netstat.exe",
                  "\\nslookup.exe",
                  "\\route.exe",
                  "\\schtasks.exe",
                  "\\whoami.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1055"
        ],
        "tactics": [
          "privilege_escalation",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Alexander McDonald",
        "date": "2022-06-24",
        "modified": "2023-02-03",
        "references": [
          "https://www.microsoft.com/security/blog/2021/12/09/a-closer-look-at-qakbots-latest-building-blocks-and-how-to-knock-them-down/",
          "https://www.fortinet.com/content/dam/fortinet/assets/analyst-reports/ar-qakbot.pdf"
        ],
        "falsepositives": [
          "Legitimate use of Msra.exe"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_msra_process_injection.yml"
      }
    },
    {
      "id": "b6b49cd1-34d6-4ead-b1bf-176e9edba9a4",
      "title": "Potential PowerShell Obfuscation Via Reversed Commands",
      "status": "test",
      "description": "Detects the presence of reversed PowerShell commands in the CommandLine. This is often used as a method of obfuscation by attackers",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027",
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "hctac",
                  "kaerb",
                  "dnammoc",
                  "ekovn",
                  "eliFd",
                  "rahc",
                  "etirw",
                  "golon",
                  "tninon",
                  "eddih",
                  "tpircS",
                  "ssecorp",
                  "llehsrewop",
                  "esnopser",
                  "daolnwod",
                  "tneilCbeW",
                  "tneilc",
                  "ptth",
                  "elifotevas",
                  "46esab",
                  "htaPpmeTteG",
                  "tcejbO",
                  "maerts",
                  "hcaerof",
                  "retupmoc"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_encoded_keyword": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -EncodedCommand ",
                  " -enc "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_main_"
        }
      },
      "mitre": {
        "techniques": [
          "T1027",
          "T1059.001"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Teymur Kheirkhabarov (idea), Vasiliy Burov (rule), oscd.community, Tim Shelton",
        "date": "2020-10-11",
        "modified": "2023-05-31",
        "references": [
          "https://2019.offzone.moscow/ru/report/hunting-for-powershell-abuses/",
          "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse?slide=66"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_cmdline_reversed_strings.yml"
      }
    },
    {
      "id": "f1edd233-30b5-4823-9e6a-c4171b24d316",
      "title": "Rundll32 Registered COM Objects",
      "status": "test",
      "description": "load malicious registered COM objects",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1546.015"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\rundll32.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "RUNDLL32.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "-sta ",
                  "-localserver "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "{",
                  "}"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1546.015"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-02-13",
        "modified": "2023-02-09",
        "references": [
          "https://nasbench.medium.com/a-deep-dive-into-rundll32-exe-642344b41e90",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1546.015/T1546.015.md"
        ],
        "falsepositives": [
          "Legitimate use"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_rundll32_registered_com_objects.yml"
      }
    },
    {
      "id": "7f741dcf-fc22-4759-87b4-9ae8376676a2",
      "title": "Bypass UAC via Fodhelper.exe",
      "status": "test",
      "description": "Identifies use of Fodhelper.exe to bypass User Account Control. Adversaries use this technique to execute privileged processes.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\fodhelper.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "E.M. Anhaus (originally from Atomic Blue Detections, Tony Lambert), oscd.community",
        "date": "2019-10-24",
        "modified": "2021-11-27",
        "references": [
          "https://eqllib.readthedocs.io/en/latest/analytics/e491ce22-792f-11e9-8f5c-d46d6d62a49e.html",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1548.002/T1548.002.md"
        ],
        "falsepositives": [
          "Legitimate use of fodhelper.exe utility by legitimate user"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_uac_bypass_fodhelper.yml"
      }
    },
    {
      "id": "0955e4e1-c281-4fb9-9ee1-5ee7b4b754d2",
      "title": "Use of Pcalua For Execution",
      "status": "test",
      "description": "Detects execition of commands and binaries from the context of The program compatibility assistant (Pcalua.exe). This can be used as a LOLBIN in order to bypass application whitelisting.",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\pcalua.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -a",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), E.M. Anhaus (originally from Atomic Blue Detections, Endgame), oscd.community",
        "date": "2022-06-14",
        "modified": "2023-01-04",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Pcalua/",
          "https://pentestlab.blog/2020/07/06/indirect-command-execution/"
        ],
        "falsepositives": [
          "Legitimate use by a via a batch script or by an administrator."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_pcalua.yml"
      }
    },
    {
      "id": "b6d98a4f-cef0-4abf-bbf6-24132854a83d",
      "title": "Remote Access Tool - GoToAssist Execution",
      "status": "test",
      "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1219.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "GoTo Opener",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Product": {
                    "field": "Product",
                    "value": "GoTo Opener",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Company": {
                    "field": "Company",
                    "value": "LogMeIn, Inc.",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1219.002"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-02-13",
        "modified": "2023-03-05",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-4---gotoassist-files-detected-test-on-windows"
        ],
        "falsepositives": [
          "Legitimate use"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_remote_access_tools_gotoopener.yml"
      }
    },
    {
      "id": "534f2ef7-e8a2-4433-816d-c91bccde289b",
      "title": "Explorer NOUACCHECK Flag",
      "status": "test",
      "description": "Detects suspicious starts of explorer.exe that use the /NOUACCHECK flag that allows to run all sub processes of that newly started explorer.exe without any UAC checks",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.defense-evasion",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\explorer.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "/NOUACCHECK",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_dc_logon": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "ParentCommandLine": {
                    "field": "ParentCommandLine",
                    "value": "C:\\Windows\\system32\\svchost.exe -k netsvcs -p -s Schedule",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "ParentImage": {
                    "field": "ParentImage",
                    "value": "C:\\Windows\\System32\\svchost.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "condition": "selection and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "privilege_escalation",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-02-23",
        "modified": "2022-04-21",
        "references": [
          "https://twitter.com/ORCA6665/status/1496478087244095491"
        ],
        "falsepositives": [
          "Domain Controller User Logon",
          "Unknown how many legitimate software products use that method"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_explorer_nouaccheck.yml"
      }
    },
    {
      "id": "5afee48e-67dd-4e03-a783-f74259dcf998",
      "title": "Potential LSASS Process Dump Via Procdump",
      "status": "stable",
      "description": "Detects potential credential harvesting attempts through LSASS memory dumps using ProcDump.\nThis rule identifies suspicious command-line patterns that combine memory dump flags (-ma, -mm, -mp) with LSASS-related process markers.\nLSASS (Local Security Authority Subsystem Service) contains sensitive authentication data including plaintext passwords, NTLM hashes, and Kerberos tickets in memory.\nAttackers commonly dump LSASS memory to extract credentials for lateral movement and privilege escalation.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036",
        "attack.credential-access",
        "attack.t1003.001",
        "car.2013-05-009"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_flags": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -ma ",
                  " -mm ",
                  " -mp "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_process": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " ls",
                  " keyiso",
                  " samss"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1036",
          "T1003.001"
        ],
        "tactics": [
          "defense_evasion",
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2018-10-30",
        "modified": "2025-10-19",
        "references": [
          "https://learn.microsoft.com/en-us/sysinternals/downloads/procdump",
          "https://research.splunk.com/endpoint/3742ebfe-64c2-11eb-ae93-0242ac130002",
          "https://x.com/wietze/status/1958302556033065292?s=12"
        ],
        "falsepositives": [
          "Unlikely, because no one should dump an lsass process memory",
          "Another tool that uses command line flags similar to ProcDump"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sysinternals_procdump_lsass.yml"
      }
    },
    {
      "id": "c6fb44c6-71f5-49e6-9462-1425d328aee3",
      "title": "Powershell Base64 Encoded MpPreference Cmdlet",
      "status": "test",
      "description": "Detects base64 encoded \"MpPreference\" PowerShell cmdlet code that tries to modifies or tamper with Windows Defender AV",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__base64offset_contains": {
                    "field": "CommandLine",
                    "value": [
                      "Add-MpPreference ",
                      "Set-MpPreference ",
                      "add-mppreference ",
                      "set-mppreference "
                    ],
                    "modifiers": [
                      "base64offset",
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      "QQBkAGQALQBNAHAAUAByAGUAZgBlAHIAZQBuAGMAZQAgA",
                      "EAZABkAC0ATQBwAFAAcgBlAGYAZQByAGUAbgBjAGUAIA",
                      "BAGQAZAAtAE0AcABQAHIAZQBmAGUAcgBlAG4AYwBlACAA",
                      "UwBlAHQALQBNAHAAUAByAGUAZgBlAHIAZQBuAGMAZQAgA",
                      "MAZQB0AC0ATQBwAFAAcgBlAGYAZQByAGUAbgBjAGUAIA",
                      "TAGUAdAAtAE0AcABQAHIAZQBmAGUAcgBlAG4AYwBlACAA",
                      "YQBkAGQALQBtAHAAcAByAGUAZgBlAHIAZQBuAGMAZQAgA",
                      "EAZABkAC0AbQBwAHAAcgBlAGYAZQByAGUAbgBjAGUAIA",
                      "hAGQAZAAtAG0AcABwAHIAZQBmAGUAcgBlAG4AYwBlACAA",
                      "cwBlAHQALQBtAHAAcAByAGUAZgBlAHIAZQBuAGMAZQAgA",
                      "MAZQB0AC0AbQBwAHAAcgBlAGYAZQByAGUAbgBjAGUAIA",
                      "zAGUAdAAtAG0AcABwAHIAZQBmAGUAcgBlAG4AYwBlACAA"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-03-04",
        "modified": "2023-01-30",
        "references": [
          "https://learn.microsoft.com/en-us/defender-endpoint/configure-process-opened-file-exclusions-microsoft-defender-antivirus",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md",
          "https://twitter.com/AdamTheAnalyst/status/1483497517119590403"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_base64_mppreference.yml"
      }
    },
    {
      "id": "526be59f-a573-4eea-b5f7-f0973207634d",
      "title": "New Process Created Via Wmic.EXE",
      "status": "test",
      "description": "Detects new process creation using WMIC via the \"process call create\" flag",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1047",
        "car.2016-03-002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\wmic.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "wmic.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "process",
                  "call",
                  "create"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1047"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Michael Haag, Florian Roth (Nextron Systems), juju4, oscd.community",
        "date": "2019-01-16",
        "modified": "2023-02-14",
        "references": [
          "https://www.sans.org/blog/wmic-for-incident-response/",
          "https://github.com/redcanaryco/atomic-red-team/blob/84215139ee5127f8e3a117e063b604812bd71928/atomics/T1047/T1047.md#atomic-test-5---wmi-execute-local-process"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wmic_process_creation.yml"
      }
    },
    {
      "id": "df1f26d3-bea7-4700-9ea2-ad3e990cf90e",
      "title": "Node Process Executions",
      "status": "test",
      "description": "Detects the execution of other scripts using the Node executable packaged with Adobe Creative Cloud",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.execution",
        "attack.t1127",
        "attack.t1059.007"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\Adobe Creative Cloud Experience\\libs\\node.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "Adobe Creative Cloud Experience\\js",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1127",
          "T1059.007"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Max Altgelt (Nextron Systems)",
        "date": "2022-04-06",
        "modified": "",
        "references": [
          "https://twitter.com/mttaggart/status/1511804863293784064"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_node_adobe_creative_cloud_abuse.yml"
      }
    },
    {
      "id": "64760eef-87f7-4ed3-93fd-655668ea9420",
      "title": "Use of Scriptrunner.exe",
      "status": "test",
      "description": "The \"ScriptRunner.exe\" binary can be abused to proxy execution through it and bypass possible whitelisting",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.execution",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\ScriptRunner.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "ScriptRunner.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -appvscript ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-07-01",
        "modified": "",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Scriptrunner/"
        ],
        "falsepositives": [
          "Legitimate use when App-v is deployed"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_scriptrunner.yml"
      }
    },
    {
      "id": "4f154fb6-27d1-4813-a759-78b93e0b9c48",
      "title": "Operator Bloopers Cobalt Strike Modules",
      "status": "test",
      "description": "Detects Cobalt Strike module/commands accidentally entered in CMD shell",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "Cmd.Exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\cmd.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Invoke-UserHunter",
                  "Invoke-ShareFinder",
                  "Invoke-Kerberoast",
                  "Invoke-SMBAutoBrute",
                  "Invoke-Nightmare",
                  "zerologon",
                  "av_query"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.003"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "_pete_0, TheDFIRReport",
        "date": "2022-05-06",
        "modified": "2023-01-30",
        "references": [
          "https://hstechdocs.helpsystems.com/manuals/cobaltstrike/current/userguide/content/cobalt-4-5-user-guide.pdf",
          "https://thedfirreport.com/2021/10/04/bazarloader-and-the-conti-leaks/",
          "https://thedfirreport.com/2022/06/16/sans-ransomware-summit-2022-can-you-detect-this/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_cobaltstrike_bloopers_modules.yml"
      }
    },
    {
      "id": "c02e96b7-c63a-4c47-bd83-4a9f74afcfb2",
      "title": "New Service Creation Using PowerShell",
      "status": "test",
      "description": "Detects the creation of a new service using powershell.",
      "level": "low",
      "tags": [
        "attack.persistence",
        "attack.privilege-escalation",
        "attack.t1543.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "New-Service",
                  "-BinaryPathName"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1543.003"
        ],
        "tactics": [
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Timur Zinniatullin, Daniil Yugoslavskiy, oscd.community",
        "date": "2023-02-20",
        "modified": "",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1543.003/T1543.003.md"
        ],
        "falsepositives": [
          "Legitimate administrator or user creates a service for legitimate reasons.",
          "Software installation"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_create_service.yml"
      }
    },
    {
      "id": "c83bf4b5-cdf0-437c-90fa-43d734f7c476",
      "title": "Run PowerShell Script from Redirected Input Stream",
      "status": "test",
      "description": "Detects PowerShell script execution via input stream redirect",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.execution",
        "attack.t1059"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\powershell.exe",
                  "\\pwsh.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__re": {
                "field": "CommandLine",
                "value": "\\s-\\s*<",
                "modifiers": [
                  "re"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Moriarty Meng (idea), Anton Kutepov (rule), oscd.community",
        "date": "2020-10-17",
        "modified": "2021-11-27",
        "references": [
          "https://github.com/LOLBAS-Project/LOLBAS/blob/4db780e0f0b2e2bb8cb1fa13e09196da9b9f1834/yml/LOLUtilz/OSBinaries/Powershell.yml",
          "https://twitter.com/Moriarty_Meng/status/984380793383370752"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_run_script_from_input_stream.yml"
      }
    },
    {
      "id": "57bff678-25d1-4d6c-8211-8ca106d12053",
      "title": "Remote Access Tool - ScreenConnect Execution",
      "status": "test",
      "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1219.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "ScreenConnect Service",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Product": {
                    "field": "Product",
                    "value": "ScreenConnect",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Company": {
                    "field": "Company",
                    "value": "ScreenConnect Software",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1219.002"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-02-13",
        "modified": "2023-03-05",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-5---screenconnect-application-download-and-install-on-windows"
        ],
        "falsepositives": [
          "Legitimate usage of the tool"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_remote_access_tools_screenconnect.yml"
      }
    },
    {
      "id": "589ac73f-8e12-409c-964e-31a2f5775ae2",
      "title": "HackTool - WSASS Execution",
      "status": "experimental",
      "description": "Detects execution of WSASS, a tool used to dump LSASS memory on Windows systems by leveraging WER's\n(Windows Error Reporting) WerFaultSecure.EXE to bypass PPL (Protected Process Light) protections.\n",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\wsass.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_hash": {
            "type": "field_match",
            "matchers": {
              "Hashes__contains": {
                "field": "Hashes",
                "value": "IMPHASH=32F5095C9BBDCACF28FD4060EB4DFC42",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__re": {
                "field": "CommandLine",
                "value": "(?i)\\.exe[\\\"\\']?\\s+.{12,64}[\\\"\\']?\\s+\\d{2,10}",
                "modifiers": [
                  "re"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "werfaultsecure",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.001"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-11-23",
        "modified": "",
        "references": [
          "https://github.com/TwoSevenOneT/WSASS",
          "https://www.zerosalarium.com/2025/09/Dumping-LSASS-With-WER-On-Modern-Windows-11.html"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_wsass.yml"
      }
    },
    {
      "id": "1fb76ab8-fa60-4b01-bddd-71e89bf555da",
      "title": "Pubprn.vbs Proxy Execution",
      "status": "test",
      "description": "Detects the use of the 'Pubprn.vbs' Microsoft signed script to execute commands.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1216.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "\\pubprn.vbs",
                  "script:"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1216.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-05-28",
        "modified": "",
        "references": [
          "https://lolbas-project.github.io/lolbas/Scripts/Pubprn/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_pubprn.yml"
      }
    },
    {
      "id": "d522eca2-2973-4391-a3e0-ef0374321dae",
      "title": "Abused Debug Privilege by Arbitrary Parent Processes",
      "status": "test",
      "description": "Detection of unusual child processes by different system processes",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\winlogon.exe",
                  "\\services.exe",
                  "\\lsass.exe",
                  "\\csrss.exe",
                  "\\smss.exe",
                  "\\wininit.exe",
                  "\\spoolsv.exe",
                  "\\searchindexer.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "User__contains": {
                "field": "User",
                "value": [
                  "AUTHORI",
                  "AUTORI"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell.exe",
                      "\\pwsh.exe",
                      "\\cmd.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell.EXE",
                      "pwsh.dll",
                      "Cmd.Exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " route ",
                  " ADD "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not filter",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "all of selection_*"
            },
            {
              "type": "not",
              "value": "filter"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1548"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Semanur Guneysu @semanurtg, oscd.community",
        "date": "2020-10-28",
        "modified": "2022-11-11",
        "references": [
          "https://image.slidesharecdn.com/kheirkhabarovoffzonefinal-181117201458/95/hunting-for-privilege-escalation-in-windows-environment-74-638.jpg"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_abusing_debug_privilege.yml"
      }
    },
    {
      "id": "92626ddd-662c-49e3-ac59-f6535f12d189",
      "title": "Scheduled Task Creation Via Schtasks.EXE",
      "status": "test",
      "description": "Detects the creation of scheduled tasks by user accounts via the \"schtasks\" utility.",
      "level": "low",
      "tags": [
        "attack.execution",
        "attack.persistence",
        "attack.privilege-escalation",
        "attack.t1053.005",
        "attack.s0111",
        "car.2013-08-001",
        "stp.1u"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\schtasks.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " /create ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_system_user": {
            "type": "field_match",
            "matchers": {
              "User__contains": {
                "field": "User",
                "value": [
                  "AUTHORI",
                  "AUTORI"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_msoffice": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": [
                  "C:\\Program Files\\Microsoft Office\\root\\integration\\integrator.exe",
                  "C:\\Program Files (x86)\\Microsoft Office\\root\\integration\\integrator.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Windows\\System32\\schtasks.exe",
                  "C:\\Windows\\SysWOW64\\schtasks.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "Microsoft\\Office\\Office Performance Monitor",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1053.005"
        ],
        "tactics": [
          "execution",
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2019-01-16",
        "modified": "2025-10-22",
        "references": [
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/schtasks-create"
        ],
        "falsepositives": [
          "Administrative activity",
          "Software installation"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_schtasks_creation.yml"
      }
    },
    {
      "id": "68bcd73b-37ef-49cb-95fc-edc809730be6",
      "title": "Potential Unquoted Service Path Reconnaissance Via Wmic.EXE",
      "status": "test",
      "description": "Detects known WMI recon method to look for unquoted service paths using wmic. Often used by pentester and attacker enumeration scripts",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1047"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "wmic.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\WMIC.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " service get ",
                  "name,displayname,pathname,startmode"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1047"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-06-20",
        "modified": "2023-09-11",
        "references": [
          "https://github.com/nccgroup/redsnarf/blob/35949b30106ae543dc6f2bc3f1be10c6d9a8d40e/redsnarf.py",
          "https://github.com/S3cur3Th1sSh1t/Creds/blob/eac23d67f7f90c7fc8e3130587d86158c22aa398/PowershellScripts/jaws-enum.ps1",
          "https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wmic_recon_unquoted_service_search.yml"
      }
    },
    {
      "id": "43e32da2-fdd0-4156-90de-50dfd62636f9",
      "title": "Dism Remove Online Package",
      "status": "test",
      "description": "Deployment Image Servicing and Management tool. DISM is used to enumerate, install, uninstall, configure, and update features and packages in Windows images",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_dismhost": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\DismHost.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "ParentCommandLine__contains_all": {
                "field": "ParentCommandLine",
                "value": [
                  "/Online",
                  "/Disable-Feature"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_dism": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\Dism.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/Online",
                  "/Disable-Feature"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-16",
        "modified": "2022-08-26",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md#atomic-test-26---disable-windows-defender-with-dism",
          "https://www.trendmicro.com/en_us/research/22/h/ransomware-actor-abuses-genshin-impact-anti-cheat-driver-to-kill-antivirus.html"
        ],
        "falsepositives": [
          "Legitimate script"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_dism_remove.yml"
      }
    },
    {
      "id": "bed2a484-9348-4143-8a8a-b801c979301c",
      "title": "Webshell Detection With Command Line Keywords",
      "status": "test",
      "description": "Detects certain command line parameters often used during reconnaissance activity via web shells",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.discovery",
        "attack.t1505.003",
        "attack.t1018",
        "attack.t1033",
        "attack.t1087"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_webserver_image": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\w3wp.exe",
                  "\\php-cgi.exe",
                  "\\nginx.exe",
                  "\\httpd.exe",
                  "\\caddy.exe",
                  "\\ws_tomcatservice.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_webserver_characteristics_tomcat1": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\java.exe",
                  "\\javaw.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "ParentImage__contains": {
                "field": "ParentImage",
                "value": [
                  "-tomcat-",
                  "\\tomcat"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_webserver_characteristics_tomcat2": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\java.exe",
                  "\\javaw.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "catalina.jar",
                  "CATALINA_HOME"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_susp_net_utility": {
            "type": "field_match",
            "matchers": {
              "OriginalFileName": {
                "field": "OriginalFileName",
                "value": [
                  "net.exe",
                  "net1.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " user ",
                  " use ",
                  " group "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_susp_ping_utility": {
            "type": "field_match",
            "matchers": {
              "OriginalFileName": {
                "field": "OriginalFileName",
                "value": "ping.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -n ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_susp_change_dir": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "&cd&echo",
                  "cd /d "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_susp_wmic_utility": {
            "type": "field_match",
            "matchers": {
              "OriginalFileName": {
                "field": "OriginalFileName",
                "value": "wmic.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " /node:",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_susp_powershell_cli": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\cmd.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -enc ",
                  " -EncodedCommand ",
                  " -w hidden ",
                  " -windowstyle hidden",
                  ".WebClient).Download"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_susp_misc_discovery_binaries": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\dsquery.exe",
                      "\\find.exe",
                      "\\findstr.exe",
                      "\\ipconfig.exe",
                      "\\netstat.exe",
                      "\\nslookup.exe",
                      "\\pathping.exe",
                      "\\quser.exe",
                      "\\schtasks.exe",
                      "\\systeminfo.exe",
                      "\\tasklist.exe",
                      "\\tracert.exe",
                      "\\ver.exe",
                      "\\wevtutil.exe",
                      "\\whoami.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "dsquery.exe",
                      "find.exe",
                      "findstr.exe",
                      "ipconfig.exe",
                      "netstat.exe",
                      "nslookup.exe",
                      "pathping.exe",
                      "quser.exe",
                      "schtasks.exe",
                      "sysinfo.exe",
                      "tasklist.exe",
                      "tracert.exe",
                      "ver.exe",
                      "VSSADMIN.EXE",
                      "wevtutil.exe",
                      "whoami.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_susp_misc_discovery_commands": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " Test-NetConnection ",
                  "dir \\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_webserver_* and 1 of selection_susp_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "1 of selection_webserver_*"
            },
            {
              "type": "ref",
              "value": "1 of selection_susp_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1505.003",
          "T1018",
          "T1033",
          "T1087"
        ],
        "tactics": [
          "persistence",
          "discovery"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Jonhnathan Ribeiro, Anton Kutepov, oscd.community, Chad Hudson, Matt Anderson",
        "date": "2017-01-01",
        "modified": "2024-12-14",
        "references": [
          "https://www.fireeye.com/blog/threat-research/2013/08/breaking-down-the-china-chopper-web-shell-part-ii.html",
          "https://unit42.paloaltonetworks.com/bumblebee-webshell-xhunt-campaign/",
          "https://www.huntress.com/blog/threat-advisory-oh-no-cleo-cleo-software-actively-being-exploited-in-the-wild"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_webshell_recon_commands_and_processes.yml"
      }
    },
    {
      "id": "0649be4a-aeb0-45b0-b89e-7f1668f6d9c0",
      "title": "IIS WebServer Log Deletion via CommandLine Utilities",
      "status": "experimental",
      "description": "Detects attempts to delete Internet Information Services (IIS) log files via command line utilities, which is a common defense evasion technique used by attackers to cover their tracks.\nThreat actors often abuse vulnerabilities in web applications hosted on IIS servers to gain initial access and later delete IIS logs to evade detection.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1070"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\cmd.exe",
                      "\\powershell_ise.exe",
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "cmd.exe",
                      "powershell.exe",
                      "powershell_ise.exe",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_del": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "del ",
                  "erase ",
                  "rm ",
                  "remove-item ",
                  "rmdir "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_iis_dir": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "\\inetpub\\logs\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1070"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-09-02",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/iis/manage/provisioning-and-managing-iis/managing-iis-log-file-storage"
        ],
        "falsepositives": [
          "Deletion of IIS logs that are older than a certain retention period as part of regular maintenance activities.",
          "Legitimate schedule tasks or scripts that clean up log files regularly."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_iis_logs_deletion.yml"
      }
    },
    {
      "id": "40aa399c-7b02-4715-8e5f-73572b493f33",
      "title": "Suspicious File Download From IP Via Wget.EXE - Paths",
      "status": "test",
      "description": "Detects potentially suspicious file downloads directly from IP addresses and stored in suspicious locations using Wget.exe",
      "level": "high",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\wget.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "wget.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_ip": {
            "type": "field_match",
            "matchers": {
              "CommandLine__re": {
                "field": "CommandLine",
                "value": "://[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}",
                "modifiers": [
                  "re"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_http": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "http",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_flag": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__re": {
                    "field": "CommandLine",
                    "value": "\\s-O\\s",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": "--output-document",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_paths": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      ":\\PerfLogs\\",
                      ":\\Temp\\",
                      ":\\Users\\Public\\",
                      ":\\Windows\\Help\\",
                      ":\\Windows\\Temp\\",
                      "\\Temporary Internet"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      ":\\Users\\",
                      "\\Favorites\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      ":\\Users\\",
                      "\\Favourites\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      ":\\Users\\",
                      "\\Contacts\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      ":\\Users\\",
                      "\\Pictures\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2024-02-23",
        "modified": "",
        "references": [
          "https://www.gnu.org/software/wget/manual/wget.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wget_download_susp_locations.yml"
      }
    },
    {
      "id": "7679d464-4f74-45e2-9e01-ac66c5eb041a",
      "title": "HackTool - SecurityXploded Execution",
      "status": "stable",
      "description": "Detects the execution of SecurityXploded Tools",
      "level": "critical",
      "tags": [
        "attack.credential-access",
        "attack.t1555"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Company": {
                    "field": "Company",
                    "value": "SecurityXploded",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "PasswordDump.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName__endswith": {
                    "field": "OriginalFileName",
                    "value": "PasswordDump.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1555"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2018-12-19",
        "modified": "2023-02-04",
        "references": [
          "https://securityxploded.com/",
          "https://web.archive.org/web/20200601000524/https://cyberx-labs.com/blog/gangnam-industrial-style-apt-campaign-targets-korean-industrial-companies/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_secutyxploded.yml"
      }
    },
    {
      "id": "835e75bf-4bfd-47a4-b8a6-b766cac8bcb7",
      "title": "Uncommon Child Process Of Setres.EXE",
      "status": "test",
      "description": "Detects uncommon child process of Setres.EXE.\nSetres.EXE is a Windows server only process and tool that can be used to set the screen resolution.\nIt can potentially be abused in order to launch any arbitrary file with a name containing the word \"choice\" from the current execution path.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218",
        "attack.t1202"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\setres.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__contains": {
                "field": "Image",
                "value": "\\choice",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_legit_location": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "C:\\Windows\\System32\\choice.exe",
                  "C:\\Windows\\SysWOW64\\choice.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218",
          "T1202"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "@gott_cyber, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-12-11",
        "modified": "2024-06-26",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Setres/",
          "https://twitter.com/0gtweet/status/1583356502340870144",
          "https://strontic.github.io/xcyclopedia/library/setres.exe-0E30E4C09637D7A128A37B59A3BC4D09.html",
          "https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc731033(v=ws.11)"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_setres_uncommon_child_process.yml"
      }
    },
    {
      "id": "ffa6861c-4461-4f59-8a41-578c39f3f23e",
      "title": "LSASS Dump Keyword In CommandLine",
      "status": "test",
      "description": "Detects the presence of the keywords \"lsass\" and \".dmp\" in the commandline, which could indicate a potential attempt to dump or create a dump of the lsass process.\n",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      "lsass.dmp",
                      "lsass.zip",
                      "lsass.rar",
                      "Andrew.dmp",
                      "Coredump.dmp",
                      "NotLSASS.zip",
                      "lsass_2",
                      "lsassdump",
                      "lsassdmp"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "lsass",
                      ".dmp"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "SQLDmpr",
                      ".mdmp"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "nanodump",
                      ".dmp"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.001"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "E.M. Anhaus, Tony Lambert, oscd.community, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2019-10-24",
        "modified": "2023-08-29",
        "references": [
          "https://github.com/Hackndo/lsassy",
          "https://medium.com/@markmotig/some-ways-to-dump-lsass-exe-c4a75fdc49bf",
          "https://github.com/elastic/detection-rules/blob/c76a39796972ecde44cb1da6df47f1b6562c9770/rules/windows/credential_access_lsass_memdump_file_created.toml",
          "https://www.whiteoaksecurity.com/blog/attacks-defenses-dumping-lsass-no-mimikatz/",
          "https://github.com/helpsystems/nanodump",
          "https://github.com/CCob/MirrorDump"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_lsass_dmp_cli_keywords.yml"
      }
    },
    {
      "id": "aa0b3a82-eacc-4ec3-9150-b5a9a3e3f82f",
      "title": "Potential Download/Upload Activity Using Type Command",
      "status": "test",
      "description": "Detects usage of the \"type\" command to download/upload data from WebDAV server",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1105"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_upload": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "type ",
                  " > \\\\\\\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_download": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "type \\\\\\\\",
                  " > "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1105"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-12-14",
        "modified": "",
        "references": [
          "https://mr0range.com/a-new-lolbin-using-the-windows-type-command-to-upload-download-files-81d7b6179e22"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_cmd_type_arbitrary_file_download.yml"
      }
    },
    {
      "id": "a31eeaed-3fd5-478e-a8ba-e62c6b3f9ecc",
      "title": "Raccine Uninstall",
      "status": "test",
      "description": "Detects commands that indicate a Raccine removal from an end system. Raccine is a free ransomware protection tool.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "taskkill ",
                  "RaccineSettings.exe"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "reg.exe",
                  "delete",
                  "Raccine Tray"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection3": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "schtasks",
                  "/DELETE",
                  "Raccine Rules Updater"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-01-21",
        "modified": "2022-10-09",
        "references": [
          "https://github.com/Neo23x0/Raccine"
        ],
        "falsepositives": [
          "Legitimate deinstallation by administrative staff"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_disable_raccine.yml"
      }
    },
    {
      "id": "ec1d5e28-8f3b-4188-a6f8-6e8df81dc28e",
      "title": "WMI Persistence - Script Event Consumer",
      "status": "test",
      "description": "Detects WMI script event consumers",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.privilege-escalation",
        "attack.t1546.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\WINDOWS\\system32\\wbem\\scrcons.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ParentImage": {
                "field": "ParentImage",
                "value": "C:\\Windows\\System32\\svchost.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1546.003"
        ],
        "tactics": [
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Thomas Patzke",
        "date": "2018-03-07",
        "modified": "2022-10-11",
        "references": [
          "https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/"
        ],
        "falsepositives": [
          "Legitimate event consumers",
          "Dell computers on some versions register an event consumer that is known to cause false positives when brightness is changed by the corresponding keyboard button"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wmi_persistence_script_event_consumer.yml"
      }
    },
    {
      "id": "1193d960-2369-499f-a158-7b50a31df682",
      "title": "Potential Suspicious Browser Launch From Document Reader Process",
      "status": "test",
      "description": "Detects when a browser process or browser tab is launched from an application that handles document files such as Adobe, Microsoft Office, etc. And connects to a web application over http(s), this could indicate a possible phishing attempt.\n",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1204.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__contains": {
                "field": "ParentImage",
                "value": [
                  "Acrobat Reader",
                  "Microsoft Office",
                  "PDF Reader"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\brave.exe",
                  "\\chrome.exe",
                  "\\firefox.exe",
                  "\\msedge.exe",
                  "\\opera.exe",
                  "\\maxthon.exe",
                  "\\seamonkey.exe",
                  "\\vivaldi.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "http",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_microsoft_help": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "https://go.microsoft.com/fwlink/",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_foxit": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "http://ad.foxitsoftware.com/adlog.php?",
                  "https://globe-map.foxitservice.com/go.php?do=redirect"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1204.002"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Joseph Kamau",
        "date": "2024-05-27",
        "modified": "2025-10-07",
        "references": [
          "https://app.any.run/tasks/69c5abaa-92ad-45ba-8c53-c11e23e05d04/",
          "https://app.any.run/tasks/64043a79-165f-4052-bcba-e6e49f847ec1/"
        ],
        "falsepositives": [
          "Unlikely in most cases, further investigation should be done in the commandline of the browser process to determine the context of the URL accessed."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_browser_launch_from_document_reader_process.yml"
      }
    },
    {
      "id": "327f48c1-a6db-4eb8-875a-f6981f1b0183",
      "title": "Port Forwarding Activity Via SSH.EXE",
      "status": "test",
      "description": "Detects port forwarding activity via SSH.exe",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.lateral-movement",
        "attack.t1572",
        "attack.t1021.001",
        "attack.t1021.004"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\ssh.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -R ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1572",
          "T1021.001",
          "T1021.004"
        ],
        "tactics": [
          "command_and_control",
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-10-12",
        "modified": "2024-03-05",
        "references": [
          "https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/"
        ],
        "falsepositives": [
          "Administrative activity using a remote port forwarding to a local port"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_ssh_port_forward.yml"
      }
    },
    {
      "id": "75f7a0e2-7154-4c4d-9eae-5cdb4e0a5c13",
      "title": "Write Protect For Storage Disabled",
      "status": "test",
      "description": "Detects applications trying to modify the registry in order to disable any write-protect property for storage devices.\nThis could be a precursor to a ransomware attack and has been an observed technique used by cypherpunk group.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "\\System\\CurrentControlSet\\Control",
                  "Write Protection",
                  "0",
                  "storage"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Sreeman",
        "date": "2021-06-11",
        "modified": "2024-01-18",
        "references": [
          "https://www.manageengine.com/products/desktop-central/os-imaging-deployment/media-is-write-protected.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_reg_write_protect_for_storage_disabled.yml"
      }
    },
    {
      "id": "9465ddf4-f9e4-4ebd-8d98-702df3a93239",
      "title": "IIS Native-Code Module Command Line Installation",
      "status": "test",
      "description": "Detects suspicious IIS native-code module installations via command line",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.t1505.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\appcmd.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "appcmd.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "install",
                  "module"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-name:",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_iis_setup": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": "C:\\Windows\\System32\\inetsrv\\iissetup.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_"
        }
      },
      "mitre": {
        "techniques": [
          "T1505.003"
        ],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2019-12-11",
        "modified": "2024-03-13",
        "references": [
          "https://researchcenter.paloaltonetworks.com/2018/01/unit42-oilrig-uses-rgdoor-iis-backdoor-targets-middle-east/",
          "https://www.microsoft.com/security/blog/2022/07/26/malicious-iis-extensions-quietly-open-persistent-backdoors-into-servers/"
        ],
        "falsepositives": [
          "Unknown as it may vary from organisation to organisation how admins use to install IIS modules"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_iis_appcmd_susp_module_install.yml"
      }
    },
    {
      "id": "104cdb48-a7a8-4ca7-a453-32942c6e5dcb",
      "title": "File Download Using ProtocolHandler.exe",
      "status": "test",
      "description": "Detects usage of \"ProtocolHandler\" to download files. Downloaded files will be located in the cache folder (for example - %LOCALAPPDATA%\\Microsoft\\Windows\\INetCache\\IE)\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\protocolhandler.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "ProtocolHandler.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "ftp://",
                  "http://",
                  "https://"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-07-13",
        "modified": "2023-11-09",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1218/T1218.md",
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/ProtocolHandler/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_protocolhandler_download.yml"
      }
    },
    {
      "id": "4b60e6f2-bf39-47b4-b4ea-398e33cfe253",
      "title": "CMSTP UAC Bypass via COM Object Access",
      "status": "stable",
      "description": "Detects UAC Bypass Attempt Using Microsoft Connection Manager Profile Installer Autoelevate-capable COM Objects (e.g. UACMe ID of 41, 43, 58 or 65)",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548.002",
        "attack.t1218.003",
        "attack.g0069",
        "car.2019-04-001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\DllHost.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "ParentCommandLine__contains": {
                "field": "ParentCommandLine",
                "value": [
                  " /Processid:{3E5FC7F9-9A51-4367-9063-A120244FBEC7}",
                  " /Processid:{3E000D72-A845-4CD9-BD83-80C07C3B881F}",
                  " /Processid:{BD54C901-076B-434E-B6C7-17C531F4AB41}",
                  " /Processid:{D2E7041B-2927-42FB-8E9F-7CE93B6DC937}",
                  " /Processid:{E9495B87-D950-4AB5-87A5-FF6D70BF3E90}"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "IntegrityLevel": {
                "field": "IntegrityLevel",
                "value": [
                  "High",
                  "System",
                  "S-1-16-16384",
                  "S-1-16-12288"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002",
          "T1218.003"
        ],
        "tactics": [
          "execution",
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Nik Seetharaman, Christian Burkard (Nextron Systems)",
        "date": "2019-07-31",
        "modified": "2024-12-01",
        "references": [
          "https://web.archive.org/web/20190720093911/http://www.endurant.io/cmstp/detecting-cmstp-enabled-code-execution-and-uac-bypass-with-sysmon/",
          "https://twitter.com/hFireF0X/status/897640081053364225",
          "https://medium.com/falconforce/falconfriday-detecting-uac-bypasses-0xff16-86c2a9107abf",
          "https://github.com/hfiref0x/UACME"
        ],
        "falsepositives": [
          "Legitimate CMSTP use (unlikely in modern enterprise environments)"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_uac_bypass_cmstp_com_object_access.yml"
      }
    },
    {
      "id": "34275eb8-fa19-436b-b959-3d9ecd53fa1f",
      "title": "Loaded Module Enumeration Via Tasklist.EXE",
      "status": "test",
      "description": "Detects the enumeration of a specific DLL or EXE being used by a binary via \"tasklist.exe\".\nThis is often used by attackers in order to find the specific process identifier (PID) that is using the DLL in question.\nIn order to dump the process memory or perform other nefarious actions.\n",
      "level": "medium",
      "tags": [
        "attack.t1003",
        "attack.credential-access"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\tasklist.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "tasklist.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_flags": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-m",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_module": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "rdpcorets.dll",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1003"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel",
        "date": "2024-02-12",
        "modified": "2024-03-13",
        "references": [
          "https://www.n00py.io/2021/05/dumping-plaintext-rdp-credentials-from-svchost-exe/",
          "https://pentestlab.blog/tag/svchost/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_tasklist_module_enumeration.yml"
      }
    },
    {
      "id": "0fc35fc3-efe6-4898-8a37-0b233339524f",
      "title": "Suspicious ScreenSave Change by Reg.exe",
      "status": "test",
      "description": "Adversaries may establish persistence by executing malicious content triggered by user inactivity.\nScreensavers are programs that execute after a configurable time of user inactivity and consist of Portable Executable (PE) files with a .scr file extension\n",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.privilege-escalation",
        "attack.t1546.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_reg": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\reg.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "HKEY_CURRENT_USER\\Control Panel\\Desktop",
                  "HKCU\\Control Panel\\Desktop"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_option_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/v ScreenSaveActive",
                  "/t REG_SZ",
                  "/d 1",
                  "/f"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_option_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/v ScreenSaveTimeout",
                  "/t REG_SZ",
                  "/d ",
                  "/f"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_option_3": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/v ScreenSaverIsSecure",
                  "/t REG_SZ",
                  "/d 0",
                  "/f"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_option_4": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/v SCRNSAVE.EXE",
                  "/t REG_SZ",
                  "/d ",
                  ".scr",
                  "/f"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_reg and 1 of selection_option_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_reg"
            },
            {
              "type": "ref",
              "value": "1 of selection_option_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1546.002"
        ],
        "tactics": [
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-08-19",
        "modified": "2022-06-02",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1546.002/T1546.002.md",
          "https://www.welivesecurity.com/wp-content/uploads/2017/08/eset-gazer.pdf"
        ],
        "falsepositives": [
          "GPO"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_reg_screensaver.yml"
      }
    },
    {
      "id": "fc0e89b5-adb0-43c1-b749-c12a10ec37de",
      "title": "SafeBoot Registry Key Deleted Via Reg.EXE",
      "status": "test",
      "description": "Detects execution of \"reg.exe\" commands with the \"delete\" flag on safe boot registry keys. Often used by attacker to prevent safeboot execution of security products",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "reg.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "reg.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_delete": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " delete ",
                  "\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), Tim Shelton",
        "date": "2022-08-08",
        "modified": "2023-02-04",
        "references": [
          "https://www.trendmicro.com/en_us/research/22/e/avoslocker-ransomware-variant-abuses-driver-file-to-disable-anti-Virus-scans-log4shell.html"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_reg_delete_safeboot.yml"
      }
    },
    {
      "id": "2267fe65-0681-42ad-9a6d-46553d3f3480",
      "title": "WSL Child Process Anomaly",
      "status": "test",
      "description": "Detects uncommon or suspicious child processes spawning from a WSL process. This could indicate an attempt to evade parent/child relationship detections or persistence attempts via cron using WSL",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.defense-evasion",
        "attack.t1218",
        "attack.t1202"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\wsl.exe",
                  "\\wslhost.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_children_images": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\calc.exe",
                  "\\cmd.exe",
                  "\\cscript.exe",
                  "\\mshta.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\regsvr32.exe",
                  "\\rundll32.exe",
                  "\\wscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_children_paths": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  "\\AppData\\Local\\Temp\\",
                  "C:\\Users\\Public\\",
                  "C:\\Windows\\Temp\\",
                  "C:\\Temp\\",
                  "\\Downloads\\",
                  "\\Desktop\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_parent and 1 of selection_children_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_parent"
            },
            {
              "type": "ref",
              "value": "1 of selection_children_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218",
          "T1202"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-01-23",
        "modified": "2023-08-15",
        "references": [
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Wsl/",
          "https://twitter.com/nas_bench/status/1535431474429808642"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wsl_child_processes_anomalies.yml"
      }
    },
    {
      "id": "92a974db-ab84-457f-9ec0-55db83d7a825",
      "title": "Potential AMSI Bypass Using NULL Bits",
      "status": "test",
      "description": "Detects usage of special strings/null bits in order to potentially bypass AMSI functionalities",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "if(0){{{0}}}' -f $(0 -as [char]) +",
                  "#<NULL>"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-01-04",
        "modified": "2023-05-09",
        "references": [
          "https://github.com/r00t-3xp10it/hacking-material-books/blob/43cb1e1932c16ff1f58b755bc9ab6b096046853f/obfuscation/simple_obfuscation.md#amsi-bypass-using-null-bits-satoshi"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_amsi_null_bits_bypass.yml"
      }
    },
    {
      "id": "fa00b701-44c6-4679-994d-5a18afa8a707",
      "title": "PUA - AdvancedRun Suspicious Execution",
      "status": "test",
      "description": "Detects the execution of AdvancedRun utility in the context of the TrustedInstaller, SYSTEM, Local Service or Network Service accounts",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1134.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "/EXEFilename",
                  "/CommandLine"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_runas": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      " /RunAs 8 ",
                      " /RunAs 4 ",
                      " /RunAs 10 ",
                      " /RunAs 11 "
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__endswith": {
                    "field": "CommandLine",
                    "value": [
                      "/RunAs 8",
                      "/RunAs 4",
                      "/RunAs 10",
                      "/RunAs 11"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1134.002"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-01-20",
        "modified": "2023-02-21",
        "references": [
          "https://twitter.com/splinter_code/status/1483815103279603714",
          "https://medium.com/s2wblog/analysis-of-destructive-malware-whispergate-targeting-ukraine-9d5d158f19f3",
          "https://www.elastic.co/security-labs/operation-bleeding-bear",
          "https://www.winhelponline.com/blog/run-program-as-system-localsystem-account-windows/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_advancedrun_priv_user.yml"
      }
    },
    {
      "id": "0403d67d-6227-4ea8-8145-4e72db7da120",
      "title": "UtilityFunctions.ps1 Proxy Dll",
      "status": "test",
      "description": "Detects the use of a Microsoft signed script executing a managed DLL with PowerShell.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1216"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "UtilityFunctions.ps1",
                  "RegSnapin "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1216"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-05-28",
        "modified": "",
        "references": [
          "https://lolbas-project.github.io/lolbas/Scripts/UtilityFunctions/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_utilityfunctions.yml"
      }
    },
    {
      "id": "88872991-7445-4a22-90b2-a3adadb0e827",
      "title": "Stop Windows Service Via Net.EXE",
      "status": "test",
      "description": "Detects the stopping of a Windows service via the \"net\" utility.",
      "level": "low",
      "tags": [
        "attack.impact",
        "attack.t1489"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "net.exe",
                      "net1.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\net.exe",
                      "\\net1.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " stop ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1489"
        ],
        "tactics": [
          "impact"
        ]
      },
      "meta": {
        "author": "Jakob Weinzettl, oscd.community, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-03-05",
        "modified": "",
        "references": [
          "https://ss64.com/nt/net-service.html"
        ],
        "falsepositives": [
          "There are many legitimate reasons to stop a service. This rule isn't looking for any suspicious behaviour in particular. Filter legitimate activity accordingly"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_net_stop_service.yml"
      }
    },
    {
      "id": "f44800ac-38ec-471f-936e-3fa7d9c53100",
      "title": "PUA - CleanWipe Execution",
      "status": "test",
      "description": "Detects the use of CleanWipe a tool usually used to delete Symantec antivirus.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection1": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\SepRemovalToolNative_x64.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection2": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\CATClean.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "--uninstall",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection3": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\NetInstaller.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-r",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection4": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\WFPUnins.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/uninstall",
                  "/enterprise"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2021-12-18",
        "modified": "2023-02-14",
        "references": [
          "https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Other/CleanWipe"
        ],
        "falsepositives": [
          "Legitimate administrative use (Should be investigated either way)"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_cleanwipe.yml"
      }
    },
    {
      "id": "53d4bb30-3f36-4e8a-b078-69d36c4a79ff",
      "title": "COM Object Execution via Xwizard.EXE",
      "status": "test",
      "description": "Detects the execution of Xwizard tool with the \"RunWizard\" flag and a GUID like argument.\nThis utility can be abused in order to run custom COM object created in the registry.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine": {
                "field": "CommandLine",
                "value": "RunWizard",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "CommandLine__re": {
                "field": "CommandLine",
                "value": "\\{[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}\\}",
                "modifiers": [
                  "re"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Ensar Şamil, @sblmsrsn, @oscd_initiative, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2020-10-07",
        "modified": "2024-08-15",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Xwizard/",
          "https://www.elastic.co/guide/en/security/current/execution-of-com-object-via-xwizard.html",
          "https://www.hexacorn.com/blog/2017/07/31/the-wizard-of-x-oppa-plugx-style/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_xwizard_runwizard_com_object_exec.yml"
      }
    },
    {
      "id": "814c95cc-8192-4378-a70a-f1aafd877af1",
      "title": "Use of OpenConsole",
      "status": "test",
      "description": "Detects usage of OpenConsole binary as a LOLBIN to launch other binaries to bypass application Whitelisting",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "OpenConsole.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\OpenConsole.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Program Files\\WindowsApps\\Microsoft.WindowsTerminal",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1059"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-06-16",
        "modified": "",
        "references": [
          "https://twitter.com/nas_bench/status/1537563834478645252"
        ],
        "falsepositives": [
          "Legitimate use by an administrator"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_openconsole.yml"
      }
    },
    {
      "id": "be344333-921d-4c4d-8bb8-e584cf584780",
      "title": "Potentially Suspicious Event Viewer Child Process",
      "status": "test",
      "description": "Detects uncommon or suspicious child processes of \"eventvwr.exe\" which might indicate a UAC bypass attempt",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548.002",
        "car.2019-04-001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\eventvwr.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_generic": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  ":\\Windows\\System32\\mmc.exe",
                  ":\\Windows\\System32\\WerFault.exe",
                  ":\\Windows\\SysWOW64\\WerFault.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2017-03-19",
        "modified": "2023-09-28",
        "references": [
          "https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/",
          "https://www.hybrid-analysis.com/sample/e122bc8bf291f15cab182a5d2d27b8db1e7019e4e96bb5cdbd1dfe7446f3f51f?environmentId=100"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_eventvwr_susp_child_process.yml"
      }
    },
    {
      "id": "f17211f1-1f24-4d0c-829f-31e28dc93cdd",
      "title": "Uncommon Svchost Command Line Parameter",
      "status": "experimental",
      "description": "Detects instances of svchost.exe running with an unusual or uncommon command line parameter by excluding known legitimate or common patterns.\nThis could point at a file masquerading as svchost, a process injection, or hollowing of a legitimate svchost instance.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1036.005",
        "attack.t1055",
        "attack.t1055.012"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\svchost.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_flags": {
            "type": "field_match",
            "matchers": {
              "CommandLine__re": {
                "field": "CommandLine",
                "value": "-k\\s\\w{1,64}(\\s?(-p|-s))?",
                "modifiers": [
                  "re"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_empty": {
            "type": "field_match",
            "matchers": {
              "CommandLine": {
                "field": "CommandLine",
                "value": "",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_null": {
            "type": "field_match",
            "matchers": {
              "CommandLine": {
                "field": "CommandLine",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_defender": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\MsMpEng.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "svchost.exe",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_mrt": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\MRT.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine": {
                "field": "CommandLine",
                "value": "svchost.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1036.005",
          "T1055",
          "T1055.012"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Liran Ravich",
        "date": "2025-11-14",
        "modified": "",
        "references": [
          "https://cardinalops.com/blog/the-art-of-anomaly-hunting-patterns-detection/",
          "https://www.security.com/threat-intelligence/blackbyte-exbyte-ransomware",
          "https://cloud.google.com/blog/topics/threat-intelligence/apt41-initiates-global-intrusion-campaign-using-multiple-exploits/",
          "https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/08064518/Carbanak_APT_eng.pdf"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_svchost_uncommon_command_line_flags.yml"
      }
    },
    {
      "id": "f99abdf0-6283-4e71-bd2b-b5c048a94743",
      "title": "Potentially Suspicious Office Document Executed From Trusted Location",
      "status": "test",
      "description": "Detects the execution of an Office application that points to a document that is located in a trusted location. Attackers often used this to avoid macro security and execute their malicious code.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1202"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\explorer.exe",
                  "\\dopus.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\EXCEL.EXE",
                      "\\POWERPNT.EXE",
                      "\\WINWORD.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "Excel.exe",
                      "POWERPNT.EXE",
                      "WinWord.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_trusted_location": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\AppData\\Roaming\\Microsoft\\Templates",
                  "\\AppData\\Roaming\\Microsoft\\Word\\Startup\\",
                  "\\Microsoft Office\\root\\Templates\\",
                  "\\Microsoft Office\\Templates\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_dotx": {
            "type": "field_match",
            "matchers": {
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": [
                  ".dotx",
                  ".xltx",
                  ".potx"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_main_"
        }
      },
      "mitre": {
        "techniques": [
          "T1202"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-06-21",
        "modified": "2023-10-18",
        "references": [
          "Internal Research",
          "https://twitter.com/Max_Mal_/status/1633863678909874176",
          "https://techcommunity.microsoft.com/t5/microsoft-365-blog/new-security-hardening-policies-for-trusted-documents/ba-p/3023465",
          "https://twitter.com/_JohnHammond/status/1588155401752788994"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_office_exec_from_trusted_locations.yml"
      }
    },
    {
      "id": "eca49c87-8a75-4f13-9c73-a5a29e845f03",
      "title": "Suspicious Runscripthelper.exe",
      "status": "test",
      "description": "Detects execution of powershell scripts via Runscripthelper.exe",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059",
        "attack.defense-evasion",
        "attack.t1202"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\Runscripthelper.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "surfacecheck",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059",
          "T1202"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Victor Sergeev, oscd.community",
        "date": "2020-10-09",
        "modified": "2022-07-11",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Runscripthelper/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_runscripthelper.yml"
      }
    },
    {
      "id": "4ede543c-e098-43d9-a28f-dd784a13132f",
      "title": "WinRAR Execution in Non-Standard Folder",
      "status": "test",
      "description": "Detects a suspicious WinRAR execution in a folder which is not the default installation folder",
      "level": "medium",
      "tags": [
        "attack.collection",
        "attack.t1560.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\rar.exe",
                      "\\winrar.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": [
                      "Command line RAR",
                      "WinRAR"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_main_unrar": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\UnRAR.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_path": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  ":\\Program Files (x86)\\WinRAR\\",
                  ":\\Program Files\\WinRAR\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_temp": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": ":\\Windows\\Temp\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1560.001"
        ],
        "tactics": [
          "collection"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Tigzy",
        "date": "2021-11-17",
        "modified": "2025-07-16",
        "references": [
          "https://twitter.com/cyb3rops/status/1460978167628406785"
        ],
        "falsepositives": [
          "Legitimate use of WinRAR in a folder of a software that bundles WinRAR"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_winrar_uncommon_folder_execution.yml"
      }
    },
    {
      "id": "42a993dd-bb3e-48c8-b372-4d6684c4106c",
      "title": "HackTool - CrackMapExec Execution",
      "status": "test",
      "description": "This rule detect common flag combinations used by CrackMapExec in order to detect its use even if the binary has been replaced.",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.persistence",
        "attack.privilege-escalation",
        "attack.credential-access",
        "attack.discovery",
        "attack.t1047",
        "attack.t1053",
        "attack.t1059.003",
        "attack.t1059.001",
        "attack.t1110",
        "attack.t1201"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_binary": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\crackmapexec.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_special": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -M pe_inject ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_execute": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " --local-auth",
                  " -u ",
                  " -x "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_hash": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " --local-auth",
                  " -u ",
                  " -p ",
                  " -H 'NTHASH'"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_module_mssql": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " mssql ",
                  " -u ",
                  " -p ",
                  " -M ",
                  " -d "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_module_smb1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " smb ",
                  " -u ",
                  " -H ",
                  " -M ",
                  " -o "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_module_smb2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " smb ",
                  " -u ",
                  " -p ",
                  " --local-auth"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "part_localauth_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " --local-auth",
                  " -u ",
                  " -p "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "part_localauth_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " 10.",
                  " 192.168.",
                  "/24 "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_* or all of part_localauth*",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "1 of selection_*",
            "all of part_localauth*"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1047",
          "T1053",
          "T1059.003",
          "T1059.001",
          "T1110",
          "T1201"
        ],
        "tactics": [
          "execution",
          "persistence",
          "privilege_escalation",
          "credential_access",
          "discovery"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-02-25",
        "modified": "2023-03-08",
        "references": [
          "https://mpgn.gitbook.io/crackmapexec/smb-protocol/authentication/checking-credentials-local",
          "https://www.mandiant.com/resources/telegram-malware-iranian-espionage",
          "https://www.infosecmatter.com/crackmapexec-module-library/?cmem=mssql-mimikatz",
          "https://www.infosecmatter.com/crackmapexec-module-library/?cmem=smb-pe_inject"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_crackmapexec_execution.yml"
      }
    },
    {
      "id": "12f6b752-042d-483e-bf9c-915a6d06ad75",
      "title": "Windows Firewall Disabled via PowerShell",
      "status": "test",
      "description": "Detects attempts to disable the Windows Firewall using PowerShell",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_name": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell.exe",
                      "\\pwsh.exe",
                      "\\powershell_ise.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_args": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "Set-NetFirewallProfile ",
                  " -Enabled ",
                  " False"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_opt": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -All ",
                  "Public",
                  "Domain",
                  "Private"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1562"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Tim Rauch, Elastic (idea)",
        "date": "2022-09-14",
        "modified": "2023-02-13",
        "references": [
          "https://www.elastic.co/guide/en/security/current/windows-firewall-disabled-via-powershell.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_disable_firewall.yml"
      }
    },
    {
      "id": "f91ed517-a6ba-471d-9910-b3b4a398c0f3",
      "title": "Potentially Suspicious Windows App Activity",
      "status": "test",
      "description": "Detects potentially suspicious child process of applications launched from inside the WindowsApps directory. This could be a sign of a rogue \".appx\" package installation/execution",
      "level": "medium",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__contains": {
                "field": "ParentImage",
                "value": "C:\\Program Files\\WindowsApps\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_susp_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\cmd.exe",
                  "\\cscript.exe",
                  "\\mshta.exe",
                  "\\powershell.exe",
                  "\\powershell_ise.exe",
                  "\\pwsh.exe",
                  "\\regsvr32.exe",
                  "\\rundll32.exe",
                  "\\wscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_susp_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "cmd /c",
                  "Invoke-",
                  "Base64"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_terminal": {
            "type": "field_match",
            "matchers": {
              "ParentImage__contains": {
                "field": "ParentImage",
                "value": ":\\Program Files\\WindowsApps\\Microsoft.WindowsTerminal",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\WindowsTerminal.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\powershell.exe",
                  "\\cmd.exe",
                  "\\pwsh.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_sysinternals": {
            "type": "field_match",
            "matchers": {
              "ParentImage__startswith": {
                "field": "ParentImage",
                "value": "C:\\Program Files\\WindowsApps\\Microsoft.SysinternalsSuite",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\cmd.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection_parent and 1 of selection_susp_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_parent"
            },
            {
              "type": "ref",
              "value": "1 of selection_susp_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-01-12",
        "modified": "2025-10-07",
        "references": [
          "https://news.sophos.com/en-us/2021/11/11/bazarloader-call-me-back-attack-abuses-windows-10-apps-mechanism/",
          "https://www.sentinelone.com/labs/inside-malicious-windows-apps-for-malware-deployment/"
        ],
        "falsepositives": [
          "Legitimate packages that make use of external binaries such as Windows Terminal"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_appx_execution.yml"
      }
    },
    {
      "id": "88f46b67-14d4-4f45-ac2c-d66984f22191",
      "title": "Renamed Microsoft Teams Execution",
      "status": "test",
      "description": "Detects the execution of a renamed Microsoft Teams binary.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "OriginalFileName": {
                "field": "OriginalFileName",
                "value": [
                  "msteams.exe",
                  "teams.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_legit_names": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\msteams.exe",
                  "\\teams.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2024-07-12",
        "modified": "",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_renamed_msteams.yml"
      }
    },
    {
      "id": "241e802a-b65e-484f-88cd-c2dc10f9206d",
      "title": "Read Contents From Stdin Via Cmd.EXE",
      "status": "test",
      "description": "Detect the use of \"<\" to read and potentially execute a file via cmd.exe",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_cmd": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "Cmd.Exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\cmd.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "<",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.003"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-03-07",
        "modified": "",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1059.003/T1059.003.md",
          "https://web.archive.org/web/20220306121156/https://www.x86matthew.com/view_post?id=ntdll_pipe"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_cmd_stdin_redirect.yml"
      }
    },
    {
      "id": "caf201a9-c2ce-4a26-9c3a-2b9525413711",
      "title": "Potentially Suspicious Call To Win32_NTEventlogFile Class",
      "status": "test",
      "description": "Detects usage of the WMI class \"Win32_NTEventlogFile\" in a potentially suspicious way (delete, backup, change permissions, etc.) from a PowerShell script",
      "level": "high",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_class": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "Win32_NTEventlogFile",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_function": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ".BackupEventlog(",
                  ".ChangeSecurityPermissions(",
                  ".ChangeSecurityPermissionsEx(",
                  ".ClearEventLog(",
                  ".Delete(",
                  ".DeleteEx(",
                  ".Rename(",
                  ".TakeOwnerShip(",
                  ".TakeOwnerShipEx("
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-07-13",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/previous-versions/windows/desktop/legacy/aa394225(v=vs.85)"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_nteventlogfile_usage.yml"
      }
    },
    {
      "id": "cc36992a-4671-4f21-a91d-6c2b72a2edf5",
      "title": "Suspicious Eventlog Clearing or Configuration Change Activity",
      "status": "stable",
      "description": "Detects the clearing or configuration tampering of EventLog using utilities such as \"wevtutil\", \"powershell\" and \"wmic\".\nThis technique were seen used by threat actors and ransomware strains in order to evade defenses.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1070.001",
        "attack.t1562.002",
        "car.2016-04-002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_wevtutil_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\wevtutil.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "wevtutil.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_wevtutil_cmd": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "clear-log ",
                  " cl ",
                  "set-log ",
                  " sl ",
                  "lfn:"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_other_ps_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\powershell.exe",
                  "\\powershell_ise.exe",
                  "\\pwsh.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_other_ps_cmd": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      "Clear-EventLog ",
                      "Remove-EventLog ",
                      "Limit-EventLog ",
                      "Clear-WinEvent "
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "Eventing.Reader.EventLogSession",
                      "ClearLog"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "Diagnostics.EventLog",
                      "Clear"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_other_wmi": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\powershell.exe",
                  "\\powershell_ise.exe",
                  "\\pwsh.exe",
                  "\\wmic.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "ClearEventLog",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_msiexec": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": [
                  "C:\\Windows\\SysWOW64\\msiexec.exe",
                  "C:\\Windows\\System32\\msiexec.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " sl ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "(all of selection_wevtutil_*) or (all of selection_other_ps_*) or (selection_other_wmi) and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "(all of selection_wevtutil_*)",
            "(all of selection_other_ps_*)",
            "(selection_other_wmi) and not 1 of filter_main_*"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1070.001",
          "T1562.002"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Ecco, Daniil Yugoslavskiy, oscd.community, D3F7A5105, Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2019-09-26",
        "modified": "2025-03-12",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.001/T1070.001.md",
          "https://eqllib.readthedocs.io/en/latest/analytics/5b223758-07d6-4100-9e11-238cfdd0fe97.html",
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wevtutil",
          "https://gist.github.com/fovtran/ac0624983c7722e80a8f5a4babb170ee",
          "https://jdhnet.wordpress.com/2017/12/19/changing-the-location-of-the-windows-event-logs/",
          "https://www.linkedin.com/posts/huntress-labs_when-a-sketchy-incident-hits-your-network-activity-7304940371078238208-Th_l/?utm_source=share&utm_medium=member_desktop&rcm=ACoAAAJTlRcB28IaUtg03HUU-IdliwzoAL1flGc",
          "https://stackoverflow.com/questions/66011412/how-to-clear-a-event-log-in-powershell-7",
          "https://learn.microsoft.com/en-us/dotnet/api/system.diagnostics.eventing.reader.eventlogsession.clearlog?view=windowsdesktop-9.0&viewFallbackFrom=dotnet-plat-ext-5.0#System_Diagnostics_Eventing_Reader_EventLogSession_ClearLog_System_String_",
          "https://learn.microsoft.com/en-us/dotnet/api/system.diagnostics.eventlog.clear"
        ],
        "falsepositives": [
          "Admin activity",
          "Scripts and administrative tools used in the monitored environment",
          "Maintenance activity"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_eventlog_clear.yml"
      }
    },
    {
      "id": "bd1c6866-65fc-44b2-be51-5588fcff82b9",
      "title": "Renamed Msdt.EXE Execution",
      "status": "test",
      "description": "Detects the execution of a renamed \"Msdt.exe\" binary",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "OriginalFileName": {
                "field": "OriginalFileName",
                "value": "msdt.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\msdt.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1036.003"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "pH-T (Nextron Systems)",
        "date": "2022-06-03",
        "modified": "2023-02-03",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Msdt/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_renamed_msdt.yml"
      }
    },
    {
      "id": "9b0b7ac3-6223-47aa-a3fd-e8f211e637db",
      "title": "Changing Existing Service ImagePath Value Via Reg.EXE",
      "status": "test",
      "description": "Adversaries may execute their own malicious payloads by hijacking the Registry entries used by services.\nAdversaries may use flaws in the permissions for registry to redirect from the originally specified executable to one that they control, in order to launch their own code at Service start.\nWindows stores local service configuration information in the Registry under HKLM\\SYSTEM\\CurrentControlSet\\Services\n",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.defense-evasion",
        "attack.persistence",
        "attack.t1574.011"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\reg.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "add ",
                  "SYSTEM\\CurrentControlSet\\Services\\",
                  " ImagePath "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_value": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -d ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1574.011"
        ],
        "tactics": [
          "privilege_escalation",
          "defense_evasion",
          "persistence"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-12-30",
        "modified": "2024-03-13",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1574.011/T1574.011.md#atomic-test-2---service-imagepath-change-with-regexe"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_reg_service_imagepath_change.yml"
      }
    },
    {
      "id": "15bd98ea-55f4-4d37-b09a-e7caa0fa2221",
      "title": "Rundll32 InstallScreenSaver Execution",
      "status": "test",
      "description": "An attacker may execute an application as a SCR File using rundll32.exe desk.cpl,InstallScreenSaver",
      "level": "medium",
      "tags": [
        "attack.t1218.011",
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\rundll32.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "RUNDLL32.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "InstallScreenSaver",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.011"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Christopher Peacock @securepeacock, SCYTHE @scythe_io, TactiKoolSec",
        "date": "2022-04-28",
        "modified": "2023-02-09",
        "references": [
          "https://lolbas-project.github.io/lolbas/Libraries/Desk/",
          "https://github.com/redcanaryco/atomic-red-team/blob/0f229c0e42bfe7ca736a14023836d65baa941ed2/atomics/T1218.011/T1218.011.md#atomic-test-13---rundll32-with-deskcpl"
        ],
        "falsepositives": [
          "Legitimate installation of a new screensaver"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_rundll32_installscreensaver.yml"
      }
    },
    {
      "id": "45239e6a-b035-4aaf-b339-8ad379fcb67e",
      "title": "Process Proxy Execution Via Squirrel.EXE",
      "status": "test",
      "description": "Detects the usage of the \"Squirrel.exe\" binary to execute arbitrary processes. This binary is part of multiple Electron based software installations (Slack, Teams, Discord, etc.)\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.execution",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\squirrel.exe",
                  "\\update.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_exec": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "--processStart",
                  "--processStartAndWait",
                  "--createShortcut"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_discord": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  ":\\Users\\",
                  "\\AppData\\Local\\Discord\\Update.exe",
                  "Discord.exe"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "--createShortcut",
                  "--processStart"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_github_desktop": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  ":\\Users\\",
                  "\\AppData\\Local\\GitHubDesktop\\Update.exe",
                  "GitHubDesktop.exe"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "--createShortcut",
                  "--processStartAndWait"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_teams": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  ":\\Users\\",
                  "\\AppData\\Local\\Microsoft\\Teams\\Update.exe",
                  "Teams.exe"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "--processStart",
                  "--createShortcut"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_yammer": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  ":\\Users\\",
                  "\\AppData\\Local\\yammerdesktop\\Update.exe",
                  "Yammer.exe"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "--processStart",
                  "--createShortcut"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_optional_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), Karneades / Markus Neis, Jonhnathan Ribeiro, oscd.community",
        "date": "2022-06-09",
        "modified": "2025-10-07",
        "references": [
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Squirrel/",
          "http://www.hexacorn.com/blog/2019/03/30/sqirrel-packages-manager-as-a-lolbin-a-k-a-many-electron-apps-are-lolbins-by-default/",
          "http://www.hexacorn.com/blog/2018/08/16/squirrel-as-a-lolbin/"
        ],
        "falsepositives": [
          "Expected FP with some Electron based applications such as (1Clipboard, Beaker Browser, Caret, Discord, GitHub Desktop, etc.)"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_squirrel_proxy_execution.yml"
      }
    },
    {
      "id": "66c3b204-9f88-4d0a-a7f7-8a57d521ca55",
      "title": "Potential Crypto Mining Activity",
      "status": "stable",
      "description": "Detects command line parameters or strings often used by crypto miners",
      "level": "high",
      "tags": [
        "attack.impact",
        "attack.t1496"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " --cpu-priority=",
                  "--donate-level=0",
                  " -o pool.",
                  " --nicehash",
                  " --algo=rx/0 ",
                  "stratum+tcp://",
                  "stratum+udp://",
                  "LS1kb25hdGUtbGV2ZWw9",
                  "0tZG9uYXRlLWxldmVsP",
                  "tLWRvbmF0ZS1sZXZlbD",
                  "c3RyYXR1bSt0Y3A6Ly",
                  "N0cmF0dW0rdGNwOi8v",
                  "zdHJhdHVtK3RjcDovL",
                  "c3RyYXR1bSt1ZHA6Ly",
                  "N0cmF0dW0rdWRwOi8v",
                  "zdHJhdHVtK3VkcDovL"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " pool.c ",
                  " pool.o ",
                  "gcc -"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1496"
        ],
        "tactics": [
          "impact"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-10-26",
        "modified": "2023-02-13",
        "references": [
          "https://www.poolwatch.io/coin/monero"
        ],
        "falsepositives": [
          "Legitimate use of crypto miners",
          "Some build frameworks"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_crypto_mining_monero.yml"
      }
    },
    {
      "id": "b57ba453-b384-4ab9-9f40-1038086b4e53",
      "title": "VeeamBackup Database Credentials Dump Via Sqlcmd.EXE",
      "status": "test",
      "description": "Detects dump of credentials in VeeamBackup dbo",
      "level": "high",
      "tags": [
        "attack.collection",
        "attack.t1005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_tools": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\sqlcmd.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_query": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "SELECT",
                  "TOP",
                  "[VeeamBackup].[dbo].[Credentials]"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1005"
        ],
        "tactics": [
          "collection"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-12-20",
        "modified": "2023-02-13",
        "references": [
          "https://thedfirreport.com/2021/12/13/diavol-ransomware/",
          "https://forums.veeam.com/veeam-backup-replication-f2/recover-esxi-password-in-veeam-t34630.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sqlcmd_veeam_dump.yml"
      }
    },
    {
      "id": "eee00933-a761-4cd0-be70-c42fe91731e7",
      "title": "Arbitrary File Download Via GfxDownloadWrapper.EXE",
      "status": "test",
      "description": "Detects execution of GfxDownloadWrapper.exe with a URL as an argument to download file.",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1105"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\GfxDownloadWrapper.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "http://",
                  "https://"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_known_urls": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "https://gameplayapi.intel.com/",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1105"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Victor Sergeev, oscd.community",
        "date": "2020-10-09",
        "modified": "2023-10-18",
        "references": [
          "https://lolbas-project.github.io/lolbas/HonorableMentions/GfxDownloadWrapper/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_gfxdownloadwrapper_arbitrary_file_download.yml"
      }
    },
    {
      "id": "fb9d3ff7-7348-46ab-af8c-b55f5fbf39b4",
      "title": "Execution of Powershell Script in Public Folder",
      "status": "test",
      "description": "This rule detects execution of PowerShell scripts located in the \"C:\\Users\\Public\" folder",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\powershell.exe",
                  "\\pwsh.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "-f C:\\Users\\Public",
                  "-f \"C:\\Users\\Public",
                  "-f %Public%",
                  "-fi C:\\Users\\Public",
                  "-fi \"C:\\Users\\Public",
                  "-fi %Public%",
                  "-fil C:\\Users\\Public",
                  "-fil \"C:\\Users\\Public",
                  "-fil %Public%",
                  "-file C:\\Users\\Public",
                  "-file \"C:\\Users\\Public",
                  "-file %Public%"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Max Altgelt (Nextron Systems)",
        "date": "2022-04-06",
        "modified": "2022-07-14",
        "references": [
          "https://www.mandiant.com/resources/evolution-of-fin7"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_public_folder.yml"
      }
    },
    {
      "id": "0944e002-e3f6-4eb5-bf69-3a3067b53d73",
      "title": "PowerShell Set-Acl On Windows Folder",
      "status": "test",
      "description": "Detects PowerShell scripts to set the ACL to a file in the Windows folder",
      "level": "high",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cmdlet": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "Set-Acl ",
                  "-AclObject "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_paths": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "-Path \"C:\\Windows",
                  "-Path 'C:\\Windows",
                  "-Path %windir%",
                  "-Path $env:windir"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_permissions": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "FullControl",
                  "Allow"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-10-18",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.security/set-acl?view=powershell-5.1",
          "https://github.com/redcanaryco/atomic-red-team/blob/74438b0237d141ee9c99747976447dc884cb1a39/atomics/T1505.005/T1505.005.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_set_acl_susp_location.yml"
      }
    },
    {
      "id": "ef61af62-bc74-4f58-b49b-626448227652",
      "title": "Suspicious Active Directory Database Snapshot Via ADExplorer",
      "status": "test",
      "description": "Detects the execution of Sysinternals ADExplorer with the \"-snapshot\" flag in order to save a local copy of the active directory database to a suspicious directory. This can be used by attackers to extract data for Bloodhound, usernames for password spraying or use the meta data for social engineering. The snapshot doesn't contain password hashes but there have been cases, where administrators put passwords in the comment field.",
      "level": "high",
      "tags": [
        "attack.discovery",
        "attack.t1087.002",
        "attack.t1069.002",
        "attack.t1482"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\ADExp.exe",
                      "\\ADExplorer.exe",
                      "\\ADExplorer64.exe",
                      "\\ADExplorer64a.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "AdExp",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "Active Directory Editor",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Product": {
                    "field": "Product",
                    "value": "Sysinternals ADExplorer",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_flag": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "snapshot",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_paths": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\Downloads\\",
                  "\\Users\\Public\\",
                  "\\AppData\\",
                  "\\Windows\\Temp\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1087.002",
          "T1069.002",
          "T1482"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-03-14",
        "modified": "2025-07-09",
        "references": [
          "https://www.documentcloud.org/documents/5743766-Global-Threat-Report-2019.html",
          "https://learn.microsoft.com/de-de/sysinternals/downloads/adexplorer",
          "https://github.com/c3c/ADExplorerSnapshot.py/tree/f700904defac330802bbfedd1d8ffd9248f4ee24",
          "https://www.packetlabs.net/posts/scattered-spider-is-a-young-ransomware-gang-exploiting-large-corporations/",
          "https://www.nccgroup.com/us/research-blog/lapsus-recent-techniques-tactics-and-procedures/",
          "https://trustedsec.com/blog/adexplorer-on-engagements"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sysinternals_adexplorer_susp_execution.yml"
      }
    },
    {
      "id": "e568650b-5dcd-4658-8f34-ded0b1e13992",
      "title": "Potential Product Class Reconnaissance Via Wmic.EXE",
      "status": "test",
      "description": "Detects the execution of WMIC in order to get a list of firewall, antivirus and antispywware products.\nAdversaries often enumerate security products installed on a system to identify security controls and potential ways to evade detection or disable protection mechanisms.\nThis information helps them plan their next attack steps and choose appropriate techniques to bypass security measures.\n",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1047",
        "attack.discovery",
        "attack.t1082"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\wmic.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "wmic.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "AntiVirusProduct",
                  "AntiSpywareProduct",
                  "FirewallProduct"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1047",
          "T1082"
        ],
        "tactics": [
          "execution",
          "discovery"
        ]
      },
      "meta": {
        "author": "Michael Haag, Florian Roth (Nextron Systems), juju4, oscd.community, Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2023-02-14",
        "modified": "2025-03-17",
        "references": [
          "https://github.com/albertzsigovits/malware-notes/blob/c820c7fea76cf76a861b28ebc77e06100e20ec29/Ransomware/Maze.md",
          "https://www.hybrid-analysis.com/sample/4be06ecd234e2110bd615649fe4a6fa95403979acf889d7e45a78985eb50acf9?environmentId=1",
          "https://www.trendmicro.com/en_us/research/25/c/socgholishs-intrusion-techniques-facilitate-distribution-of-rans.html"
        ],
        "falsepositives": [
          "Legitimate use of wmic.exe for reconnaissance of firewall, antivirus and antispywware products."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wmic_recon_product_class.yml"
      }
    },
    {
      "id": "d937b75f-a665-4480-88a5-2f20e9f9b22a",
      "title": "Possible Privilege Escalation via Weak Service Permissions",
      "status": "test",
      "description": "Detection of sc.exe utility spawning by user with Medium integrity level to change service ImagePath or FailureCommand",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1574.011"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "scbynonadmin": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\sc.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "IntegrityLevel": {
                "field": "IntegrityLevel",
                "value": [
                  "Medium",
                  "S-1-16-8192"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_binpath": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "config",
                  "binPath"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_failure": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "failure",
                  "command"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "scbynonadmin and 1 of selection_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "scbynonadmin"
            },
            {
              "type": "ref",
              "value": "1 of selection_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1574.011"
        ],
        "tactics": [
          "persistence",
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Teymur Kheirkhabarov",
        "date": "2019-10-26",
        "modified": "2024-12-01",
        "references": [
          "https://speakerdeck.com/heirhabarov/hunting-for-privilege-escalation-in-windows-environment",
          "https://pentestlab.blog/2017/03/30/weak-service-permissions/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sc_change_sevice_image_path_by_non_admin.yml"
      }
    },
    {
      "id": "4abc0ec4-db5a-412f-9632-26659cddf145",
      "title": "UEFI Persistence Via Wpbbin - ProcessCreation",
      "status": "test",
      "description": "Detects execution of the binary \"wpbbin\" which is used as part of the UEFI based persistence method described in the reference section",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1542.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\System32\\wpbbin.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1542.001"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-07-18",
        "modified": "",
        "references": [
          "https://grzegorztworek.medium.com/using-uefi-to-inject-executable-files-into-bitlocker-protected-drives-8ff4ca59c94c",
          "https://persistence-info.github.io/Data/wpbbin.html"
        ],
        "falsepositives": [
          "Legitimate usage of the file by hardware manufacturer such as lenovo (Thanks @0gtweet for the tip)"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wpbbin_potential_persistence.yml"
      }
    },
    {
      "id": "f14e169e-9978-4c69-acb3-1cff8200bc36",
      "title": "Suspicious GrpConv Execution",
      "status": "test",
      "description": "Detects the suspicious execution of a utility to convert Windows 3.x .grp files or for persistence purposes by malicious software or actors",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "grpconv.exe -o",
                  "grpconv -o"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1547"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-05-19",
        "modified": "",
        "references": [
          "https://twitter.com/0gtweet/status/1526833181831200770"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_susp_grpconv.yml"
      }
    },
    {
      "id": "213d6a77-3d55-4ce8-ba74-fcfef741974e",
      "title": "Private Keys Reconnaissance Via CommandLine Tools",
      "status": "test",
      "description": "Adversaries may search for private key certificate files on compromised systems for insecurely stored credential",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.t1552.004"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_cmd_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\cmd.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "Cmd.Exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cmd_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "dir ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_pwsh_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_pwsh_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "Get-ChildItem ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_findstr": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\findstr.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "FINDSTR.EXE",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_ext": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ".key",
                  ".pgp",
                  ".gpg",
                  ".ppk",
                  ".p12",
                  ".pem",
                  ".pfx",
                  ".cer",
                  ".p7b",
                  ".asc"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_ext and (all of selection_cmd_* or all of selection_pwsh_* or selection_findstr)",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection_ext and (all of selection_cmd_*",
            "all of selection_pwsh_*",
            "selection_findstr)"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1552.004"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2021-07-20",
        "modified": "2023-03-06",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1552.004/T1552.004.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_private_keys_recon.yml"
      }
    },
    {
      "id": "ab70c354-d9ac-4e11-bbb6-ec8e3b153357",
      "title": "Remote Access Tool - Team Viewer Session Started On Windows Host",
      "status": "test",
      "description": "Detects the command line executed when TeamViewer starts a session started by a remote host.\nOnce a connection has been started, an investigator can verify the connection details by viewing the \"incoming_connections.txt\" log file in the TeamViewer folder.\n",
      "level": "low",
      "tags": [
        "attack.persistence",
        "attack.initial-access",
        "attack.t1133"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "TeamViewer_Desktop.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ParentImage": {
                "field": "ParentImage",
                "value": "TeamViewer_Service.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": "TeamViewer_Desktop.exe --IPCport 5939 --Module 1",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1133"
        ],
        "tactics": [
          "persistence",
          "initial_access"
        ]
      },
      "meta": {
        "author": "Josh Nickels, Qi Nan",
        "date": "2024-03-11",
        "modified": "",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Legitimate usage of TeamViewer"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_remote_access_tools_teamviewer_incoming_connection.yml"
      }
    },
    {
      "id": "6812a10b-60ea-420c-832f-dfcc33b646ba",
      "title": "Potential PowerShell Execution Via DLL",
      "status": "test",
      "description": "Detects potential PowerShell execution from a DLL instead of the usual PowerShell process as seen used in PowerShdll.\nThis detection assumes that PowerShell commands are passed via the CommandLine.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.011"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\InstallUtil.exe",
                      "\\RegAsm.exe",
                      "\\RegSvcs.exe",
                      "\\regsvr32.exe",
                      "\\rundll32.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "InstallUtil.exe",
                      "RegAsm.exe",
                      "RegSvcs.exe",
                      "REGSVR32.EXE",
                      "RUNDLL32.EXE"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Default.GetString",
                  "DownloadString",
                  "FromBase64String",
                  "ICM ",
                  "IEX ",
                  "Invoke-Command",
                  "Invoke-Expression"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.011"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Markus Neis, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2018-08-25",
        "modified": "2024-03-07",
        "references": [
          "https://github.com/p3nt4/PowerShdll/blob/62cfa172fb4e1f7f4ac00ca942685baeb88ff356/README.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_powershell_execution_via_dll.yml"
      }
    },
    {
      "id": "a85ffc3a-e8fd-4040-93bf-78aff284d801",
      "title": "Use Of The SFTP.EXE Binary As A LOLBIN",
      "status": "test",
      "description": "Detects the usage of the \"sftp.exe\" binary as a LOLBIN by abusing the \"-D\" flag",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.execution",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\sftp.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -D ..",
                  " -D C:\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-11-10",
        "modified": "",
        "references": [
          "https://github.com/LOLBAS-Project/LOLBAS/pull/264"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_sftp.yml"
      }
    },
    {
      "id": "12b8e9f5-96b2-41e1-9a42-8c6779a5c184",
      "title": "Potentially Suspicious Execution Of PDQDeployRunner",
      "status": "test",
      "description": "Detects suspicious execution of \"PDQDeployRunner\" which is part of the PDQDeploy service stack that is responsible for executing commands and packages on a remote machines",
      "level": "medium",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__contains": {
                "field": "ParentImage",
                "value": "\\PDQDeployRunner-",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_child": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\bash.exe",
                      "\\certutil.exe",
                      "\\cmd.exe",
                      "\\csc.exe",
                      "\\cscript.exe",
                      "\\dllhost.exe",
                      "\\mshta.exe",
                      "\\msiexec.exe",
                      "\\regsvr32.exe",
                      "\\rundll32.exe",
                      "\\scriptrunner.exe",
                      "\\wmic.exe",
                      "\\wscript.exe",
                      "\\wsl.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__contains": {
                    "field": "Image",
                    "value": [
                      ":\\ProgramData\\",
                      ":\\Users\\Public\\",
                      ":\\Windows\\TEMP\\",
                      "\\AppData\\Local\\Temp"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": [
                      " -decode ",
                      " -enc ",
                      " -encodedcommand ",
                      " -w hidden",
                      "DownloadString",
                      "FromBase64String",
                      "http",
                      "iex ",
                      "Invoke-"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-07-22",
        "modified": "2024-05-02",
        "references": [
          "https://twitter.com/malmoeb/status/1550483085472432128"
        ],
        "falsepositives": [
          "Legitimate use of the PDQDeploy tool to execute these commands"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pdqdeploy_runner_susp_children.yml"
      }
    },
    {
      "id": "59e938ff-0d6d-4dc3-b13f-36cc28734d4e",
      "title": "Execute Code with Pester.bat",
      "status": "test",
      "description": "Detects code execution via Pester.bat (Pester - Powershell Modulte for testing)",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059.001",
        "attack.defense-evasion",
        "attack.t1216"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "powershell_module": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\powershell.exe",
                  "\\pwsh.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "Pester",
                  "Get-Help"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "cmd_execution": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\cmd.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "pester",
                  ";"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "get_help": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "help",
                  "\\?"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "powershell_module or (cmd_execution and get_help)",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "powershell_module",
            "(cmd_execution and get_help)"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001",
          "T1216"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Julia Fomina, oscd.community",
        "date": "2020-10-08",
        "modified": "2023-11-09",
        "references": [
          "https://twitter.com/Oddvarmoe/status/993383596244258816",
          "https://github.com/api0cradle/LOLBAS/blob/d148d278f5f205ce67cfaf49afdfb68071c7252a/OSScripts/pester.md"
        ],
        "falsepositives": [
          "Legitimate use of Pester for writing tests for Powershell scripts and modules"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_pester_1.yml"
      }
    },
    {
      "id": "37651c2a-42cd-4a69-ae0d-22a4349aa04a",
      "title": "Unsigned AppX Installation Attempt Using Add-AppxPackage",
      "status": "test",
      "description": "Detects usage of the \"Add-AppxPackage\" or it's alias \"Add-AppPackage\" to install unsigned AppX packages",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cmdlet": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Add-AppPackage ",
                  "Add-AppxPackage "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_flag": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -AllowUnsigned",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-01-31",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/windows/msix/package/unsigned-package",
          "https://twitter.com/WindowsDocs/status/1620078135080325122"
        ],
        "falsepositives": [
          "Installation of unsigned packages for testing purposes"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_install_unsigned_appx_packages.yml"
      }
    },
    {
      "id": "6c96fc76-0eb1-11eb-adc1-0242ac120002",
      "title": "Invoke-Obfuscation STDIN+ Launcher",
      "status": "test",
      "description": "Detects Obfuscated use of stdin to execute PowerShell",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027",
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__re": {
                "field": "CommandLine",
                "value": "cmd.{0,5}(?:/c|/r).+powershell.+(?:\\$\\{?input\\}?|noexit).+\\\"",
                "modifiers": [
                  "re"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1027",
          "T1059.001"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Jonathan Cheong, oscd.community",
        "date": "2020-10-15",
        "modified": "2024-04-15",
        "references": [
          "https://github.com/SigmaHQ/sigma/issues/1009"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_invoke_obfuscation_stdin.yml"
      }
    },
    {
      "id": "dcff7e85-d01f-4eb5-badd-84e2e6be8294",
      "title": "Windows Default Domain GPO Modification via GPME",
      "status": "experimental",
      "description": "Detects the use of the Group Policy Management Editor (GPME) to modify Default Domain or Default Domain Controllers Group Policy Objects (GPOs).\nAdversaries may leverage GPME to make stealthy changes in these default GPOs to deploy malicious GPOs configurations across the domain without raising suspicion.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1484.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_mmc": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\mmc.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "MMC.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_gpme": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "gpme.msc",
                  "gpobject:"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_default_gpos": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "31B2F340-016D-11D2-945F-00C04FB984F9",
                  "6AC1786C-016F-11D2-945F-00C04FB984F9"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1484.001"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "TropChaud",
        "date": "2025-11-22",
        "modified": "",
        "references": [
          "https://www.trendmicro.com/en_us/research/25/i/unmasking-the-gentlemen-ransomware.html",
          "https://adsecurity.org/?p=3377",
          "https://sdmsoftware.com/general-stuff/launching-the-new-gp-management-editor-from-the-command-line/",
          "https://www.pentestpartners.com/security-blog/living-off-the-land-gpo-style/"
        ],
        "falsepositives": [
          "Legitimate use of GPME to modify GPOs"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_mmc_default_domain_gpo_modification_via_gpme.yml"
      }
    },
    {
      "id": "0bbc6369-43e3-453d-9944-cae58821c173",
      "title": "Execution via WorkFolders.exe",
      "status": "test",
      "description": "Detects using WorkFolders.exe to execute an arbitrary control.exe",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\control.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\WorkFolders.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\System32\\control.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Maxime Thiebaut (@0xThiebaut)",
        "date": "2021-10-21",
        "modified": "2022-12-25",
        "references": [
          "https://twitter.com/elliotkillick/status/1449812843772227588"
        ],
        "falsepositives": [
          "Legitimate usage of the uncommon Windows Work Folders feature."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_workfolders.yml"
      }
    },
    {
      "id": "4aa6040b-3f28-44e3-a769-9208e5feb5ec",
      "title": "Suspicious Rundll32 Execution With Image Extension",
      "status": "test",
      "description": "Detects the execution of Rundll32.exe with DLL files masquerading as image files",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.011"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\rundll32.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "RUNDLL32.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ".bmp",
                  ".cr2",
                  ".eps",
                  ".gif",
                  ".ico",
                  ".jpeg",
                  ".jpg",
                  ".nef",
                  ".orf",
                  ".png",
                  ".raw",
                  ".sr2",
                  ".tif",
                  ".tiff"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.011"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Hieu Tran",
        "date": "2023-03-13",
        "modified": "",
        "references": [
          "https://www.zscaler.com/blogs/security-research/onenote-growing-threat-malware-distribution"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_rundll32_susp_execution_with_image_extension.yml"
      }
    },
    {
      "id": "1d174d38-8fda-4081-a9b6-56d9763c0cd8",
      "title": "Scheduled Task Creation with Curl and PowerShell Execution Combo",
      "status": "experimental",
      "description": "Detects the creation of a scheduled task using schtasks.exe, potentially in combination with curl for downloading payloads and PowerShell for executing them.\nThis facilitates executing malicious payloads or connecting with C&C server persistently without dropping the malware sample on the host.\n",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.execution",
        "attack.persistence",
        "attack.t1053.005",
        "attack.defense-evasion",
        "attack.t1218",
        "attack.command-and-control",
        "attack.t1105"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\schtasks.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " /create ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_curl": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "curl ",
                  "http",
                  "-o"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_powershell": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "powershell",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1053.005",
          "T1218",
          "T1105"
        ],
        "tactics": [
          "privilege_escalation",
          "execution",
          "persistence",
          "defense_evasion",
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-02-05",
        "modified": "",
        "references": [
          "https://tria.ge/241015-l98snsyeje/behavioral2"
        ],
        "falsepositives": [
          "Legitimate use of schtasks for administrative purposes.",
          "Automation scripts combining curl and PowerShell in controlled environments."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_schtasks_curl_and_powershell_combo.yml"
      }
    },
    {
      "id": "47e4bab7-c626-47dc-967b-255608c9a920",
      "title": "Permission Misconfiguration Reconnaissance Via Findstr.EXE",
      "status": "test",
      "description": "Detects usage of findstr with the \"EVERYONE\" or \"BUILTIN\" keywords.\nThis was seen being used in combination with \"icacls\" and other utilities to spot misconfigured files or folders permissions.\n",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.t1552.006"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_findstr_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\find.exe",
                      "\\findstr.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "FIND.EXE",
                      "FINDSTR.EXE"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_findstr_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\"Everyone\"",
                  "'Everyone'",
                  "\"BUILTIN\\\\\"",
                  "'BUILTIN\\'"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_special": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "icacls ",
                  "findstr ",
                  "Everyone"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_findstr_* or selection_special",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "all of selection_findstr_*",
            "selection_special"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1552.006"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-12",
        "modified": "2023-11-11",
        "references": [
          "https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_findstr_recon_everyone.yml"
      }
    },
    {
      "id": "d679950c-abb7-43a6-80fb-2a480c4fc450",
      "title": "PDQ Deploy Remote Adminstartion Tool Execution",
      "status": "test",
      "description": "Detect use of PDQ Deploy remote admin tool",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.lateral-movement",
        "attack.t1072"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "PDQ Deploy Console",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Product": {
                    "field": "Product",
                    "value": "PDQ Deploy",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Company": {
                    "field": "Company",
                    "value": "PDQ.com",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "PDQDeployConsole.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1072"
        ],
        "tactics": [
          "execution",
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-10-01",
        "modified": "2023-01-30",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/9e5b12c4912c07562aec7500447b11fa3e17e254/atomics/T1072/T1072.md",
          "https://www.pdq.com/pdq-deploy/"
        ],
        "falsepositives": [
          "Legitimate use"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pdqdeploy_execution.yml"
      }
    },
    {
      "id": "a0459f02-ac51-4c09-b511-b8c9203fc429",
      "title": "Potential Process Execution Proxy Via CL_Invocation.ps1",
      "status": "test",
      "description": "Detects calls to \"SyncInvoke\" that is part of the \"CL_Invocation.ps1\" script to proxy execution using \"System.Diagnostics.Process\"",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1216"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "SyncInvoke ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1216"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), oscd.community, Natalia Shornikova",
        "date": "2020-10-14",
        "modified": "2023-08-17",
        "references": [
          "https://lolbas-project.github.io/lolbas/Scripts/Cl_invocation/",
          "https://twitter.com/bohops/status/948061991012327424"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_cl_invocation.yml"
      }
    },
    {
      "id": "8202070f-edeb-4d31-a010-a26c72ac5600",
      "title": "Suspicious Process By Web Server Process",
      "status": "test",
      "description": "Detects potentially suspicious processes being spawned by a web server process which could be the result of a successfully placed web shell or exploitation\n",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.initial-access",
        "attack.t1505.003",
        "attack.t1190"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_webserver_image": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\caddy.exe",
                  "\\httpd.exe",
                  "\\nginx.exe",
                  "\\php-cgi.exe",
                  "\\php.exe",
                  "\\tomcat.exe",
                  "\\UMWorkerProcess.exe",
                  "\\w3wp.exe",
                  "\\ws_TomcatService.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_webserver_characteristics_tomcat1": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\java.exe",
                  "\\javaw.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "ParentImage__contains": {
                "field": "ParentImage",
                "value": [
                  "-tomcat-",
                  "\\tomcat"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_webserver_characteristics_tomcat2": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\java.exe",
                  "\\javaw.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "ParentCommandLine__contains": {
                "field": "ParentCommandLine",
                "value": [
                  "CATALINA_HOME",
                  "catalina.home",
                  "catalina.jar"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_anomaly_children": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\arp.exe",
                  "\\at.exe",
                  "\\bash.exe",
                  "\\bitsadmin.exe",
                  "\\certutil.exe",
                  "\\cmd.exe",
                  "\\cscript.exe",
                  "\\dsget.exe",
                  "\\hostname.exe",
                  "\\nbtstat.exe",
                  "\\net.exe",
                  "\\net1.exe",
                  "\\netdom.exe",
                  "\\netsh.exe",
                  "\\nltest.exe",
                  "\\ntdsutil.exe",
                  "\\powershell_ise.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\qprocess.exe",
                  "\\query.exe",
                  "\\qwinsta.exe",
                  "\\reg.exe",
                  "\\rundll32.exe",
                  "\\sc.exe",
                  "\\sh.exe",
                  "\\wmic.exe",
                  "\\wscript.exe",
                  "\\wusa.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_fp_1": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\java.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": "Windows\\system32\\cmd.exe /c C:\\ManageEngine\\ADManager \"Plus\\ES\\bin\\elasticsearch.bat -Enode.name=RMP-NODE1 -pelasticsearch-pid.txt",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_fp_2": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\java.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "sc query",
                  "ADManager Plus"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "1 of selection_webserver_* and selection_anomaly_children and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "1 of selection_webserver_*"
            },
            {
              "type": "ref",
              "value": "selection_anomaly_children"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1505.003",
          "T1190"
        ],
        "tactics": [
          "persistence",
          "initial_access"
        ]
      },
      "meta": {
        "author": "Thomas Patzke, Florian Roth (Nextron Systems), Zach Stanford @svch0st, Tim Shelton, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2019-01-16",
        "modified": "2024-11-26",
        "references": [
          "https://media.defense.gov/2020/Jun/09/2002313081/-1/-1/0/CSI-DETECT-AND-PREVENT-WEB-SHELL-MALWARE-20200422.PDF"
        ],
        "falsepositives": [
          "Particular web applications may spawn a shell process legitimately"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_webshell_susp_process_spawned_from_webserver.yml"
      }
    },
    {
      "id": "c7746f1c-47d3-43d6-8c45-cd1e54b6b0a2",
      "title": "Kernel Memory Dump Via LiveKD",
      "status": "test",
      "description": "Detects execution of LiveKD with the \"-m\" flag to potentially dump the kernel memory",
      "level": "high",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\livekd.exe",
                      "\\livekd64.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "livekd.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -m",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-16",
        "modified": "2024-03-13",
        "references": [
          "https://learn.microsoft.com/en-us/sysinternals/downloads/livekd",
          "https://4sysops.com/archives/creating-a-complete-memory-dump-without-a-blue-screen/",
          "https://kb.acronis.com/content/60892"
        ],
        "falsepositives": [
          "Unlikely in production environment"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sysinternals_livekd_kernel_memory_dump.yml"
      }
    },
    {
      "id": "b2815d0d-7481-4bf0-9b6c-a4c48a94b349",
      "title": "PowerShell Get-Process LSASS",
      "status": "test",
      "description": "Detects a \"Get-Process\" cmdlet and it's aliases on lsass process, which is in almost all cases a sign of malicious activity",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1552.004"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Get-Process lsas",
                  "ps lsas",
                  "gps lsas"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1552.004"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-04-23",
        "modified": "2023-01-05",
        "references": [
          "https://web.archive.org/web/20220205033028/https://twitter.com/PythonResponder/status/1385064506049630211"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_getprocess_lsass.yml"
      }
    },
    {
      "id": "e0b0c2ab-3d52-46d9-8cb7-049dc775fbd1",
      "title": "Enumeration for Credentials in Registry",
      "status": "test",
      "description": "Adversaries may search the Registry on compromised systems for insecurely stored credentials.\nThe Windows Registry stores configuration information that can be used by the system or other programs.\nAdversaries may query the Registry looking for credentials and passwords that have been stored for use by other programs or services\n",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.t1552.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "reg": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\reg.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " query ",
                  "/t ",
                  "REG_SZ",
                  "/s"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "hive": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "/f ",
                      "HKLM"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "/f ",
                      "HKCU"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": "HKCU\\Software\\SimonTatham\\PuTTY\\Sessions",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "reg and hive",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "reg"
            },
            {
              "type": "ref",
              "value": "hive"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1552.002"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-12-20",
        "modified": "2022-12-25",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1552.002/T1552.002.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_reg_enumeration_for_credentials_in_registry.yml"
      }
    },
    {
      "id": "aef9d1f1-7396-4e92-a927-4567c7a495c1",
      "title": "Suspicious Git Clone",
      "status": "test",
      "description": "Detects execution of \"git\" in order to clone a remote repository that contain suspicious keywords which might be suspicious",
      "level": "medium",
      "tags": [
        "attack.reconnaissance",
        "attack.t1593.003"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\git.exe",
                      "\\git-remote-https.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "git.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " clone ",
                  "git-remote-https "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_keyword": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "exploit",
                  "Vulns",
                  "vulnerability",
                  "RemoteCodeExecution",
                  "Invoke-",
                  "CVE-",
                  "poc-",
                  "ProofOfConcept",
                  "proxyshell",
                  "log4shell",
                  "eternalblue",
                  "eternal-blue",
                  "MS17-"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1593.003"
        ],
        "tactics": [
          "reconnaissance"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-01-03",
        "modified": "2023-01-10",
        "references": [
          "https://gist.githubusercontent.com/MichaelKoczwara/12faba9c061c12b5814b711166de8c2f/raw/e2068486692897b620c25fde1ea258c8218fe3d3/history.txt"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_git_susp_clone.yml"
      }
    },
    {
      "id": "c09dad97-1c78-4f71-b127-7edb2b8e491a",
      "title": "Execution of Suspicious File Type Extension",
      "status": "test",
      "description": "Detects whether the image specified in a process creation event doesn't refer to an \".exe\" (or other known executable extension) file. This can be caused by process ghosting or other unorthodox methods to start a process.\nThis rule might require some initial baselining to align with some third party tooling in the user environment.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "known_image_extension": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  ".bin",
                  ".cgi",
                  ".com",
                  ".exe",
                  ".scr",
                  ".tmp"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_image": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "System",
                  "Registry",
                  "MemCompression",
                  "vmmem"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_msi_installers": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": ":\\Windows\\Installer\\MSI",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_driver_store": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": ":\\Windows\\System32\\DriverStore\\FileRepository\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_msi_rollbackfiles": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": ":\\Config.Msi\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  ".rbf",
                  ".rbs"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_windows_temp": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "ParentImage__contains": {
                    "field": "ParentImage",
                    "value": ":\\Windows\\Temp\\",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__contains": {
                    "field": "Image",
                    "value": ":\\Windows\\Temp\\",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "filter_main_deleted": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": ":\\$Extend\\$Deleted\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_empty": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "-",
                  ""
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_null": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_avira": {
            "type": "field_match",
            "matchers": {
              "ParentImage__contains": {
                "field": "ParentImage",
                "value": ":\\ProgramData\\Avira\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_nvidia": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": "NVIDIA\\NvBackend\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": ".dat",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_winpakpro": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  ":\\Program Files (x86)\\WINPAKPRO\\",
                  ":\\Program Files\\WINPAKPRO\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": ".ngn",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_myq_server": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  ":\\Program Files (x86)\\MyQ\\Server\\pcltool.dll",
                  ":\\Program Files\\MyQ\\Server\\pcltool.dll"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_wsl": {
            "type": "field_match",
            "matchers": {
              "Image__contains_all": {
                "field": "Image",
                "value": [
                  "\\AppData\\Local\\Packages\\",
                  "\\LocalState\\rootfs\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_lzma_exe": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\LZMA_EXE",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_firefox": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": ":\\Program Files\\Mozilla Firefox\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_docker": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": "C:\\Windows\\System32\\services.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "com.docker.service",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "not known_image_extension and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "not",
              "value": "known_image_extension"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Max Altgelt (Nextron Systems)",
        "date": "2021-12-09",
        "modified": "2023-11-23",
        "references": [
          "https://pentestlaboratories.com/2021/12/08/process-ghosting/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_non_exe_image.yml"
      }
    },
    {
      "id": "4b991083-3d0e-44ce-8fc4-b254025d8d4b",
      "title": "Unusual Parent Process For Cmd.EXE",
      "status": "test",
      "description": "Detects suspicious parent process for cmd.exe",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\cmd.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\csrss.exe",
                  "\\ctfmon.exe",
                  "\\dllhost.exe",
                  "\\epad.exe",
                  "\\FlashPlayerUpdateService.exe",
                  "\\GoogleUpdate.exe",
                  "\\jucheck.exe",
                  "\\jusched.exe",
                  "\\LogonUI.exe",
                  "\\lsass.exe",
                  "\\regsvr32.exe",
                  "\\SearchIndexer.exe",
                  "\\SearchProtocolHost.exe",
                  "\\SIHClient.exe",
                  "\\sihost.exe",
                  "\\slui.exe",
                  "\\spoolsv.exe",
                  "\\sppsvc.exe",
                  "\\taskhostw.exe",
                  "\\unsecapp.exe",
                  "\\WerFault.exe",
                  "\\wermgr.exe",
                  "\\wlanext.exe",
                  "\\WUDFHost.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Tim Rauch, Elastic (idea)",
        "date": "2022-09-21",
        "modified": "2023-12-05",
        "references": [
          "https://www.elastic.co/guide/en/security/current/unusual-parent-process-for-cmd.exe.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_cmd_unusual_parent.yml"
      }
    },
    {
      "id": "17769c90-230e-488b-a463-e05c08e9d48f",
      "title": "Powershell Defender Exclusion",
      "status": "test",
      "description": "Detects requests to exclude files, folders or processes from Antivirus scanning using PowerShell cmdlets",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Add-MpPreference ",
                  "Set-MpPreference "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -ExclusionPath ",
                  " -ExclusionExtension ",
                  " -ExclusionProcess ",
                  " -ExclusionIpAddress "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-04-29",
        "modified": "2022-05-12",
        "references": [
          "https://learn.microsoft.com/en-us/defender-endpoint/configure-process-opened-file-exclusions-microsoft-defender-antivirus",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md",
          "https://twitter.com/AdamTheAnalyst/status/1483497517119590403"
        ],
        "falsepositives": [
          "Possible Admin Activity",
          "Other Cmdlets that may use the same parameters"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_defender_exclusion.yml"
      }
    },
    {
      "id": "7b4f794b-590a-4ad4-ba18-7964a2832205",
      "title": "Renamed Vmnat.exe Execution",
      "status": "test",
      "description": "Detects renamed vmnat.exe or portable version that can be used for DLL side-loading",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1574.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "OriginalFileName": {
                "field": "OriginalFileName",
                "value": "vmnat.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_rename": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "vmnat.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1574.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "elhoim",
        "date": "2022-09-09",
        "modified": "2023-02-03",
        "references": [
          "https://twitter.com/malmoeb/status/1525901219247845376"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_renamed_vmnat.yml"
      }
    },
    {
      "id": "e56d3073-83ff-4021-90fe-c658e0709e72",
      "title": "Gpresult Display Group Policy Information",
      "status": "test",
      "description": "Detects cases in which a user uses the built-in Windows utility gpresult to display the Resultant Set of Policy (RSoP) information",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.t1615"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\gpresult.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "/z",
                  "/v"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1615"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-05-01",
        "modified": "",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1615/T1615.md",
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/gpresult",
          "https://unit42.paloaltonetworks.com/emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve/",
          "https://www.welivesecurity.com/wp-content/uploads/2020/05/ESET_Turla_ComRAT.pdf"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_gpresult_execution.yml"
      }
    },
    {
      "id": "0a4f6091-223b-41f6-8743-f322ec84930b",
      "title": "Suspicious GUP Usage",
      "status": "test",
      "description": "Detects execution of the Notepad++ updater in a suspicious directory, which is often used in DLL side-loading attacks",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1574.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\GUP.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_programfiles": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\Program Files\\Notepad++\\updater\\GUP.exe",
                  "\\Program Files (x86)\\Notepad++\\updater\\GUP.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_user": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": "\\Users\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\AppData\\Local\\Notepad++\\updater\\GUP.exe",
                  "\\AppData\\Roaming\\Notepad++\\updater\\GUP.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1574.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2019-02-06",
        "modified": "2022-08-13",
        "references": [
          "https://www.fireeye.com/blog/threat-research/2018/09/apt10-targeting-japanese-corporations-using-updated-ttps.html"
        ],
        "falsepositives": [
          "Execution of tools named GUP.exe and located in folders different than Notepad++\\updater"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_gup_suspicious_execution.yml"
      }
    },
    {
      "id": "40f9af16-589d-4984-b78d-8c2aec023197",
      "title": "Potential UAC Bypass Via Sdclt.EXE",
      "status": "test",
      "description": "A General detection for sdclt being spawned as an elevated process. This could be an indicator of sdclt being used for bypass UAC techniques.",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.defense-evasion",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "sdclt.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "IntegrityLevel": {
                "field": "IntegrityLevel",
                "value": [
                  "High",
                  "S-1-16-12288"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "privilege_escalation",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
        "date": "2020-05-02",
        "modified": "2024-12-01",
        "references": [
          "https://github.com/OTRF/detection-hackathon-apt29/issues/6",
          "https://github.com/OTRF/ThreatHunter-Playbook/blob/2d4257f630f4c9770f78d0c1df059f891ffc3fec/docs/evals/apt29/detections/3.B.2_C36B49B5-DF58-4A34-9FE9-56189B9DEFEA.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_uac_bypass_sdclt.yml"
      }
    },
    {
      "id": "9c0295ce-d60d-40bd-bd74-84673b7592b1",
      "title": "Suspicious Encoded And Obfuscated Reflection Assembly Load Function Call",
      "status": "test",
      "description": "Detects suspicious base64 encoded and obfuscated \"LOAD\" keyword used in .NET \"reflection.assembly\"",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.defense-evasion",
        "attack.t1059.001",
        "attack.t1027"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "OgA6ACgAIgBMACIAKwAiAG8AYQBkACIAKQ",
                  "oAOgAoACIATAAiACsAIgBvAGEAZAAiACkA",
                  "6ADoAKAAiAEwAIgArACIAbwBhAGQAIgApA",
                  "OgA6ACgAIgBMAG8AIgArACIAYQBkACIAKQ",
                  "oAOgAoACIATABvACIAKwAiAGEAZAAiACkA",
                  "6ADoAKAAiAEwAbwAiACsAIgBhAGQAIgApA",
                  "OgA6ACgAIgBMAG8AYQAiACsAIgBkACIAKQ",
                  "oAOgAoACIATABvAGEAIgArACIAZAAiACkA",
                  "6ADoAKAAiAEwAbwBhACIAKwAiAGQAIgApA",
                  "OgA6ACgAJwBMACcAKwAnAG8AYQBkACcAKQ",
                  "oAOgAoACcATAAnACsAJwBvAGEAZAAnACkA",
                  "6ADoAKAAnAEwAJwArACcAbwBhAGQAJwApA",
                  "OgA6ACgAJwBMAG8AJwArACcAYQBkACcAKQ",
                  "oAOgAoACcATABvACcAKwAnAGEAZAAnACkA",
                  "6ADoAKAAnAEwAbwAnACsAJwBhAGQAJwApA",
                  "OgA6ACgAJwBMAG8AYQAnACsAJwBkACcAKQ",
                  "oAOgAoACcATABvAGEAJwArACcAZAAnACkA",
                  "6ADoAKAAnAEwAbwBhACcAKwAnAGQAJwApA"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001",
          "T1027"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "pH-T (Nextron Systems)",
        "date": "2022-03-01",
        "modified": "2023-04-06",
        "references": [
          "https://github.com/Neo23x0/Raccine/blob/20a569fa21625086433dcce8bb2765d0ea08dcb6/yara/mal_revil.yar",
          "https://thedfirreport.com/2022/05/09/seo-poisoning-a-gootloader-story/",
          "https://learn.microsoft.com/en-us/dotnet/api/system.appdomain.load?view=net-7.0"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_base64_reflection_assembly_load_obfusc.yml"
      }
    },
    {
      "id": "70bc5215-526f-4477-963c-a47a5c9ebd12",
      "title": "Potential Active Directory Enumeration Using AD Module - ProcCreation",
      "status": "test",
      "description": "Detects usage of the \"Import-Module\" cmdlet to load the \"Microsoft.ActiveDirectory.Management.dl\" DLL. Which is often used by attackers to perform AD enumeration.",
      "level": "medium",
      "tags": [
        "attack.reconnaissance",
        "attack.discovery",
        "attack.impact"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\powershell.exe",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "PowerShell.EXE",
                      "pwsh.dll"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cmdlet": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "Import-Module ",
                  "ipmo "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_dll": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "Microsoft.ActiveDirectory.Management.dll",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "reconnaissance",
          "discovery",
          "impact"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2023-01-22",
        "modified": "",
        "references": [
          "https://github.com/samratashok/ADModule",
          "https://twitter.com/cyb3rops/status/1617108657166061568?s=20",
          "https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/active-directory-enumeration-with-ad-module-without-rsat-or-admin-privileges"
        ],
        "falsepositives": [
          "Legitimate use of the library for administrative activity"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_active_directory_module_dll_import.yml"
      }
    },
    {
      "id": "7090adee-82e2-4269-bd59-80691e7c6338",
      "title": "Console CodePage Lookup Via CHCP",
      "status": "test",
      "description": "Detects use of chcp to look up the system locale value as part of host discovery",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.t1614.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\cmd.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "ParentCommandLine__contains": {
                "field": "ParentCommandLine",
                "value": [
                  " -c ",
                  " -r ",
                  " -k "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\chcp.com",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": [
                  "chcp",
                  "chcp ",
                  "chcp  "
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1614.001"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "_pete_0, TheDFIRReport",
        "date": "2022-02-21",
        "modified": "2024-03-05",
        "references": [
          "https://thedfirreport.com/2022/04/04/stolen-images-campaign-ends-in-conti-ransomware/",
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/chcp"
        ],
        "falsepositives": [
          "During Anaconda update the 'conda.exe' process will eventually execution the 'chcp' command.",
          "Discord was seen using chcp to look up code pages"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_chcp_codepage_lookup.yml"
      }
    },
    {
      "id": "85d23b42-9a9d-4f8f-b3d7-d2733c1d58f5",
      "title": "HackTool - HollowReaper Execution",
      "status": "experimental",
      "description": "Detects usage of HollowReaper, a process hollowing shellcode launcher used for stealth payload execution through process hollowing.\nIt replaces the memory of a legitimate process with custom shellcode, allowing the attacker to execute payloads under the guise of trusted binaries.\n",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.defense-evasion",
        "attack.t1055.012"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\HollowReaper.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1055.012"
        ],
        "tactics": [
          "privilege_escalation",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-07-01",
        "modified": "",
        "references": [
          "https://github.com/vari-sh/RedTeamGrimoire/tree/b5e7635d34db6e1f0398d8847e8f293186e947c5/HollowReaper"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_hollowreaper.yml"
      }
    },
    {
      "id": "3d3aa6cd-6272-44d6-8afc-7e88dfef7061",
      "title": "Change Default File Association Via Assoc",
      "status": "test",
      "description": "Detects file association changes using the builtin \"assoc\" command.\nWhen a file is opened, the default program used to open the file (also called the file association or handler) is checked. File association selections are stored in the Windows Registry and can be edited by users, administrators, or programs that have Registry access or by administrators using the built-in assoc utility. Applications can modify the file association for a given file extension to call an arbitrary program when a file with the given extension is opened.\n",
      "level": "low",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1546.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\cmd.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "Cmd.Exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "assoc",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1546.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Timur Zinniatullin, oscd.community",
        "date": "2019-10-21",
        "modified": "2023-03-06",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1546.001/T1546.001.md"
        ],
        "falsepositives": [
          "Admin activity"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_cmd_assoc_execution.yml"
      }
    },
    {
      "id": "7f5d1c9a-3e83-48df-95a7-2b98aae6c13c",
      "title": "Potential Provlaunch.EXE Binary Proxy Execution Abuse",
      "status": "test",
      "description": "Detects child processes of \"provlaunch.exe\" which might indicate potential abuse to proxy execution.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\provlaunch.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_covered_children": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\calc.exe",
                      "\\cmd.exe",
                      "\\cscript.exe",
                      "\\mshta.exe",
                      "\\notepad.exe",
                      "\\powershell.exe",
                      "\\pwsh.exe",
                      "\\regsvr32.exe",
                      "\\rundll32.exe",
                      "\\wscript.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__contains": {
                    "field": "Image",
                    "value": [
                      ":\\PerfLogs\\",
                      ":\\Temp\\",
                      ":\\Users\\Public\\",
                      "\\AppData\\Temp\\",
                      "\\Windows\\System32\\Tasks\\",
                      "\\Windows\\Tasks\\",
                      "\\Windows\\Temp\\"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), Swachchhanda Shrawan Poudel",
        "date": "2023-08-08",
        "modified": "",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Provlaunch/",
          "https://twitter.com/0gtweet/status/1674399582162153472"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_provlaunch_potential_abuse.yml"
      }
    },
    {
      "id": "646bc99f-6682-4b47-a73a-17b1b64c9d34",
      "title": "Execute Files with Msdeploy.exe",
      "status": "test",
      "description": "Detects file execution using the msdeploy.exe lolbin",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "verb:sync",
                  "-source:RunCommand",
                  "-dest:runCommand"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\msdeploy.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Beyu Denis, oscd.community",
        "date": "2020-10-18",
        "modified": "2021-11-27",
        "references": [
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Msdeploy/",
          "https://twitter.com/pabraeken/status/995837734379032576",
          "https://twitter.com/pabraeken/status/999090532839313408"
        ],
        "falsepositives": [
          "System administrator Usage"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_msdeploy.yml"
      }
    },
    {
      "id": "ab37a6ec-6068-432b-a64e-2c7bf95b1d22",
      "title": "Scripting/CommandLine Process Spawned Regsvr32",
      "status": "test",
      "description": "Detects various command line and scripting engines/processes such as \"PowerShell\", \"Wscript\", \"Cmd\", etc. spawning a \"regsvr32\" instance.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.010"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\cmd.exe",
                  "\\cscript.exe",
                  "\\mshta.exe",
                  "\\powershell_ise.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\wscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\regsvr32.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_rpcproxy": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": "C:\\Windows\\System32\\cmd.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": " /s C:\\Windows\\System32\\RpcProxy\\RpcProxy.dll",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218.010"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-26",
        "modified": "",
        "references": [
          "https://web.archive.org/web/20171001085340/https://subt0x10.blogspot.com/2017/04/bypass-application-whitelisting-script.html",
          "https://app.any.run/tasks/34221348-072d-4b70-93f3-aa71f6ebecad/"
        ],
        "falsepositives": [
          "Legitimate \".bat\", \".hta\", \".ps1\" or \".vbs\" scripts leverage legitimately often. Apply additional filter and exclusions as necessary",
          "Some legitimate Windows services"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_regsvr32_susp_parent.yml"
      }
    },
    {
      "id": "7530cd3d-7671-43e3-b209-976966f6ea48",
      "title": "Renamed CURL.EXE Execution",
      "status": "test",
      "description": "Detects the execution of a renamed \"CURL.exe\" binary based on the PE metadata fields",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059",
        "attack.defense-evasion",
        "attack.t1202"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "curl.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "The curl executable",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_main_img": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": "\\curl",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1059",
          "T1202"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "X__Junior (Nextron Systems)",
        "date": "2023-09-11",
        "modified": "2023-10-12",
        "references": [
          "https://twitter.com/Kostastsale/status/1700965142828290260"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_renamed_curl.yml"
      }
    },
    {
      "id": "4ebc877f-4612-45cb-b3a5-8e3834db36c9",
      "title": "Webshell Hacking Activity Patterns",
      "status": "test",
      "description": "Detects certain parent child patterns found in cases in which a web shell is used to perform certain credential dumping or exfiltration activities on a compromised system\n",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.discovery",
        "attack.t1505.003",
        "attack.t1018",
        "attack.t1033",
        "attack.t1087"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_webserver_image": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\caddy.exe",
                  "\\httpd.exe",
                  "\\nginx.exe",
                  "\\php-cgi.exe",
                  "\\w3wp.exe",
                  "\\ws_tomcatservice.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_webserver_characteristics_tomcat1": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\java.exe",
                  "\\javaw.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "ParentImage__contains": {
                "field": "ParentImage",
                "value": [
                  "-tomcat-",
                  "\\tomcat"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_webserver_characteristics_tomcat2": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\java.exe",
                  "\\javaw.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "catalina.jar",
                  "CATALINA_HOME"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_child_1": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "rundll32",
                  "comsvcs"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_child_2": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " -hp",
                  " a ",
                  " -m"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_child_3": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "net",
                  " user ",
                  " /add"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_child_4": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "net",
                  " localgroup ",
                  " administrators ",
                  "/add"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_child_5": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\ntdsutil.exe",
                  "\\ldifde.exe",
                  "\\adfind.exe",
                  "\\procdump.exe",
                  "\\Nanodump.exe",
                  "\\vssadmin.exe",
                  "\\fsutil.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_child_6": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -decode ",
                  " -NoP ",
                  " -W Hidden ",
                  " /decode ",
                  " /ticket:",
                  " sekurlsa",
                  ".dmp full",
                  ".downloadfile(",
                  ".downloadstring(",
                  "FromBase64String",
                  "process call create",
                  "reg save ",
                  "whoami /priv"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_webserver_* and 1 of selection_child_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "1 of selection_webserver_*"
            },
            {
              "type": "ref",
              "value": "1 of selection_child_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1505.003",
          "T1018",
          "T1033",
          "T1087"
        ],
        "tactics": [
          "persistence",
          "discovery"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-03-17",
        "modified": "2023-11-09",
        "references": [
          "https://youtu.be/7aemGhaE9ds?t=641"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_webshell_hacking.yml"
      }
    },
    {
      "id": "36210e0d-5b19-485d-a087-c096088885f0",
      "title": "Suspicious PowerShell Parameter Substring",
      "status": "test",
      "description": "Detects suspicious PowerShell invocation with a parameter substring",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\powershell.exe",
                  "\\pwsh.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -windowstyle h ",
                  " -windowstyl h",
                  " -windowsty h",
                  " -windowst h",
                  " -windows h",
                  " -windo h",
                  " -wind h",
                  " -win h",
                  " -wi h",
                  " -win h ",
                  " -win hi ",
                  " -win hid ",
                  " -win hidd ",
                  " -win hidde ",
                  " -NoPr ",
                  " -NoPro ",
                  " -NoProf ",
                  " -NoProfi ",
                  " -NoProfil ",
                  " -nonin ",
                  " -nonint ",
                  " -noninte ",
                  " -noninter ",
                  " -nonintera ",
                  " -noninterac ",
                  " -noninteract ",
                  " -noninteracti ",
                  " -noninteractiv ",
                  " -ec ",
                  " -encodedComman ",
                  " -encodedComma ",
                  " -encodedComm ",
                  " -encodedCom ",
                  " -encodedCo ",
                  " -encodedC ",
                  " -encoded ",
                  " -encode ",
                  " -encod ",
                  " -enco ",
                  " -en ",
                  " -executionpolic ",
                  " -executionpoli ",
                  " -executionpol ",
                  " -executionpo ",
                  " -executionp ",
                  " -execution bypass",
                  " -executio bypass",
                  " -executi bypass",
                  " -execut bypass",
                  " -execu bypass",
                  " -exec bypass",
                  " -exe bypass",
                  " -ex bypass",
                  " -ep bypass",
                  " /windowstyle h ",
                  " /windowstyl h",
                  " /windowsty h",
                  " /windowst h",
                  " /windows h",
                  " /windo h",
                  " /wind h",
                  " /win h",
                  " /wi h",
                  " /win h ",
                  " /win hi ",
                  " /win hid ",
                  " /win hidd ",
                  " /win hidde ",
                  " /NoPr ",
                  " /NoPro ",
                  " /NoProf ",
                  " /NoProfi ",
                  " /NoProfil ",
                  " /nonin ",
                  " /nonint ",
                  " /noninte ",
                  " /noninter ",
                  " /nonintera ",
                  " /noninterac ",
                  " /noninteract ",
                  " /noninteracti ",
                  " /noninteractiv ",
                  " /ec ",
                  " /encodedComman ",
                  " /encodedComma ",
                  " /encodedComm ",
                  " /encodedCom ",
                  " /encodedCo ",
                  " /encodedC ",
                  " /encoded ",
                  " /encode ",
                  " /encod ",
                  " /enco ",
                  " /en ",
                  " /executionpolic ",
                  " /executionpoli ",
                  " /executionpol ",
                  " /executionpo ",
                  " /executionp ",
                  " /execution bypass",
                  " /executio bypass",
                  " /executi bypass",
                  " /execut bypass",
                  " /execu bypass",
                  " /exec bypass",
                  " /exe bypass",
                  " /ex bypass",
                  " /ep bypass"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Daniel Bohannon (idea), Roberto Rodriguez (Fix)",
        "date": "2019-01-16",
        "modified": "2022-07-14",
        "references": [
          "http://www.danielbohannon.com/blog-1/2017/3/12/powershell-execution-argument-obfuscation-how-it-can-make-detection-easier"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_powershell_susp_parameter_variation.yml"
      }
    },
    {
      "id": "82a6714f-4899-4f16-9c1e-9a333544d4c3",
      "title": "File In Suspicious Location Encoded To Base64 Via Certutil.EXE",
      "status": "test",
      "description": "Detects the execution of certutil with the \"encode\" flag to encode a file to base64 where the files are located in potentially suspicious locations",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\certutil.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "CertUtil.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "-encode",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_extension": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "\\AppData\\Roaming\\",
                  "\\Desktop\\",
                  "\\Local\\Temp\\",
                  "\\PerfLogs\\",
                  "\\Users\\Public\\",
                  "\\Windows\\Temp\\",
                  "$Recycle.Bin"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1027"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-15",
        "modified": "2024-03-05",
        "references": [
          "https://www.virustotal.com/gui/file/35c22725a92d5cb1016b09421c0a6cdbfd860fd4778b3313669b057d4a131cb7/behavior",
          "https://www.virustotal.com/gui/file/427616528b7dbc4a6057ac89eb174a3a90f7abcf3f34e5a359b7a910d82f7a72/behavior",
          "https://www.virustotal.com/gui/file/34de4c8beded481a4084a1fd77855c3e977e8ac643e5c5842d0f15f7f9b9086f/behavior",
          "https://www.virustotal.com/gui/file/4abe1395a09fda06d897a9c4eb247278c1b6cddda5d126ce5b3f4f499e3b8fa2/behavior"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_certutil_encode_susp_location.yml"
      }
    },
    {
      "id": "9ec9fb1b-e059-4489-9642-f270c207923d",
      "title": "Hiding User Account Via SpecialAccounts Registry Key - CommandLine",
      "status": "test",
      "description": "Detects changes to the registry key \"HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\SpecialAccounts\\Userlist\" where the value is set to \"0\" in order to hide user account from being listed on the logon screen.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1564.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\reg.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\SpecialAccounts\\UserList",
                  "add",
                  "/v",
                  "/d 0"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1564.002"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "@Kostastsale, TheDFIRReport",
        "date": "2022-05-14",
        "modified": "2024-08-23",
        "references": [
          "https://thedfirreport.com/2024/01/29/buzzing-on-christmas-eve-trigona-ransomware-in-3-hours/",
          "https://thedfirreport.com/2024/04/01/from-onenote-to-ransomnote-an-ice-cold-intrusion/",
          "https://thedfirreport.com/2024/04/29/from-icedid-to-dagon-locker-ransomware-in-29-days/",
          "https://thedfirreport.com/2022/07/11/select-xmrig-from-sqlserver/"
        ],
        "falsepositives": [
          "System administrator activities"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_registry_special_accounts_hide_user.yml"
      }
    },
    {
      "id": "b9f0e6f5-09b4-4358-bae4-08408705bd5c",
      "title": "New User Created Via Net.EXE With Never Expire Option",
      "status": "test",
      "description": "Detects creation of local users via the net.exe command with the option \"never expire\"",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.t1136.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\net.exe",
                      "\\net1.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "net.exe",
                      "net1.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "user",
                  "add",
                  "expires:never"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1136.001"
        ],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-07-12",
        "modified": "2023-02-21",
        "references": [
          "https://thedfirreport.com/2022/07/11/select-xmrig-from-sqlserver/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_net_user_add_never_expire.yml"
      }
    },
    {
      "id": "23ceaf5c-b6f1-4a32-8559-f2ff734be516",
      "title": "Dumping Process via Sqldumper.exe",
      "status": "test",
      "description": "Detects process dump via legitimate sqldumper.exe binary",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.t1003.001"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\sqldumper.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "0x0110",
                  "0x01100:40"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.001"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Kirill Kiryanov, oscd.community",
        "date": "2020-10-08",
        "modified": "2021-11-27",
        "references": [
          "https://twitter.com/countuponsec/status/910977826853068800",
          "https://twitter.com/countuponsec/status/910969424215232518",
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Sqldumper/"
        ],
        "falsepositives": [
          "Legitimate MSSQL Server actions"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_lolbin_susp_sqldumper_activity.yml"
      }
    },
    {
      "id": "cbec226f-63d9-4eca-9f52-dfb6652f24df",
      "title": "Suspicious Process Parents",
      "status": "test",
      "description": "Detects suspicious parent processes that should not have any children or should only have a single possible child program",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\minesweeper.exe",
                  "\\winver.exe",
                  "\\bitsadmin.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_special": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\csrss.exe",
                  "\\certutil.exe",
                  "\\eventvwr.exe",
                  "\\calc.exe",
                  "\\notepad.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_special": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\WerFault.exe",
                  "\\wermgr.exe",
                  "\\conhost.exe",
                  "\\mmc.exe",
                  "\\win32calc.exe",
                  "\\notepad.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_null": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection or ( selection_special and not 1 of filter_* )",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection",
            "( selection_special and not 1 of filter_* )"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1036"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-03-21",
        "modified": "2022-09-08",
        "references": [
          "https://twitter.com/x86matthew/status/1505476263464607744?s=12",
          "https://svch0st.medium.com/stats-from-hunting-cobalt-strike-beacons-c17e56255f9b"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_parents.yml"
      }
    },
    {
      "id": "7c0dcd3d-acf8-4f71-9570-f448b0034f94",
      "title": "PsExec Service Child Process Execution as LOCAL SYSTEM",
      "status": "test",
      "description": "Detects suspicious launch of the PSEXESVC service on this system and a sub process run as LOCAL_SYSTEM (-s), which means that someone remotely started a command on this system running it with highest privileges and not only the privileges of the login user account (e.g. the administrator account)",
      "level": "high",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": "C:\\Windows\\PSEXESVC.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "User__contains": {
                "field": "User",
                "value": [
                  "AUTHORI",
                  "AUTORI"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-07-21",
        "modified": "2023-02-28",
        "references": [
          "https://learn.microsoft.com/en-us/sysinternals/downloads/psexec"
        ],
        "falsepositives": [
          "Users that debug Microsoft Intune issues using the commands mentioned in the official documentation; see https://learn.microsoft.com/en-us/mem/intune/apps/intune-management-extension"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sysinternals_psexesvc_as_system.yml"
      }
    },
    {
      "id": "60f16a96-db70-42eb-8f76-16763e333590",
      "title": "New Capture Session Launched Via DXCap.EXE",
      "status": "test",
      "description": "Detects the execution of \"DXCap.EXE\" with the \"-c\" flag, which allows a user to launch any arbitrary binary or windows package through DXCap itself. This can be abused to potentially bypass application whitelisting.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\DXCap.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "DXCap.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " -c ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Beyu Denis, oscd.community, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2019-10-26",
        "modified": "2022-06-09",
        "references": [
          "https://lolbas-project.github.io/lolbas/OtherMSBinaries/Dxcap/",
          "https://twitter.com/harr0ey/status/992008180904419328"
        ],
        "falsepositives": [
          "Legitimate execution of dxcap.exe by legitimate user"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_dxcap_arbitrary_binary_execution.yml"
      }
    },
    {
      "id": "aa2efee7-34dd-446e-8a37-40790a66efd7",
      "title": "Recon Information for Export with Command Prompt",
      "status": "test",
      "description": "Once established within a system or network, an adversary may use automated techniques for collecting internal data.",
      "level": "medium",
      "tags": [
        "attack.collection",
        "attack.t1119"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_image": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\tree.com",
                      "\\WMIC.exe",
                      "\\doskey.exe",
                      "\\sc.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "wmic.exe",
                      "DOSKEY.EXE",
                      "sc.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_redirect": {
            "type": "field_match",
            "matchers": {
              "ParentCommandLine__contains": {
                "field": "ParentCommandLine",
                "value": [
                  " > %TEMP%\\",
                  " > %TMP%\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1119"
        ],
        "tactics": [
          "collection"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-07-30",
        "modified": "2022-09-13",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1119/T1119.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_recon.yml"
      }
    },
    {
      "id": "a197e378-d31b-41c0-9635-cfdf1c1bb423",
      "title": "HackTool - WinRM Access Via Evil-WinRM",
      "status": "test",
      "description": "Adversaries may use Valid Accounts to log into a computer using the Remote Desktop Protocol (RDP). The adversary may then perform actions as the logged-on user.",
      "level": "medium",
      "tags": [
        "attack.lateral-movement",
        "attack.t1021.006"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\ruby.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "-i ",
                  "-u ",
                  "-p "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1021.006"
        ],
        "tactics": [
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-07",
        "modified": "2023-02-13",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1021.006/T1021.006.md#atomic-test-3---winrm-access-with-evil-winrm",
          "https://github.com/Hackplayers/evil-winrm"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_hktl_evil_winrm.yml"
      }
    },
    {
      "id": "3ef5605c-9eb9-47b0-9a71-b727e6aa5c3b",
      "title": "Use NTFS Short Name in Image",
      "status": "test",
      "description": "Detect use of the Windows 8.3 short name. Which could be used as a method to avoid Image based detection",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1564.004"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  "~1.bat",
                  "~1.dll",
                  "~1.exe",
                  "~1.hta",
                  "~1.js",
                  "~1.msi",
                  "~1.ps1",
                  "~1.tmp",
                  "~1.vbe",
                  "~1.vbs",
                  "~2.bat",
                  "~2.dll",
                  "~2.exe",
                  "~2.hta",
                  "~2.js",
                  "~2.msi",
                  "~2.ps1",
                  "~2.tmp",
                  "~2.vbe",
                  "~2.vbs"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_generic_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": "C:\\Windows\\explorer.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_webex": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\WebEx\\WebexHost.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_thor": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\thor\\thor64.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_winzip": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\PROGRA~1\\WinZip\\WZPREL~1.EXE",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_vcred": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\VCREDI~1.EXE",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1564.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-06",
        "modified": "2023-07-20",
        "references": [
          "https://www.acunetix.com/blog/articles/windows-short-8-3-filenames-web-security-problem/",
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/cc959352(v=technet.10)",
          "https://twitter.com/jonasLyk/status/1555914501802921984"
        ],
        "falsepositives": [
          "Software Installers"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_susp_ntfs_short_name_use_image.yml"
      }
    },
    {
      "id": "6ddff2e8-ea1a-45d0-8938-93dfc1d67ae7",
      "title": "PUA - Restic Backup Tool Execution",
      "status": "experimental",
      "description": "Detects the execution of the Restic backup tool, which can be used for data exfiltration.\nThreat actors may leverage Restic to back up and exfiltrate sensitive data to remote storage locations, including cloud services.\nIf not legitimately used in the enterprise environment, its presence may indicate malicious activity.\n",
      "level": "high",
      "tags": [
        "attack.exfiltration",
        "attack.t1048",
        "attack.t1567.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_specific": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "--password-file",
                      "init",
                      " -r "
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "--use-fs-snapshot",
                      "backup",
                      " -r "
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_restic": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "sftp:",
                  "rest:http",
                  "s3:s3.",
                  "s3.http",
                  "azure:",
                  " gs:",
                  "rclone:",
                  "swift:",
                  " b2:"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  " init ",
                  " -r "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1048",
          "T1567.002"
        ],
        "tactics": [
          "exfiltration"
        ]
      },
      "meta": {
        "author": "Nounou Mbeiri, Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-10-17",
        "modified": "",
        "references": [
          "https://thedfirreport.com/2024/09/30/nitrogen-campaign-drops-sliver-and-ends-with-blackcat-ransomware/#exfiltration",
          "https://restic.net/",
          "https://restic.readthedocs.io/en/stable/030_preparing_a_new_repo.html"
        ],
        "falsepositives": [
          "Legitimate use of Restic for backup purposes within the organization."
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_restic.yml"
      }
    },
    {
      "id": "cb7c4a03-2871-43c0-9bbb-18bbdb079896",
      "title": "Unmount Share Via Net.EXE",
      "status": "test",
      "description": "Detects when when a mounted share is removed. Adversaries may remove share connections that are no longer useful in order to clean up traces of their operation",
      "level": "low",
      "tags": [
        "attack.defense-evasion",
        "attack.t1070.005"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\net.exe",
                      "\\net1.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": [
                      "net.exe",
                      "net1.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "share",
                  "/delete"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1070.005"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "oscd.community, @redcanary, Zach Stanford @svch0st",
        "date": "2020-10-08",
        "modified": "2023-02-21",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.005/T1070.005.md"
        ],
        "falsepositives": [
          "Administrators or Power users may remove their shares via cmd line"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_net_share_unmount.yml"
      }
    },
    {
      "id": "7c9340a9-e2ee-4e43-94c5-c54ebbea1006",
      "title": "File And SubFolder Enumeration Via Dir Command",
      "status": "test",
      "description": "Detects usage of the \"dir\" command part of Windows CMD with the \"/S\" command line flag in order to enumerate files in a specified directory and all subdirectories.\n",
      "level": "low",
      "tags": [
        "attack.discovery",
        "attack.t1217"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_cmd": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\cmd.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "Cmd.Exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "dir*-s",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1217"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-12-13",
        "modified": "2024-04-14",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1217/T1217.md"
        ],
        "falsepositives": [
          "Likely"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_cmd_dir_execution.yml"
      }
    },
    {
      "id": "15434e33-5027-4914-88d5-3d4145ec25a9",
      "title": "Potential Product Reconnaissance Via Wmic.EXE",
      "status": "test",
      "description": "Detects the execution of WMIC in order to get a list of firewall and antivirus products",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1047"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\wmic.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "wmic.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "Product",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_call_operations": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " uninstall",
                  " install"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_main_"
        }
      },
      "mitre": {
        "techniques": [
          "T1047"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali",
        "date": "2023-02-14",
        "modified": "2025-10-22",
        "references": [
          "https://thedfirreport.com/2023/03/06/2022-year-in-review/",
          "https://www.yeahhub.com/list-installed-programs-version-path-windows/",
          "https://learn.microsoft.com/en-us/answers/questions/253555/software-list-inventory-wmic-product"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_wmic_recon_product.yml"
      }
    },
    {
      "id": "d9047477-0359-48c9-b8c7-792cedcdc9c4",
      "title": "PUA - NirCmd Execution As LOCAL SYSTEM",
      "status": "test",
      "description": "Detects the use of NirCmd tool for command execution as SYSTEM user",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1569.002",
        "attack.s0029"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " runassystem ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1569.002"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-01-24",
        "modified": "2023-02-13",
        "references": [
          "https://www.nirsoft.net/utils/nircmd.html",
          "https://www.winhelponline.com/blog/run-program-as-system-localsystem-account-windows/",
          "https://www.nirsoft.net/utils/nircmd2.html#using"
        ],
        "falsepositives": [
          "Legitimate use by administrators"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_nircmd_as_system.yml"
      }
    },
    {
      "id": "0c92f2e6-f08f-4b73-9216-ecb0ca634689",
      "title": "PUA - Potential PE Metadata Tamper Using Rcedit",
      "status": "test",
      "description": "Detects the use of rcedit to potentially alter executable PE metadata properties, which could conceal efforts to rename system utilities for defense evasion.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036.003",
        "attack.t1036",
        "attack.t1027.005",
        "attack.t1027"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\rcedit-x64.exe",
                      "\\rcedit-x86.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "Edit resources of exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Product": {
                    "field": "Product",
                    "value": "rcedit",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_flags": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "--set-",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_attributes": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "OriginalFileName",
                  "CompanyName",
                  "FileDescription",
                  "ProductName",
                  "ProductVersion",
                  "LegalCopyright"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1036.003",
          "T1036",
          "T1027.005",
          "T1027"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Micah Babinski",
        "date": "2022-12-11",
        "modified": "2023-03-05",
        "references": [
          "https://security.stackexchange.com/questions/210843/is-it-possible-to-change-original-filename-of-an-exe",
          "https://www.virustotal.com/gui/file/02e8e8c5d430d8b768980f517b62d7792d690982b9ba0f7e04163cbc1a6e7915",
          "https://github.com/electron/rcedit"
        ],
        "falsepositives": [
          "Legitimate use of the tool by administrators or users to update metadata of a binary"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_rcedit_execution.yml"
      }
    },
    {
      "id": "aae1243f-d8af-40d8-ab20-33fc6d0c55bc",
      "title": "Suspicious Use of PsLogList",
      "status": "test",
      "description": "Detects usage of the PsLogList utility to dump event log in order to extract admin accounts and perform account discovery or delete events logs",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.t1087",
        "attack.t1087.001",
        "attack.t1087.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "psloglist.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\psloglist.exe",
                      "\\psloglist64.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_cli_eventlog": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " security",
                  " application",
                  " system"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_flags": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  " -d",
                  " -x",
                  " -s",
                  " -c",
                  " -g"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1087",
          "T1087.001",
          "T1087.002"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2021-12-18",
        "modified": "2024-03-05",
        "references": [
          "https://research.nccgroup.com/2021/01/12/abusing-cloud-services-to-fly-under-the-radar/",
          "https://www.cybereason.com/blog/deadringer-exposing-chinese-threat-actors-targeting-major-telcos",
          "https://github.com/3CORESec/MAL-CL/tree/master/Descriptors/Sysinternals/PsLogList",
          "https://twitter.com/EricaZelic/status/1614075109827874817"
        ],
        "falsepositives": [
          "Another tool that uses the command line switches of PsLogList",
          "Legitimate use of PsLogList by an administrator"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_sysinternals_psloglist.yml"
      }
    },
    {
      "id": "e37db05d-d1f9-49c8-b464-cee1a4b11638",
      "title": "PUA - Rclone Execution",
      "status": "test",
      "description": "Detects execution of RClone utility for exfiltration as used by various ransomwares strains like REvil, Conti, FiveHands, etc",
      "level": "high",
      "tags": [
        "attack.exfiltration",
        "attack.t1567.002"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_specific_options": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "--config ",
                  "--no-check-certificate ",
                  " copy "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_rclone_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\rclone.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Description": {
                    "field": "Description",
                    "value": "Rsync for cloud storage",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_rclone_cli": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  "pass",
                  "user",
                  "copy",
                  "sync",
                  "config",
                  "lsd",
                  "remote",
                  "ls",
                  "mega",
                  "pcloud",
                  "ftp",
                  "ignore-existing",
                  "auto-confirm",
                  "transfers",
                  "multi-thread-streams",
                  "no-check-certificate "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_specific_options or all of selection_rclone_*",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection_specific_options",
            "all of selection_rclone_*"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1567.002"
        ],
        "tactics": [
          "exfiltration"
        ]
      },
      "meta": {
        "author": "Bhabesh Raj, Sittikorn S, Aaron Greetham (@beardofbinary) - NCC Group",
        "date": "2021-05-10",
        "modified": "2023-03-05",
        "references": [
          "https://research.nccgroup.com/2021/05/27/detecting-rclone-an-effective-tool-for-exfiltration/",
          "https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware",
          "https://us-cert.cisa.gov/ncas/analysis-reports/ar21-126a",
          "https://labs.sentinelone.com/egregor-raas-continues-the-chaos-with-cobalt-strike-and-rclone",
          "https://www.splunk.com/en_us/blog/security/darkside-ransomware-splunk-threat-update-and-detections.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_pua_rclone_execution.yml"
      }
    },
    {
      "id": "f7375e28-5c14-432f-b8d1-1db26c832df3",
      "title": "Potential Arbitrary DLL Load Using Winword",
      "status": "test",
      "description": "Detects potential DLL sideloading using the Microsoft Office winword process via the '/l' flag.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1202"
      ],
      "logsource": {
        "category": "process_creation",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\WINWORD.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "OriginalFileName": {
                    "field": "OriginalFileName",
                    "value": "WinWord.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_dll": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "/l ",
                  ".dll"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1202"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Victor Sergeev, oscd.community",
        "date": "2020-10-09",
        "modified": "2023-03-29",
        "references": [
          "https://github.com/D4Vinci/One-Lin3r/blob/9fdfa5f0b9c698dfbd4cdfe7d2473192777ae1c6/one_lin3r/core/liners/windows/cmd/dll_loader_word.py"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/process_creation/proc_creation_win_office_winword_dll_load.yml"
      }
    }
  ]
}