{
  "metadata": {
    "logsource": "windows_create_stream_hash",
    "rule_count": 9,
    "compiled_at": "2026-02-04T12:28:36.363630",
    "version": "1.1"
  },
  "rules": [
    {
      "id": "025bd229-fd1f-4fdb-97ab-20006e1a5368",
      "title": "Unusual File Download from Direct IP Address",
      "status": "test",
      "description": "Detects the download of suspicious file type from URLs with IP",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1564.004"
      ],
      "logsource": {
        "category": "create_stream_hash",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Contents__re": {
                "field": "Contents",
                "value": "http[s]?://[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}",
                "modifiers": [
                  "re"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  ".ps1:Zone",
                  ".bat:Zone",
                  ".exe:Zone",
                  ".vbe:Zone",
                  ".vbs:Zone",
                  ".dll:Zone",
                  ".one:Zone",
                  ".cmd:Zone",
                  ".hta:Zone",
                  ".xll:Zone",
                  ".lnk:Zone"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1564.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), Florian Roth (Nextron Systems)",
        "date": "2022-09-07",
        "modified": "2023-02-10",
        "references": [
          "https://github.com/trustedsec/SysmonCommunityGuide/blob/adcdfee20999f422b974c8d4149bf4c361237db7/chapters/file-stream-creation-hash.md",
          "https://labs.withsecure.com/publications/detecting-onenote-abuse"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/create_stream_hash/create_stream_hash_susp_ip_domains.yml"
      }
    },
    {
      "id": "0bb4bbeb-fe52-4044-b40c-430a04577ebe",
      "title": "Potentially Suspicious File Download From ZIP TLD",
      "status": "test",
      "description": "Detects the download of a file with a potentially suspicious extension from a .zip top level domain.",
      "level": "high",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "create_stream_hash",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Contents__contains": {
                "field": "Contents",
                "value": ".zip/",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  ".bat:Zone",
                  ".dat:Zone",
                  ".dll:Zone",
                  ".doc:Zone",
                  ".docm:Zone",
                  ".exe:Zone",
                  ".hta:Zone",
                  ".pptm:Zone",
                  ".ps1:Zone",
                  ".rar:Zone",
                  ".rtf:Zone",
                  ".sct:Zone",
                  ".vbe:Zone",
                  ".vbs:Zone",
                  ".ws:Zone",
                  ".wsf:Zone",
                  ".xll:Zone",
                  ".xls:Zone",
                  ".xlsm:Zone",
                  ".zip:Zone"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2023-05-18",
        "modified": "",
        "references": [
          "https://twitter.com/cyb3rops/status/1659175181695287297",
          "https://fabian-voith.de/2020/06/25/sysmon-v11-1-reads-alternate-data-streams/"
        ],
        "falsepositives": [
          "Legitimate file downloads from a websites and web services that uses the \".zip\" top level domain."
        ],
        "source_file": "sigma_rules/windows/create_stream_hash/create_stream_hash_zip_tld_download.yml"
      }
    },
    {
      "id": "573df571-a223-43bc-846e-3f98da481eca",
      "title": "Creation Of a Suspicious ADS File Outside a Browser Download",
      "status": "test",
      "description": "Detects the creation of a suspicious ADS (Alternate Data Stream) file by software other than browsers",
      "level": "medium",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "create_stream_hash",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Contents__startswith": {
                "field": "Contents",
                "value": "[ZoneTransfer]  ZoneId=3",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ":Zone.Identifier",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  ".exe",
                  ".scr",
                  ".bat",
                  ".cmd",
                  ".docx",
                  ".hta",
                  ".jse",
                  ".lnk",
                  ".pptx",
                  ".ps",
                  ".reg",
                  ".sct",
                  ".vb",
                  ".wsc",
                  ".wsf",
                  ".xlsx"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_brave": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\brave.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_chrome": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe",
                  "C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_firefox": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Mozilla Firefox\\firefox.exe",
                  "C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_ie": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe",
                  "C:\\Program Files\\Internet Explorer\\iexplore.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_maxthon": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\maxthon.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_edge_1": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__startswith": {
                    "field": "Image",
                    "value": "C:\\Program Files (x86)\\Microsoft\\EdgeWebView\\Application\\",
                    "modifiers": [
                      "startswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\WindowsApps\\MicrosoftEdge.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image": {
                    "field": "Image",
                    "value": [
                      "C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe",
                      "C:\\Program Files\\Microsoft\\Edge\\Application\\msedge.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "filter_optional_edge_2": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\Microsoft\\EdgeCore\\",
                  "C:\\Program Files\\Microsoft\\EdgeCore\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\msedge.exe",
                  "\\msedgewebview2.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_opera": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\opera.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_safari": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\safari.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_seamonkey": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\seamonkey.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_vivaldi": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\vivaldi.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_whale": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\whale.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_snipping_tool": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Program Files\\WindowsApps\\Microsoft.ScreenSketch_",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\SnippingTool\\SnippingTool.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": "C:\\Users\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__contains_all": {
                "field": "TargetFilename",
                "value": [
                  "\\AppData\\Local\\Packages\\Microsoft.ScreenSketch_",
                  "\\TempState\\Screenshot "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".png:Zone.Identifier",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-10-22",
        "modified": "2023-06-12",
        "references": [
          "https://www.bleepingcomputer.com/news/security/exploited-windows-zero-day-lets-javascript-files-bypass-security-warnings/"
        ],
        "falsepositives": [
          "Other legitimate browsers not currently included in the filter (please add them)",
          "Legitimate downloads via scripting or command-line tools (Investigate to determine if it's legitimate)"
        ],
        "source_file": "sigma_rules/windows/create_stream_hash/create_stream_hash_creation_internet_file.yml"
      }
    },
    {
      "id": "ae02ed70-11aa-4a22-b397-c0d0e8f6ea99",
      "title": "Unusual File Download From File Sharing Websites - File Stream",
      "status": "test",
      "description": "Detects the download of suspicious file type from a well-known file and paste sharing domain",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.s0139",
        "attack.t1564.004"
      ],
      "logsource": {
        "category": "create_stream_hash",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_domain": {
            "type": "field_match",
            "matchers": {
              "Contents__contains": {
                "field": "Contents",
                "value": [
                  ".githubusercontent.com",
                  "anonfiles.com",
                  "cdn.discordapp.com",
                  "ddns.net",
                  "dl.dropboxusercontent.com",
                  "ghostbin.co",
                  "github.com",
                  "glitch.me",
                  "gofile.io",
                  "hastebin.com",
                  "mediafire.com",
                  "mega.nz",
                  "onrender.com",
                  "pages.dev",
                  "paste.ee",
                  "pastebin.com",
                  "pastebin.pl",
                  "pastetext.net",
                  "pixeldrain.com",
                  "privatlab.com",
                  "privatlab.net",
                  "send.exploit.in",
                  "sendspace.com",
                  "storage.googleapis.com",
                  "storjshare.io",
                  "supabase.co",
                  "temp.sh",
                  "transfer.sh",
                  "trycloudflare.com",
                  "ufile.io",
                  "w3spaces.com",
                  "workers.dev"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_extension": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  ".bat:Zone",
                  ".cmd:Zone",
                  ".ps1:Zone"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1564.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-08-24",
        "modified": "2025-12-10",
        "references": [
          "https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventid=90015",
          "https://www.cisa.gov/uscert/ncas/alerts/aa22-321a",
          "https://www.microsoft.com/en-us/security/blog/2024/01/17/new-ttps-observed-in-mint-sandstorm-campaign-targeting-high-profile-individuals-at-universities-and-research-orgs/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/create_stream_hash/create_stream_hash_file_sharing_domains_download_unusual_extension.yml"
      }
    },
    {
      "id": "b69888d4-380c-45ce-9cf9-d9ce46e67821",
      "title": "Hidden Executable In NTFS Alternate Data Stream",
      "status": "test",
      "description": "Detects the creation of an ADS (Alternate Data Stream) that contains an executable by looking at a non-empty Imphash",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.s0139",
        "attack.t1564.004"
      ],
      "logsource": {
        "category": "create_stream_hash",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Hash__contains": {
                "field": "Hash",
                "value": "IMPHASH=",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_null": {
            "type": "field_match",
            "matchers": {
              "Hash__contains": {
                "field": "Hash",
                "value": "IMPHASH=00000000000000000000000000000000",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1564.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), @0xrawsec",
        "date": "2018-06-03",
        "modified": "2023-02-10",
        "references": [
          "https://twitter.com/0xrawsec/status/1002478725605273600?s=21"
        ],
        "falsepositives": [
          "This rule isn't looking for any particular binary characteristics. As legitimate installers and programs were seen embedding hidden binaries in their ADS. Some false positives are expected from browser processes and similar."
        ],
        "source_file": "sigma_rules/windows/create_stream_hash/create_stream_hash_ads_executable.yml"
      }
    },
    {
      "id": "a3f5c081-e75b-43a0-9f5b-51f26fe5dba2",
      "title": "Potential Suspicious Winget Package Installation",
      "status": "test",
      "description": "Detects potential suspicious winget package installation from a suspicious source.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.persistence"
      ],
      "logsource": {
        "category": "create_stream_hash",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Contents__startswith": {
                "field": "Contents",
                "value": "[ZoneTransfer]  ZoneId=3",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Contents__contains": {
                "field": "Contents",
                "value": [
                  "://1",
                  "://2",
                  "://3",
                  "://4",
                  "://5",
                  "://6",
                  "://7",
                  "://8",
                  "://9"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ":Zone.Identifier",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\AppData\\Local\\Temp\\WinGet\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion",
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-04-18",
        "modified": "",
        "references": [
          "https://github.com/nasbench/Misc-Research/tree/b9596e8109dcdb16ec353f316678927e507a5b8d/LOLBINs/Winget"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/create_stream_hash/create_stream_hash_winget_susp_package_source.yml"
      }
    },
    {
      "id": "0d7a9363-af70-4e7b-a3b7-1a176b7fbe84",
      "title": "Exports Registry Key To an Alternate Data Stream",
      "status": "test",
      "description": "Exports the target Registry key and hides it in the specified alternate data stream.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1564.004"
      ],
      "logsource": {
        "category": "create_stream_hash",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\regedit.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1564.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Oddvar Moe, Sander Wiebing, oscd.community",
        "date": "2020-10-07",
        "modified": "2021-11-27",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Regedit/",
          "https://gist.github.com/api0cradle/cdd2d0d0ec9abb686f0e89306e277b8f"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/create_stream_hash/create_stream_hash_regedit_export_to_ads.yml"
      }
    },
    {
      "id": "52182dfb-afb7-41db-b4bc-5336cb29b464",
      "title": "Suspicious File Download From File Sharing Websites -  File Stream",
      "status": "test",
      "description": "Detects the download of suspicious file type from a well-known file and paste sharing domain",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.s0139",
        "attack.t1564.004"
      ],
      "logsource": {
        "category": "create_stream_hash",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_domain": {
            "type": "field_match",
            "matchers": {
              "Contents__contains": {
                "field": "Contents",
                "value": [
                  ".githubusercontent.com",
                  "anonfiles.com",
                  "cdn.discordapp.com",
                  "ddns.net",
                  "dl.dropboxusercontent.com",
                  "ghostbin.co",
                  "github.com",
                  "glitch.me",
                  "gofile.io",
                  "hastebin.com",
                  "mediafire.com",
                  "mega.nz",
                  "onrender.com",
                  "pages.dev",
                  "paste.ee",
                  "pastebin.com",
                  "pastebin.pl",
                  "pastetext.net",
                  "pixeldrain.com",
                  "privatlab.com",
                  "privatlab.net",
                  "send.exploit.in",
                  "sendspace.com",
                  "storage.googleapis.com",
                  "storjshare.io",
                  "supabase.co",
                  "temp.sh",
                  "transfer.sh",
                  "trycloudflare.com",
                  "ufile.io",
                  "w3spaces.com",
                  "workers.dev"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_extension": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  ".cpl:Zone",
                  ".dll:Zone",
                  ".exe:Zone",
                  ".hta:Zone",
                  ".lnk:Zone",
                  ".one:Zone",
                  ".vbe:Zone",
                  ".vbs:Zone",
                  ".xll:Zone"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1564.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-08-24",
        "modified": "2025-12-10",
        "references": [
          "https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventid=90015",
          "https://www.cisa.gov/uscert/ncas/alerts/aa22-321a",
          "https://fabian-voith.de/2020/06/25/sysmon-v11-1-reads-alternate-data-streams/",
          "https://www.microsoft.com/en-us/security/blog/2024/01/17/new-ttps-observed-in-mint-sandstorm-campaign-targeting-high-profile-individuals-at-universities-and-research-orgs/"
        ],
        "falsepositives": [
          "Some false positives might occur with binaries download via Github"
        ],
        "source_file": "sigma_rules/windows/create_stream_hash/create_stream_hash_file_sharing_domains_download_susp_extension.yml"
      }
    },
    {
      "id": "19b041f6-e583-40dc-b842-d6fa8011493f",
      "title": "HackTool Named File Stream Created",
      "status": "test",
      "description": "Detects the creation of a named file stream with the imphash of a well-known hack tool",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.s0139",
        "attack.t1564.004"
      ],
      "logsource": {
        "category": "create_stream_hash",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Hash__contains": {
                "field": "Hash",
                "value": [
                  "IMPHASH=BCCA3C247B619DCD13C8CDFF5F123932",
                  "IMPHASH=3A19059BD7688CB88E70005F18EFC439",
                  "IMPHASH=bf6223a49e45d99094406777eb6004ba",
                  "IMPHASH=0C106686A31BFE2BA931AE1CF6E9DBC6",
                  "IMPHASH=0D1447D4B3259B3C2A1D4CFB7ECE13C3",
                  "IMPHASH=1B0369A1E06271833F78FFA70FFB4EAF",
                  "IMPHASH=4C1B52A19748428E51B14C278D0F58E3",
                  "IMPHASH=4D927A711F77D62CEBD4F322CB57EC6F",
                  "IMPHASH=66EE036DF5FC1004D9ED5E9A94A1086A",
                  "IMPHASH=672B13F4A0B6F27D29065123FE882DFC",
                  "IMPHASH=6BBD59CEA665C4AFCC2814C1327EC91F",
                  "IMPHASH=725BB81DC24214F6ECACC0CFB36AD30D",
                  "IMPHASH=9528A0E91E28FBB88AD433FEABCA2456",
                  "IMPHASH=9DA6D5D77BE11712527DCAB86DF449A3",
                  "IMPHASH=A6E01BC1AB89F8D91D9EAB72032AAE88",
                  "IMPHASH=B24C5EDDAEA4FE50C6A96A2A133521E4",
                  "IMPHASH=D21BBC50DCC169D7B4D0F01962793154",
                  "IMPHASH=FCC251CCEAE90D22C392215CC9A2D5D6",
                  "IMPHASH=23867A89C2B8FC733BE6CF5EF902F2D1",
                  "IMPHASH=A37FF327F8D48E8A4D2F757E1B6E70BC",
                  "IMPHASH=F9A28C458284584A93B14216308D31BD",
                  "IMPHASH=6118619783FC175BC7EBECFF0769B46E",
                  "IMPHASH=959A83047E80AB68B368FDB3F4C6E4EA",
                  "IMPHASH=563233BFA169ACC7892451F71AD5850A",
                  "IMPHASH=87575CB7A0E0700EB37F2E3668671A08",
                  "IMPHASH=13F08707F759AF6003837A150A371BA1",
                  "IMPHASH=1781F06048A7E58B323F0B9259BE798B",
                  "IMPHASH=233F85F2D4BC9D6521A6CAAE11A1E7F5",
                  "IMPHASH=24AF2584CBF4D60BBE5C6D1B31B3BE6D",
                  "IMPHASH=632969DDF6DBF4E0F53424B75E4B91F2",
                  "IMPHASH=713C29B396B907ED71A72482759ED757",
                  "IMPHASH=749A7BB1F0B4C4455949C0B2BF7F9E9F",
                  "IMPHASH=8628B2608957A6B0C6330AC3DE28CE2E",
                  "IMPHASH=8B114550386E31895DFAB371E741123D",
                  "IMPHASH=94CB940A1A6B65BED4D5A8F849CE9793",
                  "IMPHASH=9D68781980370E00E0BD939EE5E6C141",
                  "IMPHASH=B18A1401FF8F444056D29450FBC0A6CE",
                  "IMPHASH=CB567F9498452721D77A451374955F5F",
                  "IMPHASH=730073214094CD328547BF1F72289752",
                  "IMPHASH=17B461A082950FC6332228572138B80C",
                  "IMPHASH=DC25EE78E2EF4D36FAA0BADF1E7461C9",
                  "IMPHASH=819B19D53CA6736448F9325A85736792",
                  "IMPHASH=829DA329CE140D873B4A8BDE2CBFAA7E",
                  "IMPHASH=C547F2E66061A8DFFB6F5A3FF63C0A74",
                  "IMPHASH=0588081AB0E63BA785938467E1B10CCA",
                  "IMPHASH=0D9EC08BAC6C07D9987DFD0F1506587C",
                  "IMPHASH=BC129092B71C89B4D4C8CDF8EA590B29",
                  "IMPHASH=4DA924CF622D039D58BCE71CDF05D242",
                  "IMPHASH=E7A3A5C377E2D29324093377D7DB1C66",
                  "IMPHASH=9A9DBEC5C62F0380B4FA5FD31DEFFEDF",
                  "IMPHASH=AF8A3976AD71E5D5FDFB67DDB8DADFCE",
                  "IMPHASH=0C477898BBF137BBD6F2A54E3B805FF4",
                  "IMPHASH=0CA9F02B537BCEA20D4EA5EB1A9FE338",
                  "IMPHASH=3AB3655E5A14D4EEFC547F4781BF7F9E",
                  "IMPHASH=E6F9D5152DA699934B30DAAB206471F6",
                  "IMPHASH=3AD59991CCF1D67339B319B15A41B35D",
                  "IMPHASH=FFDD59E0318B85A3E480874D9796D872",
                  "IMPHASH=0CF479628D7CC1EA25EC7998A92F5051",
                  "IMPHASH=07A2D4DCBD6CB2C6A45E6B101F0B6D51",
                  "IMPHASH=D6D0F80386E1380D05CB78E871BC72B1",
                  "IMPHASH=38D9E015591BBFD4929E0D0F47FA0055",
                  "IMPHASH=0E2216679CA6E1094D63322E3412D650",
                  "IMPHASH=ADA161BF41B8E5E9132858CB54CAB5FB",
                  "IMPHASH=2A1BC4913CD5ECB0434DF07CB675B798",
                  "IMPHASH=11083E75553BAAE21DC89CE8F9A195E4",
                  "IMPHASH=A23D29C9E566F2FA8FFBB79267F5DF80",
                  "IMPHASH=4A07F944A83E8A7C2525EFA35DD30E2F",
                  "IMPHASH=767637C23BB42CD5D7397CF58B0BE688",
                  "IMPHASH=14C4E4C72BA075E9069EE67F39188AD8",
                  "IMPHASH=3C782813D4AFCE07BBFC5A9772ACDBDC",
                  "IMPHASH=7D010C6BB6A3726F327F7E239166D127",
                  "IMPHASH=89159BA4DD04E4CE5559F132A9964EB3",
                  "IMPHASH=6F33F4A5FC42B8CEC7314947BD13F30F",
                  "IMPHASH=5834ED4291BDEB928270428EBBAF7604",
                  "IMPHASH=5A8A8A43F25485E7EE1B201EDCBC7A38",
                  "IMPHASH=DC7D30B90B2D8ABF664FBED2B1B59894",
                  "IMPHASH=41923EA1F824FE63EA5BEB84DB7A3E74",
                  "IMPHASH=3DE09703C8E79ED2CA3F01074719906B",
                  "IMPHASH=A53A02B997935FD8EEDCB5F7ABAB9B9F",
                  "IMPHASH=E96A73C7BF33A464C510EDE582318BF2",
                  "IMPHASH=32089B8851BBF8BC2D014E9F37288C83",
                  "IMPHASH=09D278F9DE118EF09163C6140255C690",
                  "IMPHASH=03866661686829d806989e2fc5a72606",
                  "IMPHASH=e57401fbdadcd4571ff385ab82bd5d6d",
                  "IMPHASH=84B763C45C0E4A3E7CA5548C710DB4EE",
                  "IMPHASH=19584675D94829987952432E018D5056",
                  "IMPHASH=330768A4F172E10ACB6287B87289D83B",
                  "IMPHASH=885C99CCFBE77D1CBFCB9C4E7C1A3313",
                  "IMPHASH=22A22BC9E4E0D2F189F1EA01748816AC",
                  "IMPHASH=7FA30E6BB7E8E8A69155636E50BF1B28",
                  "IMPHASH=96DF3A3731912449521F6F8D183279B1",
                  "IMPHASH=7E6CF3FF4576581271AC8A313B2AAB46",
                  "IMPHASH=51791678F351C03A0EB4E2A7B05C6E17",
                  "IMPHASH=25CE42B079282632708FC846129E98A5",
                  "IMPHASH=021BCCA20BA3381B11BDDE26B4E62F20",
                  "IMPHASH=59223B5F52D8799D38E0754855CBDF42",
                  "IMPHASH=81E75D8F1D276C156653D3D8813E4A43",
                  "IMPHASH=17244E8B6B8227E57FE709CCAD421420",
                  "IMPHASH=5B76DA3ACDEDC8A5CDF23A798B5936B4",
                  "IMPHASH=CB2B65BB77D995CC1C0E5DF1C860133C",
                  "IMPHASH=40445337761D80CF465136FAFB1F63E6",
                  "IMPHASH=8A790F401B29FA87BC1E56F7272B3AA6"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1564.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-08-24",
        "modified": "2024-11-23",
        "references": [
          "https://github.com/gentilkiwi/mimikatz",
          "https://github.com/topotam/PetitPotam",
          "https://github.com/ohpe/juicy-potato",
          "https://github.com/antonioCoco/RoguePotato",
          "https://www.tarasco.org/security/pwdump_7/",
          "https://github.com/fortra/nanodump",
          "https://github.com/codewhitesec/HandleKatz",
          "https://github.com/xuanxuan0/DripLoader",
          "https://github.com/hfiref0x/UACME",
          "https://github.com/outflanknl/Dumpert",
          "https://github.com/wavestone-cdt/EDRSandblast"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/create_stream_hash/create_stream_hash_hktl_generic_download.yml"
      }
    }
  ]
}