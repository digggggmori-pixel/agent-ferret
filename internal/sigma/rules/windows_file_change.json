{
  "metadata": {
    "logsource": "windows_file_change",
    "rule_count": 2,
    "compiled_at": "2026-02-04T12:28:36.374268",
    "version": "1.1"
  },
  "rules": [
    {
      "id": "558eebe5-f2ba-4104-b339-36f7902bcc1a",
      "title": "File Creation Date Changed to Another Year",
      "status": "test",
      "description": "Attackers may change the file creation time of a backdoor to make it look like it was installed with the operating system.\nNote that many processes legitimately change the creation time of a file; it does not necessarily indicate malicious activity.\n",
      "level": "high",
      "tags": [
        "attack.t1070.006",
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "file_change",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection1": {
            "type": "field_match",
            "matchers": {
              "PreviousCreationUtcTime__startswith": {
                "field": "PreviousCreationUtcTime",
                "value": "2022",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection2": {
            "type": "field_match",
            "matchers": {
              "PreviousCreationUtcTime__startswith": {
                "field": "PreviousCreationUtcTime",
                "value": "202",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "gen_filter_updates": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image": {
                    "field": "Image",
                    "value": [
                      "C:\\Windows\\system32\\ProvTool.exe",
                      "C:\\Windows\\System32\\usocoreworker.exe",
                      "C:\\Windows\\ImmersiveControlPanel\\SystemSettings.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "TargetFilename__startswith": {
                    "field": "TargetFilename",
                    "value": "C:\\ProgramData\\USOPrivate\\UpdateStore\\",
                    "modifiers": [
                      "startswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "TargetFilename__endswith": {
                    "field": "TargetFilename",
                    "value": [
                      ".tmp",
                      ".temp"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "gen_filter_tiworker": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\WINDOWS\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\TiWorker.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".cab",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter1": {
            "type": "field_match",
            "matchers": {
              "CreationUtcTime__startswith": {
                "field": "CreationUtcTime",
                "value": "2022",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter2": {
            "type": "field_match",
            "matchers": {
              "CreationUtcTime__startswith": {
                "field": "CreationUtcTime",
                "value": "202",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "(( selection1 and not filter1 ) or ( selection2 and not filter2 )) and not 1 of gen_filter*",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "(( selection1 and not filter1 )",
            "( selection2 and not filter2 )) and not 1 of gen_filter*"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1070.006"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113, Florian Roth (Nextron Systems)",
        "date": "2022-08-12",
        "modified": "2022-10-25",
        "references": [
          "https://www.inversecos.com/2022/04/defence-evasion-technique-timestomping.html"
        ],
        "falsepositives": [
          "Changes made to or by the local NTP service"
        ],
        "source_file": "sigma_rules/windows/file/file_change/file_change_win_2022_timestomping.yml"
      }
    },
    {
      "id": "9f383dc0-fdeb-4d56-acbc-9f9f4f8f20f3",
      "title": "Unusual File Modification by dns.exe",
      "status": "test",
      "description": "Detects an unexpected file being modified by dns.exe which my indicate activity related to remote code execution or other forms of exploitation as seen in CVE-2020-1350 (SigRed)",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.initial-access",
        "attack.t1133"
      ],
      "logsource": {
        "category": "file_change",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\dns.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "\\dns.log",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1133"
        ],
        "tactics": [
          "persistence",
          "initial_access"
        ]
      },
      "meta": {
        "author": "Tim Rauch (Nextron Systems), Elastic (idea)",
        "date": "2022-09-27",
        "modified": "",
        "references": [
          "https://www.elastic.co/guide/en/security/current/unusual-file-modification-by-dns-exe.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_change/file_change_win_unusual_modification_by_dns_exe.yml"
      }
    }
  ]
}