{
  "metadata": {
    "logsource": "windows_pipe_created",
    "rule_count": 17,
    "compiled_at": "2026-02-04T12:28:36.414076",
    "version": "1.1"
  },
  "rules": [
    {
      "id": "637f689e-b4a5-4a86-be0e-0100a0a33ba2",
      "title": "HackTool - EfsPotato Named Pipe Creation",
      "status": "test",
      "description": "Detects the pattern of a pipe name as used by the hack tool EfsPotato",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1055"
      ],
      "logsource": {
        "category": "pipe_created",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "PipeName__contains": {
                "field": "PipeName",
                "value": [
                  "\\pipe\\",
                  "\\pipe\\srvsvc"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_ctx": {
            "type": "field_match",
            "matchers": {
              "PipeName__contains": {
                "field": "PipeName",
                "value": "\\CtxShare",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_default": {
            "type": "field_match",
            "matchers": {
              "PipeName__startswith": {
                "field": "PipeName",
                "value": "\\pipe\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1055"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-08-23",
        "modified": "2023-12-21",
        "references": [
          "https://twitter.com/SBousseaden/status/1429530155291193354?s=20",
          "https://github.com/zcgonvh/EfsPotato"
        ],
        "falsepositives": [
          "\\pipe\\LOCAL\\Monitorian"
        ],
        "source_file": "sigma_rules/windows/pipe_created/pipe_created_hktl_efspotato.yml"
      }
    },
    {
      "id": "0adc67e0-a68f-4ffd-9c43-28905aad5d6a",
      "title": "HackTool - Koh Default Named Pipe",
      "status": "test",
      "description": "Detects creation of default named pipes used by the Koh tool",
      "level": "critical",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.credential-access",
        "attack.t1528",
        "attack.t1134.001"
      ],
      "logsource": {
        "category": "pipe_created",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "PipeName__contains": {
                "field": "PipeName",
                "value": [
                  "\\imposecost",
                  "\\imposingcost"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1528",
          "T1134.001"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation",
          "credential_access"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-07-08",
        "modified": "2023-08-07",
        "references": [
          "https://github.com/GhostPack/Koh/blob/0283d9f3f91cf74732ad377821986cfcb088e20a/Clients/BOF/KohClient.c#L12"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/pipe_created/pipe_created_hktl_koh_default_pipe.yml"
      }
    },
    {
      "id": "41504465-5e3a-4a5b-a5b4-2a0baadd4463",
      "title": "PsExec Tool Execution From Suspicious Locations - PipeName",
      "status": "test",
      "description": "Detects PsExec default pipe creation where the image executed is located in a suspicious location. Which could indicate that the tool is being used in an attack",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1569.002",
        "attack.s0029"
      ],
      "logsource": {
        "category": "pipe_created",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "PipeName": {
                "field": "PipeName",
                "value": "\\PSEXESVC",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Image__contains": {
                "field": "Image",
                "value": [
                  ":\\Users\\Public\\",
                  ":\\Windows\\Temp\\",
                  "\\AppData\\Local\\Temp\\",
                  "\\Desktop\\",
                  "\\Downloads\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1569.002"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-04",
        "modified": "2023-09-20",
        "references": [
          "https://www.jpcert.or.jp/english/pub/sr/ir_research.html",
          "https://jpcertcc.github.io/ToolAnalysisResultSheet"
        ],
        "falsepositives": [
          "Rare legitimate use of psexec from the locations mentioned above. This will require initial tuning based on your environment."
        ],
        "source_file": "sigma_rules/windows/pipe_created/pipe_created_sysinternals_psexec_default_pipe_susp_location.yml"
      }
    },
    {
      "id": "f6451de4-df0a-41fa-8d72-b39f54a08db5",
      "title": "PUA - PAExec Default Named Pipe",
      "status": "test",
      "description": "Detects PAExec default named pipe",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1569.002"
      ],
      "logsource": {
        "category": "pipe_created",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "PipeName__startswith": {
                "field": "PipeName",
                "value": "\\PAExec",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1569.002"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-10-26",
        "modified": "",
        "references": [
          "https://github.com/microsoft/Microsoft-365-Defender-Hunting-Queries/blob/efa17a600b43c897b4b7463cc8541daa1987eeb4/Command%20and%20Control/C2-NamedPipe.md",
          "https://github.com/poweradminllc/PAExec"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/pipe_created/pipe_created_pua_paexec_default_pipe.yml"
      }
    },
    {
      "id": "961d0ba2-3eea-4303-a930-2cf78bbfcc5e",
      "title": "HackTool - Credential Dumping Tools Named Pipe Created",
      "status": "test",
      "description": "Detects well-known credential dumping tools execution via specific named pipe creation",
      "level": "critical",
      "tags": [
        "attack.credential-access",
        "attack.t1003.001",
        "attack.t1003.002",
        "attack.t1003.004",
        "attack.t1003.005"
      ],
      "logsource": {
        "category": "pipe_created",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "PipeName__contains": {
                "field": "PipeName",
                "value": [
                  "\\cachedump",
                  "\\lsadump",
                  "\\wceservicepipe"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.001",
          "T1003.002",
          "T1003.004",
          "T1003.005"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Teymur Kheirkhabarov, oscd.community",
        "date": "2019-11-01",
        "modified": "2023-08-07",
        "references": [
          "https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment",
          "https://image.slidesharecdn.com/zeronights2017kheirkhabarov-171118103000/75/hunting-for-credentials-dumping-in-windows-environment-57-2048.jpg?cb=1666035799"
        ],
        "falsepositives": [
          "Legitimate Administrator using tool for password recovery"
        ],
        "source_file": "sigma_rules/windows/pipe_created/pipe_created_hktl_generic_cred_dump_tools_pipes.yml"
      }
    },
    {
      "id": "58cb02d5-78ce-4692-b3e1-dce850aae41a",
      "title": "Alternate PowerShell Hosts Pipe",
      "status": "test",
      "description": "Detects alternate PowerShell hosts potentially bypassing detections looking for powershell.exe",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "pipe_created",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "PipeName__startswith": {
                "field": "PipeName",
                "value": "\\PSHost",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_generic": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__contains": {
                    "field": "Image",
                    "value": [
                      ":\\Program Files\\PowerShell\\7-preview\\pwsh.exe",
                      ":\\Program Files\\PowerShell\\7\\pwsh.exe",
                      ":\\Windows\\system32\\dsac.exe",
                      ":\\Windows\\system32\\inetsrv\\w3wp.exe",
                      ":\\Windows\\System32\\sdiagnhost.exe",
                      ":\\Windows\\system32\\ServerManager.exe",
                      ":\\Windows\\system32\\wbem\\wmiprvse.exe",
                      ":\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell_ise.exe",
                      ":\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",
                      ":\\Windows\\System32\\wsmprovhost.exe",
                      ":\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell_ise.exe",
                      ":\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell.exe"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__contains_all": {
                    "field": "Image",
                    "value": [
                      "C:\\Program Files\\WindowsApps\\Microsoft.PowerShellPreview",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__contains_all": {
                    "field": "Image",
                    "value": [
                      "\\AppData\\Local\\Microsoft\\WindowsApps\\Microsoft.PowerShellPreview",
                      "\\pwsh.exe"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "filter_optional_sqlserver": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\",
                  "C:\\Program Files\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__contains": {
                "field": "Image",
                "value": "\\Microsoft SQL Server\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\Tools\\Binn\\SQLPS.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_azure_connected_machine_agent": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Program Files\\AzureConnectedMachineAgent\\GCArcService",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\GC\\gc_worker.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_citrix": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Program Files\\Citrix\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_exchange": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Program Files\\Microsoft\\Exchange Server\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_null": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez @Cyb3rWard0g, Tim Shelton",
        "date": "2019-09-12",
        "modified": "2025-10-07",
        "references": [
          "https://threathunterplaybook.com/hunts/windows/190610-PwshAlternateHosts/notebook.html",
          "https://threathunterplaybook.com/hunts/windows/190410-LocalPwshExecution/notebook.html"
        ],
        "falsepositives": [
          "Programs using PowerShell directly without invocation of a dedicated interpreter."
        ],
        "source_file": "sigma_rules/windows/pipe_created/pipe_created_powershell_alternate_host_pipe.yml"
      }
    },
    {
      "id": "1f7025a6-e747-4130-aac4-961eb47015f1",
      "title": "HackTool - DiagTrackEoP Default Named Pipe",
      "status": "test",
      "description": "Detects creation of default named pipe used by the DiagTrackEoP POC, a tool that abuses \"SeImpersonate\" privilege.",
      "level": "critical",
      "tags": [
        "attack.privilege-escalation"
      ],
      "logsource": {
        "category": "pipe_created",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "PipeName__contains": {
                "field": "PipeName",
                "value": "thisispipe",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-03",
        "modified": "2023-08-07",
        "references": [
          "https://github.com/Wh04m1001/DiagTrackEoP/blob/3a2fc99c9700623eb7dc7d4b5f314fd9ce5ef51f/main.cpp#L22"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/pipe_created/pipe_created_hktl_diagtrack_eop.yml"
      }
    },
    {
      "id": "d36f87ea-c403-44d2-aa79-1a0ac7c24456",
      "title": "PUA - RemCom Default Named Pipe",
      "status": "test",
      "description": "Detects default RemCom pipe creation",
      "level": "medium",
      "tags": [
        "attack.lateral-movement",
        "attack.t1021.002",
        "attack.execution",
        "attack.t1569.002"
      ],
      "logsource": {
        "category": "pipe_created",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "PipeName__contains": {
                "field": "PipeName",
                "value": "\\RemCom",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1021.002",
          "T1569.002"
        ],
        "tactics": [
          "lateral_movement",
          "execution"
        ]
      },
      "meta": {
        "author": "Nikita Nazarov, oscd.community, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-08-07",
        "modified": "2023-11-30",
        "references": [
          "https://drive.google.com/file/d/1lKya3_mLnR3UQuCoiYruO3qgu052_iS_/view",
          "https://github.com/kavika13/RemCom"
        ],
        "falsepositives": [
          "Legitimate Administrator activity"
        ],
        "source_file": "sigma_rules/windows/pipe_created/pipe_created_pua_remcom_default_pipe.yml"
      }
    },
    {
      "id": "0e7163d4-9e19-4fa7-9be6-000c61aad77a",
      "title": "CobaltStrike Named Pipe Pattern Regex",
      "status": "test",
      "description": "Detects the creation of a named pipe matching a pattern used by CobaltStrike Malleable C2 profiles",
      "level": "critical",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1055"
      ],
      "logsource": {
        "category": "pipe_created",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "PipeName__re": {
                    "field": "PipeName",
                    "value": "\\\\mojo\\.5688\\.8052\\.(?:183894939787088877|35780273329370473)[0-9a-f]{2}",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "PipeName__re": {
                    "field": "PipeName",
                    "value": "\\\\wkssvc_?[0-9a-f]{2}",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "PipeName__re": {
                    "field": "PipeName",
                    "value": "\\\\ntsvcs[0-9a-f]{2}",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "PipeName__re": {
                    "field": "PipeName",
                    "value": "\\\\DserNamePipe[0-9a-f]{2}",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "PipeName__re": {
                    "field": "PipeName",
                    "value": "\\\\SearchTextHarvester[0-9a-f]{2}",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "PipeName__re": {
                    "field": "PipeName",
                    "value": "\\\\mypipe-(?:f|h)[0-9a-f]{2}",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "PipeName__re": {
                    "field": "PipeName",
                    "value": "\\\\windows\\.update\\.manager[0-9a-f]{2,3}",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "PipeName__re": {
                    "field": "PipeName",
                    "value": "\\\\ntsvcs_[0-9a-f]{2}",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "PipeName__re": {
                    "field": "PipeName",
                    "value": "\\\\scerpc_?[0-9a-f]{2}",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "PipeName__re": {
                    "field": "PipeName",
                    "value": "\\\\PGMessagePipe[0-9a-f]{2}",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "PipeName__re": {
                    "field": "PipeName",
                    "value": "\\\\MsFteWds[0-9a-f]{2}",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "PipeName__re": {
                    "field": "PipeName",
                    "value": "\\\\f4c3[0-9a-f]{2}",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "PipeName__re": {
                    "field": "PipeName",
                    "value": "\\\\fullduplex_[0-9a-f]{2}",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "PipeName__re": {
                    "field": "PipeName",
                    "value": "\\\\msrpc_[0-9a-f]{4}",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "PipeName__re": {
                    "field": "PipeName",
                    "value": "\\\\win\\\\msrpc_[0-9a-f]{2}",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "PipeName__re": {
                    "field": "PipeName",
                    "value": "\\\\f53f[0-9a-f]{2}",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "PipeName__re": {
                    "field": "PipeName",
                    "value": "\\\\rpc_[0-9a-f]{2}",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "PipeName__re": {
                    "field": "PipeName",
                    "value": "\\\\spoolss_[0-9a-f]{2}",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "PipeName__re": {
                    "field": "PipeName",
                    "value": "\\\\Winsock2\\\\CatalogChangeListener-[0-9a-f]{3}-0,",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1055"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-07-30",
        "modified": "2022-12-31",
        "references": [
          "https://svch0st.medium.com/guide-to-named-pipes-and-hunting-for-cobalt-strike-pipes-dc46b2c5f575",
          "https://gist.github.com/MHaggis/6c600e524045a6d49c35291a21e10752"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/pipe_created/pipe_created_hktl_cobaltstrike_re.yml"
      }
    },
    {
      "id": "ac7102b4-9e1e-4802-9b4f-17c5524c015c",
      "title": "New PowerShell Instance Created",
      "status": "test",
      "description": "Detects the execution of PowerShell via the creation of a named pipe starting with PSHost",
      "level": "informational",
      "tags": [
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "pipe_created",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "PipeName__startswith": {
                "field": "PipeName",
                "value": "\\PSHost",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
        "date": "2019-09-12",
        "modified": "2023-11-30",
        "references": [
          "https://threathunterplaybook.com/hunts/windows/190610-PwshAlternateHosts/notebook.html",
          "https://threathunterplaybook.com/hunts/windows/190410-LocalPwshExecution/notebook.html"
        ],
        "falsepositives": [
          "Likely"
        ],
        "source_file": "sigma_rules/windows/pipe_created/pipe_created_powershell_execution_pipe.yml"
      }
    },
    {
      "id": "85adeb13-4fc9-4e68-8a4a-c7cb2c336eb7",
      "title": "CobaltStrike Named Pipe Patterns",
      "status": "test",
      "description": "Detects the creation of a named pipe with a pattern found in CobaltStrike malleable C2 profiles",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1055",
        "stp.1k"
      ],
      "logsource": {
        "category": "pipe_created",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_malleable_profile_generic": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "PipeName__startswith": {
                    "field": "PipeName",
                    "value": [
                      "\\DserNamePipe",
                      "\\f4c3",
                      "\\f53f",
                      "\\fullduplex_",
                      "\\mojo.5688.8052.183894939787088877",
                      "\\mojo.5688.8052.35780273329370473",
                      "\\MsFteWds",
                      "\\msrpc_",
                      "\\mypipe-f",
                      "\\mypipe-h",
                      "\\ntsvcs",
                      "\\PGMessagePipe",
                      "\\rpc_",
                      "\\scerpc",
                      "\\SearchTextHarvester",
                      "\\spoolss",
                      "\\win_svc",
                      "\\win\\msrpc_",
                      "\\windows.update.manager",
                      "\\wkssvc"
                    ],
                    "modifiers": [
                      "startswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "PipeName": {
                    "field": "PipeName",
                    "value": [
                      "\\demoagent_11",
                      "\\demoagent_22"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_malleable_profile_catalog_change_listener": {
            "type": "field_match",
            "matchers": {
              "PipeName__startswith": {
                "field": "PipeName",
                "value": "\\Winsock2\\CatalogChangeListener-",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "PipeName__endswith": {
                "field": "PipeName",
                "value": "-0,",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_generic": {
            "type": "field_match",
            "matchers": {
              "PipeName": {
                "field": "PipeName",
                "value": [
                  "\\wkssvc",
                  "\\spoolss",
                  "\\scerpc",
                  "\\ntsvcs",
                  "\\SearchTextHarvester",
                  "\\PGMessagePipe",
                  "\\MsFteWds"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_websense": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  ":\\Program Files\\Websense\\",
                  ":\\Program Files (x86)\\Websense\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "PipeName__startswith": {
                "field": "PipeName",
                "value": [
                  "\\DserNamePipeR",
                  "\\DserNamePipeW"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "1 of selection_malleable_profile_* and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "1 of selection_malleable_profile_*"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1055"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Christian Burkard (Nextron Systems)",
        "date": "2021-07-30",
        "modified": "2024-01-26",
        "references": [
          "https://svch0st.medium.com/guide-to-named-pipes-and-hunting-for-cobalt-strike-pipes-dc46b2c5f575",
          "https://gist.github.com/MHaggis/6c600e524045a6d49c35291a21e10752"
        ],
        "falsepositives": [
          "Chrome instances using the exact same pipe name \"mojo.xxx\"",
          "Websense Endpoint using the pipe name \"DserNamePipe(R|W)\\d{1,5}\""
        ],
        "source_file": "sigma_rules/windows/pipe_created/pipe_created_hktl_cobaltstrike_susp_pipe_patterns.yml"
      }
    },
    {
      "id": "d5601f8c-b26f-4ab0-9035-69e11a8d4ad2",
      "title": "CobaltStrike Named Pipe",
      "status": "test",
      "description": "Detects the creation of a named pipe as used by CobaltStrike",
      "level": "critical",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1055"
      ],
      "logsource": {
        "category": "pipe_created",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_MSSE": {
            "type": "field_match",
            "matchers": {
              "PipeName__contains_all": {
                "field": "PipeName",
                "value": [
                  "\\MSSE-",
                  "-server"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_postex": {
            "type": "field_match",
            "matchers": {
              "PipeName__startswith": {
                "field": "PipeName",
                "value": "\\postex_",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_status": {
            "type": "field_match",
            "matchers": {
              "PipeName__startswith": {
                "field": "PipeName",
                "value": "\\status_",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_msagent": {
            "type": "field_match",
            "matchers": {
              "PipeName__startswith": {
                "field": "PipeName",
                "value": "\\msagent_",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_mojo": {
            "type": "field_match",
            "matchers": {
              "PipeName__startswith": {
                "field": "PipeName",
                "value": "\\mojo_",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_interprocess": {
            "type": "field_match",
            "matchers": {
              "PipeName__startswith": {
                "field": "PipeName",
                "value": "\\interprocess_",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_samr": {
            "type": "field_match",
            "matchers": {
              "PipeName__startswith": {
                "field": "PipeName",
                "value": "\\samr_",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_netlogon": {
            "type": "field_match",
            "matchers": {
              "PipeName__startswith": {
                "field": "PipeName",
                "value": "\\netlogon_",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_srvsvc": {
            "type": "field_match",
            "matchers": {
              "PipeName__startswith": {
                "field": "PipeName",
                "value": "\\srvsvc_",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_lsarpc": {
            "type": "field_match",
            "matchers": {
              "PipeName__startswith": {
                "field": "PipeName",
                "value": "\\lsarpc_",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_wkssvc": {
            "type": "field_match",
            "matchers": {
              "PipeName__startswith": {
                "field": "PipeName",
                "value": "\\wkssvc_",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1055"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Wojciech Lesicki",
        "date": "2021-05-25",
        "modified": "2022-10-31",
        "references": [
          "https://twitter.com/d4rksystem/status/1357010969264873472",
          "https://labs.f-secure.com/blog/detecting-cobalt-strike-default-modules-via-named-pipe-analysis/",
          "https://github.com/SigmaHQ/sigma/issues/253",
          "https://blog.cobaltstrike.com/2021/02/09/learn-pipe-fitting-for-all-of-your-offense-projects/",
          "https://redcanary.com/threat-detection-report/threats/cobalt-strike/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/pipe_created/pipe_created_hktl_cobaltstrike.yml"
      }
    },
    {
      "id": "f318b911-ea88-43f4-9281-0de23ede628e",
      "title": "PUA - CSExec Default Named Pipe",
      "status": "test",
      "description": "Detects default CSExec pipe creation",
      "level": "medium",
      "tags": [
        "attack.lateral-movement",
        "attack.t1021.002",
        "attack.execution",
        "attack.t1569.002"
      ],
      "logsource": {
        "category": "pipe_created",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "PipeName__contains": {
                "field": "PipeName",
                "value": "\\csexecsvc",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1021.002",
          "T1569.002"
        ],
        "tactics": [
          "lateral_movement",
          "execution"
        ]
      },
      "meta": {
        "author": "Nikita Nazarov, oscd.community, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-08-07",
        "modified": "2023-11-30",
        "references": [
          "https://drive.google.com/file/d/1lKya3_mLnR3UQuCoiYruO3qgu052_iS_/view",
          "https://github.com/malcomvetter/CSExec"
        ],
        "falsepositives": [
          "Legitimate Administrator activity"
        ],
        "source_file": "sigma_rules/windows/pipe_created/pipe_created_pua_csexec_default_pipe.yml"
      }
    },
    {
      "id": "493fb4ab-cdcc-4c4f-818c-0e363bd1e4bb",
      "title": "WMI Event Consumer Created Named Pipe",
      "status": "test",
      "description": "Detects the WMI Event Consumer service scrcons.exe creating a named pipe",
      "level": "medium",
      "tags": [
        "attack.t1047",
        "attack.execution"
      ],
      "logsource": {
        "category": "pipe_created",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\scrcons.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1047"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-09-01",
        "modified": "2023-11-30",
        "references": [
          "https://github.com/RiccardoAncarani/LiquidSnake"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/pipe_created/pipe_created_scrcons_wmi_consumer_namedpipe.yml"
      }
    },
    {
      "id": "4d0083b3-580b-40da-9bba-626c19fe4033",
      "title": "HackTool - CoercedPotato Named Pipe Creation",
      "status": "test",
      "description": "Detects the pattern of a pipe name as used by the hack tool CoercedPotato",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1055"
      ],
      "logsource": {
        "category": "pipe_created",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "PipeName__contains": {
                "field": "PipeName",
                "value": "\\coerced\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1055"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2023-10-11",
        "modified": "",
        "references": [
          "https://blog.hackvens.fr/articles/CoercedPotato.html",
          "https://github.com/hackvens/CoercedPotato"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/pipe_created/pipe_created_hktl_coercedpotato.yml"
      }
    },
    {
      "id": "fe3ac066-98bb-432a-b1e7-a5229cb39d4a",
      "title": "Malicious Named Pipe Created",
      "status": "test",
      "description": "Detects the creation of a named pipe seen used by known APTs or malware.",
      "level": "critical",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1055"
      ],
      "logsource": {
        "category": "pipe_created",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "PipeName": {
                "field": "PipeName",
                "value": [
                  "\\46a676ab7f179e511e30dd2dc41bd388",
                  "\\583da945-62af-10e8-4902-a8f205c72b2e",
                  "\\6e7645c4-32c5-4fe3-aabf-e94c2f4370e7",
                  "\\9f81f59bc58452127884ce513865ed20",
                  "\\adschemerpc",
                  "\\ahexec",
                  "\\AnonymousPipe",
                  "\\bc31a7",
                  "\\bc367",
                  "\\bizkaz",
                  "\\csexecsvc",
                  "\\dce_3d",
                  "\\e710f28d59aa529d6792ca6ff0ca1b34",
                  "\\gruntsvc",
                  "\\isapi_dg",
                  "\\isapi_dg2",
                  "\\isapi_http",
                  "\\jaccdpqnvbrrxlaf",
                  "\\lsassw",
                  "\\NamePipe_MoreWindows",
                  "\\pcheap_reuse",
                  "\\Posh*",
                  "\\rpchlp_3",
                  "\\sdlrpc",
                  "\\svcctl",
                  "\\testPipe",
                  "\\winsession"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1055"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), blueteam0ps, elhoim",
        "date": "2017-11-06",
        "modified": "2023-08-07",
        "references": [
          "https://securelist.com/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/71275/",
          "https://securelist.com/faq-the-projectsauron-apt/75533/",
          "https://web.archive.org/web/20180725233601/https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf",
          "https://www.us-cert.gov/ncas/alerts/TA17-117A",
          "https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html",
          "https://thedfirreport.com/2020/06/21/snatch-ransomware/",
          "https://github.com/RiccardoAncarani/LiquidSnake",
          "https://www.accenture.com/us-en/blogs/cyber-defense/turla-belugasturgeon-compromises-government-entity",
          "https://us-cert.cisa.gov/ncas/analysis-reports/ar19-304a",
          "https://download.bitdefender.com/resources/files/News/CaseStudies/study/115/Bitdefender-Whitepaper-PAC-A4-en-EN1.pdf",
          "https://unit42.paloaltonetworks.com/emissary-panda-attacks-middle-east-government-sharepoint-servers/",
          "https://thedfirreport.com/2022/02/21/qbot-and-zerologon-lead-to-full-domain-compromise/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/pipe_created/pipe_created_susp_malicious_namedpipes.yml"
      }
    },
    {
      "id": "1ea13e8c-03ea-409b-877d-ce5c3d2c1cb3",
      "title": "ADFS Database Named Pipe Connection By Uncommon Tool",
      "status": "test",
      "description": "Detects suspicious local connections via a named pipe to the AD FS configuration database (Windows Internal Database).\nUsed to access information such as the AD FS configuration settings which contains sensitive information used to sign SAML tokens.\n",
      "level": "medium",
      "tags": [
        "attack.collection",
        "attack.t1005"
      ],
      "logsource": {
        "category": "pipe_created",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "PipeName": {
                "field": "PipeName",
                "value": "\\MICROSOFT##WID\\tsql\\query",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_generic": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  ":\\Windows\\System32\\mmc.exe",
                  ":\\Windows\\system32\\svchost.exe",
                  ":\\Windows\\System32\\wsmprovhost.exe",
                  ":\\Windows\\SysWOW64\\mmc.exe",
                  ":\\Windows\\SysWOW64\\wsmprovhost.exe",
                  ":\\Windows\\WID\\Binn\\sqlwriter.exe",
                  "\\AzureADConnect.exe",
                  "\\Microsoft.Identity.Health.Adfs.PshSurrogate.exe",
                  "\\Microsoft.IdentityServer.ServiceHost.exe",
                  "\\Microsoft.Tri.Sensor.exe",
                  "\\sqlservr.exe",
                  "\\tssdis.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1005"
        ],
        "tactics": [
          "collection"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez @Cyb3rWard0g",
        "date": "2021-10-08",
        "modified": "2023-11-30",
        "references": [
          "https://github.com/Azure/Azure-Sentinel/blob/f99542b94afe0ad2f19a82cc08262e7ac8e1428e/Detections/SecurityEvent/ADFSDBNamedPipeConnection.yaml",
          "https://o365blog.com/post/adfs/",
          "https://github.com/Azure/SimuLand"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/pipe_created/pipe_created_adfs_namedpipe_connection_uncommon_tool.yml"
      }
    }
  ]
}