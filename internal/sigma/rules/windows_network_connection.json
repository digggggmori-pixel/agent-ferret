{
  "metadata": {
    "logsource": "windows_network_connection",
    "rule_count": 51,
    "compiled_at": "2026-02-04T12:28:36.406203",
    "version": "1.1"
  },
  "rules": [
    {
      "id": "297ae038-edc2-4b2e-bb3e-7c5fc94dd5c7",
      "title": "New Connection Initiated To Potential Dead Drop Resolver Domain",
      "status": "test",
      "description": "Detects an executable, which is not an internet browser or known application, initiating network connections to legit popular websites, which were seen to be used as dead drop resolvers in previous attacks.\nIn this context attackers leverage known websites such as \"facebook\", \"youtube\", etc. In order to pass through undetected.\n",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1102",
        "attack.t1102.001"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "DestinationHostname__endswith": {
                "field": "DestinationHostname",
                "value": [
                  ".t.me",
                  "4shared.com",
                  "abuse.ch",
                  "anonfiles.com",
                  "cdn.discordapp.com",
                  "cloudflare.com",
                  "ddns.net",
                  "discord.com",
                  "docs.google.com",
                  "drive.google.com",
                  "dropbox.com",
                  "dropmefiles.com",
                  "facebook.com",
                  "feeds.rapidfeeds.com",
                  "fotolog.com",
                  "ghostbin.co/",
                  "githubusercontent.com",
                  "gofile.io",
                  "hastebin.com",
                  "imgur.com",
                  "livejournal.com",
                  "mediafire.com",
                  "mega.co.nz",
                  "mega.nz",
                  "onedrive.com",
                  "pages.dev",
                  "paste.ee",
                  "pastebin.com",
                  "pastebin.pl",
                  "pastetext.net",
                  "pixeldrain.com",
                  "privatlab.com",
                  "privatlab.net",
                  "reddit.com",
                  "send.exploit.in",
                  "sendspace.com",
                  "steamcommunity.com",
                  "storage.googleapis.com",
                  "technet.microsoft.com",
                  "temp.sh",
                  "transfer.sh",
                  "trycloudflare.com",
                  "twitter.com",
                  "ufile.io",
                  "vimeo.com",
                  "w3spaces.com",
                  "wetransfer.com",
                  "workers.dev",
                  "youtube.com"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_chrome": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe",
                  "C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_chrome_appdata": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Users\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\AppData\\Local\\Google\\Chrome\\Application\\chrome.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_firefox": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Mozilla Firefox\\firefox.exe",
                  "C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_firefox_appdata": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Users\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\AppData\\Local\\Mozilla Firefox\\firefox.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_ie": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe",
                  "C:\\Program Files\\Internet Explorer\\iexplore.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_edge_1": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__startswith": {
                    "field": "Image",
                    "value": "C:\\Program Files (x86)\\Microsoft\\EdgeWebView\\Application\\",
                    "modifiers": [
                      "startswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\WindowsApps\\MicrosoftEdge.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image": {
                    "field": "Image",
                    "value": [
                      "C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe",
                      "C:\\Program Files\\Microsoft\\Edge\\Application\\msedge.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "filter_main_edge_2": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\Microsoft\\EdgeCore\\",
                  "C:\\Program Files\\Microsoft\\EdgeCore\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\msedge.exe",
                  "\\msedgewebview2.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_safari": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\Safari\\",
                  "C:\\Program Files\\Safari\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\safari.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_defender": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Windows Defender Advanced Threat Protection\\",
                  "C:\\Program Files\\Windows Defender\\",
                  "C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\MsMpEng.exe",
                  "\\MsSense.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_prtg": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\PRTG Network Monitor\\PRTG Probe.exe",
                  "C:\\Program Files\\PRTG Network Monitor\\PRTG Probe.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_brave": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Program Files\\BraveSoftware\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\brave.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_maxthon": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": "\\AppData\\Local\\Maxthon\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\maxthon.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_opera": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": "\\AppData\\Local\\Programs\\Opera\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\opera.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_seamonkey": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\SeaMonkey\\",
                  "C:\\Program Files (x86)\\SeaMonkey\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\seamonkey.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_vivaldi": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": "\\AppData\\Local\\Vivaldi\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\vivaldi.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_whale": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Naver\\Naver Whale\\",
                  "C:\\Program Files (x86)\\Naver\\Naver Whale\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\whale.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_whaterfox": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Waterfox\\",
                  "C:\\Program Files (x86)\\Waterfox\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\Waterfox.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_midori": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": "\\AppData\\Local\\Programs\\midori-ng\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\Midori Next Generation.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_slimbrowser": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\SlimBrowser\\",
                  "C:\\Program Files (x86)\\SlimBrowser\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\slimbrowser.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_flock": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": "\\AppData\\Local\\Flock\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\Flock.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_phoebe": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": "\\AppData\\Local\\Phoebe\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\Phoebe.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_falkon": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Falkon\\",
                  "C:\\Program Files (x86)\\Falkon\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\falkon.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_qtweb": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\QtWeb\\",
                  "C:\\Program Files\\QtWeb\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\QtWeb.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_avant": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\Avant Browser\\",
                  "C:\\Program Files\\Avant Browser\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\avant.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_whatsapp": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\WindowsApps\\",
                  "C:\\Program Files\\WindowsApps\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\WhatsApp.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "DestinationHostname__endswith": {
                "field": "DestinationHostname",
                "value": "facebook.com",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_telegram": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": "\\AppData\\Roaming\\Telegram Desktop\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\Telegram.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "DestinationHostname__endswith": {
                "field": "DestinationHostname",
                "value": ".t.me",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_onedrive": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": "\\AppData\\Local\\Microsoft\\OneDrive\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\OneDrive.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "DestinationHostname__endswith": {
                "field": "DestinationHostname",
                "value": "onedrive.com",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_dropbox": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\Dropbox\\Client\\",
                  "C:\\Program Files\\Dropbox\\Client\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\Dropbox.exe",
                  "\\DropboxInstaller.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "DestinationHostname__endswith": {
                "field": "DestinationHostname",
                "value": "dropbox.com",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_mega": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\MEGAsync.exe",
                  "\\MEGAsyncSetup32_*RC.exe",
                  "\\MEGAsyncSetup32.exe",
                  "\\MEGAsyncSetup64.exe",
                  "\\MEGAupdater.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "DestinationHostname__endswith": {
                "field": "DestinationHostname",
                "value": [
                  "mega.co.nz",
                  "mega.nz"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_googledrive": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Google\\Drive File Stream\\",
                  "C:\\Program Files (x86)\\Google\\Drive File Stream\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "GoogleDriveFS.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "DestinationHostname__endswith": {
                "field": "DestinationHostname",
                "value": "drive.google.com",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_discord": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": "\\AppData\\Local\\Discord\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\Discord.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "DestinationHostname__endswith": {
                "field": "DestinationHostname",
                "value": [
                  "discord.com",
                  "cdn.discordapp.com"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_null": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_empty": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1102",
          "T1102.001"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Sorina Ionescu, X__Junior (Nextron Systems)",
        "date": "2022-08-17",
        "modified": "2024-10-21",
        "references": [
          "https://web.archive.org/web/20220830134315/https://content.fireeye.com/apt-41/rpt-apt41/",
          "https://securelist.com/the-tetrade-brazilian-banking-malware/97779/",
          "https://blog.bushidotoken.net/2021/04/dead-drop-resolvers-espionage-inspired.html",
          "https://github.com/kleiton0x00/RedditC2",
          "https://twitter.com/kleiton0x7e/status/1600567316810551296",
          "https://www.linkedin.com/posts/kleiton-kurti_github-kleiton0x00redditc2-abusing-reddit-activity-7009939662462984192-5DbI/?originalSubdomain=al"
        ],
        "falsepositives": [
          "One might need to exclude other internet browsers found in it's network or other applications like ones mentioned above from Microsoft Defender.",
          "Ninite contacting githubusercontent.com"
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_domain_dead_drop_resolvers.yml"
      }
    },
    {
      "id": "efafe0bf-4238-479e-af8f-797bd3490d2d",
      "title": "Outbound Network Connection Initiated By Cmstp.EXE",
      "status": "test",
      "description": "Detects a network connection initiated by Cmstp.EXE\nIts uncommon for \"cmstp.exe\" to initiate an outbound network connection. Investigate the source of such requests to determine if they are malicious.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.003"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\cmstp.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_local_ranges": {
            "type": "field_match",
            "matchers": {
              "DestinationIp__cidr": {
                "field": "DestinationIp",
                "value": [
                  "127.0.0.0/8",
                  "10.0.0.0/8",
                  "172.16.0.0/12",
                  "192.168.0.0/16",
                  "169.254.0.0/16",
                  "::1/128",
                  "fe80::/10",
                  "fc00::/7"
                ],
                "modifiers": [
                  "cidr"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218.003"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-30",
        "modified": "2024-05-31",
        "references": [
          "https://web.archive.org/web/20190720093911/http://www.endurant.io/cmstp/detecting-cmstp-enabled-code-execution-and-uac-bypass-with-sysmon/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_cmstp_initiated_connection.yml"
      }
    },
    {
      "id": "b3ad3c0f-c949-47a1-a30e-b0491ccae876",
      "title": "Uncommon Connection to Active Directory Web Services",
      "status": "test",
      "description": "Detects uncommon network connections to the Active Directory Web Services (ADWS) from processes not typically associated with ADWS management.\n",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.t1087"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Initiated": {
                "field": "Initiated",
                "value": true,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "DestinationPort": {
                "field": "DestinationPort",
                "value": 9389,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_dsac": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\system32\\dsac.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_ms_monitoring_agent": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Program Files\\Microsoft Monitoring Agent\\",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_powershell": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\PowerShell\\7\\pwsh.exe",
                  "C:\\Program Files\\PowerShell\\7-preview\\pwsh.ex",
                  "C:\\Windows\\System32\\WindowsPowerShell\\",
                  "C:\\Windows\\SysWOW64\\WindowsPowerShell\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1087"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "@kostastsale",
        "date": "2024-01-26",
        "modified": "",
        "references": [
          "https://medium.com/falconforce/soaphound-tool-to-collect-active-directory-data-via-adws-165aca78288c",
          "https://github.com/FalconForceTeam/FalconFriday/blob/a9219dfcfd89836f34660223f47d766982bdce46/Discovery/ADWS_Connection_from_Unexpected_Binary-Win.md"
        ],
        "falsepositives": [
          "ADWS is used by a number of legitimate applications that need to interact with Active Directory. These applications should be added to the allow-listing to avoid false positives."
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_adws_unusual_connection.yml"
      }
    },
    {
      "id": "0dba975d-a193-4ed1-a067-424df57570d1",
      "title": "Uncommon Network Connection Initiated By Certutil.EXE",
      "status": "test",
      "description": "Detects a network connection initiated by the certutil.exe utility.\nAttackers can abuse the utility in order to download malware or additional payloads.\n",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1105"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\certutil.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "DestinationPort": {
                "field": "DestinationPort",
                "value": [
                  80,
                  135,
                  443,
                  445
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1105"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "frack113, Florian Roth (Nextron Systems)",
        "date": "2022-09-02",
        "modified": "2024-05-31",
        "references": [
          "https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/certutil"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_certutil_initiated_connection.yml"
      }
    },
    {
      "id": "786cdae8-fefb-4eb2-9227-04e34060db01",
      "title": "Suspicious Wordpad Outbound Connections",
      "status": "test",
      "description": "Detects a network connection initiated by \"wordpad.exe\" over uncommon destination ports.\nThis might indicate potential process injection activity from a beacon or similar mechanisms.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.command-and-control"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\wordpad.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_ports": {
            "type": "field_match",
            "matchers": {
              "DestinationPort": {
                "field": "DestinationPort",
                "value": [
                  80,
                  139,
                  443,
                  445,
                  465,
                  587,
                  993,
                  995
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion",
          "command_and_control"
        ]
      },
      "meta": {
        "author": "X__Junior (Nextron Systems)",
        "date": "2023-07-12",
        "modified": "2023-12-15",
        "references": [
          "https://blogs.blackberry.com/en/2023/07/romcom-targets-ukraine-nato-membership-talks-at-nato-summit"
        ],
        "falsepositives": [
          "Other ports can be used, apply additional filters accordingly"
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_wordpad_uncommon_ports.yml"
      }
    },
    {
      "id": "5205613d-2a63-4412-a895-3a2458b587b3",
      "title": "Network Connection Initiated By AddinUtil.EXE",
      "status": "test",
      "description": "Detects a network connection initiated by the Add-In deployment cache updating utility \"AddInutil.exe\".\nThis could indicate a potential command and control communication as this tool doesn't usually initiate network activity.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\addinutil.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Michael McKinley (@McKinleyMike), Tony Latteri (@TheLatteri)",
        "date": "2023-09-18",
        "modified": "2024-07-16",
        "references": [
          "https://www.blue-prints.blog/content/blog/posts/lolbin/addinutil-lolbas.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_addinutil_initiated.yml"
      }
    },
    {
      "id": "2fdaf50b-9fd5-449f-ba69-f17248119af6",
      "title": "Network Connection Initiated via Finger.EXE",
      "status": "experimental",
      "description": "Detects network connections via finger.exe, which can be abused by threat actors to retrieve remote commands for execution on Windows devices.\nIn one ClickFix malware campaign, adversaries leveraged the finger protocol to fetch commands from a remote server.\nSince the finger utility is not commonly used in modern Windows environments, its presence already raises suspicion.\nInvestigating such network connections can also help identify potential malicious infrastructure used by threat actors\n",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1071.004",
        "attack.execution",
        "attack.t1059.003"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\finger.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1071.004",
          "T1059.003"
        ],
        "tactics": [
          "command_and_control",
          "execution"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-11-19",
        "modified": "",
        "references": [
          "https://www.bleepingcomputer.com/news/security/decades-old-finger-protocol-abused-in-clickfix-malware-attacks/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_finger.yml"
      }
    },
    {
      "id": "5c80b618-0dbb-46e6-acbb-03d90bcb6d83",
      "title": "Network Connection Initiated To AzureWebsites.NET By Non-Browser Process",
      "status": "test",
      "description": "Detects an initiated network connection by a non browser process on the system to \"azurewebsites.net\". The latter was often used by threat actors as a malware hosting and exfiltration site.\n",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1102",
        "attack.t1102.001"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "DestinationHostname__endswith": {
                "field": "DestinationHostname",
                "value": "azurewebsites.net",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_chrome": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe",
                  "C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_chrome_appdata": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Users\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\AppData\\Local\\Google\\Chrome\\Application\\chrome.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_firefox": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Mozilla Firefox\\firefox.exe",
                  "C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_firefox_appdata": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Users\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\AppData\\Local\\Mozilla Firefox\\firefox.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_ie": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe",
                  "C:\\Program Files\\Internet Explorer\\iexplore.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_edge_1": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__startswith": {
                    "field": "Image",
                    "value": "C:\\Program Files (x86)\\Microsoft\\EdgeWebView\\Application\\",
                    "modifiers": [
                      "startswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\WindowsApps\\MicrosoftEdge.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image": {
                    "field": "Image",
                    "value": [
                      "C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe",
                      "C:\\Program Files\\Microsoft\\Edge\\Application\\msedge.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "filter_main_edge_2": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\Microsoft\\EdgeCore\\",
                  "C:\\Program Files\\Microsoft\\EdgeCore\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\msedge.exe",
                  "\\msedgewebview2.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_safari": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\Safari\\",
                  "C:\\Program Files\\Safari\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\safari.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_defender": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Windows Defender Advanced Threat Protection\\",
                  "C:\\Program Files\\Windows Defender\\",
                  "C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\MsMpEng.exe",
                  "\\MsSense.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_prtg": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\PRTG Network Monitor\\PRTG Probe.exe",
                  "C:\\Program Files\\PRTG Network Monitor\\PRTG Probe.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_brave": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Program Files\\BraveSoftware\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\brave.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_maxthon": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": "\\AppData\\Local\\Maxthon\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\maxthon.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_opera": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": "\\AppData\\Local\\Programs\\Opera\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\opera.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_seamonkey": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\SeaMonkey\\",
                  "C:\\Program Files (x86)\\SeaMonkey\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\seamonkey.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_vivaldi": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": "\\AppData\\Local\\Vivaldi\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\vivaldi.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_whale": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Naver\\Naver Whale\\",
                  "C:\\Program Files (x86)\\Naver\\Naver Whale\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\whale.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_whaterfox": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Waterfox\\",
                  "C:\\Program Files (x86)\\Waterfox\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\Waterfox.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_slimbrowser": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\SlimBrowser\\",
                  "C:\\Program Files (x86)\\SlimBrowser\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\slimbrowser.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_flock": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": "\\AppData\\Local\\Flock\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\Flock.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_phoebe": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": "\\AppData\\Local\\Phoebe\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\Phoebe.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_falkon": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Falkon\\",
                  "C:\\Program Files (x86)\\Falkon\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\falkon.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_qtweb": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\QtWeb\\",
                  "C:\\Program Files\\QtWeb\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\QtWeb.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_avant": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\Avant Browser\\",
                  "C:\\Program Files\\Avant Browser\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\avant.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_discord": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": "\\AppData\\Local\\Discord\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\Discord.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_null": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_empty": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1102",
          "T1102.001"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2024-06-24",
        "modified": "2024-07-16",
        "references": [
          "https://www.sentinelone.com/labs/wip26-espionage-threat-actors-abuse-cloud-infrastructure-in-targeted-telco-attacks/",
          "https://symantec-enterprise-blogs.security.com/threat-intelligence/harvester-new-apt-attacks-asia",
          "https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/higaisa-or-winnti-apt-41-backdoors-old-and-new/",
          "https://intezer.com/blog/research/how-we-escaped-docker-in-azure-functions/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_domain_azurewebsites.yml"
      }
    },
    {
      "id": "fdeebdf0-9f3f-4d08-84a6-4c4d13e39fe4",
      "title": "Network Connection Initiated To Mega.nz",
      "status": "test",
      "description": "Detects a network connection initiated by a binary to \"api.mega.co.nz\".\nAttackers were seen abusing file sharing websites similar to \"mega.nz\" in order to upload/download additional payloads.\n",
      "level": "low",
      "tags": [
        "attack.exfiltration",
        "attack.t1567.002"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "DestinationHostname__endswith": {
                "field": "DestinationHostname",
                "value": [
                  "mega.co.nz",
                  "mega.nz"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1567.002"
        ],
        "tactics": [
          "exfiltration"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-12-06",
        "modified": "2024-05-31",
        "references": [
          "https://megatools.megous.com/",
          "https://www.mandiant.com/resources/russian-targeting-gov-business"
        ],
        "falsepositives": [
          "Legitimate MEGA installers and utilities are expected to communicate with this domain. Exclude hosts that are known to be allowed to use this tool."
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_domain_mega_nz.yml"
      }
    },
    {
      "id": "ed74fe75-7594-4b4b-ae38-e38e3fd2eb23",
      "title": "Outbound RDP Connections Over Non-Standard Tools",
      "status": "test",
      "description": "Detects Non-Standard tools initiating a connection over port 3389 indicating possible lateral movement.\nAn initial baseline is required before using this utility to exclude third party RDP tooling that you might use.\n",
      "level": "high",
      "tags": [
        "attack.lateral-movement",
        "attack.t1021.001",
        "car.2013-07-002"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "DestinationPort": {
                "field": "DestinationPort",
                "value": 3389,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_mstsc": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Windows\\System32\\mstsc.exe",
                  "C:\\Windows\\SysWOW64\\mstsc.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_dns": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\System32\\dns.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "SourcePort": {
                "field": "SourcePort",
                "value": 53,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Protocol": {
                "field": "Protocol",
                "value": "udp",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_avast": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\Avast Software\\Avast\\AvastSvc.exe",
                  "\\Avast\\AvastSvc.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_sysinternals_rdcman": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\RDCMan.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_chrome": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_third_party": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\FSAssessment.exe",
                  "\\FSDiscovery.exe",
                  "\\MobaRTE.exe",
                  "\\mRemote.exe",
                  "\\mRemoteNG.exe",
                  "\\Passwordstate.exe",
                  "\\RemoteDesktopManager.exe",
                  "\\RemoteDesktopManager64.exe",
                  "\\RemoteDesktopManagerFree.exe",
                  "\\RSSensor.exe",
                  "\\RTS2App.exe",
                  "\\RTSApp.exe",
                  "\\spiceworks-finder.exe",
                  "\\Terminals.exe",
                  "\\ws_TunnelService.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_thor": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\thor.exe",
                  "\\thor64.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_splunk": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Program Files\\SplunkUniversalForwarder\\bin\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_sentinel_one": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\Ranger\\SentinelRanger.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_firefox": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Program Files\\Mozilla Firefox\\firefox.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_tsplus": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\TSplus\\Java\\bin\\HTML5service.exe",
                  "C:\\Program Files (x86)\\TSplus\\Java\\bin\\HTML5service.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_null": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_empty": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_unknown": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "<unknown process>",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1021.001"
        ],
        "tactics": [
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Markus Neis",
        "date": "2019-05-15",
        "modified": "2024-02-09",
        "references": [
          "https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-0708"
        ],
        "falsepositives": [
          "Third party RDP tools"
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_rdp_outbound_over_non_standard_tools.yml"
      }
    },
    {
      "id": "e54979bd-c5f9-4d6c-967b-a04b19ac4c74",
      "title": "Uncommon Outbound Kerberos Connection",
      "status": "test",
      "description": "Detects uncommon outbound network activity via Kerberos default port indicating possible lateral movement or first stage PrivEsc via delegation.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.credential-access",
        "attack.t1558",
        "attack.lateral-movement",
        "attack.t1550.003"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "DestinationPort": {
                "field": "DestinationPort",
                "value": 88,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_lsass": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\System32\\lsass.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_chrome": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe",
                  "C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_firefox": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe",
                  "C:\\Program Files\\Mozilla Firefox\\firefox.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_tomcat": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\tomcat\\bin\\tomcat8.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1558",
          "T1550.003"
        ],
        "tactics": [
          "defense_evasion",
          "credential_access",
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Ilyas Ochkov, oscd.community",
        "date": "2019-10-24",
        "modified": "2024-03-15",
        "references": [
          "https://github.com/GhostPack/Rubeus"
        ],
        "falsepositives": [
          "Web Browsers and third party application might generate similar activity. An initial baseline is required."
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_susp_outbound_kerberos_connection.yml"
      }
    },
    {
      "id": "1d08ac94-400d-4469-a82f-daee9a908849",
      "title": "Communication To Ngrok Tunneling Service Initiated",
      "status": "test",
      "description": "Detects an executable initiating a network connection to \"ngrok\" tunneling domains.\nAttackers were seen using this \"ngrok\" in order to store their second stage payloads and malware.\nWhile communication with such domains can be legitimate, often times is a sign of either data exfiltration by malicious actors or additional download.\n",
      "level": "high",
      "tags": [
        "attack.exfiltration",
        "attack.command-and-control",
        "attack.t1567",
        "attack.t1568.002",
        "attack.t1572",
        "attack.t1090",
        "attack.t1102",
        "attack.s0508"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "DestinationHostname__contains": {
                "field": "DestinationHostname",
                "value": [
                  "tunnel.us.ngrok.com",
                  "tunnel.eu.ngrok.com",
                  "tunnel.ap.ngrok.com",
                  "tunnel.au.ngrok.com",
                  "tunnel.sa.ngrok.com",
                  "tunnel.jp.ngrok.com",
                  "tunnel.in.ngrok.com"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1567",
          "T1568.002",
          "T1572",
          "T1090",
          "T1102"
        ],
        "tactics": [
          "exfiltration",
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-11-03",
        "modified": "2024-02-02",
        "references": [
          "https://twitter.com/hakluke/status/1587733971814977537/photo/1",
          "https://ngrok.com/docs/secure-tunnels/tunnels/ssh-reverse-tunnel-agent"
        ],
        "falsepositives": [
          "Legitimate use of the ngrok service."
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_domain_ngrok_tunnel.yml"
      }
    },
    {
      "id": "08249dc0-a28d-4555-8ba5-9255a198e08c",
      "title": "Local Network Connection Initiated By Script Interpreter",
      "status": "test",
      "description": "Detects a script interpreter (Wscript/Cscript) initiating a local network connection to download or execute a script hosted on a shared folder.\n",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1105"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\wscript.exe",
                  "\\cscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "DestinationIp__cidr": {
                "field": "DestinationIp",
                "value": [
                  "127.0.0.0/8",
                  "10.0.0.0/8",
                  "172.16.0.0/12",
                  "192.168.0.0/16",
                  "169.254.0.0/16",
                  "::1/128",
                  "fe80::/10",
                  "fc00::/7"
                ],
                "modifiers": [
                  "cidr"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1105"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-08-28",
        "modified": "2024-05-31",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/28d190330fe44de6ff4767fc400cc10fa7cd6540/atomics/T1105/T1105.md"
        ],
        "falsepositives": [
          "Legitimate scripts"
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_wscript_cscript_local_connection.yml"
      }
    },
    {
      "id": "7cd1dcdc-6edf-4896-86dc-d1f19ad64903",
      "title": "Network Connection Initiated To Cloudflared Tunnels Domains",
      "status": "test",
      "description": "Detects network connections to Cloudflared tunnels domains initiated by a process on the system.\nAttackers can abuse that feature to establish a reverse shell or persistence on a machine.\n",
      "level": "medium",
      "tags": [
        "attack.exfiltration",
        "attack.command-and-control",
        "attack.t1567",
        "attack.t1572"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "DestinationHostname__endswith": {
                "field": "DestinationHostname",
                "value": [
                  ".v2.argotunnel.com",
                  "protocol-v2.argotunnel.com",
                  "trycloudflare.com",
                  "update.argotunnel.com"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1567",
          "T1572"
        ],
        "tactics": [
          "exfiltration",
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Kamran Saifullah, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2024-05-27",
        "modified": "",
        "references": [
          "https://defr0ggy.github.io/research/Abusing-Cloudflared-A-Proxy-Service-To-Host-Share-Applications/",
          "https://www.guidepointsecurity.com/blog/tunnel-vision-cloudflared-abused-in-the-wild/",
          "Internal Research"
        ],
        "falsepositives": [
          "Legitimate use of cloudflare tunnels will also trigger this."
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_domain_cloudflared_communication.yml"
      }
    },
    {
      "id": "b1e5da3b-ca8e-4adf-915c-9921f3d85481",
      "title": "RDP to HTTP or HTTPS Target Ports",
      "status": "test",
      "description": "Detects svchost hosting RDP termsvcs communicating to target systems on TCP port 80 or 443",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1572",
        "attack.lateral-movement",
        "attack.t1021.001",
        "car.2013-07-002"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\svchost.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "SourcePort": {
                "field": "SourcePort",
                "value": 3389,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "DestinationPort": {
                "field": "DestinationPort",
                "value": [
                  80,
                  443
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1572",
          "T1021.001"
        ],
        "tactics": [
          "command_and_control",
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-04-29",
        "modified": "2022-07-14",
        "references": [
          "https://twitter.com/tekdefense/status/1519711183162556416?s=12&t=OTsHCBkQOTNs1k3USz65Zg",
          "https://www.mandiant.com/resources/bypassing-network-restrictions-through-rdp-tunneling"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_rdp_to_http.yml"
      }
    },
    {
      "id": "4b89abaa-99fe-4232-afdd-8f9aa4d20382",
      "title": "Potentially Suspicious Malware Callback Communication",
      "status": "test",
      "description": "Detects programs that connect to known malware callback ports based on statistical analysis from two different sandbox system databases\n",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.command-and-control",
        "attack.t1571"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "DestinationPort": {
                "field": "DestinationPort",
                "value": [
                  100,
                  198,
                  200,
                  243,
                  473,
                  666,
                  700,
                  743,
                  777,
                  1443,
                  1515,
                  1777,
                  1817,
                  1904,
                  1960,
                  2443,
                  2448,
                  3360,
                  3675,
                  3939,
                  4040,
                  4433,
                  4438,
                  4443,
                  4444,
                  4455,
                  5445,
                  5552,
                  5649,
                  6625,
                  7210,
                  7777,
                  8143,
                  8843,
                  9631,
                  9943,
                  10101,
                  12102,
                  12103,
                  12322,
                  13145,
                  13394,
                  13504,
                  13505,
                  13506,
                  13507,
                  14102,
                  14103,
                  14154,
                  49180,
                  65520,
                  65535
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_local_ranges": {
            "type": "field_match",
            "matchers": {
              "DestinationIp__cidr": {
                "field": "DestinationIp",
                "value": [
                  "127.0.0.0/8",
                  "10.0.0.0/8",
                  "172.16.0.0/12",
                  "192.168.0.0/16",
                  "169.254.0.0/16",
                  "::1/128",
                  "fe80::/10",
                  "fc00::/7"
                ],
                "modifiers": [
                  "cidr"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_sys_directories": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\",
                  "C:\\Program Files (x86)\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1571"
        ],
        "tactics": [
          "persistence",
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2017-03-19",
        "modified": "2024-03-12",
        "references": [
          "https://docs.google.com/spreadsheets/d/17pSTDNpa0sf6pHeRhusvWG6rThciE8CsXTSlDUAZDyo"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_susp_malware_callback_port.yml"
      }
    },
    {
      "id": "20384606-a124-4fec-acbb-8bd373728613",
      "title": "Suspicious Network Connection Binary No CommandLine",
      "status": "test",
      "description": "Detects suspicious network connections made by a well-known Windows binary run with no command line parameters",
      "level": "high",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\regsvr32.exe",
                  "\\rundll32.exe",
                  "\\dllhost.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": [
                  "\\regsvr32.exe",
                  "\\rundll32.exe",
                  "\\dllhost.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_no_cmdline": {
            "type": "field_match",
            "matchers": {
              "CommandLine": {
                "field": "CommandLine",
                "value": "",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_null": {
            "type": "field_match",
            "matchers": {
              "CommandLine": {
                "field": "CommandLine",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-07-03",
        "modified": "",
        "references": [
          "https://redcanary.com/blog/raspberry-robin/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_susp_binary_no_cmdline.yml"
      }
    },
    {
      "id": "a66bc059-c370-472c-a0d7-f8fd1bf9d583",
      "title": "Network Connection Initiated By Eqnedt32.EXE",
      "status": "test",
      "description": "Detects network connections from the Equation Editor process \"eqnedt32.exe\".",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1203"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\eqnedt32.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1203"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Max Altgelt (Nextron Systems)",
        "date": "2022-04-14",
        "modified": "2024-05-31",
        "references": [
          "https://twitter.com/forensicitguy/status/1513538712986079238",
          "https://forensicitguy.github.io/xloader-formbook-velvetsweatshop-spreadsheet/",
          "https://news.sophos.com/en-us/2019/07/18/a-new-equation-editor-exploit-goes-commercial-as-maldoc-attacks-using-it-spike/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_eqnedt.yml"
      }
    },
    {
      "id": "0531e43a-d77d-47c2-b89f-5fe50321c805",
      "title": "RegAsm.EXE Initiating Network Connection To Public IP",
      "status": "test",
      "description": "Detects \"RegAsm.exe\" initiating a network connection to public IP adresses",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.009"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\regasm.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_local_ranges": {
            "type": "field_match",
            "matchers": {
              "DestinationIp__cidr": {
                "field": "DestinationIp",
                "value": [
                  "127.0.0.0/8",
                  "10.0.0.0/8",
                  "172.16.0.0/12",
                  "192.168.0.0/16",
                  "169.254.0.0/16",
                  "::1/128",
                  "fe80::/10",
                  "fc00::/7"
                ],
                "modifiers": [
                  "cidr"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218.009"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2024-04-25",
        "modified": "",
        "references": [
          "https://app.any.run/tasks/ec207948-4916-47eb-a0f4-4c6abb2e7668/",
          "https://research.splunk.com/endpoint/07921114-6db4-4e2e-ae58-3ea8a52ae93f/",
          "https://lolbas-project.github.io/lolbas/Binaries/Regasm/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_regasm_network_activity.yml"
      }
    },
    {
      "id": "c649a6c7-cd8c-4a78-9c04-000fc76df954",
      "title": "Potentially Suspicious Wuauclt Network Connection",
      "status": "test",
      "description": "Detects the use of the Windows Update Client binary (wuauclt.exe) to proxy execute code and making network connections.\nOne could easily make the DLL spawn a new process and inject to it to proxy the network connection and bypass this rule.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": "wuauclt",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": " /RunHandlerComServer",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_ip": {
            "type": "field_match",
            "matchers": {
              "DestinationIp__cidr": {
                "field": "DestinationIp",
                "value": [
                  "127.0.0.0/8",
                  "10.0.0.0/8",
                  "169.254.0.0/16",
                  "172.16.0.0/12",
                  "192.168.0.0/16",
                  "::1/128",
                  "fe80::/10",
                  "fc00::/7"
                ],
                "modifiers": [
                  "cidr"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_msrange": {
            "type": "field_match",
            "matchers": {
              "DestinationIp__cidr": {
                "field": "DestinationIp",
                "value": [
                  "20.184.0.0/13",
                  "20.192.0.0/10",
                  "23.79.0.0/16",
                  "51.10.0.0/15",
                  "51.103.0.0/16",
                  "51.104.0.0/15",
                  "52.224.0.0/11"
                ],
                "modifiers": [
                  "cidr"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_uus": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": [
                  ":\\Windows\\UUS\\Packages\\Preview\\amd64\\updatedeploy.dll /ClassId",
                  ":\\Windows\\UUS\\amd64\\UpdateDeploy.dll /ClassId"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_winsxs": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  ":\\Windows\\WinSxS\\",
                  "\\UpdateDeploy.dll /ClassId "
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_cli_null": {
            "type": "field_match",
            "matchers": {
              "CommandLine": {
                "field": "CommandLine",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_cli_empty": {
            "type": "field_match",
            "matchers": {
              "CommandLine": {
                "field": "CommandLine",
                "value": "",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
        "date": "2020-10-12",
        "modified": "2024-03-12",
        "references": [
          "https://dtm.uk/wuauclt/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_wuauclt_network_connection.yml"
      }
    },
    {
      "id": "bef0bc5a-b9ae-425d-85c6-7b2d705980c6",
      "title": "Python Initiated Connection",
      "status": "test",
      "description": "Detects a Python process initiating a network connection. While this often relates to package installation, it can also indicate a potential malicious script communicating with a C&C server.",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.t1046"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Image__contains_all": {
                "field": "Image",
                "value": [
                  "\\python",
                  ".exe"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_conda": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": "C:\\ProgramData\\Anaconda3\\Scripts\\conda.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  ":\\ProgramData\\Anaconda3\\Scripts\\conda-script.py",
                  "update"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_conda_jupyter_notebook": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": "C:\\ProgramData\\Anaconda3\\python.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "C:\\ProgramData\\Anaconda3\\Scripts\\jupyter-notebook-script.py",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_local_communication": {
            "type": "field_match",
            "matchers": {
              "DestinationIp": {
                "field": "DestinationIp",
                "value": "127.0.0.1",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "SourceIp": {
                "field": "SourceIp",
                "value": "127.0.0.1",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_pip": {
            "type": "field_match",
            "matchers": {
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "pip.exe",
                  "install"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1046"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-12-10",
        "modified": "2025-03-05",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1046/T1046.md#atomic-test-4---port-scan-using-python",
          "https://pypi.org/project/scapy/"
        ],
        "falsepositives": [
          "Legitimate python scripts using the socket library or similar will trigger this. Apply additional filters and perform an initial baseline before deploying."
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_python.yml"
      }
    },
    {
      "id": "3b5ba899-9842-4bc2-acc2-12308498bf42",
      "title": "Office Application Initiated Network Connection Over Uncommon Ports",
      "status": "test",
      "description": "Detects an office suit application (Word, Excel, PowerPoint, Outlook) communicating to target systems over uncommon ports.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.command-and-control"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\excel.exe",
                  "\\outlook.exe",
                  "\\powerpnt.exe",
                  "\\winword.exe",
                  "\\wordview.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_common_ports": {
            "type": "field_match",
            "matchers": {
              "DestinationPort": {
                "field": "DestinationPort",
                "value": [
                  53,
                  80,
                  139,
                  389,
                  443,
                  445,
                  3268
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_outlook_ports": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": ":\\Program Files\\Microsoft Office\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\OUTLOOK.EXE",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "DestinationPort": {
                "field": "DestinationPort",
                "value": [
                  143,
                  465,
                  587,
                  993,
                  995
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion",
          "command_and_control"
        ]
      },
      "meta": {
        "author": "X__Junior (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-07-12",
        "modified": "2025-10-17",
        "references": [
          "https://blogs.blackberry.com/en/2023/07/romcom-targets-ukraine-nato-membership-talks-at-nato-summit"
        ],
        "falsepositives": [
          "Other ports can be used, apply additional filters accordingly"
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_office_uncommon_ports.yml"
      }
    },
    {
      "id": "7b434893-c57d-4f41-908d-6a17bf1ae98f",
      "title": "Network Connection Initiated From Process Located In Potentially Suspicious Or Uncommon Location",
      "status": "test",
      "description": "Detects a network connection initiated by programs or processes running from suspicious or uncommon files system locations.\n",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1105"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Image__contains": {
                "field": "Image",
                "value": [
                  ":\\$Recycle.bin",
                  ":\\Perflogs\\",
                  ":\\Temp\\",
                  ":\\Users\\Default\\",
                  ":\\Users\\Public\\",
                  ":\\Windows\\Fonts\\",
                  ":\\Windows\\IME\\",
                  ":\\Windows\\System32\\Tasks\\",
                  ":\\Windows\\Tasks\\",
                  "\\config\\systemprofile\\",
                  "\\Contacts\\",
                  "\\Favorites\\",
                  "\\Favourites\\",
                  "\\Music\\",
                  "\\Pictures\\",
                  "\\Videos\\",
                  "\\Windows\\addins\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_domains": {
            "type": "field_match",
            "matchers": {
              "DestinationHostname__endswith": {
                "field": "DestinationHostname",
                "value": [
                  ".githubusercontent.com",
                  "anonfiles.com",
                  "cdn.discordapp.com",
                  "ddns.net",
                  "dl.dropboxusercontent.com",
                  "ghostbin.co",
                  "github.com",
                  "glitch.me",
                  "gofile.io",
                  "hastebin.com",
                  "mediafire.com",
                  "mega.co.nz",
                  "mega.nz",
                  "onrender.com",
                  "pages.dev",
                  "paste.ee",
                  "pastebin.com",
                  "pastebin.pl",
                  "pastetext.net",
                  "portmap.io",
                  "privatlab.com",
                  "privatlab.net",
                  "send.exploit.in",
                  "sendspace.com",
                  "storage.googleapis.com",
                  "storjshare.io",
                  "supabase.co",
                  "temp.sh",
                  "transfer.sh",
                  "trycloudflare.com",
                  "ufile.io",
                  "w3spaces.com",
                  "workers.dev"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1105"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2017-03-19",
        "modified": "2025-12-10",
        "references": [
          "https://docs.google.com/spreadsheets/d/17pSTDNpa0sf6pHeRhusvWG6rThciE8CsXTSlDUAZDyo"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_susp_initiated_uncommon_or_suspicious_locations.yml"
      }
    },
    {
      "id": "edf3485d-dac4-4d50-90e4-b0e5813f7e60",
      "title": "Suspicious Network Connection to IP Lookup Service APIs",
      "status": "test",
      "description": "Detects external IP address lookups by non-browser processes via services such as \"api.ipify.org\". This could be indicative of potential post compromise internet test activity.",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.t1016"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "DestinationHostname": {
                    "field": "DestinationHostname",
                    "value": [
                      "www.ip.cn",
                      "l2.io"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "DestinationHostname__contains": {
                    "field": "DestinationHostname",
                    "value": [
                      "api.2ip.ua",
                      "api.bigdatacloud.net",
                      "api.ipify.org",
                      "bot.whatismyipaddress.com",
                      "canireachthe.net",
                      "checkip.amazonaws.com",
                      "checkip.dyndns.org",
                      "curlmyip.com",
                      "db-ip.com",
                      "edns.ip-api.com",
                      "eth0.me",
                      "freegeoip.app",
                      "geoipy.com",
                      "getip.pro",
                      "icanhazip.com",
                      "ident.me",
                      "ifconfig.io",
                      "ifconfig.me",
                      "ip-api.com",
                      "ip.360.cn",
                      "ip.anysrc.net",
                      "ip.taobao.com",
                      "ip.tyk.nu",
                      "ipaddressworld.com",
                      "ipapi.co",
                      "ipconfig.io",
                      "ipecho.net",
                      "ipinfo.io",
                      "ipip.net",
                      "ipof.in",
                      "ipv4.icanhazip.com",
                      "ipv4bot.whatismyipaddress.com",
                      "ipv6-test.com",
                      "ipwho.is",
                      "jsonip.com",
                      "myexternalip.com",
                      "seeip.org",
                      "wgetip.com",
                      "whatismyip.akamai.com",
                      "whois.pconline.com.cn",
                      "wtfismyip.com"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_optional_brave": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\brave.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_chrome": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe",
                  "C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_firefox": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Mozilla Firefox\\firefox.exe",
                  "C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_ie": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe",
                  "C:\\Program Files\\Internet Explorer\\iexplore.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_maxthon": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\maxthon.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_edge_1": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__startswith": {
                    "field": "Image",
                    "value": "C:\\Program Files (x86)\\Microsoft\\EdgeWebView\\Application\\",
                    "modifiers": [
                      "startswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\WindowsApps\\MicrosoftEdge.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image": {
                    "field": "Image",
                    "value": [
                      "C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe",
                      "C:\\Program Files\\Microsoft\\Edge\\Application\\msedge.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "filter_optional_edge_2": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\Microsoft\\EdgeCore\\",
                  "C:\\Program Files\\Microsoft\\EdgeCore\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\msedge.exe",
                  "\\msedgewebview2.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_opera": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\opera.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_safari": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\safari.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_seamonkey": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\seamonkey.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_vivaldi": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\vivaldi.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_whale": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\whale.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1016"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Janantha Marasinghe, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-04-24",
        "modified": "2024-03-22",
        "references": [
          "https://github.com/rsp/scripts/blob/c8bb272d68164a9836e4f273d8f924927f39b8c6/externalip-benchmark.md",
          "https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-302a",
          "https://thedfirreport.com/2022/11/28/emotet-strikes-again-lnk-file-leads-to-domain-wide-ransomware/",
          "https://www.trendmicro.com/en_us/research/23/e/managed-xdr-investigation-of-ducktail-in-trend-micro-vision-one.html"
        ],
        "falsepositives": [
          "Legitimate use of the external websites for troubleshooting or network monitoring"
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_domain_external_ip_lookup.yml"
      }
    },
    {
      "id": "7e9cf7b6-e827-11ed-a05b-0242ac120003",
      "title": "Suspicious Non-Browser Network Communication With Google API",
      "status": "experimental",
      "description": "Detects a non-browser process interacting with the Google API which could indicate the use of a covert C2 such as Google Sheet C2 (GC2-sheet)\n",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1102"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "DestinationHostname__contains": {
                "field": "DestinationHostname",
                "value": [
                  "drive.googleapis.com",
                  "oauth2.googleapis.com",
                  "sheets.googleapis.com",
                  "www.googleapis.com"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_brave": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\brave.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_chrome": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  ":\\Program Files\\Google\\Chrome\\Application\\chrome.exe",
                  ":\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_google_drive": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": ":\\Program Files\\Google\\Drive File Stream\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\GoogleDriveFS.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_firefox": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  ":\\Program Files\\Mozilla Firefox\\firefox.exe",
                  ":\\Program Files (x86)\\Mozilla Firefox\\firefox.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_ie": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  ":\\Program Files (x86)\\Internet Explorer\\iexplore.exe",
                  ":\\Program Files\\Internet Explorer\\iexplore.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_maxthon": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\maxthon.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_edge_1": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__contains": {
                    "field": "Image",
                    "value": ":\\Program Files (x86)\\Microsoft\\EdgeWebView\\Application\\",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      ":\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe",
                      ":\\Program Files\\Microsoft\\Edge\\Application\\msedge.exe",
                      "\\WindowsApps\\MicrosoftEdge.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "filter_optional_edge_2": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  ":\\Program Files (x86)\\Microsoft\\EdgeCore\\",
                  ":\\Program Files\\Microsoft\\EdgeCore\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\msedge.exe",
                  "\\msedgewebview2.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_opera": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\opera.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_safari": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\safari.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_seamonkey": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\seamonkey.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_vivaldi": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\vivaldi.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_whale": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\whale.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_googleupdate": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\GoogleUpdate.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_outlook_exe": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\outlook.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_null": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_empty": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1102"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Gavin Knapp",
        "date": "2023-05-01",
        "modified": "2025-02-22",
        "references": [
          "https://github.com/looCiprian/GC2-sheet",
          "https://youtu.be/n2dFlSaBBKo",
          "https://services.google.com/fh/files/blogs/gcat_threathorizons_full_apr2023.pdf",
          "https://www.tanium.com/blog/apt41-deploys-google-gc2-for-attacks-cyber-threat-intelligence-roundup/",
          "https://www.bleepingcomputer.com/news/security/hackers-abuse-google-command-and-control-red-team-tool-in-attacks/"
        ],
        "falsepositives": [
          "Legitimate applications communicating with the \"googleapis.com\" endpoints that are not already in the exclusion list. This is environmental dependent and requires further testing and tuning."
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_domain_google_api_non_browser_access.yml"
      }
    },
    {
      "id": "8d7e392e-9b28-49e1-831d-5949c6281228",
      "title": "Network Connection Initiated By IMEWDBLD.EXE",
      "status": "test",
      "description": "Detects a network connection initiated by IMEWDBLD.EXE. This might indicate potential abuse of the utility as a LOLBIN in order to download arbitrary files or additional payloads.\n",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1105"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\IMEWDBLD.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1105"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-22",
        "modified": "2023-11-09",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1105/T1105.md#atomic-test-10---windows---powershell-download",
          "https://lolbas-project.github.io/lolbas/Binaries/IMEWDBLD/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_imewdbld.yml"
      }
    },
    {
      "id": "c539afac-c12a-46ed-b1bd-5a5567c9f045",
      "title": "Potential Remote PowerShell Session Initiated",
      "status": "test",
      "description": "Detects a process that initiated a network connection over ports 5985 or 5986 from a non-network service account.\nThis could potentially indicates a remote PowerShell connection.\n",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059.001",
        "attack.lateral-movement",
        "attack.t1021.006"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "DestinationPort": {
                "field": "DestinationPort",
                "value": [
                  5985,
                  5986
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "SourceIsIpv6": {
                "field": "SourceIsIpv6",
                "value": "false",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_service_users": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "User__contains": {
                    "field": "User",
                    "value": [
                      "NETWORK SERVICE",
                      "NETZWERKDIENST",
                      "SERVICIO DE RED",
                      "SERVIZIO DI RETE"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "User__contains_all": {
                    "field": "User",
                    "value": [
                      "SERVICE R",
                      "SEAU"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "filter_main_localhost": {
            "type": "field_match",
            "matchers": {
              "SourceIp": {
                "field": "SourceIp",
                "value": [
                  "::1",
                  "127.0.0.1"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "DestinationIp": {
                "field": "DestinationIp",
                "value": [
                  "::1",
                  "127.0.0.1"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_avast": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Avast Software\\Avast\\AvastSvc.exe",
                  "C:\\Program Files (x86)\\Avast Software\\Avast\\AvastSvc.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001",
          "T1021.006"
        ],
        "tactics": [
          "execution",
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez @Cyb3rWard0g",
        "date": "2019-09-12",
        "modified": "2024-02-02",
        "references": [
          "https://threathunterplaybook.com/hunts/windows/190511-RemotePwshExecution/notebook.html"
        ],
        "falsepositives": [
          "Legitimate usage of remote PowerShell, e.g. remote administration and monitoring.",
          "Network Service user name of a not-covered localization"
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_susp_remote_powershell_session.yml"
      }
    },
    {
      "id": "9976fa64-2804-423c-8a5b-646ade840773",
      "title": "Suspicious Outbound SMTP Connections",
      "status": "test",
      "description": "Adversaries may steal data by exfiltrating it over an un-encrypted network protocol other than that of the existing command and control channel.\nThe data may also be sent to an alternate network location from the main command and control server.\n",
      "level": "medium",
      "tags": [
        "attack.exfiltration",
        "attack.t1048.003"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "DestinationPort": {
                "field": "DestinationPort",
                "value": [
                  25,
                  587,
                  465,
                  2525
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_clients": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\thunderbird.exe",
                  "\\outlook.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_mailserver": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Program Files\\Microsoft\\Exchange Server\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_outlook": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Program Files\\WindowsApps\\microsoft.windowscommunicationsapps_",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\HxTsr.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1048.003"
        ],
        "tactics": [
          "exfiltration"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-07",
        "modified": "2022-09-21",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1048.003/T1048.003.md#atomic-test-5---exfiltration-over-alternative-protocol---smtp",
          "https://www.ietf.org/rfc/rfc2821.txt"
        ],
        "falsepositives": [
          "Other SMTP tools"
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_susp_outbound_smtp_connections.yml"
      }
    },
    {
      "id": "6d8c3d20-a5e1-494f-8412-4571d716cf5c",
      "title": "Communication To Uncommon Destination Ports",
      "status": "test",
      "description": "Detects programs that connect to uncommon destination ports",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.command-and-control",
        "attack.t1571"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "DestinationPort": {
                "field": "DestinationPort",
                "value": [
                  8080,
                  8888
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_local_ranges": {
            "type": "field_match",
            "matchers": {
              "DestinationIp__cidr": {
                "field": "DestinationIp",
                "value": [
                  "127.0.0.0/8",
                  "10.0.0.0/8",
                  "172.16.0.0/12",
                  "192.168.0.0/16",
                  "169.254.0.0/16",
                  "::1/128",
                  "fe80::/10",
                  "fc00::/7"
                ],
                "modifiers": [
                  "cidr"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_sys_directories": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\",
                  "C:\\Program Files (x86)\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1571"
        ],
        "tactics": [
          "persistence",
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2017-03-19",
        "modified": "2024-03-12",
        "references": [
          "https://docs.google.com/spreadsheets/d/17pSTDNpa0sf6pHeRhusvWG6rThciE8CsXTSlDUAZDyo"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_susp_malware_callback_ports_uncommon.yml"
      }
    },
    {
      "id": "7610a4ea-c06d-495f-a2ac-0a696abcfd3b",
      "title": "Outbound Network Connection To Public IP Via Winlogon",
      "status": "test",
      "description": "Detects a \"winlogon.exe\" process that initiate network communications with public IP addresses",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.execution",
        "attack.command-and-control",
        "attack.t1218.011"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\winlogon.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_local_ranges": {
            "type": "field_match",
            "matchers": {
              "DestinationIp__cidr": {
                "field": "DestinationIp",
                "value": [
                  "127.0.0.0/8",
                  "10.0.0.0/8",
                  "172.16.0.0/12",
                  "192.168.0.0/16",
                  "169.254.0.0/16",
                  "::1/128",
                  "fe80::/10",
                  "fc00::/7"
                ],
                "modifiers": [
                  "cidr"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218.011"
        ],
        "tactics": [
          "defense_evasion",
          "execution",
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Christopher Peacock @securepeacock, SCYTHE @scythe_io",
        "date": "2023-04-28",
        "modified": "2024-03-12",
        "references": [
          "https://www.microsoft.com/en-us/security/blog/2023/04/11/guidance-for-investigating-attacks-using-cve-2022-21894-the-blacklotus-campaign/"
        ],
        "falsepositives": [
          "Communication to other corporate systems that use IP addresses from public address spaces"
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_winlogon_net_connections.yml"
      }
    },
    {
      "id": "e81528db-fc02-45e8-8e98-4e84aba1f10b",
      "title": "Network Connection Initiated Via Notepad.EXE",
      "status": "test",
      "description": "Detects a network connection that is initiated by the \"notepad.exe\" process.\nThis might be a sign of process injection from a beacon process or something similar.\nNotepad rarely initiates a network communication except when printing documents for example.\n",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.command-and-control",
        "attack.execution",
        "attack.defense-evasion",
        "attack.t1055"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\notepad.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_printing": {
            "type": "field_match",
            "matchers": {
              "DestinationPort": {
                "field": "DestinationPort",
                "value": 9100,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1055"
        ],
        "tactics": [
          "privilege_escalation",
          "command_and_control",
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "EagleEye Team",
        "date": "2020-05-14",
        "modified": "2024-02-02",
        "references": [
          "https://web.archive.org/web/20200219102749/https://www.sans.org/cyber-security-summit/archives/file/summit-archive-1492186586.pdf",
          "https://www.cobaltstrike.com/blog/why-is-notepad-exe-connecting-to-the-internet"
        ],
        "falsepositives": [
          "Printing documents via notepad might cause communication with the printer via port 9100 or similar."
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_notepad.yml"
      }
    },
    {
      "id": "c3dbbc9f-ef1d-470a-a90a-d343448d5875",
      "title": "Suspicious Non-Browser Network Communication With Telegram API",
      "status": "test",
      "description": "Detects an a non-browser process interacting with the Telegram API which could indicate use of a covert C2",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.exfiltration",
        "attack.t1102",
        "attack.t1567",
        "attack.t1105"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "DestinationHostname__contains": {
                "field": "DestinationHostname",
                "value": "api.telegram.org",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_brave": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\brave.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_chrome": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe",
                  "C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_firefox": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Mozilla Firefox\\firefox.exe",
                  "C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_ie": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe",
                  "C:\\Program Files\\Internet Explorer\\iexplore.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_maxthon": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\maxthon.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_edge_1": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__startswith": {
                    "field": "Image",
                    "value": "C:\\Program Files (x86)\\Microsoft\\EdgeWebView\\Application\\",
                    "modifiers": [
                      "startswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\WindowsApps\\MicrosoftEdge.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image": {
                    "field": "Image",
                    "value": [
                      "C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe",
                      "C:\\Program Files\\Microsoft\\Edge\\Application\\msedge.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "filter_main_edge_2": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\Microsoft\\EdgeCore\\",
                  "C:\\Program Files\\Microsoft\\EdgeCore\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\msedge.exe",
                  "\\msedgewebview2.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_opera": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\opera.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_safari": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\safari.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_seamonkey": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\seamonkey.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_vivaldi": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\vivaldi.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_whale": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\whale.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1102",
          "T1567",
          "T1105"
        ],
        "tactics": [
          "command_and_control",
          "exfiltration"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-19",
        "modified": "",
        "references": [
          "https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/small-sieve/NCSC-MAR-Small-Sieve.pdf"
        ],
        "falsepositives": [
          "Legitimate applications communicating with the Telegram API e.g. web browsers not in the exclusion list, app with an RSS  etc."
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_domain_telegram_api_non_browser_access.yml"
      }
    },
    {
      "id": "37e4024a-6c80-4d8f-b95d-2e7e94f3a8d1",
      "title": "Outbound Network Connection Initiated By Microsoft Dialer",
      "status": "test",
      "description": "Detects outbound network connection initiated by Microsoft Dialer.\nThe Microsoft Dialer, also known as Phone Dialer, is a built-in utility application included in various versions of the Microsoft Windows operating system. Its primary function is to provide users with a graphical interface for managing phone calls via a modem or a phone line connected to the computer.\nThis is an outdated process in the current conext of it's usage and is a common target for info stealers for process injection, and is used to make C2 connections, common example is \"Rhadamanthys\"\n",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.command-and-control",
        "attack.t1071.001"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": ":\\Windows\\System32\\dialer.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_local_ranges": {
            "type": "field_match",
            "matchers": {
              "DestinationIp__cidr": {
                "field": "DestinationIp",
                "value": [
                  "127.0.0.0/8",
                  "10.0.0.0/8",
                  "172.16.0.0/12",
                  "192.168.0.0/16",
                  "169.254.0.0/16",
                  "::1/128",
                  "fe80::/10",
                  "fc00::/7"
                ],
                "modifiers": [
                  "cidr"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1071.001"
        ],
        "tactics": [
          "execution",
          "command_and_control"
        ]
      },
      "meta": {
        "author": "CertainlyP",
        "date": "2024-04-26",
        "modified": "",
        "references": [
          "https://tria.ge/240301-rk34sagf5x/behavioral2",
          "https://app.any.run/tasks/6720b85b-9c53-4a12-b1dc-73052a78477d",
          "https://research.checkpoint.com/2023/rhadamanthys-v0-5-0-a-deep-dive-into-the-stealers-components/",
          "https://strontic.github.io/xcyclopedia/library/dialer.exe-0B69655F912619756C704A0BF716B61F.html"
        ],
        "falsepositives": [
          "In Modern Windows systems, unable to see legitimate usage of this process, However, if an organization has legitimate purpose for this there can be false positives."
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_dialer_initiated_connection.yml"
      }
    },
    {
      "id": "7e9cf7b6-e827-11ed-a05b-15959c120003",
      "title": "Potentially Suspicious Network Connection To Notion API",
      "status": "test",
      "description": "Detects a non-browser process communicating with the Notion API. This could indicate potential use of a covert C2 channel such as \"OffensiveNotion C2\"",
      "level": "low",
      "tags": [
        "attack.command-and-control",
        "attack.t1102"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "DestinationHostname__contains": {
                "field": "DestinationHostname",
                "value": "api.notion.com",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_notion": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\AppData\\Local\\Programs\\Notion\\Notion.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_brave": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\brave.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_chrome": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe",
                  "C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_firefox": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Mozilla Firefox\\firefox.exe",
                  "C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_ie": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\Internet Explorer\\iexplore.exe",
                  "C:\\Program Files\\Internet Explorer\\iexplore.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_maxthon": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\maxthon.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_edge_1": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__startswith": {
                    "field": "Image",
                    "value": "C:\\Program Files (x86)\\Microsoft\\EdgeWebView\\Application\\",
                    "modifiers": [
                      "startswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": "\\WindowsApps\\MicrosoftEdge.exe",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image": {
                    "field": "Image",
                    "value": [
                      "C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe",
                      "C:\\Program Files\\Microsoft\\Edge\\Application\\msedge.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "filter_main_edge_2": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\Microsoft\\EdgeCore\\",
                  "C:\\Program Files\\Microsoft\\EdgeCore\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\msedge.exe",
                  "\\msedgewebview2.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_opera": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\opera.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_safari": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\safari.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_seamonkey": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\seamonkey.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_vivaldi": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\vivaldi.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_whale": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\whale.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1102"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Gavin Knapp",
        "date": "2023-05-03",
        "modified": "",
        "references": [
          "https://github.com/mttaggart/OffensiveNotion",
          "https://medium.com/@huskyhacks.mk/we-put-a-c2-in-your-notetaking-app-offensivenotion-3e933bace332"
        ],
        "falsepositives": [
          "Legitimate applications communicating with the \"api.notion.com\" endpoint that are not already in the exclusion list. The desktop and browser applications do not appear to be using the API by default unless integrations are configured."
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_domain_notion_api_susp_communication.yml"
      }
    },
    {
      "id": "9e02c8ec-02b9-43e8-81eb-34a475ba7965",
      "title": "Network Connection Initiated To BTunnels Domains",
      "status": "test",
      "description": "Detects network connections to BTunnels domains initiated by a process on the system.\nAttackers can abuse that feature to establish a reverse shell or persistence on a machine.\n",
      "level": "medium",
      "tags": [
        "attack.exfiltration",
        "attack.command-and-control",
        "attack.t1567",
        "attack.t1572"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "DestinationHostname__endswith": {
                "field": "DestinationHostname",
                "value": ".btunnel.co.in",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1567",
          "T1572"
        ],
        "tactics": [
          "exfiltration",
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Kamran Saifullah",
        "date": "2024-09-13",
        "modified": "",
        "references": [
          "https://defr0ggy.github.io/research/Utilizing-BTunnel-For-Data-Exfiltration/"
        ],
        "falsepositives": [
          "Legitimate use of BTunnels will also trigger this."
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_domain_btunnels.yml"
      }
    },
    {
      "id": "9f2cc74d-78af-4eb2-bb64-9cd1d292b87b",
      "title": "Microsoft Sync Center Suspicious Network Connections",
      "status": "test",
      "description": "Detects suspicious connections from Microsoft Sync Center to non-private IPs.",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.t1055",
        "attack.t1218",
        "attack.execution",
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\mobsync.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_local_ranges": {
            "type": "field_match",
            "matchers": {
              "DestinationIp__cidr": {
                "field": "DestinationIp",
                "value": [
                  "127.0.0.0/8",
                  "10.0.0.0/8",
                  "172.16.0.0/12",
                  "192.168.0.0/16",
                  "169.254.0.0/16",
                  "::1/128",
                  "fe80::/10",
                  "fc00::/7"
                ],
                "modifiers": [
                  "cidr"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1055",
          "T1218"
        ],
        "tactics": [
          "privilege_escalation",
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "elhoim",
        "date": "2022-04-28",
        "modified": "2024-03-12",
        "references": [
          "https://redcanary.com/blog/intelligence-insights-november-2021/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_susp_outbound_mobsync_connection.yml"
      }
    },
    {
      "id": "cdc8da7d-c303-42f8-b08c-b4ab47230263",
      "title": "Rundll32 Internet Connection",
      "status": "test",
      "description": "Detects a rundll32 that communicates with public IP addresses",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.011",
        "attack.execution"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\rundll32.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_local_ranges": {
            "type": "field_match",
            "matchers": {
              "DestinationIp__cidr": {
                "field": "DestinationIp",
                "value": [
                  "127.0.0.0/8",
                  "10.0.0.0/8",
                  "172.16.0.0/12",
                  "192.168.0.0/16",
                  "169.254.0.0/16",
                  "::1/128",
                  "fe80::/10",
                  "fc00::/7"
                ],
                "modifiers": [
                  "cidr"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_ms_ranges": {
            "type": "field_match",
            "matchers": {
              "DestinationIp__cidr": {
                "field": "DestinationIp",
                "value": [
                  "20.0.0.0/8",
                  "51.103.0.0/16",
                  "51.104.0.0/16",
                  "51.105.0.0/16"
                ],
                "modifiers": [
                  "cidr"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_app_sdb": {
            "type": "field_match",
            "matchers": {
              "CommandLine__endswith": {
                "field": "CommandLine",
                "value": "\\system32\\PcaSvc.dll,PcaPatchSdbTask",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_azure_managed": {
            "type": "field_match",
            "matchers": {
              "SourceHostname__endswith": {
                "field": "SourceHostname",
                "value": ".internal.cloudapp.net",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_svchost_update_processes": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": "C:\\Windows\\System32\\svchost.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "DestinationPort": {
                "field": "DestinationPort",
                "value": 443,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218.011"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2017-11-04",
        "modified": "2024-03-13",
        "references": [
          "https://www.hybrid-analysis.com/sample/759fb4c0091a78c5ee035715afe3084686a8493f39014aea72dae36869de9ff6?environmentId=100"
        ],
        "falsepositives": [
          "Communication to other corporate systems that use IP addresses from public address spaces"
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_rundll32_net_connections.yml"
      }
    },
    {
      "id": "992a6cae-db6a-43c8-9cec-76d7195c96fc",
      "title": "Outbound Network Connection Initiated By Script Interpreter",
      "status": "test",
      "description": "Detects a script interpreter wscript/cscript opening a network connection to a non-local network. Adversaries may use script to download malicious payloads.",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1105"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\wscript.exe",
                  "\\cscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_local_ranges": {
            "type": "field_match",
            "matchers": {
              "DestinationIp__cidr": {
                "field": "DestinationIp",
                "value": [
                  "127.0.0.0/8",
                  "10.0.0.0/8",
                  "172.16.0.0/12",
                  "192.168.0.0/16",
                  "169.254.0.0/16",
                  "::1/128",
                  "fe80::/10",
                  "fc00::/7"
                ],
                "modifiers": [
                  "cidr"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_ms_ranges": {
            "type": "field_match",
            "matchers": {
              "DestinationIp__cidr": {
                "field": "DestinationIp",
                "value": "20.0.0.0/11",
                "modifiers": [
                  "cidr"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1105"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "frack113, Florian Roth (Nextron Systems)",
        "date": "2022-08-28",
        "modified": "2024-03-13",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/28d190330fe44de6ff4767fc400cc10fa7cd6540/atomics/T1105/T1105.md"
        ],
        "falsepositives": [
          "Legitimate scripts"
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_wscript_cscript_outbound_connection.yml"
      }
    },
    {
      "id": "fa5b1358-b040-4403-9868-15f7d9ab6329",
      "title": "Network Communication With Crypto Mining Pool",
      "status": "stable",
      "description": "Detects initiated network connections to crypto mining pools",
      "level": "high",
      "tags": [
        "attack.impact",
        "attack.t1496"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "DestinationHostname": {
                "field": "DestinationHostname",
                "value": [
                  "alimabi.cn",
                  "ap.luckpool.net",
                  "bcn.pool.minergate.com",
                  "bcn.vip.pool.minergate.com",
                  "bohemianpool.com",
                  "ca-aipg.miningocean.org",
                  "ca-dynex.miningocean.org",
                  "ca-neurai.miningocean.org",
                  "ca-qrl.miningocean.org",
                  "ca-upx.miningocean.org",
                  "ca-zephyr.miningocean.org",
                  "ca.minexmr.com",
                  "ca.monero.herominers.com",
                  "cbd.monerpool.org",
                  "cbdv2.monerpool.org",
                  "cryptmonero.com",
                  "crypto-pool.fr",
                  "crypto-pool.info",
                  "cryptonight-hub.miningpoolhub.com",
                  "d1pool.ddns.net",
                  "d5pool.us",
                  "daili01.monerpool.org",
                  "de-aipg.miningocean.org",
                  "de-dynex.miningocean.org",
                  "de-zephyr.miningocean.org",
                  "de.minexmr.com",
                  "dl.nbminer.com",
                  "donate.graef.in",
                  "donate.ssl.xmrig.com",
                  "donate.v2.xmrig.com",
                  "donate.xmrig.com",
                  "donate2.graef.in",
                  "drill.moneroworld.com",
                  "dwarfpool.com",
                  "emercoin.com",
                  "emercoin.net",
                  "emergate.net",
                  "ethereumpool.co",
                  "eu.luckpool.net",
                  "eu.minerpool.pw",
                  "fcn-xmr.pool.minergate.com",
                  "fee.xmrig.com",
                  "fr-aipg.miningocean.org",
                  "fr-dynex.miningocean.org",
                  "fr-neurai.miningocean.org",
                  "fr-qrl.miningocean.org",
                  "fr-upx.miningocean.org",
                  "fr-zephyr.miningocean.org",
                  "fr.minexmr.com",
                  "hellominer.com",
                  "herominers.com",
                  "hk-aipg.miningocean.org",
                  "hk-dynex.miningocean.org",
                  "hk-neurai.miningocean.org",
                  "hk-qrl.miningocean.org",
                  "hk-upx.miningocean.org",
                  "hk-zephyr.miningocean.org",
                  "huadong1-aeon.ppxxmr.com",
                  "iwanttoearn.money",
                  "jw-js1.ppxxmr.com",
                  "koto-pool.work",
                  "lhr.nbminer.com",
                  "lhr3.nbminer.com",
                  "linux.monerpool.org",
                  "lokiturtle.herominers.com",
                  "luckpool.net",
                  "masari.miner.rocks",
                  "mine.c3pool.com",
                  "mine.moneropool.com",
                  "mine.ppxxmr.com",
                  "mine.zpool.ca",
                  "mine1.ppxxmr.com",
                  "minemonero.gq",
                  "miner.ppxxmr.com",
                  "miner.rocks",
                  "minercircle.com",
                  "minergate.com",
                  "minerpool.pw",
                  "minerrocks.com",
                  "miners.pro",
                  "minerxmr.ru",
                  "minexmr.cn",
                  "minexmr.com",
                  "mining-help.ru",
                  "miningpoolhub.com",
                  "mixpools.org",
                  "moner.monerpool.org",
                  "moner1min.monerpool.org",
                  "monero-master.crypto-pool.fr",
                  "monero.crypto-pool.fr",
                  "monero.hashvault.pro",
                  "monero.herominers.com",
                  "monero.lindon-pool.win",
                  "monero.miners.pro",
                  "monero.riefly.id",
                  "monero.us.to",
                  "monerocean.stream",
                  "monerogb.com",
                  "monerohash.com",
                  "moneroocean.stream",
                  "moneropool.com",
                  "moneropool.nl",
                  "monerorx.com",
                  "monerpool.org",
                  "moriaxmr.com",
                  "mro.pool.minergate.com",
                  "multipool.us",
                  "myxmr.pw",
                  "na.luckpool.net",
                  "nanopool.org",
                  "nbminer.com",
                  "node3.luckpool.net",
                  "noobxmr.com",
                  "pangolinminer.comgandalph3000.com",
                  "pool.4i7i.com",
                  "pool.armornetwork.org",
                  "pool.cortins.tk",
                  "pool.gntl.co.uk",
                  "pool.hashvault.pro",
                  "pool.minergate.com",
                  "pool.minexmr.com",
                  "pool.monero.hashvault.pro",
                  "pool.ppxxmr.com",
                  "pool.somec.cc",
                  "pool.support",
                  "pool.supportxmr.com",
                  "pool.usa-138.com",
                  "pool.xmr.pt",
                  "pool.xmrfast.com",
                  "pool2.armornetwork.org",
                  "poolchange.ppxxmr.com",
                  "pooldd.com",
                  "poolmining.org",
                  "poolto.be",
                  "ppxvip1.ppxxmr.com",
                  "ppxxmr.com",
                  "prohash.net",
                  "r.twotouchauthentication.online",
                  "randomx.xmrig.com",
                  "ratchetmining.com",
                  "seed.emercoin.com",
                  "seed.emercoin.net",
                  "seed.emergate.net",
                  "seed1.joulecoin.org",
                  "seed2.joulecoin.org",
                  "seed3.joulecoin.org",
                  "seed4.joulecoin.org",
                  "seed5.joulecoin.org",
                  "seed6.joulecoin.org",
                  "seed7.joulecoin.org",
                  "seed8.joulecoin.org",
                  "sg-aipg.miningocean.org",
                  "sg-dynex.miningocean.org",
                  "sg-neurai.miningocean.org",
                  "sg-qrl.miningocean.org",
                  "sg-upx.miningocean.org",
                  "sg-zephyr.miningocean.org",
                  "sg.minexmr.com",
                  "sheepman.mine.bz",
                  "siamining.com",
                  "sumokoin.minerrocks.com",
                  "supportxmr.com",
                  "suprnova.cc",
                  "teracycle.net",
                  "trtl.cnpool.cc",
                  "trtl.pool.mine2gether.com",
                  "turtle.miner.rocks",
                  "us-aipg.miningocean.org",
                  "us-dynex.miningocean.org",
                  "us-neurai.miningocean.org",
                  "us-west.minexmr.com",
                  "us-zephyr.miningocean.org",
                  "usxmrpool.com",
                  "viaxmr.com",
                  "webservicepag.webhop.net",
                  "xiazai.monerpool.org",
                  "xiazai1.monerpool.org",
                  "xmc.pool.minergate.com",
                  "xmo.pool.minergate.com",
                  "xmr-asia1.nanopool.org",
                  "xmr-au1.nanopool.org",
                  "xmr-eu1.nanopool.org",
                  "xmr-eu2.nanopool.org",
                  "xmr-jp1.nanopool.org",
                  "xmr-us-east1.nanopool.org",
                  "xmr-us-west1.nanopool.org",
                  "xmr-us.suprnova.cc",
                  "xmr-usa.dwarfpool.com",
                  "xmr.2miners.com",
                  "xmr.5b6b7b.ru",
                  "xmr.alimabi.cn",
                  "xmr.bohemianpool.com",
                  "xmr.crypto-pool.fr",
                  "xmr.crypto-pool.info",
                  "xmr.f2pool.com",
                  "xmr.hashcity.org",
                  "xmr.hex7e4.ru",
                  "xmr.ip28.net",
                  "xmr.monerpool.org",
                  "xmr.mypool.online",
                  "xmr.nanopool.org",
                  "xmr.pool.gntl.co.uk",
                  "xmr.pool.minergate.com",
                  "xmr.poolto.be",
                  "xmr.ppxxmr.com",
                  "xmr.prohash.net",
                  "xmr.simka.pw",
                  "xmr.somec.cc",
                  "xmr.suprnova.cc",
                  "xmr.usa-138.com",
                  "xmr.vip.pool.minergate.com",
                  "xmr1min.monerpool.org",
                  "xmrf.520fjh.org",
                  "xmrf.fjhan.club",
                  "xmrfast.com",
                  "xmrigcc.graef.in",
                  "xmrminer.cc",
                  "xmrpool.de",
                  "xmrpool.eu",
                  "xmrpool.me",
                  "xmrpool.net",
                  "xmrpool.xyz",
                  "xx11m.monerpool.org",
                  "xx11mv2.monerpool.org",
                  "xxx.hex7e4.ru",
                  "zarabotaibitok.ru",
                  "zer0day.ru"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1496"
        ],
        "tactics": [
          "impact"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2021-10-26",
        "modified": "2024-01-19",
        "references": [
          "https://www.poolwatch.io/coin/monero",
          "https://github.com/stamparm/maltrail/blob/3ea70459b9559134449423c0a7d8b965ac5c40ea/trails/static/suspicious/crypto_mining.txt",
          "https://www.virustotal.com/gui/search/behaviour_network%253A*.miningocean.org/files"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_domain_crypto_mining_pools.yml"
      }
    },
    {
      "id": "25eabf56-22f0-4915-a1ed-056b8dae0a68",
      "title": "Suspicious Dropbox API Usage",
      "status": "test",
      "description": "Detects an executable that isn't dropbox but communicates with the Dropbox API",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.exfiltration",
        "attack.t1105",
        "attack.t1567.002"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "DestinationHostname__endswith": {
                "field": "DestinationHostname",
                "value": [
                  "api.dropboxapi.com",
                  "content.dropboxapi.com"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_legit_dropbox": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": "\\Dropbox",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1105",
          "T1567.002"
        ],
        "tactics": [
          "command_and_control",
          "exfiltration"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-04-20",
        "modified": "",
        "references": [
          "https://app.any.run/tasks/7e906adc-9d11-447f-8641-5f40375ecebb",
          "https://www.zscaler.com/blogs/security-research/new-espionage-attack-molerats-apt-targeting-users-middle-east"
        ],
        "falsepositives": [
          "Legitimate use of the API with a tool that the author wasn't aware of"
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_domain_dropbox_api.yml"
      }
    },
    {
      "id": "18249279-932f-45e2-b37a-8925f2597670",
      "title": "Process Initiated Network Connection To Ngrok Domain",
      "status": "test",
      "description": "Detects an executable initiating a network connection to \"ngrok\" domains.\nAttackers were seen using this \"ngrok\" in order to store their second stage payloads and malware.\nWhile communication with such domains can be legitimate, often times is a sign of either data exfiltration by malicious actors or additional download.\n",
      "level": "high",
      "tags": [
        "attack.exfiltration",
        "attack.command-and-control",
        "attack.t1567",
        "attack.t1572",
        "attack.t1102"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "DestinationHostname__endswith": {
                "field": "DestinationHostname",
                "value": [
                  ".ngrok-free.app",
                  ".ngrok-free.dev",
                  ".ngrok.app",
                  ".ngrok.dev",
                  ".ngrok.io"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1567",
          "T1572",
          "T1102"
        ],
        "tactics": [
          "exfiltration",
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-07-16",
        "modified": "2025-07-30",
        "references": [
          "https://ngrok.com/",
          "https://ngrok.com/blog-post/new-ngrok-domains",
          "https://www.virustotal.com/gui/file/cca0c1182ac114b44dc52dd2058fcd38611c20bb6b5ad84710681d38212f835a/",
          "https://www.rnbo.gov.ua/files/2023_YEAR/CYBERCENTER/november/APT29%20attacks%20Embassies%20using%20CVE-2023-38831%20-%20report%20en.pdf"
        ],
        "falsepositives": [
          "Legitimate use of the ngrok service."
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_domain_ngrok.yml"
      }
    },
    {
      "id": "c7e91a02-d771-4a6d-a700-42587e0b1095",
      "title": "Network Connection Initiated By Regsvr32.EXE",
      "status": "test",
      "description": "Detects a network connection initiated by \"Regsvr32.exe\"",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1559.001",
        "attack.defense-evasion",
        "attack.t1218.010"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\regsvr32.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1559.001",
          "T1218.010"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Dmitriy Lifanov, oscd.community",
        "date": "2019-10-25",
        "modified": "2023-09-18",
        "references": [
          "https://pentestlab.blog/2017/05/11/applocker-bypass-regsvr32/",
          "https://oddvar.moe/2017/12/13/applocker-case-study-how-insecure-is-it-really-part-1/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_regsvr32_network_activity.yml"
      }
    },
    {
      "id": "e0f8ab85-0ac9-423b-a73a-81b3c7b1aa97",
      "title": "Network Communication Initiated To File Sharing Domains From Process Located In Suspicious Folder",
      "status": "test",
      "description": "Detects executables located in potentially suspicious directories initiating network connections towards file sharing domains.",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1105"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_paths": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  ":\\$Recycle.bin",
                  ":\\Perflogs\\",
                  ":\\Temp\\",
                  ":\\Users\\Default\\",
                  ":\\Users\\Public\\",
                  ":\\Windows\\Fonts\\",
                  ":\\Windows\\IME\\",
                  ":\\Windows\\System32\\Tasks\\",
                  ":\\Windows\\Tasks\\",
                  ":\\Windows\\Temp\\",
                  "\\AppData\\Temp\\",
                  "\\config\\systemprofile\\",
                  "\\Windows\\addins\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_domains": {
            "type": "field_match",
            "matchers": {
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "DestinationHostname__endswith": {
                "field": "DestinationHostname",
                "value": [
                  ".githubusercontent.com",
                  "anonfiles.com",
                  "cdn.discordapp.com",
                  "ddns.net",
                  "dl.dropboxusercontent.com",
                  "ghostbin.co",
                  "github.com",
                  "glitch.me",
                  "gofile.io",
                  "hastebin.com",
                  "mediafire.com",
                  "mega.co.nz",
                  "mega.nz",
                  "onrender.com",
                  "pages.dev",
                  "paste.ee",
                  "pastebin.com",
                  "pastebin.pl",
                  "pastetext.net",
                  "pixeldrain.com",
                  "privatlab.com",
                  "privatlab.net",
                  "send.exploit.in",
                  "sendspace.com",
                  "storage.googleapis.com",
                  "storjshare.io",
                  "supabase.co",
                  "temp.sh",
                  "transfer.sh",
                  "trycloudflare.com",
                  "ufile.io",
                  "w3spaces.com",
                  "workers.dev"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1105"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2018-08-30",
        "modified": "2025-12-10",
        "references": [
          "https://twitter.com/M_haggis/status/900741347035889665",
          "https://twitter.com/M_haggis/status/1032799638213066752",
          "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ransomware-hive-conti-avoslocker",
          "https://www.cisa.gov/uscert/ncas/alerts/aa22-321a",
          "https://github.com/EmpireProject/Empire/blob/e37fb2eef8ff8f5a0a689f1589f424906fe13055/data/module_source/exfil/Invoke-ExfilDataToGitHub.ps1"
        ],
        "falsepositives": [
          "Some installers located in the temp directory might communicate with the Github domains in order to download additional software. Baseline these cases or move the github domain to a lower level hunting rule."
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_susp_file_sharing_domains_susp_folders.yml"
      }
    },
    {
      "id": "d58ba5c6-0ed7-4b9d-a433-6878379efda9",
      "title": "Remote Access Tool - AnyDesk Incoming Connection",
      "status": "experimental",
      "description": "Detects incoming connections to AnyDesk. This could indicate a potential remote attacker trying to connect to a listening instance of AnyDesk and use it as potential command and control channel.\n",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.command-and-control",
        "attack.t1219.002"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\AnyDesk.exe",
                  "\\AnyDeskMSI.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Initiated": {
                "field": "Initiated",
                "value": "false",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1219.002"
        ],
        "tactics": [
          "persistence",
          "command_and_control"
        ]
      },
      "meta": {
        "author": "@d4ns4n_ (Wuerth-Phoenix)",
        "date": "2024-09-02",
        "modified": "2025-02-24",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-2---anydesk-files-detected-test-on-windows",
          "https://asec.ahnlab.com/en/40263/"
        ],
        "falsepositives": [
          "Legitimate incoming connections (e.g. sysadmin activity). Most of the time I would expect outgoing connections (initiated locally)."
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_remote_access_tools_anydesk_incoming_connection.yml"
      }
    },
    {
      "id": "07837ab9-60e1-481f-a74d-c31fb496a94c",
      "title": "Network Communication Initiated To Portmap.IO Domain",
      "status": "test",
      "description": "Detects an executable accessing the portmap.io domain, which could be a sign of forbidden C2 traffic or data exfiltration by malicious actors",
      "level": "medium",
      "tags": [
        "attack.t1041",
        "attack.command-and-control",
        "attack.t1090.002",
        "attack.exfiltration"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "DestinationHostname__endswith": {
                "field": "DestinationHostname",
                "value": ".portmap.io",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1041",
          "T1090.002"
        ],
        "tactics": [
          "command_and_control",
          "exfiltration"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2024-05-31",
        "modified": "",
        "references": [
          "https://portmap.io/",
          "https://github.com/rapid7/metasploit-framework/issues/11337",
          "https://pro.twitter.com/JaromirHorejsi/status/1795001037746761892/photo/2"
        ],
        "falsepositives": [
          "Legitimate use of portmap.io domains"
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_domain_portmap.yml"
      }
    },
    {
      "id": "5f699bc5-5446-4a4a-a0b7-5ef2885a3eb4",
      "title": "RDP Over Reverse SSH Tunnel",
      "status": "test",
      "description": "Detects svchost hosting RDP termsvcs communicating with the loopback address and on TCP port 3389",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1572",
        "attack.lateral-movement",
        "attack.t1021.001",
        "car.2013-07-002"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\svchost.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "SourcePort": {
                "field": "SourcePort",
                "value": 3389,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_destination": {
            "type": "field_match",
            "matchers": {
              "DestinationIp__cidr": {
                "field": "DestinationIp",
                "value": [
                  "127.0.0.0/8",
                  "::1/128"
                ],
                "modifiers": [
                  "cidr"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1572",
          "T1021.001"
        ],
        "tactics": [
          "command_and_control",
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Samir Bousseaden",
        "date": "2019-02-16",
        "modified": "2024-03-12",
        "references": [
          "https://twitter.com/cyb3rops/status/1096842275437625346"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_rdp_reverse_tunnel.yml"
      }
    },
    {
      "id": "75e33ce3-ae32-4dcc-9aa8-a2a3029d6f84",
      "title": "Office Application Initiated Network Connection To Non-Local IP",
      "status": "test",
      "description": "Detects an office application (Word, Excel, PowerPoint)  that initiate a network connection to a non-private IP addresses.\nThis rule aims to detect traffic similar to one seen exploited in CVE-2021-42292.\nThis rule will require an initial baseline and tuning that is specific to your organization.\n",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1203"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\excel.exe",
                  "\\outlook.exe",
                  "\\powerpnt.exe",
                  "\\winword.exe",
                  "\\wordview.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_local_ranges": {
            "type": "field_match",
            "matchers": {
              "DestinationIp__cidr": {
                "field": "DestinationIp",
                "value": [
                  "127.0.0.0/8",
                  "10.0.0.0/8",
                  "172.16.0.0/12",
                  "192.168.0.0/16",
                  "169.254.0.0/16",
                  "::1/128",
                  "fe80::/10",
                  "fc00::/7"
                ],
                "modifiers": [
                  "cidr"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_msrange_generic": {
            "type": "field_match",
            "matchers": {
              "DestinationIp__cidr": {
                "field": "DestinationIp",
                "value": [
                  "2.16.56.0/23",
                  "2.17.248.0/21",
                  "13.107.240.0/21",
                  "20.184.0.0/13",
                  "23.61.224.0/20",
                  "20.192.0.0/10",
                  "23.72.0.0/13",
                  "23.3.88.0/22",
                  "23.216.132.0/22",
                  "40.76.0.0/14",
                  "51.10.0.0/15",
                  "51.103.0.0/16",
                  "51.104.0.0/15",
                  "51.142.136.0/22",
                  "52.160.0.0/11",
                  "95.101.96.0/21",
                  "204.79.197.0/24"
                ],
                "modifiers": [
                  "cidr"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_msrange_exchange_1": {
            "type": "field_match",
            "matchers": {
              "DestinationIp__cidr": {
                "field": "DestinationIp",
                "value": [
                  "13.107.4.0/22",
                  "13.107.6.152/31",
                  "13.107.18.10/31",
                  "13.107.42.0/23",
                  "13.107.128.0/22",
                  "23.35.224.0/20",
                  "23.53.40.0/22",
                  "23.103.160.0/20",
                  "23.216.76.0/22",
                  "40.96.0.0/13",
                  "40.104.0.0/15",
                  "52.96.0.0/14",
                  "131.253.33.215/32",
                  "132.245.0.0/16",
                  "150.171.32.0/22",
                  "204.79.197.215/32",
                  "2603:1006::/40",
                  "2603:1016::/36",
                  "2603:1026::/36",
                  "2603:1036::/36",
                  "2603:1046::/36",
                  "2603:1056::/36",
                  "2620:1ec:4::152/128",
                  "2620:1ec:4::153/128",
                  "2620:1ec:c::10/128",
                  "2620:1ec:c::11/128",
                  "2620:1ec:d::10/128",
                  "2620:1ec:d::11/128",
                  "2620:1ec:8f0::/46",
                  "2620:1ec:900::/46",
                  "2620:1ec:a92::152/128",
                  "2620:1ec:a92::153/128"
                ],
                "modifiers": [
                  "cidr"
                ],
                "is_list": true,
                "negated": false
              },
              "DestinationPort": {
                "field": "DestinationPort",
                "value": [
                  80,
                  443
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_msrange_exchange_2": {
            "type": "field_match",
            "matchers": {
              "DestinationIp__cidr": {
                "field": "DestinationIp",
                "value": [
                  "13.107.6.152/31",
                  "13.107.18.10/31",
                  "13.107.128.0/22",
                  "23.103.160.0/20",
                  "40.96.0.0/13",
                  "40.104.0.0/15",
                  "52.96.0.0/14",
                  "131.253.33.215/32",
                  "132.245.0.0/16",
                  "150.171.32.0/22",
                  "204.79.197.215/32",
                  "2603:1006::/40",
                  "2603:1016::/36",
                  "2603:1026::/36",
                  "2603:1036::/36",
                  "2603:1046::/36",
                  "2603:1056::/36",
                  "2620:1ec:4::152/128",
                  "2620:1ec:4::153/128",
                  "2620:1ec:c::10/128",
                  "2620:1ec:c::11/128",
                  "2620:1ec:d::10/128",
                  "2620:1ec:d::11/128",
                  "2620:1ec:8f0::/46",
                  "2620:1ec:900::/46",
                  "2620:1ec:a92::152/128",
                  "2620:1ec:a92::153/128"
                ],
                "modifiers": [
                  "cidr"
                ],
                "is_list": true,
                "negated": false
              },
              "DestinationPort": {
                "field": "DestinationPort",
                "value": [
                  143,
                  587,
                  993,
                  995
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "Protocol": {
                "field": "Protocol",
                "value": "tcp",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_msrange_exchange_3": {
            "type": "field_match",
            "matchers": {
              "DestinationIp__cidr": {
                "field": "DestinationIp",
                "value": [
                  "40.92.0.0/15",
                  "40.107.0.0/16",
                  "52.100.0.0/14",
                  "52.238.78.88/32",
                  "104.47.0.0/17",
                  "2a01:111:f400::/48",
                  "2a01:111:f403::/48"
                ],
                "modifiers": [
                  "cidr"
                ],
                "is_list": true,
                "negated": false
              },
              "DestinationPort": {
                "field": "DestinationPort",
                "value": 443,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_msrange_exchange_4": {
            "type": "field_match",
            "matchers": {
              "DestinationIp__cidr": {
                "field": "DestinationIp",
                "value": [
                  "40.92.0.0/15",
                  "40.107.0.0/16",
                  "52.100.0.0/14",
                  "52.238.78.88/32",
                  "104.47.0.0/17",
                  "2a01:111:f400::/48",
                  "2a01:111:f403::/48"
                ],
                "modifiers": [
                  "cidr"
                ],
                "is_list": true,
                "negated": false
              },
              "DestinationPort": {
                "field": "DestinationPort",
                "value": 25,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_msrange_sharepoint_1": {
            "type": "field_match",
            "matchers": {
              "DestinationIp__cidr": {
                "field": "DestinationIp",
                "value": [
                  "13.107.136.0/22",
                  "40.108.128.0/17",
                  "52.104.0.0/14",
                  "104.146.128.0/17",
                  "150.171.40.0/22",
                  "2603:1061:1300::/40",
                  "2620:1ec:8f8::/46",
                  "2620:1ec:908::/46",
                  "2a01:111:f402::/48"
                ],
                "modifiers": [
                  "cidr"
                ],
                "is_list": true,
                "negated": false
              },
              "DestinationPort": {
                "field": "DestinationPort",
                "value": [
                  80,
                  443
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "Protocol": {
                "field": "Protocol",
                "value": "tcp",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_msrange_office_1": {
            "type": "field_match",
            "matchers": {
              "DestinationIp__cidr": {
                "field": "DestinationIp",
                "value": [
                  "13.107.6.171/32",
                  "13.107.18.15/32",
                  "13.107.140.6/32",
                  "20.64.0.0/10",
                  "52.108.0.0/14",
                  "52.244.37.168/32",
                  "2603:1006:1400::/40",
                  "2603:1016:2400::/40",
                  "2603:1026:2400::/40",
                  "2603:1036:2400::/40",
                  "2603:1046:1400::/40",
                  "2603:1056:1400::/40",
                  "2603:1063:2000::/38",
                  "2620:1ec:c::15/128",
                  "2620:1ec:8fc::6/128",
                  "2620:1ec:a92::171/128",
                  "2a01:111:f100:2000::a83e:3019/128",
                  "2a01:111:f100:2002::8975:2d79/128",
                  "2a01:111:f100:2002::8975:2da8/128",
                  "2a01:111:f100:7000::6fdd:6cd5/128",
                  "2a01:111:f100:a004::bfeb:88cf/128"
                ],
                "modifiers": [
                  "cidr"
                ],
                "is_list": true,
                "negated": false
              },
              "DestinationPort": {
                "field": "DestinationPort",
                "value": [
                  80,
                  443
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "Protocol": {
                "field": "Protocol",
                "value": "tcp",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_msrange_office_2": {
            "type": "field_match",
            "matchers": {
              "DestinationIp__cidr": {
                "field": "DestinationIp",
                "value": [
                  "172.128.0.0/10",
                  "20.20.32.0/19",
                  "20.103.156.88/32",
                  "20.190.128.0/18",
                  "20.231.128.0/19",
                  "40.126.0.0/18",
                  "57.150.0.0/15",
                  "2603:1006:2000::/48",
                  "2603:1007:200::/48",
                  "2603:1016:1400::/48",
                  "2603:1017::/48",
                  "2603:1026:3000::/48",
                  "2603:1027:1::/48",
                  "2603:1036:3000::/48",
                  "2603:1037:1::/48",
                  "2603:1046:2000::/48",
                  "2603:1047:1::/48",
                  "2603:1056:2000::/48",
                  "2603:1057:2::/48"
                ],
                "modifiers": [
                  "cidr"
                ],
                "is_list": true,
                "negated": false
              },
              "DestinationPort": {
                "field": "DestinationPort",
                "value": [
                  80,
                  443
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "Protocol": {
                "field": "Protocol",
                "value": "tcp",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_msrange_office_3": {
            "type": "field_match",
            "matchers": {
              "DestinationIp__cidr": {
                "field": "DestinationIp",
                "value": [
                  "13.64.0.0/11",
                  "13.107.6.192/32",
                  "13.107.9.192/32",
                  "13.89.179.14/32",
                  "20.40.0.0/14",
                  "20.48.0.0/12",
                  "20.64.0.0/12",
                  "52.123.0.0/16",
                  "52.108.0.0/14",
                  "52.136.0.0/13",
                  "57.150.0.0/15",
                  "80.239.150.67/32",
                  "2620:1ec:4::192/128",
                  "2620:1ec:a92::192/128"
                ],
                "modifiers": [
                  "cidr"
                ],
                "is_list": true,
                "negated": false
              },
              "DestinationPort": {
                "field": "DestinationPort",
                "value": 443,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Protocol": {
                "field": "Protocol",
                "value": "tcp",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_destination_host": {
            "type": "field_match",
            "matchers": {
              "DestinationHostname__endswith": {
                "field": "DestinationHostname",
                "value": ".deploy.static.akamaitechnologies.com",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "DestinationPort": {
                "field": "DestinationPort",
                "value": 443,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Protocol": {
                "field": "Protocol",
                "value": "tcp",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1203"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Christopher Peacock '@securepeacock', SCYTHE '@scythe_io', Florian Roth (Nextron Systems), Tim Shelton, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2021-11-10",
        "modified": "2025-10-17",
        "references": [
          "https://corelight.com/blog/detecting-cve-2021-42292",
          "https://learn.microsoft.com/de-de/microsoft-365/enterprise/urls-and-ip-address-ranges?view=o365-worldwide"
        ],
        "falsepositives": [
          "You may have to tune certain domains out that Excel may call out to, such as microsoft or other business use case domains.",
          "Office documents commonly have templates that refer to external addresses, like \"sharepoint.ourcompany.com\" may have to be tuned.",
          "It is highly recommended to baseline your activity and tune out common business use cases."
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_office_outbound_non_local_ip.yml"
      }
    },
    {
      "id": "9501f8e6-8e3d-48fc-a8a6-1089dd5d7ef4",
      "title": "Network Connection Initiated To DevTunnels Domain",
      "status": "test",
      "description": "Detects network connections to Devtunnels domains initiated by a process on a system. Attackers can abuse that feature to establish a reverse shell or persistence on a machine.\n",
      "level": "medium",
      "tags": [
        "attack.exfiltration",
        "attack.command-and-control",
        "attack.t1567.001",
        "attack.t1572"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "DestinationHostname__endswith": {
                "field": "DestinationHostname",
                "value": ".devtunnels.ms",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1567.001",
          "T1572"
        ],
        "tactics": [
          "exfiltration",
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Kamran Saifullah",
        "date": "2023-11-20",
        "modified": "",
        "references": [
          "https://blueteamops.medium.com/detecting-dev-tunnels-16f0994dc3e2",
          "https://learn.microsoft.com/en-us/azure/developer/dev-tunnels/security",
          "https://cydefops.com/devtunnels-unleashed"
        ],
        "falsepositives": [
          "Legitimate use of Devtunnels will also trigger this."
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_domain_devtunnels.yml"
      }
    },
    {
      "id": "50e54b8d-ad73-43f8-96a1-5191685b17a4",
      "title": "Silenttrinity Stager Msbuild Activity",
      "status": "test",
      "description": "Detects a possible remote connections to Silenttrinity c2",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.defense-evasion",
        "attack.t1127.001"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\msbuild.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "DestinationPort": {
                "field": "DestinationPort",
                "value": [
                  80,
                  443
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and filter",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "ref",
              "value": "filter"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1127.001"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Kiran kumar s, oscd.community",
        "date": "2020-10-11",
        "modified": "2022-10-05",
        "references": [
          "https://www.blackhillsinfosec.com/my-first-joyride-with-silenttrinity/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_silenttrinity_stager_msbuild_activity.yml"
      }
    },
    {
      "id": "4b657234-038e-4ad5-997c-4be42340bce4",
      "title": "Network Connection Initiated To Visual Studio Code Tunnels Domain",
      "status": "test",
      "description": "Detects network connections to Visual Studio Code tunnel domains initiated by a process on a system. Attackers can abuse that feature to establish a reverse shell or persistence on a machine.\n",
      "level": "medium",
      "tags": [
        "attack.exfiltration",
        "attack.command-and-control",
        "attack.t1567",
        "attack.t1572"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "DestinationHostname__endswith": {
                "field": "DestinationHostname",
                "value": ".tunnels.api.visualstudio.com",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1567",
          "T1572"
        ],
        "tactics": [
          "exfiltration",
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Kamran Saifullah",
        "date": "2023-11-20",
        "modified": "",
        "references": [
          "https://ipfyx.fr/post/visual-studio-code-tunnel/",
          "https://badoption.eu/blog/2023/01/31/code_c2.html",
          "https://cydefops.com/vscode-data-exfiltration"
        ],
        "falsepositives": [
          "Legitimate use of Visual Studio Code tunnel will also trigger this."
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_domain_vscode_tunnel_connection.yml"
      }
    },
    {
      "id": "3ab65069-d82a-4d44-a759-466661a082d1",
      "title": "Communication To LocaltoNet Tunneling Service Initiated",
      "status": "test",
      "description": "Detects an executable initiating a network connection to \"LocaltoNet\" tunneling sub-domains.\nLocaltoNet is a reverse proxy that enables localhost services to be exposed to the Internet.\nAttackers have been seen to use this service for command-and-control activities to bypass MFA and perimeter controls.\n",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1572",
        "attack.t1090",
        "attack.t1102"
      ],
      "logsource": {
        "category": "network_connection",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "DestinationHostname__endswith": {
                "field": "DestinationHostname",
                "value": [
                  ".localto.net",
                  ".localtonet.com"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Initiated": {
                "field": "Initiated",
                "value": "true",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1572",
          "T1090",
          "T1102"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Andreas Braathen (mnemonic.io)",
        "date": "2024-06-17",
        "modified": "",
        "references": [
          "https://localtonet.com/documents/supported-tunnels",
          "https://cloud.google.com/blog/topics/threat-intelligence/unc3944-targets-saas-applications"
        ],
        "falsepositives": [
          "Legitimate use of the LocaltoNet service."
        ],
        "source_file": "sigma_rules/windows/network_connection/net_connection_win_domain_localtonet_tunnel.yml"
      }
    }
  ]
}