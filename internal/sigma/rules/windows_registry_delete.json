{
  "metadata": {
    "logsource": "windows_registry_delete",
    "rule_count": 9,
    "compiled_at": "2026-02-04T12:28:36.531128",
    "version": "1.1"
  },
  "rules": [
    {
      "id": "acd74772-5f88-45c7-956b-6a7b36c294d2",
      "title": "Removal Of SD Value to Hide Schedule Task - Registry",
      "status": "test",
      "description": "Remove SD (Security Descriptor) value in \\Schedule\\TaskCache\\Tree registry hive to hide schedule task. This technique is used by Tarrask malware",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562"
      ],
      "logsource": {
        "category": "registry_delete",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains_all": {
                "field": "TargetObject",
                "value": [
                  "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree\\",
                  "SD"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Sittikorn S",
        "date": "2022-04-15",
        "modified": "2025-10-25",
        "references": [
          "https://www.microsoft.com/security/blog/2022/04/12/tarrask-malware-uses-scheduled-tasks-for-defense-evasion/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_delete/registry_delete_schtasks_hide_task_via_sd_value_removal.yml"
      }
    },
    {
      "id": "272e55a4-9e6b-4211-acb6-78f51f0b1b40",
      "title": "Folder Removed From Exploit Guard ProtectedFolders List - Registry",
      "status": "test",
      "description": "Detects the removal of folders from the \"ProtectedFolders\" list of of exploit guard. This could indicate an attacker trying to launch an encryption process or trying to manipulate data inside of the protected folder",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "registry_delete",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventType": {
                "field": "EventType",
                "value": "DeleteValue",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "SOFTWARE\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\Controlled Folder Access\\ProtectedFolders",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-05",
        "modified": "2023-02-08",
        "references": [
          "https://www.microsoft.com/security/blog/2017/10/23/windows-defender-exploit-guard-reduce-the-attack-surface-against-next-generation-malware/"
        ],
        "falsepositives": [
          "Legitimate administrators removing applications (should always be investigated)"
        ],
        "source_file": "sigma_rules/windows/registry/registry_delete/registry_delete_exploit_guard_protected_folders.yml"
      }
    },
    {
      "id": "5dfc1465-8f65-4fde-8eb5-6194380c6a62",
      "title": "Windows Recall Feature Enabled - DisableAIDataAnalysis Value Deleted",
      "status": "test",
      "description": "Detects the enabling of the Windows Recall feature via registry manipulation. Windows Recall can be enabled by deleting the existing \"DisableAIDataAnalysis\" registry value.\nAdversaries may enable Windows Recall as part of post-exploitation discovery and collection activities.\nThis rule assumes that Recall is already explicitly disabled on the host, and subsequently enabled by the adversary.\n",
      "level": "medium",
      "tags": [
        "attack.collection",
        "attack.t1113"
      ],
      "logsource": {
        "category": "registry_delete",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventType": {
                "field": "EventType",
                "value": "DeleteValue",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Microsoft\\Windows\\WindowsAI\\DisableAIDataAnalysis",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1113"
        ],
        "tactics": [
          "collection"
        ]
      },
      "meta": {
        "author": "Sajid Nawaz Khan",
        "date": "2024-06-02",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/windows/client-management/manage-recall",
          "https://learn.microsoft.com/en-us/windows/client-management/mdm/policy-csp-windowsai#disableaidataanalysis"
        ],
        "falsepositives": [
          "Legitimate use/activation of Windows Recall"
        ],
        "source_file": "sigma_rules/windows/registry/registry_delete/registry_delete_enable_windows_recall.yml"
      }
    },
    {
      "id": "72a0369a-2576-4aaf-bfc9-6bb24a574ac6",
      "title": "Delete Defender Scan ShellEx Context Menu Registry Key",
      "status": "experimental",
      "description": "Detects deletion of registry key that adds 'Scan with Defender' option in context menu. Attackers may use this to make it harder for users to scan files that are suspicious.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "registry_delete",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "shellex\\ContextMenuHandlers\\EPP",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_defender": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\",
                  "C:\\Program Files\\Windows Defender\\",
                  "C:\\Program Files (x86)\\Windows Defender\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\MsMpEng.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Matt Anderson (Huntress)",
        "date": "2025-07-11",
        "modified": "2025-10-07",
        "references": [
          "https://research.splunk.com/endpoint/395ed5fe-ad13-4366-9405-a228427bdd91/",
          "https://winaero.com/how-to-delete-scan-with-windows-defender-from-context-menu-in-windows-10/",
          "https://thedfirreport.com/2021/10/18/icedid-to-xinglocker-ransomware-in-24-hours/",
          "https://blog.malwarebytes.com/malwarebytes-news/2021/02/lazyscripter-from-empire-to-double-rat/"
        ],
        "falsepositives": [
          "Unlikely as this weakens defenses and normally would not be done even if using another AV."
        ],
        "source_file": "sigma_rules/windows/registry/registry_delete/registry_delete_defender_context_menu.yml"
      }
    },
    {
      "id": "526cc8bc-1cdc-48ad-8b26-f19bff969cec",
      "title": "Removal Of Index Value to Hide Schedule Task - Registry",
      "status": "test",
      "description": "Detects when the \"index\" value of a scheduled task is removed or deleted from the registry. Which effectively hides it from any tooling such as \"schtasks /query\"",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562"
      ],
      "logsource": {
        "category": "registry_delete",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains_all": {
                "field": "TargetObject",
                "value": [
                  "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree\\",
                  "Index"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-26",
        "modified": "2025-10-25",
        "references": [
          "https://blog.qualys.com/vulnerabilities-threat-research/2022/06/20/defending-against-scheduled-task-attacks-in-windows-environments"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_delete/registry_delete_schtasks_hide_task_via_index_value_removal.yml"
      }
    },
    {
      "id": "07bdd2f5-9c58-4f38-aec8-e101bb79ef8d",
      "title": "Terminal Server Client Connection History Cleared - Registry",
      "status": "test",
      "description": "Detects the deletion of registry keys containing the MSTSC connection history",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1070",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_delete",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection1": {
            "type": "field_match",
            "matchers": {
              "EventType": {
                "field": "EventType",
                "value": "DeleteValue",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Microsoft\\Terminal Server Client\\Default\\MRU",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection2": {
            "type": "field_match",
            "matchers": {
              "EventType": {
                "field": "EventType",
                "value": "DeleteKey",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Microsoft\\Terminal Server Client\\Servers\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1070",
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Christian Burkard (Nextron Systems)",
        "date": "2021-10-19",
        "modified": "2023-02-08",
        "references": [
          "https://learn.microsoft.com/en-us/troubleshoot/windows-server/remote/remove-entries-from-remote-desktop-connection-computer",
          "http://woshub.com/how-to-clear-rdp-connections-history/",
          "https://www.trendmicro.com/en_us/research/23/a/vice-society-ransomware-group-targets-manufacturing-companies.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_delete/registry_delete_mstsc_history_cleared.yml"
      }
    },
    {
      "id": "41d1058a-aea7-4952-9293-29eaaf516465",
      "title": "Removal Of AMSI Provider Registry Keys",
      "status": "test",
      "description": "Detects the deletion of AMSI provider registry key entries in HKLM\\Software\\Microsoft\\AMSI. This technique could be used by an attacker in order to disable AMSI inspection.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "registry_delete",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "{2781761E-28E0-4109-99FE-B9D127C57AFE}",
                  "{A7C452EF-8E9F-42EB-9F2B-245613CA0DC9}"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_defender": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\",
                  "C:\\Program Files\\Windows Defender\\",
                  "C:\\Program Files (x86)\\Windows Defender\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\MsMpEng.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-06-07",
        "modified": "2025-10-07",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md",
          "https://seclists.org/fulldisclosure/2020/Mar/45"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/registry/registry_delete/registry_delete_removal_amsi_registry_key.yml"
      }
    },
    {
      "id": "96f697b0-b499-4e5d-9908-a67bec11cdb6",
      "title": "Removal of Potential COM Hijacking Registry Keys",
      "status": "test",
      "description": "Detects any deletion of entries in \".*\\shell\\open\\command\" registry keys.\nThese registry keys might have been used for COM hijacking activities by a threat actor or an attacker and the deletion could indicate steps to remove its tracks.\n",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_delete",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\shell\\open\\command",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_explorer": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "C:\\Windows\\explorer.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_svchost": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\system32\\svchost.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_msiexec": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Windows\\System32\\msiexec.exe",
                  "C:\\Windows\\SysWOW64\\msiexec.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_generic_prorams": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\",
                  "C:\\Program Files (x86)\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_openwith": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\System32\\OpenWith.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_dropbox": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\Dropbox.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Dropbox.",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_wireshark": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\AppData\\Local\\Temp\\Wireshark_uninstaller.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\wireshark-capture-file\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_peazip": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": "peazip",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\PeaZip.",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_everything": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\Everything.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Everything.",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_uninstallers": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Windows\\Installer\\MSI",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_java": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Program Files (x86)\\Java\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\installer.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Classes\\WOW6432Node\\CLSID\\{4299124F-F2C3-41b4-9C73-9236B2AD0E8F}",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_edgeupdate": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": "\\Microsoft\\EdgeUpdate\\Install",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_avira": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\Avira\\Antivirus\\",
                  "C:\\Program Files\\Avira\\Antivirus\\"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "\\CLSID\\{305CA226-D286-468e-B848-2B2E8E697B74}\\Shell\\Open\\Command",
                  "\\AntiVir.Keyfile\\shell\\open\\command"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_installer_temp": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__contains_all": {
                    "field": "Image",
                    "value": [
                      "AppData\\Local\\Temp",
                      "\\setup.exe"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__contains_all": {
                    "field": "Image",
                    "value": [
                      "\\Temp\\is-",
                      "\\target.tmp"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "filter_optional_ninite": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\ninite.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_discord": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\reg.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Discord\\shell\\open\\command",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_spotify": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\Spotify.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Spotify\\shell\\open\\command",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_eclipse": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "C:\\eclipse\\eclipse.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "_Classes\\eclipse+",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_teamviewer": {
            "type": "field_match",
            "matchers": {
              "Image__contains_all": {
                "field": "Image",
                "value": [
                  "\\Temp",
                  "\\TeamViewer"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
        "date": "2020-05-02",
        "modified": "2025-10-07",
        "references": [
          "https://github.com/OTRF/detection-hackathon-apt29/issues/7",
          "https://github.com/OTRF/ThreatHunter-Playbook/blob/2d4257f630f4c9770f78d0c1df059f891ffc3fec/docs/evals/apt29/detections/3.C.1_22A46621-7A92-48C1-81BF-B3937EB4FDC3.md",
          "https://learn.microsoft.com/en-us/windows/win32/shell/launch",
          "https://learn.microsoft.com/en-us/windows/win32/api/shobjidl_core/nn-shobjidl_core-iexecutecommand",
          "https://learn.microsoft.com/en-us/windows/win32/shell/shell-and-managed-code"
        ],
        "falsepositives": [
          "Legitimate software (un)installations are known to cause false positives. Please add them as a filter when encountered"
        ],
        "source_file": "sigma_rules/windows/registry/registry_delete/registry_delete_removal_com_hijacking_registry_key.yml"
      }
    },
    {
      "id": "3a9b8c1e-5b2e-4f7a-9d1c-2a7f3b6e1c55",
      "title": "RunMRU Registry Key Deletion - Registry",
      "status": "experimental",
      "description": "Detects attempts to delete the RunMRU registry key, which stores the history of commands executed via the run dialog.\nIn the clickfix techniques, the phishing lures instruct users to open a run dialog through (Win + R) and execute malicious commands.\nAdversaries may delete this key to cover their tracks after executing commands.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1070.003"
      ],
      "logsource": {
        "category": "registry_delete",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RunMRU",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1070.003"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-09-25",
        "modified": "",
        "references": [
          "https://www.zscaler.com/blogs/security-research/coldriver-updates-arsenal-baitswitch-and-simplefix"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_delete/registry_delete_runmru.yml"
      }
    }
  ]
}