{
  "metadata": {
    "logsource": "windows_security",
    "rule_count": 144,
    "compiled_at": "2026-02-04T12:28:36.551717",
    "version": "1.1"
  },
  "rules": [
    {
      "id": "f598ea0c-c25a-4f72-a219-50c44411c791",
      "title": "Possible Shadow Credentials Added",
      "status": "test",
      "description": "Detects possible addition of shadow credentials to an active directory object.",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.credential-access",
        "attack.t1556"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 5136,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "AttributeLDAPDisplayName": {
                "field": "AttributeLDAPDisplayName",
                "value": "msDS-KeyCredentialLink",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1556"
        ],
        "tactics": [
          "persistence",
          "defense_evasion",
          "credential_access"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), Elastic (idea)",
        "date": "2022-10-17",
        "modified": "",
        "references": [
          "https://www.elastic.co/guide/en/security/8.4/potential-shadow-credentials-added-to-ad-object.html",
          "https://cyberstoph.org/posts/2022/03/detecting-shadow-credentials/",
          "https://twitter.com/SBousseaden/status/1581300963650187264?"
        ],
        "falsepositives": [
          "Modifications in the msDS-KeyCredentialLink attribute can be done legitimately by the Azure AD Connect synchronization account or the ADFS service account. These accounts can be added as Exceptions. (From elastic FP section)"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_susp_possible_shadow_credentials_added.yml"
      }
    },
    {
      "id": "cfeed607-6aa4-4bbd-9627-b637deb723c8",
      "title": "New or Renamed User Account with '$' Character",
      "status": "test",
      "description": "Detects the creation of a user with the \"$\" character. This can be used by attackers to hide a user or trick detection systems that lack the parsing mechanisms.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection_create": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4720,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "SamAccountName__contains": {
                "field": "SamAccountName",
                "value": "$",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_rename": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4781,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "NewTargetUserName__contains": {
                "field": "NewTargetUserName",
                "value": "$",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_homegroup": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4720,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetUserName": {
                "field": "TargetUserName",
                "value": "HomeGroupUser$",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "1 of selection_* and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "1 of selection_*"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1036"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Ilyas Ochkov, oscd.community",
        "date": "2019-10-25",
        "modified": "2024-01-16",
        "references": [
          "https://twitter.com/SBousseaden/status/1387743867663958021"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_new_or_renamed_user_account_with_dollar_sign.yml"
      }
    },
    {
      "id": "c265cf08-3f99-46c1-8d59-328247057d57",
      "title": "User Added to Local Administrator Group",
      "status": "stable",
      "description": "Detects the addition of a new member to the local administrator group, which could be legitimate activity or a sign of privilege escalation activity",
      "level": "medium",
      "tags": [
        "attack.initial-access",
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1078",
        "attack.persistence",
        "attack.t1098"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection_eid": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4732,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_group": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "TargetUserName__startswith": {
                    "field": "TargetUserName",
                    "value": "Administr",
                    "modifiers": [
                      "startswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "TargetSid": {
                    "field": "TargetSid",
                    "value": "S-1-5-32-544",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_main_computer_accounts": {
            "type": "field_match",
            "matchers": {
              "SubjectUserName__endswith": {
                "field": "SubjectUserName",
                "value": "$",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_"
        }
      },
      "mitre": {
        "techniques": [
          "T1078",
          "T1098"
        ],
        "tactics": [
          "initial_access",
          "defense_evasion",
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2017-03-14",
        "modified": "2021-01-17",
        "references": [
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4732",
          "https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/manage/understand-security-identifiers"
        ],
        "falsepositives": [
          "Legitimate administrative activity"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_user_added_to_local_administrators.yml"
      }
    },
    {
      "id": "7b449a5e-1db5-4dd0-a2dc-4e3a67282538",
      "title": "Hidden Local User Creation",
      "status": "test",
      "description": "Detects the creation of a local hidden user account which should not happen for event ID 4720.",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.t1136.001"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4720,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetUserName__endswith": {
                "field": "TargetUserName",
                "value": "$",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_homegroup": {
            "type": "field_match",
            "matchers": {
              "TargetUserName": {
                "field": "TargetUserName",
                "value": "HomeGroupUser$",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1136.001"
        ],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "Christian Burkard (Nextron Systems)",
        "date": "2021-05-03",
        "modified": "2024-01-16",
        "references": [
          "https://twitter.com/SBousseaden/status/1387743867663958021"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_hidden_user_creation.yml"
      }
    },
    {
      "id": "11d00fff-5dc3-428c-8184-801f292faec0",
      "title": "Service Registry Key Read Access Request",
      "status": "test",
      "description": "Detects \"read access\" requests on the services registry key.\nAdversaries may execute their own malicious payloads by hijacking the Registry entries used by services.\nAdversaries may use flaws in the permissions for Registry keys related to services to redirect from the originally specified executable to one that they control, in order to launch their own code when a service starts.\n",
      "level": "low",
      "tags": [
        "attack.defense-evasion",
        "attack.persistence",
        "attack.privilege-escalation",
        "attack.t1574.011"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4663,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectName__contains_all": {
                "field": "ObjectName",
                "value": [
                  "\\SYSTEM\\",
                  "ControlSet\\Services\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "AccessList__contains": {
                "field": "AccessList",
                "value": "%%1538",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1574.011"
        ],
        "tactics": [
          "defense_evasion",
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Center for Threat Informed Defense (CTID) Summiting the Pyramid Team",
        "date": "2023-09-28",
        "modified": "",
        "references": [
          "https://center-for-threat-informed-defense.github.io/summiting-the-pyramid/analytics/service_registry_permissions_weakness_check/",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1574.011/T1574.011.md#atomic-test-1---service-registry-permissions-weakness"
        ],
        "falsepositives": [
          "Likely from legitimate applications reading their key. Requires heavy tuning"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_registry_permissions_weakness_check.yml"
      }
    },
    {
      "id": "17d619c1-e020-4347-957e-1d1207455c93",
      "title": "Active Directory Replication from Non Machine Account",
      "status": "test",
      "description": "Detects potential abuse of Active Directory Replication Service (ADRS) from a non machine account to request credentials.",
      "level": "critical",
      "tags": [
        "attack.credential-access",
        "attack.t1003.006"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4662,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "AccessMask": {
                "field": "AccessMask",
                "value": "0x100",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Properties__contains": {
                "field": "Properties",
                "value": [
                  "1131f6aa-9c07-11d1-f79f-00c04fc2dcd2",
                  "1131f6ad-9c07-11d1-f79f-00c04fc2dcd2",
                  "89e95b76-444d-4c62-991a-0facbeda640c"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "SubjectUserName__endswith": {
                    "field": "SubjectUserName",
                    "value": "$",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "SubjectUserName__startswith": {
                    "field": "SubjectUserName",
                    "value": "MSOL_",
                    "modifiers": [
                      "startswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.006"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez @Cyb3rWard0g",
        "date": "2019-07-26",
        "modified": "2021-11-27",
        "references": [
          "https://threathunterplaybook.com/hunts/windows/180815-ADObjectAccessReplication/notebook.html",
          "https://threathunterplaybook.com/library/windows/active_directory_replication.html",
          "https://threathunterplaybook.com/hunts/windows/190101-ADModDirectoryReplication/notebook.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_ad_replication_non_machine_account.yml"
      }
    },
    {
      "id": "e9c8808f-4cfb-4ba9-97d4-e5f3beaa244d",
      "title": "Windows Defender Exclusion Registry Key - Write Access Requested",
      "status": "test",
      "description": "Detects write access requests to the Windows Defender exclusions registry keys. This could be an indication of an attacker trying to request a handle or access the object to write new exclusions in order to bypass security.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "AccessList__contains": {
                "field": "AccessList",
                "value": [
                  "%%4417",
                  "%%4418"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "EventID": {
                "field": "EventID",
                "value": [
                  4656,
                  4663
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "ObjectName__contains": {
                "field": "ObjectName",
                "value": "\\Microsoft\\Windows Defender\\Exclusions\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "@BarryShooshooga, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2019-10-26",
        "modified": "2023-11-11",
        "references": [
          "https://www.bleepingcomputer.com/news/security/gootkit-malware-bypasses-windows-defender-by-setting-path-exclusions/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_windows_defender_exclusions_write_access.yml"
      }
    },
    {
      "id": "9a4ff3b8-6187-4fd2-8e8b-e0eae1129495",
      "title": "SysKey Registry Keys Access",
      "status": "test",
      "description": "Detects handle requests and access operations to specific registry keys to calculate the SysKey",
      "level": "high",
      "tags": [
        "attack.discovery",
        "attack.t1012"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": [
                  4656,
                  4663
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "ObjectType": {
                "field": "ObjectType",
                "value": "key",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectName__endswith": {
                "field": "ObjectName",
                "value": [
                  "lsa\\JD",
                  "lsa\\GBG",
                  "lsa\\Skew1",
                  "lsa\\Data"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1012"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez @Cyb3rWard0g",
        "date": "2019-08-12",
        "modified": "2021-11-27",
        "references": [
          "https://threathunterplaybook.com/hunts/windows/190625-RegKeyAccessSyskey/notebook.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_syskey_registry_access.yml"
      }
    },
    {
      "id": "5a44727c-3b85-4713-8c44-4401d5499629",
      "title": "Replay Attack Detected",
      "status": "test",
      "description": "Detects possible Kerberos Replay Attack on the domain controllers when \"KRB_AP_ERR_REPEAT\" Kerberos response is sent to the client",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1558"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4649,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1558"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-10-14",
        "modified": "",
        "references": [
          "https://github.com/Yamato-Security/EnableWindowsLogSettings/blob/7f6d755d45ac7cc9fc35b0cbf498e6aa4ef19def/ConfiguringSecurityLogAuditPolicies.md",
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4649"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_replay_attack_detected.yml"
      }
    },
    {
      "id": "c8b00925-926c-47e3-beea-298fd563728e",
      "title": "Remote Access Tool Services Have Been Installed - Security",
      "status": "test",
      "description": "Detects service installation of different remote access tools software. These software are often abused by threat actors to perform",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.execution",
        "attack.t1543.003",
        "attack.t1569.002"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4697,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ServiceName__contains": {
                "field": "ServiceName",
                "value": [
                  "AmmyyAdmin",
                  "AnyDesk",
                  "Atera",
                  "BASupportExpressSrvcUpdater",
                  "BASupportExpressStandaloneService",
                  "chromoting",
                  "GoToAssist",
                  "GoToMyPC",
                  "jumpcloud",
                  "LMIGuardianSvc",
                  "LogMeIn",
                  "monblanking",
                  "Parsec",
                  "RManService",
                  "RPCPerformanceService",
                  "RPCService",
                  "SplashtopRemoteService",
                  "SSUService",
                  "TeamViewer",
                  "TightVNC",
                  "vncserver",
                  "Zoho"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1543.003",
          "T1569.002"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "execution"
        ]
      },
      "meta": {
        "author": "Connor Martin, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-12-23",
        "modified": "2024-12-07",
        "references": [
          "https://redcanary.com/blog/misbehaving-rats/"
        ],
        "falsepositives": [
          "The rule doesn't look for anything suspicious so false positives are expected. If you use one of the tools mentioned, comment it out"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_service_install_remote_access_software.yml"
      }
    },
    {
      "id": "411742ad-89b0-49cb-a7b0-3971b5c1e0a4",
      "title": "Locked Workstation",
      "status": "stable",
      "description": "Detects locked workstation session events that occur automatically after a standard period of inactivity.",
      "level": "informational",
      "tags": [
        "attack.impact"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4800,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "impact"
        ]
      },
      "meta": {
        "author": "Alexandr Yampolskyi, SOC Prime",
        "date": "2019-03-26",
        "modified": "2023-12-11",
        "references": [
          "https://www.cisecurity.org/controls/cis-controls-list/",
          "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
          "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
          "https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=4800"
        ],
        "falsepositives": [
          "Likely"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_workstation_was_locked.yml"
      }
    },
    {
      "id": "ecbc5e16-58e0-4521-9c60-eb9a7ea4ad34",
      "title": "Meterpreter or Cobalt Strike Getsystem Service Installation - Security",
      "status": "test",
      "description": "Detects the use of getsystem Meterpreter/Cobalt Strike command by detecting a specific service installation",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1134.001",
        "attack.t1134.002"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection_eid": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4697,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_cli_cmd": {
            "type": "field_match",
            "matchers": {
              "ServiceFileName__contains_all": {
                "field": "ServiceFileName",
                "value": [
                  "/c",
                  "echo",
                  "\\pipe\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "ServiceFileName__contains": {
                "field": "ServiceFileName",
                "value": [
                  "cmd",
                  "%COMSPEC%"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_rundll": {
            "type": "field_match",
            "matchers": {
              "ServiceFileName__contains_all": {
                "field": "ServiceFileName",
                "value": [
                  "rundll32",
                  ".dll,a",
                  "/p:"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cli_share": {
            "type": "field_match",
            "matchers": {
              "ServiceFileName__startswith": {
                "field": "ServiceFileName",
                "value": "\\\\\\\\127.0.0.1\\\\ADMIN$\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_eid and 1 of selection_cli_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_eid"
            },
            {
              "type": "ref",
              "value": "1 of selection_cli_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1134.001",
          "T1134.002"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Teymur Kheirkhabarov, Ecco, Florian Roth (Nextron Systems)",
        "date": "2019-10-26",
        "modified": "2023-11-15",
        "references": [
          "https://speakerdeck.com/heirhabarov/hunting-for-privilege-escalation-in-windows-environment",
          "https://blog.cobaltstrike.com/2014/04/02/what-happens-when-i-type-getsystem/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_meterpreter_or_cobaltstrike_getsystem_service_install.yml"
      }
    },
    {
      "id": "72124974-a68b-4366-b990-d30e0b2a190d",
      "title": "Metasploit SMB Authentication",
      "status": "test",
      "description": "Alerts on Metasploit host's authentications on the domain.",
      "level": "high",
      "tags": [
        "attack.lateral-movement",
        "attack.t1021.002"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection1": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": [
                  4625,
                  4624
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "LogonType": {
                "field": "LogonType",
                "value": 3,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "AuthenticationPackageName": {
                "field": "AuthenticationPackageName",
                "value": "NTLM",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "WorkstationName__re": {
                "field": "WorkstationName",
                "value": "^[A-Za-z0-9]{16}$",
                "modifiers": [
                  "re"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection2": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4776,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Workstation__re": {
                "field": "Workstation",
                "value": "^[A-Za-z0-9]{16}$",
                "modifiers": [
                  "re"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1021.002"
        ],
        "tactics": [
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Chakib Gzenayi (@Chak092), Hosni Mribah",
        "date": "2020-05-06",
        "modified": "2024-01-25",
        "references": [
          "https://github.com/rapid7/metasploit-framework/blob/1416b5776d963f21b7b5b45d19f3e961201e0aed/lib/rex/proto/smb/client.rb"
        ],
        "falsepositives": [
          "Linux hostnames composed of 16 characters."
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_metasploit_authentication.yml"
      }
    },
    {
      "id": "586a8d6b-6bfe-4ad9-9d78-888cd2fe50c3",
      "title": "Remote Service Activity via SVCCTL Named Pipe",
      "status": "test",
      "description": "Detects remote service activity via remote access to the svcctl named pipe",
      "level": "medium",
      "tags": [
        "attack.lateral-movement",
        "attack.persistence",
        "attack.t1021.002"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 5145,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ShareName": {
                "field": "ShareName",
                "value": "\\\\\\\\\\*\\\\IPC$",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "RelativeTargetName": {
                "field": "RelativeTargetName",
                "value": "svcctl",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "AccessList__contains": {
                "field": "AccessList",
                "value": "WriteData",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1021.002"
        ],
        "tactics": [
          "lateral_movement",
          "persistence"
        ]
      },
      "meta": {
        "author": "Samir Bousseaden",
        "date": "2019-04-03",
        "modified": "2024-08-01",
        "references": [
          "https://web.archive.org/web/20230329155141/https://blog.menasec.net/2019/03/threat-hunting-26-remote-windows.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_svcctl_remote_service.yml"
      }
    },
    {
      "id": "a8f29a7b-b137-4446-80a0-b804272f3da2",
      "title": "Persistence and Execution at Scale via GPO Scheduled Task",
      "status": "test",
      "description": "Detect lateral movement using GPO scheduled task, usually used to deploy ransomware at scale",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.execution",
        "attack.persistence",
        "attack.lateral-movement",
        "attack.t1053.005"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection_5136": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 5136,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "AttributeLDAPDisplayName": {
                "field": "AttributeLDAPDisplayName",
                "value": [
                  "gPCMachineExtensionNames",
                  "gPCUserExtensionNames"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "AttributeValue__contains": {
                "field": "AttributeValue",
                "value": [
                  "CAB54552-DEEA-4691-817E-ED4A4D1AFC72",
                  "AADCED64-746C-4633-A97C-D61349046527"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_5145": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 5145,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ShareName__endswith": {
                "field": "ShareName",
                "value": "\\SYSVOL",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "RelativeTargetName__endswith": {
                "field": "RelativeTargetName",
                "value": "ScheduledTasks.xml",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "AccessList__contains": {
                "field": "AccessList",
                "value": [
                  "WriteData",
                  "%%4417"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1053.005"
        ],
        "tactics": [
          "privilege_escalation",
          "execution",
          "persistence",
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Samir Bousseaden",
        "date": "2019-04-03",
        "modified": "2024-09-04",
        "references": [
          "https://twitter.com/menasec1/status/1106899890377052160",
          "https://www.secureworks.com/blog/ransomware-as-a-distraction",
          "https://www.elastic.co/guide/en/security/7.17/prebuilt-rule-0-16-1-scheduled-task-execution-at-scale-via-gpo.html"
        ],
        "falsepositives": [
          "If the source IP is not localhost then it's super suspicious, better to monitor both local and remote changes to GPO scheduled tasks."
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_gpo_scheduledtasks.yml"
      }
    },
    {
      "id": "25cde13e-8e20-4c29-b949-4e795b76f16f",
      "title": "Suspicious Teams Application Related ObjectAcess Event",
      "status": "test",
      "description": "Detects an access to authentication tokens and accounts of Microsoft Teams desktop application.",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1528"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4663,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectName__contains": {
                "field": "ObjectName",
                "value": [
                  "\\Microsoft\\Teams\\Cookies",
                  "\\Microsoft\\Teams\\Local Storage\\leveldb"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "ProcessName__contains": {
                "field": "ProcessName",
                "value": "\\Microsoft\\Teams\\current\\Teams.exe",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1528"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "@SerkinValery",
        "date": "2022-09-16",
        "modified": "",
        "references": [
          "https://www.bleepingcomputer.com/news/security/microsoft-teams-stores-auth-tokens-as-cleartext-in-windows-linux-macs/",
          "https://www.vectra.ai/blogpost/undermining-microsoft-teams-security-by-mining-tokens"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_teams_suspicious_objectaccess.yml"
      }
    },
    {
      "id": "9c8afa4d-0022-48f0-9456-3712466f9701",
      "title": "Tap Driver Installation - Security",
      "status": "test",
      "description": "Detects the installation of a well-known TAP driver service. This could be a sign of potential preparation for data exfiltration using tunnelling techniques.\n",
      "level": "low",
      "tags": [
        "attack.exfiltration",
        "attack.t1048"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4697,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ServiceFileName__contains": {
                "field": "ServiceFileName",
                "value": "tap0901",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1048"
        ],
        "tactics": [
          "exfiltration"
        ]
      },
      "meta": {
        "author": "Daniil Yugoslavskiy, Ian Davis, oscd.community",
        "date": "2019-10-24",
        "modified": "2022-11-29",
        "references": [
          "https://community.openvpn.net/openvpn/wiki/ManagingWindowsTAPDrivers"
        ],
        "falsepositives": [
          "Legitimate OpenVPN TAP installation"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_tap_driver_installation.yml"
      }
    },
    {
      "id": "faa031b5-21ed-4e02-8881-2591f98d82ed",
      "title": "Unauthorized System Time Modification",
      "status": "test",
      "description": "Detect scenarios where a potentially unauthorized application or user is modifying the system time.",
      "level": "low",
      "tags": [
        "attack.defense-evasion",
        "attack.t1070.006"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4616,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_svchost": {
            "type": "field_match",
            "matchers": {
              "ProcessName": {
                "field": "ProcessName",
                "value": "C:\\Windows\\System32\\svchost.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "SubjectUserSid": {
                "field": "SubjectUserSid",
                "value": "S-1-5-19",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_vmtools": {
            "type": "field_match",
            "matchers": {
              "ProcessName": {
                "field": "ProcessName",
                "value": [
                  "C:\\Program Files\\VMware\\VMware Tools\\vmtoolsd.exe",
                  "C:\\Program Files (x86)\\VMware\\VMware Tools\\vmtoolsd.exe",
                  "C:\\Windows\\System32\\VBoxService.exe",
                  "C:\\Windows\\System32\\oobe\\msoobe.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1070.006"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "@neu5ron",
        "date": "2019-02-05",
        "modified": "2025-12-03",
        "references": [
          "Private Cuckoo Sandbox (from many years ago, no longer have hash, NDA as well)",
          "Live environment caused by malware",
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4616"
        ],
        "falsepositives": [
          "HyperV or other virtualization technologies with binary not listed in filter portion of detection"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_susp_time_modification.yml"
      }
    },
    {
      "id": "35bc7e28-ee6b-492f-ab04-da58fcf6402e",
      "title": "Windows Network Access Suspicious desktop.ini Action",
      "status": "test",
      "description": "Detects unusual processes accessing desktop.ini remotely over network share, which can be leveraged to alter how Explorer displays a folder's content (i.e. renaming files) without changing them on disk.",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547.009"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 5145,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectType": {
                "field": "ObjectType",
                "value": "File",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "RelativeTargetName__endswith": {
                "field": "RelativeTargetName",
                "value": "\\desktop.ini",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "AccessList__contains": {
                "field": "AccessList",
                "value": [
                  "WriteData",
                  "DELETE",
                  "WriteDAC",
                  "AppendData",
                  "AddSubdirectory"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1547.009"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Tim Shelton (HAWK.IO)",
        "date": "2021-12-06",
        "modified": "2022-01-16",
        "references": [
          "https://isc.sans.edu/forums/diary/Desktopini+as+a+postexploitation+tool/25912/"
        ],
        "falsepositives": [
          "Read only access list authority"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_net_share_obj_susp_desktop_ini.yml"
      }
    },
    {
      "id": "b210394c-ba12-4f89-9117-44a2464b9511",
      "title": "SMB Create Remote File Admin Share",
      "status": "test",
      "description": "Look for non-system accounts SMB accessing a file with write (0x2) access mask via administrative share (i.e C$).",
      "level": "high",
      "tags": [
        "attack.lateral-movement",
        "attack.t1021.002"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 5145,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ShareName__endswith": {
                "field": "ShareName",
                "value": "C$",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "AccessMask": {
                "field": "AccessMask",
                "value": "0x2",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_subjectusername": {
            "type": "field_match",
            "matchers": {
              "SubjectUserName__endswith": {
                "field": "SubjectUserName",
                "value": "$",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_local_ip": {
            "type": "field_match",
            "matchers": {
              "IpAddress": {
                "field": "IpAddress",
                "value": "::1",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1021.002"
        ],
        "tactics": [
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Jose Rodriguez (@Cyb3rPandaH), OTR (Open Threat Research)",
        "date": "2020-08-06",
        "modified": "2025-10-17",
        "references": [
          "https://github.com/OTRF/ThreatHunter-Playbook/blob/f7a58156dbfc9b019f17f638b8c62d22e557d350/playbooks/WIN-201012004336.yaml",
          "https://securitydatasets.com/notebooks/atomic/windows/lateral_movement/SDWIN-200806015757.html?highlight=create%20file"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_smb_file_creation_admin_shares.yml"
      }
    },
    {
      "id": "4edf51e1-cb83-4e1a-bc39-800e396068e3",
      "title": "Invoke-Obfuscation CLIP+ Launcher - Security",
      "status": "test",
      "description": "Detects Obfuscated use of Clip.exe to execute PowerShell",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027",
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4697,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ServiceFileName__contains_all": {
                "field": "ServiceFileName",
                "value": [
                  "cmd",
                  "&&",
                  "clipboard]::"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1027",
          "T1059.001"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Jonathan Cheong, oscd.community",
        "date": "2020-10-13",
        "modified": "2022-11-27",
        "references": [
          "https://github.com/SigmaHQ/sigma/issues/1009"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_invoke_obfuscation_clip_services_security.yml"
      }
    },
    {
      "id": "20d96d95-5a20-4cf1-a483-f3bda8a7c037",
      "title": "Add or Remove Computer from DC",
      "status": "test",
      "description": "Detects the creation or removal of a computer. Can be used to detect attacks such as DCShadow via the creation of a new SPN.",
      "level": "low",
      "tags": [
        "attack.defense-evasion",
        "attack.t1207"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": [
                  4741,
                  4743
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1207"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-10-14",
        "modified": "",
        "references": [
          "https://github.com/Yamato-Security/EnableWindowsLogSettings/blob/7f6d755d45ac7cc9fc35b0cbf498e6aa4ef19def/ConfiguringSecurityLogAuditPolicies.md",
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4741",
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4743"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_add_remove_computer.yml"
      }
    },
    {
      "id": "5d6c375a-18ae-4952-b4f6-8b803f6c8555",
      "title": "File Access Of Signal Desktop Sensitive Data",
      "status": "experimental",
      "description": "Detects access to Signal Desktop's sensitive data files: db.sqlite and config.json.\nThe db.sqlite file in Signal Desktop stores all locally saved messages in an encrypted SQLite database, while the config.json contains the decryption key needed to access that data.\nSince the key is stored in plain text, a threat actor who gains access to both files can decrypt and read sensitive messages without needing the users credentials.\nCurrently the rule only covers the default Signal installation path in AppData\\Roaming. Signal Portable installations may use different paths based on user configuration. Additional paths can be added to the selection as needed.\n",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.t1003"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4663,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectType": {
                "field": "ObjectType",
                "value": "File",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectName__contains": {
                "field": "ObjectName",
                "value": "\\AppData\\Roaming\\Signal\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "ObjectName__endswith": {
                "field": "ObjectName",
                "value": [
                  "\\config.json",
                  "\\db.sqlite"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_signal": {
            "type": "field_match",
            "matchers": {
              "ProcessName__endswith": {
                "field": "ProcessName",
                "value": [
                  "\\signal-portable.exe",
                  "\\signal.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1003"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Andreas Braathen (mnemonic.io)",
        "date": "2025-10-19",
        "modified": "",
        "references": [
          "https://cloud.google.com/blog/topics/threat-intelligence/russia-targeting-signal-messenger/",
          "https://vmois.dev/query-signal-desktop-messages-sqlite/"
        ],
        "falsepositives": [
          "Unlikely, but possible from AV or backup software accessing the files."
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_signal_sensitive_config_access.yml"
      }
    },
    {
      "id": "f6c68d5f-e101-4b86-8c84-7d96851fd65c",
      "title": "T1047 Wmiprvse Wbemcomn DLL Hijack",
      "status": "test",
      "description": "Detects a threat actor creating a file named `wbemcomn.dll` in the `C:\\Windows\\System32\\wbem\\` directory over the network for a WMI DLL Hijack scenario.",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1047",
        "attack.lateral-movement",
        "attack.t1021.002"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 5145,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "RelativeTargetName__endswith": {
                "field": "RelativeTargetName",
                "value": "\\wbem\\wbemcomn.dll",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "SubjectUserName__endswith": {
                "field": "SubjectUserName",
                "value": "$",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1047",
          "T1021.002"
        ],
        "tactics": [
          "execution",
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez @Cyb3rWard0g, Open Threat Research (OTR)",
        "date": "2020-10-12",
        "modified": "2022-02-24",
        "references": [
          "https://threathunterplaybook.com/hunts/windows/201009-RemoteWMIWbemcomnDLLHijack/notebook.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_wmiprvse_wbemcomn_dll_hijack.yml"
      }
    },
    {
      "id": "1de68c67-af5c-4097-9c85-fe5578e09e67",
      "title": "WCE wceaux.dll Access",
      "status": "test",
      "description": "Detects wceaux.dll access while WCE pass-the-hash remote command execution on source host",
      "level": "critical",
      "tags": [
        "attack.credential-access",
        "attack.t1003",
        "attack.s0005"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": [
                  4656,
                  4663
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "ObjectName__endswith": {
                "field": "ObjectName",
                "value": "\\wceaux.dll",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Thomas Patzke",
        "date": "2017-06-14",
        "modified": "2025-01-30",
        "references": [
          "https://www.jpcert.or.jp/english/pub/sr/ir_research.html",
          "https://jpcertcc.github.io/ToolAnalysisResultSheet"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_mal_wceaux_dll.yml"
      }
    },
    {
      "id": "cd0f7229-d16f-42de-8fe3-fba365fbcb3a",
      "title": "Invoke-Obfuscation Via Use Rundll32 - Security",
      "status": "test",
      "description": "Detects Obfuscated Powershell via use Rundll32 in Scripts",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027",
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4697,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ServiceFileName__contains_all": {
                "field": "ServiceFileName",
                "value": [
                  "&&",
                  "rundll32",
                  "shell32.dll",
                  "shellexec_rundll"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "ServiceFileName__contains": {
                "field": "ServiceFileName",
                "value": [
                  "value",
                  "invoke",
                  "comspec",
                  "iex"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1027",
          "T1059.001"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Nikita Nazarov, oscd.community",
        "date": "2020-10-09",
        "modified": "2022-11-29",
        "references": [
          "https://github.com/SigmaHQ/sigma/issues/1009"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_invoke_obfuscation_via_use_rundll32_services_security.yml"
      }
    },
    {
      "id": "4ac1f50b-3bd0-4968-902d-868b4647937e",
      "title": "DPAPI Domain Backup Key Extraction",
      "status": "test",
      "description": "Detects tools extracting LSA secret DPAPI domain backup key from Domain Controllers",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003.004"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4662,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectType": {
                "field": "ObjectType",
                "value": "SecretObject",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "AccessMask": {
                "field": "AccessMask",
                "value": "0x2",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectName__contains": {
                "field": "ObjectName",
                "value": "BCKUPKEY",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.004"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez @Cyb3rWard0g",
        "date": "2019-06-20",
        "modified": "2022-02-24",
        "references": [
          "https://threathunterplaybook.com/hunts/windows/190620-DomainDPAPIBackupKeyExtraction/notebook.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_dpapi_domain_backupkey_extraction.yml"
      }
    },
    {
      "id": "b07e58cf-cacc-4135-8473-ccb2eba63dd2",
      "title": "Potential Kerberos Coercion by Spoofing SPNs via DNS Manipulation",
      "status": "experimental",
      "description": "Detects modifications to DNS records in Active Directory where the Distinguished Name (DN) contains a base64-encoded blob\nmatching the pattern \"1UWhRCAAAAA...BAAAA\". This pattern corresponds to a marshaled CREDENTIAL_TARGET_INFORMATION structure,\ncommonly used in Kerberos coercion attacks. Adversaries may exploit this to coerce victim systems into authenticating to\nattacker-controlled hosts by spoofing SPNs via DNS. It is one of the strong indicators of a Kerberos coercion attack,.\nwhere adversaries manipulate DNS records to spoof Service Principal Names (SPNs) and redirect authentication requests like CVE-2025-33073.\nPlease investigate the user account that made the changes, as it is likely a low-privileged account that has been compromised.\n",
      "level": "high",
      "tags": [
        "attack.collection",
        "attack.credential-access",
        "attack.t1557.003",
        "attack.persistence",
        "attack.privilege-escalation"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection_directory_service_changes": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": [
                  5136,
                  5137
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "ObjectClass": {
                "field": "ObjectClass",
                "value": "dnsNode",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectDN__contains_all": {
                "field": "ObjectDN",
                "value": [
                  "UWhRCA",
                  "BAAAA",
                  "CN=MicrosoftDNS"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_directory_service_access": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4662,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "AdditionalInfo__contains_all": {
                "field": "AdditionalInfo",
                "value": [
                  "UWhRCA",
                  "BAAAA",
                  "CN=MicrosoftDNS"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1557.003"
        ],
        "tactics": [
          "collection",
          "credential_access",
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-06-20",
        "modified": "",
        "references": [
          "https://googleprojectzero.blogspot.com/2021/10/using-kerberos-for-authentication-relay.html",
          "https://www.synacktiv.com/publications/ntlm-reflection-is-dead-long-live-ntlm-reflection-an-in-depth-analysis-of-cve-2025"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_kerberos_coercion_via_dns_object.yml"
      }
    },
    {
      "id": "12e6d621-194f-4f59-90cc-1959e21e69f7",
      "title": "Register new Logon Process by Rubeus",
      "status": "test",
      "description": "Detects potential use of Rubeus via registered new trusted logon process",
      "level": "high",
      "tags": [
        "attack.lateral-movement",
        "attack.privilege-escalation",
        "attack.credential-access",
        "attack.t1558.003"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4611,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "LogonProcessName": {
                "field": "LogonProcessName",
                "value": "User32LogonProcesss",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1558.003"
        ],
        "tactics": [
          "lateral_movement",
          "privilege_escalation",
          "credential_access"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez (source), Ilyas Ochkov (rule), oscd.community",
        "date": "2019-10-24",
        "modified": "2022-10-09",
        "references": [
          "https://posts.specterops.io/hunting-in-active-directory-unconstrained-delegation-forests-trusts-71f2b33688e1"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_register_new_logon_process_by_rubeus.yml"
      }
    },
    {
      "id": "ff151c33-45fa-475d-af4f-c2f93571f4fe",
      "title": "Azure AD Health Monitoring Agent Registry Keys Access",
      "status": "test",
      "description": "This detection uses Windows security events to detect suspicious access attempts to the registry key of Azure AD Health monitoring agent.\nThis detection requires an access control entry (ACE) on the system access control list (SACL) of the following securable object HKLM\\SOFTWARE\\Microsoft\\Microsoft Online\\Reporting\\MonitoringAgent.\n",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.t1012"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": [
                  4656,
                  4663
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "ObjectType": {
                "field": "ObjectType",
                "value": "Key",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectName": {
                "field": "ObjectName",
                "value": "\\REGISTRY\\MACHINE\\SOFTWARE\\Microsoft\\Microsoft Online\\Reporting\\MonitoringAgent",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "ProcessName__contains": {
                "field": "ProcessName",
                "value": [
                  "Microsoft.Identity.Health.Adfs.DiagnosticsAgent.exe",
                  "Microsoft.Identity.Health.Adfs.InsightsService.exe",
                  "Microsoft.Identity.Health.Adfs.MonitoringAgent.Startup.exe",
                  "Microsoft.Identity.Health.Adfs.PshSurrogate.exe",
                  "Microsoft.Identity.Health.Common.Clients.ResourceMonitor.exe"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1012"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research), MSTIC",
        "date": "2021-08-26",
        "modified": "2022-10-09",
        "references": [
          "https://o365blog.com/post/hybridhealthagent/",
          "https://github.com/OTRF/Set-AuditRule/blob/c3dec5443414231714d850565d364ca73475ade5/rules/registry/aad_connect_health_monitoring_agent.yml"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_aadhealth_mon_agent_regkey_access.yml"
      }
    },
    {
      "id": "fd0f5778-d3cb-4c9a-9695-66759d04702a",
      "title": "Invoke-Obfuscation Obfuscated IEX Invocation - Security",
      "status": "test",
      "description": "Detects all variations of obfuscated powershell IEX invocation code generated by Invoke-Obfuscation framework from the code block linked in the references",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection_eid": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4697,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_servicefilename": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "ServiceFileName__re": {
                    "field": "ServiceFileName",
                    "value": "\\$PSHome\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$PSHome\\[",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "ServiceFileName__re": {
                    "field": "ServiceFileName",
                    "value": "\\$ShellId\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$ShellId\\[",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "ServiceFileName__re": {
                    "field": "ServiceFileName",
                    "value": "\\$env:Public\\[\\s*\\d{1,3}\\s*\\]\\s*\\+\\s*\\$env:Public\\[",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "ServiceFileName__re": {
                    "field": "ServiceFileName",
                    "value": "\\$env:ComSpec\\[(\\s*\\d{1,3}\\s*,){2}",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "ServiceFileName__re": {
                    "field": "ServiceFileName",
                    "value": "\\\\*mdr\\*\\W\\s*\\)\\.Name",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "ServiceFileName__re": {
                    "field": "ServiceFileName",
                    "value": "\\$VerbosePreference\\.ToString\\(",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "ServiceFileName__re": {
                    "field": "ServiceFileName",
                    "value": "\\String\\]\\s*\\$VerbosePreference",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1027"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Daniel Bohannon (@Mandiant/@FireEye), oscd.community",
        "date": "2019-11-08",
        "modified": "2022-11-27",
        "references": [
          "https://github.com/danielbohannon/Invoke-Obfuscation/blob/f20e7f843edd0a3a7716736e9eddfa423395dd26/Out-ObfuscatedStringCommand.ps1#L873-L888"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_invoke_obfuscation_obfuscated_iex_services_security.yml"
      }
    },
    {
      "id": "028c7842-4243-41cd-be6f-12f3cf1a26c7",
      "title": "AD Object WriteDAC Access",
      "status": "test",
      "description": "Detects WRITE_DAC access to a domain object",
      "level": "critical",
      "tags": [
        "attack.defense-evasion",
        "attack.t1222.001"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4662,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectServer": {
                "field": "ObjectServer",
                "value": "DS",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "AccessMask": {
                "field": "AccessMask",
                "value": "0x40000",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectType": {
                "field": "ObjectType",
                "value": [
                  "19195a5b-6da0-11d0-afd3-00c04fd930c9",
                  "domainDNS"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1222.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez @Cyb3rWard0g",
        "date": "2019-09-12",
        "modified": "2021-11-27",
        "references": [
          "https://threathunterplaybook.com/hunts/windows/180815-ADObjectAccessReplication/notebook.html",
          "https://threathunterplaybook.com/library/windows/active_directory_replication.html",
          "https://threathunterplaybook.com/hunts/windows/190101-ADModDirectoryReplication/notebook.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_ad_object_writedac_access.yml"
      }
    },
    {
      "id": "8e5c03fa-b7f0-11ea-b242-07e0576828d9",
      "title": "Denied Access To Remote Desktop",
      "status": "test",
      "description": "This event is generated when an authenticated user who is not allowed to log on remotely attempts to connect to this computer through Remote Desktop.\nOften, this event can be generated by attackers when searching for available windows servers in the network.\n",
      "level": "medium",
      "tags": [
        "attack.lateral-movement",
        "attack.t1021.001"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4825,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1021.001"
        ],
        "tactics": [
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Pushkarev Dmitry",
        "date": "2020-06-27",
        "modified": "2021-11-27",
        "references": [
          "https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventid=4825"
        ],
        "falsepositives": [
          "Valid user was not added to RDP group"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_not_allowed_rdp_access.yml"
      }
    },
    {
      "id": "c39f0c81-7348-4965-ab27-2fde35a1b641",
      "title": "DCOM InternetExplorer.Application Iertutil DLL Hijack - Security",
      "status": "test",
      "description": "Detects a threat actor creating a file named `iertutil.dll` in the `C:\\Program Files\\Internet Explorer\\` directory over the network for a DCOM InternetExplorer DLL Hijack scenario.",
      "level": "high",
      "tags": [
        "attack.lateral-movement",
        "attack.t1021.002",
        "attack.t1021.003"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 5145,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "RelativeTargetName__endswith": {
                "field": "RelativeTargetName",
                "value": "\\Internet Explorer\\iertutil.dll",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "SubjectUserName__endswith": {
                "field": "SubjectUserName",
                "value": "$",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1021.002",
          "T1021.003"
        ],
        "tactics": [
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez @Cyb3rWard0g, Open Threat Research (OTR)",
        "date": "2020-10-12",
        "modified": "2022-11-26",
        "references": [
          "https://threathunterplaybook.com/hunts/windows/201009-RemoteDCOMIErtUtilDLLHijack/notebook.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_dcom_iertutil_dll_hijack.yml"
      }
    },
    {
      "id": "13addce7-47b2-4ca0-a98f-1de964d1d669",
      "title": "SCM Database Handle Failure",
      "status": "test",
      "description": "Detects non-system users failing to get a handle of the SCM database.",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.t1010"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4656,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectType": {
                "field": "ObjectType",
                "value": "SC_MANAGER OBJECT",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectName": {
                "field": "ObjectName",
                "value": "ServicesActive",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "AccessMask": {
                "field": "AccessMask",
                "value": "0xf003f",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "SubjectLogonId": {
                "field": "SubjectLogonId",
                "value": "0x3e4",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1010"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez @Cyb3rWard0g",
        "date": "2019-08-12",
        "modified": "2022-07-11",
        "references": [
          "https://threathunterplaybook.com/hunts/windows/190826-RemoteSCMHandle/notebook.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_scm_database_handle_failure.yml"
      }
    },
    {
      "id": "46a68649-f218-4f86-aea1-16a759d81820",
      "title": "Windows Defender Exclusion List Modified",
      "status": "test",
      "description": "Detects modifications to the Windows Defender exclusion registry key. This could indicate a potentially suspicious or even malicious activity by an attacker trying to add a new exclusion in order to bypass security.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4657,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectName__contains": {
                "field": "ObjectName",
                "value": "\\Microsoft\\Windows Defender\\Exclusions\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "@BarryShooshooga",
        "date": "2019-10-26",
        "modified": "2023-11-11",
        "references": [
          "https://www.bleepingcomputer.com/news/security/gootkit-malware-bypasses-windows-defender-by-setting-path-exclusions/"
        ],
        "falsepositives": [
          "Intended exclusions by administrators"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_windows_defender_exclusions_registry_modified.yml"
      }
    },
    {
      "id": "3a734d25-df5c-4b99-8034-af1ddb5883a4",
      "title": "Suspicious Scheduled Task Creation",
      "status": "test",
      "description": "Detects suspicious scheduled task creation events. Based on attributes such as paths, commands line flags, etc.",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1053.005"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection_eid": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4698,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_paths": {
            "type": "field_match",
            "matchers": {
              "TaskContent__contains": {
                "field": "TaskContent",
                "value": [
                  "\\AppData\\Local\\Temp\\",
                  "\\AppData\\Roaming\\",
                  "\\Users\\Public\\",
                  "\\WINDOWS\\Temp\\",
                  "C:\\Temp\\",
                  "\\Desktop\\",
                  "\\Downloads\\",
                  "\\Temporary Internet",
                  "C:\\ProgramData\\",
                  "C:\\Perflogs\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_commands": {
            "type": "field_match",
            "matchers": {
              "TaskContent__contains": {
                "field": "TaskContent",
                "value": [
                  "regsvr32",
                  "rundll32",
                  "cmd.exe</Command>",
                  "cmd</Command>",
                  "<Arguments>/c ",
                  "<Arguments>/k ",
                  "<Arguments>/r ",
                  "powershell",
                  "pwsh",
                  "mshta",
                  "wscript",
                  "cscript",
                  "certutil",
                  "bitsadmin",
                  "bash.exe",
                  "bash ",
                  "scrcons",
                  "wmic ",
                  "wmic.exe",
                  "forfiles",
                  "scriptrunner",
                  "hh.exe"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1053.005"
        ],
        "tactics": [
          "execution",
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-12-05",
        "modified": "2022-12-07",
        "references": [
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4698"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_susp_scheduled_task_creation.yml"
      }
    },
    {
      "id": "aa1697b7-d611-4f9a-9cb2-5125b4ccfd5c",
      "title": "Password Dumper Activity on LSASS",
      "status": "test",
      "description": "Detects process handle on LSASS process with certain access mask and object type SAM_DOMAIN",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003.001"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4656,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ProcessName__endswith": {
                "field": "ProcessName",
                "value": "\\lsass.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "AccessMask": {
                "field": "AccessMask",
                "value": "0x705",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectType": {
                "field": "ObjectType",
                "value": "SAM_DOMAIN",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.001"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "sigma",
        "date": "2017-02-12",
        "modified": "2022-10-09",
        "references": [
          "https://twitter.com/jackcr/status/807385668833968128"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_susp_lsass_dump.yml"
      }
    },
    {
      "id": "4a1b6da0-d94f-4fc3-98fc-2d9cb9e5ee76",
      "title": "Potentially Suspicious AccessMask Requested From LSASS",
      "status": "test",
      "description": "Detects process handle on LSASS process with certain access mask",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "car.2019-04-004",
        "attack.t1003.001"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection_1": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4656,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectName__endswith": {
                "field": "ObjectName",
                "value": "\\lsass.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "AccessMask__contains": {
                "field": "AccessMask",
                "value": [
                  "0x40",
                  "0x1400",
                  "0x100000",
                  "0x1410",
                  "0x1010",
                  "0x1438",
                  "0x143a",
                  "0x1418",
                  "0x1f0fff",
                  "0x1f1fff",
                  "0x1f2fff",
                  "0x1f3fff"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_2": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4663,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectName__endswith": {
                "field": "ObjectName",
                "value": "\\lsass.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "AccessList__contains": {
                "field": "AccessList",
                "value": [
                  "4484",
                  "4416"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_specific": {
            "type": "field_match",
            "matchers": {
              "ProcessName__endswith": {
                "field": "ProcessName",
                "value": [
                  "\\csrss.exe",
                  "\\GamingServices.exe",
                  "\\lsm.exe",
                  "\\MicrosoftEdgeUpdate.exe",
                  "\\minionhost.exe",
                  "\\MRT.exe",
                  "\\MsMpEng.exe",
                  "\\perfmon.exe",
                  "\\procexp.exe",
                  "\\procexp64.exe",
                  "\\svchost.exe",
                  "\\taskmgr.exe",
                  "\\thor.exe",
                  "\\thor64.exe",
                  "\\vmtoolsd.exe",
                  "\\VsTskMgr.exe",
                  "\\wininit.exe",
                  "\\wmiprvse.exe",
                  "RtkAudUService64"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "ProcessName__contains": {
                "field": "ProcessName",
                "value": [
                  ":\\Program Files (x86)\\",
                  ":\\Program Files\\",
                  ":\\ProgramData\\Microsoft\\Windows Defender\\Platform\\",
                  ":\\Windows\\SysNative\\",
                  ":\\Windows\\System32\\",
                  ":\\Windows\\SysWow64\\",
                  ":\\Windows\\Temp\\asgard2-agent\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_generic": {
            "type": "field_match",
            "matchers": {
              "ProcessName__contains": {
                "field": "ProcessName",
                "value": ":\\Program Files",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_exact": {
            "type": "field_match",
            "matchers": {
              "ProcessName__endswith": {
                "field": "ProcessName",
                "value": [
                  ":\\Windows\\System32\\taskhostw.exe",
                  ":\\Windows\\System32\\msiexec.exe",
                  ":\\Windows\\CCM\\CcmExec.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_sysmon": {
            "type": "field_match",
            "matchers": {
              "ProcessName__endswith": {
                "field": "ProcessName",
                "value": ":\\Windows\\Sysmon64.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "AccessList__contains": {
                "field": "AccessList",
                "value": "%%4484",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_aurora": {
            "type": "field_match",
            "matchers": {
              "ProcessName__contains": {
                "field": "ProcessName",
                "value": ":\\Windows\\Temp\\asgard2-agent-sc\\aurora\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "ProcessName__endswith": {
                "field": "ProcessName",
                "value": "\\aurora-agent-64.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "AccessList__contains": {
                "field": "AccessList",
                "value": "%%4484",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_scenarioengine": {
            "type": "field_match",
            "matchers": {
              "ProcessName__endswith": {
                "field": "ProcessName",
                "value": "\\x64\\SCENARIOENGINE.EXE",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "AccessList__contains": {
                "field": "AccessList",
                "value": "%%4484",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_avira1": {
            "type": "field_match",
            "matchers": {
              "ProcessName__contains_all": {
                "field": "ProcessName",
                "value": [
                  ":\\Users\\",
                  "\\AppData\\Local\\Temp\\is-"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "ProcessName__endswith": {
                "field": "ProcessName",
                "value": "\\avira_system_speedup.tmp",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "AccessList__contains": {
                "field": "AccessList",
                "value": "%%4484",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_avira2": {
            "type": "field_match",
            "matchers": {
              "ProcessName__contains": {
                "field": "ProcessName",
                "value": ":\\Windows\\Temp\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "ProcessName__endswith": {
                "field": "ProcessName",
                "value": "\\avira_speedup_setup_update.tmp",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "AccessList__contains": {
                "field": "AccessList",
                "value": "%%4484",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_snmp": {
            "type": "field_match",
            "matchers": {
              "ProcessName__endswith": {
                "field": "ProcessName",
                "value": ":\\Windows\\System32\\snmp.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "AccessList__contains": {
                "field": "AccessList",
                "value": "%%4484",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_googleupdate": {
            "type": "field_match",
            "matchers": {
              "ProcessName__contains": {
                "field": "ProcessName",
                "value": ":\\Windows\\SystemTemp\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "ProcessName__endswith": {
                "field": "ProcessName",
                "value": "\\GoogleUpdate.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "AccessList__contains": {
                "field": "AccessList",
                "value": "%%4484",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_procmon": {
            "type": "field_match",
            "matchers": {
              "ProcessName__endswith": {
                "field": "ProcessName",
                "value": [
                  "\\procmon64.exe",
                  "\\procmon.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "AccessList__contains": {
                "field": "AccessList",
                "value": "%%4484",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "1 of selection_* and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "1 of selection_*"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1003.001"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez, Teymur Kheirkhabarov, Dimitrios Slamaris, Mark Russinovich, Aleksey Potapov, oscd.community (update)",
        "date": "2019-11-01",
        "modified": "2023-12-19",
        "references": [
          "https://web.archive.org/web/20230208123920/https://cyberwardog.blogspot.com/2017/03/chronicles-of-threat-hunter-hunting-for_22.html",
          "https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment"
        ],
        "falsepositives": [
          "Legitimate software accessing LSASS process for legitimate reason; update the whitelist with it"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_susp_lsass_dump_generic.yml"
      }
    },
    {
      "id": "611eab06-a145-4dfa-a295-3ccc5c20f59a",
      "title": "Mimikatz DC Sync",
      "status": "test",
      "description": "Detects Mimikatz DC sync security events",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.s0002",
        "attack.t1003.006"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4662,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Properties__contains": {
                "field": "Properties",
                "value": [
                  "Replicating Directory Changes All",
                  "1131f6ad-9c07-11d1-f79f-00c04fc2dcd2",
                  "1131f6aa-9c07-11d1-f79f-00c04fc2dcd2",
                  "9923a32a-3607-11d2-b9be-0000f87a36b2",
                  "89e95b76-444d-4c62-991a-0facbeda640c"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "AccessMask": {
                "field": "AccessMask",
                "value": "0x100",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter1": {
            "type": "field_match",
            "matchers": {
              "SubjectDomainName": {
                "field": "SubjectDomainName",
                "value": "Window Manager",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter2": {
            "type": "field_match",
            "matchers": {
              "SubjectUserName__startswith": {
                "field": "SubjectUserName",
                "value": [
                  "NT AUT",
                  "MSOL_"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter3": {
            "type": "field_match",
            "matchers": {
              "SubjectUserName__endswith": {
                "field": "SubjectUserName",
                "value": "$",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1003.006"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Benjamin Delpy, Florian Roth (Nextron Systems), Scott Dermott, Sorina Ionescu",
        "date": "2018-06-03",
        "modified": "2022-04-26",
        "references": [
          "https://twitter.com/gentilkiwi/status/1003236624925413376",
          "https://gist.github.com/gentilkiwi/dcc132457408cf11ad2061340dcb53c2",
          "https://blog.blacklanternsecurity.com/p/detecting-dcsync?s=r",
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4662"
        ],
        "falsepositives": [
          "Valid DC Sync that is not covered by the filters; please report",
          "Local Domain Admin account used for Azure AD Connect"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_dcsync.yml"
      }
    },
    {
      "id": "1c480e10-7ee1-46d4-8ed2-85f9789e3ce4",
      "title": "Group Policy Abuse for Privilege Addition",
      "status": "test",
      "description": "Detects the first occurrence of a modification to Group Policy Object Attributes to add privileges to user accounts or use them to add users as local admins.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1484.001"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 5136,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "AttributeLDAPDisplayName": {
                "field": "AttributeLDAPDisplayName",
                "value": "gPCMachineExtensionNames",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "AttributeValue__contains": {
                "field": "AttributeValue",
                "value": [
                  "827D319E-6EAC-11D2-A4EA-00C04F79F83A",
                  "803E14A0-B4FB-11D0-A0D0-00A0C90F574B"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1484.001"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Elastic, Josh Nickels, Marius Rothenbcher",
        "date": "2024-09-04",
        "modified": "",
        "references": [
          "https://www.elastic.co/guide/en/security/current/group-policy-abuse-for-privilege-addition.html#_setup_275"
        ],
        "falsepositives": [
          "Users allowed to perform these modifications (user found in field SubjectUserName)"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_susp_group_policy_abuse_privilege_addition.yml"
      }
    },
    {
      "id": "6fb63b40-e02a-403e-9ffd-3bcc1d749442",
      "title": "Metasploit Or Impacket Service Installation Via SMB PsExec",
      "status": "test",
      "description": "Detects usage of Metasploit SMB PsExec (exploit/windows/smb/psexec) and Impacket psexec.py by triggering on specific service installation",
      "level": "high",
      "tags": [
        "attack.lateral-movement",
        "attack.t1021.002",
        "attack.t1570",
        "attack.execution",
        "attack.t1569.002"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4697,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ServiceFileName__re": {
                "field": "ServiceFileName",
                "value": "^%systemroot%\\\\[a-zA-Z]{8}\\.exe$",
                "modifiers": [
                  "re"
                ],
                "is_list": false,
                "negated": false
              },
              "ServiceName__re": {
                "field": "ServiceName",
                "value": "(^[a-zA-Z]{4}$)|(^[a-zA-Z]{8}$)|(^[a-zA-Z]{16}$)",
                "modifiers": [
                  "re"
                ],
                "is_list": false,
                "negated": false
              },
              "ServiceStartType": {
                "field": "ServiceStartType",
                "value": 3,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ServiceType": {
                "field": "ServiceType",
                "value": "0x10",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "ServiceName": {
                "field": "ServiceName",
                "value": "PSEXESVC",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1021.002",
          "T1570",
          "T1569.002"
        ],
        "tactics": [
          "lateral_movement",
          "execution"
        ]
      },
      "meta": {
        "author": "Bartlomiej Czyz, Relativity",
        "date": "2021-01-21",
        "modified": "2022-10-05",
        "references": [
          "https://bczyz1.github.io/2021/01/30/psexec.html"
        ],
        "falsepositives": [
          "Possible, different agents with a 8 character binary and a 4, 8 or 16 character service name"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_metasploit_or_impacket_smb_psexec_service_install.yml"
      }
    },
    {
      "id": "0255a820-e564-4e40-af2b-6ac61160335c",
      "title": "A New Trust Was Created To A Domain",
      "status": "stable",
      "description": "Addition of domains is seldom and should be verified for legitimacy.",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1098"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4706,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1098"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Thomas Patzke",
        "date": "2019-12-03",
        "modified": "2024-01-16",
        "references": [
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4706"
        ],
        "falsepositives": [
          "Legitimate extension of domain structure"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_susp_add_domain_trust.yml"
      }
    },
    {
      "id": "f033f3f3-fd24-4995-97d8-a3bb17550a88",
      "title": "WMI Persistence - Security",
      "status": "test",
      "description": "Detects suspicious WMI event filter and command line event consumer based on WMI and Security Logs.",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.privilege-escalation",
        "attack.t1546.003"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4662,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectType": {
                "field": "ObjectType",
                "value": "WMI Namespace",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectName__contains": {
                "field": "ObjectName",
                "value": "subscription",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1546.003"
        ],
        "tactics": [
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Gleb Sukhodolskiy, Timur Zinniatullin oscd.community",
        "date": "2017-08-22",
        "modified": "2022-11-29",
        "references": [
          "https://twitter.com/mattifestation/status/899646620148539397",
          "https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/"
        ],
        "falsepositives": [
          "Unknown (data set is too small; further testing needed)"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_wmi_persistence.yml"
      }
    },
    {
      "id": "214e8f95-100a-4e04-bb31-ef6cba8ce07e",
      "title": "DCERPC SMB Spoolss Named Pipe",
      "status": "test",
      "description": "Detects the use of the spoolss named pipe over SMB. This can be used to trigger the authentication via NTLM of any machine that has the spoolservice enabled.",
      "level": "medium",
      "tags": [
        "attack.lateral-movement",
        "attack.t1021.002"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 5145,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ShareName": {
                "field": "ShareName",
                "value": "\\\\\\\\\\*\\\\IPC$",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "RelativeTargetName": {
                "field": "RelativeTargetName",
                "value": "spoolss",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1021.002"
        ],
        "tactics": [
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "OTR (Open Threat Research)",
        "date": "2018-11-28",
        "modified": "2022-08-11",
        "references": [
          "https://posts.specterops.io/hunting-in-active-directory-unconstrained-delegation-forests-trusts-71f2b33688e1",
          "https://dirkjanm.io/a-different-way-of-abusing-zerologon/",
          "https://twitter.com/_dirkjan/status/1309214379003588608"
        ],
        "falsepositives": [
          "Domain Controllers acting as printer servers too? :)"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_dce_rpc_smb_spoolss_named_pipe.yml"
      }
    },
    {
      "id": "39698b3f-da92-4bc6-bfb5-645a98386e45",
      "title": "Win Susp Computer Name Containing Samtheadmin",
      "status": "test",
      "description": "Detects suspicious computer name samtheadmin-{1..100}$ generated by hacktool",
      "level": "critical",
      "tags": [
        "attack.initial-access",
        "attack.defense-evasion",
        "cve.2021-42278",
        "cve.2021-42287",
        "attack.persistence",
        "attack.privilege-escalation",
        "attack.t1078"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection1": {
            "type": "field_match",
            "matchers": {
              "SamAccountName__startswith": {
                "field": "SamAccountName",
                "value": "SAMTHEADMIN-",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "SamAccountName__endswith": {
                "field": "SamAccountName",
                "value": "$",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection2": {
            "type": "field_match",
            "matchers": {
              "TargetUserName__startswith": {
                "field": "TargetUserName",
                "value": "SAMTHEADMIN-",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetUserName__endswith": {
                "field": "TargetUserName",
                "value": "$",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1078"
        ],
        "tactics": [
          "initial_access",
          "defense_evasion",
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "elhoim",
        "date": "2022-09-09",
        "modified": "2023-01-04",
        "references": [
          "https://twitter.com/malmoeb/status/1511760068743766026",
          "https://github.com/helloexp/0day/blob/614227a7b9beb0e91e7e2c6a5e532e6f7a8e883c/00-CVE_EXP/CVE-2021-42287/sam-the-admin/sam_the_admin.py"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_susp_computer_name.yml"
      }
    },
    {
      "id": "69aeb277-f15f-4d2d-b32a-55e883609563",
      "title": "Windows Event Auditing Disabled",
      "status": "test",
      "description": "Detects scenarios where system auditing (i.e.: Windows event log auditing) is disabled.\nThis may be used in a scenario where an entity would want to bypass local logging to evade detection when Windows event logging is enabled and reviewed.\nAlso, it is recommended to turn off \"Local Group Policy Object Processing\" via GPO, which will make sure that Active Directory GPOs take precedence over local/edited computer policies via something such as \"gpedit.msc\".\nPlease note, that disabling \"Local Group Policy Object Processing\" may cause an issue in scenarios of one off specific GPO modifications - however, it is recommended to perform these modifications in Active Directory anyways.\n",
      "level": "low",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.002"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4719,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "AuditPolicyChanges__contains": {
                "field": "AuditPolicyChanges",
                "value": [
                  "%%8448",
                  "%%8450"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_guid": {
            "type": "field_match",
            "matchers": {
              "SubcategoryGuid": {
                "field": "SubcategoryGuid",
                "value": [
                  "{0CCE9210-69AE-11D9-BED3-505054503030}",
                  "{0CCE9211-69AE-11D9-BED3-505054503030}",
                  "{0CCE9212-69AE-11D9-BED3-505054503030}",
                  "{0CCE9215-69AE-11D9-BED3-505054503030}",
                  "{0CCE9217-69AE-11D9-BED3-505054503030}",
                  "{0CCE921B-69AE-11D9-BED3-505054503030}",
                  "{0CCE922B-69AE-11D9-BED3-505054503030}",
                  "{0CCE922F-69AE-11D9-BED3-505054503030}",
                  "{0CCE9230-69AE-11D9-BED3-505054503030}",
                  "{0CCE9235-69AE-11D9-BED3-505054503030}",
                  "{0CCE9236-69AE-11D9-BED3-505054503030}",
                  "{0CCE9237-69AE-11D9-BED3-505054503030}",
                  "{0CCE923F-69AE-11D9-BED3-505054503030}",
                  "{0CCE9240-69AE-11D9-BED3-505054503030}",
                  "{0CCE9242-69AE-11D9-BED3-505054503030}"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1562.002"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "@neu5ron, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2017-11-19",
        "modified": "2023-11-15",
        "references": [
          "https://docs.google.com/presentation/d/1dkrldTTlN3La-OjWtkWJBb4hVk6vfsSMBFBERs6R8zA/edit"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_disable_event_auditing.yml"
      }
    },
    {
      "id": "571498c8-908e-40b4-910b-d2369159a3da",
      "title": "Password Protected ZIP File Opened (Email Attachment)",
      "status": "test",
      "description": "Detects the extraction of password protected ZIP archives. See the filename variable for more details on which file has been opened.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.initial-access",
        "attack.t1027",
        "attack.t1566.001"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 5379,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetName__contains_all": {
                "field": "TargetName",
                "value": [
                  "Microsoft_Windows_Shell_ZipFolder:filename",
                  "\\Temporary Internet Files\\Content.Outlook"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1027",
          "T1566.001"
        ],
        "tactics": [
          "defense_evasion",
          "initial_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-05-09",
        "modified": "",
        "references": [
          "https://twitter.com/sbousseaden/status/1523383197513379841"
        ],
        "falsepositives": [
          "Legitimate used of encrypted ZIP files"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_susp_opened_encrypted_zip_outlook.yml"
      }
    },
    {
      "id": "d99b79d2-0a6f-4f46-ad8b-260b6e17f982",
      "title": "Security Eventlog Cleared",
      "status": "test",
      "description": "One of the Windows Eventlogs has been cleared. e.g. caused by \"wevtutil cl\" command execution",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1070.001",
        "car.2016-04-002"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection_517": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 517,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Provider_Name": {
                "field": "Provider_Name",
                "value": "Security",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_1102": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 1102,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Provider_Name": {
                "field": "Provider_Name",
                "value": "Microsoft-Windows-Eventlog",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1070.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2017-01-10",
        "modified": "2022-02-24",
        "references": [
          "https://twitter.com/deviouspolack/status/832535435960209408",
          "https://www.hybrid-analysis.com/sample/027cc450ef5f8c5f653329641ec1fed91f694e0d229928963b30f6b0d7d3a745?environmentId=100",
          "https://github.com/Azure/Azure-Sentinel/blob/f99542b94afe0ad2f19a82cc08262e7ac8e1428e/Detections/SecurityEvent/SecurityEventLogCleared.yaml"
        ],
        "falsepositives": [
          "Rollout of log collection agents (the setup routine often includes a reset of the local Eventlog)",
          "System provisioning (system reset before the golden image creation)"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_audit_log_cleared.yml"
      }
    },
    {
      "id": "7a922f1b-2635-4d6c-91ef-af228b198ad3",
      "title": "Invoke-Obfuscation COMPRESS OBFUSCATION - Security",
      "status": "test",
      "description": "Detects Obfuscated Powershell via COMPRESS OBFUSCATION",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027",
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4697,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ServiceFileName__contains_all": {
                "field": "ServiceFileName",
                "value": [
                  "new-object",
                  "text.encoding]::ascii",
                  "readtoend"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "ServiceFileName__contains": {
                "field": "ServiceFileName",
                "value": [
                  "system.io.compression.deflatestream",
                  "system.io.streamreader"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1027",
          "T1059.001"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Timur Zinniatullin, oscd.community",
        "date": "2020-10-18",
        "modified": "2022-11-29",
        "references": [
          "https://github.com/SigmaHQ/sigma/issues/1009"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_invoke_obfuscation_via_compress_services_security.yml"
      }
    },
    {
      "id": "bfbd3291-de87-4b7c-88a2-d6a5deb28668",
      "title": "ADCS Certificate Template Configuration Vulnerability with Risky EKU",
      "status": "test",
      "description": "Detects certificate creation with template allowing risk permission subject and risky EKU",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.credential-access"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection10": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4898,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TemplateContent__contains": {
                "field": "TemplateContent",
                "value": [
                  "1.3.6.1.5.5.7.3.2",
                  "1.3.6.1.5.2.3.4",
                  "1.3.6.1.4.1.311.20.2.2",
                  "2.5.29.37.0"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection11": {
            "type": "field_match",
            "matchers": {
              "TemplateContent__contains": {
                "field": "TemplateContent",
                "value": "CT_FLAG_ENROLLEE_SUPPLIES_SUBJECT",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection20": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4899,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "NewTemplateContent__contains": {
                "field": "NewTemplateContent",
                "value": [
                  "1.3.6.1.5.5.7.3.2",
                  "1.3.6.1.5.2.3.4",
                  "1.3.6.1.4.1.311.20.2.2",
                  "2.5.29.37.0"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection21": {
            "type": "field_match",
            "matchers": {
              "NewTemplateContent__contains": {
                "field": "NewTemplateContent",
                "value": "CT_FLAG_ENROLLEE_SUPPLIES_SUBJECT",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "(selection10 and selection11) or (selection20 and selection21)",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "(selection10 and selection11)",
            "(selection20 and selection21)"
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "privilege_escalation",
          "credential_access"
        ]
      },
      "meta": {
        "author": "Orlinum , BlueDefenZer",
        "date": "2021-11-17",
        "modified": "2022-12-25",
        "references": [
          "https://www.specterops.io/assets/resources/Certified_Pre-Owned.pdf"
        ],
        "falsepositives": [
          "Administrator activity",
          "Proxy SSL certificate with subject modification",
          "Smart card enrollement"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_adcs_certificate_template_configuration_vulnerability_eku.yml"
      }
    },
    {
      "id": "f63508a0-c809-4435-b3be-ed819394d612",
      "title": "Potential Privileged System Service Operation - SeLoadDriverPrivilege",
      "status": "test",
      "description": "Detects the usage of the 'SeLoadDriverPrivilege' privilege. This privilege is required to load or unload a device driver.\nWith this privilege, the user can dynamically load and unload device drivers or other code in to kernel mode.\nThis user right does not apply to Plug and Play device drivers.\nIf you exclude privileged users/admins and processes, which are allowed to do so, you are maybe left with bad programs trying to load malicious kernel drivers.\nThis will detect Ghost-In-The-Logs (https://github.com/bats3c/Ghost-In-The-Logs) and the usage of Sysinternals and various other tools. So you have to work with a whitelist to find the bad stuff.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection_1": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4673,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "PrivilegeList": {
                "field": "PrivilegeList",
                "value": "SeLoadDriverPrivilege",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Service": {
                "field": "Service",
                "value": "-",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_exact": {
            "type": "field_match",
            "matchers": {
              "ProcessName": {
                "field": "ProcessName",
                "value": [
                  "C:\\Windows\\System32\\Dism.exe",
                  "C:\\Windows\\System32\\rundll32.exe",
                  "C:\\Windows\\System32\\fltMC.exe",
                  "C:\\Windows\\HelpPane.exe",
                  "C:\\Windows\\System32\\mmc.exe",
                  "C:\\Windows\\System32\\svchost.exe",
                  "C:\\Windows\\System32\\wimserv.exe",
                  "C:\\Windows\\System32\\RuntimeBroker.exe",
                  "C:\\Windows\\System32\\SystemSettingsBroker.exe",
                  "C:\\Windows\\explorer.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_others": {
            "type": "field_match",
            "matchers": {
              "ProcessName__endswith": {
                "field": "ProcessName",
                "value": [
                  "\\procexp64.exe",
                  "\\procexp.exe",
                  "\\procmon64.exe",
                  "\\procmon.exe",
                  "\\Google\\Chrome\\Application\\chrome.exe",
                  "\\AppData\\Local\\Microsoft\\Teams\\current\\Teams.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_startswith": {
            "type": "field_match",
            "matchers": {
              "ProcessName__startswith": {
                "field": "ProcessName",
                "value": "C:\\Program Files\\WindowsApps\\Microsoft",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_dropbox": {
            "type": "field_match",
            "matchers": {
              "ProcessName__startswith": {
                "field": "ProcessName",
                "value": [
                  "C:\\Program Files (x86)\\Dropbox\\",
                  "C:\\Program Files\\Dropbox\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "ProcessName__endswith": {
                "field": "ProcessName",
                "value": "\\Dropbox.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection_1 and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_1"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "xknow (@xknow_infosec), xorxes (@xor_xes)",
        "date": "2019-04-08",
        "modified": "2025-10-07",
        "references": [
          "https://web.archive.org/web/20230331181619/https://blog.dylan.codes/evading-sysmon-and-windows-event-logging/",
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4673"
        ],
        "falsepositives": [
          "Other legimate tools loading drivers. Including but not limited to, Sysinternals, CPU-Z, AVs etc. A baseline needs to be created according to the used products and allowed tools. A good thing to do is to try and exclude users who are allowed to load drivers."
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_user_driver_loaded.yml"
      }
    },
    {
      "id": "d00a9a72-2c09-4459-ad03-5e0a23351e36",
      "title": "Suspicious LDAP-Attributes Used",
      "status": "test",
      "description": "Detects the usage of particular AttributeLDAPDisplayNames, which are known for data exchange via LDAP by the tool LDAPFragger and are additionally not commonly used in companies.",
      "level": "high",
      "tags": [
        "attack.t1001.003",
        "attack.command-and-control"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 5136,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "AttributeValue__contains": {
                "field": "AttributeValue",
                "value": "*",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "AttributeLDAPDisplayName": {
                "field": "AttributeLDAPDisplayName",
                "value": [
                  "primaryInternationalISDNNumber",
                  "otherFacsimileTelephoneNumber",
                  "primaryTelexNumber"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1001.003"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "xknow @xknow_infosec",
        "date": "2019-03-24",
        "modified": "2022-10-05",
        "references": [
          "https://medium.com/@ivecodoe/detecting-ldapfragger-a-newly-released-cobalt-strike-beacon-using-ldap-for-c2-communication-c274a7f00961",
          "https://blog.fox-it.com/2020/03/19/ldapfragger-command-and-control-over-ldap-attributes/",
          "https://github.com/fox-it/LDAPFragger"
        ],
        "falsepositives": [
          "Companies, who may use these default LDAP-Attributes for personal information"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_susp_ldap_dataexchange.yml"
      }
    },
    {
      "id": "ab4561b1-6c7e-48a7-ad08-087cfb9ce8f1",
      "title": "Important Windows Event Auditing Disabled",
      "status": "test",
      "description": "Detects scenarios where system auditing for important events such as \"Process Creation\" or \"Logon\" events is disabled.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.002"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection_state_success_and_failure": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4719,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "SubcategoryGuid": {
                "field": "SubcategoryGuid",
                "value": [
                  "{0CCE9210-69AE-11D9-BED3-505054503030}",
                  "{0CCE9211-69AE-11D9-BED3-505054503030}",
                  "{0CCE9212-69AE-11D9-BED3-505054503030}",
                  "{0CCE9215-69AE-11D9-BED3-505054503030}",
                  "{0CCE921B-69AE-11D9-BED3-505054503030}",
                  "{0CCE922B-69AE-11D9-BED3-505054503030}",
                  "{0CCE922F-69AE-11D9-BED3-505054503030}",
                  "{0CCE9230-69AE-11D9-BED3-505054503030}",
                  "{0CCE9235-69AE-11D9-BED3-505054503030}",
                  "{0CCE9236-69AE-11D9-BED3-505054503030}",
                  "{0CCE9237-69AE-11D9-BED3-505054503030}",
                  "{0CCE923F-69AE-11D9-BED3-505054503030}",
                  "{0CCE9240-69AE-11D9-BED3-505054503030}",
                  "{0CCE9242-69AE-11D9-BED3-505054503030}"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "AuditPolicyChanges__contains": {
                "field": "AuditPolicyChanges",
                "value": [
                  "%%8448",
                  "%%8450"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_state_success_only": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4719,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "SubcategoryGuid": {
                "field": "SubcategoryGuid",
                "value": "{0CCE9217-69AE-11D9-BED3-505054503030}",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "AuditPolicyChanges__contains": {
                "field": "AuditPolicyChanges",
                "value": "%%8448",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.002"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-06-20",
        "modified": "2023-11-17",
        "references": [
          "https://docs.google.com/presentation/d/1dkrldTTlN3La-OjWtkWJBb4hVk6vfsSMBFBERs6R8zA/edit",
          "https://github.com/SigmaHQ/sigma/blob/ad1bfd3d28aa0ccc9656240f845022518ef65a2e/documentation/logsource-guides/windows/service/security.md"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_disable_event_auditing_critical.yml"
      }
    },
    {
      "id": "8cd538a4-62d5-4e83-810b-12d41e428d6e",
      "title": "Processes Accessing the Microphone and Webcam",
      "status": "test",
      "description": "Potential adversaries accessing the microphone and webcam in an endpoint.",
      "level": "medium",
      "tags": [
        "attack.collection",
        "attack.t1123"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": [
                  4657,
                  4656,
                  4663
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "ObjectName__contains": {
                "field": "ObjectName",
                "value": [
                  "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore\\microphone\\NonPackaged",
                  "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore\\webcam\\NonPackaged"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1123"
        ],
        "tactics": [
          "collection"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
        "date": "2020-06-07",
        "modified": "2021-11-27",
        "references": [
          "https://twitter.com/duzvik/status/1269671601852813320",
          "https://medium.com/@7a616368/can-you-track-processes-accessing-the-camera-and-microphone-7e6885b37072"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_camera_microphone_access.yml"
      }
    },
    {
      "id": "45545954-4016-43c6-855e-eae8f1c369dc",
      "title": "Protected Storage Service Access",
      "status": "test",
      "description": "Detects access to a protected_storage service over the network. Potential abuse of DPAPI to extract domain backup keys from Domain Controllers",
      "level": "high",
      "tags": [
        "attack.lateral-movement",
        "attack.t1021.002"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 5145,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ShareName__contains": {
                "field": "ShareName",
                "value": "IPC",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "RelativeTargetName": {
                "field": "RelativeTargetName",
                "value": "protected_storage",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1021.002"
        ],
        "tactics": [
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez @Cyb3rWard0g",
        "date": "2019-08-10",
        "modified": "2021-11-27",
        "references": [
          "https://threathunterplaybook.com/hunts/windows/190620-DomainDPAPIBackupKeyExtraction/notebook.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_protected_storage_service_access.yml"
      }
    },
    {
      "id": "470ec5fa-7b4e-4071-b200-4c753100f49b",
      "title": "Failed Code Integrity Checks",
      "status": "stable",
      "description": "Detects code integrity failures such as missing page hashes or corrupted drivers due unauthorized modification. This could be a sign of tampered binaries.\n",
      "level": "informational",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027.001"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": [
                  5038,
                  6281
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_crowdstrike": {
            "type": "field_match",
            "matchers": {
              "param1__contains": {
                "field": "param1",
                "value": [
                  "\\CSFalconServiceUninstallTool_",
                  "\\Program Files\\CrowdStrike\\",
                  "\\System32\\drivers\\CrowdStrike\\",
                  "\\Windows\\System32\\ScriptControl64_"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_sophos": {
            "type": "field_match",
            "matchers": {
              "param1__contains": {
                "field": "param1",
                "value": "\\Program Files\\Sophos\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1027.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Thomas Patzke",
        "date": "2019-12-03",
        "modified": "2025-01-19",
        "references": [
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-5038",
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-6281"
        ],
        "falsepositives": [
          "Disk device errors"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_codeintegrity_check_failure.yml"
      }
    },
    {
      "id": "12ba6a38-adb3-4d6b-91ba-a7fb248e3199",
      "title": "Password Policy Enumerated",
      "status": "test",
      "description": "Detects when the password policy is enumerated.",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.t1201"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4661,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "AccessList__contains": {
                "field": "AccessList",
                "value": "%%5392",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "ObjectServer": {
                "field": "ObjectServer",
                "value": "Security Account Manager",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1201"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Zach Mathis",
        "date": "2023-05-19",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4661",
          "https://github.com/jpalanco/alienvault-ossim/blob/f74359c0c027e42560924b5cff25cdf121e5505a/os-sim/agent/src/ParserUtil.py#L951"
        ],
        "falsepositives": [],
        "source_file": "sigma_rules/windows/builtin/security/win_security_password_policy_enumerated.yml"
      }
    },
    {
      "id": "0ee4d8a5-4e67-4faf-acfa-62a78457d1f2",
      "title": "HybridConnectionManager Service Installation",
      "status": "test",
      "description": "Rule to detect the Hybrid Connection Manager service installation.",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.t1554"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4697,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ServiceName": {
                "field": "ServiceName",
                "value": "HybridConnectionManager",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ServiceFileName__contains": {
                "field": "ServiceFileName",
                "value": "HybridConnectionManager",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1554"
        ],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
        "date": "2021-04-12",
        "modified": "2022-10-09",
        "references": [
          "https://twitter.com/Cyb3rWard0g/status/1381642789369286662"
        ],
        "falsepositives": [
          "Legitimate use of Hybrid Connection Manager via Azure function apps."
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_hybridconnectionmgr_svc_installation.yml"
      }
    },
    {
      "id": "13acf386-b8c6-4fe0-9a6e-c4756b974698",
      "title": "Remote PowerShell Sessions Network Connections (WinRM)",
      "status": "test",
      "description": "Detects basic PowerShell Remoting (WinRM) by monitoring for network inbound connections to ports 5985 OR 5986",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 5156,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "DestPort": {
                "field": "DestPort",
                "value": [
                  5985,
                  5986
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "LayerRTID": {
                "field": "LayerRTID",
                "value": 44,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez @Cyb3rWard0g",
        "date": "2019-09-12",
        "modified": "2022-10-09",
        "references": [
          "https://threathunterplaybook.com/hunts/windows/190511-RemotePwshExecution/notebook.html"
        ],
        "falsepositives": [
          "Legitimate use of remote PowerShell execution"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_remote_powershell_session.yml"
      }
    },
    {
      "id": "24549159-ac1b-479c-8175-d42aea947cae",
      "title": "Hacktool Ruler",
      "status": "test",
      "description": "This events that are generated when using the hacktool Ruler by Sensepost",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.discovery",
        "attack.execution",
        "attack.collection",
        "attack.lateral-movement",
        "attack.t1087",
        "attack.t1114",
        "attack.t1059",
        "attack.t1550.002"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection1": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4776,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Workstation": {
                "field": "Workstation",
                "value": "RULER",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection2": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": [
                  4624,
                  4625
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "WorkstationName": {
                "field": "WorkstationName",
                "value": "RULER",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "(1 of selection*)",
        "condition_parsed": {
          "op": "single",
          "selection": "(1 of selection*)"
        }
      },
      "mitre": {
        "techniques": [
          "T1087",
          "T1114",
          "T1059",
          "T1550.002"
        ],
        "tactics": [
          "defense_evasion",
          "discovery",
          "execution",
          "collection",
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2017-05-31",
        "modified": "2022-10-09",
        "references": [
          "https://github.com/sensepost/ruler",
          "https://github.com/sensepost/ruler/issues/47",
          "https://github.com/staaldraad/go-ntlm/blob/cd032d41aa8ce5751c07cb7945400c0f5c81e2eb/ntlm/ntlmv1.go#L427",
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4776",
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4624"
        ],
        "falsepositives": [
          "Go utilities that use staaldraad awesome NTLM library"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_alert_ruler.yml"
      }
    },
    {
      "id": "9eb99343-d336-4020-a3cd-67f3819e68ee",
      "title": "Account Tampering - Suspicious Failed Logon Reasons",
      "status": "test",
      "description": "This method uses uncommon error codes on failed logons to determine suspicious activity and tampering with accounts that have been disabled or somehow restricted.",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.initial-access",
        "attack.t1078"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection_eid": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": [
                  4625,
                  4776
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_status": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Status": {
                    "field": "Status",
                    "value": [
                      "0xC0000072",
                      "0xC000006F",
                      "0xC0000070",
                      "0xC0000413",
                      "0xC000018C",
                      "0xC000015B"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "SubStatus": {
                    "field": "SubStatus",
                    "value": [
                      "0xC0000072",
                      "0xC000006F",
                      "0xC0000070",
                      "0xC0000413",
                      "0xC000018C",
                      "0xC000015B"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "SubjectUserSid": {
                "field": "SubjectUserSid",
                "value": "S-1-0-0",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not filter",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "all of selection_*"
            },
            {
              "type": "not",
              "value": "filter"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1078"
        ],
        "tactics": [
          "persistence",
          "defense_evasion",
          "privilege_escalation",
          "initial_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2017-02-19",
        "modified": "2025-10-17",
        "references": [
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4625",
          "https://twitter.com/SBousseaden/status/1101431884540710913"
        ],
        "falsepositives": [
          "User using a disabled account"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_susp_failed_logon_reasons.yml"
      }
    },
    {
      "id": "1ce8c8a3-2723-48ed-8246-906ac91061a6",
      "title": "Possible PetitPotam Coerce Authentication Attempt",
      "status": "test",
      "description": "Detect PetitPotam coerced authentication activity.",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1187"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 5145,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ShareName__startswith": {
                "field": "ShareName",
                "value": "\\\\\\\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "ShareName__endswith": {
                "field": "ShareName",
                "value": "\\IPC$",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "RelativeTargetName": {
                "field": "RelativeTargetName",
                "value": "lsarpc",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "SubjectUserName": {
                "field": "SubjectUserName",
                "value": "ANONYMOUS LOGON",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1187"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Mauricio Velazco, Michael Haag",
        "date": "2021-09-02",
        "modified": "2022-08-11",
        "references": [
          "https://github.com/topotam/PetitPotam",
          "https://github.com/splunk/security_content/blob/0dd6de32de2118b2818550df9e65255f4109a56d/detections/endpoint/petitpotam_network_share_access_request.yml"
        ],
        "falsepositives": [
          "Unknown. Feedback welcomed."
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_petitpotam_network_share.yml"
      }
    },
    {
      "id": "1bbf25b9-8038-4154-a50b-118f2a32be27",
      "title": "Suspicious Windows ANONYMOUS LOGON Local Account Created",
      "status": "test",
      "description": "Detects the creation of suspicious accounts similar to ANONYMOUS LOGON, such as using additional spaces. Created as an covering detection for exclusion of Logon Type 3 from ANONYMOUS LOGON accounts.",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.t1136.001",
        "attack.t1136.002"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4720,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "SamAccountName__contains_all": {
                "field": "SamAccountName",
                "value": [
                  "ANONYMOUS",
                  "LOGON"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1136.001",
          "T1136.002"
        ],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "James Pemberton / @4A616D6573",
        "date": "2019-10-31",
        "modified": "2022-10-09",
        "references": [
          "https://twitter.com/SBousseaden/status/1189469425482829824"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_susp_local_anon_logon_created.yml"
      }
    },
    {
      "id": "5ee3a654-372f-11ec-8d3d-0242ac130003",
      "title": "ADCS Certificate Template Configuration Vulnerability",
      "status": "test",
      "description": "Detects certificate creation with template allowing risk permission subject",
      "level": "low",
      "tags": [
        "attack.privilege-escalation",
        "attack.credential-access"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection1": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4898,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TemplateContent__contains": {
                "field": "TemplateContent",
                "value": "CT_FLAG_ENROLLEE_SUPPLIES_SUBJECT",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection2": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4899,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "NewTemplateContent__contains": {
                "field": "NewTemplateContent",
                "value": "CT_FLAG_ENROLLEE_SUPPLIES_SUBJECT",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection1 or selection2",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection1",
            "selection2"
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "privilege_escalation",
          "credential_access"
        ]
      },
      "meta": {
        "author": "Orlinum , BlueDefenZer",
        "date": "2021-11-17",
        "modified": "2022-12-25",
        "references": [
          "https://www.specterops.io/assets/resources/Certified_Pre-Owned.pdf"
        ],
        "falsepositives": [
          "Administrator activity",
          "Proxy SSL certificate with subject modification",
          "Smart card enrollement"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_adcs_certificate_template_configuration_vulnerability.yml"
      }
    },
    {
      "id": "dcf2db1f-f091-425b-a821-c05875b8925a",
      "title": "Invoke-Obfuscation VAR+ Launcher - Security",
      "status": "test",
      "description": "Detects Obfuscated use of Environment Variables to execute PowerShell",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027",
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4697,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ServiceFileName__contains_all": {
                "field": "ServiceFileName",
                "value": [
                  "cmd",
                  "\"set",
                  "-f"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "ServiceFileName__contains": {
                "field": "ServiceFileName",
                "value": [
                  "/c",
                  "/r"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1027",
          "T1059.001"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Jonathan Cheong, oscd.community",
        "date": "2020-10-15",
        "modified": "2022-11-29",
        "references": [
          "https://github.com/SigmaHQ/sigma/issues/1009"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_invoke_obfuscation_var_services_security.yml"
      }
    },
    {
      "id": "32d56ea1-417f-44ff-822b-882873f5f43b",
      "title": "Impacket PsExec Execution",
      "status": "test",
      "description": "Detects execution of Impacket's psexec.py.",
      "level": "high",
      "tags": [
        "attack.lateral-movement",
        "attack.t1021.002"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection1": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 5145,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ShareName": {
                "field": "ShareName",
                "value": "\\\\\\\\\\*\\\\IPC$",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "RelativeTargetName__contains": {
                "field": "RelativeTargetName",
                "value": [
                  "RemCom_stdin",
                  "RemCom_stdout",
                  "RemCom_stderr"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection1",
        "condition_parsed": {
          "op": "single",
          "selection": "selection1"
        }
      },
      "mitre": {
        "techniques": [
          "T1021.002"
        ],
        "tactics": [
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Bhabesh Raj",
        "date": "2020-12-14",
        "modified": "2022-09-22",
        "references": [
          "https://web.archive.org/web/20230329171218/https://blog.menasec.net/2019/02/threat-hunting-3-detecting-psexec.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_impacket_psexec.yml"
      }
    },
    {
      "id": "941e5c45-cda7-4864-8cea-bbb7458d194a",
      "title": "Suspicious Remote Logon with Explicit Credentials",
      "status": "test",
      "description": "Detects suspicious processes logging on with explicit credentials",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.initial-access",
        "attack.defense-evasion",
        "attack.t1078",
        "attack.lateral-movement"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4648,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ProcessName__endswith": {
                "field": "ProcessName",
                "value": [
                  "\\cmd.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\winrs.exe",
                  "\\wmic.exe",
                  "\\net.exe",
                  "\\net1.exe",
                  "\\reg.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter1": {
            "type": "field_match",
            "matchers": {
              "TargetServerName": {
                "field": "TargetServerName",
                "value": "localhost",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter2": {
            "type": "field_match",
            "matchers": {
              "SubjectUserName__endswith": {
                "field": "SubjectUserName",
                "value": "$",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetUserName__endswith": {
                "field": "TargetUserName",
                "value": "$",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1078"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "initial_access",
          "defense_evasion",
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "oscd.community, Teymur Kheirkhabarov @HeirhabarovT, Zach Stanford @svch0st, Tim Shelton",
        "date": "2020-10-05",
        "modified": "2022-08-03",
        "references": [
          "https://drive.google.com/file/d/1lKya3_mLnR3UQuCoiYruO3qgu052_iS_/view"
        ],
        "falsepositives": [
          "Administrators that use the RunAS command or scheduled tasks"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_susp_logon_explicit_credentials.yml"
      }
    },
    {
      "id": "f6de6525-4509-495a-8a82-1f8b0ed73a00",
      "title": "Remote Task Creation via ATSVC Named Pipe",
      "status": "test",
      "description": "Detects remote task creation via at.exe or API interacting with ATSVC namedpipe",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.execution",
        "attack.lateral-movement",
        "attack.persistence",
        "car.2013-05-004",
        "car.2015-04-001",
        "attack.t1053.002"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 5145,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ShareName": {
                "field": "ShareName",
                "value": "\\\\\\\\\\*\\\\IPC$",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "RelativeTargetName": {
                "field": "RelativeTargetName",
                "value": "atsvc",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "AccessList__contains": {
                "field": "AccessList",
                "value": "WriteData",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1053.002"
        ],
        "tactics": [
          "privilege_escalation",
          "execution",
          "lateral_movement",
          "persistence"
        ]
      },
      "meta": {
        "author": "Samir Bousseaden",
        "date": "2019-04-03",
        "modified": "2024-08-01",
        "references": [
          "https://web.archive.org/web/20230409194125/https://blog.menasec.net/2019/03/threat-hunting-25-scheduled-tasks-for.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_atsvc_task.yml"
      }
    },
    {
      "id": "e5ac86dd-2da1-454b-be74-05d26c769d7d",
      "title": "Windows Default Domain GPO Modification",
      "status": "experimental",
      "description": "Detects modifications to Default Domain or Default Domain Controllers Group Policy Objects (GPOs).\nAdversaries may modify these default GPOs to deploy malicious configurations across the domain.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1484.001"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 5136,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectClass": {
                "field": "ObjectClass",
                "value": "groupPolicyContainer",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectDN__startswith": {
                "field": "ObjectDN",
                "value": [
                  "CN={31B2F340-016D-11D2-945F-00C04FB984F9},CN=POLICIES,CN=SYSTEM",
                  "CN={6AC1786C-016F-11D2-945F-00C04FB984F9},CN=POLICIES,CN=SYSTEM"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1484.001"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-11-22",
        "modified": "",
        "references": [
          "https://www.trendmicro.com/en_us/research/25/i/unmasking-the-gentlemen-ransomware.html",
          "https://adsecurity.org/?p=3377",
          "https://www.pentestpartners.com/security-blog/living-off-the-land-gpo-style/",
          "https://jgspiers.com/audit-group-policy-changes/"
        ],
        "falsepositives": [
          "Legitimate modifications to Default Domain or Default Domain Controllers GPOs"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_default_domain_gpo_modification.yml"
      }
    },
    {
      "id": "0248a7bc-8a9a-4cd8-a57e-3ae8e073a073",
      "title": "ISO Image Mounted",
      "status": "test",
      "description": "Detects the mount of an ISO image on an endpoint",
      "level": "medium",
      "tags": [
        "attack.initial-access",
        "attack.t1566.001"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4663,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectServer": {
                "field": "ObjectServer",
                "value": "Security",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectType": {
                "field": "ObjectType",
                "value": "File",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectName__startswith": {
                "field": "ObjectName",
                "value": "\\Device\\CdRom",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_generic": {
            "type": "field_match",
            "matchers": {
              "ObjectName": {
                "field": "ObjectName",
                "value": [
                  "\\Device\\CdRom0\\autorun.ico",
                  "\\Device\\CdRom0\\setup.exe",
                  "\\Device\\CdRom0\\setup64.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1566.001"
        ],
        "tactics": [
          "initial_access"
        ]
      },
      "meta": {
        "author": "Syed Hasan (@syedhasan009)",
        "date": "2021-05-29",
        "modified": "2023-11-09",
        "references": [
          "https://www.trendmicro.com/vinfo/hk-en/security/news/cybercrime-and-digital-threats/malicious-spam-campaign-uses-iso-image-files-to-deliver-lokibot-and-nanocore",
          "https://www.proofpoint.com/us/blog/threat-insight/threat-actor-profile-ta2719-uses-colorful-lures-deliver-rats-local-languages",
          "https://twitter.com/MsftSecIntel/status/1257324139515269121",
          "https://github.com/redcanaryco/atomic-red-team/blob/0f229c0e42bfe7ca736a14023836d65baa941ed2/atomics/T1553.005/T1553.005.md#atomic-test-1---mount-iso-image"
        ],
        "falsepositives": [
          "Software installation ISO files"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_iso_mount.yml"
      }
    },
    {
      "id": "80b708f3-d034-40e4-a6c8-d23b7a7db3d1",
      "title": "Invoke-Obfuscation Via Stdin - Security",
      "status": "test",
      "description": "Detects Obfuscated Powershell via Stdin in Scripts",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027",
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4697,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ServiceFileName__contains_all": {
                "field": "ServiceFileName",
                "value": [
                  "set",
                  "&&"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "ServiceFileName__contains": {
                "field": "ServiceFileName",
                "value": [
                  "environment",
                  "invoke",
                  "${input)"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1027",
          "T1059.001"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Nikita Nazarov, oscd.community",
        "date": "2020-10-12",
        "modified": "2022-11-29",
        "references": [
          "https://github.com/SigmaHQ/sigma/issues/1009"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_invoke_obfuscation_via_stdin_services_security.yml"
      }
    },
    {
      "id": "496a0e47-0a33-4dca-b009-9e6ca3591f39",
      "title": "Suspicious Kerberos RC4 Ticket Encryption",
      "status": "test",
      "description": "Detects service ticket requests using RC4 encryption type",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.t1558.003"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4769,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TicketOptions": {
                "field": "TicketOptions",
                "value": "0x40810000",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TicketEncryptionType": {
                "field": "TicketEncryptionType",
                "value": "0x17",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "reduction": {
            "type": "field_match",
            "matchers": {
              "ServiceName__endswith": {
                "field": "ServiceName",
                "value": "$",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection and not reduction",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "reduction"
        }
      },
      "mitre": {
        "techniques": [
          "T1558.003"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2017-02-06",
        "modified": "2022-06-19",
        "references": [
          "https://adsecurity.org/?p=3458",
          "https://www.trimarcsecurity.com/single-post/TrimarcResearch/Detecting-Kerberoasting-Activity"
        ],
        "falsepositives": [
          "Service accounts used on legacy systems (e.g. NetApp)",
          "Windows Domains with DFL 2003 and legacy systems"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_susp_rc4_kerberos.yml"
      }
    },
    {
      "id": "968eef52-9cff-4454-8992-1e74b9cbad6c",
      "title": "Reconnaissance Activity",
      "status": "test",
      "description": "Detects activity as \"net user administrator /domain\" and \"net group domain admins /domain\"",
      "level": "high",
      "tags": [
        "attack.discovery",
        "attack.t1087.002",
        "attack.t1069.002",
        "attack.s0039"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4661,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "AccessMask": {
                "field": "AccessMask",
                "value": "0x2d",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectType": {
                "field": "ObjectType",
                "value": [
                  "SAM_USER",
                  "SAM_GROUP"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "ObjectName__startswith": {
                "field": "ObjectName",
                "value": "S-1-5-21-",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "ObjectName__endswith": {
                "field": "ObjectName",
                "value": [
                  "-500",
                  "-512"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1087.002",
          "T1069.002"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Jack Croock (method), Jonhnathan Ribeiro (improvements), oscd.community",
        "date": "2017-03-07",
        "modified": "2022-08-22",
        "references": [
          "https://findingbad.blogspot.de/2017/01/hunting-what-does-it-look-like.html"
        ],
        "falsepositives": [
          "Administrator activity"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_susp_net_recon_activity.yml"
      }
    },
    {
      "id": "2a926e6a-4b81-4011-8a96-e36cc8c04302",
      "title": "PowerShell Scripts Installed as Services - Security",
      "status": "test",
      "description": "Detects powershell script installed as a Service",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1569.002"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4697,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ServiceFileName__contains": {
                "field": "ServiceFileName",
                "value": [
                  "powershell",
                  "pwsh"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1569.002"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "oscd.community, Natalia Shornikova",
        "date": "2020-10-06",
        "modified": "2022-11-29",
        "references": [
          "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_powershell_script_installed_as_service.yml"
      }
    },
    {
      "id": "c4e92a97-a9ff-4392-9d2d-7a4c642768ca",
      "title": "Service Installed By Unusual Client - Security",
      "status": "test",
      "description": "Detects a service installed by a client which has PID 0 or whose parent has PID 0",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.privilege-escalation",
        "attack.t1543"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection_eid": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4697,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_pid": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "ClientProcessId": {
                    "field": "ClientProcessId",
                    "value": 0,
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "ParentProcessId": {
                    "field": "ParentProcessId",
                    "value": 0,
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1543"
        ],
        "tactics": [
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Tim Rauch (Nextron Systems), Elastic (idea)",
        "date": "2022-09-15",
        "modified": "2023-01-04",
        "references": [
          "https://www.elastic.co/guide/en/security/current/windows-service-installed-via-an-unusual-client.html",
          "https://www.x86matthew.com/view_post?id=create_svc_rpc",
          "https://twitter.com/SBousseaden/status/1490608838701166596"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_service_installation_by_unusal_client.yml"
      }
    },
    {
      "id": "52d8b0c6-53d6-439a-9e41-52ad442ad9ad",
      "title": "First Time Seen Remote Named Pipe",
      "status": "test",
      "description": "This detection excludes known namped pipes accessible remotely and notify on newly observed ones, may help to detect lateral movement and remote exec using named pipes",
      "level": "high",
      "tags": [
        "attack.lateral-movement",
        "attack.t1021.002"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection1": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 5145,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ShareName": {
                "field": "ShareName",
                "value": "\\\\\\\\\\*\\\\IPC$",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "false_positives": {
            "type": "field_match",
            "matchers": {
              "RelativeTargetName": {
                "field": "RelativeTargetName",
                "value": [
                  "atsvc",
                  "samr",
                  "lsarpc",
                  "lsass",
                  "winreg",
                  "netlogon",
                  "srvsvc",
                  "protected_storage",
                  "wkssvc",
                  "browser",
                  "netdfs",
                  "svcctl",
                  "spoolss",
                  "ntsvcs",
                  "LSM_API_service",
                  "HydraLsPipe",
                  "TermSrv_API_service",
                  "MsFteWds",
                  "sql\\query",
                  "eventlog"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection1 and not false_positives",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection1",
          "exclude": "false_positives"
        }
      },
      "mitre": {
        "techniques": [
          "T1021.002"
        ],
        "tactics": [
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Samir Bousseaden",
        "date": "2019-04-03",
        "modified": "2023-03-14",
        "references": [
          "https://twitter.com/menasec1/status/1104489274387451904"
        ],
        "falsepositives": [
          "Update the excluded named pipe to filter out any newly observed legit named pipe"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_lm_namedpipe.yml"
      }
    },
    {
      "id": "a4c90ea1-2634-4ca0-adbb-35eae169b6fc",
      "title": "ETW Logging Disabled In .NET Processes - Registry",
      "status": "test",
      "description": "Potential adversaries stopping ETW providers recording loaded .NET assemblies.",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112",
        "attack.t1562"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection_etw_enabled": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4657,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectName__endswith": {
                "field": "ObjectName",
                "value": "\\SOFTWARE\\Microsoft\\.NETFramework",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "ObjectValueName": {
                "field": "ObjectValueName",
                "value": "ETWEnabled",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "NewValue": {
                "field": "NewValue",
                "value": 0,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_complus": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4657,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectName__contains": {
                "field": "ObjectName",
                "value": "\\Environment",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "ObjectValueName": {
                "field": "ObjectValueName",
                "value": [
                  "COMPlus_ETWEnabled",
                  "COMPlus_ETWFlags"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "NewValue": {
                "field": "NewValue",
                "value": 0,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1112",
          "T1562"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
        "date": "2020-06-05",
        "modified": "2022-12-20",
        "references": [
          "https://twitter.com/_xpn_/status/1268712093928378368",
          "https://social.msdn.microsoft.com/Forums/vstudio/en-US/0878832e-39d7-4eaf-8e16-a729c4c40975/what-can-i-use-e13c0d23ccbc4e12931bd9cc2eee27e4-for?forum=clr",
          "https://github.com/dotnet/runtime/blob/ee2355c801d892f2894b0f7b14a20e6cc50e0e54/docs/design/coreclr/jit/viewing-jit-dumps.md#setting-configuration-variables",
          "https://github.com/dotnet/runtime/blob/f62e93416a1799aecc6b0947adad55a0d9870732/src/coreclr/src/inc/clrconfigvalues.h#L35-L38",
          "https://github.com/dotnet/runtime/blob/7abe42dc1123722ed385218268bb9fe04556e3d3/src/coreclr/src/inc/clrconfig.h#L33-L39",
          "https://github.com/dotnet/runtime/search?p=1&q=COMPlus_&unscoped_q=COMPlus_",
          "https://bunnyinside.com/?term=f71e8cb9c76a",
          "http://managed670.rssing.com/chan-5590147/all_p1.html",
          "https://github.com/dotnet/runtime/blob/4f9ae42d861fcb4be2fcd5d3d55d5f227d30e723/docs/coding-guidelines/clr-jit-coding-conventions.md#1412-disabling-code",
          "https://i.blackhat.com/EU-21/Wednesday/EU-21-Teodorescu-Veni-No-Vidi-No-Vici-Attacks-On-ETW-Blind-EDRs.pdf"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_dot_net_etw_tamper.yml"
      }
    },
    {
      "id": "c462f537-a1e3-41a6-b5fc-b2c2cef9bf82",
      "title": "Suspicious PsExec Execution",
      "status": "test",
      "description": "detects execution of psexec or paexec with renamed service name, this rule helps to filter out the noise if psexec is used for legit purposes or if attacker uses a different psexec client other than sysinternal one",
      "level": "high",
      "tags": [
        "attack.lateral-movement",
        "attack.t1021.002"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection1": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 5145,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ShareName": {
                "field": "ShareName",
                "value": "\\\\\\\\\\*\\\\IPC$",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "RelativeTargetName__endswith": {
                "field": "RelativeTargetName",
                "value": [
                  "-stdin",
                  "-stdout",
                  "-stderr"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "RelativeTargetName__startswith": {
                "field": "RelativeTargetName",
                "value": "PSEXESVC",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection1 and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection1",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1021.002"
        ],
        "tactics": [
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Samir Bousseaden",
        "date": "2019-04-03",
        "modified": "2022-08-11",
        "references": [
          "https://web.archive.org/web/20230329171218/https://blog.menasec.net/2019/02/threat-hunting-3-detecting-psexec.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_susp_psexec.yml"
      }
    },
    {
      "id": "f8748f2c-89dc-4d95-afb0-5a2dfdbad332",
      "title": "SAM Registry Hive Handle Request",
      "status": "test",
      "description": "Detects handles requested to SAM registry hive",
      "level": "high",
      "tags": [
        "attack.discovery",
        "attack.t1012",
        "attack.credential-access",
        "attack.t1552.002"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4656,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectType": {
                "field": "ObjectType",
                "value": "Key",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectName__endswith": {
                "field": "ObjectName",
                "value": "\\SAM",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1012",
          "T1552.002"
        ],
        "tactics": [
          "discovery",
          "credential_access"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez @Cyb3rWard0g",
        "date": "2019-08-12",
        "modified": "2021-11-27",
        "references": [
          "https://threathunterplaybook.com/hunts/windows/190725-SAMRegistryHiveHandleRequest/notebook.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_sam_registry_hive_handle_request.yml"
      }
    },
    {
      "id": "4c54ba8f-73d2-4d40-8890-d9cf1dca3d30",
      "title": "Invoke-Obfuscation VAR++ LAUNCHER OBFUSCATION - Security",
      "status": "test",
      "description": "Detects Obfuscated Powershell via VAR++ LAUNCHER",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027",
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4697,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ServiceFileName__contains_all": {
                "field": "ServiceFileName",
                "value": [
                  "&&set",
                  "cmd",
                  "/c",
                  "-f"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "ServiceFileName__contains": {
                "field": "ServiceFileName",
                "value": [
                  "{0}",
                  "{1}",
                  "{2}",
                  "{3}",
                  "{4}",
                  "{5}"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1027",
          "T1059.001"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Timur Zinniatullin, oscd.community",
        "date": "2020-10-13",
        "modified": "2022-11-29",
        "references": [
          "https://github.com/SigmaHQ/sigma/issues/1009"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_invoke_obfuscation_via_var_services_security.yml"
      }
    },
    {
      "id": "2c99737c-585d-4431-b61a-c911d86ff32f",
      "title": "Powerview Add-DomainObjectAcl DCSync AD Extend Right",
      "status": "test",
      "description": "Backdooring domain object to grant the rights associated with DCSync to a regular user or machine account using Powerview\\Add-DomainObjectAcl DCSync Extended Right cmdlet, will allow to re-obtain the pwd hashes of any user/computer",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1098"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 5136,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "AttributeLDAPDisplayName": {
                "field": "AttributeLDAPDisplayName",
                "value": "ntSecurityDescriptor",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "AttributeValue__contains": {
                "field": "AttributeValue",
                "value": [
                  "1131f6ad-9c07-11d1-f79f-00c04fc2dcd2",
                  "1131f6aa-9c07-11d1-f79f-00c04fc2dcd2",
                  "89e95b76-444d-4c62-991a-0facbeda640c"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_dns_object_class": {
            "type": "field_match",
            "matchers": {
              "ObjectClass": {
                "field": "ObjectClass",
                "value": [
                  "dnsNode",
                  "dnsZoneScope",
                  "dnsZone"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1098"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Samir Bousseaden, Roberto Rodriguez @Cyb3rWard0g, oscd.community, Tim Shelton, Maxence Fossat",
        "date": "2019-04-03",
        "modified": "2022-08-16",
        "references": [
          "https://twitter.com/menasec1/status/1111556090137903104",
          "https://www.specterops.io/assets/resources/an_ace_up_the_sleeve.pdf"
        ],
        "falsepositives": [
          "New Domain Controller computer account, check user SIDs within the value attribute of event 5136 and verify if it's a regular user or DC computer account."
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_account_backdoor_dcsync_rights.yml"
      }
    },
    {
      "id": "d04ae2b8-ad54-4de0-bd87-4bc1da66aa59",
      "title": "Kerberoasting Activity - Initial Query",
      "status": "test",
      "description": "This rule will collect the data needed to start looking into possible kerberoasting activity.\nFurther analysis or computation within the query is needed focusing on requests from one specific host/IP towards multiple service names within a time period of 5 seconds.\nYou can then set a threshold for the number of requests and time between the requests to turn this into an alert.\n",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.t1558.003"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4769,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Status": {
                "field": "Status",
                "value": "0x0",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TicketEncryptionType": {
                "field": "TicketEncryptionType",
                "value": "0x17",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_krbtgt": {
            "type": "field_match",
            "matchers": {
              "ServiceName__endswith": {
                "field": "ServiceName",
                "value": [
                  "krbtgt",
                  "$"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_machine_accounts": {
            "type": "field_match",
            "matchers": {
              "TargetUserName__contains": {
                "field": "TargetUserName",
                "value": "$@",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1558.003"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "@kostastsale",
        "date": "2022-01-21",
        "modified": "2025-10-19",
        "references": [
          "https://www.trustedsec.com/blog/art_of_kerberoast/",
          "https://adsecurity.org/?p=3513"
        ],
        "falsepositives": [
          "Legacy applications."
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_kerberoasting_activity.yml"
      }
    },
    {
      "id": "66b6be3d-55d0-4f47-9855-d69df21740ea",
      "title": "Local User Creation",
      "status": "test",
      "description": "Detects local user creation on Windows servers, which shouldn't happen in an Active Directory environment. Apply this Sigma Use Case on your Windows server logs and not on your DC logs.\n",
      "level": "low",
      "tags": [
        "attack.persistence",
        "attack.t1136.001"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4720,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1136.001"
        ],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "Patrick Bareiss",
        "date": "2019-04-18",
        "modified": "2021-01-17",
        "references": [
          "https://patrick-bareiss.com/detecting-local-user-creation-in-ad-with-sigma/"
        ],
        "falsepositives": [
          "Domain Controller Logs",
          "Local accounts managed by privileged account management tools"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_user_creation.yml"
      }
    },
    {
      "id": "f7644214-0eb0-4ace-9455-331ec4c09253",
      "title": "Kerberos Manipulation",
      "status": "test",
      "description": "Detects failed Kerberos TGT issue operation. This can be a sign of manipulations of TGT messages by an attacker.",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1212"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": [
                  675,
                  4768,
                  4769,
                  4771
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "Status": {
                "field": "Status",
                "value": [
                  "0x9",
                  "0xA",
                  "0xB",
                  "0xF",
                  "0x10",
                  "0x11",
                  "0x13",
                  "0x14",
                  "0x1A",
                  "0x1F",
                  "0x21",
                  "0x22",
                  "0x23",
                  "0x24",
                  "0x26",
                  "0x27",
                  "0x28",
                  "0x29",
                  "0x2C",
                  "0x2D",
                  "0x2E",
                  "0x2F",
                  "0x31",
                  "0x32",
                  "0x3E",
                  "0x3F",
                  "0x40",
                  "0x41",
                  "0x43",
                  "0x44"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1212"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2017-02-10",
        "modified": "2024-01-16",
        "references": [
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4771"
        ],
        "falsepositives": [
          "Faulty legacy applications"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_susp_kerberos_manipulation.yml"
      }
    },
    {
      "id": "d3abac66-f11c-4ed0-8acb-50cc29c97eed",
      "title": "NetNTLM Downgrade Attack",
      "status": "test",
      "description": "Detects NetNTLM downgrade attack",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1562.001",
        "attack.t1112"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4657,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectName__contains_all": {
                "field": "ObjectName",
                "value": [
                  "\\REGISTRY\\MACHINE\\SYSTEM",
                  "ControlSet",
                  "\\Control\\Lsa"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "ObjectValueName": {
                "field": "ObjectValueName",
                "value": [
                  "LmCompatibilityLevel",
                  "NtlmMinClientSec",
                  "RestrictSendingNTLMTraffic"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001",
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), wagga",
        "date": "2018-03-20",
        "modified": "2022-10-09",
        "references": [
          "https://www.optiv.com/blog/post-exploitation-using-netntlm-downgrade-attacks"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_net_ntlm_downgrade.yml"
      }
    },
    {
      "id": "f69a87ea-955e-4fb4-adb2-bb9fd6685632",
      "title": "External Disk Drive Or USB Storage Device Was Recognized By The System",
      "status": "test",
      "description": "Detects external disk drives or plugged-in USB devices.",
      "level": "low",
      "tags": [
        "attack.t1091",
        "attack.t1200",
        "attack.lateral-movement",
        "attack.initial-access"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection_eid": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 6416,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_field": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "ClassName": {
                    "field": "ClassName",
                    "value": "DiskDrive",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "DeviceDescription": {
                    "field": "DeviceDescription",
                    "value": "USB Mass Storage Device",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1091",
          "T1200"
        ],
        "tactics": [
          "lateral_movement",
          "initial_access"
        ]
      },
      "meta": {
        "author": "Keith Wright",
        "date": "2019-11-20",
        "modified": "2024-02-09",
        "references": [
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-6416"
        ],
        "falsepositives": [
          "Likely"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_external_device.yml"
      }
    },
    {
      "id": "54f0434b-726f-48a1-b2aa-067df14516e4",
      "title": "Password Protected ZIP File Opened (Suspicious Filenames)",
      "status": "test",
      "description": "Detects the extraction of password protected ZIP archives with suspicious file names. See the filename variable for more details on which file has been opened.",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.defense-evasion",
        "attack.t1027",
        "attack.t1105",
        "attack.t1036"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 5379,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetName__contains": {
                "field": "TargetName",
                "value": "Microsoft_Windows_Shell_ZipFolder:filename",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_filename": {
            "type": "field_match",
            "matchers": {
              "TargetName__contains": {
                "field": "TargetName",
                "value": [
                  "invoice",
                  "new order",
                  "rechnung",
                  "factura",
                  "delivery",
                  "purchase",
                  "order",
                  "payment"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection and selection_filename",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "ref",
              "value": "selection_filename"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1027",
          "T1105",
          "T1036"
        ],
        "tactics": [
          "command_and_control",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-05-09",
        "modified": "",
        "references": [
          "https://twitter.com/sbousseaden/status/1523383197513379841"
        ],
        "falsepositives": [
          "Legitimate used of encrypted ZIP files"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_susp_opened_encrypted_zip_filename.yml"
      }
    },
    {
      "id": "123e4e6d-b123-48f8-b261-7214938acaf0",
      "title": "Startup/Logon Script Added to Group Policy Object",
      "status": "test",
      "description": "Detects the modification of Group Policy Objects (GPO) to add a startup/logon script to users or computer objects.\n",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1484.001",
        "attack.t1547"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection_eventid": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": [
                  5136,
                  5145
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_attributes_main": {
            "type": "field_match",
            "matchers": {
              "AttributeLDAPDisplayName": {
                "field": "AttributeLDAPDisplayName",
                "value": [
                  "gPCMachineExtensionNames",
                  "gPCUserExtensionNames"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "AttributeValue__contains": {
                "field": "AttributeValue",
                "value": "42B5FAAE-6536-11D2-AE5A-0000F87571E3",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_attributes_optional": {
            "type": "field_match",
            "matchers": {
              "AttributeValue__contains": {
                "field": "AttributeValue",
                "value": [
                  "40B6664F-4972-11D1-A7CA-0000F87571E3",
                  "40B66650-4972-11D1-A7CA-0000F87571E3"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_share": {
            "type": "field_match",
            "matchers": {
              "ShareName__endswith": {
                "field": "ShareName",
                "value": "\\SYSVOL",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "RelativeTargetName__endswith": {
                "field": "RelativeTargetName",
                "value": [
                  "\\scripts.ini",
                  "\\psscripts.ini"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "AccessList__contains": {
                "field": "AccessList",
                "value": "%%4417",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_eventid and (all of selection_attributes_* or selection_share)",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection_eventid and (all of selection_attributes_*",
            "selection_share)"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1484.001",
          "T1547"
        ],
        "tactics": [
          "persistence",
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Elastic, Josh Nickels, Marius Rothenbcher",
        "date": "2024-09-06",
        "modified": "",
        "references": [
          "https://www.elastic.co/guide/en/security/current/startup-logon-script-added-to-group-policy-object.html"
        ],
        "falsepositives": [
          "Legitimate execution by system administrators."
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_susp_group_policy_startup_script_added_to_gpo.yml"
      }
    },
    {
      "id": "2632954e-db1c-49cb-9936-67d1ef1d17d2",
      "title": "Addition of SID History to Active Directory Object",
      "status": "stable",
      "description": "An attacker can use the SID history attribute to gain additional privileges.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.persistence",
        "attack.privilege-escalation",
        "attack.t1134.005"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection1": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": [
                  4765,
                  4766
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection2": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4738,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection3": {
            "type": "field_match",
            "matchers": {
              "SidHistory": {
                "field": "SidHistory",
                "value": [
                  "-",
                  "%%1793"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_null": {
            "type": "field_match",
            "matchers": {
              "SidHistory": {
                "field": "SidHistory",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection1 or (selection2 and not selection3 and not filter_null)",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection1",
            "(selection2 and not selection3 and not filter_null)"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1134.005"
        ],
        "tactics": [
          "defense_evasion",
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Thomas Patzke, @atc_project (improvements)",
        "date": "2017-02-19",
        "modified": "",
        "references": [
          "https://adsecurity.org/?p=1772"
        ],
        "falsepositives": [
          "Migration of an account into a new domain"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_susp_add_sid_history.yml"
      }
    },
    {
      "id": "0c718a5e-4284-4fb9-b4d9-b9a50b3a1974",
      "title": "Invoke-Obfuscation STDIN+ Launcher - Security",
      "status": "test",
      "description": "Detects Obfuscated use of stdin to execute PowerShell",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027",
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4697,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ServiceFileName__contains_all": {
                "field": "ServiceFileName",
                "value": [
                  "cmd",
                  "powershell"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection2": {
            "type": "field_match",
            "matchers": {
              "ServiceFileName__contains": {
                "field": "ServiceFileName",
                "value": [
                  "${input}",
                  "noexit"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection3": {
            "type": "field_match",
            "matchers": {
              "ServiceFileName__contains": {
                "field": "ServiceFileName",
                "value": [
                  " /c ",
                  " /r "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1027",
          "T1059.001"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Jonathan Cheong, oscd.community",
        "date": "2020-10-15",
        "modified": "2022-11-29",
        "references": [
          "https://github.com/SigmaHQ/sigma/issues/1009"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_invoke_obfuscation_stdin_services_security.yml"
      }
    },
    {
      "id": "f0d1feba-4344-4ca9-8121-a6c97bd6df52",
      "title": "Credential Dumping Tools Service Execution - Security",
      "status": "test",
      "description": "Detects well-known credential dumping tools execution via service execution events",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.execution",
        "attack.t1003.001",
        "attack.t1003.002",
        "attack.t1003.004",
        "attack.t1003.005",
        "attack.t1003.006",
        "attack.t1569.002",
        "attack.s0005"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4697,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ServiceFileName__contains": {
                "field": "ServiceFileName",
                "value": [
                  "cachedump",
                  "dumpsvc",
                  "fgexec",
                  "gsecdump",
                  "mimidrv",
                  "pwdump",
                  "servpw"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.001",
          "T1003.002",
          "T1003.004",
          "T1003.005",
          "T1003.006",
          "T1569.002"
        ],
        "tactics": [
          "credential_access",
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Teymur Kheirkhabarov, Daniil Yugoslavskiy, oscd.community",
        "date": "2017-03-05",
        "modified": "2022-11-29",
        "references": [
          "https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment"
        ],
        "falsepositives": [
          "Legitimate Administrator using credential dumping tool for password recovery"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_mal_creddumper.yml"
      }
    },
    {
      "id": "00ba9da1-b510-4f6b-b258-8d338836180f",
      "title": "Password Protected ZIP File Opened",
      "status": "test",
      "description": "Detects the extraction of password protected ZIP archives. See the filename variable for more details on which file has been opened.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 5379,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetName__contains": {
                "field": "TargetName",
                "value": "Microsoft_Windows_Shell_ZipFolder:filename",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "TargetName__contains": {
                "field": "TargetName",
                "value": "\\Temporary Internet Files\\Content.Outlook",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1027"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-05-09",
        "modified": "",
        "references": [
          "https://twitter.com/sbousseaden/status/1523383197513379841"
        ],
        "falsepositives": [
          "Legitimate used of encrypted ZIP files"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_susp_opened_encrypted_zip.yml"
      }
    },
    {
      "id": "300bac00-e041-4ee2-9c36-e262656a6ecc",
      "title": "Active Directory User Backdoors",
      "status": "test",
      "description": "Detects scenarios where one can control another users or computers account without having to use their credentials.",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.t1098",
        "attack.persistence"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection1": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4738,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_5136_1": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 5136,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "AttributeLDAPDisplayName": {
                "field": "AttributeLDAPDisplayName",
                "value": "msDS-AllowedToDelegateTo",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_5136_2": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 5136,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectClass": {
                "field": "ObjectClass",
                "value": "user",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "AttributeLDAPDisplayName": {
                "field": "AttributeLDAPDisplayName",
                "value": "servicePrincipalName",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_5136_3": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 5136,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "AttributeLDAPDisplayName": {
                "field": "AttributeLDAPDisplayName",
                "value": "msDS-AllowedToActOnBehalfOfOtherIdentity",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_empty": {
            "type": "field_match",
            "matchers": {
              "AllowedToDelegateTo": {
                "field": "AllowedToDelegateTo",
                "value": [
                  "",
                  "-"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_null": {
            "type": "field_match",
            "matchers": {
              "AllowedToDelegateTo": {
                "field": "AllowedToDelegateTo",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "(selection1 and not 1 of filter_*) or 1 of selection_5136_*",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "(selection1 and not 1 of filter_*)",
            "1 of selection_5136_*"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1098"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "@neu5ron",
        "date": "2017-04-13",
        "modified": "2024-02-26",
        "references": [
          "https://msdn.microsoft.com/en-us/library/cc220234.aspx",
          "https://adsecurity.org/?p=3466",
          "https://blog.harmj0y.net/redteaming/another-word-on-delegation/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_alert_ad_user_backdoors.yml"
      }
    },
    {
      "id": "0badd08f-c6a3-4630-90d3-6875cca440be",
      "title": "User Logoff Event",
      "status": "test",
      "description": "Detects a user log-off activity. Could be used for example to correlate information during forensic investigations",
      "level": "informational",
      "tags": [
        "attack.impact",
        "attack.t1531"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": [
                  4634,
                  4647
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1531"
        ],
        "tactics": [
          "impact"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-10-14",
        "modified": "",
        "references": [
          "https://github.com/Yamato-Security/EnableWindowsLogSettings/blob/7f6d755d45ac7cc9fc35b0cbf498e6aa4ef19def/ConfiguringSecurityLogAuditPolicies.md",
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4634",
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4647"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_user_logoff.yml"
      }
    },
    {
      "id": "39a80702-d7ca-4a83-b776-525b1f86a36d",
      "title": "Potential Secure Deletion with SDelete",
      "status": "test",
      "description": "Detects files that have extensions commonly seen while SDelete is used to wipe files.",
      "level": "medium",
      "tags": [
        "attack.impact",
        "attack.defense-evasion",
        "attack.t1070.004",
        "attack.t1027.005",
        "attack.t1485",
        "attack.t1553.002",
        "attack.s0195"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": [
                  4656,
                  4663,
                  4658
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "ObjectName__endswith": {
                "field": "ObjectName",
                "value": [
                  ".AAA",
                  ".ZZZ"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1070.004",
          "T1027.005",
          "T1485",
          "T1553.002"
        ],
        "tactics": [
          "impact",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Thomas Patzke",
        "date": "2017-06-14",
        "modified": "2024-12-13",
        "references": [
          "https://jpcertcc.github.io/ToolAnalysisResultSheet/details/sdelete.htm",
          "https://www.jpcert.or.jp/english/pub/sr/ir_research.html",
          "https://learn.microsoft.com/en-gb/sysinternals/downloads/sdelete"
        ],
        "falsepositives": [
          "Legitimate usage of SDelete",
          "Files that are interacted with that have these extensions legitimately"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_sdelete_potential_secure_deletion.yml"
      }
    },
    {
      "id": "e9faba72-4974-4ab2-a4c5-46e25ad59e9b",
      "title": "VSSAudit Security Event Source Registration",
      "status": "test",
      "description": "Detects the registration of the security event source VSSAudit. It would usually trigger when volume shadow copy operations happen.",
      "level": "informational",
      "tags": [
        "attack.credential-access",
        "attack.t1003.002"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "AuditSourceName": {
                "field": "AuditSourceName",
                "value": "VSSAudit",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "EventID": {
                "field": "EventID",
                "value": [
                  4904,
                  4905
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.002"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez @Cyb3rWard0g, Open Threat Research (OTR)",
        "date": "2020-10-20",
        "modified": "2022-04-28",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1003.002/T1003.002.md#atomic-test-3---esentutlexe-sam-copy"
        ],
        "falsepositives": [
          "Legitimate use of VSSVC. Maybe backup operations. It would usually be done by C:\\Windows\\System32\\VSSVC.exe."
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_vssaudit_secevent_source_registration.yml"
      }
    },
    {
      "id": "35ba1d85-724d-42a3-889f-2e2362bcaf23",
      "title": "AD Privileged Users or Groups Reconnaissance",
      "status": "test",
      "description": "Detect priv users or groups recon based on 4661 eventid and known privileged users or groups SIDs",
      "level": "high",
      "tags": [
        "attack.discovery",
        "attack.t1087.002"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4661,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectType": {
                "field": "ObjectType",
                "value": [
                  "SAM_USER",
                  "SAM_GROUP"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_object": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "ObjectName__endswith": {
                    "field": "ObjectName",
                    "value": [
                      "-512",
                      "-502",
                      "-500",
                      "-505",
                      "-519",
                      "-520",
                      "-544",
                      "-551",
                      "-555"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "ObjectName__contains": {
                    "field": "ObjectName",
                    "value": "admin",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "SubjectUserName__endswith": {
                "field": "SubjectUserName",
                "value": "$",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and selection_object and not filter",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "ref",
              "value": "selection_object"
            },
            {
              "type": "not",
              "value": "filter"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1087.002"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Samir Bousseaden",
        "date": "2019-04-03",
        "modified": "2022-07-13",
        "references": [
          "https://web.archive.org/web/20230329163438/https://blog.menasec.net/2019/02/threat-hunting-5-detecting-enumeration.html"
        ],
        "falsepositives": [
          "If source account name is not an admin then its super suspicious"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_account_discovery.yml"
      }
    },
    {
      "id": "f6de9536-0441-4b3f-a646-f4e00f300ffd",
      "title": "Weak Encryption Enabled and Kerberoast",
      "status": "test",
      "description": "Detects scenario where weak encryption is enabled for a user profile which could be used for hash/password cracking.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4738,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "olduac_des": {
            "type": "field_match",
            "matchers": {
              "OldUacValue__endswith": {
                "field": "OldUacValue",
                "value": [
                  "8???",
                  "9???",
                  "A???",
                  "B???",
                  "C???",
                  "D???",
                  "E???",
                  "F???"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "newuac_des": {
            "type": "field_match",
            "matchers": {
              "NewUacValue__endswith": {
                "field": "NewUacValue",
                "value": [
                  "8???",
                  "9???",
                  "A???",
                  "B???",
                  "C???",
                  "D???",
                  "E???",
                  "F???"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "olduac_preauth": {
            "type": "field_match",
            "matchers": {
              "OldUacValue__endswith": {
                "field": "OldUacValue",
                "value": [
                  "1????",
                  "3????",
                  "5????",
                  "7????",
                  "9????",
                  "B????",
                  "D????",
                  "F????"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "newuac_preauth": {
            "type": "field_match",
            "matchers": {
              "NewUacValue__endswith": {
                "field": "NewUacValue",
                "value": [
                  "1????",
                  "3????",
                  "5????",
                  "7????",
                  "9????",
                  "B????",
                  "D????",
                  "F????"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "olduac_encrypted": {
            "type": "field_match",
            "matchers": {
              "OldUacValue__endswith": {
                "field": "OldUacValue",
                "value": [
                  "8??",
                  "9??",
                  "A??",
                  "B??",
                  "C??",
                  "D??",
                  "E??",
                  "F??"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "newuac_encrypted": {
            "type": "field_match",
            "matchers": {
              "NewUacValue__endswith": {
                "field": "NewUacValue",
                "value": [
                  "8??",
                  "9??",
                  "A??",
                  "B??",
                  "C??",
                  "D??",
                  "E??",
                  "F??"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection and ((newuac_des and not olduac_des) or (newuac_preauth and not olduac_preauth) or (newuac_encrypted and not olduac_encrypted))",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection and ((newuac_des and not olduac_des)",
            "(newuac_preauth and not olduac_preauth)",
            "(newuac_encrypted and not olduac_encrypted))"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "@neu5ron",
        "date": "2017-07-30",
        "modified": "2021-11-27",
        "references": [
          "https://adsecurity.org/?p=2053",
          "https://blog.harmj0y.net/redteaming/another-word-on-delegation/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_alert_enable_weak_encryption.yml"
      }
    },
    {
      "id": "6daac7fc-77d1-449a-a71a-e6b4d59a0e54",
      "title": "User Couldn't Call a Privileged Service 'LsaRegisterLogonProcess'",
      "status": "test",
      "description": "The 'LsaRegisterLogonProcess' function verifies that the application making the function call is a logon process by checking that it has the SeTcbPrivilege privilege set. Possible Rubeus tries to get a handle to LSA.",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.lateral-movement",
        "attack.privilege-escalation",
        "attack.t1558.003"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4673,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Service": {
                "field": "Service",
                "value": "LsaRegisterLogonProcess()",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Keywords": {
                "field": "Keywords",
                "value": "0x8010000000000000",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1558.003"
        ],
        "tactics": [
          "credential_access",
          "lateral_movement",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez (source), Ilyas Ochkov (rule), oscd.community",
        "date": "2019-10-24",
        "modified": "2022-12-25",
        "references": [
          "https://posts.specterops.io/hunting-in-active-directory-unconstrained-delegation-forests-trusts-71f2b33688e1"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_user_couldnt_call_priv_service_lsaregisterlogonprocess.yml"
      }
    },
    {
      "id": "1d2ab8ac-1a01-423b-9c39-001510eae8e8",
      "title": "Azure AD Health Service Agents Registry Keys Access",
      "status": "test",
      "description": "This detection uses Windows security events to detect suspicious access attempts to the registry key values and sub-keys of Azure AD Health service agents (e.g AD FS).\nInformation from AD Health service agents can be used to potentially abuse some of the features provided by those services in the cloud (e.g. Federation).\nThis detection requires an access control entry (ACE) on the system access control list (SACL) of the following securable object: HKLM:\\SOFTWARE\\Microsoft\\ADHealthAgent.\nMake sure you set the SACL to propagate to its sub-keys.\n",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.t1012"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": [
                  4656,
                  4663
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "ObjectType": {
                "field": "ObjectType",
                "value": "Key",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectName": {
                "field": "ObjectName",
                "value": "\\REGISTRY\\MACHINE\\SOFTWARE\\Microsoft\\ADHealthAgent",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "ProcessName__contains": {
                "field": "ProcessName",
                "value": [
                  "Microsoft.Identity.Health.Adfs.DiagnosticsAgent.exe",
                  "Microsoft.Identity.Health.Adfs.InsightsService.exe",
                  "Microsoft.Identity.Health.Adfs.MonitoringAgent.Startup.exe",
                  "Microsoft.Identity.Health.Adfs.PshSurrogate.exe",
                  "Microsoft.Identity.Health.Common.Clients.ResourceMonitor.exe"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1012"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research), MSTIC",
        "date": "2021-08-26",
        "modified": "2022-10-09",
        "references": [
          "https://o365blog.com/post/hybridhealthagent/",
          "https://github.com/OTRF/Set-AuditRule/blob/c3dec5443414231714d850565d364ca73475ade5/rules/registry/aad_connect_health_service_agent.yml"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_aadhealth_svc_agent_regkey_access.yml"
      }
    },
    {
      "id": "7b14c76a-c602-4ae6-9717-eff868153fc0",
      "title": "HackTool - NoFilter Execution",
      "status": "test",
      "description": "Detects execution of NoFilter, a tool for abusing the Windows Filtering Platform for privilege escalation via hardcoded policy name indicators\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1134",
        "attack.t1134.001"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection_5447": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 5447,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "FilterName__contains": {
                "field": "FilterName",
                "value": "RonPolicy",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_5449": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 5449,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ProviderContextName__contains": {
                "field": "ProviderContextName",
                "value": "RonPolicy",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1134",
          "T1134.001"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Stamatis Chatzimangou (st0pp3r)",
        "date": "2024-01-05",
        "modified": "",
        "references": [
          "https://github.com/deepinstinct/NoFilter/blob/121d215ab130c5e8e3ad45a7e7fcd56f4de97b4d/NoFilter/Consts.cpp",
          "https://github.com/deepinstinct/NoFilter",
          "https://www.deepinstinct.com/blog/nofilter-abusing-windows-filtering-platform-for-privilege-escalation",
          "https://x.com/_st0pp3r_/status/1742203752361128162?s=20"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_hktl_nofilter.yml"
      }
    },
    {
      "id": "98054878-5eab-434c-85d4-72d4e5a3361b",
      "title": "HackTool - EDRSilencer Execution - Filter Added",
      "status": "test",
      "description": "Detects execution of EDRSilencer, a tool that abuses the Windows Filtering Platform (WFP) to block the outbound traffic of running EDR agents based on specific hardcoded filter names.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": [
                  5441,
                  5447
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "FilterName__contains": {
                "field": "FilterName",
                "value": "Custom Outbound Filter",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Thodoris Polyzos (@SmoothDeploy)",
        "date": "2024-01-29",
        "modified": "2024-01-30",
        "references": [
          "https://github.com/netero1010/EDRSilencer"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_hktl_edr_silencer.yml"
      }
    },
    {
      "id": "910ab938-668b-401b-b08c-b596e80fdca5",
      "title": "Transferring Files with Credential Data via Network Shares",
      "status": "test",
      "description": "Transferring files with well-known filenames (sensitive files with credential data) using network shares",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.t1003.002",
        "attack.t1003.001",
        "attack.t1003.003"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection_eid": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 5145,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_object": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "RelativeTargetName__contains": {
                    "field": "RelativeTargetName",
                    "value": [
                      "\\mimidrv",
                      "\\lsass",
                      "\\windows\\minidump\\",
                      "\\hiberfil",
                      "\\sqldmpr"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "RelativeTargetName": {
                    "field": "RelativeTargetName",
                    "value": [
                      "Windows\\NTDS\\ntds.dit",
                      "Windows\\System32\\config\\SAM",
                      "Windows\\System32\\config\\SECURITY",
                      "Windows\\System32\\config\\SYSTEM"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.002",
          "T1003.001",
          "T1003.003"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Teymur Kheirkhabarov, oscd.community",
        "date": "2019-10-22",
        "modified": "2025-07-11",
        "references": [
          "https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment"
        ],
        "falsepositives": [
          "Transferring sensitive files for legitimate administration work by legitimate administrator"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_transf_files_with_cred_data_via_network_shares.yml"
      }
    },
    {
      "id": "5bed80b6-b3e8-428e-a3ae-d3c757589e41",
      "title": "RDP over Reverse SSH Tunnel WFP",
      "status": "test",
      "description": "Detects svchost hosting RDP termsvcs communicating with the loopback address",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.command-and-control",
        "attack.lateral-movement",
        "attack.t1090.001",
        "attack.t1090.002",
        "attack.t1021.001",
        "car.2013-07-002"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 5156,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "sourceRDP": {
            "type": "field_match",
            "matchers": {
              "SourcePort": {
                "field": "SourcePort",
                "value": 3389,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "DestAddress": {
                "field": "DestAddress",
                "value": [
                  "127.*",
                  "::1"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "destinationRDP": {
            "type": "field_match",
            "matchers": {
              "DestPort": {
                "field": "DestPort",
                "value": 3389,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "SourceAddress": {
                "field": "SourceAddress",
                "value": [
                  "127.*",
                  "::1"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_app_container": {
            "type": "field_match",
            "matchers": {
              "FilterOrigin": {
                "field": "FilterOrigin",
                "value": "AppContainer Loopback",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_thor": {
            "type": "field_match",
            "matchers": {
              "Application__endswith": {
                "field": "Application",
                "value": [
                  "\\thor.exe",
                  "\\thor64.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and ( sourceRDP or destinationRDP ) and not 1 of filter*",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection and ( sourceRDP",
            "destinationRDP ) and not 1 of filter*"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1090.001",
          "T1090.002",
          "T1021.001"
        ],
        "tactics": [
          "defense_evasion",
          "command_and_control",
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Samir Bousseaden",
        "date": "2019-02-16",
        "modified": "2022-09-02",
        "references": [
          "https://twitter.com/SBousseaden/status/1096148422984384514",
          "https://github.com/sbousseaden/EVTX-ATTACK-SAMPLES/blob/44fbe85f72ee91582876b49678f9a26292a155fb/Command%20and%20Control/DE_RDP_Tunnel_5156.evtx"
        ],
        "falsepositives": [
          "Programs that connect locally to the RDP port"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_rdp_reverse_tunnel.yml"
      }
    },
    {
      "id": "53ad8e36-f573-46bf-97e4-15ba5bf4bb51",
      "title": "Password Change on Directory Service Restore Mode (DSRM) Account",
      "status": "stable",
      "description": "Detects potential attempts made to set the Directory Services Restore Mode administrator password.\nThe Directory Service Restore Mode (DSRM) account is a local administrator account on Domain Controllers.\nAttackers may change the password in order to obtain persistence.\n",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1098"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4794,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1098"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Thomas Patzke",
        "date": "2017-02-19",
        "modified": "2020-08-23",
        "references": [
          "https://adsecurity.org/?p=1714",
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4794"
        ],
        "falsepositives": [
          "Initial installation of a domain controller."
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_susp_dsrm_password_change.yml"
      }
    },
    {
      "id": "dae8171c-5ec6-4396-b210-8466585b53e9",
      "title": "SCM Database Privileged Operation",
      "status": "test",
      "description": "Detects non-system users performing privileged operation os the SCM database",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4674,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectType": {
                "field": "ObjectType",
                "value": "SC_MANAGER OBJECT",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectName": {
                "field": "ObjectName",
                "value": "servicesactive",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "PrivilegeList": {
                "field": "PrivilegeList",
                "value": "SeTakeOwnershipPrivilege",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "SubjectLogonId": {
                "field": "SubjectLogonId",
                "value": "0x3e4",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ProcessName__endswith": {
                "field": "ProcessName",
                "value": ":\\Windows\\System32\\services.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1548"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez @Cyb3rWard0g, Tim Shelton",
        "date": "2019-08-15",
        "modified": "2022-09-18",
        "references": [
          "https://threathunterplaybook.com/hunts/windows/190826-RemoteSCMHandle/notebook.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_scm_database_privileged_operation.yml"
      }
    },
    {
      "id": "252902e3-5830-4cf6-bf21-c22083dfd5cf",
      "title": "Possible Impacket SecretDump Remote Activity",
      "status": "test",
      "description": "Detect AD credential dumping using impacket secretdump HKTL",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003.002",
        "attack.t1003.004",
        "attack.t1003.003"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 5145,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ShareName": {
                "field": "ShareName",
                "value": "\\\\\\\\\\*\\\\ADMIN$",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "RelativeTargetName__contains_all": {
                "field": "RelativeTargetName",
                "value": [
                  "SYSTEM32\\",
                  ".tmp"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.002",
          "T1003.004",
          "T1003.003"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Samir Bousseaden, wagga",
        "date": "2019-04-03",
        "modified": "2022-08-11",
        "references": [
          "https://web.archive.org/web/20230329153811/https://blog.menasec.net/2019/02/threat-huting-10-impacketsecretdump.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_impacket_secretdump.yml"
      }
    },
    {
      "id": "962fe167-e48d-4fd6-9974-11e5b9a5d6d1",
      "title": "LSASS Access From Non System Account",
      "status": "test",
      "description": "Detects potential mimikatz-like tools accessing LSASS from non system account",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.t1003.001"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": [
                  4663,
                  4656
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "AccessMask": {
                "field": "AccessMask",
                "value": [
                  "0x100000",
                  "0x1010",
                  "0x1400",
                  "0x1410",
                  "0x1418",
                  "0x1438",
                  "0x143a",
                  "0x1f0fff",
                  "0x1f1fff",
                  "0x1f2fff",
                  "0x1f3fff",
                  "0x40",
                  "143a",
                  "1f0fff",
                  "1f1fff",
                  "1f2fff",
                  "1f3fff"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "ObjectType": {
                "field": "ObjectType",
                "value": "Process",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectName__endswith": {
                "field": "ObjectName",
                "value": "\\lsass.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_service_account": {
            "type": "field_match",
            "matchers": {
              "SubjectUserName__endswith": {
                "field": "SubjectUserName",
                "value": "$",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_generic": {
            "type": "field_match",
            "matchers": {
              "ProcessName__contains": {
                "field": "ProcessName",
                "value": [
                  ":\\Program Files\\",
                  ":\\Program Files (x86)\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_wmiprvse": {
            "type": "field_match",
            "matchers": {
              "ProcessName": {
                "field": "ProcessName",
                "value": "C:\\Windows\\System32\\wbem\\WmiPrvSE.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "AccessMask": {
                "field": "AccessMask",
                "value": "0x1410",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_steam": {
            "type": "field_match",
            "matchers": {
              "ProcessName__contains": {
                "field": "ProcessName",
                "value": "\\SteamLibrary\\steamapps\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1003.001"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez @Cyb3rWard0g",
        "date": "2019-06-20",
        "modified": "2023-12-11",
        "references": [
          "https://threathunterplaybook.com/hunts/windows/170105-LSASSMemoryReadAccess/notebook.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_lsass_access_non_system_account.yml"
      }
    },
    {
      "id": "c9eb55c3-b468-40ab-9089-db2862e42137",
      "title": "Device Installation Blocked",
      "status": "test",
      "description": "Detects an installation of a device that is forbidden by the system policy",
      "level": "medium",
      "tags": [
        "attack.initial-access",
        "attack.t1200"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 6423,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1200"
        ],
        "tactics": [
          "initial_access"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-10-14",
        "modified": "",
        "references": [
          "https://github.com/Yamato-Security/EnableWindowsLogSettings/blob/7f6d755d45ac7cc9fc35b0cbf498e6aa4ef19def/ConfiguringSecurityLogAuditPolicies.md",
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-6423"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_device_installation_blocked.yml"
      }
    },
    {
      "id": "91c945bc-2ad1-4799-a591-4d00198a1215",
      "title": "Suspicious Access to Sensitive File Extensions",
      "status": "test",
      "description": "Detects known sensitive file extensions accessed on a network share",
      "level": "medium",
      "tags": [
        "attack.collection",
        "attack.t1039"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 5145,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "RelativeTargetName__endswith": {
                "field": "RelativeTargetName",
                "value": [
                  ".bak",
                  ".dmp",
                  ".edb",
                  ".kirbi",
                  ".msg",
                  ".nsf",
                  ".nst",
                  ".oab",
                  ".ost",
                  ".pst",
                  ".rdp"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1039"
        ],
        "tactics": [
          "collection"
        ]
      },
      "meta": {
        "author": "Samir Bousseaden",
        "date": "2019-04-03",
        "modified": "2025-10-17",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Help Desk operator doing backup or re-imaging end user machine or backup software",
          "Users working with these data types or exchanging message files"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_susp_raccess_sensitive_fext.yml"
      }
    },
    {
      "id": "311b6ce2-7890-4383-a8c2-663a9f6b43cd",
      "title": "Enabled User Right in AD to Control User Objects",
      "status": "test",
      "description": "Detects scenario where if a user is assigned the SeEnableDelegationPrivilege right in Active Directory it would allow control of other AD user objects.",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1098"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection_base": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4704,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_keywords": {
            "type": "field_match",
            "matchers": {
              "PrivilegeList__contains": {
                "field": "PrivilegeList",
                "value": "SeEnableDelegationPrivilege",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1098"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "@neu5ron",
        "date": "2017-07-30",
        "modified": "2021-12-02",
        "references": [
          "https://blog.harmj0y.net/activedirectory/the-most-dangerous-user-right-you-probably-have-never-heard-of/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_alert_active_directory_user_control.yml"
      }
    },
    {
      "id": "1a0a2ff1-611b-4dac-8216-8a7b47c618a6",
      "title": "Invoke-Obfuscation Via Use Clip - Security",
      "status": "test",
      "description": "Detects Obfuscated Powershell via use Clip.exe in Scripts",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027",
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4697,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ServiceFileName__contains": {
                "field": "ServiceFileName",
                "value": "(Clipboard|i",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1027",
          "T1059.001"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Nikita Nazarov, oscd.community",
        "date": "2020-10-09",
        "modified": "2022-11-29",
        "references": [
          "https://github.com/SigmaHQ/sigma/issues/1009"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_invoke_obfuscation_via_use_clip_services_security.yml"
      }
    },
    {
      "id": "32e19d25-4aed-4860-a55a-be99cb0bf7ed",
      "title": "Possible DC Shadow Attack",
      "status": "test",
      "description": "Detects DCShadow via create new SPN",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.defense-evasion",
        "attack.t1207"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection1": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4742,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ServicePrincipalNames__contains": {
                "field": "ServicePrincipalNames",
                "value": "GC/",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection2": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 5136,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "AttributeLDAPDisplayName": {
                "field": "AttributeLDAPDisplayName",
                "value": "servicePrincipalName",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "AttributeValue__startswith": {
                "field": "AttributeValue",
                "value": "GC/",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1207"
        ],
        "tactics": [
          "credential_access",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Ilyas Ochkov, oscd.community, Chakib Gzenayi (@Chak092), Hosni Mribah",
        "date": "2019-10-25",
        "modified": "2022-10-17",
        "references": [
          "https://twitter.com/gentilkiwi/status/1003236624925413376",
          "https://gist.github.com/gentilkiwi/dcc132457408cf11ad2061340dcb53c2",
          "https://web.archive.org/web/20180203014709/https://blog.alsid.eu/dcshadow-explained-4510f52fc19d?gi=c426ac876c48"
        ],
        "falsepositives": [
          "Valid on domain controllers; exclude known DCs"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_possible_dc_shadow.yml"
      }
    },
    {
      "id": "eca91c7c-9214-47b9-b4c5-cb1d7e4f2350",
      "title": "Uncommon Outbound Kerberos Connection - Security",
      "status": "test",
      "description": "Detects uncommon outbound network activity via Kerberos default port indicating possible lateral movement or first stage PrivEsc via delegation.\n",
      "level": "medium",
      "tags": [
        "attack.lateral-movement",
        "attack.credential-access",
        "attack.t1558.003"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 5156,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "DestPort": {
                "field": "DestPort",
                "value": 88,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_lsass": {
            "type": "field_match",
            "matchers": {
              "Application__startswith": {
                "field": "Application",
                "value": [
                  "\\device\\harddiskvolume",
                  "C:"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Application__endswith": {
                "field": "Application",
                "value": "\\Windows\\System32\\lsass.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_chrome": {
            "type": "field_match",
            "matchers": {
              "Application__startswith": {
                "field": "Application",
                "value": [
                  "\\device\\harddiskvolume",
                  "C:"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Application__endswith": {
                "field": "Application",
                "value": [
                  "\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe",
                  "\\Program Files\\Google\\Chrome\\Application\\chrome.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_firefox": {
            "type": "field_match",
            "matchers": {
              "Application__startswith": {
                "field": "Application",
                "value": [
                  "\\device\\harddiskvolume",
                  "C:"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Application__endswith": {
                "field": "Application",
                "value": [
                  "\\Program Files (x86)\\Mozilla Firefox\\firefox.exe",
                  "\\Program Files\\Mozilla Firefox\\firefox.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_tomcat": {
            "type": "field_match",
            "matchers": {
              "Application__endswith": {
                "field": "Application",
                "value": "\\tomcat\\bin\\tomcat8.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1558.003"
        ],
        "tactics": [
          "lateral_movement",
          "credential_access"
        ]
      },
      "meta": {
        "author": "Ilyas Ochkov, oscd.community",
        "date": "2019-10-24",
        "modified": "2024-03-15",
        "references": [
          "https://github.com/GhostPack/Rubeus"
        ],
        "falsepositives": [
          "Web Browsers and third party application might generate similar activity. An initial baseline is required."
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_susp_outbound_kerberos_connection.yml"
      }
    },
    {
      "id": "6a53d871-682d-40b6-83e0-b7c1a6c4e3a5",
      "title": "PetitPotam Suspicious Kerberos TGT Request",
      "status": "test",
      "description": "Detect suspicious Kerberos TGT requests.\nOnce an attacer obtains a computer certificate by abusing Active Directory Certificate Services in combination with PetitPotam, the next step would be to leverage the certificate for malicious purposes.\nOne way of doing this is to request a Kerberos Ticket Granting Ticket using a tool like Rubeus.\nThis request will generate a 4768 event with some unusual fields depending on the environment.\nThis analytic will require tuning, we recommend filtering Account_Name to the Domain Controller computer accounts.\n",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1187"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4768,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetUserName__endswith": {
                "field": "TargetUserName",
                "value": "$",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CertThumbprint__contains": {
                "field": "CertThumbprint",
                "value": "*",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_local": {
            "type": "field_match",
            "matchers": {
              "IpAddress": {
                "field": "IpAddress",
                "value": "::1",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_thumbprint": {
            "type": "field_match",
            "matchers": {
              "CertThumbprint": {
                "field": "CertThumbprint",
                "value": "",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1187"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Mauricio Velazco, Michael Haag",
        "date": "2021-09-02",
        "modified": "2022-10-05",
        "references": [
          "https://github.com/topotam/PetitPotam",
          "https://isc.sans.edu/forums/diary/Active+Directory+Certificate+Services+ADCS+PKI+domain+admin+vulnerability/27668/",
          "https://github.com/splunk/security_content/blob/88d689fe8a055d8284337b9fad5d9152b42043db/detections/endpoint/petitpotam_suspicious_kerberos_tgt_request.yml"
        ],
        "falsepositives": [
          "False positives are possible if the environment is using certificates for authentication. We recommend filtering Account_Name to the Domain Controller computer accounts."
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_petitpotam_susp_tgt_request.yml"
      }
    },
    {
      "id": "098d7118-55bc-4912-a836-dc6483a8d150",
      "title": "Access To ADMIN$ Network Share",
      "status": "test",
      "description": "Detects access to ADMIN$ network share",
      "level": "low",
      "tags": [
        "attack.lateral-movement",
        "attack.t1021.002"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 5140,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ShareName": {
                "field": "ShareName",
                "value": "Admin$",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_computer_account": {
            "type": "field_match",
            "matchers": {
              "SubjectUserName__endswith": {
                "field": "SubjectUserName",
                "value": "$",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1021.002"
        ],
        "tactics": [
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2017-03-04",
        "modified": "2024-01-16",
        "references": [
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-5140"
        ],
        "falsepositives": [
          "Legitimate administrative activity"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_admin_share_access.yml"
      }
    },
    {
      "id": "7b687634-ab20-11ea-bb37-0242ac130002",
      "title": "Windows Pcap Drivers",
      "status": "test",
      "description": "Detects Windows Pcap driver installation based on a list of associated .sys files.",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.credential-access",
        "attack.t1040"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4697,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ServiceFileName__contains": {
                "field": "ServiceFileName",
                "value": [
                  "pcap",
                  "npcap",
                  "npf",
                  "nm3",
                  "ndiscap",
                  "nmnt",
                  "windivert",
                  "USBPcap",
                  "pktmon"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1040"
        ],
        "tactics": [
          "discovery",
          "credential_access"
        ]
      },
      "meta": {
        "author": "Cian Heasley",
        "date": "2020-06-10",
        "modified": "2023-04-14",
        "references": [
          "https://ragged-lab.blogspot.com/2020/06/capturing-pcap-driver-installations.html#more"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_pcap_drivers.yml"
      }
    },
    {
      "id": "3e2f1b2c-4d5e-11ee-be56-0242ac120002",
      "title": "Potential AS-REP Roasting via Kerberos TGT Requests",
      "status": "experimental",
      "description": "Detects suspicious Kerberos TGT requests with pre-authentication disabled (Pre-Authentication Type = 0) and Ticket Encryption Type (0x17) i.e, RC4-HMAC.\nThis may indicate an AS-REP Roasting attack, where attackers request AS-REP messages for accounts without pre-authentication and attempt to crack the encrypted ticket offline to recover user passwords.\n",
      "level": "medium",
      "tags": [],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4768,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TicketEncryptionType": {
                "field": "TicketEncryptionType",
                "value": "0x17",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ServiceName": {
                "field": "ServiceName",
                "value": "krbtgt",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "PreAuthType": {
                "field": "PreAuthType",
                "value": 0,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": []
      },
      "meta": {
        "author": "ANosir",
        "date": "2025-05-22",
        "modified": "2025-07-04",
        "references": [
          "https://medium.com/system-weakness/detecting-as-rep-roasting-attacks-b5b3965f9714",
          "https://www.picussecurity.com/resource/blog/as-rep-roasting-attack-explained-mitre-attack-t1558.004"
        ],
        "falsepositives": [
          "Legacy systems or applications that legitimately use RC4 encryption",
          "Misconfigured accounts with pre-authentication disabled"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_kerberos_asrep_roasting.yml"
      }
    },
    {
      "id": "39a94fd1-8c9a-4ff6-bf22-c058762f8014",
      "title": "DPAPI Domain Master Key Backup Attempt",
      "status": "test",
      "description": "Detects anyone attempting a backup for the DPAPI Master Key. This events gets generated at the source and not the Domain Controller.",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.t1003.004"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4692,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.004"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez @Cyb3rWard0g",
        "date": "2019-08-10",
        "modified": "2023-03-15",
        "references": [
          "https://threathunterplaybook.com/hunts/windows/190620-DomainDPAPIBackupKeyExtraction/notebook.html"
        ],
        "falsepositives": [
          "If a computer is a member of a domain, DPAPI has a backup mechanism to allow unprotection of the data. Which will trigger this event."
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_dpapi_domain_masterkey_backup_attempt.yml"
      }
    },
    {
      "id": "f241cf1b-3a6b-4e1a-b4f9-133c00dd95ca",
      "title": "Invoke-Obfuscation RUNDLL LAUNCHER - Security",
      "status": "test",
      "description": "Detects Obfuscated Powershell via RUNDLL LAUNCHER",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027",
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4697,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ServiceFileName__contains_all": {
                "field": "ServiceFileName",
                "value": [
                  "rundll32.exe",
                  "shell32.dll",
                  "shellexec_rundll",
                  "powershell"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1027",
          "T1059.001"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Timur Zinniatullin, oscd.community",
        "date": "2020-10-18",
        "modified": "2022-11-29",
        "references": [
          "https://github.com/SigmaHQ/sigma/issues/1009"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_invoke_obfuscation_via_rundll_services_security.yml"
      }
    },
    {
      "id": "614cf376-6651-47c4-9dcc-6b9527f749f4",
      "title": "Suspicious Scheduled Task Update",
      "status": "test",
      "description": "Detects update to a scheduled task event that contain suspicious keywords.",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1053.005"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection_eid": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4702,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_paths": {
            "type": "field_match",
            "matchers": {
              "TaskContentNew__contains": {
                "field": "TaskContentNew",
                "value": [
                  "\\AppData\\Local\\Temp\\",
                  "\\AppData\\Roaming\\",
                  "\\Users\\Public\\",
                  "\\WINDOWS\\Temp\\",
                  "C:\\Temp\\",
                  "\\Desktop\\",
                  "\\Downloads\\",
                  "\\Temporary Internet",
                  "C:\\ProgramData\\",
                  "C:\\Perflogs\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_commands": {
            "type": "field_match",
            "matchers": {
              "TaskContentNew__contains": {
                "field": "TaskContentNew",
                "value": [
                  "regsvr32",
                  "rundll32",
                  "cmd.exe</Command>",
                  "cmd</Command>",
                  "<Arguments>/c ",
                  "<Arguments>/k ",
                  "<Arguments>/r ",
                  "powershell",
                  "pwsh",
                  "mshta",
                  "wscript",
                  "cscript",
                  "certutil",
                  "bitsadmin",
                  "bash.exe",
                  "bash ",
                  "scrcons",
                  "wmic ",
                  "wmic.exe",
                  "forfiles",
                  "scriptrunner",
                  "hh.exe"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1053.005"
        ],
        "tactics": [
          "execution",
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-12-05",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4698"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_susp_scheduled_task_update.yml"
      }
    },
    {
      "id": "7595ba94-cf3b-4471-aa03-4f6baa9e5fad",
      "title": "Important Scheduled Task Deleted/Disabled",
      "status": "test",
      "description": "Detects when adversaries stop services or processes by deleting or disabling their respective scheduled tasks in order to conduct data destructive activities",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1053.005"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": [
                  4699,
                  4701
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "TaskName__contains": {
                "field": "TaskName",
                "value": [
                  "\\Windows\\SystemRestore\\SR",
                  "\\Windows\\Windows Defender\\",
                  "\\Windows\\BitLocker",
                  "\\Windows\\WindowsBackup\\",
                  "\\Windows\\WindowsUpdate\\",
                  "\\Windows\\UpdateOrchestrator\\Schedule",
                  "\\Windows\\ExploitGuard"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_sys_username": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4699,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "SubjectUserName__endswith": {
                "field": "SubjectUserName",
                "value": "$",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TaskName__contains": {
                "field": "TaskName",
                "value": "\\Windows\\Windows Defender\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1053.005"
        ],
        "tactics": [
          "execution",
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-12-05",
        "modified": "2023-03-13",
        "references": [
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4699",
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4701"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_susp_scheduled_task_delete_or_disable.yml"
      }
    },
    {
      "id": "ab6bffca-beff-4baa-af11-6733f296d57a",
      "title": "Potential AD User Enumeration From Non-Machine Account",
      "status": "test",
      "description": "Detects read access to a domain user from a non-machine account",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.t1087.002"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4662,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectType__contains": {
                "field": "ObjectType",
                "value": "bf967aba-0de6-11d0-a285-00aa003049e2",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "AccessMask__endswith": {
                "field": "AccessMask",
                "value": [
                  "1?",
                  "3?",
                  "4?",
                  "7?",
                  "9?",
                  "B?",
                  "D?",
                  "F?"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_machine_accounts": {
            "type": "field_match",
            "matchers": {
              "SubjectUserName__endswith": {
                "field": "SubjectUserName",
                "value": "$",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_msql": {
            "type": "field_match",
            "matchers": {
              "SubjectUserName__startswith": {
                "field": "SubjectUserName",
                "value": "MSOL_",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1087.002"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Maxime Thiebaut (@0xThiebaut)",
        "date": "2020-03-30",
        "modified": "2022-11-08",
        "references": [
          "https://www.specterops.io/assets/resources/an_ace_up_the_sleeve.pdf",
          "http://www.stuffithoughtiknew.com/2019/02/detecting-bloodhound.html",
          "https://learn.microsoft.com/en-us/windows/win32/adschema/attributes-all",
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4662"
        ],
        "falsepositives": [
          "Administrators configuring new users."
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_ad_user_enumeration.yml"
      }
    },
    {
      "id": "9b8d9203-4e0f-4cd9-bb06-4cc4ea6d0e9a",
      "title": "Invoke-Obfuscation Via Use MSHTA - Security",
      "status": "test",
      "description": "Detects Obfuscated Powershell via use MSHTA in Scripts",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027",
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4697,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ServiceFileName__contains_all": {
                "field": "ServiceFileName",
                "value": [
                  "mshta",
                  "vbscript:createobject",
                  ".run",
                  "window.close"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1027",
          "T1059.001"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Nikita Nazarov, oscd.community",
        "date": "2020-10-09",
        "modified": "2022-11-29",
        "references": [
          "https://github.com/SigmaHQ/sigma/issues/1009"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_invoke_obfuscation_via_use_mshta_services_security.yml"
      }
    },
    {
      "id": "d7a95147-145f-4678-b85d-d1ff4a3bb3f6",
      "title": "CobaltStrike Service Installations - Security",
      "status": "test",
      "description": "Detects known malicious service installs that appear in cases in which a Cobalt Strike beacon elevates privileges or lateral movement",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.execution",
        "attack.privilege-escalation",
        "attack.lateral-movement",
        "attack.t1021.002",
        "attack.t1543.003",
        "attack.t1569.002"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "event_id": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4697,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection1": {
            "type": "field_match",
            "matchers": {
              "ServiceFileName__contains_all": {
                "field": "ServiceFileName",
                "value": [
                  "ADMIN$",
                  ".exe"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection2": {
            "type": "field_match",
            "matchers": {
              "ServiceFileName__contains_all": {
                "field": "ServiceFileName",
                "value": [
                  "%COMSPEC%",
                  "start",
                  "powershell"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection3": {
            "type": "field_match",
            "matchers": {
              "ServiceFileName__contains": {
                "field": "ServiceFileName",
                "value": "powershell -nop -w hidden -encodedcommand",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection4": {
            "type": "field_match",
            "matchers": {
              "ServiceFileName__base64offset_contains": {
                "field": "ServiceFileName",
                "value": "IEX (New-Object Net.Webclient).DownloadString('http://127.0.0.1:",
                "modifiers": [
                  "base64offset",
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "event_id and 1 of selection*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "event_id"
            },
            {
              "type": "ref",
              "value": "1 of selection*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1021.002",
          "T1543.003",
          "T1569.002"
        ],
        "tactics": [
          "persistence",
          "execution",
          "privilege_escalation",
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Wojciech Lesicki",
        "date": "2021-05-26",
        "modified": "2022-11-27",
        "references": [
          "https://www.sans.org/webcasts/119395",
          "https://www.crowdstrike.com/blog/getting-the-bacon-from-cobalt-strike-beacon/",
          "https://thedfirreport.com/2021/08/29/cobalt-strike-a-defenders-guide/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_cobaltstrike_service_installs.yml"
      }
    },
    {
      "id": "18beca67-ab3e-4ee3-ba7a-a46ca8d7d0cc",
      "title": "Sysmon Channel Reference Deletion",
      "status": "test",
      "description": "Potential threat actor tampering with Sysmon manifest and eventually disabling it",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection1": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4657,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectName__contains": {
                "field": "ObjectName",
                "value": [
                  "WINEVT\\Publishers\\{5770385f-c22a-43e0-bf4c-06f5698ffbd9}",
                  "WINEVT\\Channels\\Microsoft-Windows-Sysmon/Operational"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "ObjectValueName": {
                "field": "ObjectValueName",
                "value": "Enabled",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "NewValue": {
                "field": "NewValue",
                "value": 0,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection2": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4663,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ObjectName__contains": {
                "field": "ObjectName",
                "value": [
                  "WINEVT\\Publishers\\{5770385f-c22a-43e0-bf4c-06f5698ffbd9}",
                  "WINEVT\\Channels\\Microsoft-Windows-Sysmon/Operational"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "AccessMask": {
                "field": "AccessMask",
                "value": "0x10000",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
        "date": "2020-07-14",
        "modified": "2025-10-22",
        "references": [
          "https://twitter.com/Flangvik/status/1283054508084473861",
          "https://twitter.com/SecurityJosh/status/1283027365770276866",
          "https://securityjosh.github.io/2020/04/23/Mute-Sysmon.html",
          "https://gist.github.com/Cyb3rWard0g/cf08c38c61f7e46e8404b38201ca01c8"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/win_security_sysmon_channel_reference_deletion.yml"
      }
    },
    {
      "id": "749c9f5e-b353-4b90-a9c1-05243357ca4b",
      "title": "Potential Privilege Escalation via Local Kerberos Relay over LDAP",
      "status": "test",
      "description": "Detects a suspicious local successful logon event where the Logon Package is Kerberos, the remote address is set to localhost, and the target user SID is the built-in local Administrator account.\nThis may indicate an attempt to leverage a Kerberos relay attack variant that can be used to elevate privilege locally from a domain joined limited user to local System privileges.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.credential-access",
        "attack.t1548"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4624,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "LogonType": {
                "field": "LogonType",
                "value": 3,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "AuthenticationPackageName": {
                "field": "AuthenticationPackageName",
                "value": "Kerberos",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "IpAddress": {
                "field": "IpAddress",
                "value": "127.0.0.1",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetUserSid__startswith": {
                "field": "TargetUserSid",
                "value": "S-1-5-21-",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetUserSid__endswith": {
                "field": "TargetUserSid",
                "value": "-500",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_ip_null": {
            "type": "field_match",
            "matchers": {
              "IpPort": {
                "field": "IpPort",
                "value": "0",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1548"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation",
          "credential_access"
        ]
      },
      "meta": {
        "author": "Elastic, @SBousseaden",
        "date": "2022-04-27",
        "modified": "2024-08-13",
        "references": [
          "https://twitter.com/sbousseaden/status/1518976397364056071?s=12&t=qKO5eKHvWhAP19a50FTZ7g",
          "https://github.com/elastic/detection-rules/blob/5fe7833312031a4787e07893e27e4ea7a7665745/rules/_deprecated/privilege_escalation_krbrelayup_suspicious_logon.toml#L38"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/account_management/win_security_susp_privesc_kerberos_relay_over_ldap.yml"
      }
    },
    {
      "id": "2111118f-7e46-4fc8-974a-59fd8ec95196",
      "title": "DiagTrackEoP Default Login Username",
      "status": "test",
      "description": "Detects the default \"UserName\" used by the DiagTrackEoP POC",
      "level": "critical",
      "tags": [
        "attack.privilege-escalation"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4624,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "LogonType": {
                "field": "LogonType",
                "value": 9,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetOutboundUserName": {
                "field": "TargetOutboundUserName",
                "value": "thisisnotvaliduser",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-03",
        "modified": "",
        "references": [
          "https://github.com/Wh04m1001/DiagTrackEoP/blob/3a2fc99c9700623eb7dc7d4b5f314fd9ce5ef51f/main.cpp#L46"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/builtin/security/account_management/win_security_diagtrack_eop_default_login_username.yml"
      }
    },
    {
      "id": "51e33403-2a37-4d66-a574-1fda1782cc31",
      "title": "RDP Login from Localhost",
      "status": "test",
      "description": "RDP login with localhost source address may be a tunnelled login",
      "level": "high",
      "tags": [
        "attack.lateral-movement",
        "car.2013-07-002",
        "attack.t1021.001"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4624,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "LogonType": {
                "field": "LogonType",
                "value": 10,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "IpAddress": {
                "field": "IpAddress",
                "value": [
                  "::1",
                  "127.0.0.1"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1021.001"
        ],
        "tactics": [
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Thomas Patzke",
        "date": "2019-01-28",
        "modified": "2022-10-09",
        "references": [
          "https://www.fireeye.com/blog/threat-research/2019/01/bypassing-network-restrictions-through-rdp-tunneling.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/account_management/win_security_rdp_localhost_login.yml"
      }
    },
    {
      "id": "b237c54b-0f15-4612-a819-44b735e0de27",
      "title": "A Security-Enabled Global Group Was Deleted",
      "status": "stable",
      "description": "Detects activity when a security-enabled global group is deleted",
      "level": "low",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1098"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": [
                  4730,
                  634
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1098"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Alexandr Yampolskyi, SOC Prime",
        "date": "2023-04-26",
        "modified": "",
        "references": [
          "https://www.cisecurity.org/controls/cis-controls-list/",
          "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
          "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
          "https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=4730",
          "https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=634"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/account_management/win_security_security_enabled_global_group_deleted.yml"
      }
    },
    {
      "id": "78d5cab4-557e-454f-9fb9-a222bd0d5edc",
      "title": "External Remote SMB Logon from Public IP",
      "status": "test",
      "description": "Detects successful logon from public IP address via SMB. This can indicate a publicly-exposed SMB port.",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.defense-evasion",
        "attack.initial-access",
        "attack.credential-access",
        "attack.t1133",
        "attack.t1078",
        "attack.t1110"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4624,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "LogonType": {
                "field": "LogonType",
                "value": 3,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_local_ranges": {
            "type": "field_match",
            "matchers": {
              "IpAddress__cidr": {
                "field": "IpAddress",
                "value": [
                  "::1/128",
                  "10.0.0.0/8",
                  "127.0.0.0/8",
                  "172.16.0.0/12",
                  "192.168.0.0/16",
                  "169.254.0.0/16",
                  "fc00::/7",
                  "fe80::/10"
                ],
                "modifiers": [
                  "cidr"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_empty": {
            "type": "field_match",
            "matchers": {
              "IpAddress": {
                "field": "IpAddress",
                "value": "-",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1133",
          "T1078",
          "T1110"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "defense_evasion",
          "initial_access",
          "credential_access"
        ]
      },
      "meta": {
        "author": "Micah Babinski (@micahbabinski), Zach Mathis (@yamatosecurity)",
        "date": "2023-01-19",
        "modified": "2024-03-11",
        "references": [
          "https://www.inversecos.com/2020/04/successful-4624-anonymous-logons-to.html",
          "https://twitter.com/Purp1eW0lf/status/1616144561965002752"
        ],
        "falsepositives": [
          "Legitimate or intentional inbound connections from public IP addresses on the SMB port."
        ],
        "source_file": "sigma_rules/windows/builtin/security/account_management/win_security_successful_external_remote_smb_login.yml"
      }
    },
    {
      "id": "16f5d8ca-44bd-47c8-acbe-6fc95a16c12f",
      "title": "RottenPotato Like Attack Pattern",
      "status": "test",
      "description": "Detects logon events that have characteristics of events generated during an attack with RottenPotato and the like",
      "level": "high",
      "tags": [
        "attack.collection",
        "attack.privilege-escalation",
        "attack.credential-access",
        "attack.t1557.001"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4624,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "LogonType": {
                "field": "LogonType",
                "value": 3,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetUserName": {
                "field": "TargetUserName",
                "value": "ANONYMOUS LOGON",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "WorkstationName": {
                "field": "WorkstationName",
                "value": "-",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "IpAddress": {
                "field": "IpAddress",
                "value": [
                  "127.0.0.1",
                  "::1"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1557.001"
        ],
        "tactics": [
          "collection",
          "privilege_escalation",
          "credential_access"
        ]
      },
      "meta": {
        "author": "@SBousseaden, Florian Roth",
        "date": "2019-11-15",
        "modified": "2022-12-22",
        "references": [
          "https://twitter.com/SBousseaden/status/1195284233729777665"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/account_management/win_security_susp_rottenpotato.yml"
      }
    },
    {
      "id": "def8b624-e08f-4ae1-8612-1ba21190da6b",
      "title": "Outgoing Logon with New Credentials",
      "status": "test",
      "description": "Detects logon events that specify new credentials",
      "level": "low",
      "tags": [
        "attack.defense-evasion",
        "attack.lateral-movement",
        "attack.t1550"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4624,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "LogonType": {
                "field": "LogonType",
                "value": 9,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1550"
        ],
        "tactics": [
          "defense_evasion",
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Max Altgelt (Nextron Systems)",
        "date": "2022-04-06",
        "modified": "",
        "references": [
          "https://go.recordedfuture.com/hubfs/reports/mtp-2021-0914.pdf"
        ],
        "falsepositives": [
          "Legitimate remote administration activity"
        ],
        "source_file": "sigma_rules/windows/builtin/security/account_management/win_security_susp_logon_newcredentials.yml"
      }
    },
    {
      "id": "259a9cdf-c4dd-4fa2-b243-2269e5ab18a2",
      "title": "External Remote RDP Logon from Public IP",
      "status": "test",
      "description": "Detects successful logon from public IP address via RDP. This can indicate a publicly-exposed RDP port.",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.defense-evasion",
        "attack.initial-access",
        "attack.credential-access",
        "attack.t1133",
        "attack.t1078",
        "attack.t1110"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4624,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "LogonType": {
                "field": "LogonType",
                "value": 10,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_local_ranges": {
            "type": "field_match",
            "matchers": {
              "IpAddress__cidr": {
                "field": "IpAddress",
                "value": [
                  "::1/128",
                  "10.0.0.0/8",
                  "127.0.0.0/8",
                  "172.16.0.0/12",
                  "192.168.0.0/16",
                  "169.254.0.0/16",
                  "fc00::/7",
                  "fe80::/10"
                ],
                "modifiers": [
                  "cidr"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_empty": {
            "type": "field_match",
            "matchers": {
              "IpAddress": {
                "field": "IpAddress",
                "value": "-",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1133",
          "T1078",
          "T1110"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "defense_evasion",
          "initial_access",
          "credential_access"
        ]
      },
      "meta": {
        "author": "Micah Babinski (@micahbabinski), Zach Mathis (@yamatosecurity)",
        "date": "2023-01-19",
        "modified": "2024-03-11",
        "references": [
          "https://www.inversecos.com/2020/04/successful-4624-anonymous-logons-to.html",
          "https://twitter.com/Purp1eW0lf/status/1616144561965002752"
        ],
        "falsepositives": [
          "Legitimate or intentional inbound connections from public IP addresses on the RDP port."
        ],
        "source_file": "sigma_rules/windows/builtin/security/account_management/win_security_successful_external_remote_rdp_login.yml"
      }
    },
    {
      "id": "f88e112a-21aa-44bd-9b01-6ee2a2bbbed1",
      "title": "Failed Logon From Public IP",
      "status": "test",
      "description": "Detects a failed logon attempt from a public IP. A login from a public IP can indicate a misconfigured firewall or network boundary.",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.defense-evasion",
        "attack.initial-access",
        "attack.persistence",
        "attack.t1078",
        "attack.t1190",
        "attack.t1133"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4625,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_ip_unknown": {
            "type": "field_match",
            "matchers": {
              "IpAddress__contains": {
                "field": "IpAddress",
                "value": "-",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_local_ranges": {
            "type": "field_match",
            "matchers": {
              "IpAddress__cidr": {
                "field": "IpAddress",
                "value": [
                  "::1/128",
                  "10.0.0.0/8",
                  "127.0.0.0/8",
                  "172.16.0.0/12",
                  "192.168.0.0/16",
                  "169.254.0.0/16",
                  "fc00::/7",
                  "fe80::/10"
                ],
                "modifiers": [
                  "cidr"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1078",
          "T1190",
          "T1133"
        ],
        "tactics": [
          "privilege_escalation",
          "defense_evasion",
          "initial_access",
          "persistence"
        ]
      },
      "meta": {
        "author": "NVISO",
        "date": "2020-05-06",
        "modified": "2024-03-11",
        "references": [
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/auditing/event-4625"
        ],
        "falsepositives": [
          "Legitimate logon attempts over the internet",
          "IPv4-to-IPv6 mapped IPs"
        ],
        "source_file": "sigma_rules/windows/builtin/security/account_management/win_security_susp_failed_logon_source.yml"
      }
    },
    {
      "id": "5af54681-df95-4c26-854f-2565e13cfab0",
      "title": "Successful Account Login Via WMI",
      "status": "stable",
      "description": "Detects successful logon attempts performed with WMI",
      "level": "low",
      "tags": [
        "attack.execution",
        "attack.t1047"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4624,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ProcessName__endswith": {
                "field": "ProcessName",
                "value": "\\WmiPrvSE.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1047"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Thomas Patzke",
        "date": "2019-12-04",
        "modified": "2024-01-17",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Monitoring tools",
          "Legitimate system administration"
        ],
        "source_file": "sigma_rules/windows/builtin/security/account_management/win_security_susp_wmi_login.yml"
      }
    },
    {
      "id": "8eef149c-bd26-49f2-9e5a-9b00e3af499b",
      "title": "Pass the Hash Activity 2",
      "status": "stable",
      "description": "Detects the attack technique pass the hash which is used to move laterally inside the network",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.lateral-movement",
        "attack.t1550.002"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection_logon3": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4624,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "SubjectUserSid": {
                "field": "SubjectUserSid",
                "value": "S-1-0-0",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "LogonType": {
                "field": "LogonType",
                "value": 3,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "LogonProcessName": {
                "field": "LogonProcessName",
                "value": "NtLmSsp",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "KeyLength": {
                "field": "KeyLength",
                "value": 0,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_logon9": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4624,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "LogonType": {
                "field": "LogonType",
                "value": 9,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "LogonProcessName": {
                "field": "LogonProcessName",
                "value": "seclogo",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "TargetUserName": {
                "field": "TargetUserName",
                "value": "ANONYMOUS LOGON",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "1 of selection_* and not filter",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "1 of selection_*"
            },
            {
              "type": "not",
              "value": "filter"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1550.002"
        ],
        "tactics": [
          "defense_evasion",
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Dave Kennedy, Jeff Warren (method) / David Vassallo (rule)",
        "date": "2019-06-14",
        "modified": "2022-10-05",
        "references": [
          "https://github.com/iadgov/Event-Forwarding-Guidance/tree/master/Events",
          "https://web.archive.org/web/20170909091934/https://blog.binarydefense.com/reliably-detecting-pass-the-hash-through-event-log-analysis",
          "https://blog.stealthbits.com/how-to-detect-pass-the-hash-attacks/"
        ],
        "falsepositives": [
          "Administrator activity"
        ],
        "source_file": "sigma_rules/windows/builtin/security/account_management/win_security_pass_the_hash_2.yml"
      }
    },
    {
      "id": "02c39d30-02b5-45d2-b435-8aebfe5a8629",
      "title": "A Member Was Removed From a Security-Enabled Global Group",
      "status": "stable",
      "description": "Detects activity when a member is removed from a security-enabled global group",
      "level": "low",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1098"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": [
                  633,
                  4729
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1098"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Alexandr Yampolskyi, SOC Prime",
        "date": "2023-04-26",
        "modified": "",
        "references": [
          "https://www.cisecurity.org/controls/cis-controls-list/",
          "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
          "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
          "https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=4729",
          "https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=633"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/account_management/win_security_member_removed_security_enabled_global_group.yml"
      }
    },
    {
      "id": "02f7c9c1-1ae8-4c6a-8add-04693807f92f",
      "title": "Potential Access Token Abuse",
      "status": "test",
      "description": "Detects potential token impersonation and theft. Example, when using \"DuplicateToken(Ex)\" and \"ImpersonateLoggedOnUser\" with the \"LOGON32_LOGON_NEW_CREDENTIALS flag\".",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1134.001",
        "stp.4u"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4624,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "LogonType": {
                "field": "LogonType",
                "value": 9,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "LogonProcessName": {
                "field": "LogonProcessName",
                "value": "Advapi",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "AuthenticationPackageName": {
                "field": "AuthenticationPackageName",
                "value": "Negotiate",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ImpersonationLevel": {
                "field": "ImpersonationLevel",
                "value": "%%1833",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1134.001"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Michaela Adams, Zach Mathis",
        "date": "2022-11-06",
        "modified": "2023-04-26",
        "references": [
          "https://www.elastic.co/fr/blog/how-attackers-abuse-access-token-manipulation",
          "https://www.manageengine.com/log-management/cyber-security/access-token-manipulation.html"
        ],
        "falsepositives": [
          "Anti-Virus"
        ],
        "source_file": "sigma_rules/windows/builtin/security/account_management/win_security_access_token_abuse.yml"
      }
    },
    {
      "id": "c43c26be-2e87-46c7-8661-284588c5a53e",
      "title": "A Member Was Added to a Security-Enabled Global Group",
      "status": "stable",
      "description": "Detects activity when a member is added to a security-enabled global group",
      "level": "low",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1098"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": [
                  4728,
                  632
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1098"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Alexandr Yampolskyi, SOC Prime",
        "date": "2023-04-26",
        "modified": "",
        "references": [
          "https://www.cisecurity.org/controls/cis-controls-list/",
          "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
          "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
          "https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=4728",
          "https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=632"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/security/account_management/win_security_member_added_security_enabled_global_group.yml"
      }
    },
    {
      "id": "192a0330-c20b-4356-90b6-7b7049ae0b87",
      "title": "Successful Overpass the Hash Attempt",
      "status": "test",
      "description": "Detects successful logon with logon type 9 (NewCredentials) which matches the Overpass the Hash behavior of e.g Mimikatz's sekurlsa::pth module.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.lateral-movement",
        "attack.s0002",
        "attack.t1550.002"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4624,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "LogonType": {
                "field": "LogonType",
                "value": 9,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "LogonProcessName": {
                "field": "LogonProcessName",
                "value": "seclogo",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "AuthenticationPackageName": {
                "field": "AuthenticationPackageName",
                "value": "Negotiate",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1550.002"
        ],
        "tactics": [
          "defense_evasion",
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez (source), Dominik Schaudel (rule)",
        "date": "2018-02-12",
        "modified": "2021-11-27",
        "references": [
          "https://web.archive.org/web/20220419045003/https://cyberwardog.blogspot.com/2017/04/chronicles-of-threat-hunter-hunting-for.html"
        ],
        "falsepositives": [
          "Runas command-line tool using /netonly parameter"
        ],
        "source_file": "sigma_rules/windows/builtin/security/account_management/win_security_overpass_the_hash.yml"
      }
    },
    {
      "id": "0f63e1ef-1eb9-4226-9d54-8927ca08520a",
      "title": "Admin User Remote Logon",
      "status": "test",
      "description": "Detect remote login by Administrator user (depending on internal pattern).",
      "level": "low",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.defense-evasion",
        "attack.lateral-movement",
        "attack.initial-access",
        "attack.t1078.001",
        "attack.t1078.002",
        "attack.t1078.003",
        "car.2016-04-005"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 4624,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "LogonType": {
                "field": "LogonType",
                "value": 10,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "AuthenticationPackageName": {
                "field": "AuthenticationPackageName",
                "value": "Negotiate",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetUserName__startswith": {
                "field": "TargetUserName",
                "value": "Admin",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1078.001",
          "T1078.002",
          "T1078.003"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "defense_evasion",
          "lateral_movement",
          "initial_access"
        ]
      },
      "meta": {
        "author": "juju4",
        "date": "2017-10-29",
        "modified": "2022-10-09",
        "references": [
          "https://car.mitre.org/wiki/CAR-2016-04-005"
        ],
        "falsepositives": [
          "Legitimate administrative activity."
        ],
        "source_file": "sigma_rules/windows/builtin/security/account_management/win_security_admin_rdp_login.yml"
      }
    },
    {
      "id": "bacf58c6-e199-4040-a94f-95dea0f1e45a",
      "title": "Windows Filtering Platform Blocked Connection From EDR Agent Binary",
      "status": "test",
      "description": "Detects a Windows Filtering Platform (WFP) blocked connection event involving common Endpoint Detection and Response (EDR) agents.\nAdversaries may use WFP filters to prevent Endpoint Detection and Response (EDR) agents from reporting security events.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "security"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 5157,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Application__endswith": {
                "field": "Application",
                "value": [
                  "\\AmSvc.exe",
                  "\\cb.exe",
                  "\\CETASvc.exe",
                  "\\CNTAoSMgr.exe",
                  "\\CrAmTray.exe",
                  "\\CrsSvc.exe",
                  "\\CSFalconContainer.exe",
                  "\\CSFalconService.exe",
                  "\\CybereasonAV.exe",
                  "\\CylanceSvc.exe",
                  "\\cyserver.exe",
                  "\\CyveraService.exe",
                  "\\CyvrFsFlt.exe",
                  "\\EIConnector.exe",
                  "\\elastic-agent.exe",
                  "\\elastic-endpoint.exe",
                  "\\EndpointBasecamp.exe",
                  "\\ExecutionPreventionSvc.exe",
                  "\\filebeat.exe",
                  "\\fortiedr.exe",
                  "\\hmpalert.exe",
                  "\\hurukai.exe",
                  "\\LogProcessorService.exe",
                  "\\mcsagent.exe",
                  "\\mcsclient.exe",
                  "\\MsMpEng.exe",
                  "\\MsSense.exe",
                  "\\Ntrtscan.exe",
                  "\\PccNTMon.exe",
                  "\\QualysAgent.exe",
                  "\\RepMgr.exe",
                  "\\RepUtils.exe",
                  "\\RepUx.exe",
                  "\\RepWAV.exe",
                  "\\RepWSC.exe",
                  "\\sedservice.exe",
                  "\\SenseCncProxy.exe",
                  "\\SenseIR.exe",
                  "\\SenseNdr.exe",
                  "\\SenseSampleUploader.exe",
                  "\\SentinelAgent.exe",
                  "\\SentinelAgentWorker.exe",
                  "\\SentinelBrowserNativeHost.exe",
                  "\\SentinelHelperService.exe",
                  "\\SentinelServiceHost.exe",
                  "\\SentinelStaticEngine.exe",
                  "\\SentinelStaticEngineScanner.exe",
                  "\\sfc.exe",
                  "\\sophos ui.exe",
                  "\\sophosfilescanner.exe",
                  "\\sophosfs.exe",
                  "\\sophoshealth.exe",
                  "\\sophosips.exe",
                  "\\sophosLivequeryservice.exe",
                  "\\sophosnetfilter.exe",
                  "\\sophosntpservice.exe",
                  "\\sophososquery.exe",
                  "\\sspservice.exe",
                  "\\TaniumClient.exe",
                  "\\TaniumCX.exe",
                  "\\TaniumDetectEngine.exe",
                  "\\TMBMSRV.exe",
                  "\\TmCCSF.exe",
                  "\\TmListen.exe",
                  "\\TmWSCSvc.exe",
                  "\\Traps.exe",
                  "\\winlogbeat.exe",
                  "\\WSCommunicator.exe",
                  "\\xagt.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "@gott_cyber",
        "date": "2024-01-08",
        "modified": "",
        "references": [
          "https://github.com/netero1010/EDRSilencer",
          "https://github.com/amjcyber/EDRNoiseMaker",
          "https://ghoulsec.medium.com/misc-series-4-forensics-on-edrsilencer-events-428b20b3f983"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/builtin/security/object_access/win_security_wfp_endpoint_agent_blocked.yml"
      }
    }
  ]
}