{
  "metadata": {
    "logsource": "windows_appxdeployment_server",
    "rule_count": 7,
    "compiled_at": "2026-02-04T12:28:36.358120",
    "version": "1.1"
  },
  "rules": [
    {
      "id": "5cdeaf3d-1489-477c-95ab-c318559fc051",
      "title": "AppX Located in Known Staging Directory Added to Deployment Pipeline",
      "status": "test",
      "description": "Detects an appx package that was added to the pipeline of the \"to be processed\" packages that is located in a known folder often used as a staging directory.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "appxdeployment-server"
      },
      "detection": {
        "selections": {
          "selection_eid": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 854,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_paths_forward": {
            "type": "field_match",
            "matchers": {
              "Path__contains": {
                "field": "Path",
                "value": [
                  ":/Perflogs/",
                  ":/Users/Public/",
                  ":/Windows/Temp/",
                  "/AppdData/Local/Temp/",
                  "/Desktop/",
                  "/Downloads/"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_paths_back": {
            "type": "field_match",
            "matchers": {
              "Path__contains": {
                "field": "Path",
                "value": [
                  ":\\PerfLogs\\",
                  ":\\Users\\Public\\",
                  ":\\Windows\\Temp\\",
                  "\\AppdData\\Local\\Temp\\",
                  "\\Desktop\\",
                  "\\Downloads\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_eid and 1 of selection_paths_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_eid"
            },
            {
              "type": "ref",
              "value": "1 of selection_paths_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-01-11",
        "modified": "",
        "references": [
          "https://www.sentinelone.com/labs/inside-malicious-windows-apps-for-malware-deployment/",
          "https://learn.microsoft.com/en-us/windows/win32/appxpkg/troubleshooting",
          "https://news.sophos.com/en-us/2021/11/11/bazarloader-call-me-back-attack-abuses-windows-10-apps-mechanism/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/appxdeployment_server/win_appxdeployment_server_appx_package_in_staging_directory.yml"
      }
    },
    {
      "id": "8b48ad89-10d8-4382-a546-50588c410f0d",
      "title": "Remote AppX Package Downloaded from File Sharing or CDN Domain",
      "status": "test",
      "description": "Detects an appx package that was added to the pipeline of the \"to be processed\" packages which was downloaded from a file sharing or CDN domain.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "appxdeployment-server"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 854,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Path__contains": {
                "field": "Path",
                "value": [
                  ".githubusercontent.com",
                  "anonfiles.com",
                  "cdn.discordapp.com",
                  "ddns.net",
                  "dl.dropboxusercontent.com",
                  "ghostbin.co",
                  "github.com",
                  "glitch.me",
                  "gofile.io",
                  "hastebin.com",
                  "mediafire.com",
                  "mega.nz",
                  "onrender.com",
                  "pages.dev",
                  "paste.ee",
                  "pastebin.com",
                  "pastebin.pl",
                  "pastetext.net",
                  "privatlab.com",
                  "privatlab.net",
                  "send.exploit.in",
                  "sendspace.com",
                  "storage.googleapis.com",
                  "storjshare.io",
                  "supabase.co",
                  "temp.sh",
                  "transfer.sh",
                  "trycloudflare.com",
                  "ufile.io",
                  "w3spaces.com",
                  "workers.dev"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-01-11",
        "modified": "2025-12-10",
        "references": [
          "https://www.sentinelone.com/labs/inside-malicious-windows-apps-for-malware-deployment/",
          "https://learn.microsoft.com/en-us/windows/win32/appxpkg/troubleshooting",
          "https://news.sophos.com/en-us/2021/11/11/bazarloader-call-me-back-attack-abuses-windows-10-apps-mechanism/"
        ],
        "falsepositives": [
          "Unlikely, unless the organization uses file sharing or CDN services to distribute internal applications."
        ],
        "source_file": "sigma_rules/windows/builtin/appxdeployment_server/win_appxdeployment_server_appx_downloaded_from_file_sharing_domains.yml"
      }
    },
    {
      "id": "898d5fc9-fbc3-43de-93ad-38e97237c344",
      "title": "AppX Package Deployment Failed Due to Signing Requirements",
      "status": "test",
      "description": "Detects an appx package deployment / installation with the error code \"0x80073cff\" which indicates that the package didn't meet the signing requirements.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "appxdeployment-server"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 401,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ErrorCode": {
                "field": "ErrorCode",
                "value": "0x80073cff",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-01-11",
        "modified": "2025-12-03",
        "references": [
          "https://www.sentinelone.com/labs/inside-malicious-windows-apps-for-malware-deployment/",
          "https://learn.microsoft.com/en-us/windows/win32/appxpkg/troubleshooting",
          "https://news.sophos.com/en-us/2021/11/11/bazarloader-call-me-back-attack-abuses-windows-10-apps-mechanism/"
        ],
        "falsepositives": [
          "Legitimate AppX packages not signed by MS used part of an enterprise."
        ],
        "source_file": "sigma_rules/windows/builtin/appxdeployment_server/win_appxdeployment_server_appx_package_deployment_failed_signing_requirements.yml"
      }
    },
    {
      "id": "6ae53108-c3a0-4bee-8f45-c7591a2c337f",
      "title": "Deployment AppX Package Was Blocked By AppLocker",
      "status": "test",
      "description": "Detects an appx package deployment that was blocked by AppLocker policy.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "appxdeployment-server"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 412,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2023-01-11",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/windows/win32/appxpkg/troubleshooting",
          "https://github.com/nasbench/EVTX-ETW-Resources/blob/7a806a148b3d9d381193d4a80356016e6e8b1ee8/ETWEventsList/CSV/Windows11/22H2/W11_22H2_Pro_20220920_22621.382/Providers/Microsoft-Windows-AppXDeployment-Server.csv"
        ],
        "falsepositives": [
          "Unlikely, since this event notifies about blocked application deployment. Tune your applocker rules to avoid blocking legitimate applications."
        ],
        "source_file": "sigma_rules/windows/builtin/appxdeployment_server/win_appxdeployment_server_applocker_block.yml"
      }
    },
    {
      "id": "e021bbb5-407f-41f5-9dc9-1864c45a7a51",
      "title": "Deployment Of The AppX Package Was Blocked By The Policy",
      "status": "test",
      "description": "Detects an appx package deployment that was blocked by the local computer policy.\nThe following events indicate that an AppX package deployment was blocked by a policy:\n- Event ID 441: The package deployment operation is blocked by the \"Allow deployment operations in special profiles\" policy\n- Event ID 442: Deployments to non-system volumes are blocked by the \"Disable deployment of Windows Store apps to non-system volumes\" policy.\"\n- Event ID 453: Package blocked by a platform policy.\n- Event ID 454: Package blocked by a platform policy.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "appxdeployment-server"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": [
                  441,
                  442,
                  453,
                  454
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2023-01-11",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/windows/win32/appxpkg/troubleshooting",
          "https://github.com/nasbench/EVTX-ETW-Resources/blob/7a806a148b3d9d381193d4a80356016e6e8b1ee8/ETWEventsList/CSV/Windows11/22H2/W11_22H2_Pro_20220920_22621.382/Providers/Microsoft-Windows-AppXDeployment-Server.csv"
        ],
        "falsepositives": [
          "Unlikely, since this event notifies about blocked application deployment. Tune your applocker rules to avoid blocking legitimate applications."
        ],
        "source_file": "sigma_rules/windows/builtin/appxdeployment_server/win_appxdeployment_server_policy_block.yml"
      }
    },
    {
      "id": "c977cb50-3dff-4a9f-b873-9290f56132f1",
      "title": "AppX Located in Uncommon Directory Added to Deployment Pipeline",
      "status": "test",
      "description": "Detects an appx package that was added to the pipeline of the \"to be processed\" packages that is located in uncommon locations.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "appxdeployment-server"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 854,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_generic": {
            "type": "field_match",
            "matchers": {
              "Path__contains": {
                "field": "Path",
                "value": [
                  ":/Program%20Files",
                  ":/Windows/System32/",
                  ":\\Program Files (x86)\\",
                  ":\\Program Files\\",
                  ":\\Windows\\ImmersiveControlPanel\\",
                  ":\\Windows\\PrintDialog\\",
                  ":\\Windows\\SystemApps\\",
                  "AppData/Local/Temp/WinGet/Microsoft.Winget.Source",
                  "x-windowsupdate://"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_specific": {
            "type": "field_match",
            "matchers": {
              "Path__contains": {
                "field": "Path",
                "value": [
                  "https://installer.teams.static.microsoft/",
                  "https://res.cdn.office.net",
                  "https://statics.teams.cdn.live.net/",
                  "https://statics.teams.cdn.office.net/",
                  "microsoft.com"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_onedrive": {
            "type": "field_match",
            "matchers": {
              "Path__contains": {
                "field": "Path",
                "value": "AppData\\Local\\Microsoft\\OneDrive\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_winget": {
            "type": "field_match",
            "matchers": {
              "Path__contains": {
                "field": "Path",
                "value": [
                  "AppData/Local/Temp/WinGet/Microsoft.Winget.Source",
                  "AppData\\Local\\Temp\\WinGet\\Microsoft.Winget.Source"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_x_windowsupdate": {
            "type": "field_match",
            "matchers": {
              "Path__contains": {
                "field": "Path",
                "value": "x-windowsupdate://",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-01-11",
        "modified": "2025-12-03",
        "references": [
          "Internal Research",
          "https://www.sentinelone.com/labs/inside-malicious-windows-apps-for-malware-deployment/",
          "https://learn.microsoft.com/en-us/windows/win32/appxpkg/troubleshooting",
          "https://news.sophos.com/en-us/2021/11/11/bazarloader-call-me-back-attack-abuses-windows-10-apps-mechanism/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/appxdeployment_server/win_appxdeployment_server_uncommon_package_locations.yml"
      }
    },
    {
      "id": "09d3b48b-be17-47f5-bf4e-94e7e75d09ce",
      "title": "Potential Malicious AppX Package Installation Attempts",
      "status": "test",
      "description": "Detects potential installation or installation attempts of known malicious appx packages",
      "level": "medium",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "appxdeployment-server"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": [
                  400,
                  401
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "PackageFullName__contains": {
                "field": "PackageFullName",
                "value": "3669e262-ec02-4e9d-bcb4-3d008b4afac9",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-01-11",
        "modified": "2023-01-12",
        "references": [
          "https://www.sentinelone.com/labs/inside-malicious-windows-apps-for-malware-deployment/",
          "https://news.sophos.com/en-us/2021/11/11/bazarloader-call-me-back-attack-abuses-windows-10-apps-mechanism/",
          "https://forensicitguy.github.io/analyzing-magnitude-magniber-appx/"
        ],
        "falsepositives": [
          "Rare occasions where a malicious package uses the exact same name and version as a legitimate application."
        ],
        "source_file": "sigma_rules/windows/builtin/appxdeployment_server/win_appxdeployment_server_mal_appx_names.yml"
      }
    }
  ]
}