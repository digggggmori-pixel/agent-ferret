{
  "metadata": {
    "logsource": "windows_ntlm",
    "rule_count": 3,
    "compiled_at": "2026-02-04T12:28:36.413204",
    "version": "1.1"
  },
  "rules": [
    {
      "id": "98c3bcf1-56f2-49dc-9d8d-c66cf190238b",
      "title": "NTLM Logon",
      "status": "test",
      "description": "Detects logons using NTLM, which could be caused by a legacy source or attackers",
      "level": "low",
      "tags": [
        "attack.defense-evasion",
        "attack.lateral-movement",
        "attack.t1550.002"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "ntlm"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 8002,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1550.002"
        ],
        "tactics": [
          "defense_evasion",
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2018-06-08",
        "modified": "2024-07-22",
        "references": [
          "https://twitter.com/JohnLaTwC/status/1004895028995477505"
        ],
        "falsepositives": [
          "Legacy hosts"
        ],
        "source_file": "sigma_rules/windows/builtin/ntlm/win_susp_ntlm_auth.yml"
      }
    },
    {
      "id": "ce5678bb-b9aa-4fb5-be4b-e57f686256ad",
      "title": "Potential Remote Desktop Connection to Non-Domain Host",
      "status": "test",
      "description": "Detects logons using NTLM to hosts that are potentially not part of the domain.",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1219.002"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "ntlm"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 8001,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetName__startswith": {
                "field": "TargetName",
                "value": "TERMSRV",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1219.002"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "James Pemberton",
        "date": "2020-05-22",
        "modified": "2021-11-27",
        "references": [
          "n/a"
        ],
        "falsepositives": [
          "Host connections to valid domains, exclude these.",
          "Host connections not using host FQDN.",
          "Host connections to external legitimate domains."
        ],
        "source_file": "sigma_rules/windows/builtin/ntlm/win_susp_ntlm_rdp.yml"
      }
    },
    {
      "id": "9c8acf1a-cbf9-4db6-b63c-74baabe03e59",
      "title": "NTLM Brute Force",
      "status": "test",
      "description": "Detects common NTLM brute force device names",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.t1110"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "ntlm"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 8004,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "devicename": {
            "type": "field_match",
            "matchers": {
              "WorkstationName": {
                "field": "WorkstationName",
                "value": [
                  "Rdesktop",
                  "Remmina",
                  "Freerdp",
                  "Windows7",
                  "Windows8",
                  "Windows2012",
                  "Windows2016",
                  "Windows2019"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection and devicename",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "ref",
              "value": "devicename"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1110"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Jerry Shockley '@jsh0x'",
        "date": "2022-02-02",
        "modified": "",
        "references": [
          "https://www.varonis.com/blog/investigate-ntlm-brute-force"
        ],
        "falsepositives": [
          "Systems with names equal to the spoofed ones used by the brute force tools"
        ],
        "source_file": "sigma_rules/windows/builtin/ntlm/win_susp_ntlm_brute_force.yml"
      }
    }
  ]
}