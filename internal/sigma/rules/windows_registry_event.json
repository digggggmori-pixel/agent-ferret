{
  "metadata": {
    "logsource": "windows_registry_event",
    "rule_count": 32,
    "compiled_at": "2026-02-04T12:28:36.532293",
    "version": "1.1"
  },
  "rules": [
    {
      "id": "6aa1d992-5925-4e9f-a49b-845e51d1de01",
      "title": "New DLL Added to AppCertDlls Registry Key",
      "status": "test",
      "description": "Dynamic-link libraries (DLLs) that are specified in the AppCertDLLs value in the Registry key can be abused to obtain persistence and privilege escalation\nby causing a malicious DLL to be loaded and run in the context of separate processes on the computer.\n",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1546.009"
      ],
      "logsource": {
        "category": "registry_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "TargetObject": {
                    "field": "TargetObject",
                    "value": "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\AppCertDlls",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "NewName": {
                    "field": "NewName",
                    "value": "HKLM\\SYSTEM\\CurentControlSet\\Control\\Session Manager\\AppCertDlls",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1546.009"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Ilyas Ochkov, oscd.community",
        "date": "2019-10-25",
        "modified": "2021-11-27",
        "references": [
          "http://www.hexacorn.com/blog/2013/01/19/beyond-good-ol-run-key-part-3/",
          "https://eqllib.readthedocs.io/en/latest/analytics/14f90406-10a0-4d36-a672-31cabe149f2f.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_event/registry_event_new_dll_added_to_appcertdlls_registry_key.yml"
      }
    },
    {
      "id": "4f84b697-c9ed-4420-8ab5-e09af5b2345d",
      "title": "New DLL Added to AppInit_DLLs Registry Key",
      "status": "test",
      "description": "DLLs that are specified in the AppInit_DLLs value in the Registry key HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows are loaded by user32.dll into every process that loads user32.dll",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1546.010"
      ],
      "logsource": {
        "category": "registry_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "TargetObject__endswith": {
                    "field": "TargetObject",
                    "value": [
                      "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\AppInit_Dlls",
                      "\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\AppInit_Dlls"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "NewName__endswith": {
                    "field": "NewName",
                    "value": [
                      "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\AppInit_Dlls",
                      "\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\AppInit_Dlls"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": "(Empty)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1546.010"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Ilyas Ochkov, oscd.community, Tim Shelton",
        "date": "2019-10-25",
        "modified": "2022-12-25",
        "references": [
          "https://eqllib.readthedocs.io/en/latest/analytics/822dc4c5-b355-4df8-bd37-29c458997b8f.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_event/registry_event_new_dll_added_to_appinit_dlls_registry_key.yml"
      }
    },
    {
      "id": "f663a6d9-9d1b-49b8-b2b1-0637914d199a",
      "title": "Narrator's Feedback-Hub Persistence",
      "status": "test",
      "description": "Detects abusing Windows 10 Narrator's Feedback-Hub",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547.001"
      ],
      "logsource": {
        "category": "registry_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection1": {
            "type": "field_match",
            "matchers": {
              "EventType": {
                "field": "EventType",
                "value": "DeleteValue",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\AppXypsaf9f1qserqevf0sws76dx4k9a5206\\Shell\\open\\command\\DelegateExecute",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection2": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\AppXypsaf9f1qserqevf0sws76dx4k9a5206\\Shell\\open\\command\\(Default)",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1547.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Dmitriy Lifanov, oscd.community",
        "date": "2019-10-25",
        "modified": "2022-03-26",
        "references": [
          "https://giuliocomi.blogspot.com/2019/10/abusing-windows-10-narrators-feedback.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_event/registry_event_narrator_feedback_persistance.yml"
      }
    },
    {
      "id": "b98968aa-dbc0-4a9c-ac35-108363cbf8d5",
      "title": "WINEKEY Registry Modification",
      "status": "test",
      "description": "Detects potential malicious modification of run keys by winekey or team9 backdoor",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547"
      ],
      "logsource": {
        "category": "registry_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Backup Mgr",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1547"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "omkar72",
        "date": "2020-10-30",
        "modified": "2021-11-27",
        "references": [
          "https://www.fireeye.com/blog/threat-research/2020/10/kegtap-and-singlemalt-with-a-ransomware-chaser.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_event/registry_event_runkey_winekey.yml"
      }
    },
    {
      "id": "3d27f6dd-1c74-4687-b4fa-ca849d128d1c",
      "title": "Office Application Startup - Office Test",
      "status": "test",
      "description": "Detects the addition of office test registry that allows a user to specify an arbitrary DLL that will be executed every time an Office application is started",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.t1137.002"
      ],
      "logsource": {
        "category": "registry_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Software\\Microsoft\\Office test\\Special\\Perf",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1137.002"
        ],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "omkar72",
        "date": "2020-10-25",
        "modified": "2023-11-08",
        "references": [
          "https://unit42.paloaltonetworks.com/unit42-technical-walkthrough-office-test-persistence-method-used-in-recent-sofacy-attacks/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/registry/registry_event/registry_event_office_test_regadd.yml"
      }
    },
    {
      "id": "6ea3bf32-9680-422d-9f50-e90716b12a66",
      "title": "UAC Bypass Via Wsreset",
      "status": "test",
      "description": "Unfixed method for UAC bypass from Windows 10. WSReset.exe file associated with the Windows Store. It will run a binary file contained in a low-privilege registry.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "registry_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\AppX82a6gwre4fdg3bt635tn5ctqjf8msdd2\\Shell\\open\\command",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "oscd.community, Dmitry Uchakin",
        "date": "2020-10-07",
        "modified": "2021-11-27",
        "references": [
          "https://www.bleepingcomputer.com/news/security/trickbot-uses-a-new-windows-10-uac-bypass-to-launch-quietly",
          "https://lolbas-project.github.io/lolbas/Binaries/Wsreset"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_event/registry_event_bypass_via_wsreset.yml"
      }
    },
    {
      "id": "baca5663-583c-45f9-b5dc-ea96a22ce542",
      "title": "Sticky Key Like Backdoor Usage - Registry",
      "status": "test",
      "description": "Detects the usage and installation of a backdoor that uses an option to register a malicious debugger for built-in tools that are accessible in the login screen",
      "level": "critical",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1546.008",
        "car.2014-11-003",
        "car.2014-11-008"
      ],
      "logsource": {
        "category": "registry_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_registry": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\sethc.exe\\Debugger",
                  "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\utilman.exe\\Debugger",
                  "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\osk.exe\\Debugger",
                  "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\Magnify.exe\\Debugger",
                  "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\Narrator.exe\\Debugger",
                  "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\DisplaySwitch.exe\\Debugger",
                  "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\atbroker.exe\\Debugger",
                  "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\HelpPane.exe\\Debugger"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_registry",
        "condition_parsed": {
          "op": "single",
          "selection": "selection_registry"
        }
      },
      "mitre": {
        "techniques": [
          "T1546.008"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), @twjackomo, Jonhnathan Ribeiro, oscd.community",
        "date": "2018-03-15",
        "modified": "2022-11-26",
        "references": [
          "https://blogs.technet.microsoft.com/jonathantrull/2016/10/03/detecting-sticky-key-backdoors/",
          "https://bazaar.abuse.ch/sample/6f3aa9362d72e806490a8abce245331030d1ab5ac77e400dd475748236a6cc81/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/registry/registry_event/registry_event_stickykey_like_backdoor.yml"
      }
    },
    {
      "id": "b3503044-60ce-4bf4-bbcb-e3db98788823",
      "title": "DLL Load via LSASS",
      "status": "test",
      "description": "Detects a method to load DLL via LSASS process using an undocumented Registry key",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.execution",
        "attack.persistence",
        "attack.t1547.008"
      ],
      "logsource": {
        "category": "registry_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\CurrentControlSet\\Services\\NTDS\\DirectoryServiceExtPt",
                  "\\CurrentControlSet\\Services\\NTDS\\LsaDbExtPt"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_domain_controller": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\system32\\lsass.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": [
                  "%%systemroot%%\\system32\\ntdsa.dll",
                  "%%systemroot%%\\system32\\lsadb.dll"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1547.008"
        ],
        "tactics": [
          "privilege_escalation",
          "execution",
          "persistence"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2019-10-16",
        "modified": "2022-04-21",
        "references": [
          "https://blog.xpnsec.com/exploring-mimikatz-part-1/",
          "https://twitter.com/SBousseaden/status/1183745981189427200"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_event/registry_event_susp_lsass_dll_load.yml"
      }
    },
    {
      "id": "9c5037d1-c568-49b3-88c7-9846a5bdc2be",
      "title": "Suspicious Run Key from Download",
      "status": "test",
      "description": "Detects the suspicious RUN keys created by software located in Download or temporary Outlook/Internet Explorer directories",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547.001"
      ],
      "logsource": {
        "category": "registry_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  "\\AppData\\Local\\Packages\\Microsoft.Outlook_",
                  "\\AppData\\Local\\Microsoft\\Olk\\Attachments\\",
                  "\\Downloads\\",
                  "\\Temporary Internet Files\\Content.Outlook\\",
                  "\\Local Settings\\Temporary Internet Files\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Software\\Microsoft\\Windows\\CurrentVersion\\Run",
                  "\\Software\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Run",
                  "\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1547.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Swachchhanda Shrawan Poude (Nextron Systems)",
        "date": "2019-10-01",
        "modified": "2025-02-17",
        "references": [
          "https://app.any.run/tasks/c5bef5b7-f484-4c43-9cf3-d5c5c7839def/",
          "https://github.com/HackTricks-wiki/hacktricks/blob/e4c7b21b8f36c97c35b7c622732b38a189ce18f7/src/windows-hardening/windows-local-privilege-escalation/privilege-escalation-with-autorun-binaries.md"
        ],
        "falsepositives": [
          "Software installers downloaded and used by users"
        ],
        "source_file": "sigma_rules/windows/registry/registry_event/registry_event_susp_download_run_key.yml"
      }
    },
    {
      "id": "919f2ef0-be2d-4a7a-b635-eb2b41fde044",
      "title": "Disable Security Events Logging Adding Reg Key MiniNt",
      "status": "test",
      "description": "Detects the addition of a key 'MiniNt' to the registry. Upon a reboot, Windows Event Log service will stop writing events.",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1562.002",
        "attack.t1112",
        "car.2022-03-001"
      ],
      "logsource": {
        "category": "registry_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "TargetObject": {
                    "field": "TargetObject",
                    "value": "HKLM\\SYSTEM\\CurrentControlSet\\Control\\MiniNt",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  },
                  "EventType": {
                    "field": "EventType",
                    "value": "CreateKey",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "NewName": {
                    "field": "NewName",
                    "value": "HKLM\\SYSTEM\\CurrentControlSet\\Control\\MiniNt",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.002",
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Ilyas Ochkov, oscd.community",
        "date": "2019-10-25",
        "modified": "2021-11-27",
        "references": [
          "https://twitter.com/0gtweet/status/1182516740955226112",
          "https://www.hackingarticles.in/defense-evasion-windows-event-logging-t1562-002/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_event/registry_event_disable_security_events_logging_adding_reg_key_minint.yml"
      }
    },
    {
      "id": "1c8e96cd-2bed-487d-9de0-b46c90cade56",
      "title": "Potential Qakbot Registry Activity",
      "status": "test",
      "description": "Detects a registry key used by IceID in a campaign that distributes malicious OneNote files",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Software\\firm\\soft\\Name",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Hieu Tran",
        "date": "2023-03-13",
        "modified": "",
        "references": [
          "https://www.zscaler.com/blogs/security-research/onenote-growing-threat-malware-distribution"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_event/registry_event_malware_qakbot_registry.yml"
      }
    },
    {
      "id": "62120148-6b7a-42be-8b91-271c04e281a3",
      "title": "Suspicious Camera and Microphone Access",
      "status": "test",
      "description": "Detects Processes accessing the camera and microphone from suspicious folder",
      "level": "high",
      "tags": [
        "attack.collection",
        "attack.t1125",
        "attack.t1123"
      ],
      "logsource": {
        "category": "registry_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_1": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains_all": {
                "field": "TargetObject",
                "value": [
                  "\\Software\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore\\",
                  "\\NonPackaged"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_2": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "microphone",
                  "webcam"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_3": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  ":#Windows#Temp#",
                  ":#$Recycle.bin#",
                  ":#Temp#",
                  ":#Users#Public#",
                  ":#Users#Default#",
                  ":#Users#Desktop#"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1125",
          "T1123"
        ],
        "tactics": [
          "collection"
        ]
      },
      "meta": {
        "author": "Den Iuzvyk",
        "date": "2020-06-07",
        "modified": "2022-10-09",
        "references": [
          "https://medium.com/@7a616368/can-you-track-processes-accessing-the-camera-and-microphone-7e6885b37072"
        ],
        "falsepositives": [
          "Unlikely, there could be conferencing software running from a Temp folder accessing the devices"
        ],
        "source_file": "sigma_rules/windows/registry/registry_event/registry_event_susp_mic_cam_access.yml"
      }
    },
    {
      "id": "eeb30123-9fbd-4ee8-aaa0-2e545bbed6dc",
      "title": "Security Support Provider (SSP) Added to LSA Configuration",
      "status": "test",
      "description": "Detects the addition of a SSP to the registry. Upon a reboot or API call, SSP DLLs gain access to encrypted and plaintext passwords stored in Windows.\n",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547.005"
      ],
      "logsource": {
        "category": "registry_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "\\Control\\Lsa\\Security Packages",
                  "\\Control\\Lsa\\OSConfig\\Security Packages"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_msiexec": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Windows\\system32\\msiexec.exe",
                  "C:\\Windows\\syswow64\\MsiExec.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1547.005"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "iwillkeepwatch",
        "date": "2019-01-18",
        "modified": "2022-08-09",
        "references": [
          "https://powersploit.readthedocs.io/en/latest/Persistence/Install-SSP/",
          "https://github.com/EmpireProject/Empire/blob/08cbd274bef78243d7a8ed6443b8364acd1fc48b/data/module_source/persistence/Install-SSP.ps1#L157"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_event/registry_event_ssp_added_lsa_config.yml"
      }
    },
    {
      "id": "b6d235fc-1d38-4b12-adbe-325f06728f37",
      "title": "CMSTP Execution Registry Event",
      "status": "stable",
      "description": "Detects various indicators of Microsoft Connection Manager Profile Installer execution",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.execution",
        "attack.t1218.003",
        "attack.g0069",
        "car.2019-04-001"
      ],
      "logsource": {
        "category": "registry_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\cmmgr32.exe",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.003"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Nik Seetharaman",
        "date": "2018-07-16",
        "modified": "2020-12-23",
        "references": [
          "https://web.archive.org/web/20190720093911/http://www.endurant.io/cmstp/detecting-cmstp-enabled-code-execution-and-uac-bypass-with-sysmon/"
        ],
        "falsepositives": [
          "Legitimate CMSTP use (unlikely in modern enterprise environments)"
        ],
        "source_file": "sigma_rules/windows/registry/registry_event/registry_event_cmstp_execution_by_registry.yml"
      }
    },
    {
      "id": "295a59c1-7b79-4b47-a930-df12c15fc9c2",
      "title": "Windows Registry Trust Record Modification",
      "status": "test",
      "description": "Alerts on trust record modification within the registry, indicating usage of macros",
      "level": "medium",
      "tags": [
        "attack.initial-access",
        "attack.t1566.001"
      ],
      "logsource": {
        "category": "registry_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Security\\Trusted Documents\\TrustRecords",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1566.001"
        ],
        "tactics": [
          "initial_access"
        ]
      },
      "meta": {
        "author": "Antonlovesdnb, Trent Liffick (@tliffick)",
        "date": "2020-02-19",
        "modified": "2023-06-21",
        "references": [
          "https://outflank.nl/blog/2018/01/16/hunting-for-evil-detect-macros-being-executed/",
          "http://az4n6.blogspot.com/2016/02/more-on-trust-records-macros-and.html",
          "https://twitter.com/inversecos/status/1494174785621819397"
        ],
        "falsepositives": [
          "This will alert on legitimate macro usage as well, additional tuning is required"
        ],
        "source_file": "sigma_rules/windows/registry/registry_event/registry_event_office_trust_record_modification.yml"
      }
    },
    {
      "id": "a54f842a-3713-4b45-8c84-5f136fdebd3c",
      "title": "New PortProxy Registry Entry Added",
      "status": "test",
      "description": "Detects the modification of the PortProxy registry key which is used for port forwarding.",
      "level": "medium",
      "tags": [
        "attack.lateral-movement",
        "attack.defense-evasion",
        "attack.command-and-control",
        "attack.t1090"
      ],
      "logsource": {
        "category": "registry_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Services\\PortProxy\\v4tov4\\tcp\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1090"
        ],
        "tactics": [
          "lateral_movement",
          "defense_evasion",
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Andreas Hunkeler (@Karneades)",
        "date": "2021-06-22",
        "modified": "2024-03-25",
        "references": [
          "https://www.fireeye.com/blog/threat-research/2019/01/bypassing-network-restrictions-through-rdp-tunneling.html",
          "https://adepts.of0x.cc/netsh-portproxy-code/",
          "https://www.dfirnotes.net/portproxy_detection/"
        ],
        "falsepositives": [
          "WSL2 network bridge PowerShell script used for WSL/Kubernetes/Docker (e.g. https://github.com/microsoft/WSL/issues/4150#issuecomment-504209723)",
          "Synergy Software KVM (https://symless.com/synergy)"
        ],
        "source_file": "sigma_rules/windows/registry/registry_event/registry_event_portproxy_registry_key.yml"
      }
    },
    {
      "id": "1a2d6c47-75b0-45bd-b133-2c0be75349fd",
      "title": "Wdigest CredGuard Registry Modification",
      "status": "test",
      "description": "Detects potential malicious modification of the property value of IsCredGuardEnabled from\nHKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest to disable Cred Guard on a system.\nThis is usually used with UseLogonCredential to manipulate the caching credentials.\n",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\IsCredGuardEnabled",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
        "date": "2019-08-25",
        "modified": "2021-11-27",
        "references": [
          "https://teamhydra.blog/2020/08/25/bypassing-credential-guard/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_event/registry_event_disable_wdigest_credential_guard.yml"
      }
    },
    {
      "id": "9577edbb-851f-4243-8c91-1d5b50c1a39b",
      "title": "Atbroker Registry Change",
      "status": "test",
      "description": "Detects creation/modification of Assistive Technology applications and persistence with usage of 'at'",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.defense-evasion",
        "attack.t1218",
        "attack.persistence",
        "attack.t1547"
      ],
      "logsource": {
        "category": "registry_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "Software\\Microsoft\\Windows NT\\CurrentVersion\\Accessibility\\ATs",
                  "Software\\Microsoft\\Windows NT\\CurrentVersion\\Accessibility\\Configuration"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_atbroker": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\system32\\atbroker.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Microsoft\\Windows NT\\CurrentVersion\\Accessibility\\Configuration",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "(Empty)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_uninstallers": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Windows\\Installer\\MSI",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "Software\\Microsoft\\Windows NT\\CurrentVersion\\Accessibility\\ATs",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218",
          "T1547"
        ],
        "tactics": [
          "privilege_escalation",
          "defense_evasion",
          "persistence"
        ]
      },
      "meta": {
        "author": "Mateusz Wydra, oscd.community",
        "date": "2020-10-13",
        "modified": "2023-01-19",
        "references": [
          "http://www.hexacorn.com/blog/2016/07/22/beyond-good-ol-run-key-part-42/",
          "https://lolbas-project.github.io/lolbas/Binaries/Atbroker/"
        ],
        "falsepositives": [
          "Creation of non-default, legitimate at usage"
        ],
        "source_file": "sigma_rules/windows/registry/registry_event/registry_event_susp_atbroker_change.yml"
      }
    },
    {
      "id": "d67572a0-e2ec-45d6-b8db-c100d14b8ef2",
      "title": "NetNTLM Downgrade Attack - Registry",
      "status": "test",
      "description": "Detects NetNTLM downgrade attack",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1562.001",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_regkey": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains_all": {
                "field": "TargetObject",
                "value": [
                  "SYSTEM\\",
                  "ControlSet",
                  "\\Control\\Lsa"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_value_lmcompatibilitylevel": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\lmcompatibilitylevel",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": [
                  "DWORD (0x00000000)",
                  "DWORD (0x00000001)",
                  "DWORD (0x00000002)"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_value_ntlmminclientsec": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\NtlmMinClientSec",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": [
                  "DWORD (0x00000000)",
                  "DWORD (0x00000010)",
                  "DWORD (0x00000020)",
                  "DWORD (0x00000030)"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_value_restrictsendingntlmtraffic": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\RestrictSendingNTLMTraffic",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_regkey and 1 of selection_value_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_regkey"
            },
            {
              "type": "ref",
              "value": "1 of selection_value_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001",
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), wagga, Nasreddine Bencherchali (Splunk STRT)",
        "date": "2018-03-20",
        "modified": "2024-12-03",
        "references": [
          "https://web.archive.org/web/20171113231705/https://www.optiv.com/blog/post-exploitation-using-netntlm-downgrade-attacks",
          "https://www.ultimatewindowssecurity.com/wiki/page.aspx?spid=NSrpcservers"
        ],
        "falsepositives": [
          "Services or tools that set the values to more restrictive values"
        ],
        "source_file": "sigma_rules/windows/registry/registry_event/registry_event_net_ntlm_downgrade.yml"
      }
    },
    {
      "id": "460479f3-80b7-42da-9c43-2cc1d54dbccd",
      "title": "Creation of a Local Hidden User Account by Registry",
      "status": "test",
      "description": "Sysmon registry detection of a local hidden user account.",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.t1136.001"
      ],
      "logsource": {
        "category": "registry_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\SAM\\SAM\\Domains\\Account\\Users\\Names\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "$\\(Default)",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\lsass.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1136.001"
        ],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "Christian Burkard (Nextron Systems)",
        "date": "2021-05-03",
        "modified": "2025-10-31",
        "references": [
          "https://twitter.com/SBousseaden/status/1387530414185664538"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_event/registry_event_add_local_hidden_user.yml"
      }
    },
    {
      "id": "c74d7efc-8826-45d9-b8bb-f04fac9e4eff",
      "title": "Run Once Task Configuration in Registry",
      "status": "test",
      "description": "Rule to detect the configuration of Run Once registry key. Configured payload can be run by runonce.exe /AlternateShellStartup",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Microsoft\\Active Setup\\Installed Components",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\StubPath",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_chrome": {
            "type": "field_match",
            "matchers": {
              "Details__contains_all": {
                "field": "Details",
                "value": [
                  "C:\\Program Files\\Google\\Chrome\\Application\\",
                  "\\Installer\\chrmstp.exe\" --configure-user-settings --verbose-logging --system-level"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_edge": {
            "type": "field_match",
            "matchers": {
              "Details__contains": {
                "field": "Details",
                "value": [
                  "C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\",
                  "C:\\Program Files\\Microsoft\\Edge\\Application\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "Details__endswith": {
                "field": "Details",
                "value": "\\Installer\\setup.exe\" --configure-user-settings --verbose-logging --system-level --msedge --channel=stable",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Avneet Singh @v3t0_, oscd.community",
        "date": "2020-11-15",
        "modified": "2024-03-25",
        "references": [
          "https://twitter.com/pabraeken/status/990717080805789697",
          "https://lolbas-project.github.io/lolbas/Binaries/Runonce/"
        ],
        "falsepositives": [
          "Legitimate modification of the registry key by legitimate program"
        ],
        "source_file": "sigma_rules/windows/registry/registry_event/registry_event_runonce_persistence.yml"
      }
    },
    {
      "id": "5b175490-b652-4b02-b1de-5b5b4083c5f8",
      "title": "RedMimicry Winnti Playbook Registry Manipulation",
      "status": "test",
      "description": "Detects actions caused by the RedMimicry Winnti playbook",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "HKLM\\SOFTWARE\\Microsoft\\HTMLHelp\\data",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Alexander Rausch",
        "date": "2020-06-24",
        "modified": "2021-11-27",
        "references": [
          "https://redmimicry.com"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_event/registry_event_redmimicry_winnti_reg.yml"
      }
    },
    {
      "id": "5aad0995-46ab-41bd-a9ff-724f41114971",
      "title": "Esentutl Volume Shadow Copy Service Keys",
      "status": "test",
      "description": "Detects the volume shadow copy service initialization and processing via esentutl. Registry keys such as HKLM\\\\System\\\\CurrentControlSet\\\\Services\\\\VSS\\\\Diag\\\\VolSnap\\\\Volume are captured.",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003.002"
      ],
      "logsource": {
        "category": "registry_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "System\\CurrentControlSet\\Services\\VSS",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "esentutl.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "System\\CurrentControlSet\\Services\\VSS\\Start",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.002"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
        "date": "2020-10-20",
        "modified": "2022-12-25",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1003.002/T1003.002.md#atomic-test-3---esentutlexe-sam-copy"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_event/registry_event_esentutl_volume_shadow_copy_service_keys.yml"
      }
    },
    {
      "id": "a6b33c02-8305-488f-8585-03cb2a7763f2",
      "title": "Windows Credential Editor Registry",
      "status": "test",
      "description": "Detects the use of Windows Credential Editor (WCE)",
      "level": "critical",
      "tags": [
        "attack.credential-access",
        "attack.t1003.001",
        "attack.s0005"
      ],
      "logsource": {
        "category": "registry_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "Services\\WCESERVICE\\Start",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.001"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2019-12-31",
        "modified": "2021-11-27",
        "references": [
          "https://www.ampliasecurity.com/research/windows-credentials-editor/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_event/registry_event_hack_wce_reg.yml"
      }
    },
    {
      "id": "67a6c006-3fbe-46a7-9074-2ba3b82c3000",
      "title": "Path To Screensaver Binary Modified",
      "status": "test",
      "description": "Detects value modification of registry key containing path to binary used as screensaver.",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.privilege-escalation",
        "attack.t1546.002"
      ],
      "logsource": {
        "category": "registry_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Control Panel\\Desktop\\SCRNSAVE.EXE",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\rundll32.exe",
                  "\\explorer.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1546.002"
        ],
        "tactics": [
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Bartlomiej Czyz @bczyz1, oscd.community",
        "date": "2020-10-11",
        "modified": "2021-11-27",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1546.002/T1546.002.md",
          "https://www.welivesecurity.com/wp-content/uploads/2017/08/eset-gazer.pdf"
        ],
        "falsepositives": [
          "Legitimate modification of screensaver"
        ],
        "source_file": "sigma_rules/windows/registry/registry_event/registry_event_modify_screensaver_binary_path.yml"
      }
    },
    {
      "id": "7f4c43f9-b1a5-4c7d-b24a-b41bf3a3ebf2",
      "title": "Registry Tampering by Potentially Suspicious Processes",
      "status": "experimental",
      "description": "Detects suspicious registry modifications made by suspicious processes such as script engine processes such as WScript, or CScript etc.\nThese processes are rarely used for legitimate registry modifications, and their activity may indicate an attempt to modify the registry\nwithout using standard tools like regedit.exe or reg.exe, potentially for evasion and persistence.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.persistence",
        "attack.execution",
        "attack.t1112",
        "attack.t1059.005"
      ],
      "logsource": {
        "category": "registry_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\mshta.exe",
                  "\\wscript.exe",
                  "\\cscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1112",
          "T1059.005"
        ],
        "tactics": [
          "defense_evasion",
          "persistence",
          "execution"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-08-13",
        "modified": "",
        "references": [
          "https://www.nextron-systems.com/2025/07/29/detecting-the-most-popular-mitre-persistence-method-registry-run-keys-startup-folder/",
          "https://www.linkedin.com/posts/mauricefielenbach_livingofftheland-redteam-persistence-activity-7344801774182051843-TE00/"
        ],
        "falsepositives": [
          "Some legitimate admin or install scripts may use these processes for registry modifications."
        ],
        "source_file": "sigma_rules/windows/registry/registry_event/registry_event_susp_process_registry_modification.yml"
      }
    },
    {
      "id": "ac8866c7-ce44-46fd-8c17-b24acff96ca8",
      "title": "HybridConnectionManager Service Installation - Registry",
      "status": "test",
      "description": "Detects the installation of the Azure Hybrid Connection Manager service to allow remote code execution from Azure function.",
      "level": "high",
      "tags": [
        "attack.resource-development",
        "attack.t1608"
      ],
      "logsource": {
        "category": "registry_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection1": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Services\\HybridConnectionManager",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection2": {
            "type": "field_match",
            "matchers": {
              "EventType": {
                "field": "EventType",
                "value": "SetValue",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Details__contains": {
                "field": "Details",
                "value": "Microsoft.HybridConnectionManager.Listener.exe",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection1 or selection2",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection1",
            "selection2"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1608"
        ],
        "tactics": [
          "resource_development"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
        "date": "2021-04-12",
        "modified": "2022-11-27",
        "references": [
          "https://twitter.com/Cyb3rWard0g/status/1381642789369286662"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_event/registry_event_hybridconnectionmgr_svc_installation.yml"
      }
    },
    {
      "id": "5a9e1b2c-8f7d-4a1e-9b3c-0f6d7e5a4b1f",
      "title": "Windows Defender Threat Severity Default Action Modified",
      "status": "experimental",
      "description": "Detects modifications or creations of Windows Defender's default threat action settings based on severity to 'allow' or take 'no action'.\nThis is a highly suspicious configuration change that effectively disables Defender's ability to automatically mitigate threats of a certain severity level,\nallowing malicious software to run unimpeded. An attacker might use this technique to bypass defenses before executing payloads.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "registry_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Microsoft\\Windows Defender\\Threats\\ThreatSeverityDefaultAction\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "\\1",
                  "\\2",
                  "\\4",
                  "\\5"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": [
                  "DWORD (0x00000006)",
                  "DWORD (0x00000009)"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Matt Anderson (Huntress)",
        "date": "2025-07-11",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/powershell/module/defender/set-mppreference",
          "https://learn.microsoft.com/en-us/windows-hardware/customize/desktop/unattend/security-malware-windows-defender-threatseveritydefaultaction",
          "https://research.splunk.com/endpoint/7215831c-8252-4ae3-8d43-db588e82f952",
          "https://gist.github.com/Dump-GUY/8daef859f382b895ac6fd0cf094555d2",
          "https://thedfirreport.com/2021/10/18/icedid-to-xinglocker-ransomware-in-24-hours/"
        ],
        "falsepositives": [
          "Legitimate administration via scripts or tools (e.g., SCCM, Intune, GPO enforcement). Correlate with administrative activity.",
          "Software installations that legitimately modify Defender settings (less common for these specific keys)."
        ],
        "source_file": "sigma_rules/windows/registry/registry_event/registry_event_defender_threat_action_modified.yml"
      }
    },
    {
      "id": "f7f9ab88-7557-4a69-b30e-0a8f91b3a0e7",
      "title": "Registry Entries For Azorult Malware",
      "status": "test",
      "description": "Detects the presence of a registry key created during Azorult execution",
      "level": "critical",
      "tags": [
        "attack.defense-evasion",
        "attack.persistence",
        "attack.execution",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": [
                  12,
                  13
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "SYSTEM\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\services\\localNETService",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "defense_evasion",
          "persistence",
          "execution"
        ]
      },
      "meta": {
        "author": "Trent Liffick",
        "date": "2020-05-08",
        "modified": "2021-11-27",
        "references": [
          "https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/trojan.win32.azoruit.a"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_event/registry_event_mal_azorult.yml"
      }
    },
    {
      "id": "277efb8f-60be-4f10-b4d3-037802f37167",
      "title": "Registry Persistence Mechanisms in Recycle Bin",
      "status": "test",
      "description": "Detects persistence registry keys for Recycle Bin",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547"
      ],
      "logsource": {
        "category": "registry_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_create": {
            "type": "field_match",
            "matchers": {
              "EventType": {
                "field": "EventType",
                "value": "RenameKey",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "NewName__contains": {
                "field": "NewName",
                "value": "\\CLSID\\{645FF040-5081-101B-9F08-00AA002F954E}\\shell\\open",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_set": {
            "type": "field_match",
            "matchers": {
              "EventType": {
                "field": "EventType",
                "value": "SetValue",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\CLSID\\{645FF040-5081-101B-9F08-00AA002F954E}\\shell\\open\\command\\(Default)",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1547"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-11-18",
        "modified": "2022-12-06",
        "references": [
          "https://github.com/vxunderground/VXUG-Papers/blob/751edb8d50f95bd7baa730adf2c6c3bb1b034276/The%20Persistence%20Series/Persistence%20via%20Recycle%20Bin/Persistence_via_Recycle_Bin.pdf",
          "https://persistence-info.github.io/Data/recyclebin.html",
          "https://www.hexacorn.com/blog/2018/05/28/beyond-good-ol-run-key-part-78-2/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_event/registry_event_persistence_recycle_bin.yml"
      }
    },
    {
      "id": "152f3630-77c1-4284-bcc0-4cc68ab2f6e7",
      "title": "Shell Open Registry Keys Manipulation",
      "status": "test",
      "description": "Detects the shell open key manipulation (exefile and ms-settings) used for persistence and the pattern of UAC Bypass using fodhelper.exe, computerdefaults.exe, slui.exe via registry keys (e.g. UACMe 33 or 62)",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548.002",
        "attack.t1546.001"
      ],
      "logsource": {
        "category": "registry_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection1": {
            "type": "field_match",
            "matchers": {
              "EventType": {
                "field": "EventType",
                "value": "SetValue",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "Classes\\ms-settings\\shell\\open\\command\\SymbolicLinkValue",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__contains": {
                "field": "Details",
                "value": "\\Software\\Classes\\{",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection2": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "Classes\\ms-settings\\shell\\open\\command\\DelegateExecute",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection3": {
            "type": "field_match",
            "matchers": {
              "EventType": {
                "field": "EventType",
                "value": "SetValue",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "Classes\\ms-settings\\shell\\open\\command\\(Default)",
                  "Classes\\exefile\\shell\\open\\command\\(Default)"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_sel3": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": "(Empty)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection1 or selection2 or (selection3 and not filter_sel3)",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection1",
            "selection2",
            "(selection3 and not filter_sel3)"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002",
          "T1546.001"
        ],
        "tactics": [
          "persistence",
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Christian Burkard (Nextron Systems)",
        "date": "2021-08-30",
        "modified": "2022-01-13",
        "references": [
          "https://github.com/hfiref0x/UACME",
          "https://winscripting.blog/2017/05/12/first-entry-welcome-and-uac-bypass/",
          "https://github.com/RhinoSecurityLabs/Aggressor-Scripts/tree/master/UACBypass",
          "https://tria.ge/211119-gs7rtshcfr/behavioral2 [Lokibot sample from Nov 2021]"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_event/registry_event_shell_open_keys_manipulation.yml"
      }
    },
    {
      "id": "55e29995-75e7-451a-bef0-6225e2f13597",
      "title": "Potential Credential Dumping Via LSASS SilentProcessExit Technique",
      "status": "test",
      "description": "Detects changes to the Registry in which a monitor program gets registered to dump the memory of the lsass.exe process",
      "level": "critical",
      "tags": [
        "attack.credential-access",
        "attack.t1003.001"
      ],
      "logsource": {
        "category": "registry_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "Microsoft\\Windows NT\\CurrentVersion\\SilentProcessExit\\lsass.exe",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.001"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-02-26",
        "modified": "2022-12-19",
        "references": [
          "https://www.deepinstinct.com/2021/02/16/lsass-memory-dumps-are-stealthier-than-ever-before-part-2/",
          "https://oddvar.moe/2018/04/10/persistence-using-globalflags-in-image-file-execution-options-hidden-from-autoruns-exe/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/registry/registry_event/registry_event_silentprocessexit_lsass.yml"
      }
    }
  ]
}