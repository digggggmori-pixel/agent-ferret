{
  "metadata": {
    "logsource": "windows_file_rename",
    "rule_count": 1,
    "compiled_at": "2026-02-04T12:28:36.390750",
    "version": "1.1"
  },
  "rules": [
    {
      "id": "e3f673b3-65d1-4d80-9146-466f8b63fa99",
      "title": "Suspicious Appended Extension",
      "status": "test",
      "description": "Detects file renames where the target filename uses an uncommon double extension. Could indicate potential ransomware activity renaming files and adding a custom extension to the encrypted files, such as \".jpg.crypted\", \".docx.locky\", etc.",
      "level": "medium",
      "tags": [
        "attack.impact",
        "attack.t1486"
      ],
      "logsource": {
        "category": "file_rename",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "SourceFilename__endswith": {
                "field": "SourceFilename",
                "value": [
                  ".doc",
                  ".docx",
                  ".jpeg",
                  ".jpg",
                  ".lnk",
                  ".pdf",
                  ".png",
                  ".pst",
                  ".rtf",
                  ".xls",
                  ".xlsx"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  ".doc.",
                  ".docx.",
                  ".jpeg.",
                  ".jpg.",
                  ".lnk.",
                  ".pdf.",
                  ".png.",
                  ".pst.",
                  ".rtf.",
                  ".xls.",
                  ".xlsx."
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_generic": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".backup",
                  ".bak",
                  ".old",
                  ".orig",
                  ".temp",
                  ".tmp"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_anaconda": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": ":\\ProgramData\\Anaconda3\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".c~",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1486"
        ],
        "tactics": [
          "impact"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-07-16",
        "modified": "2023-11-11",
        "references": [
          "https://app.any.run/tasks/d66ead5a-faf4-4437-93aa-65785afaf9e5/",
          "https://blog.cyble.com/2022/08/10/onyx-ransomware-renames-its-leak-site-to-vsop/"
        ],
        "falsepositives": [
          "Backup software"
        ],
        "source_file": "sigma_rules/windows/file/file_rename/file_rename_win_ransomware.yml"
      }
    }
  ]
}