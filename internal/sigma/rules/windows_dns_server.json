{
  "metadata": {
    "logsource": "windows_dns_server",
    "rule_count": 2,
    "compiled_at": "2026-02-04T12:28:36.368782",
    "version": "1.1"
  },
  "rules": [
    {
      "id": "6d444368-6da1-43fe-b2fc-44202430480e",
      "title": "Failed DNS Zone Transfer",
      "status": "test",
      "description": "Detects when a DNS zone transfer failed.",
      "level": "medium",
      "tags": [
        "attack.reconnaissance",
        "attack.t1590.002"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "dns-server"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 6004,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1590.002"
        ],
        "tactics": [
          "reconnaissance"
        ]
      },
      "meta": {
        "author": "Zach Mathis",
        "date": "2023-05-24",
        "modified": "",
        "references": [
          "https://kb.eventtracker.com/evtpass/evtpages/EventId_6004_Microsoft-Windows-DNS-Server-Service_65410.asp"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/builtin/dns_server/win_dns_server_failed_dns_zone_transfer.yml"
      }
    },
    {
      "id": "cbe51394-cd93-4473-b555-edf0144952d9",
      "title": "DNS Server Error Failed Loading the ServerLevelPluginDLL",
      "status": "test",
      "description": "Detects a DNS server error in which a specified plugin DLL (in registry) could not be loaded",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1574.001"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "dns-server"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": [
                  150,
                  770,
                  771
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1574.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2017-05-08",
        "modified": "2023-02-05",
        "references": [
          "https://medium.com/@esnesenon/feature-not-bug-dnsadmin-to-dc-compromise-in-one-line-a0f779b8dc83",
          "https://technet.microsoft.com/en-us/library/cc735829(v=ws.10).aspx",
          "https://twitter.com/gentilkiwi/status/861641945944391680"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/builtin/dns_server/win_dns_server_susp_server_level_plugin_dll.yml"
      }
    }
  ]
}