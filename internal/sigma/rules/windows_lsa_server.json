{
  "metadata": {
    "logsource": "windows_lsa_server",
    "rule_count": 1,
    "compiled_at": "2026-02-04T12:28:36.404438",
    "version": "1.1"
  },
  "rules": [
    {
      "id": "7ac407cc-0f48-4328-aede-de1d2e6fef41",
      "title": "Standard User In High Privileged Group",
      "status": "test",
      "description": "Detect standard users login that are part of high privileged groups such as the Administrator group",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.privilege-escalation"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "lsa-server"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "EventID": {
                "field": "EventID",
                "value": 300,
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetUserSid__startswith": {
                "field": "TargetUserSid",
                "value": "S-1-5-21-",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "SidList__contains": {
                "field": "SidList",
                "value": [
                  "S-1-5-32-544",
                  "-500}",
                  "-518}",
                  "-519}"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_admin": {
            "type": "field_match",
            "matchers": {
              "TargetUserSid__endswith": {
                "field": "TargetUserSid",
                "value": [
                  "-500",
                  "-518",
                  "-519"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "credential_access",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2023-01-13",
        "modified": "2023-05-05",
        "references": [
          "https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/manage/understand-security-identifiers",
          "https://learn.microsoft.com/en-us/windows-server/security/credentials-protection-and-management/configuring-additional-lsa-protection",
          "https://github.com/nasbench/EVTX-ETW-Resources/blob/7a806a148b3d9d381193d4a80356016e6e8b1ee8/ETWProvidersManifests/Windows11/22H2/W11_22H2_Pro_20221220_22621.963/WEPExplorer/LsaSrv.xml"
        ],
        "falsepositives": [
          "Standard domain users who are part of the administrator group. These users shouldn't have these right. But in the case where it's necessary. They should be filtered out using the \"TargetUserName\" field"
        ],
        "source_file": "sigma_rules/windows/builtin/lsa_server/win_lsa_server_normal_user_admin.yml"
      }
    }
  ]
}