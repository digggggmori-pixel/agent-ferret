{
  "metadata": {
    "logsource": "windows_file_access",
    "rule_count": 7,
    "compiled_at": "2026-02-04T12:28:36.373061",
    "version": "1.1"
  },
  "rules": [
    {
      "id": "f41b0311-44f9-44f0-816d-dd45e39d4bc8",
      "title": "Access To Crypto Currency Wallets By Uncommon Applications",
      "status": "test",
      "description": "Detects file access requests to crypto currency files by uncommon processes.\nCould indicate potential attempt of crypto currency wallet stealing.\n",
      "level": "medium",
      "tags": [
        "attack.t1003",
        "attack.credential-access"
      ],
      "logsource": {
        "category": "file_access",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "FileName__contains": {
                    "field": "FileName",
                    "value": [
                      "\\AppData\\Roaming\\Ethereum\\keystore\\",
                      "\\AppData\\Roaming\\EthereumClassic\\keystore\\",
                      "\\AppData\\Roaming\\monero\\wallets\\"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "FileName__endswith": {
                    "field": "FileName",
                    "value": [
                      "\\AppData\\Roaming\\Bitcoin\\wallet.dat",
                      "\\AppData\\Roaming\\BitcoinABC\\wallet.dat",
                      "\\AppData\\Roaming\\BitcoinSV\\wallet.dat",
                      "\\AppData\\Roaming\\DashCore\\wallet.dat",
                      "\\AppData\\Roaming\\DogeCoin\\wallet.dat",
                      "\\AppData\\Roaming\\Litecoin\\wallet.dat",
                      "\\AppData\\Roaming\\Ripple\\wallet.dat",
                      "\\AppData\\Roaming\\Zcash\\wallet.dat"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_main_system": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "System",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_generic": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\",
                  "C:\\Program Files\\",
                  "C:\\Windows\\system32\\",
                  "C:\\Windows\\SysWOW64\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_defender": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\ProgramData\\Microsoft\\Windows Defender\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\MpCopyAccelerator.exe",
                  "\\MsMpEng.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1003"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "X__Junior (Nextron Systems)",
        "date": "2024-07-29",
        "modified": "",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Antivirus, Anti-Spyware, Anti-Malware Software",
          "Backup software",
          "Legitimate software installed on partitions other than \"C:\\\"",
          "Searching software such as \"everything.exe\""
        ],
        "source_file": "sigma_rules/windows/file/file_access/file_access_win_susp_crypto_currency_wallets.yml"
      }
    },
    {
      "id": "407aecb1-e762-4acf-8c7b-d087bcff3bb6",
      "title": "Credential Manager Access By Uncommon Applications",
      "status": "test",
      "description": "Detects suspicious processes based on name and location that access the windows credential manager and vault.\nWhich can be a sign of credential stealing. Example case would be usage of mimikatz \"dpapi::cred\" function\n",
      "level": "medium",
      "tags": [
        "attack.t1003",
        "attack.credential-access"
      ],
      "logsource": {
        "category": "file_access",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "FileName__contains": {
                "field": "FileName",
                "value": [
                  "\\AppData\\Local\\Microsoft\\Credentials\\",
                  "\\AppData\\Roaming\\Microsoft\\Credentials\\",
                  "\\AppData\\Local\\Microsoft\\Vault\\",
                  "\\ProgramData\\Microsoft\\Vault\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_system_folders": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\",
                  "C:\\Program Files (x86)\\",
                  "C:\\Windows\\system32\\",
                  "C:\\Windows\\SysWOW64\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1003"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-10-11",
        "modified": "2024-07-29",
        "references": [
          "https://hunter2.gitbook.io/darthsidious/privilege-escalation/mimikatz",
          "https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/"
        ],
        "falsepositives": [
          "Legitimate software installed by the users for example in the \"AppData\" directory may access these files (for any reason)."
        ],
        "source_file": "sigma_rules/windows/file/file_access/file_access_win_susp_credential_manager_access.yml"
      }
    },
    {
      "id": "a1dfd976-4852-41d4-9507-dc6590a3ccd0",
      "title": "Suspicious File Access to Browser Credential Storage",
      "status": "experimental",
      "description": "Detects file access to browser credential storage paths by non-browser processes, which may indicate credential access attempts.\nAdversaries may attempt to access browser credential storage to extract sensitive information such as usernames and passwords or cookies.\nThis behavior is often commonly observed in credential stealing malware.\n",
      "level": "low",
      "tags": [
        "attack.credential-access",
        "attack.t1555.003",
        "attack.discovery",
        "attack.t1217"
      ],
      "logsource": {
        "category": "file_access",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_browser_paths": {
            "type": "field_match",
            "matchers": {
              "FileName__contains": {
                "field": "FileName",
                "value": [
                  "\\Sputnik\\Sputnik",
                  "\\MapleStudio\\ChromePlus",
                  "\\QIP Surf",
                  "\\BlackHawk",
                  "\\7Star\\7Star",
                  "\\CatalinaGroup\\Citrio",
                  "\\Google\\Chrome",
                  "\\Coowon\\Coowon",
                  "\\CocCoc\\Browser",
                  "\\uCozMedia\\Uran",
                  "\\Tencent\\QQBrowser",
                  "\\Orbitum",
                  "\\Slimjet",
                  "\\Iridium",
                  "\\Vivaldi",
                  "\\Chromium",
                  "\\GhostBrowser",
                  "\\CentBrowser",
                  "\\Xvast",
                  "\\Chedot",
                  "\\SuperBird",
                  "\\360Browser\\Browser",
                  "\\360Chrome\\Chrome",
                  "\\Comodo\\Dragon",
                  "\\BraveSoftware\\Brave-Browser",
                  "\\Torch",
                  "\\UCBrowser\\",
                  "\\Blisk",
                  "\\Epic Privacy Browser",
                  "\\Nichrome",
                  "\\Amigo",
                  "\\Kometa",
                  "\\Xpom",
                  "\\Microsoft\\Edge",
                  "\\Liebao7Default\\EncryptedStorage",
                  "\\AVAST Software\\Browser",
                  "\\Kinza",
                  "\\Mozilla\\SeaMonkey\\",
                  "\\Comodo\\IceDragon\\",
                  "\\8pecxstudios\\Cyberfox\\",
                  "\\FlashPeak\\SlimBrowser\\",
                  "\\Moonchild Productions\\Pale Moon\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_browser_subpaths": {
            "type": "field_match",
            "matchers": {
              "FileName__contains": {
                "field": "FileName",
                "value": [
                  "\\Profiles\\",
                  "\\User Data"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cred_files": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "FileName__contains": {
                    "field": "FileName",
                    "value": [
                      "\\Login Data",
                      "\\Cookies",
                      "\\EncryptedStorage",
                      "\\WebCache\\"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "FileName__endswith": {
                    "field": "FileName",
                    "value": [
                      "cert9.db",
                      "cookies.sqlite",
                      "formhistory.sqlite",
                      "key3.db",
                      "key4.db",
                      "Login Data.sqlite",
                      "logins.json",
                      "places.sqlite"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_main_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\Sputnik.exe",
                  "\\ChromePlus.exe",
                  "\\QIP Surf.exe",
                  "\\BlackHawk.exe",
                  "\\7Star.exe",
                  "\\Sleipnir5.exe",
                  "\\Citrio.exe",
                  "\\Chrome SxS.exe",
                  "\\Chrome.exe",
                  "\\Coowon.exe",
                  "\\CocCocBrowser.exe",
                  "\\Uran.exe",
                  "\\QQBrowser.exe",
                  "\\Orbitum.exe",
                  "\\Slimjet.exe",
                  "\\Iridium.exe",
                  "\\Vivaldi.exe",
                  "\\Chromium.exe",
                  "\\GhostBrowser.exe",
                  "\\CentBrowser.exe",
                  "\\Xvast.exe",
                  "\\Chedot.exe",
                  "\\SuperBird.exe",
                  "\\360Browser.exe",
                  "\\360Chrome.exe",
                  "\\dragon.exe",
                  "\\brave.exe",
                  "\\torch.exe",
                  "\\UCBrowser.exe",
                  "\\BliskBrowser.exe",
                  "\\Epic Privacy Browser.exe",
                  "\\nichrome.exe",
                  "\\AmigoBrowser.exe",
                  "\\KometaBrowser.exe",
                  "\\XpomBrowser.exe",
                  "\\msedge.exe",
                  "\\LiebaoBrowser.exe",
                  "\\AvastBrowser.exe",
                  "\\Kinza.exe",
                  "\\seamonkey.exe",
                  "\\icedragon.exe",
                  "\\cyberfox.exe",
                  "\\SlimBrowser.exe",
                  "\\palemoon.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_path": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  "\\Sputnik\\",
                  "\\MapleStudio\\",
                  "\\QIP Surf\\",
                  "\\BlackHawk\\",
                  "\\7Star\\",
                  "\\Fenrir Inc\\",
                  "\\CatalinaGroup\\",
                  "\\Google\\",
                  "\\Coowon\\",
                  "\\CocCoc\\",
                  "\\uCozMedia\\",
                  "\\Tencent\\",
                  "\\Orbitum\\",
                  "\\Slimjet\\",
                  "\\Iridium\\",
                  "\\Vivaldi\\",
                  "\\Chromium\\",
                  "\\GhostBrowser\\",
                  "\\CentBrowser\\",
                  "\\Xvast\\",
                  "\\Chedot\\",
                  "\\SuperBird\\",
                  "\\360Browser\\",
                  "\\360Chrome\\",
                  "\\Comodo\\",
                  "\\BraveSoftware\\",
                  "\\Torch\\",
                  "\\UCBrowser\\",
                  "\\Blisk\\",
                  "\\Epic Privacy Browser\\",
                  "\\Nichrome\\",
                  "\\Amigo\\",
                  "\\Kometa\\",
                  "\\Xpom\\",
                  "\\Microsoft\\",
                  "\\Liebao7\\",
                  "\\AVAST Software\\",
                  "\\Kinza\\",
                  "\\Mozilla\\",
                  "\\8pecxstudios\\",
                  "\\FlashPeak\\",
                  "\\Moonchild Productions\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_system": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "System",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "ParentImage": {
                "field": "ParentImage",
                "value": "Idle",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_generic": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\",
                  "C:\\Program Files (x86)\\",
                  "C:\\Windows\\System32\\",
                  "C:\\Windows\\SysWOW64\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_defender": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": "\\Microsoft\\Windows Defender\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\MpCopyAccelerator.exe",
                  "\\MsMpEng.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_thor": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\thor.exe",
                  "\\thor64.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_msiexec": {
            "type": "field_match",
            "matchers": {
              "ParentImage": {
                "field": "ParentImage",
                "value": "C:\\Windows\\System32\\msiexec.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_other": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\everything.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "all of selection_*"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1555.003",
          "T1217"
        ],
        "tactics": [
          "credential_access",
          "discovery"
        ]
      },
      "meta": {
        "author": "frack113, X__Junior (Nextron Systems), Swachchhanda Shrawan Poudel (Nextron Systems), Parth-FourCore",
        "date": "2025-05-22",
        "modified": "",
        "references": [
          "https://github.com/splunk/security_content/blob/7283ba3723551f46b69dfeb23a63b358afb2cb0e/lookups/browser_app_list.csv?plain=1",
          "https://fourcore.io/blogs/threat-hunting-browser-credential-stealing"
        ],
        "falsepositives": [
          "Antivirus, Anti-Spyware, Anti-Malware Software",
          "Legitimate software accessing browser data for synchronization or backup purposes.",
          "Legitimate software installed on partitions other than \"C:\\\""
        ],
        "source_file": "sigma_rules/windows/file/file_access/file_access_win_susp_process_access_browser_cred_files.yml"
      }
    },
    {
      "id": "d51694fe-484a-46ac-92d6-969e76d60d10",
      "title": "Access To Potentially Sensitive Sysvol Files By Uncommon Applications",
      "status": "test",
      "description": "Detects file access requests to potentially sensitive files hosted on the Windows Sysvol share.",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.t1552.006"
      ],
      "logsource": {
        "category": "file_access",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "FileName__startswith": {
                "field": "FileName",
                "value": "\\\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "FileName__contains_all": {
                "field": "FileName",
                "value": [
                  "\\sysvol\\",
                  "\\Policies\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "FileName__endswith": {
                "field": "FileName",
                "value": [
                  "audit.csv",
                  "Files.xml",
                  "GptTmpl.inf",
                  "groups.xml",
                  "Registry.pol",
                  "Registry.xml",
                  "scheduledtasks.xml",
                  "scripts.ini",
                  "services.xml"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_generic": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\",
                  "C:\\Program Files\\",
                  "C:\\Windows\\system32\\",
                  "C:\\Windows\\SysWOW64\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_explorer": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\explorer.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1552.006"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2023-12-21",
        "modified": "2024-07-29",
        "references": [
          "https://github.com/vletoux/pingcastle"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_access/file_access_win_susp_gpo_files.yml"
      }
    },
    {
      "id": "46612ae6-86be-4802-bc07-39b59feb1309",
      "title": "Access To Windows DPAPI Master Keys By Uncommon Applications",
      "status": "test",
      "description": "Detects file access requests to the the Windows Data Protection API Master keys by an uncommon application.\nThis can be a sign of credential stealing. Example case would be usage of mimikatz \"dpapi::masterkey\" function\n",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.t1555.004"
      ],
      "logsource": {
        "category": "file_access",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "FileName__contains": {
                "field": "FileName",
                "value": [
                  "\\Microsoft\\Protect\\S-1-5-18\\",
                  "\\Microsoft\\Protect\\S-1-5-21-"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_system_folders": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\",
                  "C:\\Program Files (x86)\\",
                  "C:\\Windows\\system32\\",
                  "C:\\Windows\\SysWOW64\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1555.004"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-10-17",
        "modified": "2024-07-29",
        "references": [
          "http://blog.harmj0y.net/redteaming/operational-guidance-for-offensive-user-dpapi-abuse/",
          "https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation/dpapi-extracting-passwords"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_access/file_access_win_susp_dpapi_master_key_access.yml"
      }
    },
    {
      "id": "7a2a22ea-a203-4cd3-9abf-20eb1c5c6cd2",
      "title": "Access To Windows Credential History File By Uncommon Applications",
      "status": "test",
      "description": "Detects file access requests to the Windows Credential History File by an uncommon application.\nThis can be a sign of credential stealing. Example case would be usage of mimikatz \"dpapi::credhist\" function\n",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.t1555.004"
      ],
      "logsource": {
        "category": "file_access",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "FileName__endswith": {
                "field": "FileName",
                "value": "\\Microsoft\\Protect\\CREDHIST",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_system_folders": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\",
                  "C:\\Program Files (x86)\\",
                  "C:\\Windows\\system32\\",
                  "C:\\Windows\\SysWOW64\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_explorer": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\explorer.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1555.004"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-10-17",
        "modified": "2024-07-29",
        "references": [
          "https://tools.thehacker.recipes/mimikatz/modules/dpapi/credhist",
          "https://www.passcape.com/windows_password_recovery_dpapi_credhist"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_access/file_access_win_susp_credhist.yml"
      }
    },
    {
      "id": "65744385-8541-44a6-8630-ffc824d7d4cc",
      "title": "Microsoft Teams Sensitive File Access By Uncommon Applications",
      "status": "test",
      "description": "Detects file access attempts to sensitive Microsoft teams files (leveldb, cookies) by an uncommon process.\n",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.t1528"
      ],
      "logsource": {
        "category": "file_access",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "FileName__contains": {
                "field": "FileName",
                "value": [
                  "\\Microsoft\\Teams\\Cookies",
                  "\\Microsoft\\Teams\\Local Storage\\leveldb"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_legit_location": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\Microsoft\\Teams\\current\\Teams.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1528"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "@SerkinValery",
        "date": "2024-07-22",
        "modified": "",
        "references": [
          "https://www.bleepingcomputer.com/news/security/microsoft-teams-stores-auth-tokens-as-cleartext-in-windows-linux-macs/",
          "https://www.vectra.ai/blog/undermining-microsoft-teams-security-by-mining-tokens"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_access/file_access_win_teams_sensitive_files.yml"
      }
    }
  ]
}