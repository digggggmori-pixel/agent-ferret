{
  "metadata": {
    "logsource": "windows_file_event",
    "rule_count": 162,
    "compiled_at": "2026-02-04T12:28:36.377601",
    "version": "1.1"
  },
  "rules": [
    {
      "id": "fcc6d700-68d9-4241-9a1a-06874d621b06",
      "title": "Suspicious File Created Via OneNote Application",
      "status": "test",
      "description": "Detects suspicious files created via the OneNote application. This could indicate a potential malicious \".one\"/\".onepkg\" file was executed as seen being used in malware activity in the wild",
      "level": "high",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\onenote.exe",
                  "\\onenotem.exe",
                  "\\onenoteim.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\AppData\\Local\\Temp\\OneNote\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".bat",
                  ".chm",
                  ".cmd",
                  ".dll",
                  ".exe",
                  ".hta",
                  ".htm",
                  ".html",
                  ".js",
                  ".lnk",
                  ".ps1",
                  ".vbe",
                  ".vbs",
                  ".wsf"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-02-09",
        "modified": "2023-02-27",
        "references": [
          "https://www.bleepingcomputer.com/news/security/hackers-now-use-microsoft-onenote-attachments-to-spread-malware/",
          "https://blog.osarmor.com/319/onenote-attachment-delivers-asyncrat-malware/",
          "https://twitter.com/MaD_c4t/status/1623414582382567424",
          "https://labs.withsecure.com/publications/detecting-onenote-abuse",
          "https://www.trustedsec.com/blog/new-attacks-old-tricks-how-onenote-malware-is-evolving/",
          "https://app.any.run/tasks/17f2d378-6d11-4d6f-8340-954b04f35e83/"
        ],
        "falsepositives": [
          "False positives should be very low with the extensions list cited. Especially if you don't heavily utilize OneNote.",
          "Occasional FPs might occur if OneNote is used internally to share different embedded documents"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_office_onenote_susp_dropped_files.yml"
      }
    },
    {
      "id": "409f8a98-4496-4aaa-818a-c931c0a8b832",
      "title": "Created Files by Microsoft Sync Center",
      "status": "test",
      "description": "This rule detects suspicious files created by Microsoft Sync Center (mobsync)",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.t1055",
        "attack.t1218",
        "attack.execution",
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_mobsync": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\mobsync.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_created_file": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".dll",
                  ".exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection_mobsync and filter_created_file",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_mobsync"
            },
            {
              "type": "ref",
              "value": "filter_created_file"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1055",
          "T1218"
        ],
        "tactics": [
          "privilege_escalation",
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "elhoim",
        "date": "2022-04-28",
        "modified": "2022-06-02",
        "references": [
          "https://redcanary.com/blog/intelligence-insights-november-2021/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_susp_creation_by_mobsync.yml"
      }
    },
    {
      "id": "56e05d41-ce99-4ecd-912d-93f019ee0b71",
      "title": "Visual Studio Code Tunnel Remote File Creation",
      "status": "test",
      "description": "Detects the creation of file by the \"node.exe\" process in the \".vscode-server\" directory. Could be a sign of remote file creation via VsCode tunnel feature\n",
      "level": "medium",
      "tags": [
        "attack.command-and-control"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": "\\servers\\Stable-",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\server\\node.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\.vscode-server\\data\\User\\History\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-10-25",
        "modified": "",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_vscode_tunnel_remote_creation_artefacts.yml"
      }
    },
    {
      "id": "4aafb0fa-bff5-4b9d-b99e-8093e659c65f",
      "title": "Writing Local Admin Share",
      "status": "test",
      "description": "Aversaries may use to interact with a remote network share using Server Message Block (SMB).\nThis technique is used by post-exploitation frameworks.\n",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.lateral-movement",
        "attack.t1546.002"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains_all": {
                "field": "TargetFilename",
                "value": [
                  "\\\\\\\\127.0.0",
                  "\\ADMIN$\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1546.002"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-01",
        "modified": "2022-08-13",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1021.002/T1021.002.md#atomic-test-4---execute-command-writing-output-to-local-admin-share"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_writing_local_admin_share.yml"
      }
    },
    {
      "id": "7280c9f3-a5af-45d0-916a-bc01cb4151c9",
      "title": "Suspicious MSExchangeMailboxReplication ASPX Write",
      "status": "test",
      "description": "Detects suspicious activity in which the MSExchangeMailboxReplication process writes .asp and .apsx files to disk, which could be a sign of ProxyShell exploitation",
      "level": "high",
      "tags": [
        "attack.initial-access",
        "attack.t1190",
        "attack.persistence",
        "attack.t1505.003"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\MSExchangeMailboxReplication.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".aspx",
                  ".asp"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1190",
          "T1505.003"
        ],
        "tactics": [
          "initial_access",
          "persistence"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-02-25",
        "modified": "",
        "references": [
          "https://redcanary.com/blog/blackbyte-ransomware/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_susp_exchange_aspx_write.yml"
      }
    },
    {
      "id": "cd8b36ac-8e4a-4c2f-a402-a29b8fbd5bca",
      "title": "Suspicious File Creation Activity From Fake Recycle.Bin Folder",
      "status": "test",
      "description": "Detects file write event from/to a fake recycle bin folder that is often used as a staging directory for malware",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__contains": {
                    "field": "Image",
                    "value": [
                      "RECYCLERS.BIN\\",
                      "RECYCLER.BIN\\"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "TargetFilename__contains": {
                    "field": "TargetFilename",
                    "value": [
                      "RECYCLERS.BIN\\",
                      "RECYCLER.BIN\\"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "X__Junior (Nextron Systems)",
        "date": "2023-07-12",
        "modified": "2023-12-11",
        "references": [
          "https://www.mandiant.com/resources/blog/infected-usb-steal-secrets",
          "https://unit42.paloaltonetworks.com/cloaked-ursa-phishing/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_susp_recycle_bin_fake_exec.yml"
      }
    },
    {
      "id": "68578b43-65df-4f81-9a9b-92f32711a951",
      "title": "UAC Bypass Using Windows Media Player - File",
      "status": "test",
      "description": "Detects the pattern of UAC Bypass using Windows Media Player osksupport.dll (UACMe 32)",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection1": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": "C:\\Users\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "\\AppData\\Local\\Temp\\OskSupport.dll",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection2": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\system32\\DllHost.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetFilename": {
                "field": "TargetFilename",
                "value": "C:\\Program Files\\Windows Media Player\\osk.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Christian Burkard (Nextron Systems)",
        "date": "2021-08-23",
        "modified": "2022-10-09",
        "references": [
          "https://github.com/hfiref0x/UACME"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_uac_bypass_wmp.yml"
      }
    },
    {
      "id": "15904280-565c-4b73-9303-3291f964e7f9",
      "title": "Potential Persistence Attempt Via ErrorHandler.Cmd",
      "status": "test",
      "description": "Detects creation of a file named \"ErrorHandler.cmd\" in the \"C:\\WINDOWS\\Setup\\Scripts\\\" directory which could be used as a method of persistence\nThe content of C:\\WINDOWS\\Setup\\Scripts\\ErrorHandler.cmd is read whenever some tools under C:\\WINDOWS\\System32\\oobe\\ (e.g. Setup.exe) fail to run for any reason.\n",
      "level": "medium",
      "tags": [
        "attack.persistence"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "\\WINDOWS\\Setup\\Scripts\\ErrorHandler.cmd",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-09",
        "modified": "2022-12-19",
        "references": [
          "https://www.hexacorn.com/blog/2022/01/16/beyond-good-ol-run-key-part-135/",
          "https://github.com/last-byte/PersistenceSniper"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_errorhandler_persistence.yml"
      }
    },
    {
      "id": "fc4f4817-0c53-4683-a4ee-b17a64bc1039",
      "title": "Suspicious Desktopimgdownldr Target File",
      "status": "test",
      "description": "Detects a suspicious Microsoft desktopimgdownldr file creation that stores a file to a suspicious location or contains a file with a suspicious extension",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1105"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\svchost.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\Personalization\\LockScreenImage\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter1": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "C:\\Windows\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter2": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  ".jpg",
                  ".jpeg",
                  ".png"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter1 and not filter2",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "filter1"
            },
            {
              "type": "not",
              "value": "filter2"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1105"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2020-07-03",
        "modified": "2022-06-02",
        "references": [
          "https://labs.sentinelone.com/living-off-windows-land-a-new-native-file-downldr/",
          "https://twitter.com/SBousseaden/status/1278977301745741825"
        ],
        "falsepositives": [
          "False positives depend on scripts and administrative tools used in the monitored environment"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_susp_desktopimgdownldr_file.yml"
      }
    },
    {
      "id": "80e1f67a-4596-4351-98f5-a9c3efabac95",
      "title": "Suspicious Scheduled Task Write to System32 Tasks",
      "status": "test",
      "description": "Detects the creation of tasks from processes executed from suspicious locations",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.execution",
        "attack.t1053"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\Windows\\System32\\Tasks",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__contains": {
                "field": "Image",
                "value": [
                  "\\AppData\\",
                  "C:\\PerfLogs",
                  "\\Windows\\System32\\config\\systemprofile"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1053"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-11-16",
        "modified": "2022-01-12",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_susp_task_write.yml"
      }
    },
    {
      "id": "a05baa88-e922-4001-bc4d-8738135f27de",
      "title": "Process Monitor Driver Creation By Non-Sysinternals Binary",
      "status": "test",
      "description": "Detects creation of the Process Monitor driver by processes other than Process Monitor (procmon) itself.",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.privilege-escalation",
        "attack.t1068"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\procmon",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".sys",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_process_explorer": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\procmon.exe",
                  "\\procmon64.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1068"
        ],
        "tactics": [
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-05",
        "modified": "",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Some false positives may occur with legitimate renamed process monitor binaries"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_sysinternals_procmon_driver_susp_creation.yml"
      }
    },
    {
      "id": "a6976974-ea6f-4e97-818e-ea08625c52cb",
      "title": "Potential RipZip Attack on Startup Folder",
      "status": "test",
      "description": "Detects a phishing attack which expands a ZIP file containing a malicious shortcut.\nIf the victim expands the ZIP file via the explorer process, then the explorer process expands the malicious ZIP file and drops a malicious shortcut redirected to a backdoor into the Startup folder.\nAdditionally, the file name of the malicious shortcut in Startup folder contains {0AFACED1-E828-11D1-9187-B532F1E9575D} meaning the folder shortcut operation.\n",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains_all": {
                "field": "TargetFilename",
                "value": [
                  "\\Microsoft\\Windows\\Start Menu\\Programs\\Startup",
                  ".lnk.{0AFACED1-E828-11D1-9187-B532F1E9575D}"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\explorer.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1547"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Greg (rule)",
        "date": "2022-07-21",
        "modified": "2023-01-05",
        "references": [
          "https://twitter.com/jonasLyk/status/1549338335243534336?t=CrmPocBGLbDyE4p6zTX1cg&s=19"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_ripzip_attack.yml"
      }
    },
    {
      "id": "bdd8157d-8e85-4397-bb82-f06cc9c71dbb",
      "title": "UAC Bypass Using IEInstal - File",
      "status": "test",
      "description": "Detects the pattern of UAC Bypass using IEInstal.exe (UACMe 64)",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Program Files\\Internet Explorer\\IEInstal.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": "C:\\Users\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\AppData\\Local\\Temp\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "consent.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Christian Burkard (Nextron Systems)",
        "date": "2021-08-30",
        "modified": "2022-10-09",
        "references": [
          "https://github.com/hfiref0x/UACME"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_uac_bypass_ieinstal.yml"
      }
    },
    {
      "id": "304afd73-55a5-4bb9-8c21-0b1fc84ea9e4",
      "title": "PSEXEC Remote Execution File Artefact",
      "status": "test",
      "description": "Detects creation of the PSEXEC key file. Which is created anytime a PsExec command is executed. It gets written to the file system and will be recorded in the USN Journal on the target system",
      "level": "high",
      "tags": [
        "attack.lateral-movement",
        "attack.privilege-escalation",
        "attack.execution",
        "attack.persistence",
        "attack.t1136.002",
        "attack.t1543.003",
        "attack.t1570",
        "attack.s0029"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": "C:\\Windows\\PSEXEC-",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".key",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1136.002",
          "T1543.003",
          "T1570"
        ],
        "tactics": [
          "lateral_movement",
          "privilege_escalation",
          "execution",
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-01-21",
        "modified": "2023-02-23",
        "references": [
          "https://aboutdfir.com/the-key-to-identify-psexec/",
          "https://twitter.com/davisrichardg/status/1616518800584704028"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_sysinternals_psexec_service_key.yml"
      }
    },
    {
      "id": "814ddeca-3d31-4265-8e07-8cc54fb44903",
      "title": "LiveKD Kernel Memory Dump File Created",
      "status": "test",
      "description": "Detects the creation of a file that has the same name as the default LiveKD kernel memory dump.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename": {
                "field": "TargetFilename",
                "value": "C:\\Windows\\livekd.dmp",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-16",
        "modified": "",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "In rare occasions administrators might leverage LiveKD to perform live kernel debugging. This should not be allowed on production systems. Investigate and apply additional filters where necessary."
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_sysinternals_livekd_default_dump_name.yml"
      }
    },
    {
      "id": "13c02350-4177-4e45-ac17-cf7ca628ff5e",
      "title": "Files With System DLL Name In Unsuspected Locations",
      "status": "test",
      "description": "Detects the creation of a file with the \".dll\" extension that has the name of a System DLL in uncommon or unsuspected locations. (Outisde of \"System32\", \"SysWOW64\", etc.).\nIt is highly recommended to perform an initial baseline before using this rule in production.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036.005"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  "\\secur32.dll",
                  "\\tdh.dll"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_generic": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  "C:\\$WINDOWS.~BT\\",
                  "C:\\$WinREAgent\\",
                  "C:\\Windows\\SoftwareDistribution\\",
                  "C:\\Windows\\System32\\",
                  "C:\\Windows\\SysWOW64\\",
                  "C:\\Windows\\WinSxS\\",
                  "C:\\Windows\\uus\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1036.005"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2024-06-24",
        "modified": "",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Third party software might bundle specific versions of system DLLs."
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_creation_system_dll_files.yml"
      }
    },
    {
      "id": "63e4f530-65dc-49cc-8f80-ccfa95c69d43",
      "title": "UAC Bypass Using EventVwr",
      "status": "test",
      "description": "Detects the pattern of a UAC bypass using Windows Event Viewer",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  "\\Microsoft\\Event Viewer\\RecentViews",
                  "\\Microsoft\\EventV~1\\RecentViews"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Windows\\System32\\",
                  "C:\\Windows\\SysWOW64\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Antonio Cocomazzi (idea), Florian Roth (Nextron Systems)",
        "date": "2022-04-27",
        "modified": "2022-11-22",
        "references": [
          "https://twitter.com/orange_8361/status/1518970259868626944?s=20&t=RFXqZjtA7tWM3HxqEH78Aw",
          "https://twitter.com/splinter_code/status/1519075134296006662?s=12&t=DLUXH86WtcmG_AZ5gY3C6g",
          "https://lolbas-project.github.io/lolbas/Binaries/Eventvwr/#execute"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_uac_bypass_eventvwr.yml"
      }
    },
    {
      "id": "65236ec7-ace0-4f0c-82fd-737b04fd4dcb",
      "title": "EVTX Created In Uncommon Location",
      "status": "test",
      "description": "Detects the creation of new files with the \".evtx\" extension in non-common or non-standard location.\nThis could indicate tampering with default EVTX locations in order to evade security controls or simply exfiltration of event log to search for sensitive information within.\nNote that backup software and legitimate administrator might perform similar actions during troubleshooting.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.002"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".evtx",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_path": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": "C:\\Windows\\System32\\winevt\\Logs\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_baseimage": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": "C:\\ProgramData\\Microsoft\\Windows\\Containers\\BaseImages\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "\\Windows\\System32\\winevt\\Logs\\",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1562.002"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "D3F7A5105",
        "date": "2023-01-02",
        "modified": "2024-03-26",
        "references": [
          "https://learn.microsoft.com/en-us/windows/win32/eventlog/eventlog-key"
        ],
        "falsepositives": [
          "Administrator or backup activity",
          "An unknown bug seems to trigger the Windows \"svchost\" process to drop EVTX files in the \"C:\\Windows\\Temp\" directory in the form \"<log_name\">_<uuid>.evtx\". See https://superuser.com/questions/1371229/low-disk-space-after-filling-up-c-windows-temp-with-evtx-and-txt-files"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_create_evtx_non_common_locations.yml"
      }
    },
    {
      "id": "6902955a-01b7-432c-b32a-6f5f81d8f625",
      "title": "LSASS Process Dump Artefact In CrashDumps Folder",
      "status": "test",
      "description": "Detects the presence of an LSASS dump file in the \"CrashDumps\" folder. This could be a sign of LSASS credential dumping. Techniques such as the LSASS Shtinkering have been seen abusing the Windows Error Reporting to dump said process.",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003.001"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": "C:\\Windows\\System32\\config\\systemprofile\\AppData\\Local\\CrashDumps\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "lsass.exe.",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".dmp",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.001"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "@pbssubhash",
        "date": "2022-12-08",
        "modified": "",
        "references": [
          "https://github.com/deepinstinct/Lsass-Shtinkering",
          "https://media.defcon.org/DEF%20CON%2030/DEF%20CON%2030%20presentations/Asaf%20Gilboa%20-%20LSASS%20Shtinkering%20Abusing%20Windows%20Error%20Reporting%20to%20Dump%20LSASS.pdf"
        ],
        "falsepositives": [
          "Rare legitimate dump of the process by the operating system due to a crash of lsass"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_lsass_shtinkering.yml"
      }
    },
    {
      "id": "9b64de98-9db3-4033-bd7a-f51430105f00",
      "title": "Windows Terminal Profile Settings Modification By Uncommon Process",
      "status": "test",
      "description": "Detects the creation or modification of the Windows Terminal Profile settings file \"settings.json\" by an uncommon process.",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547.015"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\cmd.exe",
                  "\\cscript.exe",
                  "\\mshta.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\wscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "\\AppData\\Local\\Packages\\Microsoft.WindowsTerminal_8wekyb3d8bbwe\\LocalState\\settings.json",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1547.015"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-07-22",
        "modified": "",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/74438b0237d141ee9c99747976447dc884cb1a39/atomics/T1547.015/T1547.015.md#atomic-test-1---persistence-by-modifying-windows-terminal-profile",
          "https://twitter.com/nas_bench/status/1550836225652686848"
        ],
        "falsepositives": [
          "Some false positives may occur with admin scripts that set WT settings."
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_susp_windows_terminal_profile.yml"
      }
    },
    {
      "id": "4f1707b1-b50b-45b4-b5a2-3978b5a5d0d6",
      "title": "Potential Homoglyph Attack Using Lookalike Characters in Filename",
      "status": "test",
      "description": "Detects the presence of unicode characters which are homoglyphs, or identical in appearance, to ASCII letter characters.\nThis is used as an obfuscation and masquerading techniques. Only \"perfect\" homoglyphs are included; these are characters that\nare indistinguishable from ASCII characters and thus may make excellent candidates for homoglyph attack characters.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036",
        "attack.t1036.003"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_upper": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  ""
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_lower": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  ""
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1036",
          "T1036.003"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Micah Babinski, @micahbabinski",
        "date": "2023-05-08",
        "modified": "",
        "references": [
          "https://redcanary.com/threat-detection-report/threats/socgholish/#threat-socgholish",
          "http://www.irongeek.com/homoglyph-attack-generator.php"
        ],
        "falsepositives": [
          "File names with legitimate Cyrillic text. Will likely require tuning (or not be usable) in countries where these alphabets are in use."
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_susp_homoglyph_filename.yml"
      }
    },
    {
      "id": "39f1f9f2-9636-45de-98f6-a4046aa8e4b9",
      "title": "Potential Webshell Creation On Static Website",
      "status": "test",
      "description": "Detects the creation of files with certain extensions on a static web site. This can be indicative of potential uploads of a web shell.",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.t1505.003"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_wwwroot_path": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\inetpub\\wwwroot\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_wwwroot_ext": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  ".ashx",
                  ".asp",
                  ".ph",
                  ".soap"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_htdocs_path": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  "\\www\\",
                  "\\htdocs\\",
                  "\\html\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_htdocs_ext": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": ".ph",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_temp": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  "\\AppData\\Local\\Temp\\",
                  "\\Windows\\Temp\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_system": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "System",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_legitimate": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\xampp",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "(all of selection_wwwroot_* or all of selection_htdocs_*) and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "(all of selection_wwwroot_*",
            "all of selection_htdocs_*) and not 1 of filter_main_*"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1505.003"
        ],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "Beyu Denis, oscd.community, Tim Shelton, Thurein Oo",
        "date": "2019-10-22",
        "modified": "2023-10-15",
        "references": [
          "PT ESC rule and personal experience",
          "https://github.com/swisskyrepo/PayloadsAllTheThings/blob/c95a0a1a2855dc0cd7f7327614545fe30482a636/Upload%20Insecure%20Files/README.md"
        ],
        "falsepositives": [
          "Legitimate administrator or developer creating legitimate executable files in a web application folder"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_webshell_creation_detect.yml"
      }
    },
    {
      "id": "6c0ce3b6-85e2-49d4-9c3f-6e008ce9796e",
      "title": "Suspicious Deno File Written from Remote Source",
      "status": "experimental",
      "description": "Detects Deno writing a file from a direct HTTP(s) call and writing to the appdata folder or bringing it's own malicious DLL.\nThis behavior may indicate an attempt to execute remotely hosted, potentially malicious files through deno.\n",
      "level": "low",
      "tags": [
        "attack.execution",
        "attack.t1204",
        "attack.t1059.007",
        "attack.command-and-control",
        "attack.t1105"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_path": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  "\\deno\\gen\\",
                  "\\deno\\remote\\https\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__contains_all": {
                "field": "TargetFilename",
                "value": [
                  ":\\Users\\",
                  "\\AppData\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_path",
        "condition_parsed": {
          "op": "single",
          "selection": "selection_path"
        }
      },
      "mitre": {
        "techniques": [
          "T1204",
          "T1059.007",
          "T1105"
        ],
        "tactics": [
          "execution",
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Josh Nickels, Michael Taggart",
        "date": "2025-05-22",
        "modified": "",
        "references": [
          "https://taggart-tech.com/evildeno/"
        ],
        "falsepositives": [
          "Legitimate usage of deno to request a file or bring a DLL to a host"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_creation_deno.yml"
      }
    },
    {
      "id": "54127bd4-f541-4ac3-afdb-ea073f63f692",
      "title": "Potential Persistence Via Notepad++ Plugins",
      "status": "test",
      "description": "Detects creation of new \".dll\" files inside the plugins directory of a notepad++ installation by a process other than \"gup.exe\". Which could indicates possible persistence",
      "level": "medium",
      "tags": [
        "attack.persistence"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\Notepad++\\plugins\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".dll",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_gup": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\Notepad++\\updater\\gup.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_install": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Users\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__contains": {
                "field": "Image",
                "value": "\\AppData\\Local\\Temp\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\target.exe",
                  "Installer.x64.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_installer": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": "\\npp.",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": ".exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename": {
                "field": "TargetFilename",
                "value": [
                  "C:\\Program Files\\Notepad++\\plugins\\NppExport\\NppExport.dll",
                  "C:\\Program Files\\Notepad++\\plugins\\mimeTools\\mimeTools.dll",
                  "C:\\Program Files\\Notepad++\\plugins\\NppConverter\\NppConverter.dll",
                  "C:\\Program Files\\Notepad++\\plugins\\Config\\nppPluginList.dll"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-06-10",
        "modified": "2025-09-01",
        "references": [
          "https://pentestlab.blog/2022/02/14/persistence-notepad-plugins/"
        ],
        "falsepositives": [
          "Possible FPs during first installation of Notepad++",
          "Legitimate use of custom plugins by users in order to enhance notepad++ functionalities"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_notepad_plus_plus_persistence.yml"
      }
    },
    {
      "id": "f0540f7e-2db3-4432-b9e0-3965486744bc",
      "title": "Legitimate Application Dropped Executable",
      "status": "test",
      "description": "Detects programs on a Windows system that should not write executables to disk",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\eqnedt32.exe",
                  "\\wordpad.exe",
                  "\\wordview.exe",
                  "\\certutil.exe",
                  "\\certoc.exe",
                  "\\CertReq.exe",
                  "\\Desktopimgdownldr.exe",
                  "\\esentutl.exe",
                  "\\mshta.exe",
                  "\\AcroRd32.exe",
                  "\\RdrCEF.exe",
                  "\\hh.exe",
                  "\\finger.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".exe",
                  ".dll",
                  ".ocx"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113, Florian Roth (Nextron Systems)",
        "date": "2022-08-21",
        "modified": "2023-06-22",
        "references": [
          "https://github.com/Neo23x0/sysmon-config/blob/3f808d9c022c507aae21a9346afba4a59dd533b9/sysmonconfig-export-block.xml#L1326"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_susp_legitimate_app_dropping_exe.yml"
      }
    },
    {
      "id": "b447f7de-1e53-4cbf-bfb4-f1f6d0b04e4e",
      "title": "Suspicious Binaries and Scripts in Public Folder",
      "status": "experimental",
      "description": "Detects the creation of a file with a suspicious extension in the public folder, which could indicate potential malicious activity.",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1204"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": ":\\Users\\Public\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".bat",
                  ".dll",
                  ".exe",
                  ".hta",
                  ".js",
                  ".ps1",
                  ".vbe",
                  ".vbs"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1204"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "The DFIR Report",
        "date": "2025-01-23",
        "modified": "",
        "references": [
          "https://intel.thedfirreport.com/events/view/30032",
          "https://intel.thedfirreport.com/eventReports/view/70",
          "https://thedfirreport.com/2025/01/27/cobalt-strike-and-a-pair-of-socks-lead-to-lockbit-ransomware/"
        ],
        "falsepositives": [
          "Administrators deploying legitimate binaries to public folders."
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_susp_public_folder_extension.yml"
      }
    },
    {
      "id": "3da70954-0f2c-4103-adff-b7440368f50e",
      "title": "Suspicious PROCEXP152.sys File Created In TMP",
      "status": "test",
      "description": "Detects the creation of the PROCEXP152.sys file in the application-data local temporary folder.\nThis driver is used by Sysinternals Process Explorer but also by KDU (https://github.com/hfiref0x/KDU) or Ghost-In-The-Logs (https://github.com/bats3c/Ghost-In-The-Logs), which uses KDU.\n",
      "level": "medium",
      "tags": [
        "attack.t1562.001",
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\AppData\\Local\\Temp\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "PROCEXP152.sys",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  "\\procexp64.exe",
                  "\\procexp.exe",
                  "\\procmon64.exe",
                  "\\procmon.exe"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "xknow (@xknow_infosec), xorxes (@xor_xes)",
        "date": "2019-04-08",
        "modified": "2022-11-22",
        "references": [
          "https://web.archive.org/web/20230331181619/https://blog.dylan.codes/evading-sysmon-and-windows-event-logging/"
        ],
        "falsepositives": [
          "Other legimate tools using this driver and filename (like Sysinternals). Note - Clever attackers may easily bypass this detection by just renaming the driver filename. Therefore just Medium-level and don't rely on it."
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_susp_procexplorer_driver_created_in_tmp_folder.yml"
      }
    },
    {
      "id": "34986307-b7f4-49be-92f3-e7a4d01ac5db",
      "title": "Rclone Config File Creation",
      "status": "test",
      "description": "Detects Rclone config files being created",
      "level": "medium",
      "tags": [
        "attack.exfiltration",
        "attack.t1567.002"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains_all": {
                "field": "TargetFilename",
                "value": [
                  ":\\Users\\",
                  "\\.config\\rclone\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1567.002"
        ],
        "tactics": [
          "exfiltration"
        ]
      },
      "meta": {
        "author": "Aaron Greetham (@beardofbinary) - NCC Group",
        "date": "2021-05-26",
        "modified": "2023-05-09",
        "references": [
          "https://research.nccgroup.com/2021/05/27/detecting-rclone-an-effective-tool-for-exfiltration/"
        ],
        "falsepositives": [
          "Legitimate Rclone usage"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_rclone_config_files.yml"
      }
    },
    {
      "id": "28208707-fe31-437f-9a7f-4b1108b94d2e",
      "title": "Suspicious Startup Folder Persistence",
      "status": "test",
      "description": "Detects the creation of potentially malicious script and executable files in Windows startup folders, which is a common persistence technique used by threat actors.\nThese files (.ps1, .vbs, .js, .bat, etc.) are automatically executed when a user logs in, making the Startup folder an attractive target for attackers.\nThis technique is frequently observed in malvertising campaigns and malware distribution where attackers attempt to maintain long-term access to compromised systems.\n",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.execution",
        "attack.t1204.002",
        "attack.persistence",
        "attack.t1547.001"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\Windows\\Start Menu\\Programs\\Startup\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".bat",
                  ".cmd",
                  ".dll",
                  ".hta",
                  ".jar",
                  ".js",
                  ".jse",
                  ".msi",
                  ".ps1",
                  ".psd1",
                  ".psm1",
                  ".scr",
                  ".url",
                  ".vba",
                  ".vbe",
                  ".vbs",
                  ".wsf"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1204.002",
          "T1547.001"
        ],
        "tactics": [
          "privilege_escalation",
          "execution",
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2022-08-10",
        "modified": "2025-10-12",
        "references": [
          "https://github.com/last-byte/PersistenceSniper",
          "https://www.microsoft.com/en-us/security/blog/2025/03/06/malvertising-campaign-leads-to-info-stealers-hosted-on-github/",
          "https://github.com/redcanaryco/atomic-red-team/blob/5ede8f21e42ebe37e0a6eff757dba60bcfa85859/atomics/T1547.001/T1547.001.md"
        ],
        "falsepositives": [
          "Rare legitimate usage of some of the extensions mentioned in the rule"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_susp_startup_folder_persistence.yml"
      }
    },
    {
      "id": "a10a2c40-2c4d-49f8-b557-1a946bc55d9d",
      "title": "Uncommon File Created In Office Startup Folder",
      "status": "test",
      "description": "Detects the creation of a file with an uncommon extension in an Office application startup folder",
      "level": "high",
      "tags": [
        "attack.resource-development",
        "attack.t1587.001"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_word_paths": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "TargetFilename__contains": {
                    "field": "TargetFilename",
                    "value": "\\Microsoft\\Word\\STARTUP",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "TargetFilename__contains_all": {
                    "field": "TargetFilename",
                    "value": [
                      "\\Office",
                      "\\Program Files",
                      "\\STARTUP"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_excel_paths": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "TargetFilename__contains": {
                    "field": "TargetFilename",
                    "value": "\\Microsoft\\Excel\\XLSTART",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "TargetFilename__contains_all": {
                    "field": "TargetFilename",
                    "value": [
                      "\\Office",
                      "\\Program Files",
                      "\\XLSTART"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_exclude_word_ext": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".docb",
                  ".docm",
                  ".docx",
                  ".dotm",
                  ".mdb",
                  ".mdw",
                  ".pdf",
                  ".wll",
                  ".wwl"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_exclude_excel_ext": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".xll",
                  ".xls",
                  ".xlsm",
                  ".xlsx",
                  ".xlt",
                  ".xltm",
                  ".xlw"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_office_click_to_run": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": ":\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\OfficeClickToRun.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_office_apps": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  ":\\Program Files\\Microsoft Office\\",
                  ":\\Program Files (x86)\\Microsoft Office\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\winword.exe",
                  "\\excel.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "((selection_word_paths and not filter_exclude_word_ext) or (selection_excel_paths and not filter_exclude_excel_ext)) and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "((selection_word_paths and not filter_exclude_word_ext)",
            "(selection_excel_paths and not filter_exclude_excel_ext)) and not 1 of filter_main_*"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1587.001"
        ],
        "tactics": [
          "resource_development"
        ]
      },
      "meta": {
        "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-06-05",
        "modified": "2023-12-13",
        "references": [
          "https://app.any.run/tasks/d6fe6624-6ef8-485d-aa75-3d1bdda2a08c/",
          "http://addbalance.com/word/startup.htm",
          "https://answers.microsoft.com/en-us/msoffice/forum/all/document-in-word-startup-folder-doesnt-open-when/44ab0932-2917-4150-8cdc-2f2cf39e86f3",
          "https://en.wikipedia.org/wiki/List_of_Microsoft_Office_filename_extensions"
        ],
        "falsepositives": [
          "False positive might stem from rare extensions used by other Office utilities."
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_office_uncommon_file_startup.yml"
      }
    },
    {
      "id": "602a1f13-c640-4d73-b053-be9a2fa58b96",
      "title": "HackTool - Powerup Write Hijack DLL",
      "status": "test",
      "description": "Powerup tool's Write Hijack DLL exploits DLL hijacking for privilege escalation.\nIn it's default mode, it builds a self deleting .bat file which executes malicious command.\nThe detection rule relies on creation of the malicious bat file (debug.bat by default).\n",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.privilege-escalation",
        "attack.defense-evasion",
        "attack.t1574.001"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\powershell.exe",
                  "\\pwsh.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".bat",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1574.001"
        ],
        "tactics": [
          "persistence",
          "privilege_escalation",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Subhash Popuri (@pbssubhash)",
        "date": "2021-08-21",
        "modified": "2024-06-27",
        "references": [
          "https://powersploit.readthedocs.io/en/latest/Privesc/Write-HijackDll/"
        ],
        "falsepositives": [
          "Any powershell script that creates bat files"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_hktl_powerup_dllhijacking.yml"
      }
    },
    {
      "id": "c7a74c80-ba5a-486e-9974-ab9e682bc5e4",
      "title": "File With Uncommon Extension Created By An Office Application",
      "status": "test",
      "description": "Detects the creation of files with an executable or script extension by an Office application.",
      "level": "high",
      "tags": [
        "attack.t1204.002",
        "attack.execution"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection1": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\excel.exe",
                  "\\msaccess.exe",
                  "\\mspub.exe",
                  "\\powerpnt.exe",
                  "\\visio.exe",
                  "\\winword.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection2": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".bat",
                  ".cmd",
                  ".com",
                  ".dll",
                  ".exe",
                  ".hta",
                  ".ocx",
                  ".proj",
                  ".ps1",
                  ".scf",
                  ".scr",
                  ".sys",
                  ".vbe",
                  ".vbs",
                  ".wsf",
                  ".wsh"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_localassembly": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\AppData\\Local\\assembly\\tmp\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".dll",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_webservicecache": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains_all": {
                "field": "TargetFilename",
                "value": [
                  "C:\\Users\\",
                  "\\AppData\\Local\\Microsoft\\Office\\",
                  "\\WebServiceCache\\AllUsers"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".com",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_webex": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\winword.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\AppData\\Local\\Temp\\webexdelta\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".dll",
                  ".exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_backstageinappnavcache": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains_all": {
                "field": "TargetFilename",
                "value": [
                  "C:\\Users\\",
                  "\\AppData\\Local\\Microsoft\\Office\\",
                  "\\BackstageInAppNavCache\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".com",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection* and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "all of selection*"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1204.002"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Vadim Khrykov (ThreatIntel), Cyb3rEng (Rule), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2021-08-23",
        "modified": "2025-10-17",
        "references": [
          "https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware/",
          "https://github.com/vadim-hunter/Detection-Ideas-Rules/blob/02bcbfc2bfb8b4da601bb30de0344ae453aa1afe/Threat%20Intelligence/The%20DFIR%20Report/20210329_Sodinokibi_(aka_REvil)_Ransomware.yaml"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_office_susp_file_extension.yml"
      }
    },
    {
      "id": "69ca12af-119d-44ed-b50f-a47af0ebc364",
      "title": "LSASS Process Memory Dump Creation Via Taskmgr.EXE",
      "status": "test",
      "description": "Detects the creation of an \"lsass.dmp\" file by the taskmgr process. This indicates a manual dumping of the LSASS.exe process memory using Windows Task Manager.",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003.001"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  ":\\Windows\\system32\\taskmgr.exe",
                  ":\\Windows\\SysWOW64\\taskmgr.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__contains_all": {
                "field": "TargetFilename",
                "value": [
                  "\\AppData\\Local\\Temp\\",
                  "\\lsass",
                  ".DMP"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.001"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel",
        "date": "2023-10-19",
        "modified": "",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/987e3ca988ae3cff4b9f6e388c139c05bf44bbb8/atomics/T1003.001/T1003.001.md#L1"
        ],
        "falsepositives": [
          "Rare case of troubleshooting by an administrator or support that has to be investigated regardless"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_taskmgr_lsass_dump.yml"
      }
    },
    {
      "id": "2f7979ae-f82b-45af-ac1d-2b10e93b0baa",
      "title": "Potential DCOM InternetExplorer.Application DLL Hijack",
      "status": "test",
      "description": "Detects potential DLL hijack of \"iertutil.dll\" found in the DCOM InternetExplorer.Application Class over the network",
      "level": "critical",
      "tags": [
        "attack.lateral-movement",
        "attack.t1021.002",
        "attack.t1021.003"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "System",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "\\Internet Explorer\\iertutil.dll",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1021.002",
          "T1021.003"
        ],
        "tactics": [
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez @Cyb3rWard0g, Open Threat Research (OTR), wagga",
        "date": "2020-10-12",
        "modified": "2022-12-18",
        "references": [
          "https://threathunterplaybook.com/hunts/windows/201009-RemoteDCOMIErtUtilDLLHijack/notebook.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_dcom_iertutil_dll_hijack.yml"
      }
    },
    {
      "id": "7047d730-036f-4f40-b9d8-1c63e36d5e62",
      "title": "Potential Binary Or Script Dropper Via PowerShell",
      "status": "test",
      "description": "Detects PowerShell creating a binary executable or a script file.",
      "level": "medium",
      "tags": [
        "attack.persistence"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\powershell.exe",
                  "\\powershell_ise.exe",
                  "\\pwsh.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".bat",
                  ".chm",
                  ".cmd",
                  ".com",
                  ".dll",
                  ".exe",
                  ".hta",
                  ".jar",
                  ".js",
                  ".ocx",
                  ".scr",
                  ".sys",
                  ".vbe",
                  ".vbs",
                  ".wsf"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_user_temp": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": "C:\\Users\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\AppData\\Local\\Temp\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".dll",
                  ".exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_other_temp": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": [
                  "C:\\Windows\\Temp\\",
                  "C:\\Windows\\SystemTemp\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".dll",
                  ".exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_powershell_module": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": "C:\\Users\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\WindowsPowerShell\\Modules\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".dll",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_nuget": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": "C:\\Program Files\\PackageManagement\\ProviderAssemblies\\nuget\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "\\Microsoft.PackageManagement.NuGetProvider.dll",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-03-17",
        "modified": "2025-07-04",
        "references": [
          "https://www.zscaler.com/blogs/security-research/onenote-growing-threat-malware-distribution"
        ],
        "falsepositives": [
          "False positives will differ depending on the environment and scripts used. Apply additional filters accordingly."
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_powershell_drop_binary_or_script.yml"
      }
    },
    {
      "id": "34746e8c-5fb8-415a-b135-0abc167e912a",
      "title": "WinSxS Executable File Creation By Non-System Process",
      "status": "test",
      "description": "Detects the creation of binaries in the WinSxS folder by non-system processes",
      "level": "medium",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": "C:\\Windows\\WinSxS\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_system_location": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Windows\\Systems32\\",
                  "C:\\Windows\\SysWOW64\\",
                  "C:\\Windows\\WinSxS\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-11",
        "modified": "",
        "references": [
          "https://media.defense.gov/2023/May/09/2003218554/-1/-1/0/JOINT_CSA_HUNTING_RU_INTEL_SNAKE_MALWARE_20230509.PDF"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_susp_winsxs_binary_creation.yml"
      }
    },
    {
      "id": "8fbf3271-1ef6-4e94-8210-03c2317947f6",
      "title": "Cred Dump Tools Dropped Files",
      "status": "test",
      "description": "Files with well-known filenames (parts of credential dump software or files produced by them) creation",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003.001",
        "attack.t1003.002",
        "attack.t1003.003",
        "attack.t1003.004",
        "attack.t1003.005"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "TargetFilename__contains": {
                    "field": "TargetFilename",
                    "value": [
                      "\\fgdump-log",
                      "\\kirbi",
                      "\\pwdump",
                      "\\pwhashes",
                      "\\wce_ccache",
                      "\\wce_krbtkts"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "TargetFilename__endswith": {
                    "field": "TargetFilename",
                    "value": [
                      "\\cachedump.exe",
                      "\\cachedump64.exe",
                      "\\DumpExt.dll",
                      "\\DumpSvc.exe",
                      "\\Dumpy.exe",
                      "\\fgexec.exe",
                      "\\lsremora.dll",
                      "\\lsremora64.dll",
                      "\\NTDS.out",
                      "\\procdump.exe",
                      "\\procdump64.exe",
                      "\\procdump64a.exe",
                      "\\pstgdump.exe",
                      "\\pwdump.exe",
                      "\\SAM.out",
                      "\\SECURITY.out",
                      "\\servpw.exe",
                      "\\servpw64.exe",
                      "\\SYSTEM.out",
                      "\\test.pwd",
                      "\\wceaux.dll"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.001",
          "T1003.002",
          "T1003.003",
          "T1003.004",
          "T1003.005"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Teymur Kheirkhabarov, oscd.community",
        "date": "2019-11-01",
        "modified": "2025-10-25",
        "references": [
          "https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment"
        ],
        "falsepositives": [
          "Legitimate Administrator using tool for password recovery"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_cred_dump_tools_dropped_files.yml"
      }
    },
    {
      "id": "654fcc6d-840d-4844-9b07-2c3300e54a26",
      "title": "Legitimate Application Dropped Archive",
      "status": "test",
      "description": "Detects programs on a Windows system that should not write an archive to disk",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\winword.exe",
                  "\\excel.exe",
                  "\\powerpnt.exe",
                  "\\msaccess.exe",
                  "\\mspub.exe",
                  "\\eqnedt32.exe",
                  "\\visio.exe",
                  "\\wordpad.exe",
                  "\\wordview.exe",
                  "\\certutil.exe",
                  "\\certoc.exe",
                  "\\CertReq.exe",
                  "\\Desktopimgdownldr.exe",
                  "\\esentutl.exe",
                  "\\finger.exe",
                  "\\notepad.exe",
                  "\\AcroRd32.exe",
                  "\\RdrCEF.exe",
                  "\\mshta.exe",
                  "\\hh.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".zip",
                  ".rar",
                  ".7z",
                  ".diagcab",
                  ".appx"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113, Florian Roth",
        "date": "2022-08-21",
        "modified": "",
        "references": [
          "https://github.com/Neo23x0/sysmon-config/blob/3f808d9c022c507aae21a9346afba4a59dd533b9/sysmonconfig-export-block.xml#L1326"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_susp_legitimate_app_dropping_archive.yml"
      }
    },
    {
      "id": "2d367498-5112-4ae5-a06a-96e7bc33a211",
      "title": "Suspicious Binary Writes Via AnyDesk",
      "status": "test",
      "description": "Detects AnyDesk writing binary files to disk other than \"gcapi.dll\".\nAccording to RedCanary research it is highly abnormal for AnyDesk to write executable files to disk besides gcapi.dll,\nwhich is a legitimate DLL that is part of the Google Chrome web browser used to interact with the Google Cloud API. (See reference section for more details)\n",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1219.002"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\AnyDesk.exe",
                  "\\AnyDeskMSI.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".dll",
                  ".exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_dlls": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "\\gcapi.dll",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1219.002"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-09-28",
        "modified": "2025-02-24",
        "references": [
          "https://redcanary.com/blog/misbehaving-rats/",
          "https://thedfirreport.com/2025/02/24/confluence-exploit-leads-to-lockbit-ransomware/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_anydesk_writing_susp_binaries.yml"
      }
    },
    {
      "id": "74babdd6-a758-4549-9632-26535279e654",
      "title": "Suspicious Executable File Creation",
      "status": "test",
      "description": "Detect creation of suspicious executable file names.\nSome strings look for suspicious file extensions, others look for filenames that exploit unquoted service paths.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1564"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ":\\$Recycle.Bin.exe",
                  ":\\Documents and Settings.exe",
                  ":\\MSOCache.exe",
                  ":\\PerfLogs.exe",
                  ":\\Recovery.exe",
                  ".bat.exe",
                  ".sys.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1564"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-09-05",
        "modified": "2023-12-11",
        "references": [
          "https://medium.com/@SumitVerma101/windows-privilege-escalation-part-1-unquoted-service-path-c7a011a8d8ae",
          "https://app.any.run/tasks/76c69e2d-01e8-49d9-9aea-fb7cc0c4d3ad/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_susp_executable_creation.yml"
      }
    },
    {
      "id": "3d0ed417-3d94-4963-a562-4a92c940656a",
      "title": "Creation of a Diagcab",
      "status": "test",
      "description": "Detects the creation of diagcab file, which could be caused by some legitimate installer or is a sign of exploitation (review the filename and its location)",
      "level": "medium",
      "tags": [
        "attack.resource-development"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".diagcab",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "resource_development"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-06-08",
        "modified": "",
        "references": [
          "https://threadreaderapp.com/thread/1533879688141086720.html"
        ],
        "falsepositives": [
          "Legitimate microsoft diagcab"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_susp_diagcab.yml"
      }
    },
    {
      "id": "93a19907-d4f9-4deb-9f91-aac4692776a6",
      "title": "UAC Bypass Using .NET Code Profiler on MMC",
      "status": "test",
      "description": "Detects the pattern of UAC Bypass using .NET Code Profiler and mmc.exe DLL hijacking (UACMe 39)",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": "C:\\Users\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "\\AppData\\Local\\Temp\\pe386.dll",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Christian Burkard (Nextron Systems)",
        "date": "2021-08-30",
        "modified": "2022-10-09",
        "references": [
          "https://github.com/hfiref0x/UACME"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_uac_bypass_dotnet_profiler.yml"
      }
    },
    {
      "id": "d7b50671-d1ad-4871-aa60-5aa5b331fe04",
      "title": "Suspicious File Creation In Uncommon AppData Folder",
      "status": "test",
      "description": "Detects the creation of suspicious files and folders inside the user's AppData folder but not inside any of the common and well known directories (Local, Romaing, LocalLow). This method could be used as a method to bypass detection who exclude the AppData folder in fear of FPs",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.execution"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": "C:\\Users\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\AppData\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".bat",
                  ".cmd",
                  ".cpl",
                  ".dll",
                  ".exe",
                  ".hta",
                  ".iso",
                  ".lnk",
                  ".msi",
                  ".ps1",
                  ".psm1",
                  ".scr",
                  ".vbe",
                  ".vbs"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": "C:\\Users\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  "\\AppData\\Local\\",
                  "\\AppData\\LocalLow\\",
                  "\\AppData\\Roaming\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter_main",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter_main"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-05",
        "modified": "2023-02-23",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_new_files_in_uncommon_appdata_folder.yml"
      }
    },
    {
      "id": "3a8da4e0-36c1-40d2-8b29-b3e890d5172a",
      "title": "NTDS Exfiltration Filename Patterns",
      "status": "test",
      "description": "Detects creation of files with specific name patterns seen used in various tools that export the NTDS.DIT for exfiltration.",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003.003"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  "\\All.cab",
                  ".ntds.cleartext"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.003"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-03-11",
        "modified": "2023-05-05",
        "references": [
          "https://github.com/rapid7/metasploit-framework/blob/eb6535009f5fdafa954525687f09294918b5398d/modules/post/windows/gather/ntds_grabber.rb",
          "https://github.com/rapid7/metasploit-framework/blob/eb6535009f5fdafa954525687f09294918b5398d/data/post/powershell/NTDSgrab.ps1",
          "https://github.com/SecureAuthCorp/impacket/blob/7d2991d78836b376452ca58b3d14daa61b67cb40/impacket/examples/secretsdump.py#L2405"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_ntds_exfil_tools.yml"
      }
    },
    {
      "id": "e4a74e34-ecde-4aab-b2fb-9112dd01aed0",
      "title": "Dynamic CSharp Compile Artefact",
      "status": "test",
      "description": "When C# is compiled dynamically, a .cmdline file will be created as a part of the process.\nCertain processes are not typically observed compiling C# code, but can do so without touching disk.\nThis can be used to unpack a payload for execution\n",
      "level": "low",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027.004"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".cmdline",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1027.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-09",
        "modified": "2023-02-17",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1027.004/T1027.004.md#atomic-test-2---dynamic-c-compile"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_csharp_compile_artefact.yml"
      }
    },
    {
      "id": "33f41cdd-35ac-4ba8-814b-c6a4244a1ad4",
      "title": "WMI Persistence - Script Event Consumer File Write",
      "status": "test",
      "description": "Detects file writes of WMI script event consumer",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.t1546.003",
        "attack.persistence"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\WINDOWS\\system32\\wbem\\scrcons.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1546.003"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Thomas Patzke",
        "date": "2018-03-07",
        "modified": "2021-11-27",
        "references": [
          "https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/"
        ],
        "falsepositives": [
          "Dell Power Manager (C:\\Program Files\\Dell\\PowerManager\\DpmPowerPlanSetup.exe)"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_wmi_persistence_script_event_consumer_write.yml"
      }
    },
    {
      "id": "aba15bdd-657f-422a-bab3-ac2d2a0d6f1c",
      "title": "Potentially Suspicious DMP/HDMP File Creation",
      "status": "test",
      "description": "Detects the creation of a file with the \".dmp\"/\".hdmp\" extension by a shell or scripting application such as \"cmd\", \"powershell\", etc. Often created by software during a crash. Memory dumps can sometimes contain sensitive information such as credentials. It's best to determine the source of the crash.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\cmd.exe",
                  "\\cscript.exe",
                  "\\mshta.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\wscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".dmp",
                  ".dump",
                  ".hdmp"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-09-07",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/windows/win32/wer/collecting-user-mode-dumps"
        ],
        "falsepositives": [
          "Some administrative PowerShell or VB scripts might have the ability to collect dumps and move them to other folders which might trigger a false positive."
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_dump_file_susp_creation.yml"
      }
    },
    {
      "id": "cad1fe90-2406-44dc-bd03-59d0b58fe722",
      "title": "HackTool - NPPSpy Hacktool Usage",
      "status": "test",
      "description": "Detects the use of NPPSpy hacktool that stores cleartext passwords of users that logged in to a local file",
      "level": "high",
      "tags": [
        "attack.credential-access"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  "\\NPPSpy.txt",
                  "\\NPPSpy.dll"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-11-29",
        "modified": "2024-06-27",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1003/T1003.md#atomic-test-2---credential-dumping-with-nppspy",
          "https://twitter.com/0gtweet/status/1465282548494487554"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_hktl_nppspy.yml"
      }
    },
    {
      "id": "75bf09fa-1dd7-4d18-9af9-dd9e492562eb",
      "title": "ADSI-Cache File Creation By Uncommon Tool",
      "status": "test",
      "description": "Detects the creation of an \"Active Directory Schema Cache File\" (.sch) file by an uncommon tool.",
      "level": "medium",
      "tags": [
        "attack.t1001.003",
        "attack.command-and-control"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\Local\\Microsoft\\Windows\\SchCache\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".sch",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_generic": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      ":\\Program Files\\Cylance\\Desktop\\CylanceSvc.exe",
                      ":\\Windows\\CCM\\CcmExec.exe",
                      ":\\windows\\system32\\dllhost.exe",
                      ":\\Windows\\system32\\dsac.exe",
                      ":\\Windows\\system32\\efsui.exe",
                      ":\\windows\\system32\\mmc.exe",
                      ":\\windows\\system32\\svchost.exe",
                      ":\\Windows\\System32\\wbem\\WmiPrvSE.exe",
                      ":\\windows\\system32\\WindowsPowerShell\\v1.0\\powershell.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__contains": {
                    "field": "Image",
                    "value": [
                      ":\\Windows\\ccmsetup\\autoupgrade\\ccmsetup",
                      ":\\Program Files\\SentinelOne\\Sentinel Agent"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "filter_main_office": {
            "type": "field_match",
            "matchers": {
              "Image__contains_all": {
                "field": "Image",
                "value": [
                  ":\\Program Files\\",
                  "\\Microsoft Office"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\OUTLOOK.EXE",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_ldapwhoami": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\LANDesk\\LDCLient\\ldapwhoami.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_citrix": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": ":\\Program Files\\Citrix\\Receiver StoreFront\\Services\\DefaultDomainServices\\Citrix.DeliveryServices.DomainServices.ServiceHost.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1001.003"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "xknow @xknow_infosec, Tim Shelton",
        "date": "2019-03-24",
        "modified": "2023-10-18",
        "references": [
          "https://medium.com/@ivecodoe/detecting-ldapfragger-a-newly-released-cobalt-strike-beacon-using-ldap-for-c2-communication-c274a7f00961",
          "https://blog.fox-it.com/2020/03/19/ldapfragger-command-and-control-over-ldap-attributes/",
          "https://github.com/fox-it/LDAPFragger"
        ],
        "falsepositives": [
          "Other legimate tools, which do ADSI (LDAP) operations, e.g. any remoting activity by MMC, Powershell, Windows etc."
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_adsi_cache_creation_by_uncommon_tool.yml"
      }
    },
    {
      "id": "f331aa1f-8c53-4fc3-b083-cc159bc971cb",
      "title": "Malicious PowerShell Scripts - FileCreation",
      "status": "test",
      "description": "Detects the creation of known offensive powershell scripts used for exploitation",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_generic": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  "\\Add-ConstrainedDelegationBackdoor.ps1",
                  "\\Add-Exfiltration.ps1",
                  "\\Add-Persistence.ps1",
                  "\\Add-RegBackdoor.ps1",
                  "\\Add-RemoteRegBackdoor.ps1",
                  "\\Add-ScrnSaveBackdoor.ps1",
                  "\\ADRecon.ps1",
                  "\\AzureADRecon.ps1",
                  "\\BadSuccessor.ps1",
                  "\\Check-VM.ps1",
                  "\\ConvertTo-ROT13.ps1",
                  "\\Copy-VSS.ps1",
                  "\\Create-MultipleSessions.ps1",
                  "\\DNS_TXT_Pwnage.ps1",
                  "\\dnscat2.ps1",
                  "\\Do-Exfiltration.ps1",
                  "\\DomainPasswordSpray.ps1",
                  "\\Download_Execute.ps1",
                  "\\Download-Execute-PS.ps1",
                  "\\Enable-DuplicateToken.ps1",
                  "\\Enabled-DuplicateToken.ps1",
                  "\\Execute-Command-MSSQL.ps1",
                  "\\Execute-DNSTXT-Code.ps1",
                  "\\Execute-OnTime.ps1",
                  "\\ExetoText.ps1",
                  "\\Exploit-Jboss.ps1",
                  "\\Find-AVSignature.ps1",
                  "\\Find-Fruit.ps1",
                  "\\Find-GPOLocation.ps1",
                  "\\Find-TrustedDocuments.ps1",
                  "\\FireBuster.ps1",
                  "\\FireListener.ps1",
                  "\\Get-ApplicationHost.ps1",
                  "\\Get-ChromeDump.ps1",
                  "\\Get-ClipboardContents.ps1",
                  "\\Get-ComputerDetail.ps1",
                  "\\Get-FoxDump.ps1",
                  "\\Get-GPPAutologon.ps1",
                  "\\Get-GPPPassword.ps1",
                  "\\Get-IndexedItem.ps1",
                  "\\Get-Keystrokes.ps1",
                  "\\Get-LSASecret.ps1",
                  "\\Get-MicrophoneAudio.ps1",
                  "\\Get-PassHashes.ps1",
                  "\\Get-PassHints.ps1",
                  "\\Get-RegAlwaysInstallElevated.ps1",
                  "\\Get-RegAutoLogon.ps1",
                  "\\Get-RickAstley.ps1",
                  "\\Get-Screenshot.ps1",
                  "\\Get-SecurityPackages.ps1",
                  "\\Get-ServiceFilePermission.ps1",
                  "\\Get-ServicePermission.ps1",
                  "\\Get-ServiceUnquoted.ps1",
                  "\\Get-SiteListPassword.ps1",
                  "\\Get-System.ps1",
                  "\\Get-TimedScreenshot.ps1",
                  "\\Get-UnattendedInstallFile.ps1",
                  "\\Get-Unconstrained.ps1",
                  "\\Get-USBKeystrokes.ps1",
                  "\\Get-VaultCredential.ps1",
                  "\\Get-VulnAutoRun.ps1",
                  "\\Get-VulnSchTask.ps1",
                  "\\Get-WebConfig.ps1",
                  "\\Get-WebCredentials.ps1",
                  "\\Get-WLAN-Keys.ps1",
                  "\\Gupt-Backdoor.ps1",
                  "\\HTTP-Backdoor.ps1",
                  "\\HTTP-Login.ps1",
                  "\\Install-ServiceBinary.ps1",
                  "\\Install-SSP.ps1",
                  "\\Invoke-ACLScanner.ps1",
                  "\\Invoke-ADSBackdoor.ps1",
                  "\\Invoke-AmsiBypass.ps1",
                  "\\Invoke-ARPScan.ps1",
                  "\\Invoke-BackdoorLNK.ps1",
                  "\\Invoke-BadPotato.ps1",
                  "\\Invoke-BetterSafetyKatz.ps1",
                  "\\Invoke-BruteForce.ps1",
                  "\\Invoke-BypassUAC.ps1",
                  "\\Invoke-Carbuncle.ps1",
                  "\\Invoke-Certify.ps1",
                  "\\Invoke-ConPtyShell.ps1",
                  "\\Invoke-CredentialInjection.ps1",
                  "\\Invoke-CredentialsPhish.ps1",
                  "\\Invoke-DAFT.ps1",
                  "\\Invoke-DCSync.ps1",
                  "\\Invoke-Decode.ps1",
                  "\\Invoke-DinvokeKatz.ps1",
                  "\\Invoke-DllInjection.ps1",
                  "\\Invoke-DNSExfiltrator.ps1",
                  "\\Invoke-DNSUpdate.ps1",
                  "\\Invoke-DowngradeAccount.ps1",
                  "\\Invoke-EgressCheck.ps1",
                  "\\Invoke-Encode.ps1",
                  "\\Invoke-EventViewer.ps1",
                  "\\Invoke-Eyewitness.ps1",
                  "\\Invoke-FakeLogonScreen.ps1",
                  "\\Invoke-Farmer.ps1",
                  "\\Invoke-Get-RBCD-Threaded.ps1",
                  "\\Invoke-Gopher.ps1",
                  "\\Invoke-Grouper2.ps1",
                  "\\Invoke-Grouper3.ps1",
                  "\\Invoke-HandleKatz.ps1",
                  "\\Invoke-Interceptor.ps1",
                  "\\Invoke-Internalmonologue.ps1",
                  "\\Invoke-Inveigh.ps1",
                  "\\Invoke-InveighRelay.ps1",
                  "\\Invoke-JSRatRegsvr.ps1",
                  "\\Invoke-JSRatRundll.ps1",
                  "\\Invoke-KrbRelay.ps1",
                  "\\Invoke-KrbRelayUp.ps1",
                  "\\Invoke-LdapSignCheck.ps1",
                  "\\Invoke-Lockless.ps1",
                  "\\Invoke-MalSCCM.ps1",
                  "\\Invoke-Mimikatz.ps1",
                  "\\Invoke-MimikatzWDigestDowngrade.ps1",
                  "\\Invoke-Mimikittenz.ps1",
                  "\\Invoke-MITM6.ps1",
                  "\\Invoke-NanoDump.ps1",
                  "\\Invoke-NetRipper.ps1",
                  "\\Invoke-NetworkRelay.ps1",
                  "\\Invoke-NinjaCopy.ps1",
                  "\\Invoke-OxidResolver.ps1",
                  "\\Invoke-P0wnedshell.ps1",
                  "\\Invoke-P0wnedshellx86.ps1",
                  "\\Invoke-Paranoia.ps1",
                  "\\Invoke-PortScan.ps1",
                  "\\Invoke-PoshRatHttp.ps1",
                  "\\Invoke-PoshRatHttps.ps1",
                  "\\Invoke-PostExfil.ps1",
                  "\\Invoke-PowerDump.ps1",
                  "\\Invoke-PowerDPAPI.ps1",
                  "\\Invoke-PowerShellIcmp.ps1",
                  "\\Invoke-PowerShellTCP.ps1",
                  "\\Invoke-PowerShellTcpOneLine.ps1",
                  "\\Invoke-PowerShellTcpOneLineBind.ps1",
                  "\\Invoke-PowerShellUdp.ps1",
                  "\\Invoke-PowerShellUdpOneLine.ps1",
                  "\\Invoke-PowerShellWMI.ps1",
                  "\\Invoke-PowerThIEf.ps1",
                  "\\Invoke-PPLDump.ps1",
                  "\\Invoke-Prasadhak.ps1",
                  "\\Invoke-PsExec.ps1",
                  "\\Invoke-PsGcat.ps1",
                  "\\Invoke-PsGcatAgent.ps1",
                  "\\Invoke-PSInject.ps1",
                  "\\Invoke-PsUaCme.ps1",
                  "\\Invoke-ReflectivePEInjection.ps1",
                  "\\Invoke-ReverseDNSLookup.ps1",
                  "\\Invoke-Rubeus.ps1",
                  "\\Invoke-RunAs.ps1",
                  "\\Invoke-SafetyKatz.ps1",
                  "\\Invoke-SauronEye.ps1",
                  "\\Invoke-SCShell.ps1",
                  "\\Invoke-Seatbelt.ps1",
                  "\\Invoke-ServiceAbuse.ps1",
                  "\\Invoke-SessionGopher.ps1",
                  "\\Invoke-ShellCode.ps1",
                  "\\Invoke-SMBScanner.ps1",
                  "\\Invoke-Snaffler.ps1",
                  "\\Invoke-Spoolsample.ps1",
                  "\\Invoke-SSHCommand.ps1",
                  "\\Invoke-SSIDExfil.ps1",
                  "\\Invoke-StandIn.ps1",
                  "\\Invoke-StickyNotesExtract.ps1",
                  "\\Invoke-Tater.ps1",
                  "\\Invoke-Thunderfox.ps1",
                  "\\Invoke-ThunderStruck.ps1",
                  "\\Invoke-TokenManipulation.ps1",
                  "\\Invoke-Tokenvator.ps1",
                  "\\Invoke-TotalExec.ps1",
                  "\\Invoke-UrbanBishop.ps1",
                  "\\Invoke-UserHunter.ps1",
                  "\\Invoke-VoiceTroll.ps1",
                  "\\Invoke-Whisker.ps1",
                  "\\Invoke-WinEnum.ps1",
                  "\\Invoke-winPEAS.ps1",
                  "\\Invoke-WireTap.ps1",
                  "\\Invoke-WmiCommand.ps1",
                  "\\Invoke-WScriptBypassUAC.ps1",
                  "\\Invoke-Zerologon.ps1",
                  "\\Keylogger.ps1",
                  "\\MailRaider.ps1",
                  "\\New-HoneyHash.ps1",
                  "\\OfficeMemScraper.ps1",
                  "\\Offline_Winpwn.ps1",
                  "\\Out-CHM.ps1",
                  "\\Out-DnsTxt.ps1",
                  "\\Out-Excel.ps1",
                  "\\Out-HTA.ps1",
                  "\\Out-Java.ps1",
                  "\\Out-JS.ps1",
                  "\\Out-Minidump.ps1",
                  "\\Out-RundllCommand.ps1",
                  "\\Out-SCF.ps1",
                  "\\Out-SCT.ps1",
                  "\\Out-Shortcut.ps1",
                  "\\Out-WebQuery.ps1",
                  "\\Out-Word.ps1",
                  "\\Parse_Keys.ps1",
                  "\\Port-Scan.ps1",
                  "\\PowerBreach.ps1",
                  "\\powercat.ps1",
                  "\\Powermad.ps1",
                  "\\PowerRunAsSystem.psm1",
                  "\\PowerSharpPack.ps1",
                  "\\PowerUp.ps1",
                  "\\PowerUpSQL.ps1",
                  "\\PowerView.ps1",
                  "\\PSAsyncShell.ps1",
                  "\\RemoteHashRetrieval.ps1",
                  "\\Remove-Persistence.ps1",
                  "\\Remove-PoshRat.ps1",
                  "\\Remove-Update.ps1",
                  "\\Run-EXEonRemote.ps1",
                  "\\Schtasks-Backdoor.ps1",
                  "\\Set-DCShadowPermissions.ps1",
                  "\\Set-MacAttribute.ps1",
                  "\\Set-RemotePSRemoting.ps1",
                  "\\Set-RemoteWMI.ps1",
                  "\\Set-Wallpaper.ps1",
                  "\\Show-TargetScreen.ps1",
                  "\\Speak.ps1",
                  "\\Start-CaptureServer.ps1",
                  "\\Start-WebcamRecorder.ps1",
                  "\\StringToBase64.ps1",
                  "\\TexttoExe.ps1",
                  "\\Veeam-Get-Creds.ps1",
                  "\\VolumeShadowCopyTools.ps1",
                  "\\WinPwn.ps1",
                  "\\WSUSpendu.ps1"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_invoke_sharp": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "Invoke-Sharp",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".ps1",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Markus Neis, Nasreddine Bencherchali (Nextron Systems), Mustafa Kaan Demir, Georg Lauenstein",
        "date": "2018-04-07",
        "modified": "2025-12-10",
        "references": [
          "https://github.com/PowerShellMafia/PowerSploit",
          "https://github.com/NetSPI/PowerUpSQL",
          "https://github.com/CsEnox/EventViewer-UACBypass",
          "https://web.archive.org/web/20210511204621/https://github.com/AlsidOfficial/WSUSpendu",
          "https://github.com/nettitude/Invoke-PowerThIEf",
          "https://github.com/S3cur3Th1sSh1t/WinPwn",
          "https://github.com/S3cur3Th1sSh1t/PowerSharpPack/tree/master/PowerSharpBinaries",
          "https://github.com/BC-SECURITY/Invoke-ZeroLogon/blob/111d17c7fec486d9bb23387e2e828b09a26075e4/Invoke-ZeroLogon.ps1",
          "https://github.com/xorrior/RandomPS-Scripts/blob/848c919bfce4e2d67b626cbcf4404341cfe3d3b6/Get-DXWebcamVideo.ps1",
          "https://github.com/rvrsh3ll/Misc-Powershell-Scripts/blob/6f23bb41f9675d7e2d32bacccff75e931ae00554/OfficeMemScraper.ps1",
          "https://github.com/dafthack/DomainPasswordSpray/blob/b13d64a5834694aa73fd2aea9911a83027c465a7/DomainPasswordSpray.ps1",
          "https://unit42.paloaltonetworks.com/threat-assessment-black-basta-ransomware/",
          "https://research.nccgroup.com/2022/06/06/shining-the-light-on-black-basta/",
          "https://github.com/HarmJ0y/DAMP",
          "https://github.com/samratashok/nishang",
          "https://github.com/DarkCoderSc/PowerRunAsSystem/",
          "https://github.com/besimorhino/powercat",
          "https://github.com/Kevin-Robertson/Powermad",
          "https://github.com/adrecon/ADRecon",
          "https://github.com/adrecon/AzureADRecon",
          "https://github.com/sadshade/veeam-creds/blob/6010eaf31ba41011b58d6af3950cffbf6f5cea32/Veeam-Get-Creds.ps1",
          "https://github.com/The-Viper-One/Invoke-PowerDPAPI/",
          "https://github.com/Arno0x/DNSExfiltrator/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_powershell_exploit_scripts.yml"
      }
    },
    {
      "id": "0e29e3a7-1ad8-40aa-b691-9f82ecd33d66",
      "title": "Office Macro File Download",
      "status": "test",
      "description": "Detects the creation of a new office macro files on the system via an application (browser, mail client).\nThis can help identify potential malicious activity, such as the download of macro-enabled documents that could be used for exploitation.\n",
      "level": "low",
      "tags": [
        "attack.initial-access",
        "attack.t1566.001"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_processes": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\RuntimeBroker.exe",
                  "\\outlook.exe",
                  "\\thunderbird.exe",
                  "\\brave.exe",
                  "\\chrome.exe",
                  "\\firefox.exe",
                  "\\iexplore.exe",
                  "\\maxthon.exe",
                  "\\MicrosoftEdge.exe",
                  "\\msedge.exe",
                  "\\msedgewebview2.exe",
                  "\\opera.exe",
                  "\\safari.exe",
                  "\\seamonkey.exe",
                  "\\vivaldi.exe",
                  "\\whale.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_ext": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "TargetFilename__endswith": {
                    "field": "TargetFilename",
                    "value": [
                      ".docm",
                      ".dotm",
                      ".xlsm",
                      ".xltm",
                      ".potm",
                      ".pptm"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "TargetFilename__contains": {
                    "field": "TargetFilename",
                    "value": [
                      ".docm:Zone",
                      ".dotm:Zone",
                      ".xlsm:Zone",
                      ".xltm:Zone",
                      ".potm:Zone",
                      ".pptm:Zone"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1566.001"
        ],
        "tactics": [
          "initial_access"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-01-23",
        "modified": "2025-10-29",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1566.001/T1566.001.md",
          "https://learn.microsoft.com/en-us/deployoffice/compat/office-file-format-reference"
        ],
        "falsepositives": [
          "Legitimate macro files downloaded from the internet",
          "Legitimate macro files sent as attachments via emails"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_office_macro_files_downloaded.yml"
      }
    },
    {
      "id": "2f9356ae-bf43-41b8-b858-4496d83b2acb",
      "title": "ISO File Created Within Temp Folders",
      "status": "test",
      "description": "Detects the creation of a ISO file in the Outlook temp folder or in the Appdata temp folder. Typical of Qakbot TTP from end-July 2022.",
      "level": "high",
      "tags": [
        "attack.initial-access",
        "attack.t1566.001"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_1": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains_all": {
                "field": "TargetFilename",
                "value": [
                  "\\AppData\\Local\\Temp\\",
                  ".zip\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".iso",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_2": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\AppData\\Local\\Microsoft\\Windows\\INetCache\\Content.Outlook\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".iso",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1566.001"
        ],
        "tactics": [
          "initial_access"
        ]
      },
      "meta": {
        "author": "@sam0x90",
        "date": "2022-07-30",
        "modified": "",
        "references": [
          "https://twitter.com/Sam0x90/status/1552011547974696960",
          "https://securityaffairs.co/wordpress/133680/malware/dll-sideloading-spread-qakbot.html",
          "https://github.com/redcanaryco/atomic-red-team/blob/0f229c0e42bfe7ca736a14023836d65baa941ed2/atomics/T1553.005/T1553.005.md#atomic-test-1---mount-iso-image"
        ],
        "falsepositives": [
          "Potential FP by sysadmin opening a zip file containing a legitimate ISO file"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_iso_file_mount.yml"
      }
    },
    {
      "id": "fec96f39-988b-4586-b746-b93d59fd1922",
      "title": "ScreenConnect Temporary Installation Artefact",
      "status": "test",
      "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1219.002"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\Bin\\ScreenConnect.",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1219.002"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-02-13",
        "modified": "",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-5---screenconnect-application-download-and-install-on-windows"
        ],
        "falsepositives": [
          "Legitimate use"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_remote_access_tools_screenconnect_artefact.yml"
      }
    },
    {
      "id": "7d604714-e071-49ff-8726-edeb95a70679",
      "title": "Legitimate Application Dropped Script",
      "status": "test",
      "description": "Detects programs on a Windows system that should not write scripts to disk",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\eqnedt32.exe",
                  "\\wordpad.exe",
                  "\\wordview.exe",
                  "\\certutil.exe",
                  "\\certoc.exe",
                  "\\CertReq.exe",
                  "\\Desktopimgdownldr.exe",
                  "\\esentutl.exe",
                  "\\mshta.exe",
                  "\\AcroRd32.exe",
                  "\\RdrCEF.exe",
                  "\\hh.exe",
                  "\\finger.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".ps1",
                  ".bat",
                  ".vbs",
                  ".scf",
                  ".wsf",
                  ".wsh"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113, Florian Roth (Nextron Systems)",
        "date": "2022-08-21",
        "modified": "2023-06-22",
        "references": [
          "https://github.com/Neo23x0/sysmon-config/blob/3f808d9c022c507aae21a9346afba4a59dd533b9/sysmonconfig-export-block.xml#L1326"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_susp_legitimate_app_dropping_script.yml"
      }
    },
    {
      "id": "8e1cb247-6cf6-42fa-b440-3f27d57e9936",
      "title": "Potential Persistence Via Microsoft Office Add-In",
      "status": "test",
      "description": "Detects potential persistence activity via startup add-ins that load when Microsoft Office starts (.wll/.xll are simply .dll fit for Word or Excel).",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.t1137.006"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_wlldropped": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\Microsoft\\Word\\Startup\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".wll",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_xlldropped": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\Microsoft\\Excel\\Startup\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".xll",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_xladropped": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "Microsoft\\Excel\\XLSTART\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".xlam",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_generic": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\Microsoft\\Addins\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".xlam",
                  ".xla",
                  ".ppam"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1137.006"
        ],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "NVISO",
        "date": "2020-05-11",
        "modified": "2023-02-08",
        "references": [
          "Internal Research",
          "https://labs.withsecure.com/publications/add-in-opportunities-for-office-persistence",
          "https://github.com/redcanaryco/atomic-red-team/blob/4ae9580a1a8772db87a1b6cdb0d03e5af231e966/atomics/T1137.006/T1137.006.md"
        ],
        "falsepositives": [
          "Legitimate add-ins"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_office_addin_persistence.yml"
      }
    },
    {
      "id": "1908fcc1-1b92-4272-8214-0fbaf2fa5163",
      "title": "Malicious DLL File Dropped in the Teams or OneDrive Folder",
      "status": "test",
      "description": "Detects creation of a malicious DLL file in the location where the OneDrive or Team applications\nUpon execution of the Teams or OneDrive application, the dropped malicious DLL file (\"iphlpapi.dll\") is sideloaded\n",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.privilege-escalation",
        "attack.defense-evasion",
        "attack.t1574.001"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains_all": {
                "field": "TargetFilename",
                "value": [
                  "iphlpapi.dll",
                  "\\AppData\\Local\\Microsoft"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1574.001"
        ],
        "tactics": [
          "persistence",
          "privilege_escalation",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-08-12",
        "modified": "",
        "references": [
          "https://blog.cyble.com/2022/07/27/targeted-attacks-being-carried-out-via-dll-sideloading/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_iphlpapi_dll_sideloading.yml"
      }
    },
    {
      "id": "ee63c85c-6d51-4d12-ad09-04e25877a947",
      "title": "New Custom Shim Database Created",
      "status": "test",
      "description": "Adversaries may establish persistence and/or elevate privileges by executing malicious content triggered by application shims.\nThe Microsoft Windows Application Compatibility Infrastructure/Framework (Application Shim) was created to allow for backward compatibility of software as the operating system codebase changes over time.\n",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547.009"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  ":\\Windows\\apppatch\\Custom\\",
                  ":\\Windows\\apppatch\\CustomSDB\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1547.009"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2021-12-29",
        "modified": "2023-12-06",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1546.011/T1546.011.md#atomic-test-2---new-shim-database-files-created-in-the-default-shim-database-directory",
          "https://www.mandiant.com/resources/blog/fin7-shim-databases-persistence",
          "https://liberty-shell.com/sec/2020/02/25/shim-persistence/",
          "https://andreafortuna.org/2018/11/12/process-injection-and-persistence-using-application-shimming/"
        ],
        "falsepositives": [
          "Legitimate custom SHIM installations will also trigger this rule"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_creation_new_shim_database.yml"
      }
    },
    {
      "id": "e890acee-d488-420e-8f20-d9b19b3c3d43",
      "title": "Suspicious File Created by ArcSOC.exe",
      "status": "experimental",
      "description": "Detects instances where the ArcGIS Server process ArcSOC.exe, which hosts REST services running on an ArcGIS\nserver, creates a file with suspicious file type, indicating that it may be an executable, script file,\nor otherwise unusual.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.command-and-control",
        "attack.persistence",
        "attack.initial-access",
        "attack.t1127",
        "attack.t1105",
        "attack.t1133"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\ArcSOC.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".ahk",
                  ".aspx",
                  ".au3",
                  ".bat",
                  ".cmd",
                  ".dll",
                  ".exe",
                  ".hta",
                  ".js",
                  ".ps1",
                  ".py",
                  ".vbe",
                  ".vbs",
                  ".wsf"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1127",
          "T1105",
          "T1133"
        ],
        "tactics": [
          "defense_evasion",
          "command_and_control",
          "persistence",
          "initial_access"
        ]
      },
      "meta": {
        "author": "Micah Babinski",
        "date": "2025-11-25",
        "modified": "",
        "references": [
          "https://reliaquest.com/blog/threat-spotlight-inside-flax-typhoons-arcgis-compromise/",
          "https://enterprise.arcgis.com/en/server/12.0/administer/windows/inside-an-arcgis-server-site.htm"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_arcsoc_susp_file_created.yml"
      }
    },
    {
      "id": "145095eb-e273-443b-83d0-f9b519b7867b",
      "title": "PDF File Created By RegEdit.EXE",
      "status": "test",
      "description": "Detects the creation of a file with the \".pdf\" extension by the \"RegEdit.exe\" process.\nThis indicates that a user is trying to print/save a registry key as a PDF in order to potentially extract sensitive information and bypass defenses.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\regedit.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".pdf",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2024-07-08",
        "modified": "",
        "references": [
          "https://sensepost.com/blog/2024/dumping-lsa-secrets-a-story-about-task-decorrelation/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_regedit_print_as_pdf.yml"
      }
    },
    {
      "id": "0a1255c5-d732-4b62-ac02-b5152d34fb83",
      "title": "ADExplorer Writing Complete AD Snapshot Into .dat File",
      "status": "experimental",
      "description": "Detects the dual use tool ADExplorer writing a complete AD snapshot into a .dat file. This can be used by attackers to extract data for Bloodhound, usernames for password spraying or use the meta data for social engineering. The snapshot doesn't contain password hashes but there have been cases, where administrators put passwords in the comment field.",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.t1087.002",
        "attack.t1069.002",
        "attack.t1482"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\ADExp.exe",
                  "\\ADExplorer.exe",
                  "\\ADExplorer64.exe",
                  "\\ADExplorer64a.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".dat",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1087.002",
          "T1069.002",
          "T1482"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Arnim Rupp (Nextron Systems), Thomas Patzke",
        "date": "2025-07-09",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/de-de/sysinternals/downloads/adexplorer",
          "https://github.com/c3c/ADExplorerSnapshot.py/tree/f700904defac330802bbfedd1d8ffd9248f4ee24",
          "https://www.packetlabs.net/posts/scattered-spider-is-a-young-ransomware-gang-exploiting-large-corporations/",
          "https://www.nccgroup.com/us/research-blog/lapsus-recent-techniques-tactics-and-procedures/",
          "https://trustedsec.com/blog/adexplorer-on-engagements"
        ],
        "falsepositives": [
          "Legitimate use of ADExplorer by administrators creating .dat snapshots"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_sysinternals_adexplorer_dump_written.yml"
      }
    },
    {
      "id": "8c3c76ca-8f8b-4b1d-aaf3-81aebcd367c9",
      "title": "Creation Exe for Service with Unquoted Path",
      "status": "test",
      "description": "Adversaries may execute their own malicious payloads by hijacking vulnerable file path references.\nAdversaries can take advantage of paths that lack surrounding quotations by placing an executable in a higher level directory within the path, so that Windows will choose the adversary's executable to launch.\n",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547.009"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename": {
                "field": "TargetFilename",
                "value": "C:\\program.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1547.009"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-12-30",
        "modified": "",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1574.009/T1574.009.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_creation_unquoted_service_path.yml"
      }
    },
    {
      "id": "847def9e-924d-4e90-b7c4-5f581395a2b4",
      "title": "HackTool - QuarksPwDump Dump File",
      "status": "test",
      "description": "Detects a dump file written by QuarksPwDump password dumper",
      "level": "critical",
      "tags": [
        "attack.credential-access",
        "attack.t1003.002"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains_all": {
                "field": "TargetFilename",
                "value": [
                  "\\AppData\\Local\\Temp\\SAM-",
                  ".dmp"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.002"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2018-02-10",
        "modified": "2024-06-27",
        "references": [
          "https://jpcertcc.github.io/ToolAnalysisResultSheet/details/QuarksPWDump.htm"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_hktl_quarkspw_filedump.yml"
      }
    },
    {
      "id": "07a99744-56ac-40d2-97b7-2095967b0e03",
      "title": "Potential Privilege Escalation Attempt Via .Exe.Local Technique",
      "status": "test",
      "description": "Detects potential privilege escalation attempt via the creation of the \"*.Exe.Local\" folder inside the \"System32\" directory in order to sideload \"comctl32.dll\"",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.persistence",
        "attack.privilege-escalation"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": [
                  "C:\\Windows\\System32\\logonUI.exe.local",
                  "C:\\Windows\\System32\\werFault.exe.local",
                  "C:\\Windows\\System32\\consent.exe.local",
                  "C:\\Windows\\System32\\narrator.exe.local",
                  "C:\\Windows\\System32\\wermgr.exe.local"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "\\comctl32.dll",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion",
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), Subhash P (@pbssubhash)",
        "date": "2022-12-16",
        "modified": "2022-12-19",
        "references": [
          "https://github.com/binderlabs/DirCreate2System",
          "https://github.com/sailay1996/awesome_windows_logical_bugs/blob/60cbb23a801f4c3195deac1cc46df27c225c3d07/dir_create2system.txt"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_system32_local_folder_privilege_escalation.yml"
      }
    },
    {
      "id": "e3845023-ca9a-4024-b2b2-5422156d5527",
      "title": "PowerShell Module File Created By Non-PowerShell Process",
      "status": "test",
      "description": "Detects the creation of a new PowerShell module \".psm1\", \".psd1\", \".dll\", \".ps1\", etc. by a non-PowerShell process",
      "level": "medium",
      "tags": [
        "attack.persistence"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  "\\WindowsPowerShell\\Modules\\",
                  "\\PowerShell\\7\\Modules\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_pwsh": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  ":\\Program Files\\PowerShell\\7-preview\\pwsh.exe",
                  ":\\Program Files\\PowerShell\\7\\pwsh.exe",
                  ":\\Windows\\System32\\poqexec.exe",
                  ":\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell_ise.exe",
                  ":\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",
                  ":\\Windows\\SysWOW64\\poqexec.exe",
                  ":\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell_ise.exe",
                  ":\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_msiexec": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Windows\\System32\\msiexec.exe",
                  "C:\\Windows\\SysWOW64\\msiexec.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-09",
        "modified": "2025-10-07",
        "references": [
          "Internal Research",
          "https://learn.microsoft.com/en-us/powershell/scripting/developer/module/understanding-a-windows-powershell-module?view=powershell-7.3"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_powershell_module_uncommon_creation.yml"
      }
    },
    {
      "id": "4358e5a5-7542-4dcb-b9f3-87667371839b",
      "title": "ISO or Image Mount Indicator in Recent Files",
      "status": "test",
      "description": "Detects the creation of recent element file that points to an .ISO, .IMG, .VHD or .VHDX file as often used in phishing attacks.\nThis can be a false positive on server systems but on workstations users should rarely mount .iso or .img files.\n",
      "level": "medium",
      "tags": [
        "attack.initial-access",
        "attack.t1566.001"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".iso.lnk",
                  ".img.lnk",
                  ".vhd.lnk",
                  ".vhdx.lnk"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\Microsoft\\Windows\\Recent\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1566.001"
        ],
        "tactics": [
          "initial_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-02-11",
        "modified": "",
        "references": [
          "https://www.microsoft.com/security/blog/2021/05/27/new-sophisticated-email-based-attack-from-nobelium/",
          "https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/malicious-spam-campaign-uses-iso-image-files-to-deliver-lokibot-and-nanocore",
          "https://blog.emsisoft.com/en/32373/beware-new-wave-of-malware-spreads-via-iso-file-email-attachments/",
          "https://insights.sei.cmu.edu/blog/the-dangers-of-vhd-and-vhdx-files/"
        ],
        "falsepositives": [
          "Cases in which a user mounts an image file for legitimate reasons"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_iso_file_recent.yml"
      }
    },
    {
      "id": "b4926b47-a9d7-434c-b3a0-adc3fa0bd13e",
      "title": "Suspicious Double Extension Files",
      "status": "test",
      "description": "Detects dropped files with double extensions, which is often used by malware as a method to abuse the fact that Windows hide default extensions by default.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036.007"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_gen": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".exe",
                  ".iso",
                  ".rar",
                  ".svg",
                  ".zip"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  ".doc.",
                  ".docx.",
                  ".gif.",
                  ".jpeg.",
                  ".jpg.",
                  ".mp3.",
                  ".mp4.",
                  ".pdf.",
                  ".png.",
                  ".ppt.",
                  ".pptx.",
                  ".rtf.",
                  ".svg.",
                  ".txt.",
                  ".xls.",
                  ".xlsx."
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_exe": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".rar.exe",
                  ".zip.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1036.007"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), frack113",
        "date": "2022-06-19",
        "modified": "2025-07-22",
        "references": [
          "https://www.crowdstrike.com/blog/meet-crowdstrikes-adversary-of-the-month-for-june-mustang-panda/",
          "https://www.anomali.com/blog/china-based-apt-mustang-panda-targets-minority-groups-public-and-private-sector-organizations",
          "https://www.cybereason.com/blog/research/a-bazar-of-tricks-following-team9s-development-cycles",
          "https://twitter.com/malwrhunterteam/status/1235135745611960321",
          "https://twitter.com/luc4m/status/1073181154126254080",
          "https://cloud.google.com/blog/topics/threat-intelligence/cybercriminals-weaponize-fake-ai-websites",
          "https://vipre.com/blog/svg-phishing-attacks-the-new-trick-in-the-cybercriminals-playbook/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_susp_double_extension.yml"
      }
    },
    {
      "id": "576426ad-0131-4001-ae01-be175da0c108",
      "title": "PowerShell Script Dropped Via PowerShell.EXE",
      "status": "test",
      "description": "Detects PowerShell creating a PowerShell file (.ps1). While often times this behavior is benign, sometimes it can be a sign of a dropper script trying to achieve persistence.",
      "level": "low",
      "tags": [
        "attack.persistence"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\powershell.exe",
                  "\\pwsh.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".ps1",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_psscriptpolicytest": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "__PSScriptPolicyTest_",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_appdata": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": "C:\\Users\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\AppData\\Local\\Temp\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_windows_temp": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": "C:\\Windows\\Temp\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2023-05-09",
        "modified": "",
        "references": [
          "https://www.zscaler.com/blogs/security-research/onenote-growing-threat-malware-distribution"
        ],
        "falsepositives": [
          "False positives will differ depending on the environment and scripts used. Apply additional filters accordingly."
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_powershell_drop_powershell.yml"
      }
    },
    {
      "id": "0e20c89d-2264-44ae-8238-aeeaba609ece",
      "title": "Potential Persistence Via Microsoft Office Startup Folder",
      "status": "test",
      "description": "Detects creation of Microsoft Office files inside of one of the default startup folders in order to achieve persistence.",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.t1137"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_word_paths": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "TargetFilename__contains": {
                    "field": "TargetFilename",
                    "value": "\\Microsoft\\Word\\STARTUP",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "TargetFilename__contains_all": {
                    "field": "TargetFilename",
                    "value": [
                      "\\Office",
                      "\\Program Files",
                      "\\STARTUP"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_word_extension": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".doc",
                  ".docm",
                  ".docx",
                  ".dot",
                  ".dotm",
                  ".rtf"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_excel_paths": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "TargetFilename__contains": {
                    "field": "TargetFilename",
                    "value": "\\Microsoft\\Excel\\XLSTART",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "TargetFilename__contains_all": {
                    "field": "TargetFilename",
                    "value": [
                      "\\Office",
                      "\\Program Files",
                      "\\XLSTART"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_excel_extension": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".xls",
                  ".xlsm",
                  ".xlsx",
                  ".xlt",
                  ".xltm"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_office": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\WINWORD.exe",
                  "\\EXCEL.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "(all of selection_word_* or all of selection_excel_*) and not filter_main_office",
        "condition_parsed": {
          "op": "complex_and_not",
          "include": {
            "op": "or",
            "operands": [
              "all of selection_word_*",
              "all of selection_excel_*"
            ]
          },
          "exclude": "filter_main_office"
        }
      },
      "mitre": {
        "techniques": [
          "T1137"
        ],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "Max Altgelt (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-06-02",
        "modified": "2023-06-22",
        "references": [
          "https://insight-jp.nttsecurity.com/post/102hojk/operation-restylink-apt-campaign-targeting-japanese-companies",
          "https://learn.microsoft.com/en-us/office/troubleshoot/excel/use-startup-folders"
        ],
        "falsepositives": [
          "Loading a user environment from a backup or a domain controller",
          "Synchronization of templates"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_office_startup_persistence.yml"
      }
    },
    {
      "id": "3215aa19-f060-4332-86d5-5602511f3ca8",
      "title": "Suspicious LNK Double Extension File Created",
      "status": "test",
      "description": "Detects the creation of files with an \"LNK\" as a second extension. This is sometimes used by malware as a method to abuse the fact that Windows hides the \"LNK\" extension by default.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036.007"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".lnk",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  ".doc.",
                  ".docx.",
                  ".jpg.",
                  ".pdf.",
                  ".ppt.",
                  ".pptx.",
                  ".xls.",
                  ".xlsx."
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_recent": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\AppData\\Roaming\\Microsoft\\Windows\\Recent\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_office_recent": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\excel.exe",
                  "\\powerpnt.exe",
                  "\\winword.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\AppData\\Roaming\\Microsoft\\Office\\Recent\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_office_excel": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\excel.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\AppData\\Roaming\\Microsoft\\Excel",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_office_powerpoint": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\powerpnt.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\AppData\\Roaming\\Microsoft\\PowerPoint",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_office_word": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\winword.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\AppData\\Roaming\\Microsoft\\Word",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1036.007"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), frack113",
        "date": "2022-11-07",
        "modified": "2023-10-18",
        "references": [
          "https://www.crowdstrike.com/blog/meet-crowdstrikes-adversary-of-the-month-for-june-mustang-panda/",
          "https://www.anomali.com/blog/china-based-apt-mustang-panda-targets-minority-groups-public-and-private-sector-organizations",
          "https://www.cybereason.com/blog/research/a-bazar-of-tricks-following-team9s-development-cycles",
          "https://twitter.com/malwrhunterteam/status/1235135745611960321",
          "https://twitter.com/luc4m/status/1073181154126254080"
        ],
        "falsepositives": [
          "Some tuning is required for other general purpose directories of third party apps"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_susp_lnk_double_extension.yml"
      }
    },
    {
      "id": "162ab1e4-6874-4564-853c-53ec3ab8be01",
      "title": "TeamViewer Remote Session",
      "status": "test",
      "description": "Detects the creation of log files during a TeamViewer remote session",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1219.002"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection1": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  "\\TeamViewer\\RemotePrinting\\tvprint.db",
                  "\\TeamViewer\\TVNetwork.log"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection2": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains_all": {
                "field": "TargetFilename",
                "value": [
                  "\\TeamViewer",
                  "_Logfile.log"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1219.002"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-01-30",
        "modified": "",
        "references": [
          "https://www.teamviewer.com/en-us/"
        ],
        "falsepositives": [
          "Legitimate uses of TeamViewer in an organisation"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_susp_teamviewer_remote_session.yml"
      }
    },
    {
      "id": "62ed5b55-f991-406a-85d9-e8e8fdf18789",
      "title": "UAC Bypass Using Consent and Comctl32 - File",
      "status": "test",
      "description": "Detects the pattern of UAC Bypass using consent.exe and comctl32.dll (UACMe 22)",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": "C:\\Windows\\System32\\consent.exe.@",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "\\comctl32.dll",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Christian Burkard (Nextron Systems)",
        "date": "2021-08-23",
        "modified": "2022-10-09",
        "references": [
          "https://github.com/hfiref0x/UACME"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_uac_bypass_consent_comctl32.yml"
      }
    },
    {
      "id": "bd1212e5-78da-431e-95fa-c58e3237a8e6",
      "title": "Suspicious ASPX File Drop by Exchange",
      "status": "test",
      "description": "Detects suspicious file type dropped by an Exchange component in IIS into a suspicious folder",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.t1505.003"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\w3wp.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "MSExchange",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  "FrontEnd\\HttpProxy\\",
                  "\\inetpub\\wwwroot\\aspnet_client\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_types": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".aspx",
                  ".asp",
                  ".ashx"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1505.003"
        ],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), MSTI (query, idea)",
        "date": "2022-10-01",
        "modified": "",
        "references": [
          "https://www.microsoft.com/security/blog/2022/09/30/analyzing-attacks-using-the-exchange-vulnerabilities-cve-2022-41040-and-cve-2022-41082/",
          "https://www.gteltsc.vn/blog/canh-bao-chien-dich-tan-cong-su-dung-lo-hong-zero-day-tren-microsoft-exchange-server-12714.html",
          "https://en.gteltsc.vn/blog/cap-nhat-nhe-ve-lo-hong-bao-mat-0day-microsoft-exchange-dang-duoc-su-dung-de-tan-cong-cac-to-chuc-tai-viet-nam-9685.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_exchange_webshell_drop.yml"
      }
    },
    {
      "id": "7fff6773-2baa-46de-a24a-b6eec1aba2d1",
      "title": "UAC Bypass Using NTFS Reparse Point - File",
      "status": "test",
      "description": "Detects the pattern of UAC Bypass using NTFS reparse point and wusa.exe DLL hijacking (UACMe 36)",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": "C:\\Users\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "\\AppData\\Local\\Temp\\api-ms-win-core-kernel32-legacy-l1.DLL",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Christian Burkard (Nextron Systems)",
        "date": "2021-08-30",
        "modified": "2022-10-09",
        "references": [
          "https://github.com/hfiref0x/UACME"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_uac_bypass_ntfs_reparse_point.yml"
      }
    },
    {
      "id": "6ea858a8-ba71-4a12-b2cc-5d83312404c7",
      "title": "HackTool - Typical HiveNightmare SAM File Export",
      "status": "test",
      "description": "Detects files written by the different tools that exploit HiveNightmare",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1552.001",
        "cve.2021-36934"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "TargetFilename__contains": {
                    "field": "TargetFilename",
                    "value": [
                      "\\hive_sam_",
                      "\\SAM-2021-",
                      "\\SAM-2022-",
                      "\\SAM-2023-",
                      "\\SAM-haxx",
                      "\\Sam.save"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "TargetFilename": {
                    "field": "TargetFilename",
                    "value": "C:\\windows\\temp\\sam",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1552.001"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-07-23",
        "modified": "2024-06-27",
        "references": [
          "https://github.com/GossiTheDog/HiveNightmare",
          "https://github.com/FireFart/hivenightmare/",
          "https://github.com/WiredPulse/Invoke-HiveNightmare",
          "https://twitter.com/cube0x0/status/1418920190759378944"
        ],
        "falsepositives": [
          "Files that accidentally contain these strings"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_hktl_hivenightmare_file_exports.yml"
      }
    },
    {
      "id": "a8f866e1-bdd4-425e-a27a-37619238d9c7",
      "title": "Potential Hidden Directory Creation Via NTFS INDEX_ALLOCATION Stream",
      "status": "test",
      "description": "Detects the creation of hidden file/folder with the \"::$index_allocation\" stream. Which can be used as a technique to prevent access to folder and files from tooling such as \"explorer.exe\" and \"powershell.exe\"\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1564.004"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "::$index_allocation",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1564.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Scoubi (@ScoubiMtl)",
        "date": "2023-10-09",
        "modified": "",
        "references": [
          "https://twitter.com/pfiatde/status/1681977680688738305",
          "https://soroush.me/blog/2010/12/a-dotty-salty-directory-a-secret-place-in-ntfs-for-secret-files/",
          "https://sec-consult.com/blog/detail/pentesters-windows-ntfs-tricks-collection/",
          "https://github.com/redcanaryco/atomic-red-team/blob/5c3b23002d2bbede3c07e7307165fc2a235a427d/atomics/T1564.004/T1564.004.md#atomic-test-5---create-hidden-directory-via-index_allocation",
          "https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-fscc/c54dec26-1551-4d3a-a0ea-4fa40f848eb3"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_susp_hidden_dir_index_allocation.yml"
      }
    },
    {
      "id": "5f87308a-0a5b-4623-ae15-d8fa1809bc60",
      "title": "Suspicious Files in Default GPO Folder",
      "status": "test",
      "description": "Detects the creation of copy of suspicious files (EXE/DLL) to the default GPO storage folder",
      "level": "medium",
      "tags": [
        "attack.t1036.005",
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\Policies\\{31B2F340-016D-11D2-945F-00C04FB984F9}\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".dll",
                  ".exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1036.005"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "elhoim",
        "date": "2022-04-28",
        "modified": "",
        "references": [
          "https://redcanary.com/blog/intelligence-insights-november-2021/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_susp_default_gpo_dir_write.yml"
      }
    },
    {
      "id": "760e75d8-c3b5-409b-a9bf-6130b4c4603f",
      "title": "Self Extraction Directive File Created In Potentially Suspicious Location",
      "status": "test",
      "description": "Detects the creation of Self Extraction Directive files (.sed) in a potentially suspicious location.\nThese files are used by the \"iexpress.exe\" utility in order to create self extracting packages.\nAttackers were seen abusing this utility and creating PE files with embedded \".sed\" entries.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  ":\\ProgramData\\",
                  ":\\Temp\\",
                  ":\\Windows\\System32\\Tasks\\",
                  ":\\Windows\\Tasks\\",
                  ":\\Windows\\Temp\\",
                  "\\AppData\\Local\\Temp\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".sed",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Joseliyo Sanchez, @Joseliyo_Jstnk",
        "date": "2024-02-05",
        "modified": "",
        "references": [
          "https://strontic.github.io/xcyclopedia/library/iexpress.exe-D594B2A33EFAFD0EABF09E3FDC05FCEA.html",
          "https://en.wikipedia.org/wiki/IExpress",
          "https://www.virustotal.com/gui/file/602f4ae507fa8de57ada079adff25a6c2a899bd25cd092d0af7e62cdb619c93c/behavior"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_sed_file_creation.yml"
      }
    },
    {
      "id": "81315b50-6b60-4d8f-9928-3466e1022515",
      "title": "Desktop.INI Created by Uncommon Process",
      "status": "test",
      "description": "Detects unusual processes accessing desktop.ini, which can be leveraged to alter how Explorer displays a folder's content (i.e. renaming files) without changing them on disk.",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547.009"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "\\desktop.ini",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_generic": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Windows\\",
                  "C:\\Program Files\\",
                  "C:\\Program Files (x86)\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_upgrade": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": "C:\\$WINDOWS.~BT\\NewOS\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_jetbrains": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Users\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\AppData\\Local\\JetBrains\\Toolbox\\bin\\7z.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\JetBrains\\apps\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_onedrive": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Users\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__contains": {
                "field": "Image",
                "value": "\\AppData\\Local\\Microsoft\\OneDrive\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1547.009"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Maxime Thiebaut (@0xThiebaut), Tim Shelton (HAWK.IO)",
        "date": "2020-03-19",
        "modified": "2025-12-09",
        "references": [
          "https://isc.sans.edu/forums/diary/Desktopini+as+a+postexploitation+tool/25912/"
        ],
        "falsepositives": [
          "Operations performed through Windows SCCM or equivalent",
          "Read only access list authority"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_desktop_ini_created_by_uncommon_process.yml"
      }
    },
    {
      "id": "11b1ed55-154d-4e82-8ad7-83739298f720",
      "title": "NTDS.DIT Creation By Uncommon Process",
      "status": "test",
      "description": "Detects creation of a file named \"ntds.dit\" (Active Directory Database) by an uncommon process or a process located in a suspicious directory",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003.002",
        "attack.t1003.003"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_ntds": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "\\ntds.dit",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_process_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\cmd.exe",
                  "\\cscript.exe",
                  "\\mshta.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\regsvr32.exe",
                  "\\rundll32.exe",
                  "\\wscript.exe",
                  "\\wsl.exe",
                  "\\wt.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_process_paths": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  "\\AppData\\",
                  "\\Temp\\",
                  "\\Public\\",
                  "\\PerfLogs\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_ntds and 1 of selection_process_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_ntds"
            },
            {
              "type": "ref",
              "value": "1 of selection_process_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1003.002",
          "T1003.003"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-01-11",
        "modified": "2022-07-14",
        "references": [
          "https://stealthbits.com/blog/extracting-password-hashes-from-the-ntds-dit-file/",
          "https://adsecurity.org/?p=2398"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_ntds_dit_uncommon_process.yml"
      }
    },
    {
      "id": "4e87b8e2-2ee9-4b2a-a715-4727d297ece0",
      "title": "Potential SAM Database Dump",
      "status": "test",
      "description": "Detects the creation of files that look like exports of the local SAM (Security Account Manager)",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003.002"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "TargetFilename__endswith": {
                    "field": "TargetFilename",
                    "value": [
                      "\\Temp\\sam",
                      "\\sam.sav",
                      "\\Intel\\sam",
                      "\\sam.hive",
                      "\\Perflogs\\sam",
                      "\\ProgramData\\sam",
                      "\\Users\\Public\\sam",
                      "\\AppData\\Local\\sam",
                      "\\AppData\\Roaming\\sam",
                      "_ShadowSteal.zip",
                      "\\Documents\\SAM.export",
                      ":\\sam"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "TargetFilename__contains": {
                    "field": "TargetFilename",
                    "value": [
                      "\\hive_sam_",
                      "\\sam.save",
                      "\\sam.export",
                      "\\~reg_sam.save",
                      "\\sam_backup",
                      "\\sam.bck",
                      "\\sam.backup"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.002"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-02-11",
        "modified": "2023-01-05",
        "references": [
          "https://github.com/search?q=CVE-2021-36934",
          "https://web.archive.org/web/20210725081645/https://github.com/cube0x0/CVE-2021-36934",
          "https://www.google.com/search?q=%22reg.exe+save%22+sam",
          "https://github.com/HuskyHacks/ShadowSteal",
          "https://github.com/FireFart/hivenightmare"
        ],
        "falsepositives": [
          "Rare cases of administrative activity"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_sam_dump.yml"
      }
    },
    {
      "id": "3a9fa2ec-30bc-4ebd-b49e-7c9cff225502",
      "title": "VsCode Powershell Profile Modification",
      "status": "test",
      "description": "Detects the creation or modification of a vscode related powershell profile which could indicate suspicious activity as the profile can be used as a mean of persistence",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.privilege-escalation",
        "attack.t1546.013"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "\\Microsoft.VSCode_profile.ps1",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1546.013"
        ],
        "tactics": [
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-24",
        "modified": "2023-01-06",
        "references": [
          "https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_profiles?view=powershell-7.2"
        ],
        "falsepositives": [
          "Legitimate use of the profile by developers or administrators"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_susp_vscode_powershell_profile.yml"
      }
    },
    {
      "id": "b1c50487-1967-4315-a026-6491686d860e",
      "title": "Office Macro File Creation From Suspicious Process",
      "status": "test",
      "description": "Detects the creation of a office macro file from a a suspicious process",
      "level": "high",
      "tags": [
        "attack.initial-access",
        "attack.t1566.001"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_cmd": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\cscript.exe",
                      "\\mshta.exe",
                      "\\regsvr32.exe",
                      "\\rundll32.exe",
                      "\\wscript.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "ParentImage__endswith": {
                    "field": "ParentImage",
                    "value": [
                      "\\cscript.exe",
                      "\\mshta.exe",
                      "\\regsvr32.exe",
                      "\\rundll32.exe",
                      "\\wscript.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_ext": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".docm",
                  ".dotm",
                  ".xlsm",
                  ".xltm",
                  ".potm",
                  ".pptm"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1566.001"
        ],
        "tactics": [
          "initial_access"
        ]
      },
      "meta": {
        "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-01-23",
        "modified": "2023-02-22",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1566.001/T1566.001.md",
          "https://learn.microsoft.com/en-us/deployoffice/compat/office-file-format-reference"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_office_macro_files_from_susp_process.yml"
      }
    },
    {
      "id": "2aa0a6b4-a865-495b-ab51-c28249537b75",
      "title": "Startup Folder File Write",
      "status": "test",
      "description": "A General detection for files being created in the Windows startup directory. This could be an indicator of persistence.",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547.001"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\Microsoft\\Windows\\Start Menu\\Programs\\StartUp",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_update": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Image": {
                    "field": "Image",
                    "value": [
                      "C:\\Windows\\System32\\wuauclt.exe",
                      "C:\\Windows\\uus\\ARM64\\wuaucltcore.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "TargetFilename__startswith": {
                    "field": "TargetFilename",
                    "value": [
                      "C:\\$WINDOWS.~BT\\NewOS\\",
                      "C:\\$WinREAgent\\Scratch\\Mount\\"
                    ],
                    "modifiers": [
                      "startswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "filter_optional_onenote": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\ONENOTE.EXE",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "\\Send to OneNote.lnk",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1547.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
        "date": "2020-05-02",
        "modified": "2025-12-03",
        "references": [
          "https://github.com/OTRF/detection-hackathon-apt29/issues/12",
          "https://github.com/OTRF/ThreatHunter-Playbook/blob/2d4257f630f4c9770f78d0c1df059f891ffc3fec/docs/evals/apt29/detections/5.B.1_611FCA99-97D0-4873-9E51-1C1BA2DBB40D.md"
        ],
        "falsepositives": [
          "FP could be caused by legitimate application writing shortcuts for example. This folder should always be inspected to make sure that all the files in there are legitimate"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_startup_folder_file_write.yml"
      }
    },
    {
      "id": "a5a2d357-1ab8-4675-a967-ef9990a59391",
      "title": "LSASS Process Memory Dump Files",
      "status": "test",
      "description": "Detects creation of files with names used by different memory dumping tools to create a memory dump of the LSASS process memory, which contains user credentials.",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003.001"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_1": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  "\\Andrew.dmp",
                  "\\Coredump.dmp",
                  "\\lsass.dmp",
                  "\\lsass.rar",
                  "\\lsass.zip",
                  "\\NotLSASS.zip",
                  "\\PPLBlade.dmp",
                  "\\rustive.dmp"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_2": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  "\\lsass_2",
                  "\\lsassdmp",
                  "\\lsassdump"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_3": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains_all": {
                "field": "TargetFilename",
                "value": [
                  "\\lsass",
                  ".dmp"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_4": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "SQLDmpr",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".mdmp",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_5": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  "\\nanodump",
                  "\\proc_"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".dmp",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.001"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-11-15",
        "modified": "2024-10-08",
        "references": [
          "https://www.google.com/search?q=procdump+lsass",
          "https://medium.com/@markmotig/some-ways-to-dump-lsass-exe-c4a75fdc49bf",
          "https://github.com/elastic/detection-rules/blob/c76a39796972ecde44cb1da6df47f1b6562c9770/rules/windows/credential_access_lsass_memdump_file_created.toml",
          "https://www.whiteoaksecurity.com/blog/attacks-defenses-dumping-lsass-no-mimikatz/",
          "https://github.com/helpsystems/nanodump",
          "https://github.com/CCob/MirrorDump",
          "https://github.com/safedv/RustiveDump/blob/1a9b026b477587becfb62df9677cede619d42030/src/main.rs#L35",
          "https://github.com/ricardojoserf/NativeDump/blob/01d8cd17f31f51f5955a38e85cd3c83a17596175/NativeDump/Program.cs#L258"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_lsass_default_dump_file_names.yml"
      }
    },
    {
      "id": "130c9e58-28ac-4f83-8574-0a4cc913b97e",
      "title": "Potential Winnti Dropper Activity",
      "status": "test",
      "description": "Detects files dropped by Winnti as described in RedMimicry Winnti playbook",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1027"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  "\\gthread-3.6.dll",
                  "\\sigcmm-2.4.dll",
                  "\\Windows\\Temp\\tmp.bat"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1027"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Alexander Rausch",
        "date": "2020-06-24",
        "modified": "2023-01-05",
        "references": [
          "https://redmimicry.com/posts/redmimicry-winnti/#dropper"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_redmimicry_winnti_filedrop.yml"
      }
    },
    {
      "id": "155dbf56-e0a4-4dd0-8905-8a98705045e8",
      "title": "UAC Bypass Abusing Winsat Path Parsing - File",
      "status": "test",
      "description": "Detects the pattern of UAC Bypass using a path parsing issue in winsat.exe (UACMe 52)",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": "C:\\Users\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  "\\AppData\\Local\\Temp\\system32\\winsat.exe",
                  "\\AppData\\Local\\Temp\\system32\\winmm.dll"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Christian Burkard (Nextron Systems)",
        "date": "2021-08-30",
        "modified": "2022-10-09",
        "references": [
          "https://github.com/hfiref0x/UACME"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_uac_bypass_winsat.yml"
      }
    },
    {
      "id": "bb09dd3e-2b78-4819-8e35-a7c1b874e449",
      "title": "HackTool - Inveigh Execution Artefacts",
      "status": "test",
      "description": "Detects the presence and execution of Inveigh via dropped artefacts",
      "level": "critical",
      "tags": [
        "attack.command-and-control",
        "attack.t1219.002"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  "\\Inveigh-Log.txt",
                  "\\Inveigh-Cleartext.txt",
                  "\\Inveigh-NTLMv1Users.txt",
                  "\\Inveigh-NTLMv2Users.txt",
                  "\\Inveigh-NTLMv1.txt",
                  "\\Inveigh-NTLMv2.txt",
                  "\\Inveigh-FormInput.txt",
                  "\\Inveigh.dll",
                  "\\Inveigh.exe",
                  "\\Inveigh.ps1",
                  "\\Inveigh-Relay.ps1"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1219.002"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-10-24",
        "modified": "2024-06-27",
        "references": [
          "https://github.com/Kevin-Robertson/Inveigh/blob/29d9e3c3a625b3033cdaf4683efaafadcecb9007/Inveigh/Support/Output.cs",
          "https://github.com/Kevin-Robertson/Inveigh/blob/29d9e3c3a625b3033cdaf4683efaafadcecb9007/Inveigh/Support/Control.cs",
          "https://thedfirreport.com/2020/11/23/pysa-mespinoza-ransomware/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_hktl_inveigh_artefacts.yml"
      }
    },
    {
      "id": "4c7f49ee-2638-43bb-b85b-ce676c30b260",
      "title": "Assembly DLL Creation Via AspNetCompiler",
      "status": "test",
      "description": "Detects the creation of new DLL assembly files by \"aspnet_compiler.exe\", which could be a sign of \"aspnet_compiler\" abuse to proxy execution through a build provider.\n",
      "level": "medium",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\aspnet_compiler.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__contains_all": {
                "field": "TargetFilename",
                "value": [
                  "\\Temporary ASP.NET Files\\",
                  "\\assembly\\tmp\\",
                  ".dll"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-08-14",
        "modified": "",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Legitimate assembly compilation using a build provider"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_aspnet_temp_files.yml"
      }
    },
    {
      "id": "3ab79e90-9fab-4cdf-a7b2-6522bc742adb",
      "title": "HackTool - RemoteKrbRelay SMB Relay Secrets Dump Module Indicators",
      "status": "test",
      "description": "Detects the creation of file with specific names used by RemoteKrbRelay SMB Relay attack module.",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1219.002"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ":\\windows\\temp\\sam.tmp",
                  ":\\windows\\temp\\sec.tmp",
                  ":\\windows\\temp\\sys.tmp"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1219.002"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2024-06-27",
        "modified": "",
        "references": [
          "https://github.com/CICADA8-Research/RemoteKrbRelay/blob/19ec76ba7aa50c2722b23359bc4541c0a9b2611c/Exploit/RemoteKrbRelay/Relay/Attacks/RemoteRegistry.cs#L31-L40"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_hktl_krbrelay_remote_ioc.yml"
      }
    },
    {
      "id": "fabb0e80-030c-4e3e-a104-d09676991ac3",
      "title": "Suspicious File Created in Outlook Temporary Directory",
      "status": "experimental",
      "description": "Detects the creation of files with suspicious file extensions in the temporary directory that Outlook uses when opening attachments.\nThis can be used to detect spear-phishing campaigns that use suspicious files as attachments, which may contain malicious code.\n",
      "level": "high",
      "tags": [
        "attack.initial-access",
        "attack.t1566.001"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_extension": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".cpl",
                  ".hta",
                  ".iso",
                  ".rdp",
                  ".svg",
                  ".vba",
                  ".vbe",
                  ".vbs"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_location": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "TargetFilename__contains": {
                    "field": "TargetFilename",
                    "value": [
                      "\\AppData\\Local\\Packages\\Microsoft.Outlook_",
                      "\\AppData\\Local\\Microsoft\\Olk\\Attachments\\"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "TargetFilename__contains_all": {
                    "field": "TargetFilename",
                    "value": [
                      "\\AppData\\Local\\Microsoft\\Windows\\",
                      "\\Content.Outlook\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1566.001"
        ],
        "tactics": [
          "initial_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-07-22",
        "modified": "",
        "references": [
          "https://vipre.com/blog/svg-phishing-attacks-the-new-trick-in-the-cybercriminals-playbook/",
          "https://thecyberexpress.com/rogue-rdp-files-used-in-ukraine-cyberattacks/",
          "https://www.microsoft.com/en-us/security/blog/2024/10/29/midnight-blizzard-conducts-large-scale-spear-phishing-campaign-using-rdp-files/"
        ],
        "falsepositives": [
          "Opening of headers or footers in email signatures that include SVG images or legitimate SVG attachments"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_office_outlook_susp_file_creation_in_temp_dir.yml"
      }
    },
    {
      "id": "d5866ddf-ce8f-4aea-b28e-d96485a20d3d",
      "title": "Files With System Process Name In Unsuspected Locations",
      "status": "test",
      "description": "Detects the creation of an executable with a system process name in folders other than the system ones (System32, SysWOW64, etc.).\nIt is highly recommended to perform an initial baseline before using this rule in production.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036.005"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  "\\AtBroker.exe",
                  "\\audiodg.exe",
                  "\\backgroundTaskHost.exe",
                  "\\bcdedit.exe",
                  "\\bitsadmin.exe",
                  "\\cmdl32.exe",
                  "\\cmstp.exe",
                  "\\conhost.exe",
                  "\\csrss.exe",
                  "\\dasHost.exe",
                  "\\dfrgui.exe",
                  "\\dllhost.exe",
                  "\\dwm.exe",
                  "\\eventcreate.exe",
                  "\\eventvwr.exe",
                  "\\explorer.exe",
                  "\\extrac32.exe",
                  "\\fontdrvhost.exe",
                  "\\ipconfig.exe",
                  "\\iscsicli.exe",
                  "\\iscsicpl.exe",
                  "\\logman.exe",
                  "\\LogonUI.exe",
                  "\\LsaIso.exe",
                  "\\lsass.exe",
                  "\\lsm.exe",
                  "\\msiexec.exe",
                  "\\msinfo32.exe",
                  "\\mstsc.exe",
                  "\\nbtstat.exe",
                  "\\odbcconf.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\regini.exe",
                  "\\regsvr32.exe",
                  "\\rundll32.exe",
                  "\\RuntimeBroker.exe",
                  "\\schtasks.exe",
                  "\\SearchFilterHost.exe",
                  "\\SearchIndexer.exe",
                  "\\SearchProtocolHost.exe",
                  "\\SecurityHealthService.exe",
                  "\\SecurityHealthSystray.exe",
                  "\\services.exe",
                  "\\ShellAppRuntime.exe",
                  "\\sihost.exe",
                  "\\smartscreen.exe",
                  "\\smss.exe",
                  "\\spoolsv.exe",
                  "\\svchost.exe",
                  "\\SystemSettingsBroker.exe",
                  "\\taskhost.exe",
                  "\\taskhostw.exe",
                  "\\Taskmgr.exe",
                  "\\TiWorker.exe",
                  "\\vssadmin.exe",
                  "\\w32tm.exe",
                  "\\WerFault.exe",
                  "\\WerFaultSecure.exe",
                  "\\wermgr.exe",
                  "\\wevtutil.exe",
                  "\\wininit.exe",
                  "\\winlogon.exe",
                  "\\winrshost.exe",
                  "\\WinRTNetMUAHostServer.exe",
                  "\\wlanext.exe",
                  "\\wlrmdr.exe",
                  "\\WmiPrvSE.exe",
                  "\\wslhost.exe",
                  "\\WSReset.exe",
                  "\\WUDFHost.exe",
                  "\\WWAHost.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_generic": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  "C:\\$WINDOWS.~BT\\",
                  "C:\\$WinREAgent\\",
                  "C:\\Windows\\SoftwareDistribution\\",
                  "C:\\Windows\\System32\\",
                  "C:\\Windows\\SysWOW64\\",
                  "C:\\Windows\\WinSxS\\",
                  "C:\\Windows\\uus\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_tiworker": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\TiWorker.exe",
                  "\\wuaucltcore.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": "C:\\Windows\\Temp\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_svchost": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "C:\\Windows\\system32\\svchost.exe",
                  "C:\\Windows\\SysWOW64\\svchost.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  "C:\\Program Files\\WindowsApps\\",
                  "C:\\Program Files (x86)\\WindowsApps\\",
                  "\\AppData\\Local\\Microsoft\\WindowsApps\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_wuauclt": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Windows\\System32\\wuauclt.exe",
                  "C:\\Windows\\SysWOW64\\wuauclt.exe",
                  "C:\\Windows\\UUS\\arm64\\wuaucltcore.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_explorer": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "C:\\Windows\\explorer.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_msiexec": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "C:\\WINDOWS\\system32\\msiexec.exe",
                  "C:\\WINDOWS\\SysWOW64\\msiexec.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": [
                  "C:\\Program Files\\PowerShell\\7\\pwsh.exe",
                  "C:\\Program Files\\PowerShell\\7-preview\\pwsh.exe",
                  "C:\\Program Files\\WindowsApps\\Microsoft.PowerShellPreview\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_healtray": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "C:\\Windows\\System32\\SecurityHealth\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "\\SecurityHealthSystray.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\SecurityHealthSetup.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1036.005"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Sander Wiebing, Tim Shelton, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2020-05-26",
        "modified": "2025-12-03",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "System processes copied outside their default folders for testing purposes",
          "Third party software naming their software with the same names as the processes mentioned here"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_creation_system_file.yml"
      }
    },
    {
      "id": "1f0489be-b496-4ddf-b3a9-5900f2044e9c",
      "title": "Suspicious File Write to SharePoint Layouts Directory",
      "status": "experimental",
      "description": "Detects suspicious file writes to SharePoint layouts directory which could indicate webshell activity or post-exploitation.\nThis behavior has been observed in the exploitation of SharePoint vulnerabilities such as CVE-2025-49704, CVE-2025-49706 or CVE-2025-53770.\n",
      "level": "high",
      "tags": [
        "attack.initial-access",
        "attack.t1190",
        "attack.persistence",
        "attack.t1505.003"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\cmd.exe",
                  "\\powershell_ise.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\w3wp.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": [
                  "C:\\Program Files\\Common Files\\Microsoft Shared\\Web Server Extensions\\",
                  "C:\\Program Files (x86)\\Common Files\\Microsoft Shared\\Web Server Extensions\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  "\\15\\TEMPLATE\\LAYOUTS\\",
                  "\\16\\TEMPLATE\\LAYOUTS\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".asax",
                  ".ascx",
                  ".ashx",
                  ".asmx",
                  ".asp",
                  ".aspx",
                  ".bat",
                  ".cmd",
                  ".cer",
                  ".config",
                  ".hta",
                  ".js",
                  ".jsp",
                  ".jspx",
                  ".php",
                  ".ps1",
                  ".vbs"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1190",
          "T1505.003"
        ],
        "tactics": [
          "initial_access",
          "persistence"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-07-24",
        "modified": "",
        "references": [
          "https://unit42.paloaltonetworks.com/microsoft-sharepoint-cve-2025-49704-cve-2025-49706-cve-2025-53770/",
          "https://www.microsoft.com/en-us/security/blog/2025/07/22/disrupting-active-exploitation-of-on-premises-sharepoint-vulnerabilities/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_susp_filewrite_in_sharepoint_layouts_dir.yml"
      }
    },
    {
      "id": "fed85bf9-e075-4280-9159-fbe8a023d6fa",
      "title": "Advanced IP Scanner - File Event",
      "status": "test",
      "description": "Detects the use of Advanced IP Scanner. Seems to be a popular tool for ransomware groups.",
      "level": "medium",
      "tags": [
        "attack.discovery",
        "attack.t1046"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\AppData\\Local\\Temp\\Advanced IP Scanner 2",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1046"
        ],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "@ROxPinTeddy",
        "date": "2020-05-12",
        "modified": "2022-11-29",
        "references": [
          "https://news.sophos.com/en-us/2019/12/09/snatch-ransomware-reboots-pcs-into-safe-mode-to-bypass-protection/",
          "https://www.fireeye.com/blog/threat-research/2020/05/tactics-techniques-procedures-associated-with-maze-ransomware-incidents.html",
          "https://labs.f-secure.com/blog/prelude-to-ransomware-systembc",
          "https://assets.documentcloud.org/documents/20444693/fbi-pin-egregor-ransomware-bc-01062021.pdf",
          "https://thedfirreport.com/2021/01/18/all-that-for-a-coinminer"
        ],
        "falsepositives": [
          "Legitimate administrative use"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_advanced_ip_scanner.yml"
      }
    },
    {
      "id": "805c55d9-31e6-4846-9878-c34c75054fe9",
      "title": "Octopus Scanner Malware",
      "status": "test",
      "description": "Detects Octopus Scanner Malware.",
      "level": "high",
      "tags": [
        "attack.initial-access",
        "attack.t1195",
        "attack.t1195.001"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  "\\AppData\\Local\\Microsoft\\Cache134.dat",
                  "\\AppData\\Local\\Microsoft\\ExplorerSync.db"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1195",
          "T1195.001"
        ],
        "tactics": [
          "initial_access"
        ]
      },
      "meta": {
        "author": "NVISO",
        "date": "2020-06-09",
        "modified": "2021-11-27",
        "references": [
          "https://securitylab.github.com/research/octopus-scanner-malware-open-source-supply-chain"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_mal_octopus_scanner.yml"
      }
    },
    {
      "id": "059c5af9-5131-4d8d-92b2-de4ad6146712",
      "title": "LiveKD Driver Creation By Uncommon Process",
      "status": "test",
      "description": "Detects the creation of the LiveKD driver by a process image other than \"livekd.exe\".",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename": {
                "field": "TargetFilename",
                "value": "C:\\Windows\\System32\\drivers\\LiveKdD.SYS",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_legit_name": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\livekd.exe",
                  "\\livek64.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-16",
        "modified": "",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Administrators might rename LiveKD before its usage which could trigger this. Add additional names you use to the filter"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_sysinternals_livekd_driver_susp_creation.yml"
      }
    },
    {
      "id": "df6ecb8b-7822-4f4b-b412-08f524b4576c",
      "title": "Creation Of Non-Existent System DLL",
      "status": "test",
      "description": "Detects the creation of system DLLs that are usually not present on the system (or at least not in system directories).\nUsually this technique is used to achieve DLL hijacking.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.persistence",
        "attack.privilege-escalation",
        "attack.t1574.001"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ":\\Windows\\System32\\TSMSISrv.dll",
                  ":\\Windows\\System32\\TSVIPSrv.dll",
                  ":\\Windows\\System32\\wbem\\wbemcomn.dll",
                  ":\\Windows\\System32\\WLBSCTRL.dll",
                  ":\\Windows\\System32\\wow64log.dll",
                  ":\\Windows\\System32\\WptsExtensions.dll",
                  "\\SprintCSP.dll"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1574.001"
        ],
        "tactics": [
          "defense_evasion",
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), fornotes",
        "date": "2022-12-01",
        "modified": "2024-01-10",
        "references": [
          "https://decoded.avast.io/martinchlumecky/png-steganography/",
          "https://posts.specterops.io/lateral-movement-scm-and-dll-hijacking-primer-d2f61e8ab992",
          "https://clement.notin.org/blog/2020/09/12/CVE-2020-7315-McAfee-Agent-DLL-injection/",
          "https://github.com/Wh04m1001/SysmonEoP",
          "https://www.hexacorn.com/blog/2013/12/08/beyond-good-ol-run-key-part-5/",
          "https://github.com/blackarrowsec/redteam-research/tree/26e6fc0c0d30d364758fa11c2922064a9a7fd309/LPE%20via%20StorSvc"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_create_non_existent_dlls.yml"
      }
    },
    {
      "id": "e94b9ddc-eec5-4bb8-8a58-b9dc5f4e185f",
      "title": "UEFI Persistence Via Wpbbin - FileCreation",
      "status": "test",
      "description": "Detects creation of a file named \"wpbbin\" in the \"%systemroot%\\system32\\\" directory. Which could be indicative of UEFI based persistence method",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1542.001"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename": {
                "field": "TargetFilename",
                "value": "C:\\Windows\\System32\\wpbbin.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1542.001"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-07-18",
        "modified": "",
        "references": [
          "https://grzegorztworek.medium.com/using-uefi-to-inject-executable-files-into-bitlocker-protected-drives-8ff4ca59c94c",
          "https://persistence-info.github.io/Data/wpbbin.html"
        ],
        "falsepositives": [
          "Legitimate usage of the file by hardware manufacturer such as lenovo (Thanks @0gtweet for the tip)"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_wpbbin_persistence.yml"
      }
    },
    {
      "id": "7fd164ba-126a-4d9c-9392-0d4f7c243df0",
      "title": "OneNote Attachment File Dropped In Suspicious Location",
      "status": "test",
      "description": "Detects creation of files with the \".one\"/\".onepkg\" extension in suspicious or uncommon locations. This could be a sign of attackers abusing OneNote attachments",
      "level": "medium",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  "\\AppData\\Local\\Temp\\",
                  "\\Users\\Public\\",
                  "\\Windows\\Temp\\",
                  ":\\Temp\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".one",
                  ".onepkg"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_onenote": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": ":\\Program Files\\Microsoft Office\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\ONENOTE.EXE",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-01-22",
        "modified": "2023-09-19",
        "references": [
          "https://www.bleepingcomputer.com/news/security/hackers-now-use-microsoft-onenote-attachments-to-spread-malware/",
          "https://blog.osarmor.com/319/onenote-attachment-delivers-asyncrat-malware/"
        ],
        "falsepositives": [
          "Legitimate usage of \".one\" or \".onepkg\" files from those locations"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_office_onenote_files_in_susp_locations.yml"
      }
    },
    {
      "id": "e8a52bbd-bced-459f-bd93-64db45ce7657",
      "title": "Potential Suspicious PowerShell Module File Created",
      "status": "test",
      "description": "Detects the creation of a new PowerShell module in the first folder of the module directory structure \"\\WindowsPowerShell\\Modules\\malware\\malware.psm1\". This is somewhat an uncommon practice as legitimate modules often includes a version folder.",
      "level": "medium",
      "tags": [
        "attack.persistence"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  "\\\\WindowsPowerShell\\\\Modules\\\\*\\.ps",
                  "\\\\WindowsPowerShell\\\\Modules\\\\*\\.dll"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-09",
        "modified": "",
        "references": [
          "Internal Research",
          "https://learn.microsoft.com/en-us/powershell/scripting/developer/module/understanding-a-windows-powershell-module?view=powershell-7.3"
        ],
        "falsepositives": [
          "False positive rate will vary depending on the environments. Additional filters might be required to make this logic usable in production."
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_powershell_module_susp_creation.yml"
      }
    },
    {
      "id": "0b8baa3f-575c-46ee-8715-d6f28cc7d33c",
      "title": "NTDS.DIT Created",
      "status": "test",
      "description": "Detects creation of a file named \"ntds.dit\" (Active Directory Database)",
      "level": "low",
      "tags": [
        "attack.credential-access",
        "attack.t1003.003"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "ntds.dit",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.003"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-05",
        "modified": "",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_ntds_dit_creation.yml"
      }
    },
    {
      "id": "0afecb6e-6223-4a82-99fb-bf5b981e92a5",
      "title": "Remote Access Tool - ScreenConnect Temporary File",
      "status": "test",
      "description": "Detects the creation of files in a specific location by ScreenConnect RMM.\nScreenConnect has feature to remotely execute binaries on a target machine. These binaries will be dropped to \":\\Users\\<username>\\Documents\\ConnectWiseControl\\Temp\\\" before execution.\n",
      "level": "low",
      "tags": [
        "attack.execution",
        "attack.t1059.003"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\ScreenConnect.WindowsClient.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\Documents\\ConnectWiseControl\\Temp\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.003"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Ali Alwashali",
        "date": "2023-10-10",
        "modified": "",
        "references": [
          "https://github.com/SigmaHQ/sigma/pull/4467"
        ],
        "falsepositives": [
          "Legitimate use of ScreenConnect"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_remote_access_tools_screenconnect_remote_file.yml"
      }
    },
    {
      "id": "e15b518d-b4ce-4410-a9cd-501f23ce4a18",
      "title": "Suspicious Creation with Colorcpl",
      "status": "test",
      "description": "Once executed, colorcpl.exe will copy the arbitrary file to c:\\windows\\system32\\spool\\drivers\\color\\",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1564"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\colorcpl.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_ext": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".icm",
                  ".gmmp",
                  ".cdmp",
                  ".camp"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1564"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-21",
        "modified": "2023-01-05",
        "references": [
          "https://twitter.com/eral4m/status/1480468728324231172?s=20"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_susp_colorcpl.yml"
      }
    },
    {
      "id": "f0e2b768-5220-47dd-b891-d57b96fc0ec1",
      "title": "CSExec Service File Creation",
      "status": "test",
      "description": "Detects default CSExec service filename which indicates CSExec service installation and execution",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1569.002",
        "attack.s0029"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "\\csexecsvc.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1569.002"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-08-04",
        "modified": "",
        "references": [
          "https://github.com/malcomvetter/CSExec"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_csexec_service.yml"
      }
    },
    {
      "id": "5b40a734-99b6-4b98-a1d0-1cea51a08ab2",
      "title": "Suspicious Interactive PowerShell as SYSTEM",
      "status": "test",
      "description": "Detects the creation of files that indicator an interactive use of PowerShell in the SYSTEM user context",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename": {
                "field": "TargetFilename",
                "value": [
                  "C:\\Windows\\System32\\config\\systemprofile\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt",
                  "C:\\Windows\\System32\\config\\systemprofile\\AppData\\Local\\Microsoft\\Windows\\PowerShell\\StartupProfileData-Interactive"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-12-07",
        "modified": "2022-08-13",
        "references": [
          "https://jpcertcc.github.io/ToolAnalysisResultSheet/details/PowerSploit_Invoke-Mimikatz.htm"
        ],
        "falsepositives": [
          "Administrative activity",
          "PowerShell scripts running as SYSTEM user"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_susp_system_interactive_powershell.yml"
      }
    },
    {
      "id": "5d756aee-ad3e-4306-ad95-cb1abec48de2",
      "title": "GoToAssist Temporary Installation Artefact",
      "status": "test",
      "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1219.002"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\AppData\\Local\\Temp\\LogMeInInc\\GoToAssist Remote Support Expert\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1219.002"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-02-13",
        "modified": "",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-4---gotoassist-files-detected-test-on-windows"
        ],
        "falsepositives": [
          "Legitimate use"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_gotoopener_artefact.yml"
      }
    },
    {
      "id": "48ea844d-19b1-4642-944e-fe39c2cc1fec",
      "title": "UAC Bypass Using IDiagnostic Profile - File",
      "status": "test",
      "description": "Detects the creation of a file by \"dllhost.exe\" in System32 directory part of \"IDiagnosticProfileUAC\" UAC bypass technique",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\DllHost.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": "C:\\Windows\\System32\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".dll",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "execution",
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-07-03",
        "modified": "",
        "references": [
          "https://github.com/Wh04m1001/IDiagnosticProfileUAC"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_uac_bypass_idiagnostic_profile.yml"
      }
    },
    {
      "id": "52753ea4-b3a0-4365-910d-36cff487b789",
      "title": "Hijack Legit RDP Session to Move Laterally",
      "status": "test",
      "description": "Detects the usage of tsclient share to place a backdoor on the RDP source machine's startup folder",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1219.002"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\mstsc.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1219.002"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Samir Bousseaden",
        "date": "2019-02-21",
        "modified": "2021-11-27",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_tsclient_filewrite_startup.yml"
      }
    },
    {
      "id": "6e90ae7a-7cd3-473f-a035-4ebb72d961da",
      "title": "PCRE.NET Package Temp Files",
      "status": "test",
      "description": "Detects processes creating temp files related to PCRE.NET package",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\AppData\\Local\\Temp\\ba9ea7344a4a5f591d6e5dc32a13494b\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
        "date": "2020-10-29",
        "modified": "2022-10-09",
        "references": [
          "https://twitter.com/rbmaslen/status/1321859647091970051",
          "https://twitter.com/tifkin_/status/1321916444557365248"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_pcre_net_temp_file.yml"
      }
    },
    {
      "id": "d353dac0-1b41-46c2-820c-d7d2561fc6ed",
      "title": "AWL Bypass with Winrm.vbs and Malicious WsmPty.xsl/WsmTxt.xsl - File",
      "status": "test",
      "description": "Detects execution of attacker-controlled WsmPty.xsl or WsmTxt.xsl via winrm.vbs and copied cscript.exe (can be renamed)",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1216"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "system_files": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  "WsmPty.xsl",
                  "WsmTxt.xsl"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "in_system_folder": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": [
                  "C:\\Windows\\System32\\",
                  "C:\\Windows\\SysWOW64\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "system_files and not in_system_folder",
        "condition_parsed": {
          "op": "and_not",
          "include": "system_files",
          "exclude": "in_system_folder"
        }
      },
      "mitre": {
        "techniques": [
          "T1216"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Julia Fomina, oscd.community",
        "date": "2020-10-06",
        "modified": "2022-11-28",
        "references": [
          "https://posts.specterops.io/application-whitelisting-bypass-and-arbitrary-unsigned-code-execution-technique-in-winrm-vbs-c8c24fb40404"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_winrm_awl_bypass.yml"
      }
    },
    {
      "id": "28a452f3-786c-4fd8-b8f2-bddbe9d616d1",
      "title": "Creation of WerFault.exe/Wer.dll in Unusual Folder",
      "status": "test",
      "description": "Detects the creation of a file named \"WerFault.exe\" or \"wer.dll\" in an uncommon folder, which could be a sign of WerFault DLL hijacking.",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1574.001"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  "\\WerFault.exe",
                  "\\wer.dll"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_known_locations": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": [
                  "C:\\Windows\\SoftwareDistribution\\",
                  "C:\\Windows\\System32\\",
                  "C:\\Windows\\SysWOW64\\",
                  "C:\\Windows\\WinSxS\\",
                  "C:\\Windows\\UUS\\arm64\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1574.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-05-09",
        "modified": "2025-12-03",
        "references": [
          "https://www.bleepingcomputer.com/news/security/hackers-are-now-hiding-malware-in-windows-event-logs/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_werfault_dll_hijacking.yml"
      }
    },
    {
      "id": "002bdb95-0cf1-46a6-9e08-d38c128a6127",
      "title": "WScript or CScript Dropper - File",
      "status": "test",
      "description": "Detects a file ending in jse, vbe, js, vba, vbs written by cscript.exe or wscript.exe",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059.005",
        "attack.t1059.007"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\wscript.exe",
                  "\\cscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": [
                  "C:\\Users\\",
                  "C:\\ProgramData"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".jse",
                  ".vbe",
                  ".js",
                  ".vba",
                  ".vbs"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.005",
          "T1059.007"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Tim Shelton",
        "date": "2022-01-10",
        "modified": "2022-12-02",
        "references": [
          "WScript or CScript Dropper (cea72823-df4d-4567-950c-0b579eaf0846)"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_cscript_wscript_dropper.yml"
      }
    },
    {
      "id": "7892ec59-c5bb-496d-8968-e5d210ca3ac4",
      "title": "DPAPI Backup Keys And Certificate Export Activity IOC",
      "status": "test",
      "description": "Detects file names with specific patterns seen generated and used by tools such as Mimikatz and DSInternals related to exported or stolen DPAPI backup keys and certificates.\n",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1555",
        "attack.t1552.004"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  "ntds_capi_",
                  "ntds_legacy_",
                  "ntds_unknown_"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".cer",
                  ".key",
                  ".pfx",
                  ".pvk"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1555",
          "T1552.004"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Nounou Mbeiri, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2024-06-26",
        "modified": "",
        "references": [
          "https://www.dsinternals.com/en/dpapi-backup-key-theft-auditing/",
          "https://github.com/MichaelGrafnetter/DSInternals/blob/39ee8a69bbdc1cfd12c9afdd7513b4788c4895d4/Src/DSInternals.Common/Data/DPAPI/DPAPIBackupKey.cs#L28-L32"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_susp_dpapi_backup_and_cert_export_ioc.yml"
      }
    },
    {
      "id": "89c42960-f244-4dad-9151-ae9b1a3287a2",
      "title": "Suspicious File Write to Webapps Root Directory",
      "status": "experimental",
      "description": "Detects suspicious file writes to the root directory of web applications, particularly Apache web servers or Tomcat servers.\nThis may indicate an attempt to deploy malicious files such as web shells or other unauthorized scripts.\n",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.t1505.003",
        "attack.initial-access",
        "attack.t1190"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_susp_img": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\dotnet.exe",
                  "\\w3wp.exe",
                  "\\java.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_servers": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  "\\apache",
                  "\\tomcat"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_path": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\webapps\\ROOT\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_susp_extensions": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".jsp",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1505.003",
          "T1190"
        ],
        "tactics": [
          "persistence",
          "initial_access"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-10-20",
        "modified": "",
        "references": [
          "https://labs.watchtowr.com/guess-who-would-be-stupid-enough-to-rob-the-same-vault-twice-pre-auth-rce-chains-in-commvault/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_susp_file_write_in_webapps_root.yml"
      }
    },
    {
      "id": "41bb431f-56d8-4691-bb56-ed34e390906f",
      "title": "UAC Bypass Using MSConfig Token Modification - File",
      "status": "test",
      "description": "Detects the pattern of UAC Bypass using a msconfig GUI hack (UACMe 55)",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": "C:\\Users\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "\\AppData\\Local\\Temp\\pkgmgr.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Christian Burkard (Nextron Systems)",
        "date": "2021-08-30",
        "modified": "2022-10-09",
        "references": [
          "https://github.com/hfiref0x/UACME"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_uac_bypass_msconfig_gui.yml"
      }
    },
    {
      "id": "0c3fac91-5627-46e8-a6a8-a0d7b9b8ae1b",
      "title": "Suspicious Get-Variable.exe Creation",
      "status": "test",
      "description": "Get-Variable is a valid PowerShell cmdlet\nWindowsApps is by default in the path where PowerShell is executed.\nSo when the Get-Variable command is issued on PowerShell execution, the system first looks for the Get-Variable executable in the path and executes the malicious binary instead of looking for the PowerShell cmdlet.\n",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1546",
        "attack.defense-evasion",
        "attack.t1027"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "Local\\Microsoft\\WindowsApps\\Get-Variable.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1546",
          "T1027"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-04-23",
        "modified": "",
        "references": [
          "https://blog.malwarebytes.com/threat-intelligence/2022/04/colibri-loader-combines-task-scheduler-and-powershell-in-clever-persistence-technique/",
          "https://www.joesandbox.com/analysis/465533/0/html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_susp_get_variable.yml"
      }
    },
    {
      "id": "8d5aca11-22b3-4f22-b7ba-90e60533e1fb",
      "title": "Wmiexec Default Output File",
      "status": "test",
      "description": "Detects the creation of the default output filename used by the wmiexec tool",
      "level": "critical",
      "tags": [
        "attack.lateral-movement",
        "attack.execution",
        "attack.t1047"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "TargetFilename__re": {
                    "field": "TargetFilename",
                    "value": "\\\\Windows\\\\__1\\d{9}\\.\\d{1,7}$",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "TargetFilename__re": {
                    "field": "TargetFilename",
                    "value": "C:\\\\__1\\d{9}\\.\\d{1,7}$",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "TargetFilename__re": {
                    "field": "TargetFilename",
                    "value": "D:\\\\__1\\d{9}\\.\\d{1,7}$",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1047"
        ],
        "tactics": [
          "lateral_movement",
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-06-02",
        "modified": "2023-03-08",
        "references": [
          "https://www.crowdstrike.com/blog/how-to-detect-and-prevent-impackets-wmiexec/",
          "https://github.com/fortra/impacket/blob/f4b848fa27654ca95bc0f4c73dbba8b9c2c9f30a/examples/wmiexec.py"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_wmiexec_default_filename.yml"
      }
    },
    {
      "id": "74a2b37d-fea4-41e0-9ac7-c9fbcf1f60cc",
      "title": "WinRAR Creating Files in Startup Locations",
      "status": "experimental",
      "description": "Detects WinRAR creating files in Windows startup locations, which may indicate an attempt to establish persistence by adding malicious files to the Startup folder.\nThis kind of behaviour has been associated with exploitation of WinRAR path traversal vulnerability CVE-2025-6218 or CVE-2025-8088.\n",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547.001"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\WinRAR.exe",
                  "\\Rar.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\Start Menu\\Programs\\Startup\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1547.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-07-16",
        "modified": "",
        "references": [
          "https://github.com/mulwareX/CVE-2025-6218-POC",
          "https://x.com/0x534c/status/1944694507787710685",
          "https://www.welivesecurity.com/en/eset-research/update-winrar-tools-now-romcom-and-others-exploiting-zero-day-vulnerability/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_winrar_file_creation_in_startup_folder.yml"
      }
    },
    {
      "id": "0b9ad457-2554-44c1-82c2-d56a99c42377",
      "title": "Anydesk Temporary Artefact",
      "status": "test",
      "description": "An adversary may use legitimate desktop support and remote access software, such as Team Viewer, Go2Assist, LogMein, AmmyyAdmin, etc, to establish an interactive command and control channel to target systems within networks.\nThese services are commonly used as legitimate technical support software, and may be allowed by application control within a target environment.\nRemote access tools like VNC, Ammyy, and Teamviewer are used frequently when compared with other legitimate software commonly used by adversaries. (Citation: Symantec Living off the Land)\n",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1219.002"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  "\\AppData\\Roaming\\AnyDesk\\user.conf",
                  "\\AppData\\Roaming\\AnyDesk\\system.conf"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1219.002"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-02-11",
        "modified": "2024-07-20",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-2---anydesk-files-detected-test-on-windows"
        ],
        "falsepositives": [
          "Legitimate use"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_anydesk_artefact.yml"
      }
    },
    {
      "id": "dbbd9f66-2ed3-4ca2-98a4-6ea985dd1a1c",
      "title": "Potential Initial Access via DLL Search Order Hijacking",
      "status": "test",
      "description": "Detects attempts to create a DLL file to a known desktop application dependencies folder such as Slack, Teams or OneDrive and by an unusual process. This may indicate an attempt to load a malicious module via DLL search order hijacking.",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1566",
        "attack.t1566.001",
        "attack.initial-access",
        "attack.t1574",
        "attack.t1574.001",
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\winword.exe",
                  "\\excel.exe",
                  "\\powerpnt.exe",
                  "\\MSACCESS.EXE",
                  "\\MSPUB.EXE",
                  "\\fltldr.exe",
                  "\\cmd.exe",
                  "\\certutil.exe",
                  "\\mshta.exe",
                  "\\cscript.exe",
                  "\\wscript.exe",
                  "\\curl.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".dll",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__contains_all": {
                "field": "TargetFilename",
                "value": [
                  "\\Users\\",
                  "\\AppData\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  "\\Microsoft\\OneDrive\\",
                  "\\Microsoft OneDrive\\",
                  "\\Microsoft\\Teams\\",
                  "\\Local\\slack\\app-",
                  "\\Local\\Programs\\Microsoft VS Code\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\cmd.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__contains_all": {
                "field": "TargetFilename",
                "value": [
                  "\\Users\\",
                  "\\AppData\\",
                  "\\Microsoft\\OneDrive\\",
                  "\\api-ms-win-core-"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1566",
          "T1566.001",
          "T1574",
          "T1574.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "initial_access",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Tim Rauch (rule), Elastic (idea)",
        "date": "2022-10-21",
        "modified": "",
        "references": [
          "https://github.com/elastic/protections-artifacts/commit/746086721fd385d9f5c6647cada1788db4aea95f#diff-5d46dd4ac6866b4337ec126be8cee0e115467b3e8703794ba6f6df6432c806bc",
          "https://posts.specterops.io/automating-dll-hijack-discovery-81c4295904b0"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_initial_access_dll_search_order_hijacking.yml"
      }
    },
    {
      "id": "614a7e17-5643-4d89-b6fe-f9df1a79641c",
      "title": "Wmiprvse Wbemcomn DLL Hijack - File",
      "status": "test",
      "description": "Detects a threat actor creating a file named `wbemcomn.dll` in the `C:\\Windows\\System32\\wbem\\` directory over the network and loading it for a WMI DLL Hijack scenario.",
      "level": "critical",
      "tags": [
        "attack.execution",
        "attack.t1047",
        "attack.lateral-movement",
        "attack.t1021.002"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "System",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "\\wbem\\wbemcomn.dll",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1047",
          "T1021.002"
        ],
        "tactics": [
          "execution",
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
        "date": "2020-10-12",
        "modified": "2022-12-02",
        "references": [
          "https://threathunterplaybook.com/hunts/windows/201009-RemoteWMIWbemcomnDLLHijack/notebook.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_wmiprvse_wbemcomn_dll_hijack.yml"
      }
    },
    {
      "id": "ce7066a6-508a-42d3-995b-2952c65dc2ce",
      "title": "Drop Binaries Into Spool Drivers Color Folder",
      "status": "test",
      "description": "Detects the creation of suspcious binary files inside the \"\\windows\\system32\\spool\\drivers\\color\\\" as seen in the blog referenced below",
      "level": "medium",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": "C:\\Windows\\System32\\spool\\drivers\\color\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".dll",
                  ".exe",
                  ".sys"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-07-28",
        "modified": "",
        "references": [
          "https://www.microsoft.com/security/blog/2022/07/27/untangling-knotweed-european-private-sector-offensive-actor-using-0-day-exploits/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_susp_spool_drivers_color_drop.yml"
      }
    },
    {
      "id": "03f4ca17-de95-428d-a75a-4ee78b047256",
      "title": "HackTool - Impacket File Indicators",
      "status": "experimental",
      "description": "Detects file creation events with filename patterns used by Impacket.",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003.001"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_names_re": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__re": {
                "field": "TargetFilename",
                "value": "\\\\sessionresume_[a-zA-Z]{8}$",
                "modifiers": [
                  "re"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_names_re",
        "condition_parsed": {
          "op": "single",
          "selection": "selection_names_re"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.001"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "The DFIR Report, IrishDeath",
        "date": "2025-05-19",
        "modified": "",
        "references": [
          "https://thedfirreport.com/2025/05/19/another-confluence-bites-the-dust-falling-to-elpaco-team-ransomware/",
          "https://github.com/fortra/impacket"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_impacket_file_indicators.yml"
      }
    },
    {
      "id": "979baf41-ca44-4540-9d0c-4fcef3b5a3a4",
      "title": "Potential File Extension Spoofing Using Right-to-Left Override",
      "status": "test",
      "description": "Detects suspicious filenames that contain a right-to-left override character and a potentially spoofed file extensions.\n",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.defense-evasion",
        "attack.t1036.002"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_rtlo_unicode": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  "\\u202e",
                  "[U+202E]"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_extensions": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  "3pm.",
                  "4pm.",
                  "cod.",
                  "fdp.",
                  "ftr.",
                  "gepj.",
                  "gnp.",
                  "gpj.",
                  "ism.",
                  "lmth.",
                  "nls.",
                  "piz.",
                  "slx.",
                  "tdo.",
                  "vsc.",
                  "vwm.",
                  "xcod.",
                  "xslx.",
                  "xtpp."
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1036.002"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Jonathan Peters (Nextron Systems), Florian Roth (Nextron Systems), Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2024-11-17",
        "modified": "2025-02-06",
        "references": [
          "https://redcanary.com/blog/right-to-left-override/",
          "https://www.malwarebytes.com/blog/news/2014/01/the-rtlo-method",
          "https://tria.ge/241015-l98snsyeje/behavioral2",
          "https://www.unicode.org/versions/Unicode5.2.0/ch02.pdf"
        ],
        "falsepositives": [
          "Filenames that contains scriptures such as arabic or hebrew might make use of this character"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_susp_right_to_left_override_extension_spoofing.yml"
      }
    },
    {
      "id": "f92a6f1e-a512-4a15-9735-da09e78d7273",
      "title": "GatherNetworkInfo.VBS Reconnaissance Script Output",
      "status": "test",
      "description": "Detects creation of files which are the results of executing the built-in reconnaissance script \"C:\\Windows\\System32\\gatherNetworkInfo.vbs\".",
      "level": "medium",
      "tags": [
        "attack.discovery"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": "C:\\Windows\\System32\\config",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  "\\Hotfixinfo.txt",
                  "\\netiostate.txt",
                  "\\sysportslog.txt",
                  "\\VmSwitchLog.evtx"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "discovery"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-02-08",
        "modified": "",
        "references": [
          "https://posts.slayerlabs.com/living-off-the-land/#gathernetworkinfovbs",
          "https://www.mandiant.com/resources/blog/trojanized-windows-installers-ukrainian-government"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_lolbin_gather_network_info_script_output.yml"
      }
    },
    {
      "id": "7eff1a7f-dd45-4c20-877a-f21e342a7611",
      "title": "RemCom Service File Creation",
      "status": "test",
      "description": "Detects default RemCom service filename which indicates RemCom service installation and execution",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1569.002",
        "attack.s0029"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "\\RemComSvc.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1569.002"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-08-04",
        "modified": "",
        "references": [
          "https://github.com/kavika13/RemCom/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_remcom_service.yml"
      }
    },
    {
      "id": "736ffa74-5f6f-44ca-94ef-1c0df4f51d2a",
      "title": "HackTool - CrackMapExec File Indicators",
      "status": "test",
      "description": "Detects file creation events with filename patterns used by CrackMapExec.",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003.001"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_path": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": "C:\\Windows\\Temp\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_names_str": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  "\\temp.ps1",
                  "\\msol.ps1"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_names_re": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "TargetFilename__re": {
                    "field": "TargetFilename",
                    "value": "\\\\[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}\\.txt$",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "TargetFilename__re": {
                    "field": "TargetFilename",
                    "value": "\\\\[a-zA-Z]{8}\\.tmp$",
                    "modifiers": [
                      "re"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection_path and 1 of selection_names_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_path"
            },
            {
              "type": "ref",
              "value": "1 of selection_names_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1003.001"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2024-03-11",
        "modified": "2024-06-27",
        "references": [
          "https://github.com/byt3bl33d3r/CrackMapExec/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_hktl_crackmapexec_indicators.yml"
      }
    },
    {
      "id": "6e2a900a-ced9-4e4a-a9c2-13e706f9518a",
      "title": "HackTool - Potential Remote Credential Dumping Activity Via CrackMapExec Or Impacket-Secretsdump",
      "status": "test",
      "description": "Detects default filenames output from the execution of CrackMapExec and Impacket-secretsdump against an endpoint.",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\svchost.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__re": {
                "field": "TargetFilename",
                "value": "\\\\Windows\\\\System32\\\\[a-zA-Z0-9]{8}\\.tmp$",
                "modifiers": [
                  "re"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "SecurityAura",
        "date": "2022-11-16",
        "modified": "2024-06-27",
        "references": [
          "https://github.com/Porchetta-Industries/CrackMapExec",
          "https://github.com/fortra/impacket/blob/ff8c200fd040b04d3b5ff05449646737f836235d/examples/secretsdump.py"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_hktl_remote_cred_dump.yml"
      }
    },
    {
      "id": "1277f594-a7d1-4f28-a2d3-73af5cbeab43",
      "title": "Windows Shell/Scripting Application File Write to Suspicious Folder",
      "status": "test",
      "description": "Detects Windows shells and scripting applications that write files to suspicious folders",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_1": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\bash.exe",
                  "\\cmd.exe",
                  "\\cscript.exe",
                  "\\msbuild.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\sh.exe",
                  "\\wscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": [
                  "C:\\PerfLogs\\",
                  "C:\\Users\\Public\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_2": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\certutil.exe",
                  "\\forfiles.exe",
                  "\\mshta.exe",
                  "\\schtasks.exe",
                  "\\scriptrunner.exe",
                  "\\wmic.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  "C:\\PerfLogs\\",
                  "C:\\Users\\Public\\",
                  "C:\\Windows\\Temp\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1059"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-11-20",
        "modified": "2023-03-29",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_shell_write_susp_directory.yml"
      }
    },
    {
      "id": "fccfb43e-09a7-4bd2-8b37-a5a7df33386d",
      "title": ".RDP File Created By Uncommon Application",
      "status": "test",
      "description": "Detects creation of a file with an \".rdp\" extension by an application that doesn't commonly create such files.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".rdp",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\brave.exe",
                  "\\CCleaner Browser\\Application\\CCleanerBrowser.exe",
                  "\\chromium.exe",
                  "\\firefox.exe",
                  "\\Google\\Chrome\\Application\\chrome.exe",
                  "\\iexplore.exe",
                  "\\microsoftedge.exe",
                  "\\msedge.exe",
                  "\\Opera.exe",
                  "\\Vivaldi.exe",
                  "\\Whale.exe",
                  "\\olk.exe",
                  "\\Outlook.exe",
                  "\\RuntimeBroker.exe",
                  "\\Thunderbird.exe",
                  "\\Discord.exe",
                  "\\Keybase.exe",
                  "\\msteams.exe",
                  "\\Slack.exe",
                  "\\teams.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-04-18",
        "modified": "2024-11-01",
        "references": [
          "https://www.blackhillsinfosec.com/rogue-rdp-revisiting-initial-access-methods/",
          "https://web.archive.org/web/20230726144748/https://blog.thickmints.dev/mintsights/detecting-rogue-rdp/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_rdp_file_susp_creation.yml"
      }
    },
    {
      "id": "b5b78988-486d-4a80-b991-930eff3ff8bf",
      "title": "PowerShell Profile Modification",
      "status": "test",
      "description": "Detects the creation or modification of a powershell profile which could indicate suspicious activity as the profile can be used as a mean of persistence",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.privilege-escalation",
        "attack.t1546.013"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  "\\Microsoft.PowerShell_profile.ps1",
                  "\\PowerShell\\profile.ps1",
                  "\\Program Files\\PowerShell\\7-preview\\profile.ps1",
                  "\\Program Files\\PowerShell\\7\\profile.ps1",
                  "\\Windows\\System32\\WindowsPowerShell\\v1.0\\profile.ps1",
                  "\\WindowsPowerShell\\profile.ps1"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1546.013"
        ],
        "tactics": [
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "HieuTT35, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2019-10-24",
        "modified": "2023-10-23",
        "references": [
          "https://www.welivesecurity.com/2019/05/29/turla-powershell-usage/",
          "https://persistence-info.github.io/Data/powershellprofile.html"
        ],
        "falsepositives": [
          "System administrator creating Powershell profile manually"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_susp_powershell_profile.yml"
      }
    },
    {
      "id": "caf02a0a-1e1c-4552-9b48-5e070bd88d11",
      "title": "Suspicious Creation TXT File in User Desktop",
      "status": "test",
      "description": "Ransomware create txt file in the user Desktop",
      "level": "high",
      "tags": [
        "attack.impact",
        "attack.t1486"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\cmd.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__contains_all": {
                "field": "TargetFilename",
                "value": [
                  "\\Users\\",
                  "\\Desktop\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".txt",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1486"
        ],
        "tactics": [
          "impact"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-12-26",
        "modified": "",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1486/T1486.md#atomic-test-5---purelocker-ransom-note"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_susp_desktop_txt.yml"
      }
    },
    {
      "id": "8c31f563-f9a7-450c-bfa8-35f8f32f1f61",
      "title": "New Outlook Macro Created",
      "status": "test",
      "description": "Detects the creation of a macro file for Outlook.",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.command-and-control",
        "attack.t1137",
        "attack.t1008",
        "attack.t1546"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\outlook.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "\\Microsoft\\Outlook\\VbaProject.OTM",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1137",
          "T1008",
          "T1546"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "command_and_control"
        ]
      },
      "meta": {
        "author": "@ScoubiMtl",
        "date": "2021-04-05",
        "modified": "2023-02-08",
        "references": [
          "https://www.mdsec.co.uk/2020/11/a-fresh-outlook-on-mail-based-persistence/"
        ],
        "falsepositives": [
          "User genuinely creates a VB Macro for their email"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_office_outlook_macro_creation.yml"
      }
    },
    {
      "id": "bbb7e38c-0b41-4a11-b306-d2a457b7ac2b",
      "title": "Suspicious File Created In PerfLogs",
      "status": "test",
      "description": "Detects suspicious file based on their extension being created in \"C:\\PerfLogs\\\". Note that this directory mostly contains \".etl\" files",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": "C:\\PerfLogs\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".7z",
                  ".bat",
                  ".bin",
                  ".chm",
                  ".dll",
                  ".exe",
                  ".hta",
                  ".lnk",
                  ".ps1",
                  ".psm1",
                  ".py",
                  ".scr",
                  ".sys",
                  ".vbe",
                  ".vbs",
                  ".zip"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-05",
        "modified": "",
        "references": [
          "Internal Research",
          "https://labs.withsecure.com/publications/fin7-target-veeam-servers"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_perflogs_susp_files.yml"
      }
    },
    {
      "id": "02773bed-83bf-469f-b7ff-e676e7d78bab",
      "title": "BloodHound Collection Files",
      "status": "test",
      "description": "Detects default file names outputted by the BloodHound collection tool SharpHound",
      "level": "high",
      "tags": [
        "attack.discovery",
        "attack.t1087.001",
        "attack.t1087.002",
        "attack.t1482",
        "attack.t1069.001",
        "attack.t1069.002",
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  "BloodHound.zip",
                  "_computers.json",
                  "_containers.json",
                  "_domains.json",
                  "_gpos.json",
                  "_groups.json",
                  "_ous.json",
                  "_users.json"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_ms_winapps": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\svchost.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": "C:\\Program Files\\WindowsApps\\Microsoft.",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "\\pocket_containers.json",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1087.001",
          "T1087.002",
          "T1482",
          "T1069.001",
          "T1069.002",
          "T1059.001"
        ],
        "tactics": [
          "discovery",
          "execution"
        ]
      },
      "meta": {
        "author": "C.J. May",
        "date": "2022-08-09",
        "modified": "2023-03-29",
        "references": [
          "https://academy.hackthebox.com/course/preview/active-directory-bloodhound/bloodhound--data-collection"
        ],
        "falsepositives": [
          "Some false positives may arise in some environment and this may require some tuning. Add additional filters or reduce level depending on the level of noise"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_bloodhound_collection.yml"
      }
    },
    {
      "id": "e36941d0-c0f0-443f-bc6f-cb2952eb69ea",
      "title": "PowerShell Module File Created",
      "status": "test",
      "description": "Detects the creation of a new PowerShell module \".psm1\", \".psd1\", \".dll\", \".ps1\", etc.",
      "level": "low",
      "tags": [
        "attack.persistence"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\powershell.exe",
                  "\\pwsh.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  "\\WindowsPowerShell\\Modules\\",
                  "\\PowerShell\\7\\Modules\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-09",
        "modified": "",
        "references": [
          "Internal Research",
          "https://learn.microsoft.com/en-us/powershell/scripting/developer/module/understanding-a-windows-powershell-module?view=powershell-7.3"
        ],
        "falsepositives": [
          "Likely"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_powershell_module_creation.yml"
      }
    },
    {
      "id": "9711de76-5d4f-4c50-a94f-21e4e8f8384d",
      "title": "Installation of TeamViewer Desktop",
      "status": "test",
      "description": "TeamViewer_Desktop.exe is create during install",
      "level": "medium",
      "tags": [
        "attack.command-and-control",
        "attack.t1219.002"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "\\TeamViewer_Desktop.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1219.002"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-28",
        "modified": "",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1219/T1219.md#atomic-test-1---teamviewer-files-detected-test-on-windows"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_install_teamviewer_desktop.yml"
      }
    },
    {
      "id": "3d2a2d59-929c-4b78-8c1a-145dfe9e07b1",
      "title": "Publisher Attachment File Dropped In Suspicious Location",
      "status": "test",
      "description": "Detects creation of files with the \".pub\" extension in suspicious or uncommon locations. This could be a sign of attackers abusing Publisher documents",
      "level": "medium",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  "\\AppData\\Local\\Temp\\",
                  "\\Users\\Public\\",
                  "\\Windows\\Temp\\",
                  "C:\\Temp\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".pub",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-02-08",
        "modified": "",
        "references": [
          "https://twitter.com/EmericNasi/status/1623224526220804098"
        ],
        "falsepositives": [
          "Legitimate usage of \".pub\" files from those locations"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_office_publisher_files_in_susp_locations.yml"
      }
    },
    {
      "id": "1027d292-dd87-4a1a-8701-2abe04d7783c",
      "title": "PSScriptPolicyTest Creation By Uncommon Process",
      "status": "test",
      "description": "Detects the creation of the \"PSScriptPolicyTest\" PowerShell script by an uncommon process. This file is usually generated by Microsoft Powershell to test against Applocker.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "__PSScriptPolicyTest_",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_powershell": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\PowerShell\\7-preview\\pwsh.exe",
                  "C:\\Program Files\\PowerShell\\7\\pwsh.exe",
                  "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell_ise.exe",
                  "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",
                  "C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell_ise.exe",
                  "C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_pwsh_preview": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\WindowsApps\\Microsoft.PowerShellPreview",
                  "\\AppData\\Local\\Microsoft\\WindowsApps\\Microsoft.PowerShellPreview"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\pwsh.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_generic": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Windows\\System32\\dsac.exe",
                  "C:\\Windows\\System32\\sdiagnhost.exe",
                  "C:\\Windows\\System32\\ServerManager.exe",
                  "C:\\Windows\\System32\\wsmprovhost.exe",
                  "C:\\Windows\\SysWOW64\\sdiagnhost.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-06-01",
        "modified": "2025-10-07",
        "references": [
          "https://www.paloaltonetworks.com/blog/security-operations/stopping-powershell-without-powershell/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_ps_script_policy_test_creation_by_uncommon_process.yml"
      }
    },
    {
      "id": "16fe46bb-4f64-46aa-817d-ff7bec4a2352",
      "title": "LiveKD Driver Creation",
      "status": "test",
      "description": "Detects the creation of the LiveKD driver, which is used for live kernel debugging",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename": {
                "field": "TargetFilename",
                "value": "C:\\Windows\\System32\\drivers\\LiveKdD.SYS",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\livekd.exe",
                  "\\livek64.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-16",
        "modified": "",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Legitimate usage of LiveKD for debugging purposes will also trigger this"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_sysinternals_livekd_driver.yml"
      }
    },
    {
      "id": "318557a5-150c-4c8d-b70e-a9910e199857",
      "title": "File Creation In Suspicious Directory By Msdt.EXE",
      "status": "test",
      "description": "Detects msdt.exe creating files in suspicious directories which could be a sign of exploitation of either Follina or Dogwalk vulnerabilities",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547.001",
        "cve.2022-30190"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\msdt.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  "\\Desktop\\",
                  "\\Start Menu\\Programs\\Startup\\",
                  "C:\\PerfLogs\\",
                  "C:\\ProgramData\\",
                  "C:\\Users\\Public\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1547.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Vadim Varganov, Florian Roth (Nextron Systems)",
        "date": "2022-08-24",
        "modified": "2023-02-23",
        "references": [
          "https://irsl.medium.com/the-trouble-with-microsofts-troubleshooters-6e32fc80b8bd",
          "https://msrc-blog.microsoft.com/2022/05/30/guidance-for-cve-2022-30190-microsoft-support-diagnostic-tool-vulnerability/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_msdt_susp_directories.yml"
      }
    },
    {
      "id": "c3e76af5-4ce0-4a14-9c9a-25ceb8fda182",
      "title": "WerFault LSASS Process Memory Dump",
      "status": "test",
      "description": "Detects WerFault creating a dump file with a name that indicates that the dump file could be an LSASS process memory, which contains user credentials",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003.001"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\WINDOWS\\system32\\WerFault.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  "\\lsass",
                  "lsass.exe"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.001"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-06-27",
        "modified": "",
        "references": [
          "https://github.com/helpsystems/nanodump"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_lsass_werfault_dump.yml"
      }
    },
    {
      "id": "b6f91281-20aa-446a-b986-38a92813a18f",
      "title": "DLL Search Order Hijackig Via Additional Space in Path",
      "status": "test",
      "description": "Detects when an attacker create a similar folder structure to windows system folders such as (Windows, Program Files...)\nbut with a space in order to trick DLL load search order and perform a \"DLL Search Order Hijacking\" attack\n",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.privilege-escalation",
        "attack.defense-evasion",
        "attack.t1574.001"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": [
                  "C:\\Windows \\",
                  "C:\\Program Files \\",
                  "C:\\Program Files (x86) \\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".dll",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1574.001"
        ],
        "tactics": [
          "persistence",
          "privilege_escalation",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-07-30",
        "modified": "",
        "references": [
          "https://twitter.com/cyb3rops/status/1552932770464292864",
          "https://www.wietzebeukema.nl/blog/hijacking-dlls-in-windows"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_dll_sideloading_space_path.yml"
      }
    },
    {
      "id": "6b269392-9eba-40b5-acb6-55c882b20ba6",
      "title": "Suspicious File Drop by Exchange",
      "status": "test",
      "description": "Detects suspicious file type dropped by an Exchange component in IIS",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.t1190",
        "attack.initial-access",
        "attack.t1505.003"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\w3wp.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains": {
                "field": "CommandLine",
                "value": "MSExchange",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_types": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".aspx",
                  ".asp",
                  ".ashx",
                  ".ps1",
                  ".bat",
                  ".exe",
                  ".dll",
                  ".vbs"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1190",
          "T1505.003"
        ],
        "tactics": [
          "persistence",
          "initial_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-10-04",
        "modified": "",
        "references": [
          "https://www.microsoft.com/security/blog/2022/09/30/analyzing-attacks-using-the-exchange-vulnerabilities-cve-2022-41040-and-cve-2022-41082/",
          "https://www.gteltsc.vn/blog/canh-bao-chien-dich-tan-cong-su-dung-lo-hong-zero-day-tren-microsoft-exchange-server-12714.html",
          "https://en.gteltsc.vn/blog/cap-nhat-nhe-ve-lo-hong-bao-mat-0day-microsoft-exchange-dang-duoc-su-dung-de-tan-cong-cac-to-chuc-tai-viet-nam-9685.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_exchange_webshell_drop_suspicious.yml"
      }
    },
    {
      "id": "91174a41-dc8f-401b-be89-7bfc140612a0",
      "title": "Office Macro File Creation",
      "status": "test",
      "description": "Detects the creation of a new office macro files on the systems",
      "level": "low",
      "tags": [
        "attack.initial-access",
        "attack.t1566.001"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".docm",
                  ".dotm",
                  ".xlsm",
                  ".xltm",
                  ".potm",
                  ".pptm"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1566.001"
        ],
        "tactics": [
          "initial_access"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-01-23",
        "modified": "",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1566.001/T1566.001.md",
          "https://learn.microsoft.com/en-us/deployoffice/compat/office-file-format-reference"
        ],
        "falsepositives": [
          "Very common in environments that rely heavily on macro documents"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_office_macro_files_created.yml"
      }
    },
    {
      "id": "e074832a-eada-4fd7-94a1-10642b130e16",
      "title": "HackTool - SafetyKatz Dump Indicator",
      "status": "test",
      "description": "Detects default lsass dump filename generated by SafetyKatz.",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003.001"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "\\Temp\\debug.bin",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.001"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Markus Neis",
        "date": "2018-07-24",
        "modified": "2024-06-27",
        "references": [
          "https://github.com/GhostPack/SafetyKatz",
          "https://github.com/GhostPack/SafetyKatz/blob/715b311f76eb3a4c8d00a1bd29c6cd1899e450b7/SafetyKatz/Program.cs#L63"
        ],
        "falsepositives": [
          "Rare legitimate files with similar filename structure"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_hktl_safetykatz.yml"
      }
    },
    {
      "id": "c3edc6a5-d9d4-48d8-930e-aab518390917",
      "title": "Potential Persistence Via Outlook Form",
      "status": "test",
      "description": "Detects the creation of a new Outlook form which can contain malicious code",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.t1137.003"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\outlook.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  "\\AppData\\Local\\Microsoft\\FORMS\\IPM",
                  "\\Local Settings\\Application Data\\Microsoft\\Forms"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1137.003"
        ],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "Tobias Michalski (Nextron Systems)",
        "date": "2021-06-10",
        "modified": "2023-02-22",
        "references": [
          "https://speakerdeck.com/heirhabarov/hunting-for-persistence-via-microsoft-exchange-server-or-outlook?slide=76",
          "https://speakerdeck.com/heirhabarov/hunting-for-persistence-via-microsoft-exchange-server-or-outlook?slide=79",
          "https://learn.microsoft.com/en-us/office/vba/outlook/concepts/outlook-forms/create-an-outlook-form",
          "https://www.slipstick.com/developer/custom-form/clean-outlooks-forms-cache/"
        ],
        "falsepositives": [
          "Legitimate use of outlook forms"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_office_outlook_newform.yml"
      }
    },
    {
      "id": "92fa78e7-4d39-45f1-91a3-8b23f3f1088d",
      "title": "Potential Startup Shortcut Persistence Via PowerShell.EXE",
      "status": "test",
      "description": "Detects PowerShell writing startup shortcuts.\nThis procedure was highlighted in Red Canary Intel Insights Oct. 2021, \"We frequently observe adversaries using PowerShell to write malicious .lnk files into the startup directory to establish persistence.\nAccordingly, this detection opportunity is likely to identify persistence mechanisms in multiple threats.\nIn the context of Yellow Cockatoo, this persistence mechanism eventually launches the command-line script that leads to the installation of a malicious DLL\"\n",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547.001"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\powershell.exe",
                  "\\pwsh.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\start menu\\programs\\startup\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".lnk",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1547.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Christopher Peacock '@securepeacock', SCYTHE",
        "date": "2021-10-24",
        "modified": "2023-02-23",
        "references": [
          "https://redcanary.com/blog/intelligence-insights-october-2021/",
          "https://github.com/redcanaryco/atomic-red-team/blob/36d49de4c8b00bf36054294b4a1fcbab3917d7c5/atomics/T1547.001/T1547.001.md#atomic-test-7---add-executable-shortcut-link-to-user-startup-folder"
        ],
        "falsepositives": [
          "Depending on your environment accepted applications may leverage this at times. It is recommended to search for anomalies inidicative of malware."
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_powershell_startup_shortcuts.yml"
      }
    },
    {
      "id": "93d94efc-d7ad-4161-ad7d-1638c4f908d8",
      "title": "HackTool - Dumpert Process Dumper Default File",
      "status": "test",
      "description": "Detects the creation of the default dump file used by Outflank Dumpert tool. A process dumper, which dumps the lsass process memory",
      "level": "critical",
      "tags": [
        "attack.credential-access",
        "attack.t1003.001"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "dumpert.dmp",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.001"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2020-02-04",
        "modified": "2023-05-09",
        "references": [
          "https://github.com/outflanknl/Dumpert",
          "https://unit42.paloaltonetworks.com/actors-still-exploiting-sharepoint-vulnerability/"
        ],
        "falsepositives": [
          "Very unlikely"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_hktl_dumpert.yml"
      }
    },
    {
      "id": "de46c52b-0bf8-4936-a327-aace94f94ac6",
      "title": "Process Explorer Driver Creation By Non-Sysinternals Binary",
      "status": "test",
      "description": "Detects creation of the Process Explorer drivers by processes other than Process Explorer (procexp) itself.\nHack tools or malware may use the Process Explorer driver to elevate privileges, drops it to disk for a few moments, runs a service using that driver and removes it afterwards.\n",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.privilege-escalation",
        "attack.t1068"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\PROCEXP",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".sys",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_process_explorer": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\procexp.exe",
                  "\\procexp64.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1068"
        ],
        "tactics": [
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2023-05-05",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/sysinternals/downloads/process-explorer",
          "https://github.com/Yaxser/Backstab",
          "https://www.elastic.co/security-labs/stopping-vulnerable-driver-attacks",
          "https://news.sophos.com/en-us/2023/04/19/aukill-edr-killer-malware-abuses-process-explorer-driver/"
        ],
        "falsepositives": [
          "Some false positives may occur with legitimate renamed process explorer binaries"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_sysinternals_procexp_driver_susp_creation.yml"
      }
    },
    {
      "id": "97aa2e88-555c-450d-85a6-229bcd87efb8",
      "title": "Suspicious Screensaver Binary File Creation",
      "status": "test",
      "description": "Adversaries may establish persistence by executing malicious content triggered by user inactivity.\nScreensavers are programs that execute after a configurable time of user inactivity and consist of Portable Executable (PE) files with a .scr file extension\n",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1546.002"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".scr",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_generic": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\Kindle.exe",
                  "\\Bin\\ccSvcHst.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_tiworker": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\TiWorker.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "\\uwfservicingscr.scr",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1546.002"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-12-29",
        "modified": "2022-11-08",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1546.002/T1546.002.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_creation_scr_binary_file.yml"
      }
    },
    {
      "id": "e0b06658-7d1d-4cd3-bf15-03467507ff7c",
      "title": "Suspicious DotNET CLR Usage Log Artifact",
      "status": "test",
      "description": "Detects the creation of Usage Log files by the CLR (clr.dll). These files are named after the executing process once the assembly is finished executing for the first time in the (user) session context.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  "\\UsageLogs\\cmstp.exe.log",
                  "\\UsageLogs\\cscript.exe.log",
                  "\\UsageLogs\\mshta.exe.log",
                  "\\UsageLogs\\msxsl.exe.log",
                  "\\UsageLogs\\regsvr32.exe.log",
                  "\\UsageLogs\\rundll32.exe.log",
                  "\\UsageLogs\\svchost.exe.log",
                  "\\UsageLogs\\wscript.exe.log",
                  "\\UsageLogs\\wmic.exe.log"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_rundll32": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": "\\MsiExec.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "ParentCommandLine__contains": {
                "field": "ParentCommandLine",
                "value": " -Embedding",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\rundll32.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "CommandLine__contains_all": {
                "field": "CommandLine",
                "value": [
                  "Temp",
                  "zzzzInvokeManagedCustomActionOutOfProc"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113, omkar72, oscd.community, Wojciech Lesicki",
        "date": "2022-11-18",
        "modified": "2023-02-23",
        "references": [
          "https://bohops.com/2021/03/16/investigating-net-clr-usage-log-tampering-techniques-for-edr-evasion/",
          "https://github.com/olafhartong/sysmon-modular/blob/fa1ae53132403d262be2bbd7f17ceea7e15e8c78/11_file_create/include_dotnet.xml",
          "https://web.archive.org/web/20221026202428/https://gist.github.com/code-scrap/d7f152ffcdb3e0b02f7f394f5187f008",
          "https://web.archive.org/web/20230329154538/https://blog.menasec.net/2019/07/interesting-difr-traces-of-net-clr.html"
        ],
        "falsepositives": [
          "Rundll32.exe with zzzzInvokeManagedCustomActionOutOfProc in command line and msiexec.exe as parent process - https://twitter.com/SBousseaden/status/1388064061087260675"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_net_cli_artefact.yml"
      }
    },
    {
      "id": "0bcfabcb-7929-47f4-93d6-b33fb67d34d1",
      "title": "Adwind RAT / JRAT File Artifact",
      "status": "test",
      "description": "Detects javaw.exe in AppData folder as used by Adwind / JRAT",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059.005",
        "attack.t1059.007"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "TargetFilename__contains_all": {
                    "field": "TargetFilename",
                    "value": [
                      "\\AppData\\Roaming\\Oracle\\bin\\java",
                      ".exe"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "TargetFilename__contains_all": {
                    "field": "TargetFilename",
                    "value": [
                      "\\Retrive",
                      ".vbs"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1059.005",
          "T1059.007"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Tom Ueltschi, Jonhnathan Ribeiro, oscd.community",
        "date": "2017-11-10",
        "modified": "2022-12-02",
        "references": [
          "https://www.hybrid-analysis.com/sample/ba86fa0d4b6af2db0656a88b1dd29f36fe362473ae8ad04255c4e52f214a541c?environmentId=100",
          "https://www.first.org/resources/papers/conf2017/Advanced-Incident-Detection-and-Threat-Hunting-using-Sysmon-and-Splunk.pdf"
        ],
        "falsepositives": [],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_mal_adwind.yml"
      }
    },
    {
      "id": "c048f047-7e2a-4888-b302-55f509d4a91d",
      "title": "SCR File Write Event",
      "status": "test",
      "description": "Detects the creation of screensaver files (.scr) outside of system folders. Attackers may execute an application as an \".SCR\" file using \"rundll32.exe desk.cpl,InstallScreenSaver\" for example.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.011"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".scr",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  ":\\$WINDOWS.~BT\\NewOS\\",
                  ":\\Windows\\System32\\",
                  ":\\Windows\\SysWOW64\\",
                  ":\\Windows\\WinSxS\\",
                  ":\\WUDownloadCache\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1218.011"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Christopher Peacock @securepeacock, SCYTHE @scythe_io",
        "date": "2022-04-27",
        "modified": "2023-08-23",
        "references": [
          "https://lolbas-project.github.io/lolbas/Libraries/Desk/"
        ],
        "falsepositives": [
          "The installation of new screen savers by third party software"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_new_scr_file.yml"
      }
    },
    {
      "id": "b8fd0e93-ff58-4cbd-8f48-1c114e342e62",
      "title": "Windows Binaries Write Suspicious Extensions",
      "status": "test",
      "description": "Detects Windows executables that write files with suspicious extensions",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_generic": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\csrss.exe",
                  "\\lsass.exe",
                  "\\RuntimeBroker.exe",
                  "\\sihost.exe",
                  "\\smss.exe",
                  "\\wininit.exe",
                  "\\winlogon.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".bat",
                  ".dll",
                  ".exe",
                  ".hta",
                  ".iso",
                  ".ps1",
                  ".txt",
                  ".vbe",
                  ".vbs"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_special": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\dllhost.exe",
                  "\\rundll32.exe",
                  "\\svchost.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".bat",
                  ".hta",
                  ".iso",
                  ".ps1",
                  ".vbe",
                  ".vbs"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_AppLockerPolicyTest": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\System32\\dllhost.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__contains_all": {
                "field": "TargetFilename",
                "value": [
                  ":\\Users\\",
                  "\\AppData\\Local\\Temp\\__PSScriptPolicyTest_"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".ps1",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_script_gpo_machine": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\system32\\svchost.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__contains_all": {
                "field": "TargetFilename",
                "value": [
                  "C:\\Windows\\System32\\GroupPolicy\\DataStore\\",
                  "\\sysvol\\",
                  "\\Policies\\",
                  "\\Machine\\Scripts\\Startup\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".ps1",
                  ".bat"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_clipchamp": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\system32\\svchost.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__contains_all": {
                "field": "TargetFilename",
                "value": [
                  "C:\\Program Files\\WindowsApps\\Clipchamp",
                  ".ps1"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_powershell_preview": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Windows\\system32\\svchost.exe",
                  "C:\\Windows\\SysWOW64\\svchost.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": [
                  "C:\\Program Files\\WindowsApps\\Microsoft.PowerShellPreview",
                  "C:\\Program Files (x86)\\WindowsApps\\Microsoft.PowerShellPreview"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".ps1",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "1 of selection_* and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "1 of selection_*"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1036"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-12",
        "modified": "2025-10-07",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_shell_write_susp_files_extensions.yml"
      }
    },
    {
      "id": "8468111a-ef07-4654-903b-b863a80bbc95",
      "title": "VHD Image Download Via Browser",
      "status": "test",
      "description": "Detects creation of \".vhd\"/\".vhdx\" files by browser processes.\nMalware can use mountable Virtual Hard Disk \".vhd\" files to encapsulate payloads and evade security controls.\n",
      "level": "medium",
      "tags": [
        "attack.resource-development",
        "attack.t1587.001"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\brave.exe",
                  "\\chrome.exe",
                  "\\firefox.exe",
                  "\\iexplore.exe",
                  "\\maxthon.exe",
                  "\\MicrosoftEdge.exe",
                  "\\msedge.exe",
                  "\\msedgewebview2.exe",
                  "\\opera.exe",
                  "\\safari.exe",
                  "\\seamonkey.exe",
                  "\\vivaldi.exe",
                  "\\whale.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": ".vhd",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1587.001"
        ],
        "tactics": [
          "resource_development"
        ]
      },
      "meta": {
        "author": "frack113, Christopher Peacock '@securepeacock', SCYTHE '@scythe_io'",
        "date": "2021-10-25",
        "modified": "2023-05-05",
        "references": [
          "https://redcanary.com/blog/intelligence-insights-october-2021/",
          "https://www.kaspersky.com/blog/lazarus-vhd-ransomware/36559/",
          "https://securelist.com/lazarus-on-the-hunt-for-big-game/97757/"
        ],
        "falsepositives": [
          "Legitimate downloads of \".vhd\" files would also trigger this"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_vhd_download_via_browsers.yml"
      }
    },
    {
      "id": "d102b8f5-61dc-4e68-bd83-9a3187c67377",
      "title": "Renamed VsCode Code Tunnel Execution - File Indicator",
      "status": "test",
      "description": "Detects the creation of a file with the name \"code_tunnel.json\" which indicate execution and usage of VsCode tunneling utility by an \"Image\" or \"Process\" other than VsCode.\n",
      "level": "high",
      "tags": [
        "attack.command-and-control"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "\\code_tunnel.json",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_legit_name": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\code-tunnel.exe",
                  "\\code.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-10-25",
        "modified": "",
        "references": [
          "https://ipfyx.fr/post/visual-studio-code-tunnel/",
          "https://badoption.eu/blog/2023/01/31/code_c2.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_vscode_tunnel_renamed_execution.yml"
      }
    },
    {
      "id": "117d3d3a-755c-4a61-b23e-9171146d094c",
      "title": "Suspicious Outlook Macro Created",
      "status": "test",
      "description": "Detects the creation of a macro file for Outlook.",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.command-and-control",
        "attack.t1137",
        "attack.t1008",
        "attack.t1546"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "\\Microsoft\\Outlook\\VbaProject.OTM",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\outlook.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1137",
          "T1008",
          "T1546"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-02-08",
        "modified": "",
        "references": [
          "https://www.mdsec.co.uk/2020/11/a-fresh-outlook-on-mail-based-persistence/",
          "https://speakerdeck.com/heirhabarov/hunting-for-persistence-via-microsoft-exchange-server-or-outlook?slide=53",
          "https://www.linkedin.com/pulse/outlook-backdoor-using-vba-samir-b-/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_office_outlook_susp_macro_creation.yml"
      }
    },
    {
      "id": "259e5a6a-b8d2-4c38-86e2-26c5e651361d",
      "title": "PsExec Service File Creation",
      "status": "test",
      "description": "Detects default PsExec service filename which indicates PsExec service installation and execution",
      "level": "low",
      "tags": [
        "attack.execution",
        "attack.t1569.002",
        "attack.s0029"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "\\PSEXESVC.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1569.002"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Thomas Patzke",
        "date": "2017-06-12",
        "modified": "2022-10-26",
        "references": [
          "https://www.jpcert.or.jp/english/pub/sr/ir_research.html",
          "https://jpcertcc.github.io/ToolAnalysisResultSheet"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_sysinternals_psexec_service.yml"
      }
    },
    {
      "id": "9e099d99-44c2-42b6-a6d8-54c3545cab29",
      "title": "HackTool - Mimikatz Kirbi File Creation",
      "status": "test",
      "description": "Detects the creation of files created by mimikatz such as \".kirbi\", \"mimilsa.log\", etc.",
      "level": "critical",
      "tags": [
        "attack.credential-access",
        "attack.t1558"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".kirbi",
                  "mimilsa.log"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1558"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), David ANDRE",
        "date": "2021-11-08",
        "modified": "2024-06-27",
        "references": [
          "https://cobalt.io/blog/kerberoast-attack-techniques",
          "https://pentestlab.blog/2019/10/21/persistence-security-support-provider/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_hktl_mimikatz_files.yml"
      }
    },
    {
      "id": "1d2de8a6-4803-4fde-b85b-f58f3aa7a705",
      "title": "Potentially Suspicious WDAC Policy File Creation",
      "status": "experimental",
      "description": "Detects suspicious Windows Defender Application Control (WDAC) policy file creation from abnormal processes that could be abused by attacker to block EDR/AV components while allowing their own malicious code to run on the system.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_target": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\Windows\\System32\\CodeIntegrity\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_images": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\Microsoft.ConfigurationManagement.exe",
                  "\\WDAC Wizard.exe",
                  "C:\\Program Files\\PowerShell\\7-preview\\pwsh.exe",
                  "C:\\Program Files\\PowerShell\\7\\pwsh.exe",
                  "C:\\Windows\\System32\\dllhost.exe",
                  "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell_ise.exe",
                  "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",
                  "C:\\Windows\\SysWOW64\\dllhost.exe",
                  "C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell_ise.exe",
                  "C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_cli": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "ConvertFrom-CIPolicy -XmlFilePath",
                      "-BinaryFilePath "
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains": {
                    "field": "CommandLine",
                    "value": "CiTool --update-policy",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "CommandLine__contains_all": {
                    "field": "CommandLine",
                    "value": [
                      "Copy-Item -Path",
                      "-Destination"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "filter_main_system": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "System",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_wuauclt": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Windows\\System32\\wuauclt.exe",
                  "C:\\Windows\\UUS\\arm64\\wuaucltcore.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection_target and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_target"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "X__Junior",
        "date": "2025-02-07",
        "modified": "2025-12-03",
        "references": [
          "https://learn.microsoft.com/en-us/windows/security/application-security/application-control/app-control-for-business/deployment/deploy-appcontrol-policies-using-group-policy",
          "https://beierle.win/2024-12-20-Weaponizing-WDAC-Killing-the-Dreams-of-EDR/",
          "https://github.com/logangoins/Krueger/tree/main",
          "https://learn.microsoft.com/en-us/windows/security/application-security/application-control/app-control-for-business/deployment/appcontrol-deployment-guide",
          "https://learn.microsoft.com/en-us/windows/security/application-security/application-control/app-control-for-business/deployment/deploy-appcontrol-policies-with-script",
          "https://learn.microsoft.com/en-us/windows/security/application-security/application-control/app-control-for-business/deployment/deploy-appcontrol-policies-with-memcm"
        ],
        "falsepositives": [
          "Administrators and security vendors could leverage WDAC, apply additional filters as needed."
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_susp_wdac_policy_creation.yml"
      }
    },
    {
      "id": "4e7050dd-e548-483f-b7d6-527ab4fa784d",
      "title": "NTDS.DIT Creation By Uncommon Parent Process",
      "status": "test",
      "description": "Detects creation of a file named \"ntds.dit\" (Active Directory Database) by an uncommon parent process or directory",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003.003"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_file": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "\\ntds.dit",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_process_parent": {
            "type": "field_match",
            "matchers": {
              "ParentImage__endswith": {
                "field": "ParentImage",
                "value": [
                  "\\cscript.exe",
                  "\\httpd.exe",
                  "\\nginx.exe",
                  "\\php-cgi.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\w3wp.exe",
                  "\\wscript.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_process_parent_path": {
            "type": "field_match",
            "matchers": {
              "ParentImage__contains": {
                "field": "ParentImage",
                "value": [
                  "\\apache",
                  "\\tomcat",
                  "\\AppData\\",
                  "\\Temp\\",
                  "\\Public\\",
                  "\\PerfLogs\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_file and 1 of selection_process_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_file"
            },
            {
              "type": "ref",
              "value": "1 of selection_process_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1003.003"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-03-11",
        "modified": "2023-01-05",
        "references": [
          "https://www.ired.team/offensive-security/credential-access-and-credential-dumping/ntds.dit-enumeration",
          "https://www.n00py.io/2022/03/manipulating-user-passwords-without-mimikatz/",
          "https://pentestlab.blog/tag/ntds-dit/",
          "https://github.com/samratashok/nishang/blob/414ee1104526d7057f9adaeee196d91ae447283e/Gather/Copy-VSS.ps1"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_ntds_dit_uncommon_parent_process.yml"
      }
    },
    {
      "id": "c61daa90-3c1e-4f18-af62-8f288b5c9aaf",
      "title": "Uncommon File Creation By Mysql Daemon Process",
      "status": "test",
      "description": "Detects the creation of files with scripting or executable extensions by Mysql daemon.\nWhich could be an indicator of \"User Defined Functions\" abuse to download malware.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "file_event",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\mysqld.exe",
                  "\\mysqld-nt.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".bat",
                  ".dat",
                  ".dll",
                  ".exe",
                  ".ps1",
                  ".psm1",
                  ".vbe",
                  ".vbs"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Joseph Kamau",
        "date": "2024-05-27",
        "modified": "",
        "references": [
          "https://asec.ahnlab.com/en/58878/",
          "https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/honeypot-recon-mysql-malware-infection-via-user-defined-functions-udf/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_event/file_event_win_mysqld_uncommon_file_creation.yml"
      }
    }
  ]
}