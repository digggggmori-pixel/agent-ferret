{
  "metadata": {
    "logsource": "windows_raw_access_thread",
    "rule_count": 1,
    "compiled_at": "2026-02-04T12:28:36.530079",
    "version": "1.1"
  },
  "rules": [
    {
      "id": "db809f10-56ce-4420-8c86-d6a7d793c79c",
      "title": "Potential Defense Evasion Via Raw Disk Access By Uncommon Tools",
      "status": "test",
      "description": "Detects raw disk access using uncommon tools or tools that are located in suspicious locations (heavy filtering is required), which could indicate possible defense evasion attempts",
      "level": "low",
      "tags": [
        "attack.defense-evasion",
        "attack.t1006"
      ],
      "logsource": {
        "category": "raw_access_thread",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {},
        "filters": {
          "filter_main_floppy": {
            "type": "field_match",
            "matchers": {
              "Device__contains": {
                "field": "Device",
                "value": "floppy",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_generic": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\$WINDOWS.~BT\\",
                  "C:\\Program Files (x86)\\",
                  "C:\\Program Files\\",
                  "C:\\Windows\\CCM\\",
                  "C:\\Windows\\explorer.exe",
                  "C:\\Windows\\servicing\\",
                  "C:\\Windows\\SoftwareDistribution\\",
                  "C:\\Windows\\System32\\",
                  "C:\\Windows\\SystemApps\\",
                  "C:\\Windows\\SysWOW64\\",
                  "C:\\Windows\\uus\\",
                  "C:\\Windows\\WinSxS\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_system_images": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "Registry",
                  "System"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_windefender": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\MsMpEng.exe",
                  "\\MpDefenderCoreService.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_microsoft_appdata": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Users\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__contains_all": {
                "field": "Image",
                "value": [
                  "\\AppData\\",
                  "\\Microsoft\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_ssd_nvme": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Windows\\Temp\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\Executables\\SSDUpdate.exe",
                  "\\HostMetadata\\NVMEHostmetadata.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_null": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_systemsettings": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\ImmersiveControlPanel\\SystemSettings.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_update": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\$WinREAgent\\Scratch\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_github_desktop": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Users\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__contains": {
                "field": "Image",
                "value": "\\AppData\\Local\\GitHubDesktop\\app-",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\resources\\app\\git\\mingw64\\bin\\git.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_nextron": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Windows\\Temp\\asgard2-agent\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\thor.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_Keybase": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Users\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__contains": {
                "field": "Image",
                "value": "\\AppData\\Local\\Keybase\\upd.exe",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1006"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Teymur Kheirkhabarov, oscd.community",
        "date": "2019-10-22",
        "modified": "2025-12-03",
        "references": [
          "https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment"
        ],
        "falsepositives": [
          "Likely"
        ],
        "source_file": "sigma_rules/windows/raw_access_thread/raw_access_thread_susp_disk_access_using_uncommon_tools.yml"
      }
    }
  ]
}