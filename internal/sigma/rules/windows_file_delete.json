{
  "metadata": {
    "logsource": "windows_file_delete",
    "rule_count": 12,
    "compiled_at": "2026-02-04T12:28:36.374819",
    "version": "1.1"
  },
  "rules": [
    {
      "id": "3eb8c339-a765-48cc-a150-4364c04652bf",
      "title": "IIS WebServer Access Logs Deleted",
      "status": "test",
      "description": "Detects the deletion of IIS WebServer access logs which may indicate an attempt to destroy forensic evidence",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1070"
      ],
      "logsource": {
        "category": "file_delete",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\inetpub\\logs\\LogFiles\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".log",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1070"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Tim Rauch (Nextron Systems), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-09-16",
        "modified": "2023-02-15",
        "references": [
          "https://www.elastic.co/guide/en/security/current/webserver-access-logs-deleted.html"
        ],
        "falsepositives": [
          "During uninstallation of the IIS service",
          "During log rotation"
        ],
        "source_file": "sigma_rules/windows/file/file_delete/file_delete_win_delete_iis_access_logs.yml"
      }
    },
    {
      "id": "3109530e-ab47-4cc6-a953-cac5ebcc93ae",
      "title": "ADS Zone.Identifier Deleted By Uncommon Application",
      "status": "test",
      "description": "Detects the deletion of the \"Zone.Identifier\" ADS by an uncommon process. Attackers can leverage this in order to bypass security restrictions that make use of the ADS such as Microsoft Office apps.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1070.004"
      ],
      "logsource": {
        "category": "file_delete",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ":Zone.Identifier",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_generic": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\PowerShell\\7-preview\\pwsh.exe",
                  "C:\\Program Files\\PowerShell\\7\\pwsh.exe",
                  "C:\\Windows\\explorer.exe",
                  "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",
                  "C:\\Windows\\SysWOW64\\explorer.exe",
                  "C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_browsers_chrome": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe",
                  "C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_browsers_firefox": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe",
                  "C:\\Program Files\\Mozilla Firefox\\firefox.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_browsers_msedge": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe",
                  "C:\\Program Files\\Microsoft\\Edge\\Application\\msedge.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1070.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-09-04",
        "modified": "2025-07-04",
        "references": [
          "https://securityliterate.com/how-malware-abuses-the-zone-identifier-to-circumvent-detection-and-analysis/",
          "Internal Research"
        ],
        "falsepositives": [
          "Other third party applications not listed."
        ],
        "source_file": "sigma_rules/windows/file/file_delete/file_delete_win_zone_identifier_ads_uncommon.yml"
      }
    },
    {
      "id": "270185ff-5f50-4d6d-a27f-24c3b8c9fef8",
      "title": "Tomcat WebServer Logs Deleted",
      "status": "test",
      "description": "Detects the deletion of tomcat WebServer logs which may indicate an attempt to destroy forensic evidence",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1070"
      ],
      "logsource": {
        "category": "file_delete",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains_all": {
                "field": "TargetFilename",
                "value": [
                  "\\Tomcat",
                  "\\logs\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": [
                  "catalina.",
                  "_access_log.",
                  "localhost."
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1070"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-02-16",
        "modified": "",
        "references": [
          "Internal Research",
          "https://linuxhint.com/view-tomcat-logs-windows/"
        ],
        "falsepositives": [
          "During uninstallation of the tomcat server",
          "During log rotation"
        ],
        "source_file": "sigma_rules/windows/file/file_delete/file_delete_win_delete_tomcat_logs.yml"
      }
    },
    {
      "id": "8f0b1fb1-9bd4-4e74-8cdf-a8de4d2adfd0",
      "title": "Unusual File Deletion by Dns.exe",
      "status": "test",
      "description": "Detects an unexpected file being deleted by dns.exe which my indicate activity related to remote code execution or other forms of exploitation as seen in CVE-2020-1350 (SigRed)",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.initial-access",
        "attack.t1133"
      ],
      "logsource": {
        "category": "file_delete",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\dns.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "\\dns.log",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1133"
        ],
        "tactics": [
          "persistence",
          "initial_access"
        ]
      },
      "meta": {
        "author": "Tim Rauch (Nextron Systems), Elastic (idea)",
        "date": "2022-09-27",
        "modified": "2023-02-15",
        "references": [
          "https://www.elastic.co/guide/en/security/current/unusual-file-modification-by-dns-exe.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_delete/file_delete_win_unusual_deletion_by_dns_exe.yml"
      }
    },
    {
      "id": "f01d1f70-cd41-42ec-9c0b-26dd9c22bf29",
      "title": "Process Deletion of Its Own Executable",
      "status": "test",
      "description": "Detects the deletion of a process's executable by itself. This is usually not possible without workarounds and may be used by malware to hide its traces.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "file_delete",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename": {
                "field": "TargetFilename",
                "value": "Image",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Max Altgelt (Nextron Systems)",
        "date": "2024-09-03",
        "modified": "",
        "references": [
          "https://github.com/joaoviictorti/RustRedOps/tree/ce04369a246006d399e8c61d9fe0e6b34f988a49/Self_Deletion"
        ],
        "falsepositives": [
          "Some false positives are to be expected from uninstallers."
        ],
        "source_file": "sigma_rules/windows/file/file_delete/file_delete_win_delete_own_image.yml"
      }
    },
    {
      "id": "06125661-3814-4e03-bfa2-1e4411c60ac3",
      "title": "Backup Files Deleted",
      "status": "test",
      "description": "Detects deletion of files with extensions often used for backup files. Adversaries may delete or remove built-in operating system data and turn off services designed to aid in the recovery of a corrupted system to prevent recovery.",
      "level": "medium",
      "tags": [
        "attack.impact",
        "attack.t1490"
      ],
      "logsource": {
        "category": "file_delete",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\cmd.exe",
                  "\\powershell.exe",
                  "\\pwsh.exe",
                  "\\wt.exe",
                  "\\rundll32.exe",
                  "\\regsvr32.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".VHD",
                  ".bac",
                  ".bak",
                  ".wbcat",
                  ".bkf",
                  ".set",
                  ".win",
                  ".dsk"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1490"
        ],
        "tactics": [
          "impact"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-02",
        "modified": "2023-02-15",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1490/T1490.md#atomic-test-6---windows---delete-backup-files"
        ],
        "falsepositives": [
          "Legitimate usage"
        ],
        "source_file": "sigma_rules/windows/file/file_delete/file_delete_win_delete_backup_file.yml"
      }
    },
    {
      "id": "6ddab845-b1b8-49c2-bbf7-1a11967f64bc",
      "title": "File Deleted Via Sysinternals SDelete",
      "status": "test",
      "description": "Detects the deletion of files by the Sysinternals SDelete utility. It looks for the common name pattern used to rename files.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1070.004"
      ],
      "logsource": {
        "category": "file_delete",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": [
                  ".AAA",
                  ".ZZZ"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_wireshark": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "\\Wireshark\\radius\\dictionary.alcatel-lucent.aaa",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1070.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
        "date": "2020-05-02",
        "modified": "2023-02-15",
        "references": [
          "https://github.com/OTRF/detection-hackathon-apt29/issues/9",
          "https://github.com/OTRF/ThreatHunter-Playbook/blob/2d4257f630f4c9770f78d0c1df059f891ffc3fec/docs/evals/apt29/detections/4.B.4_83D62033-105A-4A02-8B75-DAB52D8D51EC.md"
        ],
        "falsepositives": [
          "Legitimate usage"
        ],
        "source_file": "sigma_rules/windows/file/file_delete/file_delete_win_sysinternals_sdelete_file_deletion.yml"
      }
    },
    {
      "id": "b1decb61-ed83-4339-8e95-53ea51901720",
      "title": "TeamViewer Log File Deleted",
      "status": "test",
      "description": "Detects the deletion of the TeamViewer log files which may indicate an attempt to destroy forensic evidence",
      "level": "low",
      "tags": [
        "attack.defense-evasion",
        "attack.t1070.004"
      ],
      "logsource": {
        "category": "file_delete",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "\\TeamViewer_",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".log",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\system32\\svchost.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1070.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-16",
        "modified": "2023-02-15",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.004/T1070.004.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_delete/file_delete_win_delete_teamviewer_logs.yml"
      }
    },
    {
      "id": "a55349d8-9588-4c5a-8e3b-1925fe2a4ffe",
      "title": "Exchange PowerShell Cmdlet History Deleted",
      "status": "test",
      "description": "Detects the deletion of the Exchange PowerShell cmdlet History logs which may indicate an attempt to destroy forensic evidence",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1070"
      ],
      "logsource": {
        "category": "file_delete",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": "\\Logging\\CmdletInfra\\LocalPowerShell\\Cmdlet\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": "_Cmdlet_",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1070"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-10-26",
        "modified": "2022-12-30",
        "references": [
          "https://m365internals.com/2022/10/07/hunting-in-on-premises-exchange-server-logs/"
        ],
        "falsepositives": [
          "Possible FP during log rotation"
        ],
        "source_file": "sigma_rules/windows/file/file_delete/file_delete_win_delete_exchange_powershell_logs.yml"
      }
    },
    {
      "id": "0a1f9d29-6465-4776-b091-7f43b26e4c89",
      "title": "Prefetch File Deleted",
      "status": "test",
      "description": "Detects the deletion of a prefetch file which may indicate an attempt to destroy forensic evidence",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1070.004"
      ],
      "logsource": {
        "category": "file_delete",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__contains": {
                "field": "TargetFilename",
                "value": ":\\Windows\\Prefetch\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".pf",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_svchost": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": ":\\windows\\system32\\svchost.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "User__contains": {
                "field": "User",
                "value": [
                  "AUTHORI",
                  "AUTORI"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1070.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Cedric MAURUGEON",
        "date": "2021-09-29",
        "modified": "2024-01-25",
        "references": [
          "Internal Research",
          "https://www.group-ib.com/blog/hunting-for-ttps-with-prefetch-files/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_delete/file_delete_win_delete_prefetch.yml"
      }
    },
    {
      "id": "63c779ba-f638-40a0-a593-ddd45e8b1ddc",
      "title": "EventLog EVTX File Deleted",
      "status": "test",
      "description": "Detects the deletion of the event log files which may indicate an attempt to destroy forensic evidence",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1070"
      ],
      "logsource": {
        "category": "file_delete",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__startswith": {
                "field": "TargetFilename",
                "value": "C:\\Windows\\System32\\winevt\\Logs\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": ".evtx",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1070"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-02-15",
        "modified": "",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_delete/file_delete_win_delete_event_log_files.yml"
      }
    },
    {
      "id": "ff301988-c231-4bd0-834c-ac9d73b86586",
      "title": "PowerShell Console History Logs Deleted",
      "status": "test",
      "description": "Detects the deletion of the PowerShell console History logs which may indicate an attempt to destroy forensic evidence",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1070"
      ],
      "logsource": {
        "category": "file_delete",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetFilename__endswith": {
                "field": "TargetFilename",
                "value": "\\PSReadLine\\ConsoleHost_history.txt",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1070"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-02-15",
        "modified": "",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/file/file_delete/file_delete_win_delete_powershell_command_history.yml"
      }
    }
  ]
}