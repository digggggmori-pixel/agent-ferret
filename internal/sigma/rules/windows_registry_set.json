{
  "metadata": {
    "logsource": "windows_registry_set",
    "rule_count": 199,
    "compiled_at": "2026-02-04T12:28:36.535903",
    "version": "1.1"
  },
  "rules": [
    {
      "id": "3fd4c8d7-8362-4557-a8e6-83b29cc0d724",
      "title": "IE ZoneMap Setting Downgraded To MyComputer Zone For HTTP Protocols",
      "status": "test",
      "description": "Detects changes to Internet Explorer's (IE / Windows Internet properties) ZoneMap configuration of the \"HTTP\" and \"HTTPS\" protocols to point to the \"My Computer\" zone. This allows downloaded files from the Internet to be granted the same level of trust as files stored locally.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\ProtocolDefaults",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "\\http",
                  "\\https"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Details__contains": {
                "field": "Details",
                "value": "DWORD (0x00000000)",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), Michael Haag (idea)",
        "date": "2023-09-05",
        "modified": "",
        "references": [
          "https://twitter.com/M_haggis/status/1699056847154725107",
          "https://twitter.com/JAMESWT_MHT/status/1699042827261391247",
          "https://learn.microsoft.com/en-us/troubleshoot/developer/browsers/security-privacy/ie-security-zones-registry-entries",
          "https://www.virustotal.com/gui/file/339ff720c74dc44265b917b6d3e3ba0411d61f3cd3c328e9a2bae81592c8a6e5/content"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_ie_security_zone_protocol_defaults_downgrade.yml"
      }
    },
    {
      "id": "9ace0707-b560-49b8-b6ca-5148b42f39fb",
      "title": "Potential Persistence Via Logon Scripts - Registry",
      "status": "test",
      "description": "Detects creation of \"UserInitMprLogonScript\" registry value which can be used as a persistence method by malicious actors",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.t1037.001",
        "attack.persistence",
        "attack.lateral-movement"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "UserInitMprLogonScript",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1037.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Tom Ueltschi (@c_APT_ure)",
        "date": "2019-01-12",
        "modified": "2025-10-26",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1037.001/T1037.001.md"
        ],
        "falsepositives": [
          "Investigate the contents of the \"UserInitMprLogonScript\" value to determine of the added script is legitimate"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_persistence_logon_scripts_userinitmprlogonscript.yml"
      }
    },
    {
      "id": "07743f65-7ec9-404a-a519-913db7118a8d",
      "title": "COM Hijack via Sdclt",
      "status": "test",
      "description": "Detects changes to 'HKCU\\Software\\Classes\\Folder\\shell\\open\\command\\DelegateExecute'",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1546",
        "attack.t1548"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Software\\Classes\\Folder\\shell\\open\\command\\DelegateExecute",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1546",
          "T1548"
        ],
        "tactics": [
          "persistence",
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Omkar Gudhate",
        "date": "2020-09-27",
        "modified": "2023-09-28",
        "references": [
          "http://blog.sevagas.com/?Yet-another-sdclt-UAC-bypass",
          "https://www.exploit-db.com/exploits/47696"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_comhijack_sdclt.yml"
      }
    },
    {
      "id": "f37b4bce-49d0-4087-9f5b-58bffda77316",
      "title": "Potential AutoLogger Sessions Tampering",
      "status": "test",
      "description": "Detects tampering with autologger trace sessions which is a technique used by attackers to disable logging",
      "level": "high",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_main": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\System\\CurrentControlSet\\Control\\WMI\\Autologger\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_values": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\EventLog-",
                  "\\Defender"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "\\Enable",
                  "\\Start"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000000)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_wevtutil": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\system32\\wevtutil.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_defender": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\",
                  "C:\\Program Files\\Windows Defender\\",
                  "C:\\Program Files (x86)\\Windows Defender\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\MsMpEng.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\DefenderApiLogger\\",
                  "\\DefenderAuditLogger\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_main_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-01",
        "modified": "2025-10-07",
        "references": [
          "https://twitter.com/MichalKoczwara/status/1553634816016498688",
          "https://thedfirreport.com/2021/10/18/icedid-to-xinglocker-ransomware-in-24-hours/",
          "https://i.blackhat.com/EU-21/Wednesday/EU-21-Teodorescu-Veni-No-Vidi-No-Vici-Attacks-On-ETW-Blind-EDRs.pdf"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_disable_autologger_sessions.yml"
      }
    },
    {
      "id": "53330955-dc52-487f-a3a2-da24dcff99b5",
      "title": "New BgInfo.EXE Custom DB Path Registry Configuration",
      "status": "test",
      "description": "Detects setting of a new registry database value related to BgInfo configuration. Attackers can for example set this value to save the results of the commands executed by BgInfo in order to exfiltrate information.",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Software\\Winternals\\BGInfo\\Database",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-08-16",
        "modified": "",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Legitimate use of external DB to save the results"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_bginfo_custom_db.yml"
      }
    },
    {
      "id": "243380fa-11eb-4141-af92-e14925e77c1b",
      "title": "Potential PSFactoryBuffer COM Hijacking",
      "status": "test",
      "description": "Detects changes to the PSFactory COM InProcServer32 registry. This technique was used by RomCom to create persistence storing a malicious DLL.",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1546.015"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\CLSID\\{c90250f3-4d7d-4991-9b69-a5c5bc1c2ae6}\\InProcServer32\\(Default)",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": [
                  "%windir%\\System32\\ActXPrxy.dll",
                  "C:\\Windows\\System32\\ActXPrxy.dll"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter_main",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter_main"
        }
      },
      "mitre": {
        "techniques": [
          "T1546.015"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "BlackBerry Threat Research and Intelligence Team - @Joseliyo_Jstnk",
        "date": "2023-06-07",
        "modified": "2023-08-17",
        "references": [
          "https://blogs.blackberry.com/en/2023/06/romcom-resurfaces-targeting-ukraine",
          "https://strontic.github.io/xcyclopedia/library/clsid_C90250F3-4D7D-4991-9B69-A5C5BC1C2AE6.html",
          "https://www.virustotal.com/gui/file/6d3ab9e729bb03ae8ae3fcd824474c5052a165de6cb4c27334969a542c7b261d/detection",
          "https://www.trendmicro.com/en_us/research/23/e/void-rabisu-s-use-of-romcom-backdoor-shows-a-growing-shift-in-th.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_persistence_comhijack_psfactorybuffer.yml"
      }
    },
    {
      "id": "992dd79f-dde8-4bb0-9085-6350ba97cfb3",
      "title": "New BgInfo.EXE Custom VBScript Registry Configuration",
      "status": "test",
      "description": "Detects setting of a new registry value related to BgInfo configuration, which can be abused to execute custom VBScript via \"BgInfo.exe\"",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Software\\Winternals\\BGInfo\\UserFields\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__startswith": {
                "field": "Details",
                "value": "4",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-08-16",
        "modified": "",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Legitimate VBScript"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_bginfo_custom_vbscript.yml"
      }
    },
    {
      "id": "8b9606c9-28be-4a38-b146-0e313cc232c1",
      "title": "Potential Ransomware Activity Using LegalNotice Message",
      "status": "test",
      "description": "Detect changes to the \"LegalNoticeCaption\" or \"LegalNoticeText\" registry values where the message set contains keywords often used in ransomware ransom messages",
      "level": "high",
      "tags": [
        "attack.impact",
        "attack.t1491.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\LegalNoticeCaption",
                  "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\LegalNoticeText"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "Details__contains": {
                "field": "Details",
                "value": [
                  "encrypted",
                  "Unlock-Password",
                  "paying"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1491.001"
        ],
        "tactics": [
          "impact"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-12-11",
        "modified": "2023-08-17",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/5c1e6f1b4fafd01c8d1ece85f510160fc1275fbf/atomics/T1491.001/T1491.001.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_legalnotice_susp_message.yml"
      }
    },
    {
      "id": "5b16df71-8615-4f7f-ac9b-6c43c0509e61",
      "title": "Hide Schedule Task Via Index Value Tamper",
      "status": "test",
      "description": "Detects when the \"index\" value of a scheduled task is modified from the registry\nWhich effectively hides it from any tooling such as \"schtasks /query\" (Read the referenced link for more information about the effects of this technique)\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains_all": {
                "field": "TargetObject",
                "value": [
                  "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree\\",
                  "Index"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000000)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-26",
        "modified": "2023-08-17",
        "references": [
          "https://blog.qualys.com/vulnerabilities-threat-research/2022/06/20/defending-against-scheduled-task-attacks-in-windows-environments"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_hide_scheduled_task_via_index_tamper.yml"
      }
    },
    {
      "id": "46dd5308-4572-4d12-aa43-8938f0184d4f",
      "title": "Bypass UAC Using DelegateExecute",
      "status": "test",
      "description": "Bypasses User Account Control using a fileless method",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.defense-evasion",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\open\\command\\DelegateExecute",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "(Empty)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "privilege_escalation",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-05",
        "modified": "2023-08-17",
        "references": [
          "https://learn.microsoft.com/en-us/windows/win32/api/shobjidl_core/nn-shobjidl_core-iexecutecommand",
          "https://devblogs.microsoft.com/oldnewthing/20100312-01/?p=14623",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1548.002/T1548.002.md#atomic-test-7---bypass-uac-using-sdclt-delegateexecute"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_bypass_uac_using_delegateexecute.yml"
      }
    },
    {
      "id": "7d995e63-ec83-4aa3-89d5-8a17b5c87c86",
      "title": "Scripted Diagnostics Turn Off Check Enabled - Registry",
      "status": "test",
      "description": "Detects enabling TurnOffCheck which can be used to bypass defense of MSDT Follina vulnerability",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Policies\\Microsoft\\Windows\\ScriptedDiagnostics\\TurnOffCheck",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000001)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Christopher Peacock @securepeacock, SCYTHE @scythe_io",
        "date": "2022-06-15",
        "modified": "2023-08-17",
        "references": [
          "https://twitter.com/wdormann/status/1537075968568877057?s=20&t=0lr18OAnmAGoGpma6grLUw"
        ],
        "falsepositives": [
          "Administrator actions"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_enabling_turnoffcheck.yml"
      }
    },
    {
      "id": "34aa0252-6039-40ff-951f-939fd6ce47d8",
      "title": "Suspicious Keyboard Layout Load",
      "status": "test",
      "description": "Detects the keyboard preload installation with a suspicious keyboard layout, e.g. Chinese, Iranian or Vietnamese layout load in user session on systems maintained by US staff only",
      "level": "medium",
      "tags": [
        "attack.resource-development",
        "attack.t1588.002"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_registry": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Keyboard Layout\\Preload\\",
                  "\\Keyboard Layout\\Substitutes\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "Details__contains": {
                "field": "Details",
                "value": [
                  "00000429",
                  "00050429",
                  "0000042a"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_registry",
        "condition_parsed": {
          "op": "single",
          "selection": "selection_registry"
        }
      },
      "mitre": {
        "techniques": [
          "T1588.002"
        ],
        "tactics": [
          "resource_development"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2019-10-12",
        "modified": "2023-08-17",
        "references": [
          "https://renenyffenegger.ch/notes/Windows/registry/tree/HKEY_CURRENT_USER/Keyboard-Layout/Preload/index",
          "https://github.com/SwiftOnSecurity/sysmon-config/pull/92/files"
        ],
        "falsepositives": [
          "Administrators or users that actually use the selected keyboard layouts (heavily depends on the organisation's user base)"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_susp_keyboard_layout_load.yml"
      }
    },
    {
      "id": "275641a5-a492-45e2-a817-7c81e9d9d3e9",
      "title": "Add DisallowRun Execution to Registry",
      "status": "test",
      "description": "Detect set DisallowRun to 1 to prevent user running specific computer program",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\DisallowRun",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000001)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-08-19",
        "modified": "2023-08-17",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1112/T1112.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_disallowrun_execution.yml"
      }
    },
    {
      "id": "df4dc653-1029-47ba-8231-3c44238cc0ae",
      "title": "Potential Persistence Using DebugPath",
      "status": "test",
      "description": "Detects potential persistence using Appx DebugPath",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1546.015"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_debug": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "Classes\\ActivatableClasses\\Package\\Microsoft.",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\DebugPath",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_default": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Software\\Microsoft\\Windows\\CurrentVersion\\PackagedAppXDebug\\Microsoft.",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\(Default)",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1546.015"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-07-27",
        "modified": "2023-08-17",
        "references": [
          "https://oddvar.moe/2018/09/06/persistence-using-universal-windows-platform-apps-appx/",
          "https://github.com/rootm0s/WinPwnage"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_persistence_appx_debugger.yml"
      }
    },
    {
      "id": "f5fe36cf-f1ec-4c23-903d-09a3110f6bbb",
      "title": "Potential ClickFix Execution Pattern - Registry",
      "status": "experimental",
      "description": "Detects potential ClickFix malware execution patterns by monitoring registry modifications in RunMRU keys containing HTTP/HTTPS links.\nClickFix is known to be distributed through phishing campaigns and uses techniques like clipboard hijacking and fake CAPTCHA pages.\nThrough the fakecaptcha pages, the adversary tricks users into opening the Run dialog box and pasting clipboard-hijacked content,\nsuch as one-liners that execute remotely hosted malicious files or scripts.\n",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1204.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_registry": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RunMRU\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_details": {
            "type": "field_match",
            "matchers": {
              "Details__contains": {
                "field": "Details",
                "value": [
                  "http://",
                  "https://"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_susp_pattern": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Details__contains": {
                    "field": "Details",
                    "value": [
                      "account",
                      "anti-bot",
                      "botcheck",
                      "captcha",
                      "challenge",
                      "confirmation",
                      "fraud",
                      "human",
                      "identification",
                      "identificator",
                      "identity",
                      "robot",
                      "validation",
                      "verification",
                      "verify"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Details__contains": {
                    "field": "Details",
                    "value": [
                      "%comspec%",
                      "bitsadmin",
                      "certutil",
                      "cmd",
                      "cscript",
                      "curl",
                      "finger",
                      "mshta",
                      "powershell",
                      "pwsh",
                      "regsvr32",
                      "rundll32",
                      "schtasks",
                      "wget",
                      "wscript"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1204.001"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-03-25",
        "modified": "2025-11-19",
        "references": [
          "https://github.com/JohnHammond/recaptcha-phish",
          "https://www.zscaler.com/blogs/security-research/deepseek-lure-using-captchas-spread-malware",
          "https://www.threatdown.com/blog/clipboard-hijacker-tries-to-install-a-trojan/",
          "https://app.any.run/tasks/5c16b4db-4b36-4039-a0ed-9b09abff8be2",
          "https://www.esentire.com/security-advisories/netsupport-rat-clickfix-distribution",
          "https://medium.com/@boutnaru/the-windows-foreniscs-journey-run-mru-run-dialog-box-most-recently-used-57375a02d724",
          "https://unit42.paloaltonetworks.com/preventing-clickfix-attack-vector/",
          "https://medium.com/@poudelswachchhanda123/preventing-lnk-and-fakecaptcha-threats-a-system-hardening-approach-2f7b7ed2e493",
          "https://www.scpx.com.au/2025/11/16/decades-old-finger-protocol-abused-in-clickfix-malware-attacks/"
        ],
        "falsepositives": [
          "Legitimate applications using RunMRU with HTTP links"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_potential_clickfix_execution.yml"
      }
    },
    {
      "id": "33efc23c-6ea2-4503-8cfe-bdf82ce8f705",
      "title": "Potential Persistence Via New AMSI Providers - Registry",
      "status": "test",
      "description": "Detects when an attacker adds a new AMSI provider via the Windows Registry to bypass AMSI (Antimalware Scan Interface) protections.\nAttackers may add custom AMSI providers to persist on the system and evade detection by security software that relies on AMSI for scanning scripts and other content.\nThis technique is often used in conjunction with fileless malware and script-based attacks to maintain persistence while avoiding detection.\n",
      "level": "medium",
      "tags": [
        "attack.persistence"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\SOFTWARE\\Microsoft\\AMSI\\Providers\\",
                  "\\SOFTWARE\\WOW6432Node\\Microsoft\\AMSI\\Providers\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_avast": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Avast Software\\Avast\\RegSvr.exe",
                  "C:\\Program Files\\Avast Software\\Avast\\x86\\RegSvr.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\{FB904E4E-D2C7-4C8D-8492-B620BB9896B1}",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_avg": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\AVG\\Antivirus\\RegSvr.exe",
                  "C:\\Program Files\\AVG\\Antivirus\\x86\\RegSvr.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\{FB904E4E-D2C7-4C8D-8492-B620BB9896B1}",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_avira": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Program Files\\Avira\\Endpoint Protection SDK\\endpointprotection.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\{00000001-3DCC-4B48-A82E-E2071FE58E05}",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-07-21",
        "modified": "2025-10-26",
        "references": [
          "https://persistence-info.github.io/Data/amsi.html",
          "https://github.com/gtworek/PSBits/blob/8d767892f3b17eefa4d0668f5d2df78e844f01d8/FakeAMSI/FakeAMSI.c"
        ],
        "falsepositives": [
          "Legitimate security products adding their own AMSI providers. Filter these according to your environment."
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_persistence_amsi_providers.yml"
      }
    },
    {
      "id": "6b6976a3-b0e6-4723-ac24-ae38a737af41",
      "title": "Potential Persistence Via Shim Database In Uncommon Location",
      "status": "test",
      "description": "Detects the installation of a new shim database where the file is located in a non-default location",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1546.011"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains_all": {
                "field": "TargetObject",
                "value": [
                  "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\InstalledSDB\\",
                  "\\DatabasePath"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_known_locations": {
            "type": "field_match",
            "matchers": {
              "Details__contains": {
                "field": "Details",
                "value": ":\\Windows\\AppPatch\\Custom",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1546.011"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-08-01",
        "modified": "2023-08-17",
        "references": [
          "https://www.fireeye.com/blog/threat-research/2017/05/fin7-shim-databases-persistence.html",
          "https://andreafortuna.org/2018/11/12/process-injection-and-persistence-using-application-shimming/",
          "https://www.blackhat.com/docs/asia-14/materials/Erickson/Asia-14-Erickson-Persist-It-Using-And-Abusing-Microsofts-Fix-It-Patches.pdf"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_persistence_shim_database_uncommon_location.yml"
      }
    },
    {
      "id": "555155a2-03bf-4fe7-af74-d176b3fdbe16",
      "title": "Driver Added To Disallowed Images In HVCI - Registry",
      "status": "test",
      "description": "Detects changes to the \"HVCIDisallowedImages\" registry value to potentially add a driver to the list, in order to prevent it from loading.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains_all": {
                "field": "TargetObject",
                "value": [
                  "\\Control\\CI\\",
                  "\\HVCIDisallowedImages"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), Omar Khaled (@beacon_exe)",
        "date": "2023-12-05",
        "modified": "2024-08-21",
        "references": [
          "https://github.com/yardenshafir/conference_talks/blob/3de1f5d7c02656c35117f067fbff0a219c304b09/OffensiveCon_2023_Your_Mitigations_are_My_Opportunities.pdf",
          "https://x.com/yarden_shafir/status/1822667605175324787"
        ],
        "falsepositives": [
          "Legitimate usage of this key would also trigger this. Investigate the driver being added and make sure its intended"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_hvci_disallowed_images.yml"
      }
    },
    {
      "id": "e3fdf743-f05b-4051-990a-b66919be1743",
      "title": "Change User Account Associated with the FAX Service",
      "status": "test",
      "description": "Detect change of the user account associated with the FAX service to avoid the escalation problem.",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject": {
                "field": "TargetObject",
                "value": "HKLM\\System\\CurrentControlSet\\Services\\Fax\\ObjectName",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Details__contains": {
                "field": "Details",
                "value": "NetworkService",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-07-17",
        "modified": "2022-12-30",
        "references": [
          "https://twitter.com/dottor_morte/status/1544652325570191361",
          "https://raw.githubusercontent.com/RiccardoAncarani/talks/master/F-Secure/unorthodox-lateral-movement.pdf"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_fax_change_service_user.yml"
      }
    },
    {
      "id": "8f2a5c3d-9e4b-4a7c-8d1f-2e5a6b9c3d7e",
      "title": "Suspicious Space Characters in TypedPaths Registry Path - FileFix",
      "status": "experimental",
      "description": "Detects the occurrence of numerous space characters in TypedPaths registry paths, which may indicate execution via phishing lures using file-fix techniques to hide malicious commands.\n",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1204.004",
        "attack.defense-evasion",
        "attack.t1027.010"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_key": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\TypedPaths\\url1",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__contains": {
                "field": "Details",
                "value": "#",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_space_variation": {
            "type": "field_match",
            "matchers": {
              "Details__contains": {
                "field": "Details",
                "value": [
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "            "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1204.004",
          "T1027.010"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-11-04",
        "modified": "",
        "references": [
          "https://expel.com/blog/cache-smuggling-when-a-picture-isnt-a-thousand-words/",
          "https://mrd0x.com/filefix-clickfix-alternative/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_susp_typedpaths_space_characters.yml"
      }
    },
    {
      "id": "6763c6c8-bd01-4687-bc8d-4fa52cf8ba08",
      "title": "Outlook EnableUnsafeClientMailRules Setting Enabled - Registry",
      "status": "test",
      "description": "Detects an attacker trying to enable the outlook security setting \"EnableUnsafeClientMailRules\" which allows outlook to run applications or execute macros",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Outlook\\Security\\EnableUnsafeClientMailRules",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000001)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-02-08",
        "modified": "2023-08-17",
        "references": [
          "https://support.microsoft.com/en-us/topic/how-to-control-the-rule-actions-to-start-an-application-or-run-a-macro-in-outlook-2016-and-outlook-2013-e4964b72-173c-959d-5d7b-ead562979048",
          "https://speakerdeck.com/heirhabarov/hunting-for-persistence-via-microsoft-exchange-server-or-outlook?slide=44"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_office_outlook_enable_unsafe_client_mail_rules.yml"
      }
    },
    {
      "id": "966315ef-c5e1-4767-ba25-fce9c8de3660",
      "title": "Suspicious Environment Variable Has Been Registered",
      "status": "test",
      "description": "Detects the creation of user-specific or system-wide environment variables via the registry. Which contains suspicious commands and strings",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.persistence"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_main": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Environment\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_details": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Details": {
                    "field": "Details",
                    "value": [
                      "powershell",
                      "pwsh"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Details__contains": {
                    "field": "Details",
                    "value": [
                      "\\AppData\\Local\\Temp\\",
                      "C:\\Users\\Public\\",
                      "TVqQAAMAAAAEAAAA",
                      "TVpQAAIAAAAEAA8A",
                      "TVqAAAEAAAAEABAA",
                      "TVoAAAAAAAAAAAAA",
                      "TVpTAQEAAAAEAAAA",
                      "SW52b2tlL",
                      "ludm9rZS",
                      "JbnZva2Ut",
                      "SQBuAHYAbwBrAGUALQ",
                      "kAbgB2AG8AawBlAC0A",
                      "JAG4AdgBvAGsAZQAtA"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Details__startswith": {
                    "field": "Details",
                    "value": [
                      "SUVY",
                      "SQBFAF",
                      "SQBuAH",
                      "cwBhA",
                      "aWV4",
                      "aQBlA",
                      "R2V0",
                      "dmFy",
                      "dgBhA",
                      "dXNpbm",
                      "H4sIA",
                      "Y21k",
                      "cABhAH",
                      "Qzpc",
                      "Yzpc"
                    ],
                    "modifiers": [
                      "startswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion",
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-12-20",
        "modified": "2023-08-17",
        "references": [
          "https://infosec.exchange/@sbousseaden/109542254124022664"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_suspicious_env_variables.yml"
      }
    },
    {
      "id": "046218bd-e0d8-4113-a3c3-895a12b2b298",
      "title": "Session Manager Autorun Keys Modification",
      "status": "test",
      "description": "Detects modification of autostart extensibility point (ASEP) in registry.",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547.001",
        "attack.t1546.009"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "session_manager_base": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\System\\CurrentControlSet\\Control\\Session Manager",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "session_manager": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\SetupExecute",
                  "\\S0InitialCommand",
                  "\\KnownDlls",
                  "\\Execute",
                  "\\BootExecute",
                  "\\AppCertDlls"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": "(Empty)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "session_manager_base and session_manager and not filter",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "session_manager_base"
            },
            {
              "type": "ref",
              "value": "session_manager"
            },
            {
              "type": "not",
              "value": "filter"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1547.001",
          "T1546.009"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split)",
        "date": "2019-10-25",
        "modified": "2023-08-17",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md",
          "https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns",
          "https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d"
        ],
        "falsepositives": [
          "Legitimate software automatically (mostly, during installation) sets up autorun keys for legitimate reason",
          "Legitimate administrator sets up autorun keys for legitimate reason"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_session_manager.yml"
      }
    },
    {
      "id": "17e53739-a1fc-4a62-b1b9-87711c2d5e44",
      "title": "Python Function Execution Security Warning Disabled In Excel - Registry",
      "status": "test",
      "description": "Detects changes to the registry value \"PythonFunctionWarnings\" that would prevent any warnings or alerts from showing when Python functions are about to be executed.\nThreat actors could run malicious code through the new Microsoft Excel feature that allows Python to run within the spreadsheet.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Microsoft\\Office\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Excel\\Security\\PythonFunctionWarnings",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000001)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), @Kostastsale",
        "date": "2024-08-23",
        "modified": "",
        "references": [
          "https://support.microsoft.com/en-us/office/data-security-and-python-in-excel-33cc88a4-4a87-485e-9ff9-f35958278327"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_office_disable_python_security_warnings.yml"
      }
    },
    {
      "id": "d6a9b252-c666-4de6-8806-5561bbbd3bdc",
      "title": "Wdigest Enable UseLogonCredential",
      "status": "test",
      "description": "Detects potential malicious modification of the property value of UseLogonCredential from HKLM:\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest to enable clear-text credentials",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "WDigest\\UseLogonCredential",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000001)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
        "date": "2019-09-12",
        "modified": "2023-08-17",
        "references": [
          "https://threathunterplaybook.com/hunts/windows/190510-RegModWDigestDowngrade/notebook.html",
          "https://support.microsoft.com/en-us/topic/microsoft-security-advisory-update-to-improve-credentials-protection-and-management-may-13-2014-93434251-04ac-b7f3-52aa-9f951c14b649",
          "https://github.com/redcanaryco/atomic-red-team/blob/73fcfa1d4863f6a4e17f90e54401de6e30a312bb/atomics/T1112/T1112.md#atomic-test-3---modify-registry-to-store-logon-credentials"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_wdigest_enable_uselogoncredential.yml"
      }
    },
    {
      "id": "e1aa95de-610a-427d-b9e7-9b46cfafbe6a",
      "title": "Windows Defender Service Disabled - Registry",
      "status": "test",
      "description": "Detects when an attacker or tool disables the  Windows Defender service (WinDefend) via the registry",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Services\\WinDefend\\Start",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000004)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Jn Trenansk, frack113, AlertIQ, Nasreddine Bencherchali",
        "date": "2022-08-01",
        "modified": "2024-03-25",
        "references": [
          "https://thedfirreport.com/2021/10/18/icedid-to-xinglocker-ransomware-in-24-hours/",
          "https://gist.github.com/anadr/7465a9fde63d41341136949f14c21105"
        ],
        "falsepositives": [
          "Administrator actions"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_disable_windows_defender_service.yml"
      }
    },
    {
      "id": "90f342e1-1aaa-4e43-b092-39fda57ed11e",
      "title": "ETW Logging Disabled For rpcrt4.dll",
      "status": "test",
      "description": "Detects changes to the \"ExtErrorInformation\" key in order to disable ETW logging for rpcrt4.dll",
      "level": "low",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112",
        "attack.t1562"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Microsoft\\Windows NT\\Rpc\\ExtErrorInformation",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": [
                  "DWORD (0x00000000)",
                  "DWORD (0x00000002)"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1112",
          "T1562"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-12-09",
        "modified": "2023-08-17",
        "references": [
          "http://redplait.blogspot.com/2020/07/whats-wrong-with-etw.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_rpcrt4_etw_tamper.yml"
      }
    },
    {
      "id": "674202d0-b22a-4af4-ae5f-2eda1f3da1af",
      "title": "Bypass UAC Using Event Viewer",
      "status": "test",
      "description": "Bypasses User Account Control using Event Viewer and a relevant Windows Registry modification",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547.010"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "_Classes\\mscfile\\shell\\open\\command\\(Default)",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Details__startswith": {
                "field": "Details",
                "value": "%SystemRoot%\\system32\\mmc.exe \"%1\" %",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1547.010"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-05",
        "modified": "2023-08-17",
        "references": [
          "https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1548.002/T1548.002.md#atomic-test-1---bypass-uac-using-event-viewer-cmd"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_bypass_uac_using_eventviewer.yml"
      }
    },
    {
      "id": "9d8f9bb8-01af-4e15-a3a2-349071530530",
      "title": "Suspicious Path In Keyboard Layout IME File Registry Value",
      "status": "test",
      "description": "Detects usage of Windows Input Method Editor (IME) keyboard layout feature, which allows an attacker to load a DLL into the process after sending the WM_INPUTLANGCHANGEREQUEST message.\nBefore doing this, the client needs to register the DLL in a special registry key that is assumed to implement this keyboard layout. This registry key should store a value named \"Ime File\" with a DLL path.\nIMEs are essential for languages that have more characters than can be represented on a standard keyboard, such as Chinese, Japanese, and Korean.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_registry": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains_all": {
                "field": "TargetObject",
                "value": [
                  "\\Control\\Keyboard Layouts\\",
                  "Ime File"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_folders_1": {
            "type": "field_match",
            "matchers": {
              "Details__contains": {
                "field": "Details",
                "value": [
                  ":\\Perflogs\\",
                  ":\\Users\\Public\\",
                  ":\\Windows\\Temp\\",
                  "\\AppData\\Local\\Temp\\",
                  "\\AppData\\Roaming\\",
                  "\\Temporary Internet"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_folders_2": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Details__contains_all": {
                    "field": "Details",
                    "value": [
                      ":\\Users\\",
                      "\\Favorites\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Details__contains_all": {
                    "field": "Details",
                    "value": [
                      ":\\Users\\",
                      "\\Favourites\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Details__contains_all": {
                    "field": "Details",
                    "value": [
                      ":\\Users\\",
                      "\\Contacts\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection_registry and 1 of selection_folders_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_registry"
            },
            {
              "type": "ref",
              "value": "1 of selection_folders_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "X__Junior (Nextron Systems)",
        "date": "2023-11-21",
        "modified": "",
        "references": [
          "https://www.linkedin.com/pulse/guntior-story-advanced-bootkit-doesnt-rely-windows-disk-baranov-wue8e/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_ime_suspicious_paths.yml"
      }
    },
    {
      "id": "0c93308a-3f1b-40a9-b649-57ea1a1c1d63",
      "title": "Activate Suppression of Windows Security Center Notifications",
      "status": "test",
      "description": "Detect set Notification_Suppress to 1 to disable the Windows security center notification",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "SOFTWARE\\Policies\\Microsoft\\Windows Defender\\UX Configuration\\Notification_Suppress",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000001)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-08-19",
        "modified": "2023-08-17",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1112/T1112.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_suppress_defender_notifications.yml"
      }
    },
    {
      "id": "fa277e82-9b78-42dd-b05c-05555c7b6015",
      "title": "Enable Local Manifest Installation With Winget",
      "status": "test",
      "description": "Detects changes to the AppInstaller (winget) policy. Specifically the activation of the local manifest installation, which allows a user to install new packages via custom manifests.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.persistence"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\AppInstaller\\EnableLocalManifestFiles",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000001)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion",
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-04-17",
        "modified": "2023-08-17",
        "references": [
          "https://github.com/nasbench/Misc-Research/tree/b9596e8109dcdb16ec353f316678927e507a5b8d/LOLBINs/Winget"
        ],
        "falsepositives": [
          "Administrators or developers might enable this for testing purposes or to install custom private packages"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_winget_enable_local_manifest.yml"
      }
    },
    {
      "id": "31e124fb-5dc4-42a0-83b3-44a69c77b271",
      "title": "Antivirus Filter Driver Disallowed On Dev Drive - Registry",
      "status": "test",
      "description": "Detects activity that indicates a user disabling the ability for Antivirus mini filter to inspect a \"Dev Drive\".\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\FilterManager\\FltmgrDevDriveAllowAntivirusFilter",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000000)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "@kostastsale, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-11-05",
        "modified": "2024-08-16",
        "references": [
          "https://twitter.com/0gtweet/status/1720419490519752955"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_devdrv_disallow_antivirus_filter.yml"
      }
    },
    {
      "id": "a9b6c011-ab69-4ddb-bc0a-c4f21c80ec47",
      "title": "Potential Attachment Manager Settings Associations Tamper",
      "status": "test",
      "description": "Detects tampering with attachment manager settings policies associations to lower the default file type risks (See reference for more information)",
      "level": "high",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_main": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Associations\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_value_default_file_type_rsik": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\DefaultFileTypeRisk",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00006152)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_value_low_risk_filetypes": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\LowRiskFileTypes",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__contains": {
                "field": "Details",
                "value": [
                  ".zip;",
                  ".rar;",
                  ".exe;",
                  ".bat;",
                  ".com;",
                  ".cmd;",
                  ".reg;",
                  ".msi;",
                  ".htm;",
                  ".html;"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_main and 1 of selection_value_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_main"
            },
            {
              "type": "ref",
              "value": "1 of selection_value_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-01",
        "modified": "2023-08-17",
        "references": [
          "https://support.microsoft.com/en-us/topic/information-about-the-attachment-manager-in-microsoft-windows-c48a4dcd-8de5-2af5-ee9b-cd795ae42738",
          "https://www.virustotal.com/gui/file/2bcd5702a7565952c44075ac6fb946c7780526640d1264f692c7664c02c68465"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_policies_associations_tamper.yml"
      }
    },
    {
      "id": "5a93eb65-dffa-4543-b761-94aa60098fb6",
      "title": "Registry Hide Function from User",
      "status": "test",
      "description": "Detects registry modifications that hide internal tools or functions from the user (malware like Agent Tesla, Hermetic Wiper uses this technique)",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_set_1": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\HideClock",
                  "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\HideSCAHealth",
                  "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\HideSCANetwork",
                  "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\HideSCAPower",
                  "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\HideSCAVolume"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000001)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_set_0": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\ShowInfoTip",
                  "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\ShowCompColor"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000000)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_set_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_set_"
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-03-18",
        "modified": "2023-08-17",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1564.001/T1564.001.md"
        ],
        "falsepositives": [
          "Legitimate admin script"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_hide_function_user.yml"
      }
    },
    {
      "id": "790317c0-0a36-4a6a-a105-6e576bf99a14",
      "title": "COM Object Hijacking Via Modification Of Default System CLSID Default Value",
      "status": "experimental",
      "description": "Detects potential COM object hijacking via modification of default system CLSID.",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1546.015"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_target_root": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\CLSID\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "\\InprocServer32\\(Default)",
                  "\\LocalServer32\\(Default)"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_target_builtin_clsid": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\{1f486a52-3cb1-48fd-8f50-b8dc300d9f9d}\\",
                  "\\{2155fee3-2419-4373-b102-6843707eb41f}\\",
                  "\\{4590f811-1d3a-11d0-891f-00aa004b2e24}\\",
                  "\\{4de225bf-cf59-4cfc-85f7-68b90f185355}\\",
                  "\\{ddc05a5a-351a-4e06-8eaf-54ec1bc2dcea}\\",
                  "\\{F56F6FDD-AA9D-4618-A949-C1B91AF43B1A}\\",
                  "\\{F82B4EF1-93A9-4DDE-8015-F7950A1A6E31}\\",
                  "\\{7849596a-48ea-486e-8937-a2a3009f31a9}\\",
                  "\\{0b91a74b-ad7c-4a9d-b563-29eef9167172}\\",
                  "\\{603D3801-BD81-11d0-A3A5-00C04FD706EC}\\",
                  "\\{30D49246-D217-465F-B00B-AC9DDD652EB7}\\",
                  "\\{A7A63E5C-3877-4840-8727-C1EA9D7A4D50}\\",
                  "\\{2227A280-3AEA-1069-A2DE-08002B30309D}\\",
                  "\\{2DEA658F-54C1-4227-AF9B-260AB5FC3543}\\",
                  "\\{AA509086-5Ca9-4C25-8F95-589D3C07B48A}\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_susp_location_1": {
            "type": "field_match",
            "matchers": {
              "Details__contains": {
                "field": "Details",
                "value": [
                  ":\\Perflogs\\",
                  "\\AppData\\Local\\",
                  "\\Desktop\\",
                  "\\Downloads\\",
                  "\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\",
                  "\\System32\\spool\\drivers\\color\\",
                  "\\Temporary Internet",
                  "\\Users\\Public\\",
                  "\\Windows\\Temp\\",
                  "%appdata%",
                  "%temp%",
                  "%tmp%"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_susp_location_2": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Details__contains_all": {
                    "field": "Details",
                    "value": [
                      ":\\Users\\",
                      "\\Favorites\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Details__contains_all": {
                    "field": "Details",
                    "value": [
                      ":\\Users\\",
                      "\\Favourites\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Details__contains_all": {
                    "field": "Details",
                    "value": [
                      ":\\Users\\",
                      "\\Contacts\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Details__contains_all": {
                    "field": "Details",
                    "value": [
                      ":\\Users\\",
                      "\\Pictures\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_target_* and 1 of selection_susp_location_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "all of selection_target_*"
            },
            {
              "type": "ref",
              "value": "1 of selection_susp_location_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1546.015"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2024-07-16",
        "modified": "2025-11-10",
        "references": [
          "https://www.microsoft.com/security/blog/2022/07/27/untangling-knotweed-european-private-sector-offensive-actor-using-0-day-exploits/ (idea)",
          "https://unit42.paloaltonetworks.com/snipbot-romcom-malware-variant/",
          "https://blog.talosintelligence.com/uat-5647-romcom/",
          "https://global.ptsecurity.com/analytics/pt-esc-threat-intelligence/darkhotel-a-cluster-of-groups-united-by-common-techniques",
          "https://threatbook.io/blog/Analysis-of-APT-C-60-Attack-on-South-Korea",
          "https://catalyst.prodaft.com/public/report/inside-the-latest-espionage-campaign-of-nebulous-mantis",
          "https://github.com/rtecCyberSec/BitlockMove",
          "https://cert.gov.ua/article/6284080",
          "https://securelist.com/forumtroll-apt-hacking-team-dante-spyware/117851/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_persistence_com_hijacking_builtin.yml"
      }
    },
    {
      "id": "b86852fb-4c77-48f9-8519-eb1b2c308b59",
      "title": "Potential Persistence Via AppCompat RegisterAppRestart Layer",
      "status": "test",
      "description": "Detects the setting of the REGISTERAPPRESTART compatibility layer on an application.\nThis compatibility layer allows an application to register for restart using the \"RegisterApplicationRestart\" API.\nThis can be potentially abused as a persistence mechanism.\n",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1546.011"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Layers\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__contains": {
                "field": "Details",
                "value": "REGISTERAPPRESTART",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1546.011"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2024-01-01",
        "modified": "",
        "references": [
          "https://github.com/nasbench/Misc-Research/blob/d114d6a5e0a437d3818e492ef9864367152543e7/Other/Persistence-Via-RegisterAppRestart-Shim.md"
        ],
        "falsepositives": [
          "Legitimate applications making use of this feature for compatibility reasons"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_persistence_app_cpmpat_layer_registerapprestart.yml"
      }
    },
    {
      "id": "c7dcacd0-cc59-4004-b0a4-1d6cdebe6f3e",
      "title": "Disable Administrative Share Creation at Startup",
      "status": "test",
      "description": "Administrative shares are hidden network shares created by Microsoft Windows NT operating systems that grant system administrators remote access to every disk volume on a network-connected system",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1070.005"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Services\\LanmanServer\\Parameters\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "\\AutoShareWks",
                  "\\AutoShareServer"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000000)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1070.005"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-16",
        "modified": "2024-03-25",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.005/T1070.005.md#atomic-test-4---disable-administrative-share-creation-at-startup"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_disable_administrative_share.yml"
      }
    },
    {
      "id": "5de03871-5d46-4539-a82d-3aa992a69a83",
      "title": "Registry Disable System Restore",
      "status": "test",
      "description": "Detects the modification of the registry to disable a system restore on the computer",
      "level": "high",
      "tags": [
        "attack.impact",
        "attack.t1490"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Policies\\Microsoft\\Windows NT\\SystemRestore",
                  "\\Microsoft\\Windows NT\\CurrentVersion\\SystemRestore"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "DisableConfig",
                  "DisableSR"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000001)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1490"
        ],
        "tactics": [
          "impact"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-04-04",
        "modified": "2023-08-17",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1490/T1490.md#atomic-test-9---disable-system-restore-through-registry"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_disable_system_restore.yml"
      }
    },
    {
      "id": "8b7273a4-ba5d-4d8a-b04f-11f2900d043a",
      "title": "Hypervisor Enforced Code Integrity Disabled",
      "status": "test",
      "description": "Detects changes to the HypervisorEnforcedCodeIntegrity registry key and the \"Enabled\" value being set to 0 in order to disable the Hypervisor Enforced Code Integrity feature. This allows an attacker to load unsigned and untrusted code to be run in the kernel\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "\\Control\\DeviceGuard\\HypervisorEnforcedCodeIntegrity",
                  "\\Control\\DeviceGuard\\Scenarios\\HypervisorEnforcedCodeIntegrity\\Enabled",
                  "\\Microsoft\\Windows\\DeviceGuard\\HypervisorEnforcedCodeIntegrity"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000000)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), Anish Bogati",
        "date": "2023-03-14",
        "modified": "2024-07-05",
        "references": [
          "https://www.welivesecurity.com/2023/03/01/blacklotus-uefi-bootkit-myth-confirmed/",
          "https://github.com/redcanaryco/atomic-red-team/blob/04e487c1828d76df3e834621f4f893ea756d5232/atomics/T1562.001/T1562.001.md#atomic-test-43---disable-hypervisor-enforced-code-integrity-hvci"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_deviceguard_hypervisorenforcedcodeintegrity_disabled.yml"
      }
    },
    {
      "id": "cd277474-5c52-4423-a52b-ac2d7969902f",
      "title": "New BgInfo.EXE Custom WMI Query Registry Configuration",
      "status": "test",
      "description": "Detects setting of a new registry value related to BgInfo configuration, which can be abused to execute custom WMI query via \"BgInfo.exe\"",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Software\\Winternals\\BGInfo\\UserFields\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__startswith": {
                "field": "Details",
                "value": "6",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-08-16",
        "modified": "",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Legitimate WMI query"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_bginfo_custom_wmi_query.yml"
      }
    },
    {
      "id": "a80f662f-022f-4429-9b8c-b1a41aaa6688",
      "title": "Internet Explorer Autorun Keys Modification",
      "status": "test",
      "description": "Detects modification of autostart extensibility point (ASEP) in registry.",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "ie": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Software\\Wow6432Node\\Microsoft\\Internet Explorer",
                  "\\Software\\Microsoft\\Internet Explorer"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "ie_details": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Toolbar",
                  "\\Extensions",
                  "\\Explorer Bars"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_empty": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": "(Empty)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_extensions": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Extensions\\{2670000A-7350-4f3c-8081-5663EE0C6C49}",
                  "\\Extensions\\{31D09BA0-12F5-4CCE-BE8A-2923E76605DA}",
                  "\\Extensions\\{789FE86F-6FC4-46A1-9849-EDE0DB0C95CA}",
                  "\\Extensions\\{A95fe080-8f5d-11d2-a20b-00aa003c157a}"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_toolbar": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "\\Toolbar\\ShellBrowser\\ITBar7Layout",
                  "\\Toolbar\\ShowDiscussionButton",
                  "\\Toolbar\\Locked"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "ie and ie_details and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "ie"
            },
            {
              "type": "ref",
              "value": "ie_details"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1547.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split)",
        "date": "2019-10-25",
        "modified": "2023-08-17",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md",
          "https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns",
          "https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d"
        ],
        "falsepositives": [
          "Legitimate software automatically (mostly, during installation) sets up autorun keys for legitimate reason",
          "Legitimate administrator sets up autorun keys for legitimate reason"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_internet_explorer.yml"
      }
    },
    {
      "id": "487bb375-12ef-41f6-baae-c6a1572b4dd1",
      "title": "Potential Persistence Via Outlook Today Page",
      "status": "test",
      "description": "Detects potential persistence activity via outlook today page.\nAn attacker can set a custom page to execute arbitrary code and link to it via the registry values \"URL\" and \"UserDefinedUrl\".\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.persistence",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_main": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains_all": {
                "field": "TargetObject",
                "value": [
                  "Software\\Microsoft\\Office\\",
                  "\\Outlook\\Today\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_value_stamp": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Stamp",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000001)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_value_url": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "\\URL",
                  "\\UserDefinedUrl"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_office": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\",
                  "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\Updates\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\OfficeClickToRun.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection_main and 1 of selection_value_* and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_main"
            },
            {
              "type": "ref",
              "value": "1 of selection_value_*"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "defense_evasion",
          "persistence"
        ]
      },
      "meta": {
        "author": "Tobias Michalski (Nextron Systems), David Bertho (@dbertho) & Eirik Sveen (@0xSV1), Storebrand",
        "date": "2021-06-10",
        "modified": "2024-08-07",
        "references": [
          "https://speakerdeck.com/heirhabarov/hunting-for-persistence-via-microsoft-exchange-server-or-outlook?slide=74",
          "https://trustedsec.com/blog/specula-turning-outlook-into-a-c2-with-one-registry-change"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_persistence_outlook_todaypage.yml"
      }
    },
    {
      "id": "f674e36a-4b91-431e-8aef-f8a96c2aca35",
      "title": "CurrentControlSet Autorun Keys Modification",
      "status": "test",
      "description": "Detects modification of autostart extensibility point (ASEP) in registry.",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "system_control_base": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\SYSTEM\\CurrentControlSet\\Control",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "system_control_keys": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Terminal Server\\WinStations\\RDP-Tcp\\InitialProgram",
                  "\\Terminal Server\\Wds\\rdpwd\\StartupPrograms",
                  "\\SecurityProviders\\SecurityProviders",
                  "\\SafeBoot\\AlternateShell",
                  "\\Print\\Providers",
                  "\\Print\\Monitors",
                  "\\NetworkProvider\\Order",
                  "\\Lsa\\Notification Packages",
                  "\\Lsa\\Authentication Packages",
                  "\\BootVerificationProgram\\ImagePath"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_empty": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": "(Empty)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_cutepdf": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\System32\\spoolsv.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Print\\Monitors\\CutePDF Writer Monitor",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": [
                  "cpwmon64_v40.dll",
                  "CutePDF Writer"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_onenote": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\System32\\spoolsv.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "Print\\Monitors\\Appmon\\Ports\\Microsoft.Office.OneNote_",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "User__contains": {
                "field": "User",
                "value": [
                  "AUTHORI",
                  "AUTORI"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_poqexec": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\System32\\poqexec.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\NetworkProvider\\Order\\ProviderOrder",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_realvnc": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\System32\\spoolsv.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Print\\Monitors\\MONVNC\\Driver",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "VNCpm.dll",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of system_control_* and not 1 of filter_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "system_control_",
          "none_of": "filter_"
        }
      },
      "mitre": {
        "techniques": [
          "T1547.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split)",
        "date": "2019-10-25",
        "modified": "2023-08-17",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md",
          "https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns",
          "https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d"
        ],
        "falsepositives": [
          "Legitimate software automatically (mostly, during installation) sets up autorun keys for legitimate reason",
          "Legitimate administrator sets up autorun keys for legitimate reason"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_currentcontrolset.yml"
      }
    },
    {
      "id": "c90362e0-2df3-4e61-94fe-b37615814cb1",
      "title": "Potential Persistence Via Netsh Helper DLL - Registry",
      "status": "test",
      "description": "Detects changes to the Netsh registry key to add a new DLL value. This change might be an indication of a potential persistence attempt by adding a malicious Netsh helper\n",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1546.007"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\Microsoft\\NetSh",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__contains": {
                "field": "Details",
                "value": ".dll",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_poqexec": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\System32\\poqexec.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": [
                  "ipmontr.dll",
                  "iasmontr.dll",
                  "ippromon.dll"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1546.007"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Anish Bogati",
        "date": "2023-11-28",
        "modified": "2025-10-08",
        "references": [
          "https://www.ired.team/offensive-security/persistence/t1128-netsh-helper-dll",
          "https://pentestlab.blog/2019/10/29/persistence-netsh-helper-dll/"
        ],
        "falsepositives": [
          "Legitimate helper added by different programs and the OS"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_netsh_helper_dll_potential_persistence.yml"
      }
    },
    {
      "id": "0e6a9e62-627e-496c-aef5-bfa39da29b5e",
      "title": "MaxMpxCt Registry Value Changed",
      "status": "test",
      "description": "Detects changes to the \"MaxMpxCt\" registry value.\nMaxMpxCt specifies the maximum outstanding network requests for the server per client, which is used when negotiating a Server Message Block (SMB) connection with a client. Note if the value is set beyond 125 older Windows 9x clients will fail to negotiate.\nRansomware threat actors and operators (specifically BlackCat) were seen increasing this value in order to handle a higher volume of traffic.\n",
      "level": "low",
      "tags": [
        "attack.defense-evasion",
        "attack.t1070.005"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Services\\LanmanServer\\Parameters\\MaxMpxCt",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1070.005"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2024-03-19",
        "modified": "",
        "references": [
          "https://www.huntress.com/blog/blackcat-ransomware-affiliate-ttps",
          "https://securityscorecard.com/research/deep-dive-into-alphv-blackcat-ransomware",
          "https://www.intrinsec.com/alphv-ransomware-gang-analysis/?cn-reloaded=1",
          "https://www.sentinelone.com/labs/blackcat-ransomware-highly-configurable-rust-driven-raas-on-the-prowl-for-victims/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_optimize_file_sharing_network.yml"
      }
    },
    {
      "id": "bf4fc428-dcc3-4bbd-99fe-2422aeee2544",
      "title": "ETW Logging Disabled In .NET Processes - Sysmon Registry",
      "status": "test",
      "description": "Potential adversaries stopping ETW providers recording loaded .NET assemblies.",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112",
        "attack.t1562"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_etw_enabled": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "SOFTWARE\\Microsoft\\.NETFramework\\ETWEnabled",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000000)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_complus": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "\\COMPlus_ETWEnabled",
                  "\\COMPlus_ETWFlags"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": [
                  0,
                  "DWORD (0x00000000)"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1112",
          "T1562"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
        "date": "2020-06-05",
        "modified": "2023-08-17",
        "references": [
          "https://twitter.com/_xpn_/status/1268712093928378368",
          "https://social.msdn.microsoft.com/Forums/vstudio/en-US/0878832e-39d7-4eaf-8e16-a729c4c40975/what-can-i-use-e13c0d23ccbc4e12931bd9cc2eee27e4-for?forum=clr",
          "https://github.com/dotnet/runtime/blob/ee2355c801d892f2894b0f7b14a20e6cc50e0e54/docs/design/coreclr/jit/viewing-jit-dumps.md#setting-configuration-variables",
          "https://github.com/dotnet/runtime/blob/f62e93416a1799aecc6b0947adad55a0d9870732/src/coreclr/src/inc/clrconfigvalues.h#L35-L38",
          "https://github.com/dotnet/runtime/blob/7abe42dc1123722ed385218268bb9fe04556e3d3/src/coreclr/src/inc/clrconfig.h#L33-L39",
          "https://github.com/dotnet/runtime/search?p=1&q=COMPlus_&unscoped_q=COMPlus_",
          "https://bunnyinside.com/?term=f71e8cb9c76a",
          "http://managed670.rssing.com/chan-5590147/all_p1.html",
          "https://github.com/dotnet/runtime/blob/4f9ae42d861fcb4be2fcd5d3d55d5f227d30e723/docs/coding-guidelines/clr-jit-coding-conventions.md#1412-disabling-code",
          "https://blog.xpnsec.com/hiding-your-dotnet-complus-etwenabled/",
          "https://i.blackhat.com/EU-21/Wednesday/EU-21-Teodorescu-Veni-No-Vidi-No-Vici-Attacks-On-ETW-Blind-EDRs.pdf"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_dot_net_etw_tamper.yml"
      }
    },
    {
      "id": "7c81fec3-1c1d-43b0-996a-46753041b1b6",
      "title": "UAC Bypass via Event Viewer",
      "status": "test",
      "description": "Detects UAC bypass method using Windows event viewer",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548.002",
        "car.2019-04-001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\mscfile\\shell\\open\\command",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2017-03-19",
        "modified": "2023-09-28",
        "references": [
          "https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/",
          "https://www.hybrid-analysis.com/sample/e122bc8bf291f15cab182a5d2d27b8db1e7019e4e96bb5cdbd1dfe7446f3f51f?environmentId=100"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_uac_bypass_eventvwr.yml"
      }
    },
    {
      "id": "a166f74e-bf44-409d-b9ba-ea4b2dd8b3cd",
      "title": "Macro Enabled In A Potentially Suspicious Document",
      "status": "test",
      "description": "Detects registry changes to Office trust records where the path is located in a potentially suspicious location",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_value": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Security\\Trusted Documents\\TrustRecords",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_paths": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "/AppData/Local/Microsoft/Windows/INetCache/",
                  "/AppData/Local/Temp/",
                  "/PerfLogs/",
                  "C:/Users/Public/",
                  "file:///D:/",
                  "file:///E:/"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-06-21",
        "modified": "2023-08-17",
        "references": [
          "https://twitter.com/inversecos/status/1494174785621819397",
          "Internal Research"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_office_trust_record_susp_location.yml"
      }
    },
    {
      "id": "7021255e-5db3-4946-a8b9-0ba7a4644a69",
      "title": "Potential Provisioning Registry Key Abuse For Binary Proxy Execution - REG",
      "status": "test",
      "description": "Detects potential abuse of the provisioning registry key for indirect command execution through \"Provlaunch.exe\".",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\Microsoft\\Provisioning\\Commands\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel",
        "date": "2023-08-02",
        "modified": "2023-08-17",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/Provlaunch/",
          "https://twitter.com/0gtweet/status/1674399582162153472"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_provisioning_command_abuse.yml"
      }
    },
    {
      "id": "dc5c24af-6995-49b2-86eb-a9ff62199e82",
      "title": "COM Hijacking via TreatAs",
      "status": "test",
      "description": "Detect modification of TreatAs key to enable \"rundll32.exe -sta\" command",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1546.015"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "TreatAs\\(Default)",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_office": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\OfficeClickToRun.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_office2": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Microsoft Office\\root\\integration\\integrator.exe",
                  "C:\\Program Files (x86)\\Microsoft Office\\root\\integration\\integrator.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_svchost": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\system32\\svchost.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_misexec": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Windows\\system32\\msiexec.exe",
                  "C:\\Windows\\SysWOW64\\msiexec.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1546.015"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-08-28",
        "modified": "2025-07-11",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1546.015/T1546.015.md",
          "https://www.youtube.com/watch?v=3gz1QmiMhss&t=1251s"
        ],
        "falsepositives": [
          "Legitimate use"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_treatas_persistence.yml"
      }
    },
    {
      "id": "f742bde7-9528-42e5-bd82-84f51a8387d2",
      "title": "Uncommon Microsoft Office Trusted Location Added",
      "status": "test",
      "description": "Detects changes to registry keys related to \"Trusted Location\" of Microsoft Office where the path is set to something uncommon. Attackers might add additional trusted locations to avoid macro security restrictions.",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "Security\\Trusted Locations\\Location",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Path",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_exclude_known_paths": {
            "type": "field_match",
            "matchers": {
              "Details__contains": {
                "field": "Details",
                "value": [
                  "%APPDATA%\\Microsoft\\Templates",
                  "%%APPDATA%%\\Microsoft\\Templates",
                  "%APPDATA%\\Microsoft\\Word\\Startup",
                  "%%APPDATA%%\\Microsoft\\Word\\Startup",
                  ":\\Program Files (x86)\\Microsoft Office\\root\\Templates\\",
                  ":\\Program Files\\Microsoft Office (x86)\\Templates",
                  ":\\Program Files\\Microsoft Office\\root\\Templates\\",
                  ":\\Program Files\\Microsoft Office\\Templates\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_office_click_to_run": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": ":\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\OfficeClickToRun.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_office_apps": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  ":\\Program Files\\Microsoft Office\\",
                  ":\\Program Files (x86)\\Microsoft Office\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_exclude_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_exclude_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-06-21",
        "modified": "2023-09-29",
        "references": [
          "Internal Research",
          "https://admx.help/?Category=Office2016&Policy=excel16.Office.Microsoft.Policies.Windows::L_TrustedLoc01"
        ],
        "falsepositives": [
          "Other unknown legitimate or custom paths need to be filtered to avoid false positives"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_office_trusted_location_uncommon.yml"
      }
    },
    {
      "id": "b29aed60-ebd1-442b-9cb5-16a1d0324adb",
      "title": "Wow6432Node CurrentVersion Autorun Keys Modification",
      "status": "test",
      "description": "Detects modification of autostart extensibility point (ASEP) in registry.",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_wow_current_version_base": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_wow_current_version_keys": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\ShellServiceObjectDelayLoad",
                  "\\Run\\",
                  "\\RunOnce\\",
                  "\\RunOnceEx\\",
                  "\\RunServices\\",
                  "\\RunServicesOnce\\",
                  "\\Explorer\\ShellServiceObjects",
                  "\\Explorer\\ShellIconOverlayIdentifiers",
                  "\\Explorer\\ShellExecuteHooks",
                  "\\Explorer\\SharedTaskScheduler",
                  "\\Explorer\\Browser Helper Objects"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_empty": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": "(Empty)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_null": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_ms_win_desktop_runtime": {
            "type": "field_match",
            "matchers": {
              "Details__startswith": {
                "field": "Details",
                "value": "\"C:\\ProgramData\\Package Cache\\{d21a4f20-968a-4b0c-bf04-a38da5f06e41}\\windowsdesktop-runtime-",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_vcredist": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\VC_redist.x64.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__endswith": {
                "field": "Details",
                "value": "}\\VC_redist.x64.exe\" /burn.runonce",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_upgrades": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\ProgramData\\Package Cache",
                  "C:\\Windows\\Temp\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__contains": {
                "field": "Image",
                "value": [
                  "\\winsdksetup.exe",
                  "\\windowsdesktop-runtime-",
                  "\\AspNetCoreSharedFrameworkBundle-"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "Details__endswith": {
                "field": "Details",
                "value": " /burn.runonce",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_uninstallers": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Windows\\Installer\\MSI",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Explorer\\Browser Helper Objects",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_msiexec": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\WINDOWS\\system32\\msiexec.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Run\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_edge": {
            "type": "field_match",
            "matchers": {
              "Image__contains_all": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\Microsoft\\EdgeUpdate\\Install\\{",
                  "\\setup.exe"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_msoffice1": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\OfficeClickToRun.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Office\\ClickToRun\\REGISTRY\\MACHINE\\Software\\Wow6432Node\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_msoffice2": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Microsoft Office\\root\\integration\\integrator.exe",
                  "C:\\Program Files (x86)\\Microsoft Office\\root\\integration\\integrator.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Explorer\\Browser Helper Objects\\{31D09BA0-12F5-4CCE-BE8A-2923E76605DA}\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_dropbox": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Details__endswith": {
                    "field": "Details",
                    "value": "-A251-47B7-93E1-CDD82E34AF8B}",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Details": {
                    "field": "Details",
                    "value": "grpconv -o",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Details__contains_all": {
                    "field": "Details",
                    "value": [
                      "C:\\Program Files",
                      "\\Dropbox\\Client\\Dropbox.exe",
                      " /systemstartup"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "filter_optional_evernote": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Explorer\\Browser Helper Objects\\{92EF2EAD-A7CE-4424-B0DB-499CF856608E}\\NoExplorer",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_dotnet": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": "\\windowsdesktop-runtime-",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\{e2d1ae32-dd1d-4ad7-a298-10e42e7840fc}",
                  "\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\{7037b699-7382-448c-89a7-4765961d2537}"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Details__startswith": {
                "field": "Details",
                "value": "\"C:\\ProgramData\\Package Cache\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__endswith": {
                "field": "Details",
                "value": ".exe\" /burn.runonce",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_office": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\",
                  "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\Updates\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\OfficeClickToRun.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_discord": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Run\\Discord",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__endswith": {
                "field": "Details",
                "value": "Discord.exe --checkInstall",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_avira": {
            "type": "field_match",
            "matchers": {
              "Details__endswith": {
                "field": "Details",
                "value": "\\Avira.OE.Setup.Bundle.exe\" /burn.runonce",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\Avira.OE.Setup.Bundle.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_avg_1": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\instup.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\AvRepair",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__endswith": {
                "field": "Details",
                "value": "instup.exe\" /instop:repair /wait",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_avg_2": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\instup.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ShellIconOverlayIdentifiers\\00avg\\(Default)",
                  "\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ShellIconOverlayIdentifiers\\00asw\\(Default)"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": [
                  "{472083B1-C522-11CF-8763-00608CC02F24}",
                  "{472083B0-C522-11CF-8763-00608CC02F24}"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "all of selection_*"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1547.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split)",
        "date": "2019-10-25",
        "modified": "2025-12-08",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md",
          "https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns",
          "https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d",
          "https://oddvar.moe/2018/03/21/persistence-using-runonceex-hidden-from-autoruns-exe/"
        ],
        "falsepositives": [
          "Legitimate software automatically (mostly, during installation) sets up autorun keys for legitimate reason",
          "Legitimate administrator sets up autorun keys for legitimate reason"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_wow6432node.yml"
      }
    },
    {
      "id": "8023f872-3f1d-4301-a384-801889917ab4",
      "title": "Usage of Renamed Sysinternals Tools - RegistrySet",
      "status": "test",
      "description": "Detects non-sysinternals tools setting the \"accepteula\" key which normally is set on sysinternals tool execution",
      "level": "high",
      "tags": [
        "attack.resource-development",
        "attack.t1588.002"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\PsExec",
                  "\\ProcDump",
                  "\\Handle",
                  "\\LiveKd",
                  "\\Process Explorer",
                  "\\PsLoglist",
                  "\\PsPasswd",
                  "\\Active Directory Explorer"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\EulaAccepted",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_image_names": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\PsExec.exe",
                  "\\PsExec64.exe",
                  "\\procdump.exe",
                  "\\procdump64.exe",
                  "\\handle.exe",
                  "\\handle64.exe",
                  "\\livekd.exe",
                  "\\livekd64.exe",
                  "\\procexp.exe",
                  "\\procexp64.exe",
                  "\\psloglist.exe",
                  "\\psloglist64.exe",
                  "\\pspasswd.exe",
                  "\\pspasswd64.exe",
                  "\\ADExplorer.exe",
                  "\\ADExplorer64.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_null": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1588.002"
        ],
        "tactics": [
          "resource_development"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-24",
        "modified": "2023-08-17",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_renamed_sysinternals_eula_accepted.yml"
      }
    },
    {
      "id": "e7b18879-676e-4a0e-ae18-27039185a8e7",
      "title": "New Netsh Helper DLL Registered From A Suspicious Location",
      "status": "test",
      "description": "Detects changes to the Netsh registry key to add a new DLL value that is located on a suspicious location. This change might be an indication of a potential persistence attempt by adding a malicious Netsh helper\n",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1546.007"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_target": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\Microsoft\\NetSh",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_folders_1": {
            "type": "field_match",
            "matchers": {
              "Details__contains": {
                "field": "Details",
                "value": [
                  ":\\Perflogs\\",
                  ":\\Users\\Public\\",
                  ":\\Windows\\Temp\\",
                  "\\AppData\\Local\\Temp\\",
                  "\\Temporary Internet"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_folders_2": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Details__contains_all": {
                    "field": "Details",
                    "value": [
                      ":\\Users\\",
                      "\\Favorites\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Details__contains_all": {
                    "field": "Details",
                    "value": [
                      ":\\Users\\",
                      "\\Favourites\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Details__contains_all": {
                    "field": "Details",
                    "value": [
                      ":\\Users\\",
                      "\\Contacts\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Details__contains_all": {
                    "field": "Details",
                    "value": [
                      ":\\Users\\",
                      "\\Pictures\\"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "selection_target and 1 of selection_folders_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_target"
            },
            {
              "type": "ref",
              "value": "1 of selection_folders_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1546.007"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-11-28",
        "modified": "",
        "references": [
          "https://www.ired.team/offensive-security/persistence/t1128-netsh-helper-dll",
          "https://pentestlab.blog/2019/10/29/persistence-netsh-helper-dll/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_netsh_help_dll_persistence_susp_location.yml"
      }
    },
    {
      "id": "8fbe98a8-8f9d-44f8-aa71-8c572e29ef06",
      "title": "Potential Persistence Via MyComputer Registry Keys",
      "status": "test",
      "description": "Detects modification to the \"Default\" value of the \"MyComputer\" key and subkeys to point to a custom binary that will be launched whenever the associated action is executed (see reference section for example)",
      "level": "high",
      "tags": [
        "attack.persistence"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Microsoft\\Windows\\CurrentVersion\\Explorer\\MyComputer",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "(Default)",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-09",
        "modified": "2024-01-11",
        "references": [
          "https://www.hexacorn.com/blog/2017/01/18/beyond-good-ol-run-key-part-55/"
        ],
        "falsepositives": [
          "Unlikely but if you experience FPs add specific processes and locations you would like to monitor for"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_persistence_mycomputer.yml"
      }
    },
    {
      "id": "48437c39-9e5f-47fb-af95-3d663c3f2919",
      "title": "UAC Disabled",
      "status": "stable",
      "description": "Detects when an attacker tries to disable User Account Control (UAC) by setting the registry value \"EnableLUA\" to 0.\n",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.defense-evasion",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\EnableLUA",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000000)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "privilege_escalation",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-05",
        "modified": "2024-05-10",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/7e11e9b79583545f208a6dc3fa062f2ed443d999/atomics/T1548.002/T1548.002.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_uac_disable.yml"
      }
    },
    {
      "id": "cbf93e5d-ca6c-4722-8bea-e9119007c248",
      "title": "CurrentVersion NT Autorun Keys Modification",
      "status": "test",
      "description": "Detects modification of autostart extensibility point (ASEP) in registry.",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_nt_current_version_base": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_nt_current_version": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Winlogon\\VmApplet",
                  "\\Winlogon\\Userinit",
                  "\\Winlogon\\Taskman",
                  "\\Winlogon\\Shell",
                  "\\Winlogon\\GpExtensions",
                  "\\Winlogon\\AppSetup",
                  "\\Winlogon\\AlternateShells\\AvailableShells",
                  "\\Windows\\IconServiceLib",
                  "\\Windows\\Appinit_Dlls",
                  "\\Image File Execution Options",
                  "\\Font Drivers",
                  "\\Drivers32",
                  "\\Windows\\Run",
                  "\\Windows\\Load"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_empty": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": "(Empty)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_null": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_poqexec": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\System32\\poqexec.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_legitimate_subkey": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Image File Execution Options\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "\\DisableExceptionChainValidation",
                  "\\MitigationOptions"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_security_extension_dc": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\system32\\svchost.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Winlogon\\GPExtensions\\{827D319E-6EAC-11D2-A4EA-00C04F79F83A}\\PreviousPolicyAreas",
                  "\\Winlogon\\GPExtensions\\{827D319E-6EAC-11D2-A4EA-00C04F79F83A}\\MaxNoGPOListChangesInterval"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": [
                  "DWORD (0x00000001)",
                  "DWORD (0x00000009)",
                  "DWORD (0x000003c0)"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_runtimebroker": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\System32\\RuntimeBroker.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\runtimebroker.exe\\Microsoft.Windows.ShellExperienceHost",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_edge": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Program Files (x86)\\Microsoft\\Temp\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\MicrosoftEdgeUpdate.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_avguard": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\Avira\\Antivirus\\avguard.exe",
                  "C:\\Program Files\\Avira\\Antivirus\\avguard.exe"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "SOFTWARE\\WOW6432Node\\Avira\\Antivirus\\Overwrite_Keys\\HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "\\userinit\\UseAsDefault",
                  "\\shell\\UseAsDefault"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": [
                  "explorer.exe",
                  "C:\\Windows\\system32\\userinit.exe,"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_msoffice": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "TargetObject__contains": {
                    "field": "TargetObject",
                    "value": [
                      "\\ClickToRunStore\\HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\",
                      "\\ClickToRun\\REGISTRY\\MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image": {
                    "field": "Image",
                    "value": [
                      "C:\\Program Files\\Microsoft Office\\root\\integration\\integrator.exe",
                      "C:\\Program Files (x86)\\Microsoft Office\\root\\integration\\integrator.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "filter_optional_officeclicktorun": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\",
                  "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\Updates\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\OfficeClickToRun.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_ngen": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Windows\\Microsoft.NET\\Framework",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\ngen.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_onedrive": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\AppData\\Local\\Microsoft\\OneDrive\\StandaloneUpdater\\OneDriveSetup.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\Delete Cached Update Binary",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__startswith": {
                "field": "Details",
                "value": "C:\\Windows\\system32\\cmd.exe /q /c del /q \"C:\\Users\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__endswith": {
                "field": "Details",
                "value": "\\AppData\\Local\\Microsoft\\OneDrive\\Update\\OneDriveSetup.exe\"",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "all of selection_*"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1547.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split)",
        "date": "2019-10-25",
        "modified": "2025-10-22",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md",
          "https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns",
          "https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d"
        ],
        "falsepositives": [
          "Legitimate software automatically (mostly, during installation) sets up autorun keys for legitimate reason",
          "Legitimate administrator sets up autorun keys for legitimate reason"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_currentversion_nt.yml"
      }
    },
    {
      "id": "d6c2ce7e-afb5-4337-9ca4-4b5254ed0565",
      "title": "WinSock2 Autorun Keys Modification",
      "status": "test",
      "description": "Detects modification of autostart extensibility point (ASEP) in registry.",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "winsock_parameters_base": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\System\\CurrentControlSet\\Services\\WinSock2\\Parameters",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "winsock_parameters": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Protocol_Catalog9\\Catalog_Entries",
                  "\\NameSpace_Catalog5\\Catalog_Entries"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Details": {
                    "field": "Details",
                    "value": "(Empty)",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image": {
                    "field": "Image",
                    "value": "C:\\Windows\\System32\\MsiExec.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image": {
                    "field": "Image",
                    "value": "C:\\Windows\\syswow64\\MsiExec.exe",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "condition": "winsock_parameters_base and winsock_parameters and not filter",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "winsock_parameters_base"
            },
            {
              "type": "ref",
              "value": "winsock_parameters"
            },
            {
              "type": "not",
              "value": "filter"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1547.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split)",
        "date": "2019-10-25",
        "modified": "2023-08-17",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md",
          "https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns",
          "https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d"
        ],
        "falsepositives": [
          "Legitimate software automatically (mostly, during installation) sets up autorun keys for legitimate reason",
          "Legitimate administrator sets up autorun keys for legitimate reason"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_winsock2.yml"
      }
    },
    {
      "id": "75180c5f-4ea1-461a-a4f6-6e4700c065d4",
      "title": "Windows Recall Feature Enabled - Registry",
      "status": "test",
      "description": "Detects the enabling of the Windows Recall feature via registry manipulation. Windows Recall can be enabled by setting the value of \"DisableAIDataAnalysis\" to \"0\".\nAdversaries may enable Windows Recall as part of post-exploitation discovery and collection activities.\nThis rule assumes that Recall is already explicitly disabled on the host, and subsequently enabled by the adversary.\n",
      "level": "medium",
      "tags": [
        "attack.collection",
        "attack.t1113"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Software\\Policies\\Microsoft\\Windows\\WindowsAI\\DisableAIDataAnalysis",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000000)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1113"
        ],
        "tactics": [
          "collection"
        ]
      },
      "meta": {
        "author": "Sajid Nawaz Khan",
        "date": "2024-06-02",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/windows/client-management/manage-recall",
          "https://learn.microsoft.com/en-us/windows/client-management/mdm/policy-csp-windowsai#disableaidataanalysis"
        ],
        "falsepositives": [
          "Legitimate use/activation of Windows Recall"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_enable_windows_recall.yml"
      }
    },
    {
      "id": "fad91067-08c5-4d1a-8d8c-d96a21b37814",
      "title": "Potential PowerShell Execution Policy Tampering",
      "status": "test",
      "description": "Detects changes to the PowerShell execution policy in order to bypass signing requirements for script execution",
      "level": "medium",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "\\ShellIds\\Microsoft.PowerShell\\ExecutionPolicy",
                  "\\Policies\\Microsoft\\Windows\\PowerShell\\ExecutionPolicy"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Details__contains": {
                "field": "Details",
                "value": [
                  "Bypass",
                  "Unrestricted"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_svchost": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  ":\\Windows\\System32\\",
                  ":\\Windows\\SysWOW64\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-01-11",
        "modified": "2023-12-14",
        "references": [
          "https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.security/set-executionpolicy?view=powershell-7.3"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_powershell_execution_policy.yml"
      }
    },
    {
      "id": "961e33d1-4f86-4fcf-80ab-930a708b2f82",
      "title": "Potential Persistence Via Excel Add-in - Registry",
      "status": "test",
      "description": "Detect potential persistence via the creation of an excel add-in (XLL) file to make it run automatically when Excel is started.",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.t1137.006"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "Software\\Microsoft\\Office\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Excel\\Options",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__startswith": {
                "field": "Details",
                "value": "/R ",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__endswith": {
                "field": "Details",
                "value": ".xll",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1137.006"
        ],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2023-01-15",
        "modified": "2023-08-17",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/4ae9580a1a8772db87a1b6cdb0d03e5af231e966/atomics/T1137.006/T1137.006.md",
          "https://labs.withsecure.com/publications/add-in-opportunities-for-office-persistence"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_persistence_xll.yml"
      }
    },
    {
      "id": "f2485272-a156-4773-82d7-1d178bc4905b",
      "title": "Suspicious Service Installed",
      "status": "test",
      "description": "Detects installation of NalDrv or PROCEXP152 services via registry-keys to non-system32 folders.\nBoth services are used in the tool Ghost-In-The-Logs (https://github.com/bats3c/Ghost-In-The-Logs), which uses KDU (https://github.com/hfiref0x/KDU)\n",
      "level": "medium",
      "tags": [
        "attack.t1562.001",
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject": {
                "field": "TargetObject",
                "value": [
                  "HKLM\\System\\CurrentControlSet\\Services\\NalDrv\\ImagePath",
                  "HKLM\\System\\CurrentControlSet\\Services\\PROCEXP152\\ImagePath"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\procexp64.exe",
                  "\\procexp.exe",
                  "\\procmon64.exe",
                  "\\procmon.exe",
                  "\\handle.exe",
                  "\\handle64.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Details__contains": {
                "field": "Details",
                "value": "\\WINDOWS\\system32\\Drivers\\PROCEXP152.SYS",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "xknow (@xknow_infosec), xorxes (@xor_xes)",
        "date": "2019-04-08",
        "modified": "2023-08-17",
        "references": [
          "https://web.archive.org/web/20200419024230/https://blog.dylan.codes/evading-sysmon-and-windows-event-logging/"
        ],
        "falsepositives": [
          "Other legimate tools using this service names and drivers. Note - clever attackers may easily bypass this detection by just renaming the services. Therefore just Medium-level and don't rely on it."
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_susp_service_installed.yml"
      }
    },
    {
      "id": "fcddca7c-b9c0-4ddf-98da-e1e2d18b0157",
      "title": "Disabled Windows Defender Eventlog",
      "status": "test",
      "description": "Detects the disabling of the Windows Defender eventlog as seen in relation to Lockbit 3.0 infections",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\Microsoft-Windows-Windows Defender/Operational\\Enabled",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000000)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2022-07-04",
        "modified": "2023-08-17",
        "references": [
          "https://twitter.com/WhichbufferArda/status/1543900539280293889/photo/2"
        ],
        "falsepositives": [
          "Other Antivirus software installations could cause Windows to disable that eventlog (unknown)"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_disabled_microsoft_defender_eventlog.yml"
      }
    },
    {
      "id": "fc014922-5def-4da9-a0fc-28c973f41bfb",
      "title": "Execution DLL of Choice Using WAB.EXE",
      "status": "test",
      "description": "This rule detects that the path to the DLL written in the registry is different from the default one. Launched WAB.exe tries to load the DLL from Registry.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Software\\Microsoft\\WAB\\DLLPath",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": "%CommonProgramFiles%\\System\\wab32.dll",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "oscd.community, Natalia Shornikova",
        "date": "2020-10-13",
        "modified": "2023-08-17",
        "references": [
          "https://github.com/LOLBAS-Project/LOLBAS/blob/8283d8d91552213ded165fd36deb6cb9534cb443/yml/OSBinaries/Wab.yml",
          "https://twitter.com/Hexacorn/status/991447379864932352",
          "http://www.hexacorn.com/blog/2018/05/01/wab-exe-as-a-lolbin/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_wab_dllpath_reg_change.yml"
      }
    },
    {
      "id": "a2863fbc-d5cb-48d5-83fb-d976d4b1743b",
      "title": "RDP Sensitive Settings Changed to Zero",
      "status": "test",
      "description": "Detects tampering of RDP Terminal Service/Server sensitive settings.\nSuch as allowing unauthorized users access to a system via the 'fAllowUnsolicited' or enabling RDP via 'fDenyTSConnections', etc.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.persistence",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "\\fDenyTSConnections",
                  "\\fSingleSessionPerUser",
                  "\\UserAuthentication"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000000)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "defense_evasion",
          "persistence"
        ]
      },
      "meta": {
        "author": "Samir Bousseaden, David ANDRE, Roberto Rodriguez @Cyb3rWard0g, Nasreddine Bencherchali",
        "date": "2022-09-29",
        "modified": "2022-11-26",
        "references": [
          "https://web.archive.org/web/20200929062532/https://blog.menasec.net/2019/02/threat-hunting-rdp-hijacking-via.html",
          "http://woshub.com/rds-shadow-how-to-connect-to-a-user-session-in-windows-server-2012-r2/",
          "https://twitter.com/SagieSec/status/1469001618863624194?t=HRf0eA0W1YYzkTSHb-Ky1A&s=03",
          "https://threathunterplaybook.com/hunts/windows/190407-RegModEnableRDPConnections/notebook.html",
          "https://bazaar.abuse.ch/sample/6f3aa9362d72e806490a8abce245331030d1ab5ac77e400dd475748236a6cc81/",
          "http://etutorials.org/Microsoft+Products/microsoft+windows+server+2003+terminal+services/Chapter+6+Registry/Registry+Keys+for+Terminal+Services/",
          "https://admx.help/HKLM/SOFTWARE/Policies/Microsoft/Windows%20NT/Terminal%20Services"
        ],
        "falsepositives": [
          "Some of the keys mentioned here could be modified by an administrator while setting group policy (it should be investigated either way)"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_terminal_server_suspicious.yml"
      }
    },
    {
      "id": "7a1b4c5e-8f3d-4b9a-7c2e-1f4a5b8c6d9e",
      "title": "Suspicious Space Characters in RunMRU Registry Path - ClickFix",
      "status": "experimental",
      "description": "Detects the occurrence of numerous space characters in RunMRU registry paths, which may indicate execution via phishing lures using clickfix techniques to hide malicious commands in the Windows Run dialog box from naked eyes.\n",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1204.004",
        "attack.defense-evasion",
        "attack.t1027.010"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_key": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RunMRU\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__contains": {
                "field": "Details",
                "value": "#",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_space_variation": {
            "type": "field_match",
            "matchers": {
              "Details__contains": {
                "field": "Details",
                "value": [
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "            "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1204.004",
          "T1027.010"
        ],
        "tactics": [
          "execution",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-11-04",
        "modified": "",
        "references": [
          "https://expel.com/blog/cache-smuggling-when-a-picture-isnt-a-thousand-words/",
          "https://github.com/JohnHammond/recaptcha-phish"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_susp_runmru_space_character.yml"
      }
    },
    {
      "id": "6c304b02-06e6-402d-8be4-d5833cdf8198",
      "title": "Potential SentinelOne Shell Context Menu Scan Command Tampering",
      "status": "test",
      "description": "Detects potentially suspicious changes to the SentinelOne context menu scan command by a process other than SentinelOne.",
      "level": "medium",
      "tags": [
        "attack.persistence"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\shell\\SentinelOneScan\\command\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_sentinelone_default_scan_binary": {
            "type": "field_match",
            "matchers": {
              "Details__startswith": {
                "field": "Details",
                "value": [
                  "C:\\Program Files\\SentinelOne\\Sentinel Agent",
                  "C:\\Program Files (x86)\\SentinelOne\\Sentinel Agent"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Details__contains": {
                "field": "Details",
                "value": "\\SentinelScanFromContextMenu.exe",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_sentinelone_binary": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\SentinelOne\\",
                  "C:\\Program Files (x86)\\SentinelOne\\"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2024-03-06",
        "modified": "",
        "references": [
          "https://mrd0x.com/sentinelone-persistence-via-menu-context/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_sentinelone_shell_context_tampering.yml"
      }
    },
    {
      "id": "973ef012-8f1a-4c40-93b4-7e659a5cd17f",
      "title": "Periodic Backup For System Registry Hives Enabled",
      "status": "test",
      "description": "Detects the enabling of the \"EnablePeriodicBackup\" registry value. Once enabled, The OS will backup System registry hives on restarts to the \"C:\\Windows\\System32\\config\\RegBack\" folder. Windows creates a \"RegIdleBackup\" task to manage subsequent backups.\nRegistry backup was a default behavior on Windows and was disabled as of \"Windows 10, version 1803\".\n",
      "level": "medium",
      "tags": [
        "attack.collection",
        "attack.t1113"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Control\\Session Manager\\Configuration Manager\\EnablePeriodicBackup",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000001)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1113"
        ],
        "tactics": [
          "collection"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2024-07-01",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/troubleshoot/windows-client/installing-updates-features-roles/system-registry-no-backed-up-regback-folder"
        ],
        "falsepositives": [
          "Legitimate need for RegBack feature by administrators."
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_enable_periodic_backup.yml"
      }
    },
    {
      "id": "fdbf0b9d-0182-4c43-893b-a1eaab92d085",
      "title": "Potential Persistence Via Custom Protocol Handler",
      "status": "test",
      "description": "Detects potential persistence activity via the registering of a new custom protocole handlers. While legitimate applications register protocole handlers often times during installation. And attacker can abuse this by setting a custom handler to be used as a persistence mechanism.",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__startswith": {
                "field": "TargetObject",
                "value": "HKCR\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__startswith": {
                "field": "Details",
                "value": "URL:",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_ms_trusted": {
            "type": "field_match",
            "matchers": {
              "Details__startswith": {
                "field": "Details",
                "value": "URL:ms-",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_generic_locations": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)",
                  "C:\\Program Files\\",
                  "C:\\Windows\\System32\\",
                  "C:\\Windows\\SysWOW64\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-05-30",
        "modified": "2023-05-12",
        "references": [
          "https://ladydebug.com/blog/2019/06/21/custom-protocol-handler-cph/"
        ],
        "falsepositives": [
          "Many legitimate applications can register a new custom protocol handler. Additional filters needs to applied according to your environment."
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_persistence_custom_protocol_handler.yml"
      }
    },
    {
      "id": "509e84b9-a71a-40e0-834f-05470369bd1e",
      "title": "Default RDP Port Changed to Non Standard Port",
      "status": "test",
      "description": "Detects changes to the default RDP port.\nRemote desktop is a common feature in operating systems. It allows a user to log into a remote system using an interactive session with a graphical user interface.\nMicrosoft refers to its implementation of the Remote Desktop Protocol (RDP) as Remote Desktop Services (RDS).\n",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547.010"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Control\\Terminal Server\\WinStations\\RDP-Tcp\\PortNumber",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_port": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000d3d)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1547.010"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-01",
        "modified": "2024-03-25",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1021.001/T1021.001.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_change_rdp_port.yml"
      }
    },
    {
      "id": "d6ce7ebd-260b-4323-9768-a9631c8d4db2",
      "title": "RestrictedAdminMode Registry Value Tampering",
      "status": "test",
      "description": "Detects changes to the \"DisableRestrictedAdmin\" registry value in order to disable or enable RestrictedAdmin mode.\nRestrictedAdmin mode prevents the transmission of reusable credentials to the remote system to which you connect using Remote Desktop.\nThis prevents your credentials from being harvested during the initial connection process if the remote server has been compromise\n",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "System\\CurrentControlSet\\Control\\Lsa\\DisableRestrictedAdmin",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2023-01-13",
        "modified": "2024-08-23",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/a8e3cf63e97b973a25903d3df9fd55da6252e564/atomics/T1112/T1112.md",
          "https://social.technet.microsoft.com/wiki/contents/articles/32905.remote-desktop-services-enable-restricted-admin-mode.aspx"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_lsa_disablerestrictedadmin.yml"
      }
    },
    {
      "id": "dfb5b4e8-91d0-4291-b40a-e3b0d3942c45",
      "title": "Potential Persistence Via Shim Database Modification",
      "status": "test",
      "description": "Adversaries may establish persistence and/or elevate privileges by executing malicious content triggered by application shims.\nThe Microsoft Windows Application Compatibility Infrastructure/Framework (Application Shim) was created to allow for backward compatibility of software as the operating system codebase changes over time\n",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1546.011"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\InstalledSDB\\",
                  "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Custom\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_empty_string": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": "",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_empty_value": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": "(Empty)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_null": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1546.011"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-12-30",
        "modified": "2025-10-22",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1546.011/T1546.011.md#atomic-test-3---registry-key-creation-andor-modification-events-for-sdb",
          "https://www.fireeye.com/blog/threat-research/2017/05/fin7-shim-databases-persistence.html",
          "https://andreafortuna.org/2018/11/12/process-injection-and-persistence-using-application-shimming/"
        ],
        "falsepositives": [
          "Legitimate custom SHIM installations will also trigger this rule"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_persistence_shim_database.yml"
      }
    },
    {
      "id": "0eb46774-f1ab-4a74-8238-1155855f2263",
      "title": "Disable Windows Defender Functionalities Via Registry Keys",
      "status": "test",
      "description": "Detects when attackers or tools disable Windows Defender functionalities via the Windows registry",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_main": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\SOFTWARE\\Microsoft\\Windows Defender\\",
                  "\\SOFTWARE\\Policies\\Microsoft\\Windows Defender Security Center\\",
                  "\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_dword_1": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "\\DisableAntiSpyware",
                  "\\DisableAntiVirus",
                  "\\DisableBehaviorMonitoring",
                  "\\DisableBlockAtFirstSeen",
                  "\\DisableEnhancedNotifications",
                  "\\DisableIntrusionPreventionSystem",
                  "\\DisableIOAVProtection",
                  "\\DisableOnAccessProtection",
                  "\\DisableRealtimeMonitoring",
                  "\\DisableScanOnRealtimeEnable",
                  "\\DisableScriptScanning"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000001)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_dword_0": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "\\DisallowExploitProtectionOverride",
                  "\\Features\\TamperProtection",
                  "\\MpEngine\\MpEnablePus",
                  "\\PUAProtection",
                  "\\Signature Update\\ForceUpdateFromMU",
                  "\\SpyNet\\SpynetReporting",
                  "\\SpyNet\\SubmitSamplesConsent",
                  "\\Windows Defender Exploit Guard\\Controlled Folder Access\\EnableControlledFolderAccess"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000000)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_symantec": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Program Files\\Symantec\\Symantec Endpoint Protection\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\sepWscSvc64.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection_main and 1 of selection_dword_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_main"
            },
            {
              "type": "ref",
              "value": "1 of selection_dword_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "AlertIQ, Jn Trenansk, frack113, Nasreddine Bencherchali, Swachchhanda Shrawan Poudel",
        "date": "2022-08-01",
        "modified": "2024-10-07",
        "references": [
          "https://thedfirreport.com/2021/10/18/icedid-to-xinglocker-ransomware-in-24-hours/",
          "https://gist.github.com/anadr/7465a9fde63d41341136949f14c21105",
          "https://admx.help/?Category=Windows_7_2008R2&Policy=Microsoft.Policies.WindowsDefender::SpyNetReporting",
          "https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ransomware-hive-conti-avoslocker",
          "https://www.tenforums.com/tutorials/32236-enable-disable-microsoft-defender-pua-protection-windows-10-a.html",
          "https://www.tenforums.com/tutorials/105533-enable-disable-windows-defender-exploit-protection-settings.html",
          "https://www.tenforums.com/tutorials/123792-turn-off-tamper-protection-microsoft-defender-antivirus.html",
          "https://securelist.com/key-group-ransomware-samples-and-telegram-schemes/114025/"
        ],
        "falsepositives": [
          "Administrator actions via the Windows Defender interface",
          "Third party Antivirus"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_windows_defender_tamper.yml"
      }
    },
    {
      "id": "0cf2e1c6-8d10-4273-8059-738778f981ad",
      "title": "Potential WerFault ReflectDebugger Registry Value Abuse",
      "status": "test",
      "description": "Detects potential WerFault \"ReflectDebugger\" registry value abuse for persistence.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036.003"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Microsoft\\Windows\\Windows Error Reporting\\Hangs\\ReflectDebugger",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1036.003"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "X__Junior",
        "date": "2023-05-18",
        "modified": "",
        "references": [
          "https://cocomelonc.github.io/malware/2022/11/02/malware-pers-18.html",
          "https://www.hexacorn.com/blog/2018/08/31/beyond-good-ol-run-key-part-85/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_persistence_reflectdebugger.yml"
      }
    },
    {
      "id": "c3cefdf4-6703-4e1c-bad8-bf422fc5015a",
      "title": "Outlook Security Settings Updated - Registry",
      "status": "test",
      "description": "Detects changes to the registry values related to outlook security settings",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.t1137"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains_all": {
                "field": "TargetObject",
                "value": [
                  "\\SOFTWARE\\Microsoft\\Office\\",
                  "\\Outlook\\Security\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1137"
        ],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-12-28",
        "modified": "2023-08-17",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1137/T1137.md",
          "https://learn.microsoft.com/en-us/outlook/troubleshoot/security/information-about-email-security-settings"
        ],
        "falsepositives": [
          "Administrative activity"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_office_outlook_security_settings.yml"
      }
    },
    {
      "id": "9d15044a-7cfe-4d23-8085-6ebc11df7685",
      "title": "Potential Persistence Via Visual Studio Tools for Office",
      "status": "test",
      "description": "Detects persistence via Visual Studio Tools for Office (VSTO) add-ins in Office applications.",
      "level": "medium",
      "tags": [
        "attack.t1137.006",
        "attack.persistence"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Software\\Microsoft\\Office\\Outlook\\Addins\\",
                  "\\Software\\Microsoft\\Office\\Word\\Addins\\",
                  "\\Software\\Microsoft\\Office\\Excel\\Addins\\",
                  "\\Software\\Microsoft\\Office\\Powerpoint\\Addins\\",
                  "\\Software\\Microsoft\\VSTO\\Security\\Inclusion\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_system": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Windows\\System32\\msiexec.exe",
                  "C:\\Windows\\SysWOW64\\msiexec.exe",
                  "C:\\Windows\\System32\\regsvr32.exe",
                  "C:\\Windows\\SysWOW64\\regsvr32.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_office_click_to_run": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Common Files (x86)\\Microsoft Shared\\ClickToRun\\",
                  "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\OfficeClickToRun.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_integrator": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\Microsoft Office\\root\\integration\\integrator.exe",
                  "C:\\Program Files\\Microsoft Office\\root\\integration\\integrator.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_office_apps": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Microsoft Office\\OFFICE",
                  "C:\\Program Files (x86)\\Microsoft Office\\OFFICE",
                  "C:\\Program Files\\Microsoft Office\\Root\\OFFICE",
                  "C:\\Program Files (x86)\\Microsoft Office\\Root\\OFFICE"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\excel.exe",
                  "\\Integrator.exe",
                  "\\outlook.exe",
                  "\\powerpnt.exe",
                  "\\Teams.exe",
                  "\\visio.exe",
                  "\\winword.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_avg": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\AVG\\Antivirus\\RegSvr.exe",
                  "C:\\Program Files (x86)\\AVG\\Antivirus\\RegSvr.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Microsoft\\Office\\Outlook\\Addins\\Antivirus.AsOutExt\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_avast": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Avast Software\\Avast\\RegSvr.exe",
                  "C:\\Program Files (x86)\\Avast Software\\Avast\\RegSvr.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Microsoft\\Office\\Outlook\\Addins\\Avast.AsOutExt\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1137.006"
        ],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "Bhabesh Raj",
        "date": "2021-01-10",
        "modified": "2025-10-07",
        "references": [
          "https://twitter.com/_vivami/status/1347925307643355138",
          "https://vanmieghem.io/stealth-outlook-persistence/"
        ],
        "falsepositives": [
          "Legitimate Addin Installation"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_persistence_office_vsto.yml"
      }
    },
    {
      "id": "85b88e05-dadc-430b-8a9e-53ff1cd30aae",
      "title": "Potentially Suspicious Desktop Background Change Via Registry",
      "status": "test",
      "description": "Detects registry value settings that would replace the user's desktop background.\nThis is a common technique used by malware to change the desktop background to a ransom note or other image.\n",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.impact",
        "attack.t1112",
        "attack.t1491.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_keys": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "Control Panel\\Desktop",
                  "CurrentVersion\\Policies\\ActiveDesktop",
                  "CurrentVersion\\Policies\\System"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_values_1": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "NoChangingWallpaper",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000001)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_values_2": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Wallpaper",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_values_3": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\WallpaperStyle",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "2",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_svchost": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\svchost.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_empty": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Control Panel\\Desktop\\Wallpaper",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "(Empty)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_explorer": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "C:\\Windows\\Explorer.EXE",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_ec2launch": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Amazon\\EC2Launch\\EC2Launch.exe",
                  "C:\\Program Files (x86)\\Amazon\\EC2Launch\\EC2Launch.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Control Panel\\Desktop\\Wallpaper",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection_keys and 1 of selection_values_* and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_keys"
            },
            {
              "type": "ref",
              "value": "1 of selection_values_*"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1112",
          "T1491.001"
        ],
        "tactics": [
          "persistence",
          "defense_evasion",
          "impact"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), Stephen Lincoln @slincoln-aiq (AttackIQ)",
        "date": "2023-12-21",
        "modified": "2025-10-17",
        "references": [
          "https://www.attackiq.com/2023/09/20/emulating-rhysida/",
          "https://research.checkpoint.com/2023/the-rhysida-ransomware-activity-analysis-and-ties-to-vice-society/",
          "https://www.trendmicro.com/en_us/research/23/h/an-overview-of-the-new-rhysida-ransomware.html",
          "https://www.virustotal.com/gui/file/a864282fea5a536510ae86c77ce46f7827687783628e4f2ceb5bf2c41b8cd3c6/behavior",
          "https://admx.help/?Category=Windows_10_2016&Policy=Microsoft.Policies.WindowsDesktop::Wallpaper",
          "https://admx.help/?Category=Windows_10_2016&Policy=Microsoft.Policies.ControlPanelDisplay::CPL_Personalization_NoDesktopBackgroundUI"
        ],
        "falsepositives": [
          "Administrative scripts that change the desktop background to a company logo or other image."
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_desktop_background_change.yml"
      }
    },
    {
      "id": "c5f6a85d-b647-40f7-bbad-c10b66bab038",
      "title": "UAC Notification Disabled",
      "status": "test",
      "description": "Detects when an attacker tries to disable User Account Control (UAC) notification by tampering with the \"UACDisableNotify\" value.\nUAC is a critical security feature in Windows that prevents unauthorized changes to the operating system. It prompts the user for permission or an administrator password before allowing actions that could affect the system's operation or change settings that affect other users.\nWhen \"UACDisableNotify\" is set to 1, UAC prompts are suppressed.\n",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.defense-evasion",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Microsoft\\Security Center\\UACDisableNotify",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000001)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "privilege_escalation",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2024-05-10",
        "modified": "",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/7e11e9b79583545f208a6dc3fa062f2ed443d999/atomics/T1548.002/T1548.002.md",
          "https://securityintelligence.com/x-force/x-force-hive0129-targeting-financial-institutions-latam-banking-trojan/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_uac_disable_notification.yml"
      }
    },
    {
      "id": "bbf59793-6efb-4fa1-95ca-a7d288e52c88",
      "title": "Winlogon Notify Key Logon Persistence",
      "status": "test",
      "description": "Adversaries may abuse features of Winlogon to execute DLLs and/or executables when a user logs in.\nWinlogon.exe is a Windows component responsible for actions at logon/logoff as well as the secure attention sequence (SAS) triggered by Ctrl-Alt-Delete.\n",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547.004"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Notify\\logon",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__endswith": {
                "field": "Details",
                "value": ".dll",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1547.004"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-12-30",
        "modified": "2023-08-17",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.004/T1547.004.md#atomic-test-3---winlogon-notify-key-logon-persistence---powershell"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_winlogon_notify_key.yml"
      }
    },
    {
      "id": "4916a35e-bfc4-47d0-8e25-a003d7067061",
      "title": "Sysmon Driver Altitude Change",
      "status": "test",
      "description": "Detects changes in Sysmon driver altitude value.\nIf the Sysmon driver is configured to load at an altitude of another registered service, it will fail to load at boot.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Services\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Instances\\Sysmon Instance\\Altitude",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "B.Talebi",
        "date": "2022-07-28",
        "modified": "2024-03-25",
        "references": [
          "https://posts.specterops.io/shhmon-silencing-sysmon-via-driver-unload-682b5be57650",
          "https://youtu.be/zSihR3lTf7g"
        ],
        "falsepositives": [
          "Legitimate driver altitude change to hide sysmon"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_change_sysmon_driver_altitude.yml"
      }
    },
    {
      "id": "f50f3c09-557d-492d-81db-9064a8d4e211",
      "title": "Suspicious Execution Of Renamed Sysinternals Tools - Registry",
      "status": "test",
      "description": "Detects the creation of the \"accepteula\" key related to the Sysinternals tools being created from executables with the wrong name (e.g. a renamed Sysinternals tool)",
      "level": "high",
      "tags": [
        "attack.resource-development",
        "attack.t1588.002"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Active Directory Explorer",
                  "\\Handle",
                  "\\LiveKd",
                  "\\ProcDump",
                  "\\Process Explorer",
                  "\\PsExec",
                  "\\PsLoggedon",
                  "\\PsLoglist",
                  "\\PsPasswd",
                  "\\PsPing",
                  "\\PsService",
                  "\\SDelete"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\EulaAccepted",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\ADExplorer.exe",
                  "\\ADExplorer64.exe",
                  "\\handle.exe",
                  "\\handle64.exe",
                  "\\livekd.exe",
                  "\\livekd64.exe",
                  "\\procdump.exe",
                  "\\procdump64.exe",
                  "\\procexp.exe",
                  "\\procexp64.exe",
                  "\\PsExec.exe",
                  "\\PsExec64.exe",
                  "\\PsLoggedon.exe",
                  "\\PsLoggedon64.exe",
                  "\\psloglist.exe",
                  "\\psloglist64.exe",
                  "\\pspasswd.exe",
                  "\\pspasswd64.exe",
                  "\\PsPing.exe",
                  "\\PsPing64.exe",
                  "\\PsService.exe",
                  "\\PsService64.exe",
                  "\\sdelete.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1588.002"
        ],
        "tactics": [
          "resource_development"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-24",
        "modified": "2025-10-26",
        "references": [
          "Internal Research"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_pua_sysinternals_renamed_execution_via_eula.yml"
      }
    },
    {
      "id": "7d9263bd-dc47-4a58-bc92-5474abab390c",
      "title": "Change Winevt Channel Access Permission Via Registry",
      "status": "test",
      "description": "Detects tampering with the \"ChannelAccess\" registry key in order to change access to Windows event channel.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.002"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\ChannelAccess",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__contains": {
                "field": "Details",
                "value": [
                  "(A;;0x1;;;LA)",
                  "(A;;0x1;;;SY)",
                  "(A;;0x5;;;BA)"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_trustedinstaller": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\servicing\\TrustedInstaller.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_tiworker": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Windows\\WinSxS\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\TiWorker.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1562.002"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-09-17",
        "modified": "2024-03-25",
        "references": [
          "https://app.any.run/tasks/77b2e328-8f36-46b2-b2e2-8a80398217ab/",
          "https://learn.microsoft.com/en-us/windows/win32/api/winevt/",
          "https://itconnect.uw.edu/tools-services-support/it-systems-infrastructure/msinf/other-help/understanding-sddl-syntax/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_change_winevt_channelaccess.yml"
      }
    },
    {
      "id": "612e47e9-8a59-43a6-b404-f48683f45bd6",
      "title": "ServiceDll Hijack",
      "status": "test",
      "description": "Detects changes to the \"ServiceDLL\" value related to a service in the registry.\nThis is often used as a method of persistence.\n",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.privilege-escalation",
        "attack.t1543.003"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains_all": {
                "field": "TargetObject",
                "value": [
                  "\\System\\",
                  "ControlSet",
                  "\\Services\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Parameters\\ServiceDll",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_printextensionmanger": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": "C:\\Windows\\system32\\spool\\drivers\\x64\\3\\PrintConfig.dll",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_domain_controller": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\system32\\lsass.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Services\\NTDS\\Parameters\\ServiceDll",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "%%systemroot%%\\system32\\ntdsa.dll",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_poqexec": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\System32\\poqexec.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_safetica": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\regsvr32.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "C:\\Windows\\System32\\STAgent.dll",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1543.003"
        ],
        "tactics": [
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-02-04",
        "modified": "2024-04-03",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1543.003/T1543.003.md#atomic-test-4---tinyturla-backdoor-service-w64time",
          "https://www.hexacorn.com/blog/2013/09/19/beyond-good-ol-run-key-part-4/"
        ],
        "falsepositives": [
          "Administrative scripts",
          "Installation of a service"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_servicedll_hijack.yml"
      }
    },
    {
      "id": "9df5f547-c86a-433e-b533-f2794357e242",
      "title": "Classes Autorun Keys Modification",
      "status": "test",
      "description": "Detects modification of autostart extensibility point (ASEP) in registry.",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_classes_base": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Software\\Classes",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_classes_target": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Folder\\ShellEx\\ExtShellFolderViews",
                  "\\Folder\\ShellEx\\DragDropHandlers",
                  "\\Folder\\Shellex\\ColumnHandlers",
                  "\\Filter",
                  "\\Exefile\\Shell\\Open\\Command\\(Default)",
                  "\\Directory\\Shellex\\DragDropHandlers",
                  "\\Directory\\Shellex\\CopyHookHandlers",
                  "\\CLSID\\{AC757296-3522-4E11-9862-C17BE5A1767E}\\Instance",
                  "\\CLSID\\{ABE3B9A4-257D-4B97-BD1A-294AF496222E}\\Instance",
                  "\\CLSID\\{7ED96837-96F0-4812-B211-F13C24117ED3}\\Instance",
                  "\\CLSID\\{083863F1-70DE-11d0-BD40-00A0C911CE86}\\Instance",
                  "\\Classes\\AllFileSystemObjects\\ShellEx\\DragDropHandlers",
                  "\\.exe",
                  "\\.cmd",
                  "\\ShellEx\\PropertySheetHandlers",
                  "\\ShellEx\\ContextMenuHandlers"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_drivers": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\System32\\drvinst.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_empty": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": "(Empty)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_null": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_svchost": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\System32\\svchost.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\lnkfile\\shellex\\ContextMenuHandlers\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_msoffice": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": "{807583E5-5146-11D5-A672-00B0D022E945}",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "all of selection_*"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1547.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split)",
        "date": "2019-10-25",
        "modified": "2025-10-22",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md",
          "https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns",
          "https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d"
        ],
        "falsepositives": [
          "Legitimate software automatically (mostly, during installation) sets up autorun keys for legitimate reason",
          "Legitimate administrator sets up autorun keys for legitimate reason"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_classes.yml"
      }
    },
    {
      "id": "480421f9-417f-4d3b-9552-fd2728443ec8",
      "title": "Wow6432Node Windows NT CurrentVersion Autorun Keys Modification",
      "status": "test",
      "description": "Detects modification of autostart extensibility point (ASEP) in registry.",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_wow_nt_current_version_base": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows NT\\CurrentVersion",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_wow_nt_current_version": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Windows\\Appinit_Dlls",
                  "\\Image File Execution Options",
                  "\\Drivers32"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_empty": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": "(Empty)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_null": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_file_exec_options": {
            "type": "field_match",
            "matchers": {
              "Details__endswith": {
                "field": "Details",
                "value": "\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter_main_"
        }
      },
      "mitre": {
        "techniques": [
          "T1547.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split)",
        "date": "2019-10-25",
        "modified": "2025-10-22",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md",
          "https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns",
          "https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d"
        ],
        "falsepositives": [
          "Legitimate software automatically (mostly, during installation) sets up autorun keys for legitimate reason",
          "Legitimate administrator sets up autorun keys for legitimate reason"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_wow6432node_currentversion.yml"
      }
    },
    {
      "id": "1a5c46e9-f32f-42f7-b2bc-6e9084db7fbf",
      "title": "Trust Access Disable For VBApplications",
      "status": "test",
      "description": "Detects registry changes to Microsoft Office \"AccessVBOM\" to a value of \"1\" which disables trust access for VBA on the victim machine and lets attackers execute malicious macros without any Microsoft Office warnings.",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Security\\AccessVBOM",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000001)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Trent Liffick (@tliffick), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2020-05-22",
        "modified": "2023-08-17",
        "references": [
          "https://twitter.com/inversecos/status/1494174785621819397",
          "https://www.mcafee.com/blogs/other-blogs/mcafee-labs/zloader-with-a-new-infection-technique/",
          "https://securelist.com/scarcruft-surveilling-north-korean-defectors-and-human-rights-activists/105074/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_office_access_vbom_tamper.yml"
      }
    },
    {
      "id": "8218c875-90b9-42e2-b60d-0b0069816d10",
      "title": "PowerShell Script Execution Policy Enabled",
      "status": "test",
      "description": "Detects the enabling of the PowerShell script execution policy. Once enabled, this policy allows scripts to be executed.",
      "level": "low",
      "tags": [
        "attack.execution"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Policies\\Microsoft\\Windows\\PowerShell\\EnableScripts",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000001)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), Thurein Oo",
        "date": "2023-10-18",
        "modified": "",
        "references": [
          "https://admx.help/?Category=Windows_10_2016&Policy=Microsoft.Policies.PowerShell::EnableScripts"
        ],
        "falsepositives": [
          "Likely"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_powershell_enablescripts_enabled.yml"
      }
    },
    {
      "id": "e4d22291-f3d5-4b78-9a0c-a1fbaf32a6a4",
      "title": "Potentially Suspicious ODBC Driver Registered",
      "status": "test",
      "description": "Detects the registration of a new ODBC driver where the driver is located in a potentially suspicious location",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.persistence",
        "attack.t1003"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\ODBC\\ODBCINST.INI\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "\\Driver",
                  "\\Setup"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Details__contains": {
                "field": "Details",
                "value": [
                  ":\\PerfLogs\\",
                  ":\\ProgramData\\",
                  ":\\Temp\\",
                  ":\\Users\\Public\\",
                  ":\\Windows\\Registration\\CRMLog",
                  ":\\Windows\\System32\\com\\dmp\\",
                  ":\\Windows\\System32\\FxsTmp\\",
                  ":\\Windows\\System32\\Microsoft\\Crypto\\RSA\\MachineKeys\\",
                  ":\\Windows\\System32\\spool\\drivers\\color\\",
                  ":\\Windows\\System32\\spool\\PRINTERS\\",
                  ":\\Windows\\System32\\spool\\SERVERS\\",
                  ":\\Windows\\System32\\Tasks_Migrated\\",
                  ":\\Windows\\System32\\Tasks\\Microsoft\\Windows\\SyncCenter\\",
                  ":\\Windows\\SysWOW64\\com\\dmp\\",
                  ":\\Windows\\SysWOW64\\FxsTmp\\",
                  ":\\Windows\\SysWOW64\\Tasks\\Microsoft\\Windows\\PLA\\System\\",
                  ":\\Windows\\SysWOW64\\Tasks\\Microsoft\\Windows\\SyncCenter\\",
                  ":\\Windows\\Tasks\\",
                  ":\\Windows\\Temp\\",
                  ":\\Windows\\Tracing\\",
                  "\\AppData\\Local\\Temp\\",
                  "\\AppData\\Roaming\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003"
        ],
        "tactics": [
          "credential_access",
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-23",
        "modified": "2023-08-17",
        "references": [
          "https://www.hexacorn.com/blog/2020/08/23/odbcconf-lolbin-trifecta/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_odbc_driver_registered_susp.yml"
      }
    },
    {
      "id": "91239011-fe3c-4b54-9f24-15c86bb65913",
      "title": "Office Macros Warning Disabled",
      "status": "test",
      "description": "Detects registry changes to Microsoft Office \"VBAWarning\" to a value of \"1\" which enables the execution of all macros, whether signed or unsigned.",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Security\\VBAWarnings",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000001)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Trent Liffick (@tliffick), Nasreddine Bencherchali (Nextron Systems)",
        "date": "2020-05-22",
        "modified": "2024-03-19",
        "references": [
          "https://twitter.com/inversecos/status/1494174785621819397",
          "https://www.mcafee.com/blogs/other-blogs/mcafee-labs/zloader-with-a-new-infection-technique/",
          "https://securelist.com/scarcruft-surveilling-north-korean-defectors-and-human-rights-activists/105074/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_office_vba_warnings_tamper.yml"
      }
    },
    {
      "id": "36803969-5421-41ec-b92f-8500f79c23b0",
      "title": "Potential Persistence Via GlobalFlags",
      "status": "test",
      "description": "Detects registry persistence technique using the GlobalFlags and SilentProcessExit keys",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1546.012",
        "car.2013-01-002"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_global_flag": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains_all": {
                "field": "TargetObject",
                "value": [
                  "\\Microsoft\\Windows NT\\CurrentVersion\\",
                  "\\Image File Execution Options\\",
                  "\\GlobalFlag"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_silent_process": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains_all": {
                "field": "TargetObject",
                "value": [
                  "\\Microsoft\\Windows NT\\CurrentVersion\\",
                  "\\SilentProcessExit\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\ReportingMode",
                  "\\MonitorProcess"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1546.012"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Karneades, Jonhnathan Ribeiro, Florian Roth",
        "date": "2018-04-11",
        "modified": "2023-06-05",
        "references": [
          "https://oddvar.moe/2018/04/10/persistence-using-globalflags-in-image-file-execution-options-hidden-from-autoruns-exe/",
          "https://www.deepinstinct.com/2021/02/16/lsass-memory-dumps-are-stealthier-than-ever-before-part-2/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_persistence_globalflags.yml"
      }
    },
    {
      "id": "2f78da12-f7c7-430b-8b19-a28f269b77a3",
      "title": "Disable Windows Event Logging Via Registry",
      "status": "test",
      "description": "Detects tampering with the \"Enabled\" registry key in order to disable Windows logging of a Windows event channel",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.002"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Enabled",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000000)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_wevutil": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\system32\\wevtutil.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_iis": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Windows\\winsxs\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\TiWorker.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_svchost": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\System32\\svchost.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\Microsoft-Windows-FileInfoMinifilter",
                  "\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\Microsoft-Windows-ASN1\\",
                  "\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\Microsoft-Windows-Kernel-AppCompat\\",
                  "\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\Microsoft-Windows-Runtime\\Error\\",
                  "\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\Microsoft-Windows-CAPI2/Operational\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_trusted_installer": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\servicing\\TrustedInstaller.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels\\Microsoft-Windows-Compat-Appraiser",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_empty": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_null": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1562.002"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-07-04",
        "modified": "2024-03-25",
        "references": [
          "https://twitter.com/WhichbufferArda/status/1543900539280293889",
          "https://github.com/DebugPrivilege/CPP/blob/c39d365617dbfbcb01fffad200d52b6239b2918c/Windows%20Defender/RestoreDefenderConfig.cpp"
        ],
        "falsepositives": [
          "Rare falsepositives may occur from legitimate administrators disabling specific event log for troubleshooting"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_disable_winevt_logging.yml"
      }
    },
    {
      "id": "b7916c2a-fa2f-4795-9477-32b731f70f11",
      "title": "Registry Persistence via Explorer Run Key",
      "status": "test",
      "description": "Detects a possible persistence mechanism using RUN key for Windows Explorer and pointing to a suspicious folder",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__contains": {
                "field": "Details",
                "value": [
                  ":\\$Recycle.bin\\",
                  ":\\ProgramData\\",
                  ":\\Temp\\",
                  ":\\Users\\Default\\",
                  ":\\Users\\Public\\",
                  ":\\Windows\\Temp\\",
                  "\\AppData\\Local\\Temp\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1547.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), oscd.community",
        "date": "2018-07-18",
        "modified": "2023-12-11",
        "references": [
          "https://researchcenter.paloaltonetworks.com/2018/07/unit42-upatre-continues-evolve-new-anti-analysis-techniques/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_susp_reg_persist_explorer_run.yml"
      }
    },
    {
      "id": "d4e2745c-f0c6-4bde-a3ab-b553b3f693cc",
      "title": "Persistence Via Disk Cleanup Handler - Autorun",
      "status": "test",
      "description": "Detects when an attacker modifies values of the Disk Cleanup Handler in the registry to achieve persistence via autorun.\nThe disk cleanup manager is part of the operating system.\nIt displays the dialog box [] The user has the option of enabling or disabling individual handlers by selecting or clearing their check box in the disk cleanup manager's UI.\nAlthough Windows comes with a number of disk cleanup handlers, they aren't designed to handle files produced by other applications.\nInstead, the disk cleanup manager is designed to be flexible and extensible by enabling any developer to implement and register their own disk cleanup handler.\nAny developer can extend the available disk cleanup services by implementing and registering a disk cleanup handler.\n",
      "level": "medium",
      "tags": [
        "attack.persistence"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "root": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\VolumeCaches\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_autorun": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Autorun",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000001)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_pre_after": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\CleanupString",
                  "\\PreCleanupString"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "Details__contains": {
                "field": "Details",
                "value": [
                  "cmd",
                  "powershell",
                  "rundll32",
                  "mshta",
                  "cscript",
                  "wscript",
                  "wsl",
                  "\\Users\\Public\\",
                  "\\Windows\\TEMP\\",
                  "\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "root and 1 of selection_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "root"
            },
            {
              "type": "ref",
              "value": "1 of selection_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-07-21",
        "modified": "2023-08-17",
        "references": [
          "https://persistence-info.github.io/Data/diskcleanuphandler.html",
          "https://www.hexacorn.com/blog/2018/09/02/beyond-good-ol-run-key-part-86/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_disk_cleanup_handler_autorun_persistence.yml"
      }
    },
    {
      "id": "42205c73-75c8-4a63-9db1-e3782e06fda0",
      "title": "Suspicious Application Allowed Through Exploit Guard",
      "status": "test",
      "description": "Detects applications being added to the \"allowed applications\" list of exploit guard in order to bypass controlled folder settings",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_key": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "SOFTWARE\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\Controlled Folder Access\\AllowedApplications",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_paths": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Users\\Public\\",
                  "\\AppData\\Local\\Temp\\",
                  "\\Desktop\\",
                  "\\PerfLogs\\",
                  "\\Windows\\Temp\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-05",
        "modified": "2023-08-17",
        "references": [
          "https://www.microsoft.com/security/blog/2017/10/23/windows-defender-exploit-guard-reduce-the-attack-surface-against-next-generation-malware/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_exploit_guard_susp_allowed_apps.yml"
      }
    },
    {
      "id": "25ffa65d-76d8-4da5-a832-3f2b0136e133",
      "title": "PUA - Sysinternal Tool Execution - Registry",
      "status": "test",
      "description": "Detects the execution of a Sysinternals Tool via the creation of the \"accepteula\" registry key",
      "level": "low",
      "tags": [
        "attack.resource-development",
        "attack.t1588.002"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\EulaAccepted",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1588.002"
        ],
        "tactics": [
          "resource_development"
        ]
      },
      "meta": {
        "author": "Markus Neis",
        "date": "2017-08-28",
        "modified": "2025-10-26",
        "references": [
          "https://twitter.com/Moti_B/status/1008587936735035392"
        ],
        "falsepositives": [
          "Legitimate use of SysInternals tools",
          "Programs that use the same Registry Key"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_pua_sysinternals_execution_via_eula.yml"
      }
    },
    {
      "id": "60936b49-fca0-4f32-993d-7415edcf9a5d",
      "title": "New Application in AppCompat",
      "status": "test",
      "description": "A General detection for a new application in AppCompat. This indicates an application executing for the first time on an endpoint.",
      "level": "informational",
      "tags": [
        "attack.execution",
        "attack.t1204.002"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\AppCompatFlags\\Compatibility Assistant\\Store\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1204.002"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
        "date": "2020-05-02",
        "modified": "2023-08-17",
        "references": [
          "https://github.com/OTRF/detection-hackathon-apt29/issues/1",
          "https://github.com/OTRF/ThreatHunter-Playbook/blob/2d4257f630f4c9770f78d0c1df059f891ffc3fec/docs/evals/apt29/detections/1.A.1_DFD6A782-9BDB-4550-AB6B-525E825B095E.md"
        ],
        "falsepositives": [
          "This rule is to explore new applications on an endpoint. False positives depends on the organization.",
          "Newly setup system.",
          "Legitimate installation of new application."
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_new_application_appcompat.yml"
      }
    },
    {
      "id": "40b6e656-4e11-4c0c-8772-c1cc6dae34ce",
      "title": "ScreenSaver Registry Key Set",
      "status": "test",
      "description": "Detects registry key established after masqueraded .scr file execution using Rundll32 through desk.cpl",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218.011"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\rundll32.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "registry": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Control Panel\\Desktop\\SCRNSAVE.EXE",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__endswith": {
                "field": "Details",
                "value": ".scr",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Details__contains": {
                "field": "Details",
                "value": [
                  "C:\\Windows\\System32\\",
                  "C:\\Windows\\SysWOW64\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and registry and not filter",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "ref",
              "value": "registry"
            },
            {
              "type": "not",
              "value": "filter"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1218.011"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Jose Luis Sanchez Martinez (@Joseliyo_Jstnk)",
        "date": "2022-05-04",
        "modified": "2023-08-17",
        "references": [
          "https://twitter.com/VakninHai/status/1517027824984547329",
          "https://twitter.com/pabraeken/status/998627081360695297",
          "https://jstnk9.github.io/jstnk9/research/InstallScreenSaver-SCR-files"
        ],
        "falsepositives": [
          "Legitimate use of screen saver"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_scr_file_executed_by_rundll32.yml"
      }
    },
    {
      "id": "ad89044a-8f49-4673-9a55-cbd88a1b374f",
      "title": "Enabling COR Profiler Environment Variables",
      "status": "test",
      "description": "Detects .NET Framework CLR and .NET Core CLR \"cor_enable_profiling\" and \"cor_profiler\" variables being set and configured.",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.privilege-escalation",
        "attack.defense-evasion",
        "attack.t1574.012"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_1": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "\\COR_ENABLE_PROFILING",
                  "\\COR_PROFILER",
                  "\\CORECLR_ENABLE_PROFILING"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_2": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\CORECLR_PROFILER_PATH",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1574.012"
        ],
        "tactics": [
          "persistence",
          "privilege_escalation",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Jose Rodriguez (@Cyb3rPandaH), OTR (Open Threat Research), Jimmy Bayne (@bohops)",
        "date": "2020-09-10",
        "modified": "2023-11-24",
        "references": [
          "https://twitter.com/jamieantisocial/status/1304520651248668673",
          "https://www.slideshare.net/JamieWilliams130/started-from-the-bottom-exploiting-data-sources-to-uncover-attck-behaviors",
          "https://www.sans.org/cyber-security-summit/archives",
          "https://learn.microsoft.com/en-us/dotnet/core/runtime-config/debugging-profiling"
        ],
        "falsepositives": [],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_enabling_cor_profiler_env_variables.yml"
      }
    },
    {
      "id": "e88a6ddc-74f7-463b-9b26-f69fc0d2ce85",
      "title": "New TimeProviders Registered With Uncommon DLL Name",
      "status": "test",
      "description": "Detects processes setting a new DLL in DllName in under HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\W32Time\\TimeProvider.\nAdversaries may abuse time providers to execute DLLs when the system boots.\nThe Windows Time service (W32Time) enables time synchronization across and within domains.\n",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.privilege-escalation",
        "attack.t1547.003"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Services\\W32Time\\TimeProviders",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\DllName",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_w32time": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": [
                  "%SystemRoot%\\System32\\vmictimeprovider.dll",
                  "%systemroot%\\system32\\w32time.dll",
                  "C:\\Windows\\SYSTEM32\\w32time.DLL"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1547.003"
        ],
        "tactics": [
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-06-19",
        "modified": "2024-03-26",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.003/T1547.003.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_timeproviders_dllname.yml"
      }
    },
    {
      "id": "086ae989-9ca6-4fe7-895a-759c5544f247",
      "title": "Potential Persistence Via TypedPaths",
      "status": "test",
      "description": "Detects modification addition to the 'TypedPaths' key in the user or admin registry from a non standard application. Which might indicate persistence attempt",
      "level": "high",
      "tags": [
        "attack.persistence"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\TypedPaths\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Windows\\explorer.exe",
                  "C:\\Windows\\SysWOW64\\explorer.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-22",
        "modified": "2023-08-17",
        "references": [
          "https://twitter.com/dez_/status/1560101453150257154",
          "https://forensafe.com/blogs/typedpaths.html"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_persistence_typed_paths.yml"
      }
    },
    {
      "id": "d88d0ab2-e696-4d40-a2ed-9790064e66b3",
      "title": "Modification of IE Registry Settings",
      "status": "test",
      "description": "Detects modification of the registry settings used for Internet Explorer and other Windows components that use these settings. An attacker can abuse this registry key to add a domain to the trusted sites Zone or insert JavaScript for persistence",
      "level": "low",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_domains": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_dword": {
            "type": "field_match",
            "matchers": {
              "Details__startswith": {
                "field": "Details",
                "value": "DWORD",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_null": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_office": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": [
                  "Cookie:",
                  "Visited:",
                  "(Empty)"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_path": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Cache",
                  "\\ZoneMap",
                  "\\WpadDecision"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_binary": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": "Binary Data",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_accepted_documents": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Accepted Documents",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection_domains and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_domains"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-22",
        "modified": "2025-10-22",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1112/T1112.md#atomic-test-4---add-domain-to-trusted-sites-zone",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1112/T1112.md#atomic-test-5---javascript-in-registry"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_persistence_ie.yml"
      }
    },
    {
      "id": "9b0f8a61-91b2-464f-aceb-0527e0a45020",
      "title": "Potential COM Object Hijacking Via TreatAs Subkey - Registry",
      "status": "test",
      "description": "Detects COM object hijacking via TreatAs subkey",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1546.015"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains_all": {
                "field": "TargetObject",
                "value": [
                  "HKU\\",
                  "Classes\\CLSID\\",
                  "\\TreatAs"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_svchost": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\WINDOWS\\system32\\svchost.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1546.015"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Kutepov Anton, oscd.community",
        "date": "2019-10-23",
        "modified": "2025-10-26",
        "references": [
          "https://bohops.com/2018/08/18/abusing-the-com-registry-structure-part-2-loading-techniques-for-evasion-and-persistence/"
        ],
        "falsepositives": [
          "Maybe some system utilities in rare cases use linking keys for backward compatibility"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_persistence_com_key_linking.yml"
      }
    },
    {
      "id": "e78c408a-e2ea-43cd-b5ea-51975cf358c0",
      "title": "Disable Windows Firewall by Registry",
      "status": "test",
      "description": "Detect set EnableFirewall to 0 to disable the Windows firewall",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.004"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\StandardProfile\\EnableFirewall",
                  "\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\EnableFirewall"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000000)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-08-19",
        "modified": "2023-08-17",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1562.004/T1562.004.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_disable_windows_firewall.yml"
      }
    },
    {
      "id": "b64a026b-8deb-4c1d-92fd-98893209dff1",
      "title": "Running Chrome VPN Extensions via the Registry 2 VPN Extension",
      "status": "test",
      "description": "Running Chrome VPN Extensions via the Registry install 2 vpn extension",
      "level": "high",
      "tags": [
        "attack.initial-access",
        "attack.persistence",
        "attack.t1133"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "chrome_ext": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "Software\\Wow6432Node\\Google\\Chrome\\Extensions",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "update_url",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "chrome_vpn": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "fdcgdnkidjaadafnichfpabhfomcebme",
                  "fcfhplploccackoneaefokcmbjfbkenj",
                  "bihmplhobchoageeokmgbdihknkjbknd",
                  "gkojfkhlekighikafcpjkiklfbnlmeio",
                  "jajilbjjinjmgcibalaakngmkilboobh",
                  "gjknjjomckknofjidppipffbpoekiipm",
                  "nabbmpekekjknlbkgpodfndbodhijjem",
                  "kpiecbcckbofpmkkkdibbllpinceiihk",
                  "nlbejmccbhkncgokjcmghpfloaajcffj",
                  "omghfjlpggmjjaagoclmmobgdodcjboh",
                  "bibjcjfmgapbfoljiojpipaooddpkpai",
                  "mpcaainmfjjigeicjnlkdfajbioopjko",
                  "jljopmgdobloagejpohpldgkiellmfnc",
                  "lochiccbgeohimldjooaakjllnafhaid",
                  "nhnfcgpcbfclhfafjlooihdfghaeinfc",
                  "ookhnhpkphagefgdiemllfajmkdkcaim",
                  "namfblliamklmeodpcelkokjbffgmeoo",
                  "nbcojefnccbanplpoffopkoepjmhgdgh",
                  "majdfhpaihoncoakbjgbdhglocklcgno",
                  "lnfdmdhmfbimhhpaeocncdlhiodoblbd",
                  "eppiocemhmnlbhjplcgkofciiegomcon",
                  "cocfojppfigjeefejbpfmedgjbpchcng",
                  "foiopecknacmiihiocgdjgbjokkpkohc",
                  "hhdobjgopfphlmjbmnpglhfcgppchgje",
                  "jgbaghohigdbgbolncodkdlpenhcmcge",
                  "inligpkjkhbpifecbdjhmdpcfhnlelja",
                  "higioemojdadgdbhbbbkfbebbdlfjbip",
                  "hipncndjamdcmphkgngojegjblibadbe",
                  "iolonopooapdagdemdoaihahlfkncfgg",
                  "nhfjkakglbnnpkpldhjmpmmfefifedcj",
                  "jpgljfpmoofbmlieejglhonfofmahini",
                  "fgddmllnllkalaagkghckoinaemmogpe",
                  "ejkaocphofnobjdedneohbbiilggdlbi",
                  "keodbianoliadkoelloecbhllnpiocoi",
                  "hoapmlpnmpaehilehggglehfdlnoegck",
                  "poeojclicodamonabcabmapamjkkmnnk",
                  "dfkdflfgjdajbhocmfjolpjbebdkcjog",
                  "kcdahmgmaagjhocpipbodaokikjkampi",
                  "klnkiajpmpkkkgpgbogmcgfjhdoljacg",
                  "lneaocagcijjdpkcabeanfpdbmapcjjg",
                  "pgfpignfckbloagkfnamnolkeaecfgfh",
                  "jplnlifepflhkbkgonidnobkakhmpnmh",
                  "jliodmnojccaloajphkingdnpljdhdok",
                  "hnmpcagpplmpfojmgmnngilcnanddlhb",
                  "ffbkglfijbcbgblgflchnbphjdllaogb",
                  "kcndmbbelllkmioekdagahekgimemejo",
                  "jdgilggpfmjpbodmhndmhojklgfdlhob",
                  "bihhflimonbpcfagfadcnbbdngpopnjb",
                  "ppajinakbfocjfnijggfndbdmjggcmde",
                  "oofgbpoabipfcfjapgnbbjjaenockbdp",
                  "bhnhkdgoefpmekcgnccpnhjfdgicfebm",
                  "knmmpciebaoojcpjjoeonlcjacjopcpf",
                  "dhadilbmmjiooceioladdphemaliiobo",
                  "jedieiamjmoflcknjdjhpieklepfglin",
                  "mhngpdlhojliikfknhfaglpnddniijfh",
                  "omdakjcmkglenbhjadbccaookpfjihpa",
                  "npgimkapccfidfkfoklhpkgmhgfejhbj",
                  "akeehkgglkmpapdnanoochpfmeghfdln",
                  "gbmdmipapolaohpinhblmcnpmmlgfgje",
                  "aigmfoeogfnljhnofglledbhhfegannp",
                  "cgojmfochfikphincbhokimmmjenhhgk",
                  "ficajfeojakddincjafebjmfiefcmanc",
                  "ifnaibldjfdmaipaddffmgcmekjhiloa",
                  "jbnmpdkcfkochpanomnkhnafobppmccn",
                  "apcfdffemoinopelidncddjbhkiblecc",
                  "mjolnodfokkkaichkcjipfgblbfgojpa",
                  "oifjbnnafapeiknapihcmpeodaeblbkn",
                  "plpmggfglncceinmilojdkiijhmajkjh",
                  "mjnbclmflcpookeapghfhapeffmpodij",
                  "bblcccknbdbplgmdjnnikffefhdlobhp",
                  "aojlhgbkmkahabcmcpifbolnoichfeep",
                  "lcmammnjlbmlbcaniggmlejfjpjagiia",
                  "knajdeaocbpmfghhmijicidfcmdgbdpm",
                  "bdlcnpceagnkjnjlbbbcepohejbheilk",
                  "edknjdjielmpdlnllkdmaghlbpnmjmgb",
                  "eidnihaadmmancegllknfbliaijfmkgo",
                  "ckiahbcmlmkpfiijecbpflfahoimklke",
                  "macdlemfnignjhclfcfichcdhiomgjjb",
                  "chioafkonnhbpajpengbalkececleldf",
                  "amnoibeflfphhplmckdbiajkjaoomgnj",
                  "llbhddikeonkpbhpncnhialfbpnilcnc",
                  "pcienlhnoficegnepejpfiklggkioccm",
                  "iocnglnmfkgfedpcemdflhkchokkfeii",
                  "igahhbkcppaollcjeaaoapkijbnphfhb",
                  "njpmifchgidinihmijhcfpbdmglecdlb",
                  "ggackgngljinccllcmbgnpgpllcjepgc",
                  "kchocjcihdgkoplngjemhpplmmloanja",
                  "bnijmipndnicefcdbhgcjoognndbgkep",
                  "lklekjodgannjcccdlbicoamibgbdnmi",
                  "dbdbnchagbkhknegmhgikkleoogjcfge",
                  "egblhcjfjmbjajhjhpmnlekffgaemgfh",
                  "ehbhfpfdkmhcpaehaooegfdflljcnfec",
                  "bkkgdjpomdnfemhhkalfkogckjdkcjkg",
                  "almalgbpmcfpdaopimbdchdliminoign",
                  "akkbkhnikoeojlhiiomohpdnkhbkhieh",
                  "gbfgfbopcfokdpkdigfmoeaajfmpkbnh",
                  "bniikohfmajhdcffljgfeiklcbgffppl",
                  "lejgfmmlngaigdmmikblappdafcmkndb",
                  "ffhhkmlgedgcliajaedapkdfigdobcif",
                  "gcknhkkoolaabfmlnjonogaaifnjlfnp",
                  "pooljnboifbodgifngpppfklhifechoe",
                  "fjoaledfpmneenckfbpdfhkmimnjocfa",
                  "aakchaleigkohafkfjfjbblobjifikek",
                  "dpplabbmogkhghncfbfdeeokoefdjegm",
                  "padekgcemlokbadohgkifijomclgjgif",
                  "bfidboloedlamgdmenmlbipfnccokknp"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of chrome_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "chrome_"
        }
      },
      "mitre": {
        "techniques": [
          "T1133"
        ],
        "tactics": [
          "initial_access",
          "persistence"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-12-28",
        "modified": "2023-08-17",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1133/T1133.md#atomic-test-1---running-chrome-vpn-extensions-via-the-registry-2-vpn-extension"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_chrome_extension.yml"
      }
    },
    {
      "id": "4f281b83-0200-4b34-bf35-d24687ea57c2",
      "title": "ETW Logging Disabled For SCM",
      "status": "test",
      "description": "Detects changes to the \"TracingDisabled\" key in order to disable ETW logging for services.exe (SCM)",
      "level": "low",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112",
        "attack.t1562"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "Software\\Microsoft\\Windows NT\\CurrentVersion\\Tracing\\SCM\\Regular\\TracingDisabled",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000001)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1112",
          "T1562"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-12-09",
        "modified": "2023-08-17",
        "references": [
          "http://redplait.blogspot.com/2020/07/whats-wrong-with-etw.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_services_etw_tamper.yml"
      }
    },
    {
      "id": "f59c3faf-50f3-464b-9f4c-1b67ab512d99",
      "title": "Common Autorun Keys Modification",
      "status": "test",
      "description": "Detects modification of autostart extensibility point (ASEP) in registry.",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows CE Services\\AutoStart",
                  "\\Software\\Wow6432Node\\Microsoft\\Command Processor\\Autorun",
                  "\\SOFTWARE\\Wow6432Node\\Microsoft\\Active Setup\\Installed Components",
                  "\\SOFTWARE\\Microsoft\\Windows CE Services\\AutoStartOnDisconnect",
                  "\\SOFTWARE\\Microsoft\\Windows CE Services\\AutoStartOnConnect",
                  "\\SYSTEM\\Setup\\CmdLine",
                  "\\Software\\Microsoft\\Ctf\\LangBarAddin",
                  "\\Software\\Microsoft\\Command Processor\\Autorun",
                  "\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components",
                  "\\SOFTWARE\\Classes\\Protocols\\Handler",
                  "\\SOFTWARE\\Classes\\Protocols\\Filter",
                  "\\SOFTWARE\\Classes\\Htmlfile\\Shell\\Open\\Command\\(Default)",
                  "\\Environment\\UserInitMprLogonScript",
                  "\\SOFTWARE\\Policies\\Microsoft\\Windows\\Control Panel\\Desktop\\Scrnsave.exe",
                  "\\Software\\Microsoft\\Internet Explorer\\UrlSearchHooks",
                  "\\SOFTWARE\\Microsoft\\Internet Explorer\\Desktop\\Components",
                  "\\Software\\Classes\\Clsid\\{AB8902B4-09CA-4bb6-B78D-A8F59079A8D5}\\Inprocserver32",
                  "\\Control Panel\\Desktop\\Scrnsave.exe"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_empty": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": "(Empty)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_null": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_poqexec": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\System32\\poqexec.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_msoffice": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "TargetObject__contains": {
                    "field": "TargetObject",
                    "value": [
                      "\\Office\\ClickToRun\\REGISTRY\\MACHINE\\Software\\Classes\\PROTOCOLS\\Handler\\",
                      "\\ClickToRunStore\\HKMU\\SOFTWARE\\Classes\\PROTOCOLS\\Handler\\"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Details": {
                    "field": "Details",
                    "value": [
                      "{314111c7-a502-11d2-bbca-00c04f8ec294}",
                      "{3459B272-CC19-4448-86C9-DDC3B4B2FAD3}",
                      "{42089D2D-912D-4018-9087-2B87803E93FB}",
                      "{5504BE45-A83B-4808-900A-3A5C36E7F77A}",
                      "{807583E5-5146-11D5-A672-00B0D022E945}"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "filter_optional_chrome": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{8A69D345-D564-463c-AFF1-A69D9E530F96}",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_edge": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{9459C573-B17A-45AE-9F64-1857B5D58CEE}",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_IE": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Software\\Microsoft\\Active Setup\\Installed Components\\{89820200-ECBD-11cf-8B85-00AA005B4383}",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_integrator": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\Microsoft Office\\root\\integration\\integrator.exe",
                  "C:\\Program Files\\Microsoft Office\\root\\integration\\integrator.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_office": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\",
                  "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\Updates\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\OfficeClickToRun.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1547.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split), wagga (name)",
        "date": "2019-10-25",
        "modified": "2025-10-22",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md",
          "https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns",
          "https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d",
          "https://persistence-info.github.io/Data/userinitmprlogonscript.html"
        ],
        "falsepositives": [
          "Legitimate software automatically (mostly, during installation) sets up autorun keys for legitimate reason",
          "Legitimate administrator sets up autorun keys for legitimate reason"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_common.yml"
      }
    },
    {
      "id": "ba226dcf-d390-4642-b9af-b534872f1156",
      "title": "Windows Event Log Access Tampering Via Registry",
      "status": "experimental",
      "description": "Detects changes to the Windows EventLog channel permission values. It focuses on changes to the Security Descriptor Definition Language (SDDL) string, as modifications to these values can restrict access to specific users or groups, potentially aiding in defense evasion by controlling who can view or modify a event log channel. Upon execution, the user shouldn't be able to access the event log channel via the event viewer or via utilities such as \"Get-EventLog\" or \"wevtutil\".\n",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1547.001",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_key_1": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\SYSTEM\\CurrentControlSet\\Services\\EventLog\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\CustomSD",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_key_2": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Policies\\Microsoft\\Windows\\EventLog\\",
                  "\\Microsoft\\Windows\\CurrentVersion\\WINEVT\\Channels"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\ChannelAccess",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_details": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Details__contains": {
                    "field": "Details",
                    "value": "D:(D;",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Details__contains_all": {
                    "field": "Details",
                    "value": [
                      "D:(",
                      ")(D;"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {
          "filter_main_trustedinstaller": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\servicing\\TrustedInstaller.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_tiworker": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Windows\\WinSxS\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\TiWorker.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_empty": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_null": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "1 of selection_key_* and selection_details and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "1 of selection_key_*"
            },
            {
              "type": "ref",
              "value": "selection_details"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1547.001",
          "T1112"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "X__Junior",
        "date": "2025-01-16",
        "modified": "2025-08-16",
        "references": [
          "https://www.atomicredteam.io/atomic-red-team/atomics/T1562.002#atomic-test-8---modify-event-log-channel-access-permissions-via-registry---powershell",
          "https://www.youtube.com/watch?v=uSYvHUVU8xY",
          "https://learn.microsoft.com/en-us/windows/win32/secauthz/security-descriptor-definition-language"
        ],
        "falsepositives": [
          "Administrative activity, still unlikely"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_disable_windows_event_log_access.yml"
      }
    },
    {
      "id": "5df86130-4e95-4a54-90f7-26541b40aec2",
      "title": "Registry Modification to Hidden File Extension",
      "status": "test",
      "description": "Hides the file extension through modification of the registry",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.t1137"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_HideFileExt": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\HideFileExt",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000001)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_Hidden": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\Hidden",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000002)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1137"
        ],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-22",
        "modified": "2023-08-17",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1112/T1112.md#atomic-test-1---modify-registry-of-current-user-profile---cmd",
          "https://unit42.paloaltonetworks.com/ransomware-families/",
          "https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?name=TrojanSpy%3aMSIL%2fHakey.A"
        ],
        "falsepositives": [
          "Administrative scripts"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_hidden_extention.yml"
      }
    },
    {
      "id": "c420410f-c2d8-4010-856b-dffe21866437",
      "title": "Enable LM Hash Storage",
      "status": "test",
      "description": "Detects changes to the \"NoLMHash\" registry value in order to allow Windows to store LM Hashes.\nBy setting this registry value to \"0\" (DWORD), Windows will be allowed to store a LAN manager hash of your password in Active Directory and local SAM databases.\n",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "System\\CurrentControlSet\\Control\\Lsa\\NoLMHash",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000000)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-12-15",
        "modified": "",
        "references": [
          "https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-347a",
          "https://learn.microsoft.com/en-us/troubleshoot/windows-server/windows-security/prevent-windows-store-lm-hash-password",
          "https://www.sans.org/blog/protecting-privileged-domain-accounts-lm-hashes-the-good-the-bad-and-the-ugly/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_system_lsa_nolmhash.yml"
      }
    },
    {
      "id": "833ef470-fa01-4631-a79b-6f291c9ac498",
      "title": "Add Debugger Entry To Hangs Key For Persistence",
      "status": "test",
      "description": "Detects when an attacker adds a new \"Debugger\" value to the \"Hangs\" key in order to achieve persistence which will get invoked when an application crashes",
      "level": "high",
      "tags": [
        "attack.persistence"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\Microsoft\\Windows\\Windows Error Reporting\\Hangs\\Debugger",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-07-21",
        "modified": "2023-08-17",
        "references": [
          "https://persistence-info.github.io/Data/wer_debugger.html",
          "https://www.hexacorn.com/blog/2019/09/20/beyond-good-ol-run-key-part-116/"
        ],
        "falsepositives": [
          "This value is not set by default but could be rarly used by administrators"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_hangs_debugger_persistence.yml"
      }
    },
    {
      "id": "0cb8d736-995d-4ce7-a31e-1e8d452a1459",
      "title": "Potential EventLog File Location Tampering",
      "status": "test",
      "description": "Detects tampering with EventLog service \"file\" key. In order to change the default location of an Evtx file. This technique is used to tamper with log collection and alerting",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.002"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\SYSTEM\\CurrentControlSet\\Services\\EventLog\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\File",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Details__contains": {
                "field": "Details",
                "value": "\\System32\\Winevt\\Logs\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.002"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "D3F7A5105",
        "date": "2023-01-02",
        "modified": "2023-08-17",
        "references": [
          "https://learn.microsoft.com/en-us/windows/win32/eventlog/eventlog-key"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_evtx_file_key_tamper.yml"
      }
    },
    {
      "id": "3aff0be0-7802-4a7e-a4fa-c60c74bc5e1d",
      "title": "Lolbas OneDriveStandaloneUpdater.exe Proxy Download",
      "status": "test",
      "description": "Detects setting a custom URL for OneDriveStandaloneUpdater.exe to download a file from the Internet without executing any\nanomalous executables with suspicious arguments. The downloaded file will be in C:\\Users\\redacted\\AppData\\Local\\Microsoft\\OneDrive\\StandaloneUpdaterreSignInSettingsConfig.json\n",
      "level": "high",
      "tags": [
        "attack.command-and-control",
        "attack.t1105"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\Microsoft\\OneDrive\\UpdateOfficeConfig\\UpdateRingSettingURLFromOC",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1105"
        ],
        "tactics": [
          "command_and_control"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-05-28",
        "modified": "2023-08-17",
        "references": [
          "https://lolbas-project.github.io/lolbas/Binaries/OneDriveStandaloneUpdater/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_lolbin_onedrivestandaloneupdater.yml"
      }
    },
    {
      "id": "e6fe26ee-d063-4f5b-b007-39e90aaf50e3",
      "title": "Potential Persistence Via AutodialDLL",
      "status": "test",
      "description": "Detects change the the \"AutodialDLL\" key which could be used as a persistence method to load custom DLL via the \"ws2_32\" library",
      "level": "high",
      "tags": [
        "attack.persistence"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Services\\WinSock2\\Parameters\\AutodialDLL",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-10",
        "modified": "2023-08-17",
        "references": [
          "https://www.hexacorn.com/blog/2015/01/13/beyond-good-ol-run-key-part-24/",
          "https://persistence-info.github.io/Data/autodialdll.html"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_persistence_autodial_dll.yml"
      }
    },
    {
      "id": "3ae1a046-f7db-439d-b7ce-b8b366b81fa6",
      "title": "Disable Windows Security Center Notifications",
      "status": "test",
      "description": "Detect set UseActionCenterExperience to 0 to disable the Windows security center notification",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "Windows\\CurrentVersion\\ImmersiveShell\\UseActionCenterExperience",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000000)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-08-19",
        "modified": "2023-08-17",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1112/T1112.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_disable_security_center_notifications.yml"
      }
    },
    {
      "id": "0442defa-b4a2-41c9-ae2c-ea7042fc4701",
      "title": "Potential Credential Dumping Attempt Using New NetworkProvider - REG",
      "status": "test",
      "description": "Detects when an attacker tries to add a new network provider in order to dump clear text credentials, similar to how the NPPSpy tool does it",
      "level": "medium",
      "tags": [
        "attack.credential-access",
        "attack.t1003"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains_all": {
                "field": "TargetObject",
                "value": [
                  "\\System\\CurrentControlSet\\Services\\",
                  "\\NetworkProvider"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\System\\CurrentControlSet\\Services\\WebClient\\NetworkProvider",
                  "\\System\\CurrentControlSet\\Services\\LanmanWorkstation\\NetworkProvider",
                  "\\System\\CurrentControlSet\\Services\\RDPNP\\NetworkProvider"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_valid_procs": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\System32\\poqexec.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1003"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-23",
        "modified": "2023-08-17",
        "references": [
          "https://learn.microsoft.com/en-us/troubleshoot/windows-client/setup-upgrade-and-drivers/network-provider-settings-removed-in-place-upgrade",
          "https://github.com/gtworek/PSBits/tree/master/PasswordStealing/NPPSpy"
        ],
        "falsepositives": [
          "Other legitimate network providers used and not filtred in this rule"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_new_network_provider.yml"
      }
    },
    {
      "id": "a7df0e9e-91a5-459a-a003-4cde67c2ff5d",
      "title": "Potentially Suspicious Command Executed Via Run Dialog Box - Registry",
      "status": "test",
      "description": "Detects execution of commands via the run dialog box on Windows by checking values of the \"RunMRU\" registry key.\nThis technique was seen being abused by threat actors to deceive users into pasting and executing malicious commands, often disguised as CAPTCHA verification steps.\n",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1059.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_key": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RunMRU",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_powershell_command": {
            "type": "field_match",
            "matchers": {
              "Details__contains": {
                "field": "Details",
                "value": [
                  "powershell",
                  "pwsh"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_powershell_susp_keywords": {
            "type": "field_match",
            "matchers": {
              "Details__contains": {
                "field": "Details",
                "value": [
                  " -e ",
                  " -ec ",
                  " -en ",
                  " -enc ",
                  " -enco",
                  "ftp",
                  "Hidden",
                  "http",
                  "iex",
                  "Invoke-"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_wmic_command": {
            "type": "field_match",
            "matchers": {
              "Details__contains": {
                "field": "Details",
                "value": "wmic",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_wmic_susp_keywords": {
            "type": "field_match",
            "matchers": {
              "Details__contains": {
                "field": "Details",
                "value": [
                  "shadowcopy",
                  "process call create"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_key and (all of selection_powershell_* or all of selection_wmic_*)",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection_key and (all of selection_powershell_*",
            "all of selection_wmic_*)"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Ahmed Farouk, Nasreddine Bencherchali",
        "date": "2024-11-01",
        "modified": "",
        "references": [
          "https://medium.com/@ahmed.moh.farou2/fake-captcha-campaign-on-arabic-pirated-movie-sites-delivers-lumma-stealer-4f203f7adabf",
          "https://medium.com/@shaherzakaria8/downloading-trojan-lumma-infostealer-through-capatcha-1f25255a0e71",
          "https://www.forensafe.com/blogs/runmrukey.html",
          "https://redcanary.com/blog/threat-intelligence/intelligence-insights-october-2024/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_runmru_susp_command_execution.yml"
      }
    },
    {
      "id": "b61e87c0-50db-4b2e-8986-6a2be94b33b0",
      "title": "Directory Service Restore Mode(DSRM) Registry Value Tampering",
      "status": "test",
      "description": "Detects changes to \"DsrmAdminLogonBehavior\" registry value.\nDuring a Domain Controller (DC) promotion, administrators create a Directory Services Restore Mode (DSRM) local administrator account with a password that rarely changes. The DSRM account is an Administrator account that logs in with the DSRM mode when the server is booting up to restore AD backups or recover the server from a failure.\nAttackers could abuse DSRM account to maintain their persistence and access to the organization's Active Directory.\nIf the \"DsrmAdminLogonBehavior\" value is set to \"0\", the administrator account can only be used if the DC starts in DSRM.\nIf the \"DsrmAdminLogonBehavior\" value is set to \"1\", the administrator account can only be used if the local AD DS service is stopped.\nIf the \"DsrmAdminLogonBehavior\" value is set to \"2\", the administrator account can always be used.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.credential-access",
        "attack.persistence",
        "attack.t1556"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Control\\Lsa\\DsrmAdminLogonBehavior",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_default_value": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000000)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1556"
        ],
        "tactics": [
          "defense_evasion",
          "credential_access",
          "persistence"
        ]
      },
      "meta": {
        "author": "Nischal Khadgi",
        "date": "2024-07-11",
        "modified": "",
        "references": [
          "https://adsecurity.org/?p=1785",
          "https://www.sentinelone.com/blog/detecting-dsrm-account-misconfigurations/",
          "https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/dsrm-credentials"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_dsrm_tampering.yml"
      }
    },
    {
      "id": "3f6b7b62-61aa-45db-96bd-9c31b36b653c",
      "title": "RDP Sensitive Settings Changed",
      "status": "test",
      "description": "Detects tampering of RDP Terminal Service/Server sensitive settings.\nSuch as allowing unauthorized users access to a system via the 'fAllowUnsolicited' or enabling RDP via 'fDenyTSConnections', etc.\n\nBelow is a list of registry keys/values that are monitored by this rule:\n\n- Shadow: Used to enable Remote Desktop shadowing, which allows an administrator to view or control a user's session.\n- DisableRemoteDesktopAntiAlias: Disables anti-aliasing for remote desktop sessions.\n- DisableSecuritySettings: Disables certain security settings for Remote Desktop connections.\n- fAllowUnsolicited: Allows unsolicited remote assistance offers.\n- fAllowUnsolicitedFullControl: Allows unsolicited remote assistance offers with full control.\n- InitialProgram: Specifies a program to run automatically when a user logs on to a remote computer.\n- ServiceDll: Used in RDP hijacking techniques to specify a custom DLL to be loaded by the Terminal Services service.\n- SecurityLayer: Specifies the security layer used for RDP connections.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.persistence",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_shadow": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Control\\Terminal Server\\",
                  "\\Windows NT\\Terminal Services\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Shadow",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": [
                  "DWORD (0x00000001)",
                  "DWORD (0x00000002)",
                  "DWORD (0x00000003)",
                  "DWORD (0x00000004)"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_terminal_services_key": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Control\\Terminal Server\\",
                  "\\Windows NT\\Terminal Services\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "\\DisableRemoteDesktopAntiAlias",
                  "\\DisableSecuritySettings",
                  "\\fAllowUnsolicited",
                  "\\fAllowUnsolicitedFullControl"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000001)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_tamper_only": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Control\\Terminal Server\\InitialProgram",
                  "\\Control\\Terminal Server\\WinStations\\RDP-Tcp\\InitialProgram",
                  "\\services\\TermService\\Parameters\\ServiceDll",
                  "\\Terminal Server\\WinStations\\RDP-Tcp\\SecurityLayer",
                  "\\Windows NT\\Terminal Services\\InitialProgram"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_securitylayer_tls": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\SecurityLayer",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000002)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "(selection_shadow or selection_terminal_services_key or selection_tamper_only) and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "(selection_shadow",
            "selection_terminal_services_key",
            "selection_tamper_only) and not 1 of filter_main_*"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "defense_evasion",
          "persistence"
        ]
      },
      "meta": {
        "author": "Samir Bousseaden, David ANDRE, Roberto Rodriguez @Cyb3rWard0g, Nasreddine Bencherchali",
        "date": "2022-08-06",
        "modified": "2025-11-22",
        "references": [
          "http://etutorials.org/Microsoft+Products/microsoft+windows+server+2003+terminal+services/Chapter+6+Registry/Registry+Keys+for+Terminal+Services/",
          "http://woshub.com/rds-shadow-how-to-connect-to-a-user-session-in-windows-server-2012-r2/",
          "https://admx.help/HKLM/SOFTWARE/Policies/Microsoft/Windows%20NT/Terminal%20Services",
          "https://bazaar.abuse.ch/sample/6f3aa9362d72e806490a8abce245331030d1ab5ac77e400dd475748236a6cc81/",
          "https://blog.sekoia.io/darkgate-internals/",
          "https://blog.talosintelligence.com/understanding-the-phobos-affiliate-structure/",
          "https://github.com/redcanaryco/atomic-red-team/blob/02c7d02fe1f1feb0fc7944550408ea8224273994/atomics/T1112/T1112.md#atomic-test-63---disable-remote-desktop-anti-alias-setting-through-registry",
          "https://github.com/redcanaryco/atomic-red-team/blob/02c7d02fe1f1feb0fc7944550408ea8224273994/atomics/T1112/T1112.md#atomic-test-64---disable-remote-desktop-security-settings-through-registry",
          "https://github.com/redcanaryco/atomic-red-team/blob/dd526047b8c399c312fee47d1e6fb531164da54d/atomics/T1112/T1112.yaml#L790",
          "https://learn.microsoft.com/en-us/windows-hardware/customize/desktop/unattend/microsoft-windows-terminalservices-rdp-winstationextensions-securitylayer",
          "https://threathunterplaybook.com/hunts/windows/190407-RegModEnableRDPConnections/notebook.html",
          "https://twitter.com/SagieSec/status/1469001618863624194?t=HRf0eA0W1YYzkTSHb-Ky1A&s=03",
          "https://web.archive.org/web/20200929062532/https://blog.menasec.net/2019/02/threat-hunting-rdp-hijacking-via.html",
          "https://www.trendmicro.com/en_us/research/25/i/unmasking-the-gentlemen-ransomware.html"
        ],
        "falsepositives": [
          "Some of the keys mentioned here could be modified by an administrator while setting group policy (it should be investigated either way)"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_terminal_server_tampering.yml"
      }
    },
    {
      "id": "a1b1fd53-9c4a-444c-bae0-34a330fc7aa8",
      "title": "Potential Persistence Via DLLPathOverride",
      "status": "test",
      "description": "Detects when an attacker adds a new \"DLLPathOverride\" value to the \"Natural Language\" key in order to achieve persistence which will get invoked by \"SearchIndexer.exe\" process",
      "level": "high",
      "tags": [
        "attack.persistence"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_root": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\SYSTEM\\CurrentControlSet\\Control\\ContentIndex\\Language\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_values": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\StemmerDLLPathOverride",
                  "\\WBDLLPathOverride",
                  "\\StemmerClass",
                  "\\WBreakerClass"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-07-21",
        "modified": "2023-08-17",
        "references": [
          "https://persistence-info.github.io/Data/naturallanguage6.html",
          "https://www.hexacorn.com/blog/2018/12/30/beyond-good-ol-run-key-part-98/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_persistence_natural_language.yml"
      }
    },
    {
      "id": "61a7697c-cb79-42a8-a2ff-5f0cdfae0130",
      "title": "Potential CobaltStrike Service Installations - Registry",
      "status": "test",
      "description": "Detects known malicious service installs that appear in cases in which a Cobalt Strike beacon elevates privileges or lateral movement.\n",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.execution",
        "attack.privilege-escalation",
        "attack.lateral-movement",
        "attack.t1021.002",
        "attack.t1543.003",
        "attack.t1569.002"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_key": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "TargetObject__contains": {
                    "field": "TargetObject",
                    "value": "\\System\\CurrentControlSet\\Services",
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "TargetObject__contains_all": {
                    "field": "TargetObject",
                    "value": [
                      "\\System\\ControlSet",
                      "\\Services"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "selection_details": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Details__contains_all": {
                    "field": "Details",
                    "value": [
                      "ADMIN$",
                      ".exe"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Details__contains_all": {
                    "field": "Details",
                    "value": [
                      "%COMSPEC%",
                      "start",
                      "powershell"
                    ],
                    "modifiers": [
                      "contains",
                      "all"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1021.002",
          "T1543.003",
          "T1569.002"
        ],
        "tactics": [
          "persistence",
          "execution",
          "privilege_escalation",
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Wojciech Lesicki",
        "date": "2021-06-29",
        "modified": "2024-03-25",
        "references": [
          "https://www.sans.org/webcasts/tech-tuesday-workshop-cobalt-strike-detection-log-analysis-119395"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_cobaltstrike_service_installs.yml"
      }
    },
    {
      "id": "fe20dda1-6f37-4379-bbe0-a98d400cae90",
      "title": "Potential Persistence Via Scrobj.dll COM Hijacking",
      "status": "test",
      "description": "Detect use of scrobj.dll as this DLL looks for the ScriptletURL key to get the location of the script to execute",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1546.015"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "InprocServer32\\(Default)",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "C:\\WINDOWS\\system32\\scrobj.dll",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1546.015"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-08-20",
        "modified": "2023-08-17",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1546.015/T1546.015.md"
        ],
        "falsepositives": [
          "Legitimate use of the dll."
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_persistence_scrobj_dll.yml"
      }
    },
    {
      "id": "28036918-04d3-423d-91c0-55ecf99fb892",
      "title": "NET NGenAssemblyUsageLog Registry Key Tamper",
      "status": "test",
      "description": "Detects changes to the NGenAssemblyUsageLog registry key.\n.NET Usage Log output location can be controlled by setting the NGenAssemblyUsageLog CLR configuration knob in the Registry or by configuring an environment variable (as described in the next section).\nBy simplify specifying an arbitrary value (e.g. fake output location or junk data) for the expected value, a Usage Log file for the .NET execution context will not be created.\n",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "SOFTWARE\\Microsoft\\.NETFramework\\NGenAssemblyUsageLog",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-11-18",
        "modified": "2023-08-17",
        "references": [
          "https://bohops.com/2021/03/16/investigating-net-clr-usage-log-tampering-techniques-for-edr-evasion/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_net_cli_ngenassemblyusagelog.yml"
      }
    },
    {
      "id": "4a5f5a5e-ac01-474b-9b4e-d61298c9df1d",
      "title": "PowerShell as a Service in Registry",
      "status": "test",
      "description": "Detects that a powershell code is written to the registry as a service.",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1569.002"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Services\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\ImagePath",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__contains": {
                "field": "Details",
                "value": [
                  "powershell",
                  "pwsh"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1569.002"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "oscd.community, Natalia Shornikova",
        "date": "2020-10-06",
        "modified": "2023-08-17",
        "references": [
          "https://speakerdeck.com/heirhabarov/hunting-for-powershell-abuse"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_powershell_as_service.yml"
      }
    },
    {
      "id": "8ffc5407-52e3-478f-9596-0a7371eafe13",
      "title": "Disable PUA Protection on Windows Defender",
      "status": "test",
      "description": "Detects disabling Windows Defender PUA protection",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Policies\\Microsoft\\Windows Defender\\PUAProtection",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000000)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Austin Songer @austinsonger",
        "date": "2021-08-04",
        "modified": "2023-08-17",
        "references": [
          "https://www.tenforums.com/tutorials/32236-enable-disable-microsoft-defender-pua-protection-windows-10-a.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_disabled_pua_protection_on_microsoft_defender.yml"
      }
    },
    {
      "id": "46490193-1b22-4c29-bdd6-5bf63907216f",
      "title": "VBScript Payload Stored in Registry",
      "status": "test",
      "description": "Detects VBScript content stored into registry keys as seen being used by UNC2452 group",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "Software\\Microsoft\\Windows\\CurrentVersion",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__contains": {
                "field": "Details",
                "value": [
                  "vbscript:",
                  "jscript:",
                  "mshtml,",
                  "RunHTMLApplication",
                  "Execute(",
                  "CreateObject",
                  "window.close"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "Software\\Microsoft\\Windows\\CurrentVersion\\Run",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_dotnet": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\msiexec.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Installer\\UserData\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__contains": {
                "field": "Details",
                "value": [
                  "\\Microsoft.NET\\Primary Interop Assemblies\\Microsoft.mshtml.dll",
                  "<\\Microsoft.mshtml,fileVersion=",
                  "_mshtml_dll_",
                  "<\\Microsoft.mshtml,culture="
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1547.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2021-03-05",
        "modified": "2023-08-17",
        "references": [
          "https://www.microsoft.com/security/blog/2021/03/04/goldmax-goldfinder-sibot-analyzing-nobelium-malware/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_vbs_payload_stored.yml"
      }
    },
    {
      "id": "ab567429-1dfb-4674-b6d2-979fd2f9d125",
      "title": "Internet Explorer DisableFirstRunCustomize Enabled",
      "status": "test",
      "description": "Detects changes to the Internet Explorer \"DisableFirstRunCustomize\" value, which prevents Internet Explorer from running the first run wizard the first time a user starts the browser after installing Internet Explorer or Windows.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Microsoft\\Internet Explorer\\Main\\DisableFirstRunCustomize",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": [
                  "DWORD (0x00000001)",
                  "DWORD (0x00000002)"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_generic": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Windows\\explorer.exe",
                  "C:\\Windows\\System32\\ie4uinit.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_avira": {
            "type": "field_match",
            "matchers": {
              "Image__contains_all": {
                "field": "Image",
                "value": [
                  "\\Temp\\",
                  "\\.cr\\avira_"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "Details__contains": {
                "field": "Details",
                "value": "DWORD (0x00000001)",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_foxit": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\Foxit Software\\Foxit PDF Reader\\FoxitPDFReader.exe",
                  "C:\\Program Files\\Foxit Software\\Foxit PDF Reader\\FoxitPDFReader.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "Details__contains": {
                "field": "Details",
                "value": "DWORD (0x00000001)",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-16",
        "modified": "2025-10-07",
        "references": [
          "https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/devil-bait/NCSC-MAR-Devil-Bait.pdf",
          "https://unit42.paloaltonetworks.com/operation-ke3chang-resurfaces-with-new-tidepool-malware/",
          "https://admx.help/?Category=InternetExplorer&Policy=Microsoft.Policies.InternetExplorer::NoFirstRunCustomise"
        ],
        "falsepositives": [
          "As this is controlled by group policy as well as user settings. Some false positives may occur."
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_internet_explorer_disable_first_run_customize.yml"
      }
    },
    {
      "id": "0372e1f9-0fd2-40f7-be1b-a7b2b848fa7b",
      "title": "Disable Privacy Settings Experience in Registry",
      "status": "test",
      "description": "Detects registry modifications that disable Privacy Settings Experience",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\Policies\\Microsoft\\Windows\\OOBE\\DisablePrivacyExperience",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000000)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-10-02",
        "modified": "2023-08-17",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/9e5b12c4912c07562aec7500447b11fa3e17e254/atomics/T1562.001/T1562.001.md"
        ],
        "falsepositives": [
          "Legitimate admin script"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_disable_privacy_settings_experience.yml"
      }
    },
    {
      "id": "04b45a8a-d11d-49e4-9acc-4a1b524407a5",
      "title": "DNS-over-HTTPS Enabled by Registry",
      "status": "test",
      "description": "Detects when a user enables DNS-over-HTTPS.\nThis can be used to hide internet activity or be used to hide the process of exfiltrating data.\nWith this enabled organization will lose visibility into data such as query type, response and originating IP that are used to determine bad actors.\n",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1140",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_edge": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\Policies\\Microsoft\\Edge\\BuiltInDnsClientEnabled",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000001)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_chrome": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\Google\\Chrome\\DnsOverHttpsMode",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "secure",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_firefox": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\Policies\\Mozilla\\Firefox\\DNSOverHTTPS\\Enabled",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000001)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1140",
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Austin Songer",
        "date": "2021-07-22",
        "modified": "2023-08-17",
        "references": [
          "https://www.tenforums.com/tutorials/151318-how-enable-disable-dns-over-https-doh-microsoft-edge.html",
          "https://github.com/elastic/detection-rules/issues/1371",
          "https://chromeenterprise.google/policies/?policy=DnsOverHttpsMode",
          "https://admx.help/HKLM/Software/Policies/Mozilla/Firefox/DNSOverHTTPS"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_dns_over_https_enabled.yml"
      }
    },
    {
      "id": "7f2954d2-99c2-4d42-a065-ca36740f187b",
      "title": "Hypervisor Enforced Paging Translation Disabled",
      "status": "test",
      "description": "Detects changes to the \"DisableHypervisorEnforcedPagingTranslation\" registry value. Where the it is set to \"1\" in order to disable the Hypervisor Enforced Paging Translation feature.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\DisableHypervisorEnforcedPagingTranslation",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000001)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2024-07-05",
        "modified": "",
        "references": [
          "https://twitter.com/standa_t/status/1808868985678803222",
          "https://github.com/AaLl86/WindowsInternals/blob/070dc4f317726dfb6ffd2b7a7c121a33a8659b5e/Slides/Hypervisor-enforced%20Paging%20Translation%20-%20The%20end%20of%20non%20data-driven%20Kernel%20Exploits%20(Recon2024).pdf"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_deviceguard_hypervisorenforcedpagingtranslation_disabled.yml"
      }
    },
    {
      "id": "fecfd1a1-cc78-4313-a1ea-2ee2e8ec27a7",
      "title": "PowerShell Logging Disabled Via Registry Key Tampering",
      "status": "test",
      "description": "Detects changes to the registry for the currently logged-in user. In order to disable PowerShell module logging, script block logging or transcription and script execution logging",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1564.001",
        "attack.t1112",
        "attack.persistence"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Microsoft\\Windows\\PowerShell\\",
                  "\\Microsoft\\PowerShellCore\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "\\ModuleLogging\\EnableModuleLogging",
                  "\\ScriptBlockLogging\\EnableScriptBlockLogging",
                  "\\ScriptBlockLogging\\EnableScriptBlockInvocationLogging",
                  "\\Transcription\\EnableTranscripting",
                  "\\Transcription\\EnableInvocationHeader",
                  "\\EnableScripts"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000000)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1564.001",
          "T1112"
        ],
        "tactics": [
          "defense_evasion",
          "persistence"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-04-02",
        "modified": "2023-08-17",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1112/T1112.md#atomic-test-32---windows-powershell-logging-disabled"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_powershell_logging_disabled.yml"
      }
    },
    {
      "id": "439957a7-ad86-4a8f-9705-a28131c6821b",
      "title": "Old TLS1.0/TLS1.1 Protocol Version Enabled",
      "status": "test",
      "description": "Detects applications or users re-enabling old TLS versions by setting the \"Enabled\" value to \"1\" for the \"Protocols\" registry key.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\TLS 1.0\\",
                  "\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\TLS 1.1\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Enabled",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000001)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-09-05",
        "modified": "",
        "references": [
          "https://techcommunity.microsoft.com/t5/windows-it-pro-blog/tls-1-0-and-tls-1-1-soon-to-be-disabled-in-windows/ba-p/3887947"
        ],
        "falsepositives": [
          "Legitimate enabling of the old tls versions due to incompatibility"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_tls_protocol_old_version_enabled.yml"
      }
    },
    {
      "id": "9c226817-8dc9-46c2-a58d-66655aafd7dc",
      "title": "Modify User Shell Folders Startup Value",
      "status": "test",
      "description": "Detect modification of the startup key to a path where a payload could be stored to be launched during startup",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.privilege-escalation",
        "attack.t1547.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "Startup",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1547.001"
        ],
        "tactics": [
          "persistence",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-10-01",
        "modified": "2023-08-17",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/9e5b12c4912c07562aec7500447b11fa3e17e254/atomics/T1547.001/T1547.001.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_susp_user_shell_folders.yml"
      }
    },
    {
      "id": "f8aebc67-a56d-4ec9-9fbe-7b0e8b7b4efd",
      "title": "Hiding User Account Via SpecialAccounts Registry Key",
      "status": "test",
      "description": "Detects modifications to the registry key \"HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\SpecialAccounts\\Userlist\" where the value is set to \"0\" in order to hide user account from being listed on the logon screen.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1564.002"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\SpecialAccounts\\UserList",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000000)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1564.002"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), frack113",
        "date": "2022-07-12",
        "modified": "2023-01-26",
        "references": [
          "https://thedfirreport.com/2022/07/11/select-xmrig-from-sqlserver/",
          "https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1564.002/T1564.002.md#atomic-test-3---create-hidden-user-in-registry"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_special_accounts.yml"
      }
    },
    {
      "id": "e3b50fa5-3c3f-444e-937b-0a99d33731cd",
      "title": "Outlook Macro Execution Without Warning Setting Enabled",
      "status": "test",
      "description": "Detects the modification of Outlook security setting to allow unprompted execution of macros.",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.command-and-control",
        "attack.t1137",
        "attack.t1008",
        "attack.t1546"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Outlook\\Security\\Level",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__contains": {
                "field": "Details",
                "value": "0x00000001",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1137",
          "T1008",
          "T1546"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "command_and_control"
        ]
      },
      "meta": {
        "author": "@ScoubiMtl",
        "date": "2021-04-05",
        "modified": "2023-08-17",
        "references": [
          "https://www.mdsec.co.uk/2020/11/a-fresh-outlook-on-mail-based-persistence/",
          "https://speakerdeck.com/heirhabarov/hunting-for-persistence-via-microsoft-exchange-server-or-outlook?slide=53"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_office_outlook_enable_macro_execution.yml"
      }
    },
    {
      "id": "6db5eaf9-88f7-4ed9-af7d-9ef2ad12f236",
      "title": "Winget Admin Settings Modification",
      "status": "test",
      "description": "Detects changes to the AppInstaller (winget) admin settings. Such as enabling local manifest installations or disabling installer hash checks",
      "level": "low",
      "tags": [
        "attack.defense-evasion",
        "attack.persistence"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\winget.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__startswith": {
                "field": "TargetObject",
                "value": "\\REGISTRY\\A\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\LocalState\\admin_settings",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion",
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-04-17",
        "modified": "2023-08-17",
        "references": [
          "https://github.com/nasbench/Misc-Research/tree/b9596e8109dcdb16ec353f316678927e507a5b8d/LOLBINs/Winget",
          "https://github.com/microsoft/winget-cli/blob/02d2f93807c9851d73eaacb4d8811a76b64b7b01/src/AppInstallerCommonCore/Public/winget/AdminSettings.h#L13"
        ],
        "falsepositives": [
          "The event doesn't contain information about the type of change. False positives are expected with legitimate changes"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_winget_admin_settings_tampering.yml"
      }
    },
    {
      "id": "ddd171b5-2cc6-4975-9e78-f0eccd08cc76",
      "title": "Potential Persistence Via Outlook Home Page",
      "status": "test",
      "description": "Detects potential persistence activity via outlook home page.\nAn attacker can set a home page to achieve code execution and persistence by editing the WebView registry keys.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.persistence",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains_all": {
                "field": "TargetObject",
                "value": [
                  "\\Software\\Microsoft\\Office\\",
                  "\\Outlook\\WebView\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\URL",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "defense_evasion",
          "persistence"
        ]
      },
      "meta": {
        "author": "Tobias Michalski (Nextron Systems), David Bertho (@dbertho) & Eirik Sveen (@0xSV1), Storebrand",
        "date": "2021-06-09",
        "modified": "2024-08-07",
        "references": [
          "https://speakerdeck.com/heirhabarov/hunting-for-persistence-via-microsoft-exchange-server-or-outlook?slide=70",
          "https://support.microsoft.com/en-us/topic/outlook-home-page-feature-is-missing-in-folder-properties-d207edb7-aa02-46c5-b608-5d9dbed9bd04?ui=en-us&rs=en-us&ad=us",
          "https://trustedsec.com/blog/specula-turning-outlook-into-a-c2-with-one-registry-change"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_persistence_outlook_homepage.yml"
      }
    },
    {
      "id": "707e097c-e20f-4f67-8807-1f72ff4500d6",
      "title": "Potential Persistence Via App Paths Default Property",
      "status": "test",
      "description": "Detects changes to the \"Default\" property for keys located in the \\Software\\Microsoft\\Windows\\CurrentVersion\\App Paths\\ registry. Which might be used as a method of persistence\nThe entries found under App Paths are used primarily for the following purposes.\nFirst, to map an application's executable file name to that file's fully qualified path.\nSecond, to prepend information to the PATH environment variable on a per-application, per-process basis.\n",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1546.012"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "(Default)",
                  "Path"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Details__contains": {
                "field": "Details",
                "value": [
                  "\\Users\\Public",
                  "\\AppData\\Local\\Temp\\",
                  "\\Windows\\Temp\\",
                  "\\Desktop\\",
                  "\\Downloads\\",
                  "%temp%",
                  "%tmp%",
                  "iex",
                  "Invoke-",
                  "rundll32",
                  "regsvr32",
                  "mshta",
                  "cscript",
                  "wscript",
                  ".bat",
                  ".hta",
                  ".dll",
                  ".ps1"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1546.012"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-10",
        "modified": "2023-08-17",
        "references": [
          "https://www.hexacorn.com/blog/2013/01/19/beyond-good-ol-run-key-part-3/",
          "https://learn.microsoft.com/en-us/windows/win32/shell/app-registration"
        ],
        "falsepositives": [
          "Legitimate applications registering their binary from on of the suspicious locations mentioned above (tune it)"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_persistence_app_paths.yml"
      }
    },
    {
      "id": "4fee3d51-8069-4a4c-a0f7-924fcaff2c70",
      "title": "FileFix - Command Evidence in TypedPaths",
      "status": "experimental",
      "description": "Detects commonly-used chained commands and strings in the most recent 'url' value of the 'TypedPaths' key, which could be indicative of a user being targeted by the FileFix technique.\n",
      "level": "high",
      "tags": [
        "attack.execution",
        "attack.t1204.004"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_base": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\TypedPaths\\url1",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__contains_all": {
                "field": "Details",
                "value": [
                  "#",
                  "http"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_cmd": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Details__contains": {
                    "field": "Details",
                    "value": [
                      "account",
                      "anti-bot",
                      "botcheck",
                      "captcha",
                      "challenge",
                      "confirmation",
                      "fraud",
                      "human",
                      "identification",
                      "identificator",
                      "identity",
                      "robot",
                      "validation",
                      "verification",
                      "verify"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Details__contains": {
                    "field": "Details",
                    "value": [
                      "%comspec%",
                      "bitsadmin",
                      "certutil",
                      "cmd",
                      "cscript",
                      "curl",
                      "finger",
                      "mshta",
                      "powershell",
                      "pwsh",
                      "regsvr32",
                      "rundll32",
                      "schtasks",
                      "wget",
                      "wscript"
                    ],
                    "modifiers": [
                      "contains"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          }
        },
        "filters": {},
        "condition": "all of selection_*",
        "condition_parsed": {
          "op": "all_of",
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1204.004"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "Alfie Champion (delivr.to), Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-07-05",
        "modified": "2025-11-19",
        "references": [
          "https://x.com/russianpanda9xx/status/1940831134759506029",
          "https://mrd0x.com/filefix-clickfix-alternative/",
          "https://www.scpx.com.au/2025/11/16/decades-old-finger-protocol-abused-in-clickfix-malware-attacks/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_filefix_typedpath_commands.yml"
      }
    },
    {
      "id": "b888e3f2-224d-4435-b00b-9dd66e9ea1f1",
      "title": "Uncommon Extension In Keyboard Layout IME File Registry Value",
      "status": "test",
      "description": "Detects usage of Windows Input Method Editor (IME) keyboard layout feature, which allows an attacker to load a DLL into the process after sending the WM_INPUTLANGCHANGEREQUEST message.\nBefore doing this, the client needs to register the DLL in a special registry key that is assumed to implement this keyboard layout. This registry key should store a value named \"Ime File\" with a DLL path.\nIMEs are essential for languages that have more characters than can be represented on a standard keyboard, such as Chinese, Japanese, and Korean.\n",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains_all": {
                "field": "TargetObject",
                "value": [
                  "\\Control\\Keyboard Layouts\\",
                  "Ime File"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_known_extension": {
            "type": "field_match",
            "matchers": {
              "Details__endswith": {
                "field": "Details",
                "value": ".ime",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "X__Junior (Nextron Systems)",
        "date": "2023-11-21",
        "modified": "",
        "references": [
          "https://www.linkedin.com/pulse/guntior-story-advanced-bootkit-doesnt-rely-windows-disk-baranov-wue8e/"
        ],
        "falsepositives": [
          "IMEs are essential for languages that have more characters than can be represented on a standard keyboard, such as Chinese, Japanese, and Korean."
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_ime_non_default_extension.yml"
      }
    },
    {
      "id": "a5c7a43f-6009-4a8c-80c5-32abf1c53ecc",
      "title": "Microsoft Office Protected View Disabled",
      "status": "test",
      "description": "Detects changes to Microsoft Office protected view registry keys with which the attacker disables this feature.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_path": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains_all": {
                "field": "TargetObject",
                "value": [
                  "\\SOFTWARE\\Microsoft\\Office\\",
                  "\\Security\\ProtectedView\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_values_1": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000001)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "\\DisableAttachementsInPV",
                  "\\DisableInternetFilesInPV",
                  "\\DisableIntranetCheck",
                  "\\DisableUnsafeLocationsInPV"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_values_0": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000000)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "\\enabledatabasefileprotectedview",
                  "\\enableforeigntextfileprotectedview"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_path and 1 of selection_values_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_path"
            },
            {
              "type": "ref",
              "value": "1 of selection_values_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2021-06-08",
        "modified": "2023-08-17",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md",
          "https://unit42.paloaltonetworks.com/unit42-gorgon-group-slithering-nation-state-cybercrime/",
          "https://yoroi.company/research/cyber-criminal-espionage-operation-insists-on-italian-manufacturing/",
          "https://admx.help/HKCU/software/policies/microsoft/office/16.0/excel/security/protectedview"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_office_disable_protected_view_features.yml"
      }
    },
    {
      "id": "02ee49e2-e294-4d0f-9278-f5b3212fc588",
      "title": "New RUN Key Pointing to Suspicious Folder",
      "status": "experimental",
      "description": "Detects suspicious new RUN key element pointing to an executable in a suspicious folder",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_target": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Software\\Microsoft\\Windows\\CurrentVersion\\Run",
                  "\\Software\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Run",
                  "\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_suspicious_paths_1": {
            "type": "field_match",
            "matchers": {
              "Details__contains": {
                "field": "Details",
                "value": [
                  ":\\Perflogs",
                  ":\\ProgramData'",
                  ":\\Windows\\Temp",
                  ":\\Temp",
                  "\\AppData\\Local\\Temp",
                  "\\AppData\\Roaming",
                  ":\\$Recycle.bin",
                  ":\\Users\\Default",
                  ":\\Users\\public",
                  "%temp%",
                  "%tmp%",
                  "%Public%",
                  "%AppData%"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_suspicious_paths_user_1": {
            "type": "field_match",
            "matchers": {
              "Details__contains": {
                "field": "Details",
                "value": ":\\Users\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_suspicious_paths_user_2": {
            "type": "field_match",
            "matchers": {
              "Details__contains": {
                "field": "Details",
                "value": [
                  "\\Favorites",
                  "\\Favourites",
                  "\\Contacts",
                  "\\Music",
                  "\\Pictures",
                  "\\Documents",
                  "\\Photos"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_windows_update": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Windows\\SoftwareDistribution\\Download\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__contains_all": {
                "field": "Details",
                "value": [
                  "rundll32.exe ",
                  "C:\\WINDOWS\\system32\\advpack.dll,DelNodeRunDLL32"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "Details__contains": {
                "field": "Details",
                "value": [
                  "\\AppData\\Local\\Temp\\",
                  "C:\\Windows\\Temp\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_spotify": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Spotify\\Spotify.exe",
                  "C:\\Program Files (x86)\\Spotify\\Spotify.exe",
                  "\\AppData\\Roaming\\Spotify\\Spotify.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\Spotify",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__endswith": {
                "field": "Details",
                "value": "Spotify.exe --autostart --minimized",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection_target and (selection_suspicious_paths_1 or (all of selection_suspicious_paths_user_* )) and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "or",
          "operands": [
            "selection_target and (selection_suspicious_paths_1",
            "(all of selection_suspicious_paths_user_* )) and not 1 of filter_main_* and not 1 of filter_optional_*"
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1547.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), Markus Neis, Sander Wiebing, Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2018-08-25",
        "modified": "2025-10-06",
        "references": [
          "https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html",
          "https://github.com/HackTricks-wiki/hacktricks/blob/e4c7b21b8f36c97c35b7c622732b38a189ce18f7/src/windows-hardening/windows-local-privilege-escalation/privilege-escalation-with-autorun-binaries.md"
        ],
        "falsepositives": [
          "Software using weird folders for updates"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_susp_run_key_img_folder.yml"
      }
    },
    {
      "id": "e2482f8d-3443-4237-b906-cc145d87a076",
      "title": "Disable Internal Tools or Feature in Registry",
      "status": "test",
      "description": "Detects registry modifications that change features of internal Windows tools (malware like Agent Tesla uses this technique)",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_set_1": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\DisableCMD",
                  "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoControlPanel",
                  "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoRun",
                  "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\StartMenuLogOff",
                  "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\DisableChangePassword",
                  "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\DisableLockWorkstation",
                  "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\DisableRegistryTools",
                  "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\DisableTaskmgr",
                  "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\NoDispBackgroundPage",
                  "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\NoDispCPL",
                  "SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer\\DisableNotificationCenter",
                  "SOFTWARE\\Policies\\Microsoft\\Windows\\System\\DisableCMD"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000001)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_set_0": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\ConsentPromptBehaviorAdmin",
                  "Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\InactivityTimeoutSecs",
                  "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\shutdownwithoutlogon",
                  "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\PushNotifications\\ToastEnabled",
                  "SYSTEM\\CurrentControlSet\\Control\\Storage\\Write Protection",
                  "SYSTEM\\CurrentControlSet\\Control\\StorageDevicePolicies\\WriteProtect"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000000)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_set_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_set_"
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113, Nasreddine Bencherchali (Nextron Systems), CrimpSec",
        "date": "2022-03-18",
        "modified": "2025-06-04",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1112/T1112.md",
          "https://www.mandiant.com/resources/unc2165-shifts-to-evade-sanctions",
          "https://blogs.vmware.com/security/2022/11/batloader-the-evasive-downloader-malware.html",
          "https://www.malwarebytes.com/blog/detections/pum-optional-nodispbackgroundpage",
          "https://www.malwarebytes.com/blog/detections/pum-optional-nodispcpl",
          "https://bazaar.abuse.ch/sample/7bde840c7e8c36dce4c3bac937bcf39f36a6f118001b406bfbbc25451ce44fb4/"
        ],
        "falsepositives": [
          "Legitimate admin script"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_disable_function_user.yml"
      }
    },
    {
      "id": "9f4662ac-17ca-43aa-8f12-5d7b989d0101",
      "title": "Tamper With Sophos AV Registry Keys",
      "status": "test",
      "description": "Detects tamper attempts to sophos av functionality via registry key modification",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Sophos Endpoint Defense\\TamperProtection\\Config\\SAVEnabled",
                  "\\Sophos Endpoint Defense\\TamperProtection\\Config\\SEDEnabled",
                  "\\Sophos\\SAVService\\TamperProtection\\Enabled"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000000)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-09-02",
        "modified": "2023-08-17",
        "references": [
          "https://redacted.com/blog/bianlian-ransomware-gang-gives-it-a-go/"
        ],
        "falsepositives": [
          "Some FP may occur when the feature is disabled by the AV itself, you should always investigate if the action was legitimate"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_sophos_av_tamper.yml"
      }
    },
    {
      "id": "944e8941-f6f6-4ee8-ac05-1c224e923c0e",
      "title": "Add Port Monitor Persistence in Registry",
      "status": "test",
      "description": "Adversaries may use port monitors to run an attacker supplied DLL during system boot for persistence or privilege escalation.\nA port monitor can be set through the AddMonitor API call to set a DLL to be loaded at startup.\n",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547.010"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Control\\Print\\Monitors\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__endswith": {
                "field": "Details",
                "value": ".dll",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_cutepdf": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\System32\\spoolsv.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Control\\Print\\Monitors\\CutePDF Writer Monitor v4.0\\Driver",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "cpwmon64_v40.dll",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "User__contains": {
                "field": "User",
                "value": [
                  "AUTHORI",
                  "AUTORI"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_monvnc": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Control\\Print\\Monitors\\MONVNC\\Driver",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_vnc": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains_all": {
                "field": "TargetObject",
                "value": [
                  "Control\\Print\\Environments\\",
                  "\\Drivers\\",
                  "\\VNC Printer"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1547.010"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2021-12-30",
        "modified": "2024-03-25",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.010/T1547.010.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_add_port_monitor.yml"
      }
    },
    {
      "id": "9e3357ba-09d4-4fbd-a7c5-ad6386314513",
      "title": "Change the Fax Dll",
      "status": "test",
      "description": "Detect possible persistence using Fax DLL load when service restart",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains_all": {
                "field": "TargetObject",
                "value": [
                  "\\Software\\Microsoft\\Fax\\Device Providers\\",
                  "\\ImageName"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": "%systemroot%\\system32\\fxst30.dll",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-07-17",
        "modified": "2022-12-30",
        "references": [
          "https://twitter.com/dottor_morte/status/1544652325570191361",
          "https://raw.githubusercontent.com/RiccardoAncarani/talks/master/F-Secure/unorthodox-lateral-movement.pdf"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_fax_dll_persistance.yml"
      }
    },
    {
      "id": "33efc23c-6ea2-4503-8cfe-bdf82ce8f719",
      "title": "Lsass Full Dump Request Via DumpType Registry Settings",
      "status": "test",
      "description": "Detects the setting of the \"DumpType\" registry value to \"2\" which stands for a \"Full Dump\". Technique such as LSASS Shtinkering requires this value to be \"2\" in order to dump LSASS.",
      "level": "high",
      "tags": [
        "attack.credential-access",
        "attack.t1003.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\SOFTWARE\\Microsoft\\Windows\\Windows Error Reporting\\LocalDumps\\DumpType",
                  "\\SOFTWARE\\Microsoft\\Windows\\Windows Error Reporting\\LocalDumps\\lsass.exe\\DumpType"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000002)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1003.001"
        ],
        "tactics": [
          "credential_access"
        ]
      },
      "meta": {
        "author": "@pbssubhash",
        "date": "2022-12-08",
        "modified": "2023-08-17",
        "references": [
          "https://github.com/deepinstinct/Lsass-Shtinkering",
          "https://learn.microsoft.com/en-us/windows/win32/wer/collecting-user-mode-dumps",
          "https://media.defcon.org/DEF%20CON%2030/DEF%20CON%2030%20presentations/Asaf%20Gilboa%20-%20LSASS%20Shtinkering%20Abusing%20Windows%20Error%20Reporting%20to%20Dump%20LSASS.pdf"
        ],
        "falsepositives": [
          "Legitimate application that needs to do a full dump of their process"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_lsass_usermode_dumping.yml"
      }
    },
    {
      "id": "2ff692c2-4594-41ec-8fcb-46587de769e0",
      "title": "CrashControl CrashDump Disabled",
      "status": "test",
      "description": "Detects disabling the CrashDump per registry (as used by HermeticWiper)",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1564",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "SYSTEM\\CurrentControlSet\\Control\\CrashControl",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000000)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1564",
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Tobias Michalski (Nextron Systems)",
        "date": "2022-02-24",
        "modified": "2023-08-17",
        "references": [
          "https://www.sentinelone.com/labs/hermetic-wiper-ukraine-under-attack/"
        ],
        "falsepositives": [
          "Legitimate disabling of crashdumps"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_crashdump_disabled.yml"
      }
    },
    {
      "id": "20f0ee37-5942-4e45-b7d5-c5b5db9df5cd",
      "title": "CurrentVersion Autorun Keys Modification",
      "status": "test",
      "description": "Detects modification of autostart extensibility point (ASEP) in registry.",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_current_version_base": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_current_version_keys": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\ShellServiceObjectDelayLoad",
                  "\\Run\\",
                  "\\RunOnce\\",
                  "\\RunOnceEx\\",
                  "\\RunServices\\",
                  "\\RunServicesOnce\\",
                  "\\Policies\\System\\Shell",
                  "\\Policies\\Explorer\\Run",
                  "\\Group Policy\\Scripts\\Startup",
                  "\\Group Policy\\Scripts\\Shutdown",
                  "\\Group Policy\\Scripts\\Logon",
                  "\\Group Policy\\Scripts\\Logoff",
                  "\\Explorer\\ShellServiceObjects",
                  "\\Explorer\\ShellIconOverlayIdentifiers",
                  "\\Explorer\\ShellExecuteHooks",
                  "\\Explorer\\SharedTaskScheduler",
                  "\\Explorer\\Browser Helper Objects",
                  "\\Authentication\\PLAP Providers",
                  "\\Authentication\\Credential Providers",
                  "\\Authentication\\Credential Provider Filters"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_generic_all": {
            "type": "or_list",
            "items": [
              {
                "type": "field_match",
                "matchers": {
                  "Details": {
                    "field": "Details",
                    "value": "(Empty)",
                    "modifiers": [],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "TargetObject__endswith": {
                    "field": "TargetObject",
                    "value": "\\NgcFirst\\ConsecutiveSwitchCount",
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": false,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image__endswith": {
                    "field": "Image",
                    "value": [
                      "\\AppData\\Local\\Microsoft\\OneDrive\\Update\\OneDriveSetup.exe",
                      "\\AppData\\Roaming\\Spotify\\Spotify.exe",
                      "\\AppData\\Local\\WebEx\\WebexHost.exe"
                    ],
                    "modifiers": [
                      "endswith"
                    ],
                    "is_list": true,
                    "negated": false
                  }
                }
              },
              {
                "type": "field_match",
                "matchers": {
                  "Image": {
                    "field": "Image",
                    "value": [
                      "C:\\WINDOWS\\system32\\devicecensus.exe",
                      "C:\\Windows\\system32\\winsat.exe",
                      "C:\\Program Files\\Microsoft OneDrive\\StandaloneUpdater\\OneDriveSetup.exe",
                      "C:\\Program Files (x86)\\Microsoft OneDrive\\StandaloneUpdater\\OneDriveSetup.exe",
                      "C:\\Program Files\\Microsoft OneDrive\\Update\\OneDriveSetup.exe",
                      "C:\\Program Files (x86)\\Microsoft OneDrive\\Update\\OneDriveSetup.exe",
                      "C:\\Program Files\\Microsoft Office\\root\\integration\\Addons\\OneDriveSetup.exe",
                      "C:\\Program Files (x86)\\Microsoft Office\\root\\integration\\Addons\\OneDriveSetup.exe",
                      "C:\\Program Files\\KeePass Password Safe 2\\ShInstUtil.exe",
                      "C:\\Program Files\\Everything\\Everything.exe",
                      "C:\\Program Files (x86)\\Microsoft Office\\root\\integration\\integrator.exe",
                      "C:\\Program Files\\Microsoft Office\\root\\integration\\integrator.exe"
                    ],
                    "modifiers": [],
                    "is_list": true,
                    "negated": false
                  }
                }
              }
            ]
          },
          "filter_main_null": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_logonui": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\system32\\LogonUI.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Authentication\\Credential Providers\\{D6886603-9D2F-4EB2-B667-1971041FA96B}\\",
                  "\\Authentication\\Credential Providers\\{BEC09223-B018-416D-A0AC-523971B639F5}\\",
                  "\\Authentication\\Credential Providers\\{8AF662BF-65A0-4D0A-A540-A338A999D36F}\\",
                  "\\Authentication\\Credential Providers\\{27FBDB57-B613-4AF2-9D7E-4FA7A66C21AD}\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_edge": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\Microsoft\\EdgeUpdate\\Install\\",
                  "C:\\Program Files (x86)\\Microsoft\\EdgeWebView\\",
                  "C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_defender": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Program Files\\Windows Defender\\MsMpEng.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_teams": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\Microsoft\\Teams\\current\\Teams.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__contains": {
                "field": "Details",
                "value": "\\Microsoft\\Teams\\Update.exe --processStart ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_ctfmon": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\system32\\userinit.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "ctfmon.exe /n",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_dropbox": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\system32\\regsvr32.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "DropboxExt",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__endswith": {
                "field": "Details",
                "value": "A251-47B7-93E1-CDD82E34AF8B}",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_opera_1": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\Opera Browser Assistant",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "C:\\Program Files\\Opera\\assistant\\browser_assistant.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_opera_2": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Opera Stable",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": [
                  "C:\\Program Files\\Opera\\launcher.exe",
                  "C:\\Program Files (x86)\\Opera\\launcher.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_itunes": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\iTunesHelper",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "\"C:\\Program Files\\iTunes\\iTunesHelper.exe\"",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_zoom": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\zoommsirepair",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "\"C:\\Program Files\\Zoom\\bin\\installer.exe\" /repair",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_greenshot": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\Greenshot",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "C:\\Program Files\\Greenshot\\Greenshot.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_googledrive1": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\GoogleDriveFS",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__startswith": {
                "field": "Details",
                "value": "C:\\Program Files\\Google\\Drive File Stream\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__contains": {
                "field": "Details",
                "value": "\\GoogleDriveFS.exe",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_googledrive2": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "GoogleDrive",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": [
                  "{CFE8B367-77A7-41D7-9C90-75D16D7DC6B6}",
                  "{A8E52322-8734-481D-A7E2-27B309EF8D56}",
                  "{C973DA94-CBDF-4E77-81D1-E5B794FBD146}",
                  "{51EF1569-67EE-4AD6-9646-E726C3FFC8A2}"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_onedrive": {
            "type": "field_match",
            "matchers": {
              "Details__startswith": {
                "field": "Details",
                "value": [
                  "C:\\Windows\\system32\\cmd.exe /q /c rmdir /s /q \"C:\\Users\\",
                  "C:\\Windows\\system32\\cmd.exe /q /c del /q \"C:\\Users\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Details__contains": {
                "field": "Details",
                "value": "\\AppData\\Local\\Microsoft\\OneDrive\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_python": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\{",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__contains_all": {
                "field": "Details",
                "value": [
                  "\\AppData\\Local\\Package Cache\\{",
                  "}\\python-"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "Details__endswith": {
                "field": "Details",
                "value": ".exe\" /burn.runonce",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_officeclicktorun": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\",
                  "C:\\Program Files (x86)\\Common Files\\Microsoft Shared\\ClickToRun\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\OfficeClickToRun.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_teams": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\Microsoft\\Teams\\current\\Teams.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__contains": {
                "field": "Details",
                "value": "\\Microsoft\\Teams\\Update.exe --processStart",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_AVG_setup": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\AVG\\Antivirus\\Setup\\",
                  "C:\\Program Files (x86)\\AVG\\Antivirus\\Setup\\",
                  "\\instup.exe"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": [
                  "\"C:\\Program Files\\AVG\\Antivirus\\AvLaunch.exe\" /gui",
                  "\"C:\\Program Files (x86)\\AVG\\Antivirus\\AvLaunch.exe\" /gui",
                  "{472083B0-C522-11CF-8763-00608CC02F24}",
                  "{472083B1-C522-11CF-8763-00608CC02F24}"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_Avast": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Avast Software\\Avast\\Setup\\",
                  "C:\\Program Files (x86)\\Avast Software\\Avast\\Setup\\",
                  "\\instup.exe"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": [
                  "\"C:\\Program Files\\Avast Software\\Avast\\AvLaunch.exe\" /gui",
                  "\"C:\\Program Files (x86)\\Avast Software\\Avast\\AvLaunch.exe\" /gui"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_AVG_avgtoolsvc": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\AVG\\Antivirus\\avgToolsSvc.exe",
                  "C:\\Program Files (x86)\\AVG\\Antivirus\\avgToolsSvc.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\StartupApproved\\Run\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "Binary Data",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_aurora_dashboard": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\aurora-agent-64.exe",
                  "\\aurora-agent.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Microsoft\\Windows\\CurrentVersion\\Run\\aurora-dashboard",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "C:\\Program Files\\Aurora-Agent\\tools\\aurora-dashboard.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_everything": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Microsoft\\Windows\\CurrentVersion\\Run\\Everything",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__endswith": {
                "field": "Details",
                "value": "\\Everything\\Everything.exe\" -startup",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_discord": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Discord",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__endswith": {
                "field": "Details",
                "value": "\\Discord\\Update.exe --processStart Discord.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "all of selection_*"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1547.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split)",
        "date": "2019-10-25",
        "modified": "2025-10-22",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md",
          "https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns",
          "https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d",
          "https://oddvar.moe/2018/03/21/persistence-using-runonceex-hidden-from-autoruns-exe/"
        ],
        "falsepositives": [
          "Legitimate software automatically (mostly, during installation) sets up autorun keys for legitimate reason",
          "Legitimate administrator sets up autorun keys for legitimate reason"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_currentversion.yml"
      }
    },
    {
      "id": "8d85cf08-bf97-4260-ba49-986a2a65129c",
      "title": "Suspicious PowerShell In Registry Run Keys",
      "status": "test",
      "description": "Detects potential PowerShell commands or code within registry run keys",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Software\\Microsoft\\Windows\\CurrentVersion\\Run",
                  "\\Software\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Run",
                  "\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "Details__contains": {
                "field": "Details",
                "value": [
                  "powershell",
                  "pwsh ",
                  "FromBase64String",
                  ".DownloadFile(",
                  ".DownloadString(",
                  " -w hidden ",
                  " -w 1 ",
                  "-windowstyle hidden",
                  "-window hidden",
                  " -nop ",
                  " -encodedcommand ",
                  "-ExecutionPolicy Bypass",
                  "Invoke-Expression",
                  "IEX (",
                  "Invoke-Command",
                  "ICM -",
                  "Invoke-WebRequest",
                  "IWR ",
                  "Invoke-RestMethod",
                  "IRM ",
                  " -noni ",
                  " -noninteractive "
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1547.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "frack113, Florian Roth (Nextron Systems)",
        "date": "2022-03-17",
        "modified": "2025-07-18",
        "references": [
          "https://github.com/frack113/atomic-red-team/blob/a9051c38de8a5320b31c7039efcbd3b56cf2d65a/atomics/T1547.001/T1547.001.md#atomic-test-9---systembc-malware-as-a-service-registry",
          "https://www.trendmicro.com/en_us/research/22/j/lv-ransomware-exploits-proxyshell-in-attack.html",
          "https://github.com/HackTricks-wiki/hacktricks/blob/e4c7b21b8f36c97c35b7c622732b38a189ce18f7/src/windows-hardening/windows-local-privilege-escalation/privilege-escalation-with-autorun-binaries.md"
        ],
        "falsepositives": [
          "Legitimate admin or third party scripts. Baseline according to your environment"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_powershell_in_run_keys.yml"
      }
    },
    {
      "id": "37b437cf-3fc5-4c8e-9c94-1d7c9aff842b",
      "title": "Allow RDP Remote Assistance Feature",
      "status": "test",
      "description": "Detect enable rdp feature to allow specific user to rdp connect on the targeted machine",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "System\\CurrentControlSet\\Control\\Terminal Server\\fAllowToGetHelp",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000001)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-08-19",
        "modified": "2023-08-17",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/40b77d63808dd4f4eafb83949805636735a1fd15/atomics/T1112/T1112.md"
        ],
        "falsepositives": [
          "Legitimate use of the feature (alerts should be investigated either way)"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_allow_rdp_remote_assistance_feature.yml"
      }
    },
    {
      "id": "c7da8edc-49ae-45a2-9e61-9fd860e4e73d",
      "title": "PUA - Sysinternals Tools Execution - Registry",
      "status": "test",
      "description": "Detects the execution of some potentially unwanted tools such as PsExec, Procdump, etc. (part of the Sysinternals suite) via the creation of the \"accepteula\" registry key.",
      "level": "medium",
      "tags": [
        "attack.resource-development",
        "attack.t1588.002"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Active Directory Explorer",
                  "\\Handle",
                  "\\LiveKd",
                  "\\Process Explorer",
                  "\\ProcDump",
                  "\\PsExec",
                  "\\PsLoglist",
                  "\\PsPasswd",
                  "\\SDelete",
                  "\\Sysinternals"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\EulaAccepted",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1588.002"
        ],
        "tactics": [
          "resource_development"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-24",
        "modified": "2025-10-26",
        "references": [
          "https://twitter.com/Moti_B/status/1008587936735035392"
        ],
        "falsepositives": [
          "Legitimate use of SysInternals tools. Filter the legitimate paths used in your environment"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_pua_sysinternals_susp_execution_via_eula.yml"
      }
    },
    {
      "id": "bf9e1387-b040-4393-9851-1598f8ecfae9",
      "title": "Disable Exploit Guard Network Protection on Windows Defender",
      "status": "test",
      "description": "Detects disabling Windows Defender Exploit Guard Network Protection",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "SOFTWARE\\Policies\\Microsoft\\Windows Defender Security Center\\App and Browser protection\\DisallowExploitProtectionOverride",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (00000001)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Austin Songer @austinsonger",
        "date": "2021-08-04",
        "modified": "2023-08-17",
        "references": [
          "https://www.tenforums.com/tutorials/105533-enable-disable-windows-defender-exploit-protection-settings.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_disabled_exploit_guard_net_protection_on_ms_defender.yml"
      }
    },
    {
      "id": "976dd1f2-a484-45ec-aa1d-0e87e882262b",
      "title": "Potential Persistence Via CHM Helper DLL",
      "status": "test",
      "description": "Detects when an attacker modifies the registry key \"HtmlHelp Author\" to achieve persistence",
      "level": "high",
      "tags": [
        "attack.persistence"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Software\\Microsoft\\HtmlHelp Author\\Location",
                  "\\Software\\WOW6432Node\\Microsoft\\HtmlHelp Author\\Location"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-07-21",
        "modified": "2023-08-17",
        "references": [
          "https://persistence-info.github.io/Data/htmlhelpauthor.html",
          "https://www.hexacorn.com/blog/2018/04/22/beyond-good-ol-run-key-part-76/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_persistence_chm.yml"
      }
    },
    {
      "id": "0d7ceeef-3539-4392-8953-3dc664912714",
      "title": "UAC Secure Desktop Prompt Disabled",
      "status": "test",
      "description": "Detects when an attacker tries to change User Account Control (UAC) elevation request destination via the \"PromptOnSecureDesktop\" value.\nThe \"PromptOnSecureDesktop\" setting specifically determines whether UAC prompts are displayed on the secure desktop. The secure desktop is a separate desktop environment that's isolated from other processes running on the system. It's designed to prevent malicious software from intercepting or tampering with UAC prompts.\nWhen \"PromptOnSecureDesktop\" is set to 0, UAC prompts are displayed on the user's current desktop instead of the secure desktop. This reduces the level of security because it potentially exposes the prompts to manipulation by malicious software.\n",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.defense-evasion",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\PromptOnSecureDesktop",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000000)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "privilege_escalation",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2024-05-10",
        "modified": "",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/7e11e9b79583545f208a6dc3fa062f2ed443d999/atomics/T1548.002/T1548.002.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_uac_disable_secure_desktop_prompt.yml"
      }
    },
    {
      "id": "5f9db380-ea57-4d1e-beab-8a2d33397e93",
      "title": "UAC Bypass Using Windows Media Player - Registry",
      "status": "test",
      "description": "Detects the pattern of UAC Bypass using Windows Media Player osksupport.dll (UACMe 32)",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Compatibility Assistant\\Store\\C:\\Program Files\\Windows Media Player\\osk.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "Binary Data",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Christian Burkard (Nextron Systems)",
        "date": "2021-08-23",
        "modified": "2023-08-17",
        "references": [
          "https://github.com/hfiref0x/UACME"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_uac_bypass_wmp.yml"
      }
    },
    {
      "id": "41f6531d-af6e-4c6e-918f-b946f2b85a36",
      "title": "Potential Persistence Via LSA Extensions",
      "status": "test",
      "description": "Detects when an attacker modifies the \"REG_MULTI_SZ\" value named \"Extensions\" to include a custom DLL to achieve persistence via lsass.\nThe \"Extensions\" list contains filenames of DLLs being automatically loaded by lsass.exe. Each DLL has its InitializeLsaExtension() method called after loading.\n",
      "level": "high",
      "tags": [
        "attack.persistence"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\SYSTEM\\CurrentControlSet\\Control\\LsaExtensionConfig\\LsaSrv\\Extensions",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-07-21",
        "modified": "2023-08-17",
        "references": [
          "https://persistence-info.github.io/Data/lsaaextension.html",
          "https://twitter.com/0gtweet/status/1476286368385019906"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_persistence_lsa_extension.yml"
      }
    },
    {
      "id": "e0813366-0407-449a-9869-a2db1119dc41",
      "title": "Suspicious Printer Driver Empty Manufacturer",
      "status": "test",
      "description": "Detects a suspicious printer driver installation with an empty Manufacturer value",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1574",
        "cve.2021-1675"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains_all": {
                "field": "TargetObject",
                "value": [
                  "\\Control\\Print\\Environments\\Windows x64\\Drivers",
                  "\\Manufacturer"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "(Empty)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_cutepdf": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\CutePDF Writer v4.0\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_vnc": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\VNC Printer (PS)\\",
                  "\\VNC Printer (UD)\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_pdf24": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Version-3\\PDF24\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1574"
        ],
        "tactics": [
          "persistence",
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2020-07-01",
        "modified": "2023-08-17",
        "references": [
          "https://twitter.com/SBousseaden/status/1410545674773467140"
        ],
        "falsepositives": [
          "Alerts on legitimate printer drivers that do not set any more details in the Manufacturer value"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_susp_printer_driver.yml"
      }
    },
    {
      "id": "93d298a1-d28f-47f1-a468-d971e7796679",
      "title": "Disable Tamper Protection on Windows Defender",
      "status": "test",
      "description": "Detects disabling Windows Defender Tamper Protection",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Microsoft\\Windows Defender\\Features\\TamperProtection",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000000)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_msmpeng_client": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\MsMpEng.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_msmpeng_domain_controller": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Program Files\\Windows Defender\\MsMpEng.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Austin Songer @austinsonger",
        "date": "2021-08-04",
        "modified": "2023-08-17",
        "references": [
          "https://www.tenforums.com/tutorials/123792-turn-off-tamper-protection-microsoft-defender-antivirus.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_disabled_tamper_protection_on_microsoft_defender.yml"
      }
    },
    {
      "id": "f10ed525-97fe-4fed-be7c-2feecca941b1",
      "title": "Persistence Via Hhctrl.ocx",
      "status": "test",
      "description": "Detects when an attacker modifies the registry value of the \"hhctrl\" to point to a custom binary",
      "level": "high",
      "tags": [
        "attack.persistence"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\CLSID\\{52A2AAAE-085D-4187-97EA-8C30DB990436}\\InprocServer32\\(Default)",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": "C:\\Windows\\System32\\hhctrl.ocx",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-07-21",
        "modified": "2023-08-17",
        "references": [
          "https://persistence-info.github.io/Data/hhctrl.html",
          "https://www.hexacorn.com/blog/2018/04/23/beyond-good-ol-run-key-part-77/"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_hhctrl_persistence.yml"
      }
    },
    {
      "id": "4720b7df-40c3-48fd-bbdf-fd4b3c464f0d",
      "title": "Scheduled TaskCache Change by Uncommon Program",
      "status": "test",
      "description": "Monitor the creation of a new key under 'TaskCache' when a new scheduled task is registered by a process that is not svchost.exe, which is suspicious",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.execution",
        "attack.persistence",
        "attack.t1053",
        "attack.t1053.005"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_empty": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": "(Empty)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_null": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": null,
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_other": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "Microsoft\\Windows\\UpdateOrchestrator",
                  "Microsoft\\Windows\\SoftwareProtectionPlatform\\SvcRestartTask\\Index",
                  "Microsoft\\Windows\\Flighting\\OneSettings\\RefreshCache\\Index"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_mousocoreworker": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "C:\\Windows\\System32\\MoUsoCoreWorker.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_services": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "C:\\Windows\\System32\\services.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_tiworker": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Windows\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\TiWorker.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_svchost": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\WINDOWS\\system32\\svchost.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_ngen": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": "C:\\Windows\\Microsoft.NET\\Framework",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\ngen.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tasks\\{B66B135D-DA06-4FC4-95F8-7458E1D10129}",
                  "\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree\\Microsoft\\Windows\\.NET Framework\\.NET Framework NGEN"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_office": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Microsoft Office\\root\\Integration\\Integrator.exe",
                  "C:\\Program Files (x86)\\Microsoft Office\\root\\Integration\\Integrator.exe",
                  "C:\\Program Files\\Common Files\\microsoft shared\\ClickToRun\\OfficeC2RClient.exe",
                  "C:\\Program Files (x86)\\Common Files\\microsoft shared\\ClickToRun\\OfficeC2RClient.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_msiexec": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\System32\\msiexec.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_explorer": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\explorer.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree\\Microsoft\\Windows\\PLA\\Server Manager Performance Monitor\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_system": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "System",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_runtimebroker": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\System32\\RuntimeBroker.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_dropbox_updater": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\Dropbox\\Update\\DropboxUpdate.exe",
                  "C:\\Program Files\\Dropbox\\Update\\DropboxUpdate.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_edge": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\Microsoft\\EdgeUpdate\\MicrosoftEdgeUpdate.exe",
                  "C:\\Program Files\\Microsoft\\EdgeUpdate\\MicrosoftEdgeUpdate.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_onedrive": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files (x86)\\Microsoft OneDrive\\OneDrive.exe",
                  "C:\\Program Files\\Microsoft OneDrive\\OneDrive.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1053",
          "T1053.005"
        ],
        "tactics": [
          "privilege_escalation",
          "execution",
          "persistence"
        ]
      },
      "meta": {
        "author": "Syed Hasan (@syedhasan009)",
        "date": "2021-06-18",
        "modified": "2025-10-22",
        "references": [
          "https://thedfirreport.com/2021/03/29/sodinokibi-aka-revil-ransomware/",
          "https://labs.f-secure.com/blog/scheduled-task-tampering/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_taskcache_entry.yml"
      }
    },
    {
      "id": "a07f0359-4c90-4dc4-a681-8ffea40b4f47",
      "title": "Service Binary in Suspicious Folder",
      "status": "test",
      "description": "Detect the creation of a service with a service binary located in a suspicious directory",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_service_start": {
            "type": "field_match",
            "matchers": {
              "TargetObject__startswith": {
                "field": "TargetObject",
                "value": "HKLM\\System\\CurrentControlSet\\Services\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Start",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image__contains": {
                "field": "Image",
                "value": [
                  "\\Users\\Public\\",
                  "\\Perflogs\\",
                  "\\ADMIN$\\",
                  "\\Temp\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": [
                  "DWORD (0x00000000)",
                  "DWORD (0x00000001)",
                  "DWORD (0x00000002)"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_service_imagepath": {
            "type": "field_match",
            "matchers": {
              "TargetObject__startswith": {
                "field": "TargetObject",
                "value": "HKLM\\System\\CurrentControlSet\\Services\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\ImagePath",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__contains": {
                "field": "Details",
                "value": [
                  "\\Users\\Public\\",
                  "\\Perflogs\\",
                  "\\ADMIN$\\",
                  "\\Temp\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_avast": {
            "type": "field_match",
            "matchers": {
              "Image__contains_all": {
                "field": "Image",
                "value": [
                  "\\Common Files\\",
                  "\\Temp\\"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_mbamservice": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\CurrentControlSet\\Services\\MBAMInstallerService\\ImagePath",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__endswith": {
                "field": "Details",
                "value": "\\AppData\\Local\\Temp\\MBAMInstallerService.exe\"",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\system32\\services.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "1 of selection_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "1 of selection_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems), frack113",
        "date": "2022-05-02",
        "modified": "2025-10-07",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.001/T1562.001.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_creation_service_susp_folder.yml"
      }
    },
    {
      "id": "724ea201-6514-4f38-9739-e5973c34f49a",
      "title": "Bypass UAC Using SilentCleanup Task",
      "status": "test",
      "description": "Detects the setting of the environement variable \"windir\" to a non default value.\nAttackers often abuse this variable in order to trigger a UAC bypass via the \"SilentCleanup\" task.\nThe SilentCleanup task located in %windir%\\system32\\cleanmgr.exe is an auto-elevated task that can be abused to elevate any file with administrator privileges without prompting UAC.\n",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.defense-evasion",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Environment\\windir",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_default": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": "%SystemRoot%",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "privilege_escalation",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113, Nextron Systems",
        "date": "2022-01-06",
        "modified": "2024-01-30",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1548.002/T1548.002.md#atomic-test-9---bypass-uac-using-silentcleanup-task",
          "https://www.reddit.com/r/hacking/comments/ajtrws/bypassing_highest_uac_level_windows_810/",
          "https://www.fortinet.com/blog/threat-research/enter-the-darkgate-new-cryptocurrency-mining-and-ransomware-campaign"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_bypass_uac_using_silentcleanup_task.yml"
      }
    },
    {
      "id": "ee77a5db-b0f3-4be2-bfd4-b58be1c6b15a",
      "title": "Potential Attachment Manager Settings Attachments Tamper",
      "status": "test",
      "description": "Detects tampering with attachment manager settings policies attachments (See reference for more information)",
      "level": "high",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_main": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Attachments\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_value_hide_zone_info": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\HideZoneInfoOnProperties",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000001)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_value_save_zone_info": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\SaveZoneInformation",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000002)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_value_scan_with_av": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\ScanWithAntiVirus",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000001)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_main and 1 of selection_value_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_main"
            },
            {
              "type": "ref",
              "value": "1 of selection_value_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-08-01",
        "modified": "2023-08-17",
        "references": [
          "https://support.microsoft.com/en-us/topic/information-about-the-attachment-manager-in-microsoft-windows-c48a4dcd-8de5-2af5-ee9b-cd795ae42738",
          "https://www.virustotal.com/gui/file/2bcd5702a7565952c44075ac6fb946c7780526640d1264f692c7664c02c68465"
        ],
        "falsepositives": [
          "Unlikely"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_policies_attachments_tamper.yml"
      }
    },
    {
      "id": "4eec988f-7bf0-49f1-8675-1e6a510b3a2a",
      "title": "Potential PendingFileRenameOperations Tampering",
      "status": "test",
      "description": "Detect changes to the \"PendingFileRenameOperations\" registry key from uncommon or suspicious images locations to stage currently used files for rename or deletion after reboot.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1036.003"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_main": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\CurrentControlSet\\Control\\Session Manager\\PendingFileRenameOperations",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_susp_paths": {
            "type": "field_match",
            "matchers": {
              "Image__contains": {
                "field": "Image",
                "value": "\\Users\\Public\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection_susp_images": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": [
                  "\\reg.exe",
                  "\\regedit.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_main and 1 of selection_susp_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection_main"
            },
            {
              "type": "ref",
              "value": "1 of selection_susp_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1036.003"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2023-01-27",
        "modified": "2025-10-07",
        "references": [
          "https://any.run/report/3ecd4763ffc944fdc67a9027e459cd4f448b1a8d1b36147977afaf86bbf2a261/64b0ba45-e7ce-423b-9a1d-5b4ea59521e6",
          "https://devblogs.microsoft.com/scripting/determine-pending-reboot-statuspowershell-style-part-1/",
          "https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/cc960241(v=technet.10)?redirectedfrom=MSDN",
          "https://www.trendmicro.com/en_us/research/21/j/purplefox-adds-new-backdoor-that-uses-websockets.html",
          "https://www.trendmicro.com/en_us/research/19/i/purple-fox-fileless-malware-with-rookit-component-delivered-by-rig-exploit-kit-now-abuses-powershell.html"
        ],
        "falsepositives": [
          "Installers and updaters may set currently in use files for rename or deletion after a reboot."
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_susp_pendingfilerenameoperations.yml"
      }
    },
    {
      "id": "b23818c7-e575-4d13-8012-332075ec0a2b",
      "title": "Register New IFiltre For Persistence",
      "status": "test",
      "description": "Detects when an attacker registers a new IFilter for an extension. Microsoft Windows Search uses filters to extract the content of items for inclusion in a full-text index.\nYou can extend Windows Search to index new or proprietary file types by writing filters to extract the content, and property handlers to extract the properties of files.\n",
      "level": "medium",
      "tags": [
        "attack.persistence"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_ext": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains_all": {
                "field": "TargetObject",
                "value": [
                  "\\SOFTWARE\\Classes\\.",
                  "\\PersistentHandler"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_clsid": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains_all": {
                "field": "TargetObject",
                "value": [
                  "\\SOFTWARE\\Classes\\CLSID",
                  "\\PersistentAddinsRegistered\\{89BCB740-6119-101A-BCB7-00DD010655AF}"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_default_targets": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\CLSID\\{4F46F75F-199F-4C63-8B7D-86D48FE7970C}\\",
                  "\\CLSID\\{4887767F-7ADC-4983-B576-88FB643D6F79}\\",
                  "\\CLSID\\{D3B41FA1-01E3-49AF-AA25-1D0D824275AE}\\",
                  "\\CLSID\\{72773E1A-B711-4d8d-81FA-B9A43B0650DD}\\",
                  "\\CLSID\\{098f2470-bae0-11cd-b579-08002b30bfeb}\\",
                  "\\CLSID\\{1AA9BF05-9A97-48c1-BA28-D9DCE795E93C}\\",
                  "\\CLSID\\{2e2294a9-50d7-4fe7-a09f-e6492e185884}\\",
                  "\\CLSID\\{34CEAC8D-CBC0-4f77-B7B1-8A60CB6DA0F7}\\",
                  "\\CLSID\\{3B224B11-9363-407e-850F-C9E1FFACD8FB}\\",
                  "\\CLSID\\{3DDEB7A4-8ABF-4D82-B9EE-E1F4552E95BE}\\",
                  "\\CLSID\\{5645C8C1-E277-11CF-8FDA-00AA00A14F93}\\",
                  "\\CLSID\\{5645C8C4-E277-11CF-8FDA-00AA00A14F93}\\",
                  "\\CLSID\\{58A9EBF6-5755-4554-A67E-A2467AD1447B}\\",
                  "\\CLSID\\{5e941d80-bf96-11cd-b579-08002b30bfeb}\\",
                  "\\CLSID\\{698A4FFC-63A3-4E70-8F00-376AD29363FB}\\",
                  "\\CLSID\\{7E9D8D44-6926-426F-AA2B-217A819A5CCE}\\",
                  "\\CLSID\\{8CD34779-9F10-4f9b-ADFB-B3FAEABDAB5A}\\",
                  "\\CLSID\\{9694E38A-E081-46ac-99A0-8743C909ACB6}\\",
                  "\\CLSID\\{98de59a0-d175-11cd-a7bd-00006b827d94}\\",
                  "\\CLSID\\{AA10385A-F5AA-4EFF-B3DF-71B701E25E18}\\",
                  "\\CLSID\\{B4132098-7A03-423D-9463-163CB07C151F}\\",
                  "\\CLSID\\{d044309b-5da6-4633-b085-4ed02522e5a5}\\",
                  "\\CLSID\\{D169C14A-5148-4322-92C8-754FC9D018D8}\\",
                  "\\CLSID\\{DD75716E-B42E-4978-BB60-1497B92E30C4}\\",
                  "\\CLSID\\{E2F83EED-62DE-4A9F-9CD0-A1D40DCD13B6}\\",
                  "\\CLSID\\{E772CEB3-E203-4828-ADF1-765713D981B8}\\",
                  "\\CLSID\\{eec97550-47a9-11cf-b952-00aa0051fe20}",
                  "\\CLSID\\{FB10BD80-A331-4e9e-9EB7-00279903AD99}\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_generic_paths": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Windows\\System32\\",
                  "C:\\Program Files (x86)\\",
                  "C:\\Program Files\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "1 of selection_* and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "1 of selection_*"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-07-21",
        "modified": "2024-03-26",
        "references": [
          "https://persistence-info.github.io/Data/ifilters.html",
          "https://twitter.com/0gtweet/status/1468548924600459267",
          "https://github.com/gtworek/PSBits/tree/master/IFilter",
          "https://github.com/gtworek/PSBits/blob/8d767892f3b17eefa4d0668f5d2df78e844f01d8/IFilter/Dll.cpp#L281-L308"
        ],
        "falsepositives": [
          "Legitimate registration of IFilters by the OS or software"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_persistence_ifilter.yml"
      }
    },
    {
      "id": "d223b46b-5621-4037-88fe-fda32eead684",
      "title": "New Root or CA or AuthRoot Certificate to Store",
      "status": "test",
      "description": "Detects the addition of new root, CA or AuthRoot certificates to the Windows registry",
      "level": "medium",
      "tags": [
        "attack.impact",
        "attack.t1490"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\SOFTWARE\\Microsoft\\SystemCertificates\\Root\\Certificates\\",
                  "\\SOFTWARE\\Policies\\Microsoft\\SystemCertificates\\Root\\Certificates\\",
                  "\\SOFTWARE\\Microsoft\\EnterpriseCertificates\\Root\\Certificates\\",
                  "\\SOFTWARE\\Microsoft\\SystemCertificates\\CA\\Certificates\\",
                  "\\SOFTWARE\\Policies\\Microsoft\\SystemCertificates\\CA\\Certificates\\",
                  "\\SOFTWARE\\Microsoft\\EnterpriseCertificates\\CA\\Certificates\\",
                  "\\SOFTWARE\\Microsoft\\SystemCertificates\\AuthRoot\\Certificates\\",
                  "\\SOFTWARE\\Policies\\Microsoft\\SystemCertificates\\AuthRoot\\Certificates\\",
                  "\\SOFTWARE\\Microsoft\\EnterpriseCertificates\\AuthRoot\\Certificates\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Blob",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "Binary Data",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1490"
        ],
        "tactics": [
          "impact"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-04-04",
        "modified": "2023-08-17",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1553.004/T1553.004.md#atomic-test-6---add-root-certificate-to-currentuser-certificate-store",
          "https://posts.specterops.io/code-signing-certificate-cloning-attacks-and-defenses-6f98657fc6ec"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_install_root_or_ca_certificat.yml"
      }
    },
    {
      "id": "974515da-6cc5-4c95-ae65-f97f9150ec7f",
      "title": "Disable Microsoft Defender Firewall via Registry",
      "status": "test",
      "description": "Adversaries may disable or modify system firewalls in order to bypass controls limiting network usage",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.004"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\EnableFirewall",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000000)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.004"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-09",
        "modified": "2024-03-25",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.004/T1562.004.md#atomic-test-2---disable-microsoft-defender-firewall-via-registry"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_disable_defender_firewall.yml"
      }
    },
    {
      "id": "3390fbef-c98d-4bdd-a863-d65ed7c610dd",
      "title": "New ODBC Driver Registered",
      "status": "test",
      "description": "Detects the registration of a new ODBC driver.",
      "level": "low",
      "tags": [
        "attack.persistence"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\ODBC\\ODBCINST.INI\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Driver",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_sqlserver": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\SQL Server\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "%WINDIR%\\System32\\SQLSRV32.dll",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_office_access": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Microsoft Access ",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__startswith": {
                "field": "Details",
                "value": "C:\\Progra",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__endswith": {
                "field": "Details",
                "value": "\\ACEODBC.DLL",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_office_excel": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Microsoft Excel Driver",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__startswith": {
                "field": "Details",
                "value": "C:\\Progra",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__endswith": {
                "field": "Details",
                "value": "\\ACEODBC.DLL",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-05-23",
        "modified": "2023-08-17",
        "references": [
          "https://www.hexacorn.com/blog/2020/08/23/odbcconf-lolbin-trifecta/"
        ],
        "falsepositives": [
          "Likely"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_odbc_driver_registered.yml"
      }
    },
    {
      "id": "092af964-4233-4373-b4ba-d86ea2890288",
      "title": "Add Debugger Entry To AeDebug For Persistence",
      "status": "test",
      "description": "Detects when an attacker adds a new \"Debugger\" value to the \"AeDebug\" key in order to achieve persistence which will get invoked when an application crashes",
      "level": "medium",
      "tags": [
        "attack.persistence"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\AeDebug\\Debugger",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__endswith": {
                "field": "Details",
                "value": ".dll",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": "\"C:\\WINDOWS\\system32\\vsjitdebugger.exe\" -p %ld -e %ld -j 0x%p",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-07-21",
        "modified": "2023-08-17",
        "references": [
          "https://persistence-info.github.io/Data/aedebug.html",
          "https://learn.microsoft.com/en-us/windows/win32/debug/configuring-automatic-debugging"
        ],
        "falsepositives": [
          "Legitimate use of the key to setup a debugger. Which is often the case on developers machines"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_aedebug_persistence.yml"
      }
    },
    {
      "id": "7530b96f-ad8e-431d-a04d-ac85cc461fdc",
      "title": "Custom File Open Handler Executes PowerShell",
      "status": "test",
      "description": "Detects the abuse of custom file open handler, executing powershell",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1202"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "shell\\open\\command\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__contains_all": {
                "field": "Details",
                "value": [
                  "powershell",
                  "-command"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1202"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "CD_R0M_",
        "date": "2022-06-11",
        "modified": "2023-08-17",
        "references": [
          "https://news.sophos.com/en-us/2022/02/01/solarmarker-campaign-used-novel-registry-changes-to-establish-persistence/?cmp=30728"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_custom_file_open_handler_powershell_execution.yml"
      }
    },
    {
      "id": "ab871450-37dc-4a3a-997f-6662aa8ae0f1",
      "title": "Disable Macro Runtime Scan Scope",
      "status": "test",
      "description": "Detects tampering with the MacroRuntimeScanScope registry key to disable runtime scanning of enabled macros",
      "level": "high",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains_all": {
                "field": "TargetObject",
                "value": [
                  "\\SOFTWARE\\",
                  "\\Microsoft\\Office\\",
                  "\\Common\\Security"
                ],
                "modifiers": [
                  "contains",
                  "all"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\MacroRuntimeScanScope",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000000)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-10-25",
        "modified": "2023-08-17",
        "references": [
          "https://www.microsoft.com/en-us/security/blog/2018/09/12/office-vba-amsi-parting-the-veil-on-malicious-macros/",
          "https://admx.help/?Category=Office2016&Policy=office16.Office.Microsoft.Policies.Windows::L_MacroRuntimeScanScope",
          "https://github.com/S3cur3Th1sSh1t/OffensiveVBA/blob/28cc6a2802d8176195ac19b3c8e9a749009a82a3/src/AMSIbypasses.vba"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_disable_macroruntimescanscope.yml"
      }
    },
    {
      "id": "9d3436ef-9476-4c43-acca-90ce06bdf33a",
      "title": "DHCP Callout DLL Installation",
      "status": "test",
      "description": "Detects the installation of a Callout DLL via CalloutDlls and CalloutEnabled parameter in Registry, which can be used to execute code in context of the DHCP server (restart required)",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1574.001",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "\\Services\\DHCPServer\\Parameters\\CalloutDlls",
                  "\\Services\\DHCPServer\\Parameters\\CalloutEnabled"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1574.001",
          "T1112"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Dimitrios Slamaris",
        "date": "2017-05-15",
        "modified": "2023-08-17",
        "references": [
          "https://blog.3or.de/mimilib-dhcp-server-callout-dll-injection.html",
          "https://technet.microsoft.com/en-us/library/cc726884(v=ws.10).aspx",
          "https://msdn.microsoft.com/de-de/library/windows/desktop/aa363389(v=vs.85).aspx"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_dhcp_calloutdll.yml"
      }
    },
    {
      "id": "baecf8fb-edbf-429f-9ade-31fc3f22b970",
      "title": "Office Autorun Keys Modification",
      "status": "test",
      "description": "Detects modification of autostart extensibility point (ASEP) in registry.",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_office_root": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Software\\Wow6432Node\\Microsoft\\Office",
                  "\\Software\\Microsoft\\Office"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_office_details": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Word\\Addins",
                  "\\PowerPoint\\Addins",
                  "\\Outlook\\Addins",
                  "\\Onenote\\Addins",
                  "\\Excel\\Addins",
                  "\\Access\\Addins",
                  "test\\Special\\Perf"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_empty": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": "(Empty)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_main_known_addins": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Microsoft Office\\",
                  "C:\\Program Files (x86)\\Microsoft Office\\",
                  "C:\\Windows\\System32\\msiexec.exe",
                  "C:\\Windows\\System32\\regsvr32.exe"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Excel\\Addins\\AdHocReportingExcelClientLib.AdHocReportingExcelClientAddIn.1\\",
                  "\\Excel\\Addins\\ExcelPlugInShell.PowerMapConnect\\",
                  "\\Excel\\Addins\\NativeShim\\",
                  "\\Excel\\Addins\\NativeShim.InquireConnector.1\\",
                  "\\Excel\\Addins\\PowerPivotExcelClientAddIn.NativeEntry.1\\",
                  "\\Outlook\\AddIns\\AccessAddin.DC\\",
                  "\\Outlook\\AddIns\\ColleagueImport.ColleagueImportAddin\\",
                  "\\Outlook\\AddIns\\EvernoteCC.EvernoteContactConnector\\",
                  "\\Outlook\\AddIns\\EvernoteOLRD.Connect\\",
                  "\\Outlook\\Addins\\Microsoft.VbaAddinForOutlook.1\\",
                  "\\Outlook\\Addins\\OcOffice.OcForms\\",
                  "\\Outlook\\Addins\\\\OneNote.OutlookAddin",
                  "\\Outlook\\Addins\\OscAddin.Connect\\",
                  "\\Outlook\\Addins\\OutlookChangeNotifier.Connect\\",
                  "\\Outlook\\Addins\\UCAddin.LyncAddin.1",
                  "\\Outlook\\Addins\\UCAddin.UCAddin.1",
                  "\\Outlook\\Addins\\UmOutlookAddin.FormRegionAddin\\",
                  "AddinTakeNotesService\\FriendlyName"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_officeclicktorun": {
            "type": "field_match",
            "matchers": {
              "Image__startswith": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\",
                  "C:\\Program Files\\Common Files\\Microsoft Shared\\ClickToRun\\Updates\\"
                ],
                "modifiers": [
                  "startswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Image__endswith": {
                "field": "Image",
                "value": "\\OfficeClickToRun.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_avg": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\AVG\\Antivirus\\RegSvr.exe",
                  "C:\\Program Files\\AVG\\Antivirus\\x86\\RegSvr.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Microsoft\\Office\\Outlook\\Addins\\Antivirus.AsOutExt\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_avast": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Program Files\\Avast Software\\Avast\\RegSvr.exe",
                  "C:\\Program Files\\Avast Software\\Avast\\x86\\RegSvr.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Microsoft\\Office\\Outlook\\Addins\\Avast.AsOutExt\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_office_* and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "all of selection_office_*"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1547.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split)",
        "date": "2019-10-25",
        "modified": "2025-10-17",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md",
          "https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns",
          "https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d"
        ],
        "falsepositives": [
          "Legitimate software automatically (mostly, during installation) sets up autorun keys for legitimate reason",
          "Legitimate administrator sets up autorun keys for legitimate reason"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_office.yml"
      }
    },
    {
      "id": "160d2780-31f7-4922-8b3a-efce30e63e96",
      "title": "Potential AMSI COM Server Hijacking",
      "status": "test",
      "description": "Detects changes to the AMSI come server registry key in order disable AMSI scanning functionalities. When AMSI attempts to starts its COM component, it will query its registered CLSID and return a non-existent COM server. This causes a load failure and prevents any scanning methods from being accessed, ultimately rendering AMSI useless",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\CLSID\\{fdb00e52-a214-4aa1-8fba-4357bb0072ec}\\InProcServer32\\(Default)",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": "%windir%\\system32\\amsi.dll",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-01-04",
        "modified": "2023-08-17",
        "references": [
          "https://enigma0x3.net/2017/07/19/bypassing-amsi-via-com-server-hijacking/",
          "https://github.com/r00t-3xp10it/hacking-material-books/blob/43cb1e1932c16ff1f58b755bc9ab6b096046853f/obfuscation/simple_obfuscation.md#amsi-comreg-bypass"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_amsi_com_hijack.yml"
      }
    },
    {
      "id": "8839e550-52d7-4958-9f2f-e13c1e736838",
      "title": "Security Event Logging Disabled via MiniNt Registry Key - Registry Set",
      "status": "experimental",
      "description": "Detects the addition of the 'MiniNt' key to the registry. Upon a reboot, Windows Event Log service will stop writing events.\nWindows Event Log is a service that collects and stores event logs from the operating system and applications. It is an important component of Windows security and auditing.\nAdversary may want to disable this service to disable logging of security events which could be used to detect their activities.\n",
      "level": "high",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1562.002",
        "attack.t1112",
        "car.2022-03-001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject": {
                "field": "TargetObject",
                "value": "HKLM\\System\\CurrentControlSet\\Control\\MiniNt\\(Default)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.002",
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Swachchhanda Shrawan Poudel (Nextron Systems)",
        "date": "2025-04-09",
        "modified": "",
        "references": [
          "https://www.hackingarticles.in/defense-evasion-windows-event-logging-t1562-002/"
        ],
        "falsepositives": [
          "Highly Unlikely"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_create_minint_key.yml"
      }
    },
    {
      "id": "1c3121ed-041b-4d97-a075-07f54f20fb4a",
      "title": "Registry Explorer Policy Modification",
      "status": "test",
      "description": "Detects registry modifications that disable internal tools or functions in explorer (malware like Agent Tesla uses this technique)",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_set_1": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoLogOff",
                  "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoDesktop",
                  "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoRun",
                  "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoFind",
                  "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoControlPanel",
                  "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoFileMenu",
                  "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoClose",
                  "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoSetTaskbar",
                  "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoPropertiesMyDocuments",
                  "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoTrayContextMenu"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000001)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection_set_1",
        "condition_parsed": {
          "op": "single",
          "selection": "selection_set_1"
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-03-18",
        "modified": "2023-08-17",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1112/T1112.md"
        ],
        "falsepositives": [
          "Legitimate admin script"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_set_nopolicies_user.yml"
      }
    },
    {
      "id": "f7997770-92c3-4ec9-b112-774c4ef96f96",
      "title": "Winlogon AllowMultipleTSSessions Enable",
      "status": "test",
      "description": "Detects when the 'AllowMultipleTSSessions' value is enabled.\nWhich allows for multiple Remote Desktop connection sessions to be opened at once.\nThis is often used by attacker as a way to connect to an RDP session without disconnecting the other users\n",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\AllowMultipleTSSessions",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__endswith": {
                "field": "Details",
                "value": "DWORD (0x00000001)",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-09-09",
        "modified": "2023-08-17",
        "references": [
          "http://blog.talosintelligence.com/2022/09/lazarus-three-rats.html"
        ],
        "falsepositives": [
          "Legitimate use of the multi session functionality"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_winlogon_allow_multiple_tssessions.yml"
      }
    },
    {
      "id": "bf344fea-d947-4ef4-9192-34d008315d3a",
      "title": "Suspicious Shim Database Patching Activity",
      "status": "test",
      "description": "Detects installation of new shim databases that try to patch sections of known processes for potential process injection or persistence.",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1546.011"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Custom\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "\\csrss.exe",
                  "\\dllhost.exe",
                  "\\explorer.exe",
                  "\\RuntimeBroker.exe",
                  "\\services.exe",
                  "\\sihost.exe",
                  "\\svchost.exe",
                  "\\taskhostw.exe",
                  "\\winlogon.exe",
                  "\\WmiPrvSe.exe"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1546.011"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-08-01",
        "modified": "2023-12-06",
        "references": [
          "https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/pillowmint-fin7s-monkey-thief/",
          "https://www.fireeye.com/blog/threat-research/2017/05/fin7-shim-databases-persistence.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_persistence_shim_database_susp_application.yml"
      }
    },
    {
      "id": "18f2065c-d36c-464a-a748-bcf909acb2e3",
      "title": "Wow6432Node Classes Autorun Keys Modification",
      "status": "test",
      "description": "Detects modification of autostart extensibility point (ASEP) in registry.",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "wow_classes_base": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Software\\Wow6432Node\\Classes",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "wow_classes": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Folder\\ShellEx\\ExtShellFolderViews",
                  "\\Folder\\ShellEx\\DragDropHandlers",
                  "\\Folder\\ShellEx\\ColumnHandlers",
                  "\\Directory\\Shellex\\DragDropHandlers",
                  "\\Directory\\Shellex\\CopyHookHandlers",
                  "\\CLSID\\{AC757296-3522-4E11-9862-C17BE5A1767E}\\Instance",
                  "\\CLSID\\{ABE3B9A4-257D-4B97-BD1A-294AF496222E}\\Instance",
                  "\\CLSID\\{7ED96837-96F0-4812-B211-F13C24117ED3}\\Instance",
                  "\\CLSID\\{083863F1-70DE-11d0-BD40-00A0C911CE86}\\Instance",
                  "\\AllFileSystemObjects\\ShellEx\\DragDropHandlers",
                  "\\ShellEx\\PropertySheetHandlers",
                  "\\ShellEx\\ContextMenuHandlers"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": "(Empty)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "wow_classes_base and wow_classes and not filter",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "wow_classes_base"
            },
            {
              "type": "ref",
              "value": "wow_classes"
            },
            {
              "type": "not",
              "value": "filter"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1547.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split)",
        "date": "2019-10-25",
        "modified": "2023-08-17",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md",
          "https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns",
          "https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d"
        ],
        "falsepositives": [
          "Legitimate software automatically (mostly, during installation) sets up autorun keys for legitimate reason",
          "Legitimate administrator sets up autorun keys for legitimate reason"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_wow6432node_classes.yml"
      }
    },
    {
      "id": "a1e11042-a74a-46e6-b07c-c4ce8ecc239b",
      "title": "Potential Persistence Via Event Viewer Events.asp",
      "status": "test",
      "description": "Detects potential registry persistence technique using the Event Viewer \"Events.asp\" technique",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Microsoft\\Windows NT\\CurrentVersion\\Event Viewer\\MicrosoftRedirectionProgram",
                  "\\Microsoft\\Windows NT\\CurrentVersion\\Event Viewer\\MicrosoftRedirectionURL"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_default_redirect_program": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "C:\\WINDOWS\\system32\\svchost.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Microsoft\\Windows NT\\CurrentVersion\\Event Viewer\\MicrosoftRedirectionProgram",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "%%SystemRoot%%\\PCHealth\\HelpCtr\\Binaries\\HelpCtr.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_default_redirect_program_cli": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "C:\\WINDOWS\\system32\\svchost.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Microsoft\\Windows NT\\CurrentVersion\\Event Viewer\\MicrosoftRedirectionProgramCommandLineParameters",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "-url hcp://services/centers/support?topic=%%s",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_url": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": "http://go.microsoft.com/fwlink/events.asp",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_cleaner": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": "(Empty)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-02-17",
        "modified": "2023-03-05",
        "references": [
          "https://twitter.com/nas_bench/status/1626648985824788480",
          "https://admx.help/?Category=Windows_7_2008R2&Policy=Microsoft.Policies.InternetCommunicationManagement::EventViewer_DisableLinks",
          "https://www.hexacorn.com/blog/2019/02/15/beyond-good-ol-run-key-part-103/",
          "https://github.com/redcanaryco/atomic-red-team/blob/f296668303c29d3f4c07e42bdd2b28d8dd6625f9/atomics/T1112/T1112.md"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_persistence_event_viewer_events_asp.yml"
      }
    },
    {
      "id": "6597be7b-ac61-4ac8-bef4-d3ec88174853",
      "title": "UAC Bypass Abusing Winsat Path Parsing - Registry",
      "status": "test",
      "description": "Detects the pattern of UAC Bypass using a path parsing issue in winsat.exe (UACMe 52)",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548.002"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Root\\InventoryApplicationFile\\winsat.exe|",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\LowerCaseLongPath",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__startswith": {
                "field": "Details",
                "value": "c:\\users\\",
                "modifiers": [
                  "startswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__endswith": {
                "field": "Details",
                "value": "\\appdata\\local\\temp\\system32\\winsat.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Christian Burkard (Nextron Systems)",
        "date": "2021-08-30",
        "modified": "2023-08-17",
        "references": [
          "https://github.com/hfiref0x/UACME"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_uac_bypass_winsat.yml"
      }
    },
    {
      "id": "e7a2fd40-3ae1-4a85-bf80-15cf624fb1b1",
      "title": "System Scripts Autorun Keys Modification",
      "status": "test",
      "description": "Detects modification of autostart extensibility point (ASEP) in registry.",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.t1547.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "scripts_base": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Software\\Policies\\Microsoft\\Windows\\System\\Scripts",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "scripts": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Startup",
                  "\\Shutdown",
                  "\\Logon",
                  "\\Logoff"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": "(Empty)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "scripts_base and scripts and not filter",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "scripts_base"
            },
            {
              "type": "ref",
              "value": "scripts"
            },
            {
              "type": "not",
              "value": "filter"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1547.001"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence"
        ]
      },
      "meta": {
        "author": "Victor Sergeev, Daniil Yugoslavskiy, Gleb Sukhodolskiy, Timur Zinniatullin, oscd.community, Tim Shelton, frack113 (split)",
        "date": "2019-10-25",
        "modified": "2023-08-17",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.001/T1547.001.md",
          "https://learn.microsoft.com/en-us/sysinternals/downloads/autoruns",
          "https://gist.github.com/GlebSukhodolskiy/0fc5fa5f482903064b448890db1eaf9d"
        ],
        "falsepositives": [
          "Legitimate software automatically (mostly, during installation) sets up autorun keys for legitimate reason",
          "Legitimate administrator sets up autorun keys for legitimate reason"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_asep_reg_keys_modification_system_scripts.yml"
      }
    },
    {
      "id": "396ae3eb-4174-4b9b-880e-dc0364d78a19",
      "title": "Potential Persistence Via Outlook LoadMacroProviderOnBoot Setting",
      "status": "test",
      "description": "Detects the modification of Outlook setting \"LoadMacroProviderOnBoot\" which if enabled allows the automatic loading of any configured VBA project/module",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.command-and-control",
        "attack.t1137",
        "attack.t1008",
        "attack.t1546"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Outlook\\LoadMacroProviderOnBoot",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__contains": {
                "field": "Details",
                "value": "0x00000001",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1137",
          "T1008",
          "T1546"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "command_and_control"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2021-04-05",
        "modified": "2023-08-17",
        "references": [
          "https://speakerdeck.com/heirhabarov/hunting-for-persistence-via-microsoft-exchange-server-or-outlook?slide=53",
          "https://www.linkedin.com/pulse/outlook-backdoor-using-vba-samir-b-/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_office_outlook_enable_load_macro_provider_on_boot.yml"
      }
    },
    {
      "id": "63647769-326d-4dde-a419-b925cc0caf42",
      "title": "Enable Microsoft Dynamic Data Exchange",
      "status": "test",
      "description": "Enable Dynamic Data Exchange protocol (DDE) in all supported editions of Microsoft Word or Excel.",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1559.002"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_word": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Word\\Security\\AllowDDE",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": [
                  "DWORD (0x00000001)",
                  "DWORD (0x00000002)"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_excel": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "\\Excel\\Security\\DisableDDEServerLaunch",
                  "\\Excel\\Security\\DisableDDEServerLookup"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000000)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection_*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection_"
        }
      },
      "mitre": {
        "techniques": [
          "T1559.002"
        ],
        "tactics": [
          "execution"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-02-26",
        "modified": "2023-08-17",
        "references": [
          "https://msrc.microsoft.com/update-guide/vulnerability/ADV170021"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_office_enable_dde.yml"
      }
    },
    {
      "id": "ac9159cc-c364-4304-8f0a-d63fc1a0aabb",
      "title": "ClickOnce Trust Prompt Tampering",
      "status": "test",
      "description": "Detects changes to the ClickOnce trust prompt registry key in order to enable an installation from different locations such as the Internet.",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\MICROSOFT\\.NETFramework\\Security\\TrustManager\\PromptingLevel\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "\\Internet",
                  "\\LocalIntranet",
                  "\\MyComputer",
                  "\\TrustedSites",
                  "\\UntrustedSites"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "Enabled",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1112"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "@SerkinValery, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-06-12",
        "modified": "2023-08-17",
        "references": [
          "https://posts.specterops.io/less-smartscreen-more-caffeine-ab-using-clickonce-for-trusted-code-execution-1446ea8051c5",
          "https://learn.microsoft.com/en-us/visualstudio/deployment/how-to-configure-the-clickonce-trust-prompt-behavior"
        ],
        "falsepositives": [
          "Legitimate internal requirements."
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_clickonce_trust_prompt.yml"
      }
    },
    {
      "id": "5a5152f1-463f-436b-b2f5-8eceb3964b42",
      "title": "Displaying Hidden Files Feature Disabled",
      "status": "test",
      "description": "Detects modifications to the \"Hidden\" and \"ShowSuperHidden\" explorer registry values in order to disable showing of hidden files and system files.\nThis technique is abused by several malware families to hide their files from normal users.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1564.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\ShowSuperHidden",
                  "\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\Hidden"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000000)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1564.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-04-02",
        "modified": "2024-03-26",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1564.001/T1564.001.md#atomic-test-8---hide-files-through-registry"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_hide_file.yml"
      }
    },
    {
      "id": "5a2b21ee-6aaa-4234-ac9d-59a59edf90a1",
      "title": "Persistence Via New SIP Provider",
      "status": "test",
      "description": "Detects when an attacker register a new SIP provider for persistence and defense evasion",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1553.003"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_root": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\SOFTWARE\\Microsoft\\Cryptography\\Providers\\",
                  "\\SOFTWARE\\Microsoft\\Cryptography\\OID\\EncodingType",
                  "\\SOFTWARE\\WOW6432Node\\Microsoft\\Cryptography\\Providers\\",
                  "\\SOFTWARE\\WOW6432Node\\Microsoft\\Cryptography\\OID\\EncodingType"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "selection_dll": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Dll",
                  "\\$DLL"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": [
                  "WINTRUST.DLL",
                  "mso.dll"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_poqexec": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Windows\\System32\\poqexec.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\CryptSIPDll",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "C:\\Windows\\System32\\PsfSip.dll",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "all of selection_* and not 1 of filter*",
        "condition_parsed": {
          "op": "all_of_and_not_1_of",
          "all_of": "selection_",
          "none_of": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1553.003"
        ],
        "tactics": [
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-07-21",
        "modified": "2023-08-17",
        "references": [
          "https://persistence-info.github.io/Data/codesigning.html",
          "https://github.com/gtworek/PSBits/tree/master/SIP",
          "https://specterops.io/assets/resources/SpecterOps_Subverting_Trust_in_Windows.pdf"
        ],
        "falsepositives": [
          "Legitimate SIP being registered by the OS or different software."
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_sip_persistence.yml"
      }
    },
    {
      "id": "1547e27c-3974-43e2-a7d7-7f484fb928ec",
      "title": "Registry Persistence via Service in Safe Mode",
      "status": "test",
      "description": "Detects the modification of the registry to allow a driver or service to persist in Safe Mode.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1564.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Control\\SafeBoot\\Minimal\\",
                  "\\Control\\SafeBoot\\Network\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\(Default)",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "Service",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_optional_sophos": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\WINDOWS\\system32\\msiexec.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "\\Control\\SafeBoot\\Minimal\\SAVService\\(Default)",
                  "\\Control\\SafeBoot\\Network\\SAVService\\(Default)"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_optional_mbamservice": {
            "type": "field_match",
            "matchers": {
              "Image__endswith": {
                "field": "Image",
                "value": "\\MBAMInstallerService.exe",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\MBAMService\\(Default)",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "Service",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_hexnode": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": "C:\\Hexnode\\Hexnode Agent\\Current\\HexnodeAgent.exe",
                "modifiers": [],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "\\Control\\SafeBoot\\Minimal\\Hexnode Updater\\(Default)",
                  "\\Control\\SafeBoot\\Network\\Hexnode Updater\\(Default)",
                  "\\Control\\SafeBoot\\Minimal\\Hexnode Agent\\(Default)",
                  "\\Control\\SafeBoot\\Network\\Hexnode Agent\\(Default)"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "Service",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1564.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-04-04",
        "modified": "2025-10-22",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1112/T1112.md#atomic-test-33---windows-add-registry-value-to-load-service-in-safe-mode-without-network",
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1112/T1112.md#atomic-test-34---windows-add-registry-value-to-load-service-in-safe-mode-with-network"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_add_load_service_in_safe_mode.yml"
      }
    },
    {
      "id": "92772523-d9c1-4c93-9547-b0ca500baba3",
      "title": "Potential Persistence Via Mpnotify",
      "status": "test",
      "description": "Detects when an attacker register a new SIP provider for persistence and defense evasion",
      "level": "high",
      "tags": [
        "attack.persistence"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\mpnotify",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2022-07-21",
        "modified": "2023-08-17",
        "references": [
          "https://persistence-info.github.io/Data/mpnotify.html",
          "https://www.youtube.com/watch?v=ggY3srD9dYs&ab_channel=GrzegorzTworek"
        ],
        "falsepositives": [
          "Might trigger if a legitimate new SIP provider is registered. But this is not a common occurrence in an environment and should be investigated either way"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_persistence_mpnotify.yml"
      }
    },
    {
      "id": "45e112d0-7759-4c2a-aa36-9f8fb79d3393",
      "title": "IE Change Domain Zone",
      "status": "test",
      "description": "Hides the file extension through modification of the registry",
      "level": "medium",
      "tags": [
        "attack.persistence",
        "attack.t1137"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection_domains": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\Domains\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": [
                  "DWORD (0x00000000)",
                  "DWORD (0x00000001)",
                  "(Empty)"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection_domains and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection_domains",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1137"
        ],
        "tactics": [
          "persistence"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-01-22",
        "modified": "2023-08-17",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1112/T1112.md#atomic-test-4---add-domain-to-trusted-sites-zone",
          "https://learn.microsoft.com/en-us/troubleshoot/developer/browsers/security-privacy/ie-security-zones-registry-entries"
        ],
        "falsepositives": [
          "Administrative scripts"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_change_security_zones.yml"
      }
    },
    {
      "id": "5b872a46-3b90-45c1-8419-f675db8053aa",
      "title": "UAC Bypass via Sdclt",
      "status": "test",
      "description": "Detects the pattern of UAC Bypass using registry key manipulation of sdclt.exe (e.g. UACMe 53)",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.privilege-escalation",
        "attack.t1548.002",
        "car.2019-04-001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection1": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "Software\\Classes\\exefile\\shell\\runas\\command\\isolatedCommand",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "selection2": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "Software\\Classes\\Folder\\shell\\open\\command\\SymbolicLinkValue",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__re": {
                "field": "Details",
                "value": "-1[0-9]{3}\\\\Software\\\\Classes\\\\",
                "modifiers": [
                  "re"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "1 of selection*",
        "condition_parsed": {
          "op": "n_of",
          "count": 1,
          "pattern": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1548.002"
        ],
        "tactics": [
          "defense_evasion",
          "privilege_escalation"
        ]
      },
      "meta": {
        "author": "Omer Yampel, Christian Burkard (Nextron Systems)",
        "date": "2017-03-17",
        "modified": "2023-08-17",
        "references": [
          "https://enigma0x3.net/2017/03/17/fileless-uac-bypass-using-sdclt-exe/",
          "https://github.com/hfiref0x/UACME"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_uac_bypass_sdclt.yml"
      }
    },
    {
      "id": "a982fc9c-6333-4ffb-a51d-addb04e8b529",
      "title": "Windows Defender Exclusions Added - Registry",
      "status": "test",
      "description": "Detects the Setting of Windows Defender Exclusions",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection2": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Microsoft\\Windows Defender\\Exclusions",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection2",
        "condition_parsed": {
          "op": "single",
          "selection": "selection2"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Christian Burkard (Nextron Systems)",
        "date": "2021-07-06",
        "modified": "2023-08-17",
        "references": [
          "https://twitter.com/_nullbind/status/1204923340810543109"
        ],
        "falsepositives": [
          "Administrator actions"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_defender_exclusions.yml"
      }
    },
    {
      "id": "73a883d0-0348-4be4-a8d8-51031c2564f8",
      "title": "Potential Registry Persistence Attempt Via Windows Telemetry",
      "status": "test",
      "description": "Detects potential persistence behavior using the windows telemetry registry key.\nWindows telemetry makes use of the binary CompatTelRunner.exe to run a variety of commands and perform the actual telemetry collections.\nThis binary was created to be easily extensible, and to that end, it relies on the registry to instruct on which commands to run.\nThe problem is, it will run any arbitrary command without restriction of location or type.\n",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.execution",
        "attack.persistence",
        "attack.t1053.005"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\TelemetryController\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Command",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              },
              "Details__contains": {
                "field": "Details",
                "value": [
                  ".bat",
                  ".bin",
                  ".cmd",
                  ".dat",
                  ".dll",
                  ".exe",
                  ".hta",
                  ".jar",
                  ".js",
                  ".msi",
                  ".ps",
                  ".sh",
                  ".vb"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_generic": {
            "type": "field_match",
            "matchers": {
              "Details__contains": {
                "field": "Details",
                "value": [
                  "\\system32\\CompatTelRunner.exe",
                  "\\system32\\DeviceCensus.exe"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1053.005"
        ],
        "tactics": [
          "privilege_escalation",
          "execution",
          "persistence"
        ]
      },
      "meta": {
        "author": "Lednyov Alexey, oscd.community, Sreeman",
        "date": "2020-10-16",
        "modified": "2023-08-17",
        "references": [
          "https://www.trustedsec.com/blog/abusing-windows-telemetry-for-persistence/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_telemetry_persistence.yml"
      }
    },
    {
      "id": "9827ae57-3802-418f-994b-d5ecf5cd974b",
      "title": "Potential Registry Persistence Attempt Via DbgManagedDebugger",
      "status": "test",
      "description": "Detects the addition of the \"Debugger\" value to the \"DbgManagedDebugger\" key in order to achieve persistence. Which will get invoked when an application crashes",
      "level": "medium",
      "tags": [
        "attack.privilege-escalation",
        "attack.defense-evasion",
        "attack.persistence",
        "attack.t1574"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\Microsoft\\.NETFramework\\DbgManagedDebugger",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter": {
            "type": "field_match",
            "matchers": {
              "Details": {
                "field": "Details",
                "value": "\"C:\\Windows\\system32\\vsjitdebugger.exe\" PID %d APPDOM %d EXTEXT \"%s\" EVTHDL %d",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not filter",
        "condition_parsed": {
          "op": "and_not",
          "include": "selection",
          "exclude": "filter"
        }
      },
      "mitre": {
        "techniques": [
          "T1574"
        ],
        "tactics": [
          "privilege_escalation",
          "defense_evasion",
          "persistence"
        ]
      },
      "meta": {
        "author": "frack113",
        "date": "2022-08-07",
        "modified": "2023-08-17",
        "references": [
          "https://www.hexacorn.com/blog/2013/09/19/beyond-good-ol-run-key-part-4/",
          "https://github.com/last-byte/PersistenceSniper"
        ],
        "falsepositives": [
          "Legitimate use of the key to setup a debugger. Which is often the case on developers machines"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_dbgmanageddebugger_persistence.yml"
      }
    },
    {
      "id": "1f1d8209-636e-4c6c-a137-781cca8b82f9",
      "title": "WFP Filter Added via Registry",
      "status": "experimental",
      "description": "Detects registry modifications that add Windows Filtering Platform (WFP) filters, which may be used to block security tools and EDR agents from reporting events.\n",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.execution",
        "attack.t1562",
        "attack.t1569.002"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\BFE\\Parameters\\Policy\\Persistent\\Filter\\",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_svchost": {
            "type": "field_match",
            "matchers": {
              "Image": {
                "field": "Image",
                "value": [
                  "C:\\Windows\\System32\\svchost.exe",
                  "C:\\Windows\\SysWOW64\\svchost.exe"
                ],
                "modifiers": [],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1562",
          "T1569.002"
        ],
        "tactics": [
          "defense_evasion",
          "execution"
        ]
      },
      "meta": {
        "author": "Frack113",
        "date": "2025-10-23",
        "modified": "",
        "references": [
          "https://github.com/netero1010/EDRSilencer/blob/0e73a7037ec65c52894d8208e6f605a7da0a34a6/EDRSilencer.c",
          "https://www.huntress.com/blog/silencing-the-edr-silencers",
          "https://www.trendmicro.com/en_us/research/24/j/edrsilencer-disrupting-endpoint-security-solutions.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_susp_wfp_filter_added.yml"
      }
    },
    {
      "id": "b110ebaf-697f-4da1-afd5-b536fa27a2c1",
      "title": "Potential Signing Bypass Via Windows Developer Features - Registry",
      "status": "test",
      "description": "Detects when the enablement of developer features such as \"Developer Mode\" or \"Application Sideloading\". Which allows the user to install untrusted packages.",
      "level": "high",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": [
                  "\\Microsoft\\Windows\\CurrentVersion\\AppModelUnlock",
                  "\\Policies\\Microsoft\\Windows\\Appx\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              },
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": [
                  "\\AllowAllTrustedApps",
                  "\\AllowDevelopmentWithoutDevLicense"
                ],
                "modifiers": [
                  "endswith"
                ],
                "is_list": true,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000001)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems)",
        "date": "2023-01-12",
        "modified": "2023-08-17",
        "references": [
          "https://twitter.com/malmoeb/status/1560536653709598721",
          "https://www.sentinelone.com/labs/inside-malicious-windows-apps-for-malware-deployment/"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_turn_on_dev_features.yml"
      }
    },
    {
      "id": "e61e8a88-59a9-451c-874e-70fcc9740d67",
      "title": "New DNS ServerLevelPluginDll Installed",
      "status": "test",
      "description": "Detects the installation of a DNS plugin DLL via ServerLevelPluginDll parameter in registry, which can be used to execute code in context of the DNS server (restart required)",
      "level": "high",
      "tags": [
        "attack.privilege-escalation",
        "attack.persistence",
        "attack.defense-evasion",
        "attack.t1574.001",
        "attack.t1112"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__endswith": {
                "field": "TargetObject",
                "value": "\\services\\DNS\\Parameters\\ServerLevelPluginDll",
                "modifiers": [
                  "endswith"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1574.001",
          "T1112"
        ],
        "tactics": [
          "privilege_escalation",
          "persistence",
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Florian Roth (Nextron Systems)",
        "date": "2017-05-08",
        "modified": "2023-08-17",
        "references": [
          "https://medium.com/@esnesenon/feature-not-bug-dnsadmin-to-dc-compromise-in-one-line-a0f779b8dc83",
          "https://blog.3or.de/hunting-dns-server-level-plugin-dll-injection.html"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_dns_server_level_plugin_dll.yml"
      }
    },
    {
      "id": "44a22d59-b175-4f13-8c16-cbaef5b581ff",
      "title": "New File Association Using Exefile",
      "status": "test",
      "description": "Detects the abuse of the exefile handler in new file association. Used for bypass of security products.",
      "level": "high",
      "tags": [
        "attack.defense-evasion"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "Classes\\.",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "exefile",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "Andreas Hunkeler (@Karneades)",
        "date": "2021-11-19",
        "modified": "2023-08-17",
        "references": [
          "https://twitter.com/mrd0x/status/1461041276514623491"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/registry/registry_set/registry_set_file_association_exefile.yml"
      }
    },
    {
      "id": "4d431012-2ab5-4db7-a84e-b29809da2172",
      "title": "Enable Remote Connection Between Anonymous Computer - AllowAnonymousCallback",
      "status": "test",
      "description": "Detects enabling of the \"AllowAnonymousCallback\" registry value, which allows a remote connection between computers that do not have a trust relationship.",
      "level": "medium",
      "tags": [
        "attack.defense-evasion",
        "attack.t1562.001"
      ],
      "logsource": {
        "category": "registry_set",
        "product": "windows",
        "service": null
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "TargetObject__contains": {
                "field": "TargetObject",
                "value": "\\Microsoft\\WBEM\\CIMOM\\AllowAnonymousCallback",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              },
              "Details": {
                "field": "Details",
                "value": "DWORD (0x00000001)",
                "modifiers": [],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1562.001"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "X__Junior (Nextron Systems)",
        "date": "2023-11-03",
        "modified": "",
        "references": [
          "https://learn.microsoft.com/en-us/windows/win32/wmisdk/connecting-to-wmi-remotely-starting-with-vista"
        ],
        "falsepositives": [
          "Administrative activity"
        ],
        "source_file": "sigma_rules/windows/registry/registry_event/registry_set_enable_anonymous_connection.yml"
      }
    }
  ]
}