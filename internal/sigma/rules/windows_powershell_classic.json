{
  "metadata": {
    "logsource": "windows_powershell_classic",
    "rule_count": 3,
    "compiled_at": "2026-02-04T12:28:36.415696",
    "version": "1.1"
  },
  "rules": [
    {
      "id": "f65e22f9-819e-4f96-9c7b-498364ae7a25",
      "title": "Potential RemoteFXvGPUDisablement.EXE Abuse",
      "status": "test",
      "description": "Detects PowerShell module creation where the module Contents are set to \"function Get-VMRemoteFXPhysicalVideoAdapter\". This could be a sign of potential abuse of  the \"RemoteFXvGPUDisablement.exe\" binary which is known to be vulnerable to module load-order hijacking.",
      "level": "high",
      "tags": [
        "attack.defense-evasion",
        "attack.t1218"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "powershell-classic"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Data__contains": {
                "field": "Data",
                "value": "ModuleContents=function Get-VMRemoteFXPhysicalVideoAdapter {",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1218"
        ],
        "tactics": [
          "defense_evasion"
        ]
      },
      "meta": {
        "author": "frack113, Nasreddine Bencherchali (Nextron Systems)",
        "date": "2021-07-13",
        "modified": "2023-05-09",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1218/T1218.md",
          "https://github.com/redcanaryco/AtomicTestHarnesses/blob/7e1e4da116801e3d6fcc6bedb207064577e40572/TestHarnesses/T1218_SignedBinaryProxyExecution/InvokeRemoteFXvGPUDisablementCommand.ps1"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/powershell/powershell_classic/posh_pc_remotefxvgpudisablement_abuse.yml"
      }
    },
    {
      "id": "df9a0e0e-fedb-4d6c-8668-d765dfc92aa7",
      "title": "Suspicious Non PowerShell WSMAN COM Provider",
      "status": "test",
      "description": "Detects suspicious use of the WSMAN provider without PowerShell.exe as the host application.",
      "level": "medium",
      "tags": [
        "attack.execution",
        "attack.t1059.001",
        "attack.lateral-movement",
        "attack.t1021.003"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "powershell-classic"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Data__contains": {
                "field": "Data",
                "value": "ProviderName=WSMan",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "filters": {
          "filter_main_ps": {
            "type": "field_match",
            "matchers": {
              "Data__contains": {
                "field": "Data",
                "value": [
                  "HostApplication=powershell",
                  "HostApplication=C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell",
                  "HostApplication=C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell",
                  "HostApplication=C:/Windows/System32/WindowsPowerShell/v1.0/powershell",
                  "HostApplication=C:/Windows/SysWOW64/WindowsPowerShell/v1.0/powershell"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          },
          "filter_main_host_application_null": {
            "type": "field_match",
            "matchers": {
              "Data__re": {
                "field": "Data",
                "value": "HostId=[a-zA-Z0-9-]{36}\\s+EngineVersion=",
                "modifiers": [
                  "re"
                ],
                "is_list": false,
                "negated": false
              }
            }
          },
          "filter_optional_hexnode": {
            "type": "field_match",
            "matchers": {
              "Data__contains": {
                "field": "Data",
                "value": "HostApplication=C:\\Hexnode\\Hexnode Agent\\Current\\HexnodeAgent.exe",
                "modifiers": [
                  "contains"
                ],
                "is_list": false,
                "negated": false
              }
            }
          }
        },
        "condition": "selection and not 1 of filter_main_* and not 1 of filter_optional_*",
        "condition_parsed": {
          "op": "and",
          "operands": [
            {
              "type": "ref",
              "value": "selection"
            },
            {
              "type": "not",
              "value": "1 of filter_main_*"
            },
            {
              "type": "not",
              "value": "1 of filter_optional_*"
            }
          ]
        }
      },
      "mitre": {
        "techniques": [
          "T1059.001",
          "T1021.003"
        ],
        "tactics": [
          "execution",
          "lateral_movement"
        ]
      },
      "meta": {
        "author": "Roberto Rodriguez (Cyb3rWard0g), OTR (Open Threat Research)",
        "date": "2020-06-24",
        "modified": "2025-10-22",
        "references": [
          "https://twitter.com/chadtilbury/status/1275851297770610688",
          "https://bohops.com/2020/05/12/ws-management-com-another-approach-for-winrm-lateral-movement/",
          "https://github.com/bohops/WSMan-WinRM"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/powershell/powershell_classic/posh_pc_wsman_com_provider_no_powershell.yml"
      }
    },
    {
      "id": "71ff406e-b633-4989-96ec-bc49d825a412",
      "title": "Zip A Folder With PowerShell For Staging In Temp - PowerShell",
      "status": "test",
      "description": "Detects PowerShell scripts that make use of the \"Compress-Archive\" Cmdlet in order to compress folders and files where the output is stored in a potentially suspicious location that is used often by malware for exfiltration.\nAn adversary might compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network.\n",
      "level": "medium",
      "tags": [
        "attack.collection",
        "attack.t1074.001"
      ],
      "logsource": {
        "category": null,
        "product": "windows",
        "service": "powershell-classic"
      },
      "detection": {
        "selections": {
          "selection": {
            "type": "field_match",
            "matchers": {
              "Data__contains": {
                "field": "Data",
                "value": [
                  "Compress-Archive -Path*-DestinationPath $env:TEMP",
                  "Compress-Archive -Path*-DestinationPath*\\AppData\\Local\\Temp\\",
                  "Compress-Archive -Path*-DestinationPath*:\\Windows\\Temp\\"
                ],
                "modifiers": [
                  "contains"
                ],
                "is_list": true,
                "negated": false
              }
            }
          }
        },
        "filters": {},
        "condition": "selection",
        "condition_parsed": {
          "op": "single",
          "selection": "selection"
        }
      },
      "mitre": {
        "techniques": [
          "T1074.001"
        ],
        "tactics": [
          "collection"
        ]
      },
      "meta": {
        "author": "Nasreddine Bencherchali (Nextron Systems), frack113",
        "date": "2021-07-20",
        "modified": "2023-12-18",
        "references": [
          "https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1074.001/T1074.001.md",
          "https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-347a"
        ],
        "falsepositives": [
          "Unknown"
        ],
        "source_file": "sigma_rules/windows/powershell/powershell_classic/posh_pc_susp_zip_compress.yml"
      }
    }
  ]
}